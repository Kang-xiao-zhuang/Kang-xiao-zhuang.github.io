<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello-World</title>
    <url>/2021/01/01/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>åˆ·é¢˜ç¬”è®°(æ•°ç»„)-03</title>
    <url>/2021/05/15/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%95%B0%E7%BB%84-03/</url>
    <content><![CDATA[<p><strong>é¢˜ç›®åœ°å€:<a href="https://leetcode-cn.com/problems/rotate-matrix-lcci/">é¢è¯•é¢˜ 01.07. æ—‹è½¬çŸ©é˜µ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)</a></strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7409a77f783689c106067cf9bbaa6e1e.png"></p>
<blockquote>
<p>æ€è·¯ï¼š</p>
<ul>
<li><p>ç¿»è½¬åçš„å…ƒç´ çš„è§„å¾‹æ˜¯ å‡å¦‚å…ƒç´ æ˜¯ç¬¬äºŒåˆ—ç¬¬ä¸€ä¸ªï¼Œç¿»è½¬åä¼šæ˜¯ç¬¬äºŒè¡Œæœ€åä¸€ä¸ªï¼</p>
<pre><code>               1 2 3          7 4 1
            4 5 6   --&gt;    8 5 2
            7 8 9          9 6 3
</code></pre>
</li>
<li><p>ä»¥ 2 ä¸ºä¾‹</p>
<pre><code>         ç¿»è½¬å‰ ä½ç½® ã€0ã€‘ã€1ã€‘
         ç¿»è½¬å ä½ç½®  ã€1ã€‘ã€2ã€‘
</code></pre>
</li>
<li><p> éå†å®Œæˆä¹‹åï¼Œå†å°†matrix_newä¸­çš„ç»“æœå¤åˆ¶åˆ°åŸæ•°ç»„ä¸­å³å¯</p>
</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>[][] matrix)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–æ•°ç»„é•¿åº¦</span></span><br><span class="line">        <span class="keyword">int</span> n=matrix.length;</span><br><span class="line">        <span class="comment">//å®šä¹‰æ–°çš„æ•°ç»„</span></span><br><span class="line">        <span class="keyword">int</span> [][] matrix_new=<span class="keyword">new</span> <span class="keyword">int</span>[n][n];</span><br><span class="line">        <span class="comment">//ä¸¤æ¬¡å¾ªç¯</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">               matrix_new[j][n-i-<span class="number">1</span>]= matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                matrix[i][j]=matrix_new[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>é¢˜ç›®åœ°å€:<a href="https://leetcode-cn.com/problems/zero-matrix-lcci/">é¢è¯•é¢˜ 01.08. é›¶çŸ©é˜µ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)</a></strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/bd550f89bad70cbc9f7217df2b541531.png">)</p>
<p>æ€è·¯</p>
<ul>
<li>ç”¨2ä¸ªæ ‡è®°æ•°ç»„ è®°å½•æ¯ä¸€è¡Œå’Œæ¯ä¸€åˆ—æ˜¯å¦æœ‰0å‡ºç° å‡ºç°å°±æ ‡è®°æ•°ç»„çš„ä½ç½®ä¸ºtrue</li>
<li>æœ€åæ›´æ–°åŸæ•°ç»„</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setZeroes</span><span class="params">(<span class="keyword">int</span>[][] matrix)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> m=matrix.length,n=matrix[<span class="number">0</span>].length;</span><br><span class="line">        <span class="keyword">boolean</span>[] row=<span class="keyword">new</span> <span class="keyword">boolean</span>[m];</span><br><span class="line">        <span class="keyword">boolean</span>[] col=<span class="keyword">new</span> <span class="keyword">boolean</span>[n];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">               <span class="keyword">if</span>(matrix[i][j]==<span class="number">0</span>)&#123;</span><br><span class="line">                   row[i]=col[j]=<span class="keyword">true</span>;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">               <span class="keyword">if</span>(row[i]||col[j])&#123;</span><br><span class="line">                   matrix[i][j]=<span class="number">0</span>;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç å‡ç”±åŠ›æ‰£ç¼–è¯‘å™¨ï¼Œæäº¤é€šè¿‡ï¼Œæè¿°ç¼–å†™ä¸å½“åœ°æ–¹è¿˜è¯·å¤§å®¶è¯„è®ºåŒºæŒ‡å‡ºï¼</p>
]]></content>
      <categories>
        <category>åŠ›æ‰£åˆ·é¢˜</category>
      </categories>
      <tags>
        <tag>æ•°ç»„</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ·é¢˜ç¬”è®°(é“¾è¡¨)-02</title>
    <url>/2021/05/15/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E9%93%BE%E8%A1%A8-02/</url>
    <content><![CDATA[<p><strong>é¢˜ç›®åœ°å€:<a href="https://leetcode-cn.com/problems/delete-node-in-a-linked-list/">237. åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)</a></strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/153998322821110e4e864638b0a26419.png"></p>
<p>æ€è·¯ï¼šåªéœ€è¦å°†nodeèŠ‚ç‚¹çš„nextçš„valèµ‹å€¼ç»™nodeèŠ‚ç‚¹çš„valï¼Œç„¶åå°†nodeèŠ‚ç‚¹çš„nextçš„nextèµ‹å€¼nodeçš„next</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteNode</span><span class="params">(ListNode node)</span> </span>&#123;</span><br><span class="line">        node.val=node.next.val;</span><br><span class="line">        node.next=node.next.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>é¢˜ç›®åœ°å€:<a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list/">83. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)</a></strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2e19a6f0a969e90c35f3d997366b6657.png"></p>
<p>æ€è·¯ï¼š</p>
<ul>
<li>é¦–å…ˆåˆ¤æ–­å¤´èŠ‚ç‚¹æ˜¯å¦ä¸ºç©ºï¼Œç©ºç›´æ¥è¿”å›å¤´èŠ‚ç‚¹</li>
<li>å®šä¹‰ä¸€ä¸ªptræ¥å—å¤´èŠ‚ç‚¹ï¼Œwhileå¾ªç¯ï¼Œæ¡ä»¶ï¼š<strong>ptr.next!=null</strong> å¦‚æœptrçš„nextçš„valç­‰äºptrçš„valï¼Œé‚£ä¹ˆ<strong>ptr.next=ptr.next.next;</strong></li>
<li>å¦åˆ™<strong>ptr=ptr.next</strong>,æœ€åè¿”å›å¤´èŠ‚ç‚¹</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">deleteDuplicates</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(head==<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> head;</span><br><span class="line">            &#125;</span><br><span class="line">            ListNode ptr=head;</span><br><span class="line">            <span class="keyword">while</span>(ptr.next!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ptr.val==ptr.next.val)&#123;</span><br><span class="line">                    ptr.next=ptr.next.next;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    ptr=ptr.next;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>é¢˜ç›®åœ°å€:<a href="https://leetcode-cn.com/problems/fan-zhuan-lian-biao-lcof/">å‰‘æŒ‡ Offer 24. åè½¬é“¾è¡¨ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)</a></strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d7f1dfc302968de9b8e7e9e06aa5d942.png"></p>
<p>æ€è·¯</p>
<ul>
<li>é¦–å…ˆåˆ¤æ–­å¤´èŠ‚ç‚¹å’Œå¤´èŠ‚ç‚¹çš„nextæ˜¯å¦ä¸ºç©ºï¼ŒäºŒè€…ä¸€ä¸ªä¸ºç©ºï¼Œç›´æ¥è¿”å›å¤´èŠ‚ç‚¹</li>
<li>å®šä¹‰ç©ºçš„newhead</li>
<li>whileå¾ªç¯ å½“å¤´èŠ‚ç‚¹ä¸ä¸ºç©º</li>
<li>å…ˆå®šä¹‰ä¸€ä¸ªä¸´æ—¶å˜é‡ temp æ¥å—headçš„next  <strong>ListNode temp=head.next;</strong></li>
<li><strong>head.next=newhead;</strong> å…ˆæŠŠheadçš„nextä¸ºnull</li>
<li><strong>newhead=head;</strong> å†å°†headèµ‹å€¼ç»™newhead</li>
<li><strong>head=temp;</strong> ç›¸å½“äºäº¤æ¢å¤´èŠ‚ç‚¹å’Œå¤´èŠ‚ç‚¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ä½ç½®</li>
<li>æœ€åè¿”å›newhead</li>
</ul>
<blockquote>
<p>1 2 3 4 5</p>
<p>ä¸¾ä¾‹</p>
<ul>
<li>head=1,head.next=2,temp=null</li>
<li>å…ˆæŠŠ2çš„å€¼ç»™tempï¼Œå°†2çš„ä½ç½®å˜ä¸ºnull,</li>
<li>å†å°†1çš„å€¼èµ‹å€¼ç»™newheadï¼Œè¿™æ ·1åè½¬è¿‡æ¥å°±æ˜¯æœ€åä¸€ä¸ªå…ƒç´ </li>
<li>æœ€åå°†tempçš„å€¼èµ‹å€¼ç»™headï¼Œä¹Ÿå°±æ˜¯å¤´èŠ‚ç‚¹ç°åœ¨æ˜¯2 ï¼Œç»§ç»­å¾ªç¯ä¸‹å»å¾—åˆ°ç»“æœ 5 4 3 2 1</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseList</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="keyword">null</span>|| head.next==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode newhead=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span>(head!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            ListNode temp=head.next;</span><br><span class="line">            head.next=newhead;</span><br><span class="line">            newhead=head;</span><br><span class="line">            head=temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> newhead;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»£ç å‡ç”±åŠ›æ‰£ç¼–è¯‘å™¨ï¼Œæäº¤é€šè¿‡ï¼Œæè¿°ç¼–å†™ä¸å½“åœ°æ–¹è¿˜è¯·å¤§å®¶è¯„è®ºåŒºæŒ‡å‡ºï¼</p>
]]></content>
      <categories>
        <category>åŠ›æ‰£åˆ·é¢˜</category>
      </categories>
      <tags>
        <tag>é“¾è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>åŠ›æ‰£åˆ·é¢˜(æ•°ç»„)-01</title>
    <url>/2021/05/14/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%95%B0%E7%BB%84-01/</url>
    <content><![CDATA[<p><strong>é¢˜ç›®åœ°å€ï¼š<a href="https://leetcode-cn.com/problems/move-zeroes/">283. ç§»åŠ¨é›¶ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)</a></strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%8A%9B%E6%89%A3%E5%88%B7%E9%A2%98%E5%9B%BE%E7%89%87/Snipaste_2021-05-14_21-25-09.png"></p>
<p><strong>æ€è·¯ï¼š</strong>åŒæŒ‡é’ˆï¼Œå®šä¹‰ä¸€ä¸ªå˜é‡jï¼Œéå†æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå¦‚æœç¢°åˆ°å…ƒç´ ä¸ä¸º0ï¼Œä¸”iï¼=jï¼Œç´¢å¼•içš„å€¼èµ‹ç»™jï¼Œç´¢å¼•içš„å…ƒç´ åˆå§‹åŒ–ä¸º0ï¼Œjæœ€åè‡ªå¢1</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveZeroes</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i!=j)&#123;</span><br><span class="line">                    nums[j]=nums[i];</span><br><span class="line">                    nums[i]=<span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦ä¸ªæ–¹æ³•ï¼šéå†æ•°ç»„ï¼Œå¦‚æœå…ƒç´ ä¸ä¸º0ï¼Œå®šä¹‰ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œäº¤æ¢ç´¢å¼•iå’Œç´¢å¼•jçš„å€¼ï¼Œæœ€åjè‡ªå¢1</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveZeroes</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> temp=nums[j];</span><br><span class="line">                nums[j]=nums[i];</span><br><span class="line">                nums[i]=temp;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç å‡ç”±åŠ›æ‰£ç¼–è¯‘å™¨ï¼Œæäº¤é€šè¿‡</p>
]]></content>
      <categories>
        <category>åŠ›æ‰£åˆ·é¢˜</category>
      </categories>
      <tags>
        <tag>æ•°ç»„</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidå››å¤§ç»„ä»¶ä¹‹BroadCast</title>
    <url>/2021/05/08/Android%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E4%B9%8BBroadCast/</url>
    <content><![CDATA[<p>å†™åœ¨å‰é¢</p>
<ul>
<li> è®°å½•å­¦ä¹ BroadCastçš„ä½¿ç”¨</li>
<li><code>IDEï¼šAndroid-Studio SDKç‰ˆæœ¬ï¼šAPI30</code></li>
</ul>
<ul>
<li>å…³äºä»€ä¹ˆæ˜¯<code>BroadCast</code>è¯·å‚è€ƒä¸‹è¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/weixin_39460667/article/details/82413819?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162443856116780255296656%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162443856116780255296656&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~baidu_landing_v2~default-5-82413819.nonecase&utm_term=broadcast&spm=1018.2226.3001.4450">Android ä¹‹ è¶…è¯¦ç»† Broadcast</a></li>
<li>å…³äº<code>Service</code>å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/qq_51495235/article/details/118089323?spm=1001.2014.3001.5501">Androidå››å¤§ç»„ä»¶ä¹‹Service</a></li>
</ul>
<p>æœ¬æ–‡ä¸»è¦ç”¨<code>Service</code>å’Œ<code>BroadCast</code>æ¥å®ç°ä¸€ä¸ªç§’è¡¨å…·æœ‰<strong>å¼€å§‹</strong>ï¼Œ<strong>æš‚åœ</strong>ï¼Œ<strong>å½’é›¶</strong>ä¸‰ä¸ªåŠŸèƒ½</p>
<p>è¯ä¸å¤šè¯´å¼€å§‹ä¸Šä»£ç </p>
<p><strong>activity_receive.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.ReceiveActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/text1&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:textSize=&quot;35sp&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;200dp&quot;</span><br><span class="line">        android:layout_marginTop=&quot;100dp&quot;</span><br><span class="line">        android:orientation=&quot;vertical&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/btn1&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:text=&quot;å¼€å§‹&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/btn2&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:text=&quot;æš‚åœ&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/btn3&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:text=&quot;å½’é›¶&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/timeView&quot;</span><br><span class="line">        android:layout_marginTop=&quot;50dp&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:text=&quot;&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>é¢„è§ˆä¸‹ç•Œé¢ï¼Œæ¯”è¾ƒç®€å•</strong><br><img src="https://img-blog.csdnimg.cn/img_convert/7a480969c8cb606e1fe14a488e329a4f.png"></p>
<h2 id="1-å®šä¹‰å¹¿æ’­å‘é€å™¨BroadCastSender"><a href="#1-å®šä¹‰å¹¿æ’­å‘é€å™¨BroadCastSender" class="headerlink" title="1.å®šä¹‰å¹¿æ’­å‘é€å™¨BroadCastSender"></a>1.å®šä¹‰å¹¿æ’­å‘é€å™¨BroadCastSender</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¹¿æ’­å‘é€å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BroadCastSender</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰å¸¸é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BROADACTION = <span class="string">&quot;CZIE&quot;</span>;</span><br><span class="line">    Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String name, String value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ·»åŠ ä¸»é¢˜</span></span><br><span class="line">        intent.setAction(BROADACTION);</span><br><span class="line">        intent.putExtra(name, value);</span><br><span class="line">        <span class="comment">//å‘é€å¹¿æ’­</span></span><br><span class="line">        MyApplication.getContext().sendBroadcast(intent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String name, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ·»åŠ ä¸»é¢˜</span></span><br><span class="line">        intent.setAction(BROADACTION);</span><br><span class="line">        intent.putExtra(name, value);</span><br><span class="line">        MyApplication.getContext().sendBroadcast(intent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String name, Long value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ·»åŠ ä¸»é¢˜</span></span><br><span class="line">        intent.setAction(BROADACTION);</span><br><span class="line">        intent.putExtra(name, value);</span><br><span class="line">        MyApplication.getContext().sendBroadcast(intent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String name, Byte value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ·»åŠ ä¸»é¢˜</span></span><br><span class="line">        intent.setAction(BROADACTION);</span><br><span class="line">        intent.putExtra(name, value);</span><br><span class="line">        MyApplication.getContext().sendBroadcast(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-å®šä¹‰Serviceå‘é€æ¶ˆæ¯"><a href="#2-å®šä¹‰Serviceå‘é€æ¶ˆæ¯" class="headerlink" title="2.å®šä¹‰Serviceå‘é€æ¶ˆæ¯"></a>2.å®šä¹‰Serviceå‘é€æ¶ˆæ¯</h2><p>é€šè¿‡<code>while</code>å¾ªç¯æ¥ä¸åœçš„å‘é€æ¶ˆæ¯</p>
<p><strong>TestService3</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.IntentService;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.IBinder;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.czie.service.ReceiveActivity.istime;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestService3</span> <span class="keyword">extends</span> <span class="title">IntentService</span> </span>&#123;</span><br><span class="line">    BroadCastSender sender = <span class="keyword">new</span> BroadCastSender();</span><br><span class="line">    <span class="comment">//å¿…é¡»å®ç°çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestService3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">&quot;TestService3&quot;</span>);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¿…é¡»é‡å†™çš„æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span><span class="params">(<span class="meta">@Nullable</span> Intent intent)</span> </span>&#123;</span><br><span class="line">      </span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (istime == <span class="number">0</span>) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (istime == <span class="number">1</span>) &#123;</span><br><span class="line">                i = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            sender.send(<span class="string">&quot;HelloWorld&quot;</span>,i);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-åº”ç”¨ç±»MyApplication"><a href="#3-åº”ç”¨ç±»MyApplication" class="headerlink" title="3.åº”ç”¨ç±»MyApplication"></a>3.åº”ç”¨ç±»MyApplication</h2><p>è¯¥ç±»ç”¨æ¥è·å–ä¸Šä¸‹æ–‡</p>
<p><strong>MyApplication</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Application;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        context=<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Context <span class="title">getContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> context;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-ä¸»ç•Œé¢ReceiveActivity"><a href="#4-ä¸»ç•Œé¢ReceiveActivity" class="headerlink" title="4.ä¸»ç•Œé¢ReceiveActivity"></a>4.ä¸»ç•Œé¢ReceiveActivity</h2><ul>
<li>è®¾ç½®æŒ‰é’®ç›‘å¬äº‹ä»¶</li>
<li>å¹¿æ’­æ¥æ”¶</li>
<li>åˆ›å»ºå¹¿æ’­æ¥æ”¶å™¨</li>
</ul>
<p><strong>ReceiveActivity</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.content.IntentFilter;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReceiveActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> istime;</span><br><span class="line">    MyBroadReceiver myBroadReceiver;</span><br><span class="line">    <span class="keyword">private</span> TextView textView;</span><br><span class="line">    <span class="keyword">private</span> TextView timeView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_receive);</span><br><span class="line">        Button btn1 = findViewById(R.id.btn1);</span><br><span class="line">        Button btn2 = findViewById(R.id.btn2);</span><br><span class="line">        Button btn3 = findViewById(R.id.btn3);</span><br><span class="line">        textView = findViewById(R.id.text1);</span><br><span class="line">        timeView=findViewById(R.id.timeView);</span><br><span class="line">        btn1.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        btn2.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        btn3.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¹¿æ’­æ¥å—</span></span><br><span class="line">        myBroadReceiver=<span class="keyword">new</span> MyBroadReceiver();</span><br><span class="line">        IntentFilter intentFilter = <span class="keyword">new</span> IntentFilter();</span><br><span class="line">        intentFilter.addAction(BroadCastSender.BROADACTION);</span><br><span class="line">        registerReceiver(myBroadReceiver,intentFilter);</span><br><span class="line">      <span class="comment">//  startService(new Intent(ReceiveActivity.this,TestService3.class));</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (v.getId())&#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn1:</span><br><span class="line">                istime=<span class="number">0</span>;</span><br><span class="line">                startService(<span class="keyword">new</span> Intent(ReceiveActivity.<span class="keyword">this</span>,TestService3.class));</span><br><span class="line">              <span class="comment">//  startService(Intent.makeMainActivity(startService(new Intent(ReceiveActivity.this, TestService3.class))));</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn2:</span><br><span class="line">                istime=<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn3:</span><br><span class="line">                istime=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºå¹¿æ’­æ¥æ”¶å™¨</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyBroadReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span></span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">            <span class="comment">//è·å–å‚æ•°</span></span><br><span class="line">            <span class="keyword">int</span> time = intent.getIntExtra(<span class="string">&quot;HelloWorld&quot;</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="comment">//åˆ†é’Ÿ</span></span><br><span class="line">            <span class="keyword">int</span> min =time/<span class="number">60</span>;</span><br><span class="line">            <span class="comment">//ç§’é’Ÿ</span></span><br><span class="line">            <span class="keyword">int</span> second=time%<span class="number">60</span>;</span><br><span class="line">            String times=String.format(<span class="string">&quot;%02d&quot;</span>,min)+<span class="string">&quot;:&quot;</span>+String.format(<span class="string">&quot;%02d&quot;</span>,second);</span><br><span class="line"></span><br><span class="line">            textView.setText(String.valueOf(times));</span><br><span class="line">            SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class="line">            String clockTime = simpleDateFormat.format(<span class="keyword">new</span> Date());</span><br><span class="line">            timeView.setText(clockTime);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é¢„è§ˆä¸‹æˆæœ</strong><br><img src="https://img-blog.csdnimg.cn/img_convert/963c6f8139b6dde2b15ded45a50e1a82.gif"></p>
<p>å†™åœ¨æœ€å</p>
<ul>
<li>æŒæ¡BroadCaståŸºæœ¬çŸ¥è¯†ç‚¹å’Œå¦‚ä½•å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ï¼Œå¹¶å®ç°åŠŸèƒ½ğŸ‘</li>
<li>ç»§ç»­æ¢ç´¢BroadCastå…¶ä»–åŠŸèƒ½ğŸ’ª</li>
<li>æœ¬ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨çš„è¯ï¼Œè®°å¾—ç‚¹ä¸ªèµğŸ‘</li>
<li>å¯¹æœ¬ç¯‡æ–‡ç« æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºæŒ‡å‡ºâ¤ï¸</li>
</ul>
]]></content>
      <categories>
        <category>å®‰å“</category>
      </categories>
      <tags>
        <tag>Androidç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidå››å¤§ç»„ä»¶ä¹‹Service</title>
    <url>/2021/05/05/Android%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E4%B9%8BService/</url>
    <content><![CDATA[<p>å†™åœ¨å‰é¢</p>
<ul>
<li> è®°å½•å­¦ä¹ Serviceçš„ä½¿ç”¨</li>
<li> <code>IDEï¼šAndroid-Studio SDKç‰ˆæœ¬ï¼šAPI30</code><h1 id="1-ServiceåŸºç¡€çŸ¥è¯†ç‚¹"><a href="#1-ServiceåŸºç¡€çŸ¥è¯†ç‚¹" class="headerlink" title="1. ServiceåŸºç¡€çŸ¥è¯†ç‚¹"></a>1. ServiceåŸºç¡€çŸ¥è¯†ç‚¹</h1><h2 id="1-1çº¿ç¨‹çš„ç›¸å…³æ¦‚å¿µï¼š"><a href="#1-1çº¿ç¨‹çš„ç›¸å…³æ¦‚å¿µï¼š" class="headerlink" title="1.1çº¿ç¨‹çš„ç›¸å…³æ¦‚å¿µï¼š"></a>1.1çº¿ç¨‹çš„ç›¸å…³æ¦‚å¿µï¼š</h2>é¦–å…ˆåœ¨äº†è§£Serviceå‰å…ˆæ¥äº†è§£ä¸‹çº¿ç¨‹ã€‚</li>
<li>ç¨‹åºï¼šä¸ºäº†å®Œæˆç‰¹å®šä»»åŠ¡ï¼Œç”¨æŸç§è¯­è¨€ç¼–å†™çš„ä¸€ç»„æŒ‡ä»¤é›†åˆ(ä¸€ç»„é™æ€ä»£ç )ã€‚</li>
<li>è¿›ç¨‹ï¼šè¿è¡Œä¸­çš„ç¨‹åºï¼Œç³»ç»Ÿè°ƒåº¦ä¸èµ„æºåˆ†é…çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ï¼Œæ“ä½œç³»ç»Ÿä¼š ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€æ®µå†…å­˜ç©ºé—´ã€‚ç¨‹åºçš„ä¾æ¬¡åŠ¨æ€æ‰§è¡Œï¼Œç»å†ä»£ç çš„åŠ è½½ï¼Œæ‰§è¡Œï¼Œ æ‰§è¡Œå®Œæ¯•çš„å®Œæ•´è¿‡ç¨‹ã€‚</li>
<li>çº¿ç¨‹ï¼šæ¯”è¿›ç¨‹æ›´å°çš„æ‰§è¡Œå•å…ƒï¼Œæ¯ä¸ªè¿›ç¨‹å¯èƒ½æœ‰å¤šæ¡çº¿ç¨‹ï¼Œçº¿ç¨‹éœ€è¦æ”¾åœ¨ä¸€ä¸ª è¿›ç¨‹ä¸­æ‰èƒ½æ‰§è¡Œï¼Œçº¿ç¨‹ç”±ç¨‹åºè´Ÿè´£ç®¡ç†ï¼Œè€Œè¿›ç¨‹åˆ™ç”±ç³»ç»Ÿè¿›è¡Œè°ƒåº¦ã€‚</li>
<li>å¤šçº¿ç¨‹çš„ç†è§£ï¼šå¹¶è¡Œæ‰§è¡Œå¤šä¸ªæ¡æŒ‡ä»¤ï¼Œå°†CPUæ—¶é—´ç‰‡æŒ‰ç…§è°ƒåº¦ç®—æ³•åˆ†é…ç»™å„ä¸ª çº¿ç¨‹ï¼Œå®é™…ä¸Šæ˜¯åˆ†æ—¶æ‰§è¡Œçš„ï¼Œåªæ˜¯è¿™ä¸ªåˆ‡æ¢çš„æ—¶é—´å¾ˆçŸ­ï¼Œç”¨æˆ·æ„Ÿè§‰åˆ°â€åŒæ—¶â€è€Œå·²ã€‚</li>
</ul>
<h2 id="1-2-çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#1-2-çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="1.2 çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"></a>1.2 çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</h2><p><img src="https://img-blog.csdnimg.cn/img_convert/245d0b52c641f46bf4311403edafe1ea.png"></p>
<h2 id="1-3-åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼"><a href="#1-3-åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="1.3 åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼"></a>1.3 åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼</h2><ol>
<li>ç»§æ‰¿Threadç±»</li>
<li>å®ç°Runnableæ¥å£</li>
<li>å®ç°Callablæ¥å£</li>
</ol>
<h2 id="1-4-Serviceä¸Threadçº¿ç¨‹çš„åŒºåˆ«"><a href="#1-4-Serviceä¸Threadçº¿ç¨‹çš„åŒºåˆ«" class="headerlink" title="1.4 Serviceä¸Threadçº¿ç¨‹çš„åŒºåˆ«"></a>1.4 Serviceä¸Threadçº¿ç¨‹çš„åŒºåˆ«</h2><p>å…¶å®ä»–ä»¬ä¸¤è€…å¹¶æ²¡æœ‰å¤ªå¤§çš„å…³ç³»ï¼Œä¸è¿‡æœ‰å¾ˆå¤šäººç»å¸¸æŠŠè¿™ä¸¤ä¸ªæ··æ·†äº†ã€‚ Threadæ˜¯çº¿ç¨‹ï¼Œç¨‹åºæ‰§è¡Œçš„æœ€å°å•å…ƒï¼Œåˆ†é…CPUçš„åŸºæœ¬å•ä½ã€‚ è€ŒServiceåˆ™æ˜¯Androidæä¾›ä¸€ä¸ªå…è®¸é•¿æ—¶é—´ç•™é©»åå°çš„ä¸€ä¸ªç»„ä»¶ï¼Œæœ€å¸¸è§çš„ ç”¨æ³•å°±æ˜¯åš<code>è½®è¯¢æ“ä½œ</code>ã€‚æˆ–è€…æƒ³åœ¨åå°åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚åå°ä¸‹è½½æ›´æ–°ã€‚ è®°å¾—åˆ«æŠŠè¿™ä¸¤ä¸ªæ¦‚å¿µæ··æ·†ã€‚</p>
<h2 id="1-5-Serviceçš„ç”Ÿå‘½å‘¨æœŸå›¾"><a href="#1-5-Serviceçš„ç”Ÿå‘½å‘¨æœŸå›¾" class="headerlink" title="1.5 Serviceçš„ç”Ÿå‘½å‘¨æœŸå›¾"></a>1.5 Serviceçš„ç”Ÿå‘½å‘¨æœŸå›¾</h2><p><img src="https://img-blog.csdnimg.cn/img_convert/70d128b3ffc8398a6bf869c2168589bc.png"></p>
<h2 id="1-6-Serviceçš„ç”Ÿå‘½å‘¨æœŸè§£æ"><a href="#1-6-Serviceçš„ç”Ÿå‘½å‘¨æœŸè§£æ" class="headerlink" title="1.6 Serviceçš„ç”Ÿå‘½å‘¨æœŸè§£æ"></a>1.6 Serviceçš„ç”Ÿå‘½å‘¨æœŸè§£æ</h2><ul>
<li>StartService()å¯åŠ¨Serviceã€‚</li>
<li><pre><code>BindService()å¯åŠ¨Serviceã€‚
</code></pre>
</li>
<li>è¿˜æœ‰ä¸€ç§ï¼Œå°±æ˜¯å¯åŠ¨Serviceåï¼Œç»‘å®šService</li>
</ul>
<h2 id="1-7-ç›¸å…³æ–¹æ³•è¯¦è§£"><a href="#1-7-ç›¸å…³æ–¹æ³•è¯¦è§£" class="headerlink" title="1.7 ç›¸å…³æ–¹æ³•è¯¦è§£"></a>1.7 ç›¸å…³æ–¹æ³•è¯¦è§£</h2><ul>
<li>onCreate()ï¼šå½“Serviceç¬¬ä¸€æ¬¡è¢«åˆ›å»ºåç«‹å³å›è°ƒè¯¥æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ ä¸­åªä¼šè°ƒç”¨ä¸€æ¬¡ã€‚</li>
<li>  onDestory()ï¼šå½“Serviceè¢«å…³é—­æ—¶ä¼šå›è°ƒè¯¥æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åªä¼šå›è°ƒä¸€æ¬¡ã€‚</li>
<li>onStartCommand(intent,flag,startId)ï¼šæ—©æœŸç‰ˆæœ¬æ˜¯onStart(intent,startId), å½“å®¢æˆ·ç«¯è°ƒç”¨startService(Intent)æ–¹æ³•æ—¶ä¼šå›è°ƒï¼Œå¯å¤šæ¬¡è°ƒç”¨StartServiceæ–¹æ³•ï¼Œ ä½†ä¸ä¼šå†åˆ›å»ºæ–°çš„Serviceå¯¹è±¡ï¼Œè€Œæ˜¯ç»§ç»­å¤ç”¨å‰é¢äº§ç”Ÿçš„Serviceå¯¹è±¡ï¼Œä½†ä¼šç»§ç»­å›è°ƒ onStartCommand()æ–¹æ³•ã€‚</li>
<li>IBinder onOnbind(intent)ï¼šè¯¥æ–¹æ³•æ˜¯Serviceéƒ½å¿…é¡»å®ç°çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª IBinderå¯¹è±¡ï¼Œappé€šè¿‡è¯¥å¯¹è±¡ä¸Serviceç»„ä»¶è¿›è¡Œé€šä¿¡ã€‚</li>
<li>onUnbind(intent)ï¼šå½“è¯¥Serviceä¸Šç»‘å®šçš„æ‰€æœ‰å®¢æˆ·ç«¯éƒ½æ–­å¼€æ—¶ä¼šå›è°ƒè¯¥æ–¹æ³•ã€‚</li>
</ul>
<h1 id="2-Serviceç”Ÿå‘½å‘¨æœŸçš„éªŒè¯"><a href="#2-Serviceç”Ÿå‘½å‘¨æœŸçš„éªŒè¯" class="headerlink" title="2. Serviceç”Ÿå‘½å‘¨æœŸçš„éªŒè¯"></a>2. Serviceç”Ÿå‘½å‘¨æœŸçš„éªŒè¯</h1><h2 id="2-1-è‡ªå®šä¹‰ä¸€ä¸ªService-é‡å†™ç›¸å…³çš„æ–¹æ³•-ç”¨æˆ·åœ¨logcatä¸Šæ‰“å°éªŒè¯"><a href="#2-1-è‡ªå®šä¹‰ä¸€ä¸ªService-é‡å†™ç›¸å…³çš„æ–¹æ³•-ç”¨æˆ·åœ¨logcatä¸Šæ‰“å°éªŒè¯" class="headerlink" title="2.1 è‡ªå®šä¹‰ä¸€ä¸ªService,é‡å†™ç›¸å…³çš„æ–¹æ³•,ç”¨æˆ·åœ¨logcatä¸Šæ‰“å°éªŒè¯:"></a>2.1 è‡ªå®šä¹‰ä¸€ä¸ªService,é‡å†™ç›¸å…³çš„æ–¹æ³•,ç”¨æˆ·åœ¨logcatä¸Šæ‰“å°éªŒè¯:</h2><p>ç¼–å†™å¸ƒå±€æ–‡ä»¶ï¼Œæ·»åŠ ä¸¤ä¸ªButtonç»„ä»¶ï¼ŒIdåˆ†åˆ«è®¾ç½®ä¸º<code>startButton</code>ã€<code>stopButton</code></p>
<p><strong>activity_main.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;TableRow</span><br><span class="line">        android:id=&quot;@+id/tableRow1&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_alignParentStart=&quot;true&quot;</span><br><span class="line">        android:layout_alignParentLeft=&quot;true&quot;</span><br><span class="line">        android:layout_alignParentTop=&quot;true&quot;</span><br><span class="line">        android:layout_marginTop=&quot;100dp&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/startButton&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;100dp&quot;</span><br><span class="line">            android:text=&quot;Start&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/stopButton&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;122dp&quot;</span><br><span class="line">            android:text=&quot;Stop&quot; /&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">TableRow</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>é¢„è§ˆä¸‹æ ·å¼</strong><br><img src="https://img-blog.csdnimg.cn/img_convert/7917fc22b16c1ef138a42d5016d6b94f.png"><br>åœ¨src/main/java/åŒ…å ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code>TestService1</code>çš„ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Service;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.IBinder;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestService1</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//å¿…é¡»è¦å®ç°çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        Log.i(<span class="string">&quot;CCC&quot;</span>, <span class="string">&quot;onBindæ–¹æ³•è¢«è°ƒç”¨ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Serviceè¢«åˆ›å»ºæ—¶è°ƒç”¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.i(<span class="string">&quot;CCC&quot;</span>, <span class="string">&quot;onCreateæ–¹æ³•è¢«è°ƒç”¨ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Serviceè¢«å¯åŠ¨æ—¶è°ƒç”¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onStartCommand</span><span class="params">(Intent intent, <span class="keyword">int</span> flags, <span class="keyword">int</span> startId)</span> </span>&#123;</span><br><span class="line">        Log.i(<span class="string">&quot;CCC&quot;</span>, <span class="string">&quot;onStartCommandè¢«è°ƒç”¨ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onStartCommand(intent, flags, startId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Serviceè¢«å…³é—­ä¹‹å‰å›è°ƒ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.i(<span class="string">&quot;CCC&quot;</span>, <span class="string">&quot;onDestroyè¢«è°ƒç”¨ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™å®Œæ¯•åæ‰“å¼€é¡¹ç›®ä¸­çš„<code>AndroidManifest.xml</code>æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚ åœ¨&lt;activity  â€¦â€¦&gt;   /activity&gt;èŠ‚ç‚¹åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">service</span> <span class="attr">android:name</span>=<span class="string">&quot;.TestService1&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;com.czie.service.testservice1&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>MainActivityä¸­ç¼–å†™ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Button start, stop;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        start = (Button) findViewById(R.id.startButton);</span><br><span class="line">        stop = (Button) findViewById(R.id.stopButton);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯åŠ¨Serviceçš„Intent,ä»¥åŠIntentå±æ€§</span></span><br><span class="line">        <span class="keyword">final</span> Intent intent = <span class="keyword">new</span> Intent(<span class="keyword">this</span>,TestService1.class);</span><br><span class="line">        intent.setAction(<span class="string">&quot;com.czie.service.testservice1&quot;</span>);</span><br><span class="line">        <span class="comment">//ä¸ºä¸¤ä¸ªæŒ‰é’®è®¾ç½®ç‚¹å‡»äº‹ä»¶,åˆ†åˆ«æ˜¯å¯åŠ¨ä¸åœæ­¢service</span></span><br><span class="line">        start.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                startService(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        stop.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                stopService(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œé¡¹ç›®ï¼Œç‚¹å‡»æŒ‰é’®åŒæ—¶æŸ¥çœ‹<code>Log</code>è¾“å‡º<br><img src="https://img-blog.csdnimg.cn/img_convert/a7dba2caa4d5c265e4ac987041237dd6.png"></p>
<h2 id="2-2-IntentServiceçš„ç”¨æ³•"><a href="#2-2-IntentServiceçš„ç”¨æ³•" class="headerlink" title="2.2 IntentServiceçš„ç”¨æ³•"></a>2.2 IntentServiceçš„ç”¨æ³•</h2><p>åœ¨é¡¹ç›®ä¸­çš„src/main/java/com.czie.serviceä¸‹åˆ›å»ºä¸€ä¸ªåä¸º<code>TestService3</code>çš„ç±»</p>
<p><strong>TestService3</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.IntentService;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.IBinder;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestService3</span> <span class="keyword">extends</span> <span class="title">IntentService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¿…é¡»å®ç°çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestService3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">&quot;TestService3&quot;</span>);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¿…é¡»é‡å†™çš„æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span><span class="params">(<span class="meta">@Nullable</span> Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> 2021/6/21</span></span><br><span class="line">        <span class="comment">// Intentæ˜¯ä»Activityå‘è¿‡æ¥çš„ï¼Œæºå¸¦è¯†åˆ«å‚æ•°ï¼Œæ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„ä»»åŠ¡</span></span><br><span class="line">        String action = intent.getExtras().getString(<span class="string">&quot;param&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (action.equals(<span class="string">&quot;s1&quot;</span>)) Log.i(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;å¯åŠ¨service1&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (action.equals(<span class="string">&quot;s2&quot;</span>)) Log.i(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;å¯åŠ¨service2&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (action.equals(<span class="string">&quot;s3&quot;</span>)) Log.i(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;å¯åŠ¨service3&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æœåŠ¡ä¼‘çœ 2ç§’</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡å†™å…¶ä»–æ–¹æ³•ï¼Œç”¨äºæŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨é¡ºåº</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        Log.i(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;onBindæ–¹æ³•è¢«è°ƒç”¨äº†ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onBind(intent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIntentRedelivery</span><span class="params">(<span class="keyword">boolean</span> enabled)</span> </span>&#123;</span><br><span class="line">        Log.i(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;setIntentRedeliveryè¢«è°ƒç”¨äº†ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">super</span>.setIntentRedelivery(enabled);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.i(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;onDestroyè¢«è°ƒç”¨äº†ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™å®Œæ¯•åæ‰“å¼€é¡¹ç›®ä¸­çš„<code>AndroidManifest.xml</code>æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚ åœ¨&lt;activity  â€¦â€¦&gt;   /activity&gt;èŠ‚ç‚¹åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">service</span> <span class="attr">android:name</span>=<span class="string">&quot;.TestService3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;com.czie.service.testservice3&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨<code>MainActivity</code>ä¸­æ·»åŠ ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Button start, stop;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        start = (Button) findViewById(R.id.startButton);</span><br><span class="line">        stop = (Button) findViewById(R.id.stopButton);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Intent it1 = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, TestService3.class);</span><br><span class="line">        Bundle b1 = <span class="keyword">new</span> Bundle();</span><br><span class="line">        b1.putString(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;s1&quot;</span>);</span><br><span class="line">        it1.putExtras(b1);</span><br><span class="line"></span><br><span class="line">        Intent it2 = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, TestService3.class);</span><br><span class="line">        Bundle b2 = <span class="keyword">new</span> Bundle();</span><br><span class="line">        b2.putString(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;s2&quot;</span>);</span><br><span class="line">        it2.putExtras(b2);</span><br><span class="line"></span><br><span class="line">        Intent it3 = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, TestService3.class);</span><br><span class="line">        Bundle b3 = <span class="keyword">new</span> Bundle();</span><br><span class="line">        b3.putString(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;s3&quot;</span>);</span><br><span class="line">        it3.putExtras(b3);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¥ç€å¯åŠ¨å¤šæ¬¡IntentService</span></span><br><span class="line">        startService(it1);</span><br><span class="line">        startService(it2);</span><br><span class="line">        startService(it3);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯åŠ¨Serviceçš„Intent,ä»¥åŠIntentå±æ€§</span></span><br><span class="line">        <span class="keyword">final</span> Intent intent = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, TestService1.class);</span><br><span class="line">        intent.setAction(<span class="string">&quot;com.czie.service.testservice1&quot;</span>);</span><br><span class="line">        <span class="comment">//ä¸ºä¸¤ä¸ªæŒ‰é’®è®¾ç½®ç‚¹å‡»äº‹ä»¶,åˆ†åˆ«æ˜¯å¯åŠ¨ä¸åœæ­¢service</span></span><br><span class="line">        start.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                startService(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        stop.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                stopService(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œé¡¹ç›®ï¼ŒæŸ¥çœ‹<code>Log</code>çš„è¾“å‡º<br><code>IntentService</code>æ¯æ¬¡å¯åŠ¨ï¼Œéƒ½ä¼šæ–°å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä½†æ˜¯å§‹ç»ˆåªæœ‰ä¸€ä¸ª<code>IntentService</code>çš„å®ä¾‹<br><img src="https://img-blog.csdnimg.cn/img_convert/96541771928df7750cc6cb645a88ca5b.png"><br>å†™åœ¨æœ€å</p>
<ul>
<li>æŒæ¡ServiceåŸºæœ¬çŸ¥è¯†ç‚¹å’Œä½¿ç”¨ğŸ˜€</li>
<li>ç»§ç»­æ¢ç´¢Serviceå…¶ä»–åŠŸèƒ½ğŸ’ª</li>
<li>æœ¬ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨çš„è¯ï¼Œè®°å¾—ç‚¹ä¸ªèµğŸ‘</li>
<li>å¯¹æœ¬ç¯‡æ–‡ç« æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºæŒ‡å‡ºğŸ’–</li>
</ul>
]]></content>
      <categories>
        <category>å®‰å“</category>
      </categories>
      <tags>
        <tag>Androidç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¿‡Handlerå®ç°è‡ªåŠ¨æ·»åŠ HelloChartsæ•°æ®å’Œè‡ªåŠ¨è·³è½¬Fragment</title>
    <url>/2021/05/03/%E9%80%9A%E8%BF%87Handler%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0HelloCharts%E6%95%B0%E6%8D%AE%E5%92%8C%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BD%ACFragment/</url>
    <content><![CDATA[<p>å†™åœ¨å‰é¢</p>
<p><strong>ç”±äºæœ¬äººåˆå­¦é˜¶æ®µï¼Œå†™è¿™ç¯‡åšå®¢æ˜¯æ€»ç»“æ‰€å­¦çš„çŸ¥è¯†ç‚¹ï¼Œä¸ºåé¢çš„è¿›é˜¶æ‰“å¥½åŸºç¡€</strong></p>
<p><strong>æœ‰ä»»ä½•å…³äºä»£ç å’Œè¡¨è¿°é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºæŒ‡å‡º</strong></p>
<p>æ¥¼ä¸»æœ€è¿‘è€å¸ˆè¦æ±‚åšä¸‰ä¸ª<code>Fragment</code>åœ¨ä¸€ä¸ª<code>MainActivity</code>ä¸­å®ç°è‡ªåŠ¨è·³è½¬ï¼Œæ¯ä¸ª<code>Fragment</code>ä¸­ä½¿ç”¨æµè¡Œçš„å›¾è¡¨å¼€æºAPI<code>HelloCharts</code>ï¼Œæ¯ä¸ª<code>HelloCharts</code>éƒ½è¦è‡ªåŠ¨æ·»åŠ æ•°æ®ï¼Œå¹¶æ˜¾ç¤ºå½“å‰çš„æ¸©åº¦ï¼Œæ¹¿åº¦æˆ–PMå€¼ï¼</p>
<p>ä¸‰ä¸ª<code>Fragment</code>åˆ†åˆ«æ˜¯</p>
<ul>
<li>æ¸©åº¦æ›²çº¿å›¾</li>
<li>æ¹¿åº¦æ›²çº¿å›¾</li>
<li>PMå€¼æ›²çº¿å›¾</li>
</ul>
<p><strong>æ³¨æ„ï¼šæ¥¼ä¸»æ‰€ç”¨IDEæ˜¯<code>Eclipse</code> ,<code>API21</code> ï¼Œè™šæ‹Ÿæœºå±å¹•å¤§å°ä¸º<code>1280dp*720dp</code></strong></p>
<p><strong><code>HelloChartséœ€è¦å¯¼å…¥jaråŒ…</code>ï¼Œä¸‹è½½é€”å¾„å¤§å®¶è‡ªå·±å¯ä»¥å»æ‰¾</strong></p>
<p><strong>æ‰€ç”¨åˆ°çš„é¢œè‰²éƒ½å¯ä»¥åœ¨<a href="https://bbs.bianzhirensheng.com/color01.html?qq-pf-to=pcqq.group">é¢œè‰²å¯¹ç…§è¡¨</a>ä¸­å‚è€ƒåˆ°</strong></p>
<p>è¯ä¸å¤šè¯´å¼€å§‹ä¸Šä»£ç </p>
<h2 id="1-ç•Œé¢å¸ƒå±€"><a href="#1-ç•Œé¢å¸ƒå±€" class="headerlink" title="1. ç•Œé¢å¸ƒå±€"></a>1. ç•Œé¢å¸ƒå±€</h2><p><strong>activity_main.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.zhuang.hellocharts.MainActivity&quot;</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:orientation=&quot;vertical&quot; &gt;</span><br><span class="line"></span><br><span class="line">        &lt;FrameLayout</span><br><span class="line">            android:id=&quot;@+id/frameLayout&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:layout_weight=&quot;1&quot; &gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>fragment_humidity.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#90d7ec&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.zhuang.hellocharts.HumidityFragment&quot;</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:id=&quot;@+id/linearLayout1&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot; &gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/textView2&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;35dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;10dp&quot;</span><br><span class="line">            android:drawableLeft=&quot;@drawable/humidity_off&quot;</span><br><span class="line">            android:text=&quot;Humidityå®æ—¶æ¹¿åº¦æ•°æ®æ›²çº¿å›¾&quot;</span><br><span class="line">            android:textColor=&quot;#ed1941&quot;</span><br><span class="line">            android:textSize=&quot;25sp&quot;</span><br><span class="line">            android:textStyle=&quot;bold&quot; /&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;lecho.lib.hellocharts.view.LineChartView</span><br><span class="line">        android:id=&quot;@+id/humLineChartView&quot;</span><br><span class="line">        android:layout_width=&quot;900dp&quot;</span><br><span class="line">        android:layout_height=&quot;500dp&quot;</span><br><span class="line">        android:layout_centerHorizontal=&quot;true&quot;</span><br><span class="line">        android:layout_marginTop=&quot;50dp&quot;</span><br><span class="line">        android:background=&quot;#fab27b&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/textViewhum&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_alignBottom=&quot;@+id/linearLayout1&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;272dp&quot;</span><br><span class="line">        android:layout_toRightOf=&quot;@+id/linearLayout1&quot;</span><br><span class="line">        android:text=&quot;TextView&quot;</span><br><span class="line">        android:textColor=&quot;#ed1941&quot;</span><br><span class="line">        android:textSize=&quot;16sp&quot;</span><br><span class="line">        android:textStyle=&quot;bold&quot; /&gt;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>fragment_pm.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#ffe600&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.zhuang.hellocharts.PMFragment&quot;</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:id=&quot;@+id/linearLayout1&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot; &gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/textView2&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;35dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;10dp&quot;</span><br><span class="line">            android:drawableLeft=&quot;@drawable/pm_off&quot;</span><br><span class="line">            android:text=&quot;PM2.5å®æ—¶PMæ•°æ®æ›²çº¿å›¾&quot;</span><br><span class="line">            android:textColor=&quot;#ed1941&quot;</span><br><span class="line">            android:textSize=&quot;20sp&quot;</span><br><span class="line">            android:textStyle=&quot;bold&quot; /&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;lecho.lib.hellocharts.view.LineChartView</span><br><span class="line">        android:id=&quot;@+id/pmLineChartView&quot;</span><br><span class="line">        android:layout_width=&quot;900dp&quot;</span><br><span class="line">        android:layout_height=&quot;500dp&quot;</span><br><span class="line">        android:layout_centerHorizontal=&quot;true&quot;</span><br><span class="line">        android:layout_marginTop=&quot;50dp&quot;</span><br><span class="line">        android:background=&quot;#411445&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/textViewpm&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_alignBottom=&quot;@+id/linearLayout1&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;272dp&quot;</span><br><span class="line">        android:layout_toRightOf=&quot;@+id/linearLayout1&quot;</span><br><span class="line">        android:text=&quot;TextView&quot;</span><br><span class="line">        android:textColor=&quot;#ed1941&quot;</span><br><span class="line">        android:textSize=&quot;16sp&quot;</span><br><span class="line">        android:textStyle=&quot;bold&quot; /&gt;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>fragment_temperature.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#444693&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.zhuang.hellocharts.TemperatureFragment&quot;</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot; &gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/textView2&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;35dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;10dp&quot;</span><br><span class="line">            android:layout_weight=&quot;1&quot;</span><br><span class="line">            android:drawableLeft=&quot;@drawable/temp_off&quot;</span><br><span class="line">            android:text=&quot;Temperatureå®æ—¶æ¸©åº¦æ•°æ®æ›²çº¿å›¾&quot;</span><br><span class="line">            android:textColor=&quot;#ed1941&quot;</span><br><span class="line">            android:textSize=&quot;18sp&quot;</span><br><span class="line">            android:textStyle=&quot;bold&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/textView3&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;310dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;10dp&quot;</span><br><span class="line">            android:layout_weight=&quot;1&quot;</span><br><span class="line">            android:text=&quot;æ¸©åº¦&quot;</span><br><span class="line">            android:textColor=&quot;#ed1941&quot;</span><br><span class="line">            android:textSize=&quot;16sp&quot;</span><br><span class="line">            android:textStyle=&quot;bold&quot; /&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;lecho.lib.hellocharts.view.LineChartView</span><br><span class="line">        android:id=&quot;@+id/tempLineChartView&quot;</span><br><span class="line">        android:layout_width=&quot;900dp&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:layout_centerHorizontal=&quot;true&quot;</span><br><span class="line">        android:layout_marginTop=&quot;50dp&quot;</span><br><span class="line">        android:background=&quot;#b4532a&quot; /&gt;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-Activityå®ç°åŠŸèƒ½"><a href="#2-Activityå®ç°åŠŸèƒ½" class="headerlink" title="2. Activityå®ç°åŠŸèƒ½"></a>2. Activityå®ç°åŠŸèƒ½</h2><p><strong>MainActivity</strong></p>
<ul>
<li><p>åˆå§‹åŒ–<code>Fragment</code></p>
</li>
<li><p>è¿™ä¸ªç•Œé¢å°†<code>Fragment</code>æ·»åŠ åˆ°<code>FrameLayout</code>ä¸­</p>
</li>
<li><p>å®ç°é€šè¿‡<code>Handler</code>å’Œ<code>Thread</code>å®ç°ç•Œé¢çš„è‡ªåŠ¨åˆ‡æ¢ï¼ŒåŠ å‡ ä¸ªifåˆ¤æ–­å³å¯ï¼Œæƒ³è¦è‡ªåŠ¨ï¼Œ<code>Handler</code>å¯ä¸èƒ½å°‘</p>
</li>
<li><p><code>Handler</code>å‘æ¶ˆæ¯ï¼Œæ ¹æ®æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ˜¾ç¤ºæŒ‡å®šçš„<code>Fragment</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.hellocharts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.czie.assessment.R;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.app.FragmentManager;</span><br><span class="line"><span class="keyword">import</span> android.app.FragmentTransaction;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	TextView tempTextView, humTextView, pmTextView;</span><br><span class="line">	<span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">	TemperatureFragment temperatureFragment;</span><br><span class="line">	HumidityFragment humidityFragment;</span><br><span class="line">	PMFragment pmFragment;</span><br><span class="line">	FragmentManager fragmentManager = getFragmentManager();</span><br><span class="line">	Fragment curFragment;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">		setContentView(R.layout.activity_main);</span><br><span class="line">		initFragment();</span><br><span class="line">		showDifferentCharts();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å°†Fragmentæ·»åŠ åˆ°æŒ‡å®šå¸ƒå±€</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initFragment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		temperatureFragment = <span class="keyword">new</span> TemperatureFragment();</span><br><span class="line">		humidityFragment = <span class="keyword">new</span> HumidityFragment();</span><br><span class="line">		pmFragment = <span class="keyword">new</span> PMFragment();</span><br><span class="line"></span><br><span class="line">		FragmentTransaction transaction = fragmentManager.beginTransaction();</span><br><span class="line">		transaction.add(R.id.frameLayout, temperatureFragment);</span><br><span class="line">		transaction.add(R.id.frameLayout, humidityFragment);</span><br><span class="line">		transaction.add(R.id.frameLayout, pmFragment);</span><br><span class="line">		showFragment(temperatureFragment);</span><br><span class="line">		transaction.commit();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showFragment</span><span class="params">(Fragment fragment)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (curFragment == fragment) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		FragmentTransaction transaction = fragmentManager.beginTransaction();</span><br><span class="line">		transaction.hide(temperatureFragment);</span><br><span class="line">		transaction.hide(humidityFragment);</span><br><span class="line">		transaction.hide(pmFragment);</span><br><span class="line">		transaction.show(fragment);</span><br><span class="line">		transaction.commit();</span><br><span class="line">		curFragment = fragment;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Handler handler = <span class="keyword">new</span> Handler() &#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">switch</span> (msg.what) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">				showFragment(temperatureFragment);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				showFragment(humidityFragment);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">				showFragment(pmFragment);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ¥å›åˆ‡æ¢</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showDifferentCharts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Thread() &#123;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">					<span class="keyword">if</span> (count == <span class="number">4</span>) &#123;</span><br><span class="line">						count = <span class="number">0</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						sleep(<span class="number">5000</span>);</span><br><span class="line">						handler.sendEmptyMessage(count);</span><br><span class="line">					&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">					count++;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;.start();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-å®ç°å›¾è¡¨è‡ªåŠ¨æ·»åŠ æ•°æ®"><a href="#3-å®ç°å›¾è¡¨è‡ªåŠ¨æ·»åŠ æ•°æ®" class="headerlink" title="3. å®ç°å›¾è¡¨è‡ªåŠ¨æ·»åŠ æ•°æ®"></a>3. å®ç°å›¾è¡¨è‡ªåŠ¨æ·»åŠ æ•°æ®</h2><ul>
<li><p><code>HelloCharts</code>æœ‰å…³æ–¹æ³•å‚è€ƒä¸‹åˆ—ä»£ç æ³¨é‡Šï¼Œå¾ˆè¯¦ç»†</p>
</li>
<li><p>é¦–å…ˆè‚¯å®šä¸ç”¨æƒ³ï¼Œè‚¯å®šç”¨<code>Handler</code>å’Œ<code>Thread</code>æ¥å®ç°è‡ªåŠ¨æ·»åŠ æ•°æ®</p>
</li>
<li><p>ç”¨åˆ°é›†åˆå’Œæ•°ç»„ç”¨æ¥å­˜æ”¾æ•°æ®</p>
</li>
</ul>
<p><strong>åˆ†æä¸‹å…³é”®ä»£ç  ä»¥ä¸€ä¸ªFragmentä¸ºä¾‹ï¼Œå…¶ä½™éƒ½ä¸€æ ·å‚è€ƒå³å¯</strong></p>
<ul>
<li><strong>è¯¥æ–¹æ³•å°±å¯ä»¥æ˜¯Xè½´ä¸Šçš„æ•°æ®æ˜¯ä»¥æ—¶é—´é€šè¿‡å¤„ç†æ˜¾ç¤ºï¼Œä¸ä¼šé‡å¤</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> String[] getXData(<span class="keyword">int</span> historysecond) &#123;</span><br><span class="line">		String historyDates[] = <span class="keyword">new</span> String[historysecond];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; historysecond; i++) &#123;</span><br><span class="line">			<span class="comment">// è·å–æ—¶é—´</span></span><br><span class="line">			Calendar calendar = Calendar.getInstance();</span><br><span class="line">			<span class="comment">// è·å–ç§’æ•°</span></span><br><span class="line">			<span class="keyword">int</span> second = calendar.get(calendar.SECOND);</span><br><span class="line">			<span class="comment">// è·å–åˆ†é’Ÿ</span></span><br><span class="line">			<span class="keyword">int</span> mins = calendar.get(calendar.MINUTE);</span><br><span class="line">			historyDates[i] = String.format(<span class="string">&quot;%02d&quot;</span>, mins) + <span class="string">&quot;:&quot;</span></span><br><span class="line">					+ String.format(<span class="string">&quot;%02d&quot;</span>, second);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> historyDates;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>è¯¥æ–¹æ³•å°±æ˜¯å¯ä»¥ä¸€ç›´æ˜¾ç¤ºå½“å‰çš„æ¸©åº¦ï¼Œå’Œä¿è¯é›†åˆçš„ä¸ªæ•°ä¸ä¼šè¶…è¿‡7</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readSensorData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Thread() &#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">super</span>.run();</span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; valus.length; i++) &#123;</span><br><span class="line">						<span class="keyword">if</span> (flag != <span class="number">0</span>) &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125;</span><br><span class="line">						axisTimeValues = getXData(<span class="number">8</span>);</span><br><span class="line">						sensorPointValuesList.add(valus[i]);</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (sensorPointValuesList.size() &gt; <span class="number">7</span>) &#123;</span><br><span class="line">							sensorPointValuesList.remove(<span class="number">0</span>);</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="comment">// sensorPointValuesList.add(valus[i]);</span></span><br><span class="line">						handler.sendEmptyMessage(<span class="number">0</span>);</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;.start();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>åœ¨<code>Handler</code>é‡Œè°ƒç”¨è¯¥æ–¹æ³•ï¼Œæ¯æ¬¡æ˜¾ç¤ºå®Œæ•°æ®åï¼Œå°±è¦æ¸…ç©ºä¸€æ¬¡Xè½´å’ŒYè½´çš„æ•°æ®ï¼Œä¸æ–­å¾€é›†åˆé‡Œæ·»åŠ æ•°æ®</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showCharts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		mAxisValues.clear();</span><br><span class="line">		mPointValues.clear();</span><br><span class="line">		getAxisPoints();</span><br><span class="line">		getAxisXLables();</span><br><span class="line">		initLineChart(<span class="string">&quot;æ—¶é—´&quot;</span>, <span class="string">&quot;æ¹¿åº¦&quot;</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HumidityFragment</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.hellocharts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.czie.assessment.R;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.gesture.ContainerScrollType;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.gesture.ZoomType;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Axis;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.AxisValue;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Line;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.LineChartData;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.PointValue;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.ValueShape;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Viewport;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.view.LineChartView;</span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HumidityFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> LineChartView lineChart;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// xè½´</span></span><br><span class="line">	String axisTimeValues[] = <span class="keyword">new</span> String[<span class="number">7</span>];</span><br><span class="line">	<span class="comment">// yè½´</span></span><br><span class="line">	List&lt;Integer&gt; sensorPointValuesList = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">	<span class="keyword">int</span>[] valus = &#123; <span class="number">10</span>, <span class="number">15</span>, <span class="number">25</span>, <span class="number">20</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">private</span> TextView textViewhum;</span><br><span class="line">	<span class="keyword">private</span> List&lt;PointValue&gt; mPointValues = <span class="keyword">new</span> ArrayList&lt;PointValue&gt;();</span><br><span class="line">	<span class="comment">// å­˜æ”¾xåæ ‡è½´ä¸Šçš„æ•°æ®çš„é›†åˆ</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;AxisValue&gt; mAxisValues = <span class="keyword">new</span> ArrayList&lt;AxisValue&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span></span><br><span class="line"><span class="function"><span class="params">			Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> inflater.inflate(R.layout.fragment_humidity, container, <span class="keyword">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">		lineChart = (LineChartView) getActivity().findViewById(</span><br><span class="line">				R.id.humLineChartView);</span><br><span class="line">		textViewhum = (TextView) getActivity().findViewById(R.id.textViewhum);</span><br><span class="line">		readSensorData();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readSensorData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Thread() &#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">super</span>.run();</span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; valus.length; i++) &#123;</span><br><span class="line">						<span class="keyword">if</span> (flag != <span class="number">0</span>) &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125;</span><br><span class="line">						axisTimeValues = getXData(<span class="number">8</span>);</span><br><span class="line">						sensorPointValuesList.add(valus[i]);</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (sensorPointValuesList.size() &gt; <span class="number">7</span>) &#123;</span><br><span class="line">							sensorPointValuesList.remove(<span class="number">0</span>);</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="comment">// sensorPointValuesList.add(valus[i]);</span></span><br><span class="line">						handler.sendEmptyMessage(<span class="number">0</span>);</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;.start();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// xæ•°æ®çš„è·å–</span></span><br><span class="line">	<span class="keyword">public</span> String[] getXData(<span class="keyword">int</span> historysecond) &#123;</span><br><span class="line">		String historyDates[] = <span class="keyword">new</span> String[historysecond];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; historysecond; i++) &#123;</span><br><span class="line">			<span class="comment">// è·å–æ—¶é—´</span></span><br><span class="line">			Calendar calendar = Calendar.getInstance();</span><br><span class="line">			<span class="comment">// è·å–ç§’æ•°</span></span><br><span class="line">			<span class="keyword">int</span> second = calendar.get(calendar.SECOND);</span><br><span class="line">			<span class="comment">// è·å–åˆ†é’Ÿ</span></span><br><span class="line">			<span class="keyword">int</span> mins = calendar.get(calendar.MINUTE);</span><br><span class="line">			historyDates[i] = String.format(<span class="string">&quot;%02d&quot;</span>, mins) + <span class="string">&quot;:&quot;</span></span><br><span class="line">					+ String.format(<span class="string">&quot;%02d&quot;</span>, second);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> historyDates;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Handler handler = <span class="keyword">new</span> Handler() &#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">			showCharts();</span><br><span class="line">			textViewhum.setText(<span class="string">&quot;å½“å‰æ¹¿åº¦:&quot;</span> + flag + <span class="string">&quot;RH%&quot;</span>);</span><br><span class="line"></span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showCharts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		mAxisValues.clear();</span><br><span class="line">		mPointValues.clear();</span><br><span class="line">		getAxisPoints();</span><br><span class="line">		getAxisXLables();</span><br><span class="line">		initLineChart(<span class="string">&quot;æ—¶é—´&quot;</span>, <span class="string">&quot;æ¹¿åº¦&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initLineChart</span><span class="params">(String xName, String yName)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Line line = <span class="keyword">new</span> Line(mPointValues)</span><br><span class="line">				.setColor(Color.parseColor(<span class="string">&quot;#ef5b9c&quot;</span>)); <span class="comment">// æŠ˜çº¿çš„é¢œè‰²ï¼ˆæ©™è‰²ï¼‰</span></span><br><span class="line">		List&lt;Line&gt; lines = <span class="keyword">new</span> ArrayList&lt;Line&gt;();</span><br><span class="line">		line.setShape(ValueShape.DIAMOND); <span class="comment">// æŠ˜çº¿å›¾ä¸Šæ¯ä¸ªæ•°æ®çš„å½¢çŠ¶</span></span><br><span class="line">		line.setCubic(<span class="keyword">true</span>); <span class="comment">// æ›²çº¿æ˜¯å¦å¹³æ»‘ï¼Œå³æ˜¯æ›²çº¿è¿˜æ˜¯æŠ˜çº¿</span></span><br><span class="line">		line.setFilled(<span class="keyword">false</span>); <span class="comment">// æ˜¯å¦å¡«å……æ›²çº¿çš„é¢ç§¯</span></span><br><span class="line">		line.setHasLabels(<span class="keyword">true</span>); <span class="comment">// æ›²çº¿çš„æ•°æ®åæ ‡æ˜¯å¦åŠ ä¸Šå¤‡æ³¨</span></span><br><span class="line">		line.setHasLines(<span class="keyword">true</span>); <span class="comment">// æ˜¯å¦ç”¨çº¿æ˜¾ç¤º</span></span><br><span class="line">		line.setHasPoints(<span class="keyword">true</span>); <span class="comment">// æ˜¯å¦æ˜¾ç¤ºåœ†ç‚¹</span></span><br><span class="line">		lines.add(line);</span><br><span class="line">		LineChartData data = <span class="keyword">new</span> LineChartData();</span><br><span class="line">		data.setLines(lines);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åæ ‡è½´</span></span><br><span class="line">		Axis axisX = <span class="keyword">new</span> Axis(); <span class="comment">// xè½´</span></span><br><span class="line">		axisX.setName(xName);</span><br><span class="line">		axisX.setHasTiltedLabels(<span class="keyword">true</span>); <span class="comment">// xè½´å­—ä½“æ˜¯æ–œè¿˜æ˜¯ç›´</span></span><br><span class="line">		axisX.setTextColor(Color.WHITE); <span class="comment">// å­—ä½“é¢œè‰²</span></span><br><span class="line">		axisX.setTextSize(<span class="number">10</span>); <span class="comment">// å­—ä½“å¤§å°</span></span><br><span class="line">		axisX.setMaxLabelChars(<span class="number">10</span>); <span class="comment">// æœ€å¤šå‡ ä¸ªxè½´åæ ‡</span></span><br><span class="line">		axisX.setValues(mAxisValues); <span class="comment">// å¡«å……xè½´çš„åæ ‡åç§°</span></span><br><span class="line">		data.setAxisXBottom(axisX); <span class="comment">// xè½´åœ¨åº•éƒ¨</span></span><br><span class="line">		axisX.setHasLines(<span class="keyword">true</span>); <span class="comment">// xè½´åˆ†å‰²çº¿</span></span><br><span class="line"></span><br><span class="line">		Axis axisY = <span class="keyword">new</span> Axis(); <span class="comment">// yè½´</span></span><br><span class="line">		axisY.setName(yName); <span class="comment">// yè½´æ ‡æ³¨</span></span><br><span class="line">		axisY.setTextSize(<span class="number">10</span>);</span><br><span class="line">		data.setAxisYLeft(axisY); <span class="comment">// yè½´åœ¨å·¦è¾¹</span></span><br><span class="line">		<span class="comment">// è®¾ç½®è¡Œä¸ºå±æ€§ï¼Œæ”¯æŒç¼©æ”¾ã€æ»‘åŠ¨å’Œå¹³ç§»</span></span><br><span class="line">		lineChart.setInteractive(<span class="keyword">true</span>);</span><br><span class="line">		lineChart.setZoomType(ZoomType.HORIZONTAL);</span><br><span class="line">		lineChart.setMaxZoom((<span class="keyword">float</span>) <span class="number">2</span>); <span class="comment">// æœ€å¤§æ–¹æ³•æ¯”ä¾‹</span></span><br><span class="line">		lineChart.setContainerScrollEnabled(<span class="keyword">true</span>,</span><br><span class="line">				ContainerScrollType.HORIZONTAL);</span><br><span class="line">		lineChart.setLineChartData(data);</span><br><span class="line">		lineChart.setVisibility(View.VISIBLE);</span><br><span class="line">		Viewport v = <span class="keyword">new</span> Viewport(lineChart.getMaximumViewport());</span><br><span class="line">		<span class="comment">// yè½´æœ€é«˜å€¼</span></span><br><span class="line">		v.top = <span class="number">100</span>;</span><br><span class="line">		<span class="comment">// yè½´æœ€ä½å€¼</span></span><br><span class="line">		v.bottom = <span class="number">0</span>;</span><br><span class="line">		lineChart.setMaximumViewport(v);</span><br><span class="line">		v.left = <span class="number">0</span>;</span><br><span class="line">		v.right = <span class="number">7</span>;</span><br><span class="line">		lineChart.setCurrentViewport(v);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAxisXLables</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; axisTimeValues.length; i++) &#123;</span><br><span class="line">			mAxisValues.add(<span class="keyword">new</span> AxisValue(i).setLabel(axisTimeValues[i]));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAxisPoints</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sensorPointValuesList.size(); i++) &#123;</span><br><span class="line">			mPointValues.add(<span class="keyword">new</span> PointValue(i, sensorPointValuesList.get(i)));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>PMFragment</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.hellocharts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.czie.assessment.R;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.gesture.ContainerScrollType;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.gesture.ZoomType;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Axis;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.AxisValue;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Line;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.LineChartData;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.PointValue;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.ValueShape;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Viewport;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.view.LineChartView;</span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PMFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> LineChartView lineChart;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// xè½´</span></span><br><span class="line">	String axisTimeValues[] = <span class="keyword">new</span> String[<span class="number">7</span>];</span><br><span class="line">	<span class="comment">// yè½´</span></span><br><span class="line">	List&lt;Integer&gt; sensorPointValuesList = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">	<span class="keyword">int</span>[] valus = &#123; <span class="number">20</span>, <span class="number">45</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">60</span>, <span class="number">24</span>, <span class="number">36</span> &#125;;</span><br><span class="line">	<span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">private</span> TextView textViewpm;</span><br><span class="line">	<span class="keyword">private</span> List&lt;PointValue&gt; mPointValues = <span class="keyword">new</span> ArrayList&lt;PointValue&gt;();</span><br><span class="line">	<span class="comment">// å­˜æ”¾xåæ ‡è½´ä¸Šçš„æ•°æ®çš„é›†åˆ</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;AxisValue&gt; mAxisValues = <span class="keyword">new</span> ArrayList&lt;AxisValue&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span></span><br><span class="line"><span class="function"><span class="params">			Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> inflater.inflate(R.layout.fragment_pm, container, <span class="keyword">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">		lineChart = (LineChartView) getActivity().findViewById(</span><br><span class="line">				R.id.pmLineChartView);</span><br><span class="line">		textViewpm = (TextView) getActivity().findViewById(R.id.textViewpm);</span><br><span class="line">		readSensorData();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readSensorData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Thread() &#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">super</span>.run();</span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; valus.length; i++) &#123;</span><br><span class="line">						<span class="keyword">if</span> (flag != <span class="number">0</span>) &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125;</span><br><span class="line">						axisTimeValues = getXData(<span class="number">8</span>);</span><br><span class="line">						sensorPointValuesList.add(valus[i]);</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (sensorPointValuesList.size() &gt; <span class="number">7</span>) &#123;</span><br><span class="line">							sensorPointValuesList.remove(<span class="number">0</span>);</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="comment">// sensorPointValuesList.add(valus[i]);</span></span><br><span class="line">						handler.sendEmptyMessage(<span class="number">0</span>);</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;.start();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// xæ•°æ®çš„è·å–</span></span><br><span class="line">	<span class="keyword">public</span> String[] getXData(<span class="keyword">int</span> historysecond) &#123;</span><br><span class="line">		String historyDates[] = <span class="keyword">new</span> String[historysecond];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; historysecond; i++) &#123;</span><br><span class="line">			<span class="comment">// è·å–æ—¶é—´</span></span><br><span class="line">			Calendar calendar = Calendar.getInstance();</span><br><span class="line">			<span class="comment">// è·å–ç§’æ•°</span></span><br><span class="line">			<span class="keyword">int</span> second = calendar.get(calendar.SECOND);</span><br><span class="line">			<span class="comment">// è·å–åˆ†é’Ÿ</span></span><br><span class="line">			<span class="keyword">int</span> mins = calendar.get(calendar.MINUTE);</span><br><span class="line">			historyDates[i] = String.format(<span class="string">&quot;%02d&quot;</span>, mins) + <span class="string">&quot;:&quot;</span></span><br><span class="line">					+ String.format(<span class="string">&quot;%02d&quot;</span>, second);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> historyDates;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Handler handler = <span class="keyword">new</span> Handler() &#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">			showCharts();</span><br><span class="line">			textViewpm.setText(<span class="string">&quot;å½“å‰PMå€¼:&quot;</span> + flag + <span class="string">&quot;ug/m3&quot;</span>);</span><br><span class="line"></span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showCharts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		mAxisValues.clear();</span><br><span class="line">		mPointValues.clear();</span><br><span class="line">		getAxisPoints();</span><br><span class="line">		getAxisXLables();</span><br><span class="line">		initLineChart(<span class="string">&quot;æ—¶é—´&quot;</span>, <span class="string">&quot;PM&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initLineChart</span><span class="params">(String xName, String yName)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Line line = <span class="keyword">new</span> Line(mPointValues)</span><br><span class="line">				.setColor(Color.parseColor(<span class="string">&quot;#6d8346&quot;</span>)); <span class="comment">// æŠ˜çº¿çš„é¢œè‰²ï¼ˆæ©™è‰²ï¼‰</span></span><br><span class="line">		List&lt;Line&gt; lines = <span class="keyword">new</span> ArrayList&lt;Line&gt;();</span><br><span class="line">		line.setShape(ValueShape.CIRCLE); <span class="comment">// æŠ˜çº¿å›¾ä¸Šæ¯ä¸ªæ•°æ®çš„å½¢çŠ¶</span></span><br><span class="line">		line.setCubic(<span class="keyword">true</span>); <span class="comment">// æ›²çº¿æ˜¯å¦å¹³æ»‘ï¼Œå³æ˜¯æ›²çº¿è¿˜æ˜¯æŠ˜çº¿</span></span><br><span class="line">		line.setFilled(<span class="keyword">false</span>); <span class="comment">// æ˜¯å¦å¡«å……æ›²çº¿çš„é¢ç§¯</span></span><br><span class="line">		line.setHasLabels(<span class="keyword">true</span>); <span class="comment">// æ›²çº¿çš„æ•°æ®åæ ‡æ˜¯å¦åŠ ä¸Šå¤‡æ³¨</span></span><br><span class="line">		line.setHasLines(<span class="keyword">true</span>); <span class="comment">// æ˜¯å¦ç”¨çº¿æ˜¾ç¤º</span></span><br><span class="line">		line.setHasPoints(<span class="keyword">true</span>); <span class="comment">// æ˜¯å¦æ˜¾ç¤ºåœ†ç‚¹</span></span><br><span class="line">		lines.add(line);</span><br><span class="line">		LineChartData data = <span class="keyword">new</span> LineChartData();</span><br><span class="line">		data.setLines(lines);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åæ ‡è½´</span></span><br><span class="line">		Axis axisX = <span class="keyword">new</span> Axis(); <span class="comment">// xè½´</span></span><br><span class="line">		axisX.setName(xName);</span><br><span class="line">		axisX.setHasTiltedLabels(<span class="keyword">true</span>); <span class="comment">// xè½´å­—ä½“æ˜¯æ–œè¿˜æ˜¯ç›´</span></span><br><span class="line">		axisX.setTextColor(Color.WHITE); <span class="comment">// å­—ä½“é¢œè‰²</span></span><br><span class="line">		axisX.setTextSize(<span class="number">10</span>); <span class="comment">// å­—ä½“å¤§å°</span></span><br><span class="line">		axisX.setMaxLabelChars(<span class="number">10</span>); <span class="comment">// æœ€å¤šå‡ ä¸ªxè½´åæ ‡</span></span><br><span class="line">		axisX.setValues(mAxisValues); <span class="comment">// å¡«å……xè½´çš„åæ ‡åç§°</span></span><br><span class="line">		data.setAxisXBottom(axisX); <span class="comment">// xè½´åœ¨åº•éƒ¨</span></span><br><span class="line">		axisX.setHasLines(<span class="keyword">true</span>); <span class="comment">// xè½´åˆ†å‰²çº¿</span></span><br><span class="line"></span><br><span class="line">		Axis axisY = <span class="keyword">new</span> Axis(); <span class="comment">// yè½´</span></span><br><span class="line">		axisY.setName(yName); <span class="comment">// yè½´æ ‡æ³¨</span></span><br><span class="line">		axisY.setTextSize(<span class="number">10</span>);</span><br><span class="line">		data.setAxisYLeft(axisY); <span class="comment">// yè½´åœ¨å·¦è¾¹</span></span><br><span class="line">		<span class="comment">// è®¾ç½®è¡Œä¸ºå±æ€§ï¼Œæ”¯æŒç¼©æ”¾ã€æ»‘åŠ¨å’Œå¹³ç§»</span></span><br><span class="line">		lineChart.setInteractive(<span class="keyword">true</span>);</span><br><span class="line">		lineChart.setZoomType(ZoomType.HORIZONTAL);</span><br><span class="line">		lineChart.setMaxZoom((<span class="keyword">float</span>) <span class="number">2</span>); <span class="comment">// æœ€å¤§æ–¹æ³•æ¯”ä¾‹</span></span><br><span class="line">		lineChart.setContainerScrollEnabled(<span class="keyword">true</span>,</span><br><span class="line">				ContainerScrollType.HORIZONTAL);</span><br><span class="line">		lineChart.setLineChartData(data);</span><br><span class="line">		lineChart.setVisibility(View.VISIBLE);</span><br><span class="line">		Viewport v = <span class="keyword">new</span> Viewport(lineChart.getMaximumViewport());</span><br><span class="line">		<span class="comment">// yè½´æœ€é«˜å€¼</span></span><br><span class="line">		v.top = <span class="number">100</span>;</span><br><span class="line">		<span class="comment">// yè½´æœ€ä½å€¼</span></span><br><span class="line">		v.bottom = <span class="number">0</span>;</span><br><span class="line">		lineChart.setMaximumViewport(v);</span><br><span class="line">		v.left = <span class="number">0</span>;</span><br><span class="line">		v.right = <span class="number">7</span>;</span><br><span class="line">		lineChart.setCurrentViewport(v);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAxisXLables</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; axisTimeValues.length; i++) &#123;</span><br><span class="line">			mAxisValues.add(<span class="keyword">new</span> AxisValue(i).setLabel(axisTimeValues[i]));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAxisPoints</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sensorPointValuesList.size(); i++) &#123;</span><br><span class="line">			mPointValues.add(<span class="keyword">new</span> PointValue(i, sensorPointValuesList.get(i)));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>TemperatureFragment</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.hellocharts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.czie.assessment.R;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.gesture.ContainerScrollType;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.gesture.ZoomType;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Axis;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.AxisValue;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Line;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.LineChartData;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.PointValue;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.ValueShape;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.model.Viewport;</span><br><span class="line"><span class="keyword">import</span> lecho.lib.hellocharts.view.LineChartView;</span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TemperatureFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> LineChartView lineChart;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// xè½´</span></span><br><span class="line">	String axisTimeValues[] = <span class="keyword">new</span> String[<span class="number">7</span>];</span><br><span class="line">	<span class="comment">// yè½´</span></span><br><span class="line">	List&lt;Integer&gt; sensorPointValuesList = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">	<span class="keyword">int</span>[] valus = &#123; <span class="number">50</span>, <span class="number">27</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">27</span>, <span class="number">45</span>, <span class="number">78</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> List&lt;PointValue&gt; mPointValues = <span class="keyword">new</span> ArrayList&lt;PointValue&gt;();</span><br><span class="line">	<span class="comment">// å­˜æ”¾xåæ ‡è½´ä¸Šçš„æ•°æ®çš„é›†åˆ</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;AxisValue&gt; mAxisValues = <span class="keyword">new</span> ArrayList&lt;AxisValue&gt;();</span><br><span class="line">	<span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">private</span> TextView textView3;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span></span><br><span class="line"><span class="function"><span class="params">			Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> inflater</span><br><span class="line">				.inflate(R.layout.fragment_temperature, container, <span class="keyword">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">		lineChart = (LineChartView) getActivity().findViewById(</span><br><span class="line">				R.id.tempLineChartView);</span><br><span class="line">		textView3 = (TextView) getActivity().findViewById(R.id.textView3);</span><br><span class="line">		readSensorData();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readSensorData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Thread() &#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">super</span>.run();</span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; valus.length; i++) &#123;</span><br><span class="line">						<span class="keyword">if</span> (flag != <span class="number">0</span>) &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							flag = valus[i];</span><br><span class="line">						&#125;</span><br><span class="line">						axisTimeValues = getXData(<span class="number">8</span>);</span><br><span class="line">						sensorPointValuesList.add(valus[i]);</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (sensorPointValuesList.size() &gt; <span class="number">7</span>) &#123;</span><br><span class="line">							sensorPointValuesList.remove(<span class="number">0</span>);</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="comment">// sensorPointValuesList.add(valus[i]);</span></span><br><span class="line"></span><br><span class="line">						handler.sendEmptyMessage(<span class="number">0</span>);</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;.start();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// xæ•°æ®çš„è·å–</span></span><br><span class="line">	<span class="keyword">public</span> String[] getXData(<span class="keyword">int</span> historysecond) &#123;</span><br><span class="line">		String historyDates[] = <span class="keyword">new</span> String[historysecond];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; historysecond; i++) &#123;</span><br><span class="line">			<span class="comment">// è·å–æ—¶é—´</span></span><br><span class="line">			Calendar calendar = Calendar.getInstance();</span><br><span class="line">			<span class="comment">// è·å–ç§’æ•°</span></span><br><span class="line">			<span class="keyword">int</span> second = calendar.get(calendar.SECOND);</span><br><span class="line">			<span class="comment">// è·å–åˆ†é’Ÿ</span></span><br><span class="line">			<span class="keyword">int</span> mins = calendar.get(calendar.MINUTE);</span><br><span class="line">			historyDates[i] = String.format(<span class="string">&quot;%02d&quot;</span>, mins) + <span class="string">&quot;:&quot;</span></span><br><span class="line">					+ String.format(<span class="string">&quot;%02d&quot;</span>, second);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> historyDates;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Handler handler = <span class="keyword">new</span> Handler() &#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">			showCharts();</span><br><span class="line">			textView3.setText(<span class="string">&quot;å½“å‰æ¸©åº¦:&quot;</span> + flag + <span class="string">&quot;â„ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showCharts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		mAxisValues.clear();</span><br><span class="line">		mPointValues.clear();</span><br><span class="line">		getAxisPoints();</span><br><span class="line">		getAxisXLables();</span><br><span class="line">		initLineChart(<span class="string">&quot;æ—¶é—´&quot;</span>, <span class="string">&quot;æ¸©åº¦&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initLineChart</span><span class="params">(String xName, String yName)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Line line = <span class="keyword">new</span> Line(mPointValues)</span><br><span class="line">				.setColor(Color.parseColor(<span class="string">&quot;#d71345&quot;</span>)); <span class="comment">// æŠ˜çº¿çš„é¢œè‰²ï¼ˆçº¢è‰²ï¼‰</span></span><br><span class="line">		List&lt;Line&gt; lines = <span class="keyword">new</span> ArrayList&lt;Line&gt;();</span><br><span class="line">		line.setShape(ValueShape.SQUARE); <span class="comment">// æŠ˜çº¿å›¾ä¸Šæ¯ä¸ªæ•°æ®çš„å½¢çŠ¶</span></span><br><span class="line">		line.setCubic(<span class="keyword">true</span>); <span class="comment">// æ›²çº¿æ˜¯å¦å¹³æ»‘ï¼Œå³æ˜¯æ›²çº¿è¿˜æ˜¯æŠ˜çº¿</span></span><br><span class="line">		line.setFilled(<span class="keyword">false</span>); <span class="comment">// æ˜¯å¦å¡«å……æ›²çº¿çš„é¢ç§¯</span></span><br><span class="line">		line.setHasLabels(<span class="keyword">true</span>); <span class="comment">// æ›²çº¿çš„æ•°æ®åæ ‡æ˜¯å¦åŠ ä¸Šå¤‡æ³¨</span></span><br><span class="line">		line.setHasLines(<span class="keyword">true</span>); <span class="comment">// æ˜¯å¦ç”¨çº¿æ˜¾ç¤º</span></span><br><span class="line">		line.setHasPoints(<span class="keyword">true</span>); <span class="comment">// æ˜¯å¦æ˜¾ç¤ºåœ†ç‚¹</span></span><br><span class="line">		lines.add(line);</span><br><span class="line">		LineChartData data = <span class="keyword">new</span> LineChartData();</span><br><span class="line">		data.setLines(lines);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åæ ‡è½´</span></span><br><span class="line">		Axis axisX = <span class="keyword">new</span> Axis(); <span class="comment">// xè½´</span></span><br><span class="line">		axisX.setName(xName);</span><br><span class="line">		axisX.setHasTiltedLabels(<span class="keyword">true</span>); <span class="comment">// xè½´å­—ä½“æ˜¯æ–œè¿˜æ˜¯ç›´</span></span><br><span class="line">		axisX.setTextColor(Color.WHITE); <span class="comment">// å­—ä½“é¢œè‰²</span></span><br><span class="line">		axisX.setTextSize(<span class="number">10</span>); <span class="comment">// å­—ä½“å¤§å°</span></span><br><span class="line">		axisX.setMaxLabelChars(<span class="number">10</span>); <span class="comment">// æœ€å¤šå‡ ä¸ªxè½´åæ ‡</span></span><br><span class="line">		axisX.setValues(mAxisValues); <span class="comment">// å¡«å……xè½´çš„åæ ‡åç§°</span></span><br><span class="line">		data.setAxisXBottom(axisX); <span class="comment">// xè½´åœ¨åº•éƒ¨</span></span><br><span class="line">		axisX.setHasLines(<span class="keyword">true</span>); <span class="comment">// xè½´åˆ†å‰²çº¿</span></span><br><span class="line"></span><br><span class="line">		Axis axisY = <span class="keyword">new</span> Axis(); <span class="comment">// yè½´</span></span><br><span class="line">		axisY.setName(yName); <span class="comment">// yè½´æ ‡æ³¨</span></span><br><span class="line">		axisY.setTextSize(<span class="number">10</span>);</span><br><span class="line">		data.setAxisYLeft(axisY); <span class="comment">// yè½´åœ¨å·¦è¾¹</span></span><br><span class="line">		<span class="comment">// è®¾ç½®è¡Œä¸ºå±æ€§ï¼Œæ”¯æŒç¼©æ”¾ã€æ»‘åŠ¨å’Œå¹³ç§»</span></span><br><span class="line">		lineChart.setInteractive(<span class="keyword">true</span>);</span><br><span class="line">		lineChart.setZoomType(ZoomType.HORIZONTAL);</span><br><span class="line">		lineChart.setMaxZoom((<span class="keyword">float</span>) <span class="number">2</span>); <span class="comment">// æœ€å¤§æ–¹æ³•æ¯”ä¾‹</span></span><br><span class="line">		lineChart.setContainerScrollEnabled(<span class="keyword">true</span>,</span><br><span class="line">				ContainerScrollType.HORIZONTAL);</span><br><span class="line">		lineChart.setLineChartData(data);</span><br><span class="line">		lineChart.setVisibility(View.VISIBLE);</span><br><span class="line">		Viewport v = <span class="keyword">new</span> Viewport(lineChart.getMaximumViewport());</span><br><span class="line">		<span class="comment">// yè½´æœ€é«˜å€¼</span></span><br><span class="line">		v.top = <span class="number">100</span>;</span><br><span class="line">		<span class="comment">// yè½´æœ€ä½å€¼</span></span><br><span class="line">		v.bottom = <span class="number">0</span>;</span><br><span class="line">		lineChart.setMaximumViewport(v);</span><br><span class="line">		v.left = <span class="number">0</span>;</span><br><span class="line">		v.right = <span class="number">7</span>;</span><br><span class="line">		lineChart.setCurrentViewport(v);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAxisXLables</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; axisTimeValues.length; i++) &#123;</span><br><span class="line">			mAxisValues.add(<span class="keyword">new</span> AxisValue(i).setLabel(axisTimeValues[i]));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAxisPoints</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sensorPointValuesList.size(); i++) &#123;</span><br><span class="line">			mPointValues.add(<span class="keyword">new</span> PointValue(i, sensorPointValuesList.get(i)));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æœ€åé€šè¿‡ç®€å•åŠ¨å›¾æ¥çœ‹ä¸‹æ•ˆæœ</strong><br><a href="https://imgtu.com/i/2Ja8eS"><img src="https://img-blog.csdnimg.cn/img_convert/c1e6888749fba3a1e4bd8d0803584273.gif" alt="2Ja8eS.gif"></a><br><strong>æ€»ç»“</strong></p>
<ul>
<li>å¸ƒå±€åšçš„æœ‰ç‚¹ç®€å•ğŸ˜Š,åœ¨å®ç°åŠŸèƒ½çš„åŸºç¡€ä¸Šå†ç¾åŒ–å°±æ›´å¥½äº†</li>
<li>è¿˜æœ‰è®¸å¤šä¸è¶³çš„åœ°æ–¹ä»éœ€åŠªåŠ›ğŸ’ªï¼Œæ¯”å¦‚ä»£ç ä¼˜åŒ–ï¼Œå¯¹<code>Hellocharts</code>ç†Ÿç»ƒè¿ç”¨</li>
</ul>
<p><strong>å†™åœ¨æœ€å</strong></p>
<ul>
<li>æœ‰ä»»ä½•é”™è¯¯æ¬¢è¿è¯„è®ºåŒºæŒ‡å‡ºï¼ŒåŠæ—¶æ”¹æ­£ï¼</li>
</ul>
]]></content>
      <categories>
        <category>å®‰å“</category>
      </categories>
      <tags>
        <tag>Androidç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Android Studioä»¿QQç•Œé¢å®ç°ç®€å•çš„åŠŸèƒ½</title>
    <url>/2021/05/01/Android%20Studio%E4%BB%BFQQ%E7%95%8C%E9%9D%A2%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E5%8A%9F%E8%83%BD/</url>
    <content><![CDATA[<p>å†™åœ¨å‰é¢</p>
<p><strong>ç”±äºæœ¬äººåˆå­¦é˜¶æ®µï¼Œå†™è¿™ç¯‡åšå®¢æ˜¯æ€»ç»“æ‰€å­¦çš„çŸ¥è¯†ç‚¹ï¼Œä¸ºåé¢çš„è¿›é˜¶æ‰“å¥½åŸºç¡€</strong></p>
<p><strong>æœ‰ä»»ä½•å…³äºä»£ç å’Œè¡¨è¿°é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºæŒ‡å‡º</strong></p>
<p>æ¥¼ä¸»è¿‘æœŸåœ¨å­¦ä¹ å…³äºå®‰å“ä¸­<code>Fragment</code>å’Œ<code>ListView</code>ä¸­çš„çŸ¥è¯†ï¼ŒæŒ‰ç…§è€å¸ˆçš„è¦æ±‚æ¨¡ä»¿ä¸€ä¸‹QQç•Œé¢ è¦æ±‚åŠŸèƒ½</p>
<ul>
<li>æœ‰ç™»å½•ç•Œé¢<ul>
<li>å¯†ç ä¸å¯¹æç¤ºå¯†ç ä¸å¯¹</li>
<li>è´¦å·å¯†ç ä»»ä¸€ä¸ºç©ºæç¤ºç”¨æˆ·ä¸èƒ½ä¸ºç©º</li>
<li>ç™»å½•æˆåŠŸæç¤ºç™»å½•æˆåŠŸ</li>
<li>å¯ä»¥å®ç°è´¦å·å¯†ç è®°ä½åŠŸèƒ½</li>
</ul>
</li>
<li>æœ‰ä¸‰ä¸ªç•Œé¢å¯ä»¥ç‚¹å‡»åº•éƒ¨æŒ‰é’®å®ç°é¡µé¢çš„åˆ‡æ¢<ul>
<li>å®ç°æŒ‰é’®é€‰ä¸­çŠ¶æ€å’Œæœªé€‰ä¸­çŠ¶æ€ä¸ä¸€æ ·</li>
<li>è”ç³»äººç•Œé¢</li>
<li>ä¿¡æ¯ç•Œé¢</li>
<li>çŠ¶æ€ç•Œé¢</li>
</ul>
</li>
<li>å‘é€ä¿¡æ¯åŠŸèƒ½<ul>
<li>ç‚¹å‡»ä¿¡æ¯ç•Œé¢ä¸­çš„ä»»æ„æ¶ˆæ¯å¯ä»¥è¿›å…¥å‘æ¶ˆæ¯ç•Œé¢</li>
<li>å¯ä»¥å®ç°ç‚¹å‡»å‘é€æŒ‰é’®å°†æ‰€è¾“å…¥çš„æ–‡å­—æ˜¾ç¤ºåœ¨å±å¹•ä¸­</li>
</ul>
</li>
</ul>
<p><strong>æç¤ºï¼š</strong>æœ¬äººç”¨çš„<strong>IDEå¼€å‘ç¯å¢ƒ</strong>æ˜¯<code>Android Studio</code> <strong>API</strong>æ˜¯<code>30</code></p>
<p><strong>ç›®å½•ç»“æ„ä¸€è§ˆ</strong></p>
<p><img src="https://pic.imgdb.cn/item/60d5321c844ef46bb21d7ed7.png"></p>
<p><strong>resä¸­çš„æ–‡ä»¶</strong></p>
<p><img src="https://pic.imgdb.cn/item/60d5325f844ef46bb21f06f8.png"></p>
<h2 id="1-ç™»å½•ç•Œé¢"><a href="#1-ç™»å½•ç•Œé¢" class="headerlink" title="1. ç™»å½•ç•Œé¢"></a>1. ç™»å½•ç•Œé¢</h2><ul>
<li>ç™»å½•ç•Œé¢çš„å¸ƒå±€æ–‡ä»¶</li>
</ul>
<p><strong>activity_main.xml</strong></p>
<p>æ‰€ç”¨å›¾æ ‡éƒ½å¯ä»¥åœ¨é˜¿é‡Œå·´å·´å›¾æ ‡ç½‘æ‰¾åˆ°<a href="https://www.iconfont.cn/">iconfont-é˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“</a></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">        android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">        android:orientation=&quot;vertical&quot;</span><br><span class="line">        tools:ignore=&quot;UselessParent&quot;&gt;</span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:drawableLeft=&quot;@drawable/qq&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginTop=&quot;50dp&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;120dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;QQ&quot;</span><br><span class="line">            android:textColor=&quot;#000000&quot;</span><br><span class="line">            android:textSize=&quot;35sp&quot;</span><br><span class="line">            app:drawableStartCompat=&quot;@drawable/qq&quot;</span><br><span class="line">            android:drawableStart=&quot;@drawable/qq&quot;</span><br><span class="line">            tools:ignore=&quot;UseCompatTextViewDrawableXml&quot;</span><br><span class="line">            android:layout_marginStart=&quot;120dp&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line">        &lt;EditText</span><br><span class="line">            android:id=&quot;@+id/userNameEditText&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginTop=&quot;100dp&quot;</span><br><span class="line">            android:hint=&quot;è¯·è¾“å…¥ç”¨æˆ·å/è´¦å·/æ‰‹æœºå·&quot;</span><br><span class="line">            android:inputType=&quot;text&quot;</span><br><span class="line">            android:padding=&quot;5dp&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">EditText</span>&gt;</span></span><br><span class="line">        &lt;EditText</span><br><span class="line">            android:id=&quot;@+id/passwordEditText&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginTop=&quot;40dp&quot;</span><br><span class="line">            android:hint=&quot;è¯·è¾“å…¥å¯†ç &quot;</span><br><span class="line">            android:inputType=&quot;textPassword&quot;</span><br><span class="line">            android:padding=&quot;5dp&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">EditText</span>&gt;</span></span><br><span class="line">        &lt;ImageButton</span><br><span class="line">            android:id=&quot;@+id/loginButton&quot;</span><br><span class="line">            android:layout_marginTop=&quot;60dp&quot;</span><br><span class="line">            android:layout_gravity=&quot;center&quot;</span><br><span class="line">            android:layout_width=&quot;60dp&quot;</span><br><span class="line">            android:layout_height=&quot;60dp&quot;</span><br><span class="line">            android:src=&quot;@drawable/login&quot;</span><br><span class="line">            android:background=&quot;#fff&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ImageButton</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰€å¯¹åº”çš„<code>MainActivity</code></p>
<ul>
<li>å…¶ä¸­çš„åˆ¤æ–­é€šè¿‡ifè¯­å¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¾“å…¥å’Œè¾“å…¥æ­£ç¡®</li>
<li>æç¤º é€šè¿‡<code>Toast</code>çš„æ–¹å¼æç¤º</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.qq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.annotation.SuppressLint;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageButton;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line">    <span class="keyword">private</span> EditText userNameEditText, passwordEditText;</span><br><span class="line">    <span class="keyword">private</span> ImageButton loginButton;</span><br><span class="line">    <span class="keyword">private</span> ShareHelper shareHelper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        context=<span class="keyword">this</span>;</span><br><span class="line">        shareHelper=<span class="keyword">new</span> ShareHelper(context);</span><br><span class="line">        initview();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initview</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        userNameEditText = findViewById(R.id.userNameEditText);</span><br><span class="line">        passwordEditText = findViewById(R.id.passwordEditText);</span><br><span class="line">        loginButton = findViewById(R.id.loginButton);</span><br><span class="line">        loginButton.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//è¿›è¡Œç™»å½•é¡µé¢çš„å¤„ç†</span></span><br><span class="line">                String username = userNameEditText.getText().toString();</span><br><span class="line">                String password = passwordEditText.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (username.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (username.equals(<span class="string">&quot;zk&quot;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (password.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (password.equals(<span class="string">&quot;123&quot;</span>)) &#123;</span><br><span class="line">                                <span class="comment">// å¯¹è´¦å·å’Œå¯†ç è¿›è¡Œä¿å­˜</span></span><br><span class="line">                                shareHelper.save(<span class="string">&quot;username&quot;</span>,username);</span><br><span class="line">                                shareHelper.save(<span class="string">&quot;password&quot;</span>,password);</span><br><span class="line">                                startActivity(<span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, HomeActivity.class));</span><br><span class="line">                                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;å¯†ç ä¸æ­£ç¡®&quot;</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;è¯·å¡«å†™å¯†ç &quot;</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;ç”¨æˆ·åä¸æ­£ç¡®&quot;</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;è¯·å¡«å†™ç”¨æˆ·å&quot;</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart();</span><br><span class="line">        userNameEditText.setText(shareHelper.read(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">        passwordEditText.setText(shareHelper.read(<span class="string">&quot;password&quot;</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-è®°ä½å¯†ç åŠŸèƒ½"><a href="#2-è®°ä½å¯†ç åŠŸèƒ½" class="headerlink" title="2. è®°ä½å¯†ç åŠŸèƒ½"></a>2. è®°ä½å¯†ç åŠŸèƒ½</h2><ul>
<li>å®ç°ç¬¬ä¸€æ¬¡ç™»å½•æˆåŠŸåï¼Œå†æ¬¡ç™»å½•ä¼šè®°ä½è´¦å·å’Œå¯†ç çš„åŠŸèƒ½</li>
</ul>
<p>è¿™ä¸ªåŠŸèƒ½æˆ‘ä»¬ç”¨<code>SharedPreferences</code></p>
<p>ç®€å•äº†è§£ä¸‹ä»€ä¹ˆæ˜¯SharedPreferences</p>
<ul>
<li>SharedPreferencesæ˜¯Androidå¹³å°ä¸Šä¸€ä¸ªè½»é‡çº§çš„å­˜å‚¨è¾…åŠ©ç±»ï¼Œç”¨æ¥ä¿å­˜åº”ç”¨çš„ä¸€äº›å¸¸ç”¨é…ç½®ï¼Œå®ƒæä¾›äº†stringï¼Œsetï¼Œintï¼Œlongï¼Œfloatï¼Œbooleanå…­ç§æ•°æ®ç±»å‹ã€‚æœ€ç»ˆæ•°æ®æ˜¯ä»¥xmlå½¢å¼è¿›è¡Œå­˜å‚¨ã€‚åœ¨åº”ç”¨ä¸­é€šå¸¸åšä¸€äº›ç®€å•æ•°æ®çš„æŒä¹…åŒ–ç¼“å­˜ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.qq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.SharedPreferences;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShareHelper</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ä¸¤ä¸ªåŠŸèƒ½ ä¿å­˜ï¼Œè¯»å–</span></span><br><span class="line">    Context context;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShareHelper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShareHelper</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(String key, String value)</span> </span>&#123;</span><br><span class="line">        SharedPreferences sharedPreferences = context.getSharedPreferences(<span class="string">&quot;iot1921&quot;</span>, Context.MODE_PRIVATE);</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªè¾“å…¥å€¼</span></span><br><span class="line">        SharedPreferences.Editor editor = sharedPreferences.edit();</span><br><span class="line">        editor.putString(key, value);</span><br><span class="line">        editor.commit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¯»å–æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">read</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        SharedPreferences sharedPreferences = context.getSharedPreferences(<span class="string">&quot;iot1921&quot;</span>, Context.MODE_PRIVATE);</span><br><span class="line">        <span class="keyword">return</span> sharedPreferences.getString(key, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>è¾“å…¥å€¼è®°å¾—æäº¤ï¼Œeditor.commit();</li>
<li>åœ¨<code>MainACtivity</code>ä¸­è®°å¾—åœ¨OnStartæ–¹æ³•ä¸­ä½¿ç”¨ShareHelper.readä¼ å…¥éœ€è¦è®°ä½çš„å€¼ï¼</li>
</ul>
<p>é¢„è§ˆä¸€ä¸‹æˆæœï¼</p>
<p><img src="https://pic.imgdb.cn/item/60d53291844ef46bb2202f2b.gif"></p>
<h2 id="3-Fragmentç•Œé¢è·³è½¬"><a href="#3-Fragmentç•Œé¢è·³è½¬" class="headerlink" title="3. Fragmentç•Œé¢è·³è½¬"></a>3. Fragmentç•Œé¢è·³è½¬</h2><p>è¿™é‡Œæœ‰ä¸‰ä¸ªFragmentï¼Œæ‰€å¯¹åº”éœ€è¦ä¸‰ä¸ªfragmentå¸ƒå±€ç•Œé¢</p>
<ul>
<li>é¦–å…ˆè¦åˆ›å»º3ä¸ªæŒ‰é’®çš„åˆ‡æ¢xml</li>
</ul>
<p><strong>message.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/message_on&quot;</span> <span class="attr">android:state_selected</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/message_off&quot;</span> <span class="attr">android:state_selected</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>people.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/people_on&quot;</span> <span class="attr">android:state_selected</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/people_off&quot;</span> <span class="attr">android:state_selected</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>statue.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/statue_on&quot;</span> <span class="attr">android:state_selected</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/statue_off&quot;</span> <span class="attr">android:state_selected</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨å¸ƒå±€ç•Œé¢ä¸­ä½¿ç”¨</p>
<p><strong>activity_home.xml</strong></p>
<p>è¿™ä¸ªç•Œé¢çš„å¸ƒå±€å¯ä»¥éšæ„å‘æŒ¥ï¼Œæœ¬äººåšçš„æ¯”è¾ƒç®€å•ï¼Œè§è°…</p>
<ul>
<li>3ä¸ª<code>ImageView</code>å’Œ1ä¸ª<code>FrameLayout</code></li>
<li><code>ImageView</code>åˆ†åˆ«ç»‘å®šç‚¹å‡»äº‹ä»¶</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">        &lt;ImageView</span><br><span class="line">            android:layout_width=&quot;50dp&quot;</span><br><span class="line">            android:layout_height=&quot;50dp&quot;</span><br><span class="line">            android:src=&quot;@drawable/basketball&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ImageView</span>&gt;</span></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:text=&quot;Upcoming&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;50dp&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;250dp&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:text=&quot;+  -&quot;</span><br><span class="line">            android:textSize=&quot;25sp&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;FrameLayout</span><br><span class="line">        android:layout_marginTop=&quot;10dp&quot;</span><br><span class="line">        android:id=&quot;@+id/frameLayout&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;550dp&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/messageImageView&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;60dp&quot;</span><br><span class="line">        android:background=&quot;@drawable/message&quot;</span><br><span class="line">        android:layout_weight=&quot;1&quot;</span><br><span class="line">        android:layout_marginStart=&quot;0dp&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ImageView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/peopleImageView&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;150dp&quot;</span><br><span class="line">        android:background=&quot;@drawable/people&quot;</span><br><span class="line">        android:layout_weight=&quot;1&quot;</span><br><span class="line">        android:layout_marginStart=&quot;150dp&quot;</span><br><span class="line">        tools:ignore=&quot;ContentDescription&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ImageView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;ImageView</span><br><span class="line">            android:id=&quot;@+id/statueImageView&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;170dp&quot;</span><br><span class="line">            android:background=&quot;@drawable/statue&quot;</span><br><span class="line">            android:layout_weight=&quot;1&quot;</span><br><span class="line">            android:layout_marginStart=&quot;170dp&quot;</span><br><span class="line">            tools:ignore=&quot;ContentDescription&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ImageView</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-1-Fragementçš„ç•Œé¢ç¼–å†™"><a href="#3-1-Fragementçš„ç•Œé¢ç¼–å†™" class="headerlink" title="3.1 Fragementçš„ç•Œé¢ç¼–å†™"></a>3.1 Fragementçš„ç•Œé¢ç¼–å†™</h3><p><strong>item_listview.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@drawable/backgrounds&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;ListView</span><br><span class="line">        android:id=&quot;@+id/messagelistView&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ListView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>fragment_message.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@drawable/backgrounds&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;ListView</span><br><span class="line">        android:id=&quot;@+id/messagelistView&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ListView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>fragment_people.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:textSize=&quot;30sp&quot;</span><br><span class="line">        android:textColor=&quot;#000000&quot;</span><br><span class="line">        android:text=&quot;è¿™æ˜¯è”ç³»äººé¡µé¢&quot;</span><br><span class="line">        tools:ignore=&quot;MissingConstraints&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>fragment_statue.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:textSize=&quot;30sp&quot;</span><br><span class="line">        android:textColor=&quot;#000000&quot;</span><br><span class="line">        android:text=&quot;è¿™æ˜¯åŠ¨æ€é¡µé¢&quot;</span><br><span class="line">        tools:ignore=&quot;MissingConstraints&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Fragmentå¸ƒå±€å†™å®Œå°±æ˜¯é‡ç‚¹å¦‚ä½•åœ¨<code>FrameLayout</code>ä¸­åŠ è½½</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºå¸ƒå±€æ‰€å¯¹åº”çš„Fragment</p>
<p><strong>æ¯ä¸ªFragmentè¦æŒ‡å®šåŠ è½½çš„å¸ƒå±€å’Œè°ƒç”¨çš„æ–¹æ³•</strong></p>
<blockquote>
<p>**onCreateView()**ï¼šæ¯æ¬¡åˆ›å»ºã€ç»˜åˆ¶è¯¥Fragmentçš„Viewç»„ä»¶æ—¶å›è°ƒè¯¥æ–¹æ³•ï¼ŒFragmentå°†ä¼šæ˜¾ç¤ºè¯¥æ–¹æ³•è¿”å›çš„Viewç»„ä»¶ã€‚<br>**onActivityCreated()**ï¼šå½“Fragmentæ‰€åœ¨çš„Activityè¢«å¯åŠ¨å®Œæˆåå›è°ƒè¯¥æ–¹æ³•ã€‚</p>
</blockquote>
<p>åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­éœ€è¦å®ç°</p>
<ul>
<li>ç‚¹å‡»è¿›å…¥èŠå¤©ç•Œé¢</li>
<li>å¯ä»¥å‘é€æ¶ˆæ¯æ˜¾ç¤ºåœ¨å±å¹•ä¸Š</li>
</ul>
<p>æˆ‘ä»¬é€šè¿‡<code>List</code>é›†åˆä¸­å­˜æ”¾<code>Map</code></p>
<p><code>Map</code>ä¸­æ‰€å­˜æ”¾çš„Keyå°±æ˜¯æ‰€åˆ›å»ºçš„<code>Names</code>æ•°ç»„ï¼ŒValueå°±æ˜¯<code>Images</code>æ•°ç»„</p>
<p>é€šè¿‡åˆ›å»ºSimpleAdapterå¯¹è±¡æ¥åŠ è½½<code>fragment_message</code></p>
<p><strong>è®²ä¸‹è¿™ä¸‰è¡Œå…³é”®çš„ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åŠ è½½åœ¨å“ªä¸ªå¸ƒå±€ç•Œé¢</span></span><br><span class="line">messagelistView= getActivity().findViewById(R.id.messagelistView);</span><br><span class="line"><span class="comment">//é€‚é…å™¨ä¸­çš„å‚æ•°</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">context ä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="comment">dataList é›†åˆä¸­å­˜æ”¾çš„å€¼</span></span><br><span class="line"><span class="comment">R.layout.item_listview åŠ è½½çš„å¸ƒå±€ç•Œé¢</span></span><br><span class="line"><span class="comment">new String[]&#123;&quot;Name&quot;,&quot;Image&quot;&#125; Stringæ•°ç»„ </span></span><br><span class="line"><span class="comment">new int[]&#123;R.id.NameTextView,R.id.ImageView&#125; intæ•°ç»„ è·å–id</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">        simpleAdapter=<span class="keyword">new</span> SimpleAdapter(context,dataList,R.layout.item_listview,</span><br><span class="line">                <span class="keyword">new</span> String[]&#123;<span class="string">&quot;Name&quot;</span>,<span class="string">&quot;Image&quot;</span>&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;R.id.NameTextView,R.id.ImageView&#125;);</span><br><span class="line"><span class="comment">//åŠ è½½é€‚é…å™¨</span></span><br><span class="line">        messagelistView.setAdapter(simpleAdapter);</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªè·å–æ•°æ®çš„æ–¹æ³•<code>getData()</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//listè·å–æ•°æ®</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getData</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//éå†æ•°ç»„ä¸­çš„æ•°æ® æ·»åŠ åˆ°listä¸­</span></span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Names.length; i++) &#123;</span><br><span class="line">           <span class="comment">//æ–°å»ºmap å­˜æ”¾æ•°ç»„ä¸­çš„æ•°æ® æœ€åå­˜æ”¾åœ¨listä¸­</span></span><br><span class="line">           HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">           map.put(<span class="string">&quot;Name&quot;</span>,Names[i]);</span><br><span class="line">           map.put(<span class="string">&quot;Image&quot;</span>,Images[i]);</span><br><span class="line">           dataList.add(map);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p><strong>MessageFragment</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.qq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.AdapterView;</span><br><span class="line"><span class="keyword">import</span> android.widget.ListView;</span><br><span class="line"><span class="keyword">import</span> android.widget.SimpleAdapter;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line">    <span class="keyword">private</span> ListView messagelistView;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    List&lt;Map&lt;String,Object&gt;&gt; dataList=<span class="keyword">new</span> ArrayList&lt;Map&lt;String,Object&gt;&gt;();</span><br><span class="line">    String [] Names=&#123;<span class="string">&quot;ä¸€å·&quot;</span>,<span class="string">&quot;äºŒå·&quot;</span>,<span class="string">&quot;ä¸‰å·&quot;</span>,<span class="string">&quot;å››å·&quot;</span>,<span class="string">&quot;äº”å·&quot;</span>,<span class="string">&quot;å…­å·&quot;</span>,<span class="string">&quot;ä¸ƒå·&quot;</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> [] Images=&#123;R.mipmap.kaochang,R.mipmap.kaojitui,R.mipmap.kaojichi,R.mipmap.kaoqiezi,R.mipmap.kaolajiao,R.mipmap.kaojinzhengu ,R.mipmap.kaonanguabing&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºSimpleAdapterå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> SimpleAdapter simpleAdapter;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_message,container,<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">        context=getActivity();</span><br><span class="line">        initView();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        messagelistView= getActivity().findViewById(R.id.messagelistView);</span><br><span class="line">        getData();</span><br><span class="line">        simpleAdapter=<span class="keyword">new</span> SimpleAdapter(context,dataList,R.layout.item_listview,</span><br><span class="line">                <span class="keyword">new</span> String[]&#123;<span class="string">&quot;Name&quot;</span>,<span class="string">&quot;Image&quot;</span>&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;R.id.NameTextView,R.id.ImageView&#125;);</span><br><span class="line">        messagelistView.setAdapter(simpleAdapter);</span><br><span class="line">        <span class="comment">//listViewçš„é¡¹ç‚¹å‡»ç›‘å¬äº‹ä»¶</span></span><br><span class="line">        messagelistView.setOnItemClickListener(<span class="keyword">new</span> AdapterView.OnItemClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; adapterView, View view, <span class="keyword">int</span> i, <span class="keyword">long</span> l)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//è·å–å½“å‰é¡¹çš„æ•°æ®</span></span><br><span class="line">                String name=dataList.get(i).get(<span class="string">&quot;Name&quot;</span>).toString();</span><br><span class="line">                Intent intent=<span class="keyword">new</span> Intent(getActivity(),TalkActivity.class);</span><br><span class="line">                startActivity(<span class="keyword">new</span> Intent(getActivity(), TalkActivity.class));</span><br><span class="line">                intent.putExtra(<span class="string">&quot;name&quot;</span>,name);</span><br><span class="line">                Toast.makeText(context,<span class="string">&quot;å½“å‰ç‚¹å‡»çš„é€‰é¡¹åç§°æ˜¯&quot;</span>+name,Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//listè·å–æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getData</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//éå†æ•°ç»„ä¸­çš„æ•°æ® æ·»åŠ åˆ°listä¸­</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Names.length; i++) &#123;</span><br><span class="line">            <span class="comment">//æ–°å»ºmap å­˜æ”¾æ•°ç»„ä¸­çš„æ•°æ® æœ€åå­˜æ”¾åœ¨listä¸­</span></span><br><span class="line">            HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">            map.put(<span class="string">&quot;Name&quot;</span>,Names[i]);</span><br><span class="line">            map.put(<span class="string">&quot;Image&quot;</span>,Images[i]);</span><br><span class="line">            dataList.add(map);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PeopleFragment</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.qq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PeopleFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_people,container,<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StatueFragment</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.qq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StatueFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_statue,container,<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ååœ¨<code>HomeActivity</code>ä¸­ä½¿ç”¨</p>
<p>äº†è§£ä»€ä¹ˆæ˜¯<code>FragmentTransaction</code></p>
<blockquote>
<p>ä½¿ç”¨Fragmentæ—¶ï¼Œå¯ä»¥é€šè¿‡ç”¨æˆ·äº¤äº’æ¥æ‰§è¡Œä¸€äº›åŠ¨ä½œï¼Œæ¯”å¦‚å¢åŠ ã€ç§»é™¤ã€æ›¿æ¢ç­‰ã€‚</p>
<p>æ‰€æœ‰è¿™äº›æ”¹å˜æ„æˆä¸€ä¸ªé›†åˆï¼Œè¿™ä¸ªé›†åˆè¢«å«åšä¸€ä¸ªtransaction</p>
</blockquote>
<p><strong>HomeActivity</strong></p>
<ul>
<li>ç›‘å¬<code>ImgaeView</code>çš„ç‚¹å‡»äº‹ä»¶</li>
<li>åˆå§‹åŒ–<code>ImageView</code>çš„é€‰ä¸­çŠ¶æ€ä¸ºfalse é€šè¿‡æ–¹æ³•ä¼ å…¥å‚æ•°ä»è€Œåˆ¤æ–­å“ªä¸ª<code>ImageView</code>è¢«ç‚¹å‡» å°†è¢«ç‚¹å‡»çš„çŠ¶æ€è®¾ä¸ºfalse</li>
<li><code>showFragment(Fragment fragment)</code>ä¸­é€šè¿‡éšè—<code>Fragment</code>ï¼Œç‚¹å‡»<code>ImageView</code>æ—¶å†åˆ¤æ–­æ˜¾ç¤ºå“ªä¸ª<code>Fragment</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.qq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.app.FragmentManager;</span><br><span class="line"><span class="keyword">import</span> android.app.FragmentTransaction;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ImageView messageImageView, peopleImageView, statueImageView;</span><br><span class="line">    <span class="keyword">private</span> MessageFragment messageFragment;</span><br><span class="line">    <span class="keyword">private</span> PeopleFragment peopleFragment;</span><br><span class="line">    <span class="keyword">private</span> StatueFragment statueFragment;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> FragmentManager fragmentManager = getFragmentManager();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_home);</span><br><span class="line">        initView();</span><br><span class="line">        initFragment();</span><br><span class="line">        showFragment(statueFragment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        messageImageView = findViewById(R.id.messageImageView);</span><br><span class="line">        peopleImageView = findViewById(R.id.peopleImageView);</span><br><span class="line">        statueImageView = findViewById(R.id.statueImageView);</span><br><span class="line">        messageImageView.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        peopleImageView.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        statueImageView.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initFragment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        messageFragment = <span class="keyword">new</span> MessageFragment();</span><br><span class="line">        peopleFragment = <span class="keyword">new</span> PeopleFragment();</span><br><span class="line">        statueFragment = <span class="keyword">new</span> StatueFragment();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å±•ç¤º</span></span><br><span class="line">        FragmentTransaction transaction = fragmentManager.beginTransaction();</span><br><span class="line">        transaction.add(R.id.frameLayout, messageFragment);</span><br><span class="line">        transaction.add(R.id.frameLayout, peopleFragment);</span><br><span class="line">        transaction.add(R.id.frameLayout, statueFragment);</span><br><span class="line">        transaction.commit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (view.getId()) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> R.id.messageImageView:</span><br><span class="line">                init(messageImageView);</span><br><span class="line">                showFragment(messageFragment);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.peopleImageView:</span><br><span class="line">                init(peopleImageView);</span><br><span class="line">                showFragment(peopleFragment);</span><br><span class="line">                <span class="comment">//startActivity(new Intent(HomeActivity.this, ListViewActivity.class));</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.statueImageView:</span><br><span class="line">                init(statueImageView);</span><br><span class="line">                showFragment(statueFragment);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ImageView imageView)</span> </span>&#123;</span><br><span class="line">        messageImageView.setSelected(<span class="keyword">false</span>);</span><br><span class="line">        peopleImageView.setSelected(<span class="keyword">false</span>);</span><br><span class="line">        statueImageView.setSelected(<span class="keyword">false</span>);</span><br><span class="line">        imageView.setSelected(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å±•ç¤ºæŒ‡å®šçš„Fragment</span></span><br><span class="line">    <span class="comment">//å®šä¹‰å½“å‰é¡µé¢</span></span><br><span class="line">    <span class="keyword">private</span> Fragment curFragment = <span class="keyword">new</span> Fragment();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showFragment</span><span class="params">(Fragment fragment)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¦‚æœå½“å‰çš„fragmentä¸ä¼ å…¥çš„fragmentæ˜¯åŒä¸€ä¸ªï¼Œå‘¢ä¹ˆå°†è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (curFragment.equals(fragment)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        FragmentTransaction transaction = fragmentManager.beginTransaction();</span><br><span class="line">        transaction.hide(messageFragment);</span><br><span class="line">        transaction.hide(peopleFragment);</span><br><span class="line">        transaction.hide(statueFragment);</span><br><span class="line">        transaction.show(fragment);</span><br><span class="line">        transaction.commit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>è®°å¾— <code>transaction</code>è¦commit</li>
</ul>
<p>é¢„è§ˆä¸€ä¸‹æˆæœ!</p>
<p><img src="https://pic.imgdb.cn/item/60d532be844ef46bb221409f.gif"></p>
<h2 id="4-èŠå¤©ç•Œé¢"><a href="#4-èŠå¤©ç•Œé¢" class="headerlink" title="4. èŠå¤©ç•Œé¢"></a>4. èŠå¤©ç•Œé¢</h2><p><strong>item_talking.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:padding</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:gravity</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/talkTextView&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;300dp&quot;</span><br><span class="line">        android:text=&quot;çƒ¤è‚ &quot;</span><br><span class="line">        android:textSize=&quot;25sp&quot;</span><br><span class="line">        android:textColor=&quot;#000000&quot;</span><br><span class="line">        android:background=&quot;#cef&quot;</span><br><span class="line">        android:layout_marginStart=&quot;300dp&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/ImageView&quot;</span><br><span class="line">        android:layout_width=&quot;50dp&quot;</span><br><span class="line">        android:layout_height=&quot;50dp&quot;</span><br><span class="line">        android:background=&quot;@mipmap/kaochang&quot;&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ImageView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>activity_talk.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:orientation=&quot;vertical&quot;&gt;</span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:textColor=&quot;#000000&quot;</span><br><span class="line">            android:text=&quot;åº·å°åº„&quot;</span><br><span class="line">            android:id=&quot;@+id/NameTextView&quot;</span><br><span class="line">            android:background=&quot;#44cef6&quot;&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line">    &lt;ListView</span><br><span class="line">        android:id=&quot;@+id/listView2&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;600dp&quot;</span><br><span class="line">        android:layout_weight=&quot;1&quot;</span><br><span class="line">        /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;LinearLayout</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:orientation=&quot;horizontal&quot;</span><br><span class="line">            android:layout_gravity=&quot;bottom&quot;</span><br><span class="line">            &gt;</span><br><span class="line">            &lt;EditText</span><br><span class="line">                android:id=&quot;@+id/inputEditText&quot;</span><br><span class="line">                android:layout_width=&quot;match_parent&quot;</span><br><span class="line">                android:layout_height=&quot;match_parent&quot;</span><br><span class="line">                android:layout_weight=&quot;1&quot;&gt;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">EditText</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            &lt;Button</span><br><span class="line">                android:id=&quot;@+id/sendButton&quot;</span><br><span class="line">                android:layout_width=&quot;match_parent&quot;</span><br><span class="line">                android:layout_height=&quot;match_parent&quot;</span><br><span class="line">                android:layout_weight=&quot;3&quot;</span><br><span class="line">                android:text=&quot;å‘é€&quot;&gt;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>TalkActivity</strong></p>
<ul>
<li>é€šè¿‡<code>Handler</code>æ¥å®ç°æ¶ˆæ¯å‘å‡ºå»ä¹‹å å¯¹è¯æ¡†ç½®ä¸º<code>null</code></li>
<li>é€šè¿‡<code>simpleAdapter</code>å®ç°åŠ è½½åˆ°å“ªä¸ªå¸ƒå±€ç•Œé¢çš„id</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.czie.qq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.ListView;</span><br><span class="line"><span class="keyword">import</span> android.widget.SimpleAdapter;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.NonNull;</span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TalkActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> EditText inputEditText;</span><br><span class="line">    <span class="keyword">private</span> SimpleAdapter simpleAdapter;</span><br><span class="line">    List&lt;Map&lt;String,String&gt;&gt; list=<span class="keyword">new</span> ArrayList&lt;Map&lt;String,String&gt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_talk);</span><br><span class="line">        Context context = <span class="keyword">this</span>;</span><br><span class="line">        initView();</span><br><span class="line">        TextView nameTextView = findViewById(R.id.NameTextView);</span><br><span class="line">        Intent intent=getIntent();</span><br><span class="line">        String name=intent.getStringExtra(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        nameTextView.setText(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        inputEditText=findViewById(R.id.inputEditText);</span><br><span class="line">        Button sendButton = findViewById(R.id.sendButton);</span><br><span class="line">        ListView listView2 = findViewById(R.id.listView2);</span><br><span class="line">        listView2.setDivider(<span class="keyword">null</span>);</span><br><span class="line">        simpleAdapter=<span class="keyword">new</span> SimpleAdapter(<span class="keyword">this</span>,list,R.layout.item_talking,<span class="keyword">new</span> String[]&#123;<span class="string">&quot;message&quot;</span>&#125;,<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;R.id.talkTextView&#125;);</span><br><span class="line">        listView2.setAdapter(simpleAdapter);</span><br><span class="line">        sendButton.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        sendMessage();</span><br><span class="line">        handler.sendEmptyMessage(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String message=inputEditText.getText().toString();</span><br><span class="line">        <span class="keyword">if</span> (message.length()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            HashMap&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            map.put(<span class="string">&quot;message&quot;</span>,message);</span><br><span class="line">            list.add(map);</span><br><span class="line">            inputEditText.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Handler handler=<span class="keyword">new</span> Handler()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(<span class="meta">@NonNull</span> Message msg)</span> </span>&#123;</span><br><span class="line">            simpleAdapter.notifyDataSetChanged();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://pic.imgdb.cn/item/60d532d1844ef46bb221b0c4.gif"></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ul>
<li>å­¦ä¼šäº†ç®€å•çš„é¡µé¢è·³è½¬åŠŸèƒ½ï¼Œæé«˜æ€è€ƒçš„èƒ½åŠ›ï¼Œå­¦ä¼šå¦‚ä½•ç”¨è¾ƒå°‘ä»£ç å®ç°åŠŸèƒ½</li>
<li>è¿˜æœ‰è®¸å¤šä¸è¶³ä»éœ€åŠªåŠ›</li>
</ul>
<p><strong>å†™åœ¨æœ€åï¼š</strong></p>
<ul>
<li>æœ‰ä»»ä½•é”™è¯¯æ¬¢è¿è¯„è®ºåŒºæŒ‡å‡ºï¼ŒåŠæ—¶æ”¹æ­£ï¼</li>
</ul>
]]></content>
      <categories>
        <category>å®‰å“</category>
      </categories>
      <tags>
        <tag>Androidç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueå­¦ä¹ ç¬”è®°</title>
    <url>/2021/04/29/Vue%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p><strong>å­¦ä¹ åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV17j411f74d">2019å¹´coderwhy vue-vuejsä»å…¥é—¨åˆ°ç²¾é€šæ•™ç¨‹_å“”å“©å“”å“© (ã‚œ-ã‚œ)ã¤ãƒ­ å¹²æ¯~-bilibili</a></strong></p>
<p><strong>å†™åœ¨å‰é¢ï¼šå­¦ä¹ çš„ç‰ˆæœ¬ä¸åŒï¼Œæœ‰äº›è¯­æ³•åœ¨æ–°ç‰ˆæœ¬å·²ç»åºŸå¼ƒï¼Œå…·ä½“è¯¦è§£å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼</strong></p>
<p><strong>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://cn.vuejs.org/v2/guide/">https://cn.vuejs.org/v2/guide/</a></strong></p>
<p><strong>æœ€åæ„Ÿè°¢coderwhyè€å¸ˆçš„è®²è§£è§†é¢‘ï¼ååˆ†æ„Ÿè°¢ï¼</strong></p>
<h1 id="1ï¼Œä»€ä¹ˆæ˜¯Vue"><a href="#1ï¼Œä»€ä¹ˆæ˜¯Vue" class="headerlink" title="1ï¼Œä»€ä¹ˆæ˜¯Vue"></a>1ï¼Œä»€ä¹ˆæ˜¯Vue</h1><ul>
<li><p>Vue.jsï¼ˆè¯»éŸ³ /vjuË/, ç±»ä¼¼äº viewï¼‰ æ˜¯ä¸€å¥—æ„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼æ¡†æ¶ã€‚</p>
</li>
<li><p>Vue åªå…³æ³¨è§†å›¾å±‚ï¼Œ é‡‡ç”¨è‡ªåº•å‘ä¸Šå¢é‡å¼€å‘çš„è®¾è®¡ã€‚</p>
</li>
<li><p>Vue çš„ç›®æ ‡æ˜¯é€šè¿‡å°½å¯èƒ½ç®€å•çš„ API å®ç°å“åº”çš„æ•°æ®ç»‘å®šå’Œç»„åˆçš„è§†å›¾ç»„ä»¶ã€‚</p>
</li>
</ul>
<p><strong>å­¦ä¹ å‰éœ€è¦æœ‰å‰ç«¯ä¸‰å¤§ä»¶çš„åŸºç¡€ htmlï¼Œcssï¼ŒJavaScript</strong></p>
<h2 id="1-1-Vueç¬¬ä¸€ä¸ªç¨‹åº"><a href="#1-1-Vueç¬¬ä¸€ä¸ªç¨‹åº" class="headerlink" title="1.1 Vueç¬¬ä¸€ä¸ªç¨‹åº"></a>1.1 Vueç¬¬ä¸€ä¸ªç¨‹åº</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// let(å˜é‡ï¼‰/constï¼ˆå¸¸é‡ï¼‰</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// ç¼–ç¨‹èŒƒå¼ï¼šå£°æ˜å¼ç¼–ç¨‹</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">  <span class="comment">// åˆ›å»ºVueå¯¹è±¡çš„æ—¶å€™ï¼Œä¼ å…¥äº†ä¸€äº›option:&#123;&#125;</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// &#123;&#125;ä¸­åŒ…å«äº†elå±æ€§ï¼šè¯¥å±æ€§å†³å®šäº†è¿™ä¸ªVueå¯¹è±¡æŒ‚è½½åˆ°å“ªä¸€ä¸ªå…ƒç´ ä¸Šï¼Œ</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// å¾ˆæ˜æ˜¾ï¼Œè¿™é‡Œæ˜¯æŒ‚è½½åˆ°äº†idä¸ºappçš„å…ƒç´ ä¸Š</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// &#123;&#125;ä¸­åŒ…å«äº†dataå±æ€§ï¼šè¯¥å±æ€§ä¸­é€šå¸¸ä¼šå­˜å‚¨ä¸€äº›æ•°æ®</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// è¿™äº›æ•°æ®å¯ä»¥æ˜¯æˆ‘ä»¬ç›´æ¥å®šä¹‰å‡ºæ¥çš„ï¼Œæ¯”å¦‚åƒä¸Šé¢è¿™æ ·</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// ä¹Ÿå¯èƒ½æ˜¯æ¥è‡ªç½‘ç»œï¼Œä»æœåŠ¡å™¨åŠ è½½çš„</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,<span class="comment">//ç”¨äºæŒ‚è½½ç®¡ç†çš„å…ƒç´ </span></span></span><br><span class="line"><span class="javascript">    data:&#123;<span class="comment">//å®šä¹‰æ•°æ®</span></span></span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  <span class="comment">//ä¼ ç»Ÿjsçš„åšæ³•ï¼ˆç¼–ç¨‹èŒƒå¼ï¼šå‘½ä»¤å¼ç¼–ç¨‹ï¼‰</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">//1.åˆ›å»ºdivå…ƒç´ ï¼Œè®¾ç½®idå±æ€§</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">//2.å®šä¹‰ä¸€ä¸ªå˜é‡å«message</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">//3.messageå˜é‡æ”¾åœ¨å‰é¢çš„divå…ƒç´ ä¸­æ˜¾ç¤º</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-20_21-33-57.png"></p>
<h2 id="1-2-åˆ—è¡¨çš„æ¡ˆä¾‹"><a href="#1-2-åˆ—è¡¨çš„æ¡ˆä¾‹" class="headerlink" title="1.2 åˆ—è¡¨çš„æ¡ˆä¾‹"></a>1.2 åˆ—è¡¨çš„æ¡ˆä¾‹</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in movies&quot;</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      movies:[<span class="string">&quot;é€Ÿåº¦ä¸æ¿€æƒ…&quot;</span>,<span class="string">&quot;æµ·è´¼ç‹&quot;</span>,<span class="string">&quot;ç›—å¢“ç¬”è®°&quot;</span>,<span class="string">&quot;æˆé¾™å†é™©è®°&quot;</span>]</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-20_21-34-24.png"></p>
<h2 id="1-3-è®¡ç®—å™¨æ¡ˆä¾‹"><a href="#1-3-è®¡ç®—å™¨æ¡ˆä¾‹" class="headerlink" title="1.3 è®¡ç®—å™¨æ¡ˆä¾‹"></a>1.3 è®¡ç®—å™¨æ¡ˆä¾‹</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>å½“å‰è®¡æ•°:&#123;&#123;counter&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;sub&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line">      counter:0</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      add:<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;addè¢«æ‰§è¡Œ&quot;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.counter++</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">//å‡æ³•</span></span></span><br><span class="line"><span class="javascript">      sub:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;subè¢«æ‰§è¡Œ&quot;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.counter--</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-20_21-34-47.png"></p>
<h2 id="1-5-Vueä¸­MVMM"><a href="#1-5-Vueä¸­MVMM" class="headerlink" title="1.5 Vueä¸­MVMM"></a>1.5 Vueä¸­MVMM</h2><p>è®¡æ•°å™¨çš„MVVM</p>
<ul>
<li><p>æˆ‘ä»¬çš„è®¡æ•°å™¨ä¸­å°±æœ‰ä¸¥æ ¼çš„MVVMæ€æƒ³</p>
</li>
<li><p>Viewä¾ç„¶æ˜¯æˆ‘ä»¬çš„DOM</p>
</li>
<li><p>Modelå°±æ˜¯æˆ‘ä»¬æˆ‘ä»¬æŠ½ç¦»å‡ºæ¥çš„obj</p>
</li>
<li><p>ViewModelå°±æ˜¯æˆ‘ä»¬åˆ›å»ºçš„Vueå¯¹è±¡å®ä¾‹</p>
</li>
</ul>
<p>å®ƒä»¬ä¹‹é—´å¦‚ä½•å·¥ä½œå‘¢ï¼Ÿ</p>
<ul>
<li><p>é¦–å…ˆViewModelé€šè¿‡Data Bindingè®©objä¸­çš„æ•°æ®å®æ—¶çš„åœ¨DOMä¸­æ˜¾ç¤ºã€‚</p>
</li>
<li><p>å…¶æ¬¡ViewModelé€šè¿‡DOM Listeneræ¥ç›‘å¬DOMäº‹ä»¶ï¼Œå¹¶ä¸”é€šè¿‡methodsä¸­çš„æ“ä½œï¼Œæ¥æ”¹å˜objä¸­çš„æ•°æ®ã€‚</p>
</li>
<li><p>æœ‰äº†Vueå¸®åŠ©æˆ‘ä»¬å®ŒæˆVueModelå±‚çš„ä»»åŠ¡ï¼Œåœ¨åç»­çš„å¼€å‘ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸“æ³¨äºæ•°æ®çš„å¤„ç†ï¼Œä»¥åŠDOMçš„ç¼–å†™å·¥ä½œäº†ã€‚</p>
</li>
</ul>
<p><strong>åˆ›å»ºVueå®ä¾‹ä¼ å…¥çš„options</strong></p>
<p>åˆ›å»ºvueå®ä¾‹çš„æ—¶å€™ï¼Œä¼ å…¥ä¸€ä¸ªå¯¹è±¡options</p>
<p><strong>el:</strong> </p>
<ul>
<li><p>ç±»å‹ï¼šstring | HTMLElement</p>
</li>
<li><p>ä½œç”¨ï¼šå†³å®šä¹‹åVueå®ä¾‹ä¼šç®¡ç†å“ªä¸€ä¸ªDOMã€‚</p>
</li>
</ul>
<p><strong>data:</strong> </p>
<ul>
<li><p>ç±»å‹ï¼šObject | Function ï¼ˆç»„ä»¶å½“ä¸­dataå¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰</p>
</li>
<li><p>ä½œç”¨ï¼šVueå®ä¾‹å¯¹åº”çš„æ•°æ®å¯¹è±¡ã€‚</p>
</li>
</ul>
<p><strong>methods:</strong> </p>
<ul>
<li><p>ç±»å‹ï¼š{ [key: string]: Function }</p>
</li>
<li><p>ä½œç”¨ï¼šå®šä¹‰å±äºVueçš„ä¸€äº›æ–¹æ³•ï¼Œå¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨æŒ‡ä»¤ä¸­ä½¿ç”¨ã€‚</p>
</li>
</ul>
<h2 id="1-6-Vueçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#1-6-Vueçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="1.6 Vueçš„ç”Ÿå‘½å‘¨æœŸ"></a>1.6 Vueçš„ç”Ÿå‘½å‘¨æœŸ</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E5%9B%BE%E7%89%871.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E5%9B%BE%E7%89%873.png" alt="å›¾ç‰‡3"></p>
<h1 id="2ï¼Œæ’å€¼çš„æ“ä½œ"><a href="#2ï¼Œæ’å€¼çš„æ“ä½œ" class="headerlink" title="2ï¼Œæ’å€¼çš„æ“ä½œ"></a>2ï¼Œæ’å€¼çš„æ“ä½œ</h1><h2 id="2-1-Mustacheè¯­æ³•"><a href="#2-1-Mustacheè¯­æ³•" class="headerlink" title="2.1 Mustacheè¯­æ³•"></a>2.1 Mustacheè¯­æ³•</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;message&#125;&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;firstName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;lastName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;firstName&#125;&#125;&#123;&#123;lastName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;age+&quot;--&quot;+pet&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      firstName:<span class="string">&quot;zhuang&quot;</span>,</span></span><br><span class="line"><span class="javascript">      lastName:<span class="string">&quot;kang&quot;</span>,</span></span><br><span class="line"><span class="javascript">      age:<span class="string">&quot;20&quot;</span>,</span></span><br><span class="line"><span class="javascript">      pet:<span class="string">&quot;dog&quot;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-20_21-35-33.png"></p>
<h2 id="2-2-V-onceæŒ‡ä»¤"><a href="#2-2-V-onceæŒ‡ä»¤" class="headerlink" title="2.2 V-onceæŒ‡ä»¤"></a>2.2 V-onceæŒ‡ä»¤</h2><ul>
<li>è¯¥æŒ‡ä»¤åé¢ä¸éœ€è¦è·Ÿä»»ä½•è¡¨è¾¾å¼</li>
<li>è¯¥æŒ‡ä»¤è¡¨ç¤ºå…ƒç´ å’Œç»„ä»¶åªæ¸²æŸ“ä¸€æ¬¡ï¼Œä¸ä¼šéšç€æ•°æ®çš„æ”¹å˜è€Œæ”¹å˜</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--è¯¥æŒ‡ä»¤åé¢ä¸éœ€è¦è·Ÿä»»ä½•è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">è¯¥æŒ‡ä»¤è¡¨ç¤ºå…ƒç´ å’Œç»„ä»¶åªæ¸²æŸ“ä¸€æ¬¡ï¼Œä¸ä¼šéšç€æ•°æ®çš„æ”¹å˜è€Œæ”¹å˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>\&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-once</span>&gt;</span></span><br><span class="line">    &#123;&#123;message&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-20_21-36-58.png"></p>
<h2 id="2-3-V-htmlæŒ‡ä»¤"><a href="#2-3-V-htmlæŒ‡ä»¤" class="headerlink" title="2.3 V-htmlæŒ‡ä»¤"></a>2.3 V-htmlæŒ‡ä»¤</h2><ul>
<li>1.æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»æœåŠ¡å™¨è¯·æ±‚åˆ°çš„æ•°æ®æœ¬èº«å°±æ˜¯ä¸€ä¸ªHTMLä»£ç <ul>
<li>å¦‚æœæˆ‘ä»¬ç›´æ¥é€šè¿‡&lt;!â€“swigï¿¼163â€“&gt; </li>
</ul>
</li>
</ul>
<p>3.æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢ä»£ç æ¢æˆè®¡ç®—å±æ€§</p>
<p>è®¡ç®—å±æ€§æ˜¯å†™åœ¨å®ä¾‹çš„computedé€‰é¡¹ä¸­çš„</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;firstName&#125;&#125; &#123;&#123;lastName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;firstName+&quot; &quot;+lastName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;getFullName()&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line"><span class="javascript">      message: <span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      firstName: <span class="string">&#x27;zhuang&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      lastName: <span class="string">&#x27;kang&#x27;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">fullName</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="built_in">this</span>.firstName+<span class="string">&quot; &quot;</span>+<span class="built_in">this</span>.lastName</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">getFullName</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="built_in">this</span>.firstName+<span class="string">&quot; &quot;</span>+<span class="built_in">this</span>.lastName</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_12-49-23.png"></p>
<h2 id="3-6-è®¡ç®—å±æ€§çš„é«˜çº§æ“ä½œ"><a href="#3-6-è®¡ç®—å±æ€§çš„é«˜çº§æ“ä½œ" class="headerlink" title="3.6 è®¡ç®—å±æ€§çš„é«˜çº§æ“ä½œ"></a>3.6 è®¡ç®—å±æ€§çš„é«˜çº§æ“ä½œ</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ€»ä»·æ ¼:&#123;&#123;totalPrice&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line">      books:[</span><br><span class="line"><span class="javascript">        &#123;<span class="attr">id</span>:<span class="number">1</span>,<span class="attr">name</span>: <span class="string">&#x27;ä¹¦1&#x27;</span>,<span class="attr">price</span>:<span class="number">10</span>&#125;,</span></span><br><span class="line"><span class="javascript">        &#123;<span class="attr">id</span>:<span class="number">2</span>,<span class="attr">name</span>: <span class="string">&#x27;ä¹¦2&#x27;</span>,<span class="attr">price</span>:<span class="number">15</span>&#125;,</span></span><br><span class="line"><span class="javascript">        &#123;<span class="attr">id</span>:<span class="number">3</span>,<span class="attr">name</span>: <span class="string">&#x27;ä¹¦3&#x27;</span>,<span class="attr">price</span>:<span class="number">20</span>&#125;,</span></span><br><span class="line"><span class="javascript">        &#123;<span class="attr">id</span>:<span class="number">4</span>,<span class="attr">name</span>: <span class="string">&#x27;ä¹¦4&#x27;</span>,<span class="attr">price</span>:<span class="number">30</span>&#125;,</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    computed:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">totalPrice</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//é«˜çº§ç”¨æ³• filter/map/reduce</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> result=<span class="number">0</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="built_in">this</span>.books.length;i++)&#123;</span></span><br><span class="line"><span class="javascript">          result+=<span class="built_in">this</span>.books[i].price</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> result</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_13-04-06.png"></p>
<h2 id="3-7-è®¡ç®—å±æ€§ä¸­çš„getterå’Œsetteræ–¹æ³•"><a href="#3-7-è®¡ç®—å±æ€§ä¸­çš„getterå’Œsetteræ–¹æ³•" class="headerlink" title="3.7 è®¡ç®—å±æ€§ä¸­çš„getterå’Œsetteræ–¹æ³•"></a>3.7 è®¡ç®—å±æ€§ä¸­çš„getterå’Œsetteræ–¹æ³•</h2><ul>
<li>æ¯ä¸ªè®¡ç®—å±æ€§éƒ½åŒ…æ‹¬ä¸€ä¸ªgetterå’Œä¸€ä¸ªsetter</li>
<li>è¯­æ³•ç³–æƒ…å†µä¸‹ï¼Œè¡¨ç¤ºgetterï¼Œå–æ•°æ®</li>
<li>setterä¸€èˆ¬ä¸ç”¨</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      firstName:<span class="string">&#x27;zhuang&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      lastName:<span class="string">&#x27;kang&#x27;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    computed:&#123;</span><br><span class="line"><span class="javascript">      <span class="comment">//ä¸åŠ åŠ¨è¯ï¼Œè®¡ç®—å±æ€§ï¼Œä»¥å±æ€§å‘½å</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//è¯­æ³•ç³–ï¼Œç®€å†™</span></span></span><br><span class="line">      /*fullName() &#123;</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="built_in">this</span>.firstName+<span class="string">&quot; &quot;</span>+<span class="built_in">this</span>.lastName;</span></span><br><span class="line">      &#125;*/</span><br><span class="line">      fullName:&#123;</span><br><span class="line"><span class="javascript">        <span class="comment">//å±æ€§ä¸­getæ–¹æ³•ä¸é€‚ç”¨ï¼Œåªæ˜¯ä¸€ä¸ªåªè¯»å±æ€§</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">set</span>(<span class="params">newValue</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">&#x27;--&gt;&#x27;</span>,newValue);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> names=newValue.split(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.firstName=names[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.firstName=names[<span class="number">1</span>];</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">get</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="built_in">this</span>.firstName+<span class="string">&quot; &quot;</span>+<span class="built_in">this</span>.lastName</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_13-13-11.png"></p>
<h2 id="3-8-è®¡ç®—å±æ€§å’Œmethodsæ–¹æ³•å¯¹æ¯”"><a href="#3-8-è®¡ç®—å±æ€§å’Œmethodsæ–¹æ³•å¯¹æ¯”" class="headerlink" title="3.8 è®¡ç®—å±æ€§å’Œmethodsæ–¹æ³•å¯¹æ¯”"></a>3.8 è®¡ç®—å±æ€§å’Œmethodsæ–¹æ³•å¯¹æ¯”</h2><p>åŒ…å«ä¸€ä¸ªçŸ¥è¯†ç‚¹</p>
<ul>
<li><p>è®¡ç®—å±æ€§çš„ç¼“å­˜</p>
</li>
<li><p>methodså’Œcomputedçœ‹èµ·æ¥éƒ½å¯ä»¥å®ç°æˆ‘ä»¬çš„åŠŸèƒ½</p>
</li>
<li><p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦å¤šä¸€ä¸ªè®¡ç®—å±æ€§è¿™ä¸ªä¸œè¥¿å‘¢ï¼Ÿ</p>
</li>
<li><p>åŸå› ï¼šè®¡ç®—å±æ€§ä¼šè¿›è¡Œç¼“å­˜ï¼Œå¦‚æœå¤šæ¬¡ä½¿ç”¨,è®¡ç®—å±æ€§åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œæå¤§æé«˜äº†æ€§èƒ½</p>
</li>
<li><p>é™¤éåŸå±æ€§å‘ç”Ÿæ”¹å˜ï¼Œæ‰ä¼šé‡æ–°è°ƒç”¨è®¡ç®—å±æ€§ï¼Œæ›´æ”¹å±æ€§å€¼</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  1.ç›´æ¥æ‹¼æ¥:è¯­æ³•è¿‡äºç¹ç--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;firstName&#125;&#125; &#123;&#123;lastName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  2.é€šè¿‡å®šä¹‰methods--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;getFullName()&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;getFullName()&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;getFullName()&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  3.é€šè¿‡computed--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      firstName:<span class="string">&#x27;Lebron&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      lastName:<span class="string">&#x27;James&#x27;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">getFullName</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;getFullName&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="built_in">this</span>.firstName+<span class="string">&quot; &quot;</span>+<span class="built_in">this</span>.lastName</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">fullName</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;fullName&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="built_in">this</span>.firstName+<span class="string">&#x27; &#x27;</span>+<span class="built_in">this</span>.lastName</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_13-21-42.png"></p>
<h2 id="3-9-ES6è¡¥å……"><a href="#3-9-ES6è¡¥å……" class="headerlink" title="3.9 ES6è¡¥å……"></a>3.9 ES6è¡¥å……</h2><p>è¿™é‡Œä¸åšç¬”è®°ï¼Œåç»­å­¦ä¹ ES6çŸ¥è¯†ç‚¹ï¼</p>
<h2 id="3-10-V-onæŒ‡ä»¤"><a href="#3-10-V-onæŒ‡ä»¤" class="headerlink" title="3.10 V-onæŒ‡ä»¤"></a>3.10 V-onæŒ‡ä»¤</h2><p><strong>äº‹ä»¶ç›‘å¬</strong></p>
<ul>
<li>ä½œç”¨ï¼šç»‘å®šäº‹ä»¶ç›‘å¬å™¨</li>
<li>ç¼©å†™ï¼š@</li>
<li>é¢„æœŸï¼šFunction | Inline Statement | Object</li>
<li>å‚æ•°ï¼ševent</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>å½“å‰è®¡æ•°å™¨æ˜¯:&#123;&#123;counter&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;counter++&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;counter--&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;decrement&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  ç®€ä¾¿å†™æ³•--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;decrement&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line">      counter:0</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">increment</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.counter++</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">decrement</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.counter--</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_13-30-56.png"></p>
<h2 id="3-11-V-onå‚æ•°ä¼ é€’é—®é¢˜"><a href="#3-11-V-onå‚æ•°ä¼ é€’é—®é¢˜" class="headerlink" title="3.11 V-onå‚æ•°ä¼ é€’é—®é¢˜"></a>3.11 V-onå‚æ•°ä¼ é€’é—®é¢˜</h2><p><strong>å‚æ•°</strong></p>
<p>å½“é€šè¿‡methodsä¸­å®šä¹‰æ–¹æ³•ï¼Œä»¥ä¾›@clickè°ƒç”¨æ—¶ï¼Œéœ€è¦æ³¨æ„å‚æ•°é—®é¢˜ï¼š</p>
<ul>
<li>æƒ…å†µä¸€ï¼šå¦‚æœè¯¥æ–¹æ³•ä¸éœ€è¦é¢å¤–å‚æ•°ï¼Œé‚£ä¹ˆæ–¹æ³•åçš„()å¯ä»¥ä¸æ·»åŠ ã€‚ä½†æ˜¯æ³¨æ„ï¼šå¦‚æœæ–¹æ³•æœ¬èº«ä¸­æœ‰ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆä¼šé»˜è®¤å°†åŸç”Ÿäº‹ä»¶eventå‚æ•°ä¼ é€’è¿›å»</li>
<li>æƒ…å†µäºŒï¼šå¦‚æœéœ€è¦åŒæ—¶ä¼ å…¥æŸä¸ªå‚æ•°ï¼ŒåŒæ—¶éœ€è¦eventæ—¶ï¼Œå¯ä»¥é€šè¿‡$eventä¼ å…¥äº‹ä»¶</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  äº‹ä»¶è°ƒç”¨çš„æ–¹æ³•æ²¡æœ‰å‚æ•°--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;btn1Click()&quot;</span>&gt;</span>æŒ‰é’®1-1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;btn1Click&quot;</span>&gt;</span>æŒ‰é’®1-2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  åœ¨äº‹ä»¶å®šä¹‰æ—¶ï¼Œå†™å‡½æ•°çœç•¥äº†å°æ‹¬å·ï¼Œå‡¡æ˜¯æ–¹æ³•æœ¬èº«æ˜¯éœ€è¦å°æ‹¬å·çš„--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  è¿™ä¸ªæ—¶å€™ï¼ŒVueä¼šé»˜è®¤å°†æµè§ˆå™¨ç”Ÿäº§çš„eventäº‹ä»¶å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥åˆ°æ–¹æ³•--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">&quot;color: green&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;btn2Click&quot;</span>&gt;</span>æŒ‰é’®2-1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  å¦‚æœå‡½æ•°éœ€è¦å‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰ä¼ å…¥ï¼Œå¦‚æœæœ‰æ‹¬å·çš„è¯ï¼Œé‚£ä¹ˆå‡½æ•°çš„å½¢å‚ä¸ºunderfined--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">&quot;color: green&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;btn2Click()&quot;</span>&gt;</span>æŒ‰é’®2-2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">&quot;color: green&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;btn2Click(123)&quot;</span>&gt;</span>æŒ‰é’®2-3<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  å®šä¹‰æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬éœ€è¦eventå¯¹è±¡ï¼ŒåŒæ—¶åˆéœ€è¦å…¶ä»–å‚æ•°--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  åœ¨è°ƒç”¨æ–¹å¼ï¼Œå¦‚ä½•æ‰‹åŠ¨çš„è·å–åˆ°æµè§ˆå™¨å‚æ•°çš„eventå¯¹è±¡:  $event--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">&quot;color: blue&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;btn3Click(123,$event)&quot;</span>&gt;</span>æŒ‰é’®3<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk! &quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">btn1Click</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;btn1Click&quot;</span>);</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">btn2Click</span>(<span class="params">event</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;------------------&quot;</span>,event);</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">btn3Click</span>(<span class="params">abc,event</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;++++++++++++++++++&quot;</span>,abc, event);</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_13-35-40.png"></p>
<h2 id="3-12-v-onä¿®é¥°ç¬¦"><a href="#3-12-v-onä¿®é¥°ç¬¦" class="headerlink" title="3.12 v-onä¿®é¥°ç¬¦"></a>3.12 v-onä¿®é¥°ç¬¦</h2><p><strong>ï¼ˆä¸€ï¼‰åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‹¿åˆ°eventçš„ç›®çš„å¯èƒ½æ˜¯è¿›è¡Œä¸€äº›äº‹ä»¶å¤„ç†</strong><br><strong>ï¼ˆäºŒï¼‰Vueæä¾›äº†ä¿®é¥°ç¬¦æ¥å¸®åŠ©æˆ‘ä»¬æ–¹ä¾¿çš„å¤„ç†ä¸€äº›äº‹ä»¶ï¼š</strong></p>
<ul>
<li><p>.stop-è°ƒç”¨event.stopPropagation()</p>
</li>
<li><p>.prevent-è°ƒç”¨event.preventDefault()</p>
</li>
<li><p>.{keyCode | keyAlias}-åªå½“äº‹ä»¶æ˜¯ä»ç‰¹å®šé”®è§¦å‘æ—¶æ‰è§¦å‘å›è°ƒ</p>
</li>
<li><p>.once-åªè§¦å‘ä¸€æ¬¡å›è°ƒ</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&quot;divClick&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    stopä¿®é¥°ç¬¦--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.stop</span>=<span class="string">&quot;btn1Click&quot;</span>&gt;</span>æŒ‰é’®1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;www.baidu.com&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    preventä¿®é¥°ç¬¦--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span> @<span class="attr">click.prevent</span>=<span class="string">&quot;submitClick&quot;</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  ç›‘å¬keyup.enter--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup</span>=<span class="string">&quot;keyUp&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  onceä¿®é¥°ç¬¦--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.once</span>=<span class="string">&quot;btn2Click&quot;</span>&gt;</span>æŒ‰é’®2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line">      counter:0</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">btn1Click</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;btn1Click&quot;</span>);</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">divClick</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;divClock&#x27;</span>);</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">submitClick</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;submitClick&#x27;</span>);</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">keyUp</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;keyUp&#x27;</span>);</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">btn2Click</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;btn2Click&#x27;</span>);</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_13-47-34.png"></p>
<h2 id="3-13-v-if-v-else-v-if-elseæŒ‡ä»¤"><a href="#3-13-v-if-v-else-v-if-elseæŒ‡ä»¤" class="headerlink" title="3.13 v-if v-else v-if-elseæŒ‡ä»¤"></a>3.13 v-if v-else v-if-elseæŒ‡ä»¤</h2><p><strong>v-if,v-else-if,v-else</strong></p>
<ul>
<li><p>è¿™ä¸‰ä¸ªæŒ‡ä»¤ä¸JavaScriptçš„æ¡ä»¶è¯­å¥if,else,else ifç±»ä¼¼</p>
</li>
<li><p>Vueçš„æ¡ä»¶æŒ‡ä»¤å¯ä»¥æ ¹æ®è¡¨è¾¾å¼çš„å€¼åœ¨DMä¸­æ¸²æŸ“æˆ–é”€æ¯å…ƒç´ æˆ–ç»„ä»¶</p>
</li>
</ul>
<p><strong>v-ifåŸç†</strong></p>
<ul>
<li><p>v-ifåé¢çš„æ¡ä»¶ä¸ºflaseæ—¶ï¼Œå¯¹åº”çš„å…ƒç´ ä»¥åŠå…¶å­å…ƒç´ ä¸ä¼šæ¸²æŸ“</p>
</li>
<li><p>ä¹Ÿå°±æ˜¯æ ¹æœ¬æ²¡æœ‰ä¸ä¼šæœ‰å¯¹åº”çš„æ ‡ç­¾å‡ºç°åœ¨DOMä¸­</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  å¤šé‡åˆ†æ”¯ï¼Œä¸å»ºè®®ç›´æ¥ç”¨æ ‡ç­¾ï¼Œå»ºè®®ç”¨è®¡ç®—å±æ€§å»åš--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-if</span>=<span class="string">&quot;score&gt;=90&quot;</span>&gt;</span>ä¼˜ç§€<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else-if</span>=<span class="string">&quot;score&gt;=80&quot;</span>&gt;</span>è‰¯å¥½<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else-if</span>=<span class="string">&quot;score&gt;=60&quot;</span>&gt;</span>åŠæ ¼<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else</span>&gt;</span>ä¸åŠæ ¼<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;result&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk !&quot;</span>,</span></span><br><span class="line">      score:95,</span><br><span class="line">    &#125;,</span><br><span class="line">    computed:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">result</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> showMessage = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span>(<span class="built_in">this</span>.score&gt;=<span class="number">90</span>)&#123;</span></span><br><span class="line"><span class="javascript">          showMessage = <span class="string">&#x27;ä¼˜ç§€&#x27;</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">this</span>.score&gt;=<span class="number">80</span>)&#123;</span></span><br><span class="line"><span class="javascript">          showMessage = <span class="string">&#x27;è‰¯å¥½&#x27;</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">this</span>.score&gt;=<span class="number">60</span>)&#123;</span></span><br><span class="line"><span class="javascript">          showMessage = <span class="string">&#x27;åŠæ ¼&#x27;</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="javascript">          showMessage = <span class="string">&#x27;ä¸åŠæ ¼&#x27;</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> showMessage;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_13-52-47.png"></p>
<h2 id="3-14-åˆ‡æ¢ç™»å½•å°æ¡ˆä¾‹"><a href="#3-14-åˆ‡æ¢ç™»å½•å°æ¡ˆä¾‹" class="headerlink" title="3.14 åˆ‡æ¢ç™»å½•å°æ¡ˆä¾‹"></a>3.14 åˆ‡æ¢ç™»å½•å°æ¡ˆä¾‹</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;isUser&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·ç™»å½•<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ç”¨æˆ·è´¦å·&quot;</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;email&quot;</span>&gt;</span>ç”¨æˆ·é‚®ç®±<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ç”¨æˆ·é‚®ç®±&quot;</span> <span class="attr">key</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;isUserClick()&quot;</span>&gt;</span>åˆ‡æ¢ç™»å½•æ–¹å¼<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      isUser:<span class="literal">true</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">isUserClick</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.isUser=!<span class="built_in">this</span>.isUser;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_20-08-29.png"></p>
<p>å¦‚æœæˆ‘ä»¬åœ¨æœ‰è¾“å…¥å†…å®¹çš„æƒ…å†µä¸‹ï¼Œåˆ‡æ¢äº†ç±»å‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ–‡å­—ä¸€ä»ç„¶æ˜¾ç¤ºä¹‹å‰çš„è¾“å…¥çš„å†…å®¹<br>ä½†æ˜¯æŒ‰é“ç†è®²ï¼Œæˆ‘ä»¬åº”è¯¥åˆ‡æ¢åˆ°å¦ä¸€ä¸ªinputçš„å…ƒç´ ä¸­<br>åœ¨å¦ä¸€ä¸ªinputå…ƒç´ ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¾“å…¥å†…å®¹<br>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>
<ul>
<li><p>è¿™æ˜¯å› ä¸ºVueåœ¨è¿›è¡ŒDOMæ¸²æŸ“æ—¶ï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œä¼šå°½å¯èƒ½çš„å¤ç”¨å·²ç»å­˜åœ¨çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯é‡æ–°åˆ›å»ºæ–°çš„å…ƒç´ <br>åœ¨æ¡ˆä¾‹ä¸­ï¼ŒVueå†…éƒ¨ä¼šå‘ç°åŸæ¥çš„inputå…ƒç´ ä¸å†ä½¿ç”¨ï¼Œç›´æ¥ä½œä¸ºelseä¸­inputæ¥ä½¿ç”¨</p>
</li>
<li><p>å¦‚æœæˆ‘ä»¬ä¸è€ƒè™‘Vueå‡ºç°ç±»ä¼¼é‡å¤åˆ©ç”¨çš„é—®é¢˜ï¼Œå¯ä»¥ç»™å¯¹åº”çš„inputæ·»åŠ key<br>å¹¶ä¸”ä¿è¯keyä¸ç›¸åŒ</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;isUser&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·è´¦å·<span class="tag">&lt;/<span class="name">label</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ç”¨æˆ·è´¦å·&quot;</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;email&quot;</span>&gt;</span>ç”¨æˆ·é‚®ç®±<span class="tag">&lt;/<span class="name">label</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ç”¨æˆ·é‚®ç®±&quot;</span> <span class="attr">key</span>=<span class="string">&quot;email&quot;</span>&gt;</span>  <span class="tag">&lt;/<span class="name">span</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;isUserClick()&quot;</span>&gt;</span>åˆ‡æ¢ç™»å½•æ–¹å¼<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="3-15-v-showæŒ‡ä»¤"><a href="#3-15-v-showæŒ‡ä»¤" class="headerlink" title="3.15 v-showæŒ‡ä»¤"></a>3.15 v-showæŒ‡ä»¤</h2><p><strong>ï¼ˆä¸€ï¼‰v-showçš„ç”¨æ³•å’Œv-iféå¸¸ç›¸ä¼¼ï¼Œä¹Ÿç”¨äºå†³å®šä¸€ä¸ªå…ƒç´ æ˜¯å¦æ¸²æŸ“</strong><br><strong>ï¼ˆäºŒï¼‰v-ifå’Œv-showéƒ½å¯ä»¥å†³å®šä¸€ä¸ªå…ƒç´ æ˜¯å¦æ¸²æŸ“ï¼Œé‚£ä¹ˆå¼€å‘ä¸­æˆ‘ä»¬å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ</strong></p>
<ul>
<li>v-ifå½“æ¡ä»¶ä¸ºfalseæ—¶ï¼Œå‹æ ¹ä¸ä¼šæœ‰å¯¹åº”çš„å…ƒç´ åœ¨DOMä¸­</li>
<li>v-showå½“æ¡ä»¶ä¸ºfalseï¼Œä»…ä»…æ˜¯å°†å…ƒç´ çš„displayå±æ€§è®¾ç½®ä¸ºnoneè€Œå·²</li>
</ul>
<p><strong>ï¼ˆä¸‰ï¼‰å¼€å‘ç§å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ</strong></p>
<ul>
<li>å½“éœ€è¦åœ¨æ˜¾ç¤ºä¸éšè—ä¹‹é—´åˆ‡ç‰‡å¾ˆé¢‘ç¹æ—¶ï¼Œä½¿ç”¨v-show</li>
<li>å½“åªæœ‰ä¸€æ¬¡åˆ‡æ¢æ—¶ï¼Œé€šè¿‡ä½¿ç”¨v-if</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  v-if :å½“æ¡ä»¶ä¸ºfalseæ—¶ï¼ŒåŒ…å«v-ifæŒ‡ä»¤çš„å…ƒç´ ã€‚æ ¹æœ¬å°±ä¸ä¼šå­˜åœ¨domä¸­--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-if</span>=<span class="string">&quot;isShow&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  v-show: å½“æ¡ä»¶ä¸ºfalseæ—¶ï¼Œv-showåªæ˜¯ç»™æˆ‘ä»¬çš„å…ƒç´ æ·»åŠ ä¸€ä¸ªè¡Œå†…æ ·å¼ï¼šdisplay:none--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-show</span>=<span class="string">&quot;isShow&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      isShow:<span class="literal">true</span>,</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-16-v-foræ•°ç»„éå†"><a href="#3-16-v-foræ•°ç»„éå†" class="headerlink" title="3.16 v-foræ•°ç»„éå†"></a>3.16 v-foræ•°ç»„éå†</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in movies&quot;</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      movies:[<span class="string">&quot;é€Ÿåº¦ä¸æ¿€æƒ…&quot;</span>,<span class="string">&quot;æµ·è´¼ç‹&quot;</span>,<span class="string">&quot;ç›—å¢“ç¬”è®°&quot;</span>,<span class="string">&quot;æˆé¾™å†é™©è®°&quot;</span>]</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-20_21-34-24.png"></p>
<h2 id="3-17-v-forå¯¹è±¡éå†"><a href="#3-17-v-forå¯¹è±¡éå†" class="headerlink" title="3.17 v-forå¯¹è±¡éå†"></a>3.17 v-forå¯¹è±¡éå†</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  ç›´æ¥è¾“å‡º--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123;info.name&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123;info.age&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123;info.height&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123;info.weight&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  1.åœ¨éå†å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåªæ˜¯è·å–ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆè·å–åˆ°çš„æ˜¯value--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in info&quot;</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  2.è·å–keyå’Œvalue         å‰é¢ä¸ºvalueï¼Œåé¢ä¸ºkey   æ ¼å¼(value,key)--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(value,key) in info&quot;</span>&gt;</span>&#123;&#123;key&#125;&#125;:&#123;&#123;value&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  3.è·å–keyå’Œvalueï¼Œindex  æ ¼å¼ï¼š(value,key,index)--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(value,key,index) in info&quot;</span>&gt;</span>[&#123;&#123;index&#125;&#125;]&#123;&#123;key&#125;&#125;:&#123;&#123;value&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk!&quot;</span>,</span></span><br><span class="line">      info :&#123;</span><br><span class="line"><span class="javascript">        name:<span class="string">&#x27;zk&#x27;</span>,</span></span><br><span class="line">        age:20,</span><br><span class="line">        height:1.88,</span><br><span class="line">        weight:68.5,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-21_20-54-14.png"></p>
<h2 id="3-18-v-modelæŒ‡ä»¤"><a href="#3-18-v-modelæŒ‡ä»¤" class="headerlink" title="3.18 v-modelæŒ‡ä»¤"></a>3.18 v-modelæŒ‡ä»¤</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  åŒå‘ç»‘å®š--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;message&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  input æœ‰ä¸ªç›‘å¬äº‹ä»¶ï¼Œç”¨äºç›‘å¬ç”¨æˆ·è¾“å…¥ï¼Œåå‘ç»‘å®šmessageçš„å€¼ï¼Œå®ç°åŒå‘ç»‘å®š--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;message&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;message=$event.target.value&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">valueChange</span>(<span class="params">event</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//ä¸€æ—¦åœ¨ç•Œé¢ä¸­äº§ç”Ÿä¸€ä¸ªäº‹ä»¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªeventå¯¹è±¡</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//enentå¯¹è±¡ä¸­ï¼Œæœ‰æˆ‘ä»¬éœ€è¦value,åœ¨eventä¸­çš„targetä¸­</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//åœ¨è°ƒç”¨å‡½æ•°ä¸­ï¼Œå¦‚æœçœç•¥çš„å®å‚ï¼Œè€Œå®šä¹‰å‡½æ•°æ—¶ï¼Œæœ‰å½¢å‚ï¼Œä¼šè‡ªåŠ¨å°†eventå½“åšå®å‚ä¼ å…¥</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.message = event.target.value</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Snipaste_2021-05-18_21-36-05.png" alt="Snipaste_2021-05-18_21-36-05.png"></p>
<p>ç»“åˆradioä½¿ç”¨</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;male&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  å¦‚æœä¸åŠ nameï¼Œä¼šå¯¼è‡´å¯ä»¥åŒæ—¶å‹¾é€‰ç”·å¥³ï¼ŒåŠ ä¸Šnameï¼Œé‚£ä¹ˆæäº¤ç»™æ•°æ®åº“çš„æ—¶å€™ï¼Œkeyæ˜¯å”¯ä¸€çš„sexï¼Œæ‰€ä»¥åªèƒ½é€‰ä¸€ä¸ª--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  &lt;input type=&quot;radio&quot; id=&quot;male&quot; name=&quot;sex&quot;&gt;ç”·--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  å½“ç„¶äº†ï¼Œå¦‚æœæˆ‘ä»¬åŠ ä¸Šv-modelï¼Œå¹¶ä¸”ç»‘å®šåŒä¸€ä¸ªå…ƒç´ çš„è¯ï¼Œnameå°±å¯ä»¥ä¸æ·»åŠ äº†ï¼Œå› ä¸ºä¹Ÿæ˜¯äº’æ–¥çš„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">id</span>=<span class="string">&quot;male&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç”·&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>ç”·</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;female&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">id</span>=<span class="string">&quot;female&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¥³&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>å¥³</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ‚¨é€‰æ‹©çš„æ€§åˆ«æ˜¯ï¼š&#123;&#123;sex&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      sex: <span class="string">&#x27;ç”·&#x27;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Snipaste_2021-05-18_21-36-20.png" alt="Snipaste_2021-05-18_21-36-20.png"></p>
<h1 id="4ï¼Œè´­ç‰©è½¦å°æ¡ˆä¾‹"><a href="#4ï¼Œè´­ç‰©è½¦å°æ¡ˆä¾‹" class="headerlink" title="4ï¼Œè´­ç‰©è½¦å°æ¡ˆä¾‹"></a>4ï¼Œè´­ç‰©è½¦å°æ¡ˆä¾‹</h1><p><strong>index.html</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;books.length&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>ä¹¦ç±åç§°<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>å‡ºç‰ˆæ—¥æœŸ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>ä»·æ ¼<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>è´­ä¹°æ•°é‡<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&quot;(book,index) in books&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--      &lt;td v-for=&quot;value in book&quot;&gt;&#123;&#123;value&#125;&#125;&lt;/td&gt;--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;book.id&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;book.name&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;book.date&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;book.price | showPrice&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;decrement(index)&quot;</span><span class="attr">:disabled</span>=<span class="string">&quot;book.count&lt;=1&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        &#123;&#123;book.count&#125;&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;increment(index)&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;removeHandle(index)&quot;</span>&gt;</span>ç§»é™¤<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ€»ä»·æ ¼ï¼š&#123;&#123;totalPrice | showPrice&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-else</span>&gt;</span>è´­ç‰©è½¦ä¸ºç©º<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>main.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  data:&#123;</span><br><span class="line">    books:[</span><br><span class="line">      &#123;</span><br><span class="line">        id:<span class="number">1</span>,</span><br><span class="line">        name:<span class="string">&#x27;ä»£ç é‡æ„&#x27;</span>,</span><br><span class="line">        date:<span class="string">&#x27;2006-9&#x27;</span>,</span><br><span class="line">        price:<span class="number">85.00</span>,</span><br><span class="line">        count:<span class="number">1</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        id:<span class="number">2</span>,</span><br><span class="line">        name:<span class="string">&#x27;Linuxå¤§å…¨&#x27;</span>,</span><br><span class="line">        date:<span class="string">&#x27;2006-2&#x27;</span>,</span><br><span class="line">        price:<span class="number">59.00</span>,</span><br><span class="line">        count:<span class="number">1</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        id:<span class="number">3</span>,</span><br><span class="line">        name:<span class="string">&#x27;ç¼–ç¨‹ä¹‹ç¾&#x27;</span>,</span><br><span class="line">        date:<span class="string">&#x27;2008-10&#x27;</span>,</span><br><span class="line">        price:<span class="number">39.00</span>,</span><br><span class="line">        count:<span class="number">1</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        id:<span class="number">4</span>,</span><br><span class="line">        name:<span class="string">&#x27;ä»£ç å¤§å…¨&#x27;</span>,</span><br><span class="line">        date:<span class="string">&#x27;2006-3&#x27;</span>,</span><br><span class="line">        price:<span class="number">128.00</span>,</span><br><span class="line">        count:<span class="number">1</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    <span class="function"><span class="title">getFinalPrice</span>(<span class="params">price</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;ï¿¥&#x27;</span> + price.toFixed(<span class="number">2</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">decrement</span>(<span class="params">index</span>)</span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.books[index].count--</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">increment</span>(<span class="params">index</span>)</span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.books[index].count++</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">removeHandle</span>(<span class="params">index</span>)</span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.books.splice(index,<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  filters:&#123;</span><br><span class="line">    <span class="function"><span class="title">showPrice</span>(<span class="params">price</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;ï¿¥&#x27;</span> + price.toFixed(<span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed:&#123;</span><br><span class="line">    <span class="function"><span class="title">totalPrice</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">let</span> totalPrice = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i&lt; <span class="built_in">this</span>.books.length; i++)&#123;</span><br><span class="line">        totalPrice += <span class="built_in">this</span>.books[i].price*<span class="built_in">this</span>.books[i].count;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> totalPrice;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>style.css</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">table</span>&#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#e9e9e9</span>;</span><br><span class="line">  <span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">  <span class="attribute">border-spacing</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">th</span>,<span class="selector-tag">td</span>&#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#e9e9e9</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">th</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f7f7f7</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#5c6b77</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ•ˆæœå±•ç¤º</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-22_21-09-46.png"></p>
<h1 id="5ï¼ŒJavaScripté«˜é˜¶å‡½æ•°è®²è§£"><a href="#5ï¼ŒJavaScripté«˜é˜¶å‡½æ•°è®²è§£" class="headerlink" title="5ï¼ŒJavaScripté«˜é˜¶å‡½æ•°è®²è§£"></a>5ï¼ŒJavaScripté«˜é˜¶å‡½æ•°è®²è§£</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  åŸæ¥çš„æ•°ç»„--&gt;&#123;&#123;nums&#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  å°äº100åè¿‡æ»¤çš„æ•°ç»„--&gt;&#123;&#123;useFilter()&#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  ä¹˜ä»¥2çš„æ•°ç»„--&gt;&#123;&#123;useMap()&#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  ä¹˜ä»¥2ä»¥åçš„å„å…ƒç´ çš„å’Œçš„æ•°ç»„--&gt;&#123;&#123;useReduce()&#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  ä¸‰ç§å‡½æ•°è¿ç”¨--&gt;&#123;&#123;useOnceCount()&#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  ä¸€è¡Œä»£ç --&gt;&#123;&#123;useOnceRowCount()&#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line"><span class="javascript">      message: <span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line">      nums:[10, 20, 30, 40, 50, 60, 70]</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="javascript">    <span class="comment">//filter map reduce è®²è§£</span></span></span><br><span class="line">    /*</span><br><span class="line">    filter</span><br><span class="line">    è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ å¿…é¡»</span><br><span class="line"><span class="javascript">    è¿”å›<span class="literal">true</span> å‡½æ•°å†…éƒ¨æ·»åŠ å›è°ƒçš„å€¼åŠ å…¥æ•°ç»„ä¸­</span></span><br><span class="line"><span class="javascript">    è¿”å›<span class="literal">false</span> ä¸åŠ å…¥</span></span><br><span class="line">     */</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">useFilter</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> newNums = <span class="built_in">this</span>.nums.filter(<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">//å½“nå°äº100æ˜¯åŠ å…¥æ•°ç»„ä¸­</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> n &lt; <span class="number">100</span></span></span><br><span class="line">        &#125;)</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> newNums</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">useMap</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//å°†newNumsä¸­æ¯ä¸ªæ•°å­—Ã—2</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> new2Nums = <span class="built_in">this</span>.useFilter().map(<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> n * <span class="number">2</span></span></span><br><span class="line">        &#125;)</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> new2Nums</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">//ä½œç”¨ï¼šå¯¹æ•°ç»„ä¸­æ‰€æœ‰çš„å†…å®¹è¿›è¡Œæ±‡æ€»(ç›¸åŠ ï¼Œç›¸ä¹˜ç­‰ç­‰)</span></span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">useReduce</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> total = <span class="built_in">this</span>.useMap().reduce(<span class="function"><span class="keyword">function</span> (<span class="params">preValue, n</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> preValue + n</span></span><br><span class="line">        &#125;, 0)</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> total</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">useOnceCount</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> total = <span class="built_in">this</span>.nums.filter(<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> n &lt; <span class="number">100</span></span></span><br><span class="line"><span class="javascript">        &#125;).map(<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> n * <span class="number">2</span></span></span><br><span class="line"><span class="javascript">        &#125;).reduce(<span class="function"><span class="keyword">function</span> (<span class="params">preValue, n</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> preValue + n</span></span><br><span class="line">        &#125;, 0)</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> total</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">useOnceRowCount</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> total = <span class="built_in">this</span>.nums.filter(<span class="function"><span class="params">n</span> =&gt;</span> n &lt; <span class="number">100</span>).map(<span class="function"><span class="params">n</span> =&gt;</span> n * <span class="number">2</span>).reduce(<span class="function">(<span class="params">preValue, n</span>) =&gt;</span> preValue + n)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> total</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-22_22-00-11.png"></p>
<h1 id="6ï¼Œç»„ä»¶åŒ–å¼€å‘"><a href="#6ï¼Œç»„ä»¶åŒ–å¼€å‘" class="headerlink" title="6ï¼Œç»„ä»¶åŒ–å¼€å‘"></a>6ï¼Œç»„ä»¶åŒ–å¼€å‘</h1><h2 id="6-1-ç»„ä»¶åŒ–çš„åŸºæœ¬ä½¿ç”¨"><a href="#6-1-ç»„ä»¶åŒ–çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="6.1 ç»„ä»¶åŒ–çš„åŸºæœ¬ä½¿ç”¨"></a>6.1 ç»„ä»¶åŒ–çš„åŸºæœ¬ä½¿ç”¨</h2><p><strong>ä»€ä¹ˆæ˜¯ç»„ä»¶åŒ–ï¼Ÿ</strong></p>
<ul>
<li>äººé¢å¯¹å¤æ‚é—®é¢˜çš„å¤„ç†æ–¹å¼ï¼š</li>
</ul>
<p>ä»»ä½•ä¸€ä¸ªäººå¤„ç†ä¿¡æ¯çš„é€»è¾‘èƒ½åŠ›éƒ½æ˜¯æœ‰é™çš„</p>
<p>æ‰€ä»¥ï¼Œå½“é¢å¯¹ä¸€ä¸ªéå¸¸å¤æ‚çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ä¸å¤ªå¯èƒ½ä¸€æ¬¡æ€§æå®šä¸€å¤§å †çš„å†…å®¹ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬äººæœ‰ä¸€ç§å¤©ç”Ÿçš„èƒ½åŠ›ï¼Œå°±æ˜¯å°†é—®é¢˜è¿›è¡Œæ‹†è§£ã€‚</p>
<p>å¦‚æœå°†ä¸€ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œæ‹†åˆ†æˆå¾ˆå¤šä¸ªå¯ä»¥å¤„ç†çš„å°é—®é¢˜ï¼Œå†å°†å…¶æ”¾åœ¨æ•´ä½“å½“ä¸­ï¼Œä½ ä¼šå‘ç°å¤§çš„é—®é¢˜ä¹Ÿä¼šè¿åˆƒè€Œè§£</p>
<ul>
<li>ç»„ä»¶åŒ–ä¹Ÿæ˜¯ç±»ä¼¼çš„æ€æƒ³ï¼š</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªé¡µé¢ä¸­æ‰€æœ‰çš„å¤„ç†é€»è¾‘å…¨éƒ¨æ”¾åœ¨ä¸€èµ·ï¼Œå¤„ç†èµ·æ¥å°±ä¼šå˜å¾—éå¸¸å¤æ‚ï¼Œè€Œä¸”ä¸åˆ©äºåç»­çš„ç®¡ç†ä»¥åŠæ‰©å±•ã€‚</p>
<p>ä½†å¦‚æœï¼Œæˆ‘ä»¬è®²ä¸€ä¸ªé¡µé¢æ‹†åˆ†æˆä¸€ä¸ªä¸ªå°çš„åŠŸèƒ½å—ï¼Œæ¯ä¸ªåŠŸèƒ½å—å®Œæˆå±äºè‡ªå·±è¿™éƒ¨åˆ†ç‹¬ç«‹çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆä¹‹åæ•´ä¸ªé¡µé¢çš„ç®¡ç†å’Œç»´æŠ¤å°±å˜å¾—éå¸¸å®¹æ˜“äº†</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_18-10-15.png"></p>
<blockquote>
<p>æˆ‘ä»¬å°†ä¸€ä¸ªå®Œæ•´çš„é¡µé¢åˆ†æˆå¾ˆå¤šä¸ªç»„ä»¶ã€‚</p>
<p>æ¯ä¸ªç»„ä»¶éƒ½ç”¨äºå®ç°é¡µé¢çš„ä¸€ä¸ªåŠŸèƒ½å—ã€‚</p>
<p>è€Œæ¯ä¸€ä¸ªç»„ä»¶åˆå¯ä»¥è¿›è¡Œç»†åˆ†ã€‚</p>
</blockquote>
<p><strong>Vueç»„ä»¶åŒ–æ€æƒ³</strong></p>
<p>ç»„ä»¶åŒ–æ˜¯Vue.jsä¸­çš„é‡è¦æ€æƒ³</p>
<p><strong>å®ƒæä¾›äº†ä¸€ç§æŠ½è±¡ï¼Œè®©æˆ‘ä»¬å¯ä»¥å¼€å‘å‡ºä¸€ä¸ªä¸ªç‹¬ç«‹å¯å¤ç”¨çš„å°ç»„ä»¶æ¥æ„é€ æˆ‘ä»¬çš„åº”ç”¨ã€‚</strong></p>
<p><strong>ä»»ä½•çš„åº”ç”¨éƒ½ä¼šè¢«æŠ½è±¡æˆä¸€é¢—ç»„ä»¶æ ‘</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_18-13-10.png"></p>
<ul>
<li>ç»„ä»¶åŒ–æ€æƒ³çš„åº”ç”¨ï¼š<ul>
<li>æœ‰äº†ç»„ä»¶åŒ–çš„æ€æƒ³ï¼Œæˆ‘ä»¬åœ¨ä¹‹åçš„å¼€å‘ä¸­å°±è¦å……åˆ†çš„åˆ©ç”¨å®ƒã€‚</li>
<li>å°½å¯èƒ½çš„å°†é¡µé¢æ‹†åˆ†æˆä¸€ä¸ªä¸ªå°çš„ã€å¯å¤ç”¨çš„ç»„ä»¶ã€‚</li>
<li>è¿™æ ·è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ æ–¹ä¾¿ç»„ç»‡å’Œç®¡ç†ï¼Œå¹¶ä¸”æ‰©å±•æ€§ä¹Ÿæ›´å¼º</li>
</ul>
</li>
</ul>
<p><strong>ç»„ä»¶çš„ä½¿ç”¨åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š</strong></p>
<ul>
<li><p>åˆ›å»ºç»„ä»¶æ„é€ å™¨</p>
</li>
<li><p>æ³¨å†Œç»„ä»¶</p>
</li>
<li><p>ä½¿ç”¨ç»„ä»¶</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_18-21-26.png"></p>
<p><strong>Vue.extend()ï¼š</strong></p>
<ul>
<li><p>è°ƒç”¨Vue.extend()åˆ›å»ºçš„æ˜¯ä¸€ä¸ªç»„ä»¶æ„é€ å™¨ã€‚ </p>
</li>
<li><p>é€šå¸¸åœ¨åˆ›å»ºç»„ä»¶æ„é€ å™¨æ—¶ï¼Œä¼ å…¥templateä»£è¡¨æˆ‘ä»¬è‡ªå®šä¹‰ç»„ä»¶çš„æ¨¡æ¿ã€‚</p>
</li>
<li><p>è¯¥æ¨¡æ¿å°±æ˜¯åœ¨ä½¿ç”¨åˆ°ç»„ä»¶çš„åœ°æ–¹ï¼Œè¦æ˜¾ç¤ºçš„HTMLä»£ç </p>
</li>
</ul>
<p><strong>Vue.component()ï¼š</strong></p>
<ul>
<li><p>è°ƒç”¨Vue.component()æ˜¯å°†åˆšæ‰çš„ç»„ä»¶æ„é€ å™¨æ³¨å†Œä¸ºä¸€ä¸ªç»„ä»¶ï¼Œå¹¶ä¸”ç»™å®ƒèµ·ä¸€ä¸ªç»„ä»¶çš„æ ‡ç­¾åç§°ã€‚</p>
</li>
<li><p>æ‰€ä»¥éœ€è¦ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼š1ã€æ³¨å†Œç»„ä»¶çš„æ ‡ç­¾å 2ã€ç»„ä»¶æ„é€ å™¨</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">my_cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> cpnC = Vue.extend(&#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">    template: `<span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>&gt;`</span></span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">  <span class="comment">//æ³¨å†Œç»„ä»¶</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">//component ä½¿ç”¨ç»„ä»¶çš„åå­—ï¼Œç»„ä»¶æ„é€ å™¨å</span></span></span><br><span class="line"><span class="javascript">  Vue.component(<span class="string">&#x27;my_cpn&#x27;</span>, cpnC)</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line"><span class="javascript">      message: <span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_18-31-46.png"></p>
<h2 id="6-2-å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡"><a href="#6-2-å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡" class="headerlink" title="6.2 å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡"></a>6.2 å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">my_cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app2&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> cpnC = Vue.extend(&#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">    template: `<span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>&gt;`</span></span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">  <span class="comment">//æ³¨å†Œç»„ä»¶</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">//component ä½¿ç”¨ç»„ä»¶çš„åå­—ï¼Œç»„ä»¶æ„é€ å™¨å</span></span></span><br><span class="line"><span class="javascript">  Vue.component(<span class="string">&#x27;my_cpn&#x27;</span>, cpnC)</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line"><span class="javascript">      message: <span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app2 = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&#x27;#app2&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="comment">//å±€éƒ¨æ³¨å†Œï¼Œåªæœ‰APPå®ä¾‹ç”¨æ­¤ç»„ä»¶</span></span></span><br><span class="line">    components: &#123;</span><br><span class="line"><span class="javascript">      <span class="comment">//å®šä¹‰æ ‡ç­¾ cpn</span></span></span><br><span class="line">      cpn: cpnC</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_18-33-35.png"></p>
<h2 id="6-3-çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶"><a href="#6-3-çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶" class="headerlink" title="6.3 çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶"></a>6.3 çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶</h2><p>ç»„ä»¶å’Œç»„ä»¶ä¹‹é—´å­˜åœ¨å±‚çº§å…³ç³»<br>è€Œå…¶ä¸­ä¸€ç§éå¸¸é‡è¦çš„å…³ç³»å°±æ˜¯çˆ¶å­ç»„ä»¶çš„å…³ç³»</p>
<p><strong>çˆ¶å­ç»„ä»¶é”™è¯¯ç”¨æ³•ï¼šä»¥å­æ ‡ç­¾çš„å½¢å¼åœ¨Vueå®ä¾‹ä¸­ä½¿ç”¨</strong></p>
<ul>
<li><p>å› ä¸ºå½“å­ç»„ä»¶æ³¨å†Œåˆ°çˆ¶ç»„ä»¶çš„componentsæ—¶ï¼ŒVueä¼šç¼–è¯‘å¥½çˆ¶ç»„ä»¶çš„æ¨¡å—</p>
</li>
<li><p>è¯¥æ¨¡å—çš„å†…å®¹å·²ç»å†³å®šäº†çˆ¶ç»„ä»¶å°†è¦æ¸²æŸ“çš„HTMLï¼ˆç›¸å½“äºçˆ¶ç»„ä»¶ä¸­å·²ç»æœ‰äº†å­ç»„ä»¶ä¸­å†…å®¹äº†ï¼‰</p>
</li>
<li><p>æ˜¯åªèƒ½åœ¨çˆ¶ç»„ä»¶ä¸­è¢«è¯†åˆ«çš„</p>
</li>
<li><p>ç±»ä¼¼è¿™ç§ç”¨æ³•ï¼Œæ˜¯ä¼šè¢«æµè§ˆå™¨å¿½ç•¥çš„</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn2</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> cpnC1 = Vue.extend(&#123;</span></span><br><span class="line">    template: `</span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯cpnC1<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line">    `</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  <span class="comment">// 2.åˆ›å»ºç¬¬äºŒä¸ªç»„ä»¶</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> cpnC2 = Vue.extend(&#123;</span></span><br><span class="line">    template: `</span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯cpnC2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">cpn1</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn1</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line">    `,</span><br><span class="line">    components: &#123;</span><br><span class="line">      cpn1: cpnC1</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  <span class="comment">//å¯ä»¥çœ‹æˆæ ¹ç»„ä»¶</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      cpn2: cpnC2</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-24_16-04-47.png"></p>
<h2 id="6-4-æ³¨å†Œç»„ä»¶çš„è¯­æ³•ç³–å†™æ³•"><a href="#6-4-æ³¨å†Œç»„ä»¶çš„è¯­æ³•ç³–å†™æ³•" class="headerlink" title="6.4 æ³¨å†Œç»„ä»¶çš„è¯­æ³•ç³–å†™æ³•"></a>6.4 æ³¨å†Œç»„ä»¶çš„è¯­æ³•ç³–å†™æ³•</h2><p>åœ¨ä¸Šé¢æ³¨å†Œç»„ä»¶çš„æ–¹å¼ï¼Œå¯èƒ½ä¼šæœ‰äº›ç¹çã€‚</p>
<ul>
<li><p>Vueä¸ºäº†ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œæä¾›äº†æ³¨å†Œçš„è¯­æ³•ç³–ã€‚</p>
</li>
<li><p>ä¸»è¦æ˜¯çœå»äº†è°ƒç”¨Vue.extend()çš„æ­¥éª¤ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡æ¥ä»£æ›¿ã€‚</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>å…¨å±€å˜é‡<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">my_cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>å±€éƒ¨å˜é‡<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_cpn1</span>&gt;</span><span class="tag">&lt;/<span class="name">my_cpn1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  /*</span><br><span class="line">  å…¨å±€ç»„ä»¶æ³¨å†Œçš„è¯­æ³•ç³–</span><br><span class="line">  åˆ›å»ºç»„ä»¶æ„é€ å™¨</span><br><span class="line">  æ³¨å†Œç»„ä»¶</span><br><span class="line">  å†…éƒ¨è°ƒç”¨extend</span><br><span class="line">   */</span><br><span class="line"><span class="javascript">  Vue.component(<span class="string">&#x27;my_cpn&#x27;</span>, &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">    template: `<span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¯­æ³•ç³–å†™æ³•<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>`</span></span></span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line"><span class="javascript">      message: <span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      my_cpn1: &#123;</span><br><span class="line"><span class="handlebars"><span class="xml">        template: `<span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>my_cpn1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span>`</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-24_16-33-27.png"></p>
<h2 id="6-5-ç»„ä»¶æ¨¡æ¿åˆ†ç¦»å†™æ³•"><a href="#6-5-ç»„ä»¶æ¨¡æ¿åˆ†ç¦»å†™æ³•" class="headerlink" title="6.5 ç»„ä»¶æ¨¡æ¿åˆ†ç¦»å†™æ³•"></a>6.5 ç»„ä»¶æ¨¡æ¿åˆ†ç¦»å†™æ³•</h2><p>é€šè¿‡è¯­æ³•ç³–ç®€åŒ–äº†Vueç»„ä»¶çš„æ³¨å†Œè¿‡ç¨‹ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹çš„å†™æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œå°±æ˜¯templateæ¨¡å—å†™æ³•ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬èƒ½å°†å…¶ä¸­çš„HTMLåˆ†ç¦»å‡ºæ¥å†™ï¼Œç„¶åæŒ‚è½½åˆ°å¯¹åº”çš„ç»„ä»¶ä¸Šï¼Œå¿…ç„¶ç»“æ„ä¼šå˜å¾—éå¸¸æ¸…æ™°ã€‚</p>
<p>Vueæä¾›äº†ä¸¤ç§æ–¹æ¡ˆæ¥å®šä¹‰HTMLæ¨¡å—å†…å®¹ï¼š</p>
<p><strong>pä½¿ç”¨<script>æ ‡ç­¾</strong></p>
<p><strong>pä½¿ç”¨<template>æ ‡ç­¾</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  &lt;cpn&gt;&lt;/cpn&gt;--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn1</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">srcipt</span> <span class="attr">type</span>=<span class="string">&quot;text/x-template&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯cpn<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>scriptæ ‡ç­¾æŠ½ç¦» æ³¨æ„ç±»å‹type=&quot;text/x-template&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">srcipt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯cpn1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="comment">//æ³¨å†Œä¸€ä¸ªå…¨å±€ç»„ä»¶</span></span></span><br><span class="line"><span class="javascript">  Vue.component(<span class="string">&#x27;cpn&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">    template: <span class="string">&#x27;#cpn&#x27;</span></span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">  Vue.component(<span class="string">&#x27;cpn1&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">    template: <span class="string">&#x27;#cpn1&#x27;</span></span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line"><span class="javascript">      message: <span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-24_16-43-55.png"></p>
<h2 id="6-6-ç»„ä»¶çš„æ•°æ®"><a href="#6-6-ç»„ä»¶çš„æ•°æ®" class="headerlink" title="6.6 ç»„ä»¶çš„æ•°æ®"></a>6.6 ç»„ä»¶çš„æ•°æ®</h2><p><strong>ä¸€ä¸¶ç»„ä»¶å¯ä»¥è®¿é—®Vueå®ä¾‹æ•°æ®å—ï¼Ÿ</strong></p>
<ul>
<li>ç»„ä»¶æ˜¯ä¸€ä¸ªå•ç‹¬åŠŸèƒ½æ¨¡å—çš„å°è£…ï¼š</li>
<li>è¿™ä¸ªæ¨¡å—æœ‰å±äºè‡ªå·±çš„HTMLæ¨¡æ¿ï¼Œä¹Ÿåº”è¯¥æœ‰å±æ€§è‡ªå·±çš„æ•°æ®data</li>
<li>ç»„ä»¶ä¸­çš„æ•°æ®æ˜¯ä¿å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿé¡¶å±‚çš„Vueå®ä¾‹ä¸­å—ï¼Ÿ</li>
<li>ç»„ä»¶ä¸­ä¸èƒ½ç›´æ¥è®¿é—®Vueå®ä¾‹ä¸­çš„data</li>
<li>Vueç»„ä»¶åº”è¯¥æœ‰è‡ªå·±ä¿å­˜æ•°æ®çš„åœ°æ–¹</li>
</ul>
<p><strong>äºŒä¸¶ç»„ä»¶æ•°æ®çš„å­˜æ”¾</strong></p>
<ul>
<li>ç»„ä»¶è‡ªå·±çš„æ•°æ®å­˜æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿ</li>
<li>ç»„ä»¶å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªdataå±æ€§ï¼ˆä¹Ÿå¯ä»¥æœ‰methodsç­‰å±æ€§ï¼‰</li>
<li>åªæ˜¯è¿™ä¸ªdataå±æ€§å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°</li>
<li>è€Œä¸”è¿™ä¸ªå‡½æ•°çš„è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡å†…éƒ¨ä¿å­˜ç€æ•°æ®</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_count</span>&gt;</span><span class="tag">&lt;/<span class="name">my_count</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_count</span>&gt;</span><span class="tag">&lt;/<span class="name">my_count</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_count</span>&gt;</span><span class="tag">&lt;/<span class="name">my_count</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>å½“å‰è®¡æ•°ï¼š&#123;&#123;counter&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;decrement&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  Vue.component(<span class="string">&#x27;my_count&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">    template: <span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line">        counter: 0</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">increment</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.counter++;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">decrement</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.counter--;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_13-15-53.png"></p>
<p><strong>ä¸ºä»€ä¹ˆdataåœ¨ç»„ä»¶ä¸­å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°å‘¢?</strong></p>
<ul>
<li><p>é¦–å…ˆï¼Œå¦‚æœä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒVueç›´æ¥å°±ä¼šæŠ¥é”™ã€‚</p>
</li>
<li><p>å…¶æ¬¡ï¼ŒåŸå› æ˜¯åœ¨äºVueè®©æ¯ä¸ªç»„ä»¶å¯¹è±¡éƒ½è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå› ä¸ºå¦‚æœæ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„ï¼Œç»„ä»¶åœ¨å¤šæ¬¡ä½¿ç”¨åä¼šç›¸äº’å½±å“ã€‚</p>
</li>
</ul>
<h2 id="6-7-çˆ¶å­é€šä¿¡â€”çˆ¶ä¼ å­"><a href="#6-7-çˆ¶å­é€šä¿¡â€”çˆ¶ä¼ å­" class="headerlink" title="6.7 çˆ¶å­é€šä¿¡â€”çˆ¶ä¼ å­"></a>6.7 çˆ¶å­é€šä¿¡â€”çˆ¶ä¼ å­</h2><p><strong>ä¸€ä¸¶çˆ¶å­ç»„ä»¶çš„é€šä¿¡</strong></p>
<ul>
<li>å­ç»„ä»¶æ˜¯ä¸èƒ½æ˜¯ä¸èƒ½å¼•ç”¨çˆ¶ç»„ä»¶æˆ–è€…Vueå®ä¾‹çš„æ•°æ®çš„</li>
<li>åœ¨å¼€å‘ä¸­ï¼Œå¾€å¾€ä¸€äº›æ•°æ®ç¡®å®éœ€è¦ä»ä¸Šå±‚ä¼ é€’åˆ°ä¸‹å±‚</li>
<li>æ¯”å¦‚åœ¨ä¸€ä¸ªé¡µé¢ä¸­ï¼Œæˆ‘ä»¬ä»æœåŠ¡å™¨è¯·æ±‚åˆ°äº†å¾ˆå¤šæ•°æ®å…¶ä¸­ä¸€äº›æ•°æ®ï¼Œå¹¶éæ˜¯æˆ‘ä»¬æ•´ä¸ªé¡µé¢çš„å¤§ç»„ä»¶æ¥å±•ç¤ºçš„ï¼Œè€Œæ˜¯éœ€è¦ä¸‹é¢çš„å­ç»„ä»¶è¿›è¡Œå±•ç¤ºè¿™ä¸ªæ—¶å€™ï¼Œå¹¶ä¸ä¼šè®©å­ç»„ä»¶å†æ¬¡å‘é€ä¸€ä¸ªä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œè€Œæ˜¯ç›´æ¥è®©å¤§ç»„ä»¶ï¼ˆçˆ¶ç»„ä»¶ï¼‰å°†æ•°æ®ä¼ é€’ç»™å°ç»„ä»¶ï¼ˆå­ç»„ä»¶ï¼‰<br><strong>å¦‚ä½•è¿›è¡Œçˆ¶å­ç»„ä»¶é—´çš„é€šä¿¡å‘¢ï¼ŸVueå®˜æ–¹æåˆ°</strong><ul>
<li>é€šè¿‡propså‘å­ç»„ä»¶ä¼ é€’æ•°æ®</li>
<li>é€šè¿‡è‡ªå®šä¹‰äº‹ä»¶å‘çˆ¶ç»„ä»¶å‘é€æ¶ˆæ¯</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_18-47-25.png"></p>
<p><strong>äºŒä¸¶propsæ•°æ®éªŒè¯</strong><br>propså¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡<br>å½“éœ€è¦å¯¹propsè¿›è¡Œç±»å‹éªŒè¯æ—¶ï¼Œå°±éœ€è¦å¯¹è±¡å†™æ³•äº†<br>å¯¹è±¡å†™æ³•æ”¯æŒç±»å‹ï¼š</p>
<blockquote>
<p>String<br>Number<br>Boolean<br>Array<br><code>Object</code><br>Date<br>Function<br>Symbol</p>
<p>å½“æˆ‘ä»¬æœ‰è‡ªå®šä¹‰æ„é€ å‡½æ•°æ—¶ï¼ŒéªŒè¯ä¹Ÿæ”¯æŒè‡ªå®šä¹‰ç±»å‹</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my_cpn</span> <span class="attr">:cmovies</span>=<span class="string">&quot;movies&quot;</span> <span class="attr">:cmessage</span>=<span class="string">&quot;message&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my_cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;my_cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;movie in cmovies&quot;</span>&gt;</span>&#123;&#123;movie&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;cmovies&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;cmessage&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> my_cpn = &#123;</span></span><br><span class="line"><span class="javascript">    template: <span class="string">&#x27;#my_cpn&#x27;</span>,</span></span><br><span class="line">    /*</span><br><span class="line">    ä¼ é€’æ•°ç»„</span><br><span class="line">    ä¼ é€’å¯¹è±¡ æ§åˆ¶ä¼ é€’ç±»çš„é™åˆ¶</span><br><span class="line">    ä¼ é€’å¯¹è±¡ï¼Œæä¾›é»˜è®¤å€¼</span><br><span class="line">     */</span><br><span class="line">    props: &#123;</span><br><span class="line">      cmessage: &#123;</span><br><span class="line"><span class="javascript">        type: <span class="built_in">String</span>,</span></span><br><span class="line"><span class="javascript">        <span class="keyword">default</span>: <span class="string">&#x27;full&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="built_in">require</span>: <span class="literal">false</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      cmovies: &#123;</span><br><span class="line"><span class="javascript">        type: <span class="built_in">Array</span>,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">default</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> []</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line"><span class="javascript">      message: <span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line"><span class="javascript">      movies: [<span class="string">&#x27;æµ·è´¼ç‹&#x27;</span>, <span class="string">&#x27;æµ·ç‹&#x27;</span>, <span class="string">&#x27;æµ·å°”å…„å¼Ÿ&#x27;</span>]</span></span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      my_cpn</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_13-40-48.png"></p>
<ul>
<li>å¦‚æœpropsä½¿ç”¨çš„é©¼å³°æ ‡è¯†ï¼Œåœ¨åŠ¨æ€ç»‘å®šçš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥ç»‘å®šï¼Œåœ¨æ¯ä¸ªå¤§å†™å­—æ¯å‰é¢éœ€è¦åŠ ä¸€ä¸ª-</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span> <span class="attr">:c-Info</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;cInfo&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> cpn =&#123;</span></span><br><span class="line"><span class="javascript">    template:<span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line">    props:&#123;</span><br><span class="line"><span class="javascript">      <span class="comment">//é©¼å³°æ ‡è¯†</span></span></span><br><span class="line">      cInfo:&#123;</span><br><span class="line"><span class="javascript">        type:<span class="built_in">Object</span>,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">default</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span>&#123;</span></span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span>,</span></span><br><span class="line">      info:&#123;</span><br><span class="line"><span class="javascript">        name:<span class="string">&#x27;zk&#x27;</span>,</span></span><br><span class="line">        age:20,</span><br><span class="line">        height:1.90</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">      cpn</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_13-48-24.png"></p>
<h2 id="6-8-çˆ¶ä¼ å­-è‡ªå®šä¹‰äº‹ä»¶"><a href="#6-8-çˆ¶ä¼ å­-è‡ªå®šä¹‰äº‹ä»¶" class="headerlink" title="6.8 çˆ¶ä¼ å­-è‡ªå®šä¹‰äº‹ä»¶"></a>6.8 çˆ¶ä¼ å­-è‡ªå®šä¹‰äº‹ä»¶</h2><p><strong>ä¸€ä¸¶å­çº§å‘çˆ¶çº§ä¼ é€’</strong><br>propsç”¨äºçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œè¿˜æœ‰ä¸€ç§æ¯”è¾ƒå¸¸è§çš„äº‹å­ç»„ä»¶ä¼ é€’æ•°æ®æˆ–äº‹ä»¶åˆ°çˆ¶ç»„ä»¶ä¸­<br>æˆ‘ä»¬éœ€è¦ç”¨è‡ªå®šä¹‰äº‹ä»¶æ¥å®Œæˆ<br>ä»€ä¹ˆæ—¶å€™éœ€è¦è‡ªå®šä¹‰äº‹ä»¶å‘¢ï¼Ÿ<br>å½“å­ç»„ä»¶éœ€è¦å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®æ—¶ï¼Œå°±è¦ç”¨åˆ°è‡ªå®šä¹‰äº‹ä»¶<br>v-onä¸ä»…ä»…å¯ä»¥ç”¨äºç›‘å¬DOMäº‹ä»¶ï¼Œä¹Ÿå¯ä»¥ç”¨äºç»„ä»¶é—´çš„è‡ªå®šä¹‰äº‹ä»¶<br>è‡ªå®šä¹‰äº‹ä»¶çš„æµç¨‹ï¼š<br><strong>åœ¨å­ç»„ä»¶ä¸­ï¼Œé€šè¿‡$emit()æ¥ç›‘å¬äº‹ä»¶</strong><br><strong>åœ¨çˆ¶ç»„ä»¶ä¸­ï¼Œé€šè¿‡v-onæ¥ç›‘å¬å­ç»„ä»¶äº‹ä»¶</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span> @<span class="attr">itclick</span>=<span class="string">&quot;cpnclick&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å­ç»„ä»¶æ¨¡æ¿--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-for</span>=<span class="string">&quot;item in categories&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;itemClick(item)&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123;item.name&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> cpn=&#123;</span></span><br><span class="line"><span class="javascript">    template:<span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span>&#123;</span></span><br><span class="line">        categories:[</span><br><span class="line"><span class="javascript">          &#123;<span class="attr">id</span>:<span class="string">&#x27;100&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;çƒ­é—¨æ¨è&#x27;</span>&#125;,</span></span><br><span class="line"><span class="javascript">          &#123;<span class="attr">id</span>:<span class="string">&#x27;101&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;æ‰‹æœºæ•°ç &#x27;</span>&#125;,</span></span><br><span class="line"><span class="javascript">          &#123;<span class="attr">id</span>:<span class="string">&#x27;102&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;å®¶ç”¨ç”µå™¨&#x27;</span>&#125;,</span></span><br><span class="line"><span class="javascript">          &#123;<span class="attr">id</span>:<span class="string">&#x27;103&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;ç”µè„‘åŠå…¬&#x27;</span>&#125;,</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">itemClick</span>(<span class="params">item</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(item)</span></span><br><span class="line">        /*</span><br><span class="line">        å°†itemä¼ ç»™çˆ¶ç»„ä»¶ï¼Œè‡ªå®šä¹‰</span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.$emit(<span class="string">&#x27;itemClick&#x27;</span>,item)</span></span><br><span class="line">         */</span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.$emit(<span class="string">&#x27;itemClick&#x27;</span>,item)</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">      cpn</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">cpnclick</span>(<span class="params">item</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;cpnclick&#x27;</span>,item);</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_13-58-09.png"></p>
<h2 id="6-9-çˆ¶ä¼ å­-åŒå‘ç»‘å®š"><a href="#6-9-çˆ¶ä¼ å­-åŒå‘ç»‘å®š" class="headerlink" title="6.9 çˆ¶ä¼ å­-åŒå‘ç»‘å®š"></a>6.9 çˆ¶ä¼ å­-åŒå‘ç»‘å®š</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span> <span class="attr">:number1</span>=<span class="string">&quot;num1&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">:number2</span>=<span class="string">&quot;num2&quot;</span></span></span><br><span class="line"><span class="tag">       @<span class="attr">num1change</span>=<span class="string">&quot;num1change&quot;</span></span></span><br><span class="line"><span class="tag">       @<span class="attr">num2change</span>=<span class="string">&quot;num2change&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    ä½¿ç”¨dataä¸­çš„è®¡ç®—å±æ€§è¿›ç¨‹æ”¹åŠ¨æ•°æ®ï¼ŒåŒå‘ç»‘å®š--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>props:&#123;&#123;number1&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>data:&#123;&#123;dnumber1&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    å•å‘ç»‘å®šï¼Œåªç»‘å®šå­ç»„ä»¶çš„æ•°æ®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;dnumber1&quot;</span>&gt;</span> å•å‘ç»‘å®šï¼Œåªç»‘å®šå­ç»„ä»¶çš„æ•°æ®</span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    &lt;input type=&quot;text&quot; v-bind:value=&quot;dnumber1&quot; v-on:input=&quot;dnumber1=$event.target.value&quot;&gt; åŒå‘ç»‘å®š--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    @inputåé¢å¤ªé•¿äº† å¯ä»¥å†™æˆå‡½æ•°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;dnumber1&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;num1Input&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    &lt;input type=&quot;text&quot; :value=&quot;dnumber1&quot; @input=&quot;num1Input&quot;&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>props:&#123;&#123;number2&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>data:&#123;&#123;dnumber2&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;dnumber2&quot;</span>&gt;</span> å•å‘ç»‘å®šï¼Œåªç»‘å®šå­ç»„ä»¶çš„æ•°æ®</span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;dnumber2&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;num2Input&quot;</span>&gt;</span>åŒå‘ç»‘å®š</span><br><span class="line">    <span class="comment">&lt;!--    å•å‘ç»‘å®šï¼Œåªç»‘å®šå­ç»„ä»¶çš„æ•°æ®--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    &lt;input type=&quot;text&quot; v-model=&quot;dnumber2&quot;&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    ç›´æ¥ç»‘å®šï¼ŒVueä¸æ”¯æŒ--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    &lt;h2&gt;&#123;&#123;number1&#125;&#125;&lt;/h2&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    &lt;input type=&quot;text&quot; v-model=&quot;number1&quot;&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    ç›´æ¥ç»‘å®šï¼ŒVueä¸æ”¯æŒ--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    &lt;h2&gt;&#123;&#123;number2&#125;&#125;&lt;/h2&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    &lt;input type=&quot;text&quot; v-model=&quot;number2&quot;&gt;--&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue/dist/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;</span><br><span class="line">      num1: 1,</span><br><span class="line">      num2: 0</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">num1change</span>(<span class="params">value</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.num1 = <span class="built_in">parseFloat</span>(value)</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">num2change</span>(<span class="params">value</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.num2 = <span class="built_in">parseFloat</span>(value)</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      cpn: &#123;</span><br><span class="line"><span class="javascript">        template: <span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line">        props: &#123;</span><br><span class="line"><span class="javascript">          <span class="comment">//å¦‚æœåªæ˜¯æƒ³ç›´æ¥å±•ç¤ºçš„è¯ï¼Œå°±å¯ä»¥ç›´æ¥ç”¨</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">//å¦‚æœè¦æ”¹æ•°æ®çš„è¯ï¼Œæœ€å¥½æ˜¯æ”¾åœ¨dataä¸­ç”¨è®¡ç®—å±æ€§æ›´æ”¹</span></span></span><br><span class="line"><span class="javascript">          number1: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="javascript">          number2: <span class="built_in">Number</span></span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">            dnumber1: <span class="built_in">this</span>.number1,</span></span><br><span class="line"><span class="javascript">            dnumber2: <span class="built_in">this</span>.number2</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="javascript">          <span class="function"><span class="title">num1Input</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.dnumber1 = event.target.value;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.$emit(<span class="string">&#x27;num1change&#x27;</span>, <span class="built_in">this</span>.dnumber1)</span></span><br><span class="line">          &#125;,</span><br><span class="line"><span class="javascript">          <span class="function"><span class="title">num2Input</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.dnumber2 = event.target.value;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.$emit(<span class="string">&#x27;num2change&#x27;</span>, <span class="built_in">this</span>.dnumber2)</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_15-20-09.png"></p>
<h2 id="6-10-çˆ¶å­ç»„ä»¶çš„è®¿é—®æ–¹å¼ï¼š-children-refs"><a href="#6-10-çˆ¶å­ç»„ä»¶çš„è®¿é—®æ–¹å¼ï¼š-children-refs" class="headerlink" title="6.10 çˆ¶å­ç»„ä»¶çš„è®¿é—®æ–¹å¼ï¼š$children $refs"></a>6.10 çˆ¶å­ç»„ä»¶çš„è®¿é—®æ–¹å¼ï¼š$children $refs</h2><ul>
<li>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦çˆ¶ç»„ä»¶ç›´æ¥è®¿é—®å­ç»„ä»¶ï¼Œå­ç»„ä»¶ç›´æ¥è®¿é—®çˆ¶ç»„ä»¶ï¼Œæˆ–è€…æ˜¯å­ç»„ä»¶è®¿é—®æ ¹ç»„ä»¶</li>
<li>çˆ¶ç»„ä»¶è®¿é—®å­ç»„ä»¶ï¼šä½¿ç”¨$ childrenæˆ–è€…$ refs</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span> <span class="attr">ref</span>=<span class="string">&quot;referenceå±æ€§&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;btnClick&quot;</span>&gt;</span>æŒ‰é’®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>æˆ‘æ˜¯å­ç»„ä»¶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">btnClick</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.$refs)</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">      cpn:&#123;</span><br><span class="line"><span class="javascript">        template:<span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="javascript">            name:<span class="string">&#x27;æˆ‘æ˜¯å­ç»„ä»¶çš„name&#x27;</span></span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line"><span class="javascript">          <span class="function"><span class="title">showMessage</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">&quot;showMessage&quot;</span>);</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_15-28-23.png"></p>
<h2 id="6-11-å­è®¿é—®çˆ¶-parent-root"><a href="#6-11-å­è®¿é—®çˆ¶-parent-root" class="headerlink" title="6.11 å­è®¿é—®çˆ¶-parent-root"></a>6.11 å­è®¿é—®çˆ¶-parent-root</h2><ul>
<li>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦çˆ¶ç»„ä»¶ç›´æ¥è®¿é—®å­ç»„ä»¶ï¼Œå­ç»„ä»¶ç›´æ¥è®¿é—®çˆ¶ç»„ä»¶ï¼Œæˆ–è€…æ˜¯å­ç»„ä»¶è®¿é—®æ ¹ç»„ä»¶</li>
<li>å­ç»„ä»¶è®¿é—®çˆ¶ç»„ä»¶ï¼šä½¿ç”¨$ parent</li>
<li>å­ç»„ä»¶è®¿é—®æ ¹ç»„ä»¶ï¼šä½¿ç”¨$ root</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯cpn<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ccpn</span>&gt;</span><span class="tag">&lt;/<span class="name">ccpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;ccpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯ccpn<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;btnClick&quot;</span>&gt;</span>æŒ‰é’®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">      cpn:&#123;</span><br><span class="line"><span class="javascript">        template:<span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="javascript">            name:<span class="string">&#x27;æˆ‘æ˜¯cpnç»„ä»¶çš„name&#x27;</span></span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        components:&#123;</span><br><span class="line">          ccpn:&#123;</span><br><span class="line"><span class="javascript">            template: <span class="string">&#x27;#ccpn&#x27;</span>,</span></span><br><span class="line">            methods:&#123;</span><br><span class="line"><span class="javascript">              <span class="function"><span class="title">btnClick</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="built_in">this</span>.$parent);</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="built_in">this</span>.$parent.name);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="built_in">this</span>.$root);</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="built_in">this</span>.$root.message);</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_15-43-50.png"></p>
<h2 id="6-12-slot-æ’æ§½çš„åŸºæœ¬ä½¿ç”¨"><a href="#6-12-slot-æ’æ§½çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="6.12 slot-æ’æ§½çš„åŸºæœ¬ä½¿ç”¨"></a>6.12 slot-æ’æ§½çš„åŸºæœ¬ä½¿ç”¨</h2><p><strong>ä¸€ä¸¶ä¸ºä»€ä¹ˆä½¿ç”¨slot</strong></p>
<p><strong>ï¼ˆä¸€ï¼‰slotç¿»è¯‘ä¸ºæ’æ§½</strong></p>
<p>åœ¨ç”Ÿæ´»ä¸­å¾ˆå¤šåœ°æ–¹éƒ½æœ‰æ’æ§½ï¼Œç”µè„‘çš„USBæ’æ§½ï¼Œæ’æ¿å½“ä¸­çš„ç”µæºæ’æ§½<br>æ’æ§½çš„ç›®çš„æ˜¯è®©æˆ‘ä»¬åŸæ¥çš„è®¾å¤‡å…·æœ‰æ›´å¤šçš„æ‰©å±•æ€§<br>æ¯”å¦‚ç”µè„‘çš„USBæˆ‘ä»¬å¯ä»¥æ’å…¥Uç›˜ï¼Œç¡¬ç›˜ï¼Œæ‰‹æœºï¼ŒéŸ³å“ï¼Œé”®ç›˜ï¼Œé¼ æ ‡ç­‰<br><strong>ï¼ˆäºŒï¼‰ç»„ä»¶çš„æ’æ§½</strong></p>
<p>ç»„ä»¶çš„æ’æ§½ä¹Ÿæ˜¯ä¸ºäº†è®©æˆ‘ä»¬å°è£…çš„ç»„ä»¶æ›´å…·æœ‰æ‰©å±•æ€§<br>è®©ä½¿ç”¨è€…å¯ä»¥å†³å®šç»„ä»¶å†…éƒ¨çš„ä¸€äº›å†…å®¹åˆ°åº•å±•ç¤ºä»€ä¹ˆ<br><strong>ï¼ˆä¸‰ï¼‰ä¾‹å­ï¼šç§»åŠ¨ç½‘ç«™ä¸­çš„å¯¼èˆªæ </strong></p>
<p>ç§»åŠ¨å¼€å‘ä¸­ï¼Œå‡ ä¹æ¯ä¸ªé¡µé¢éƒ½æœ‰å¯¼èˆªæ <br>å¯¼èˆªæ æˆ‘ä»¬å¿…ç„¶ä¼šå°è£…æˆä¸€ä¸ªæ’ä»¶ï¼Œæ¯”å¦‚nav-barç»„ä»¶<br>ä¸€æ—¦æœ‰äº†è¿™ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å¤šä¸ªé¡µé¢ä¸­å¤ç”¨<br><strong>äºŒä¸¶å¦‚ä½•å°è£…è¿™ç±»æ’ä»¶å‘¢ï¼Ÿslot</strong></p>
<p><strong>ï¼ˆä¸€ï¼‰å¦‚ä½•å»å°è£…è¿™ç±»çš„ç»„ä»¶å‘¢ï¼Ÿ</strong></p>
<p>å®ƒä»¬ä¹Ÿå¾ˆå¤šåŒºåˆ«ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šå…±æ€§<br>å¦‚æœï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªå•ç‹¬å»å°è£…ä¸€ä¸ªç»„ä»¶ï¼Œæ˜¾ç„¶ä¸åˆé€‚<br>æ¯”å¦‚æ¯ä¸ªé¡µé¢éƒ½è¿”å›ï¼Œè¿™éƒ¨åˆ†å†…å®¹æˆ‘ä»¬å°±è¦é‡å¤å»å°è£…<br>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å°è£…æˆä¸€ä¸ªï¼Œå¥½åƒä¹Ÿä¸åˆç†<br>æœ‰äº›å·¦ä¾§æ˜¯èœå•ï¼Œæœ‰äº›æ˜¯è¿”å›ï¼Œæœ‰äº›ä¸­é—´æ˜¯æœç´¢ï¼Œæœ‰äº›äº‹æ–‡å­—ç­‰ç­‰<br><strong>ï¼ˆäºŒï¼‰å¦‚ä½•å°è£…åˆé€‚å‘¢ï¼ŸæŠ½å–å…±æ€§ï¼Œä¿ç•™ä¸åŒ</strong></p>
<p>æœ€å¥½çš„å°è£…æ–¹å¼å°±æ˜¯å°†å…±æ€§æŠ½å–åˆ°ç»„ä»¶ä¸­ï¼Œå°†ä¸åŒæš´éœ²ä¸ºæ’æ§½<br>ä¸€æ—¦æˆ‘ä»¬é¢„ç•™äº†æ’æ§½ï¼Œå°±å¯ä»¥è®©ä½¿ç”¨è€…æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œå†³å®šæ’æ§½ä¸­æ’å…¥ä»€ä¹ˆå†…å®¹<br>æ˜¯æœç´¢æ¡†ï¼Œè¿˜æ˜¯æ–‡å­—ï¼Œè¿˜æ˜¯èœå•ï¼Œç”±è°ƒç”¨è€…è‡ªå·±æ¥å†³å®š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>æŒ‰é’®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">i</span>&gt;</span>å“ˆå“ˆå“ˆ<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>æˆ‘æ˜¯divæ ‡ç­¾<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯Pæ ‡ç­¾<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯h2æ ‡ç­¾<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯Pæ ‡ç­¾<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&quot;Hello zk I am Vue !&quot;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">      cpn:&#123;</span><br><span class="line"><span class="javascript">        template:<span class="string">&#x27;#cpn&#x27;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_19-23-52.png"></p>
<h2 id="6-13-slot-å…·åæ’æ§½çš„ä½¿ç”¨"><a href="#6-13-slot-å…·åæ’æ§½çš„ä½¿ç”¨" class="headerlink" title="6.13 slot-å…·åæ’æ§½çš„ä½¿ç”¨"></a>6.13 slot-å…·åæ’æ§½çš„ä½¿ç”¨</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    å–åname è°ƒç”¨slot--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;center&quot;</span>&gt;</span>æ ‡é¢˜<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;left&quot;</span>&gt;</span>è¿”å›<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;right&quot;</span>&gt;</span>æ›´å¤š<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    slotä¸­é—´å‡æ˜¯é»˜è®¤å€¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;left&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>å·¦è¾¹<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;center&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>ä¸­é—´<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>å³è¾¹<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      cpn: &#123;</span><br><span class="line"><span class="javascript">        template: <span class="string">&#x27;#cpn&#x27;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_19-28-07.png"></p>
<h2 id="6-14-ç¼–è¯‘ä½œç”¨åŸŸ"><a href="#6-14-ç¼–è¯‘ä½œç”¨åŸŸ" class="headerlink" title="6.14 ç¼–è¯‘ä½œç”¨åŸŸ"></a>6.14 ç¼–è¯‘ä½œç”¨åŸŸ</h2><p><strong>åœ¨çœŸæ­£å­¦ä¹ æ’æ§½ä¹‹é—´ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆç†è§£ä¸€ä¸ªæ¦‚å¿µï¼šç¼–è¯‘ä½œç”¨åŸŸ</strong></p>
<ul>
<li><p>å®˜æ–¹å¯¹äºç¼–è¯‘çš„ä½œç”¨åŸŸè§£ææ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬è‡ªå·±æ¥é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿™ä¸ªæ¦‚å¿µ</p>
</li>
<li><p>æˆ‘ä»¬æ¥è€ƒè™‘ä¸‹é¢çš„ä»£ç æ˜¯å¦æœ€ç»ˆæ˜¯å¯ä»¥æ¸²æŸ“å‡ºæ¥çš„</p>
</li>
<li><p><my-cpn v-show="isShow"></my-cpn>ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†isShowå±æ€§ isShowå±æ€§åŒ…å«åœ¨ç»„ä»¶ä¸­ï¼Œä¹ŸåŒ…å«åœ¨Vueå®ä¾‹ä¸­</p>
</li>
<li><p>æˆ‘ä»¬å¯ä»¥ä»ä¸‹é¢çš„æ¡ˆä¾‹ä»£ç è¿è¡Œç»“æœå¾—å‡ºï¼šéƒ½åªä½œç”¨äºå½“å‰ä½œç”¨åŸŸ</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span> <span class="attr">v-show</span>=<span class="string">&quot;isShow&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯å­ç»„ä»¶<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯å†…å®¹ï¼Œzk<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-show</span>=<span class="string">&quot;isShow&quot;</span>&gt;</span>æŒ‰é’®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> vue = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data:&#123;</span><br><span class="line"><span class="javascript">      message:<span class="string">&#x27;hello,zk &#x27;</span>,</span></span><br><span class="line"><span class="javascript">      isShow:<span class="literal">true</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">      cpn:&#123;</span><br><span class="line"><span class="javascript">        template:<span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="javascript">            isShow:<span class="literal">false</span></span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="6-15-ä½œç”¨åŸŸæ’æ§½çš„ä½¿ç”¨"><a href="#6-15-ä½œç”¨åŸŸæ’æ§½çš„ä½¿ç”¨" class="headerlink" title="6.15 ä½œç”¨åŸŸæ’æ§½çš„ä½¿ç”¨"></a>6.15 ä½œç”¨åŸŸæ’æ§½çš„ä½¿ç”¨</h2><p>å­ç»„ä»¶ä¸­åŒ…å«ä¸€ç»„æ•°æ®ï¼Œæ¯”å¦‚ï¼špLanguagesï¼š[â€˜JavaScriptâ€™,â€˜Pythonâ€™,â€˜Swiftâ€™,â€˜Goâ€™,â€˜C++â€™]</p>
<blockquote>
<p>ï¼ˆä¸€ï¼‰åœ¨çˆ¶ç»„ä»¶ä½¿ç”¨æˆ‘ä»¬å­ç»„ä»¶æ—¶ï¼Œä»å­ç»„ä»¶ä¸­æ‹¿åˆ°æ•°æ®éœ€è¦åœ¨å¤šä¸ªé¡µé¢è¿›è¡Œå±•ç¤º<br>æŸäº›é¡µé¢æ˜¯ä»¥æ°´å¹³æ–¹å‘ä¸€ä¸€å±•ç¤ºçš„<br>æŸäº›ç•Œé¢æ˜¯ä»¥åˆ—è¡¨å½¢å¼å±•ç¤ºçš„<br>æŸäº›ç•Œé¢ç›´æ¥å±•å¼€ä¸€ä¸ªæ•°ç»„<br>å†…å®¹åœ¨å­ç»„ä»¶ï¼Œå¸Œæœ›çˆ¶ç»„ä»¶å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•å±•ç¤ºï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ<br>åˆ©ç”¨slotä½œç”¨åŸŸæ’æ§½å°±å¯ä»¥äº†</p>
</blockquote>
<p>æˆ‘ä»¬é€šè¿‡<template slot-scope="slot">è·å–åˆ°slotçš„å±æ€§<br>åœ¨é€šè¿‡slot.dataå°±å¯ä»¥è·å–åˆ°æˆ‘ä»¬ä¼ å…¥çš„dataäº†</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  åˆ—è¡¨å½¢å¼å±•ç¤º--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  æ°´å¹³å½¢å¼å±•ç¤º--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cpn</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    ç›®çš„æ˜¯è·å¾—å­ç»„ä»¶ä¸­çš„pLanguages--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    Vue2.5.xä»¥ä¸‹å¿…é¡»ä½¿ç”¨templateæ¨¡æ¿--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;slot&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-for</span>=<span class="string">&quot;item in slot.data&quot;</span>&gt;</span>&#123;&#123;item&#125;&#125;â€”â€”<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;slot.data.join(&#x27;â€”â€”&#x27;)&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">:data</span>=<span class="string">&quot;pLanguages&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in pLanguages&quot;</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      cpn: &#123;</span><br><span class="line"><span class="javascript">        template: <span class="string">&quot;#cpn&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">            pLanguages: [<span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;C++&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Go&#x27;</span>, <span class="string">&#x27;Solidity&#x27;</span>]</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-25_19-31-01.png"></p>
<h1 id="7ï¼Œå‰ç«¯æ¨¡å—åŒ–"><a href="#7ï¼Œå‰ç«¯æ¨¡å—åŒ–" class="headerlink" title="7ï¼Œå‰ç«¯æ¨¡å—åŒ–"></a>7ï¼Œå‰ç«¯æ¨¡å—åŒ–</h1><h2 id="7-1-JavaScriptåŸå§‹åŠŸèƒ½"><a href="#7-1-JavaScriptåŸå§‹åŠŸèƒ½" class="headerlink" title="7.1 JavaScriptåŸå§‹åŠŸèƒ½"></a>7.1 JavaScriptåŸå§‹åŠŸèƒ½</h2><p><strong>éšç€ajaxå¼‚æ­¥è¯·æ±‚çš„å‡ºç°ï¼Œæ…¢æ…¢å½¢æˆäº†å‰åç«¯çš„åˆ†ç¦»</strong></p>
<ul>
<li><p>å®¢æˆ·ç«¯éœ€è¦å®Œæˆçš„äº‹æƒ…è¶Šæ¥è¶Šå¤šï¼Œä»£ç é‡ä¹Ÿæ˜¯ä¸æ—¥ä¿±å¢ã€‚</p>
</li>
<li><p>ä¸ºäº†åº”å¯¹ä»£ç é‡çš„å‰§å¢ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°†ä»£ç ç»„ç»‡åœ¨å¤šä¸ªjsæ–‡ä»¶ä¸­ï¼Œè¿›è¡Œç»´æŠ¤ã€‚</p>
</li>
<li><p>ä½†æ˜¯è¿™ç§ç»´æŠ¤æ–¹å¼ï¼Œä¾ç„¶ä¸èƒ½é¿å…ä¸€äº›ç¾éš¾æ€§çš„é—®é¢˜ã€‚</p>
</li>
</ul>
<blockquote>
<p>å…¨å±€å˜é‡åŒåé—®é¢˜</p>
</blockquote>
<p><strong>åŒ¿åå‡½æ•°æ¥è§£å†³æ–¹é¢çš„é‡åé—®é¢˜</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-28_17-09-20.png"></p>
<p><strong>åœ¨aaa.jsæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒ¿åå‡½æ•°</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428171002122.png" alt="image-20210428171002122"></p>
<p><strong>ä½¿ç”¨æ¨¡å—ä½œä¸ºå‡ºå£</strong></p>
<blockquote>
<p>åœ¨åŒ¿åå‡½æ•°å†…éƒ¨ï¼Œå®šä¹‰ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p>ç»™å¯¹è±¡æ·»åŠ å„ç§éœ€è¦æš´éœ²åˆ°å¤–é¢çš„å±æ€§å’Œæ–¹æ³•(ä¸éœ€è¦æš´éœ²çš„ç›´æ¥å®šä¹‰å³å¯)ã€‚</p>
<p>æœ€åå°†è¿™ä¸ªå¯¹è±¡è¿”å›ï¼Œå¹¶ä¸”åœ¨å¤–é¢ä½¿ç”¨äº†ä¸€ä¸ªMoudleAæ¥å—</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428171118528.png" alt="image-20210428171118528"></p>
<p><strong>å¸¸è§çš„æ¨¡å—åŒ–è§„èŒƒ</strong>ï¼š</p>
<ul>
<li>CommonJSã€AMDã€CMDï¼Œä¹Ÿæœ‰ES6çš„Modules</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-28_17-12-19.png"></p>
<h2 id="7-2-exportåŸºæœ¬ä½¿ç”¨"><a href="#7-2-exportåŸºæœ¬ä½¿ç”¨" class="headerlink" title="7.2 exportåŸºæœ¬ä½¿ç”¨"></a>7.2 <strong>export</strong>åŸºæœ¬ä½¿ç”¨</h2><p><strong>export</strong>æŒ‡ä»¤ç”¨äºå¯¼å‡ºå˜é‡</p>
<p>ä¸¤ç§å†™æ³•</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428171329647.png" alt="image-20210428171329647"></p>
<h2 id="7-3-export-default"><a href="#7-3-export-default" class="headerlink" title="7.3 export default"></a>7.3 export default</h2><p><strong>æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ¨¡å—ä¸­åŒ…å«æŸä¸ªçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›ç»™è¿™ä¸ªåŠŸèƒ½å‘½åï¼Œè€Œä¸”è®©å¯¼å…¥è€…å¯ä»¥è‡ªå·±æ¥å‘½å</strong></p>
<p><strong>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨export default</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428171451032.png" alt="image-20210428171451032"></p>
<p><font color=red><strong>éœ€è¦æ³¨æ„</strong>ï¼šexport defaultåœ¨åŒä¸€ä¸ªæ¨¡å—ä¸­ï¼Œä¸å…è®¸åŒæ—¶å­˜åœ¨å¤šä¸ª</font></p>
<h1 id="8ï¼ŒWbepackä½¿ç”¨"><a href="#8ï¼ŒWbepackä½¿ç”¨" class="headerlink" title="8ï¼ŒWbepackä½¿ç”¨"></a>8ï¼ŒWbepackä½¿ç”¨</h1><h2 id="8-1-ä»€ä¹ˆæ˜¯Webpack"><a href="#8-1-ä»€ä¹ˆæ˜¯Webpack" class="headerlink" title="8.1 ä»€ä¹ˆæ˜¯Webpack?"></a>8.1 ä»€ä¹ˆæ˜¯Webpack?</h2><p>At its core, <strong>webpack</strong> is a <em>static module bundler</em> for modern JavaScript applications. </p>
<p>ä»æœ¬è´¨ä¸Šæ¥è®²ï¼Œwebpackæ˜¯ä¸€ä¸ªç°ä»£çš„JavaScriptåº”ç”¨çš„é™æ€<strong>æ¨¡å—æ‰“åŒ…</strong>å·¥å…·ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428171748396.png" alt="image-20210428171748396"></p>
<p><strong>æ‰“åŒ…å¦‚ä½•ç†è§£</strong></p>
<blockquote>
<p>ç†è§£äº†webpackå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ¨¡å—åŒ–ï¼Œå¹¶ä¸”å¤„ç†æ¨¡å—é—´çš„å„ç§å¤æ‚å…³ç³»åï¼Œæ‰“åŒ…çš„æ¦‚å¿µå°±éå¸¸å¥½ç†è§£äº†ã€‚</p>
<p>å°±æ˜¯å°†webpackä¸­çš„å„ç§èµ„æºæ¨¡å—è¿›è¡Œæ‰“åŒ…åˆå¹¶æˆä¸€ä¸ªæˆ–å¤šä¸ªåŒ…(Bundle)ã€‚</p>
<p>å¹¶ä¸”åœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜å¯ä»¥å¯¹èµ„æºè¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚å‹ç¼©å›¾ç‰‡ï¼Œå°†scssè½¬æˆcssï¼Œå°†ES6è¯­æ³•è½¬æˆES5è¯­æ³•ï¼Œå°†TypeScriptè½¬æˆJavaScriptç­‰ç­‰æ“ä½œã€‚</p>
</blockquote>
<h3 id="8-1-1-å®‰è£…Webpack"><a href="#8-1-1-å®‰è£…Webpack" class="headerlink" title="8.1.1 å®‰è£…Webpack"></a>8.1.1 å®‰è£…Webpack</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å…ˆè¦å®‰è£…node.js å®‰è£…æ­¥éª¤ä¸èµ˜è¿°ï¼Œnode.jsè‡ªå¸¦npmåŒ…ç®¡ç†å·¥å…·<span class="comment">#æŸ¥çœ‹nodeç‰ˆæœ¬$ node -v#å…¨å±€å®‰è£…webpack$ npm install webpack -g# cd å¯¹åº”ç›®å½• å±€éƒ¨å®‰è£…webpack$ npm install webpack --save--dev</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸ºä»€ä¹ˆå…¨å±€å®‰è£…åï¼Œè¿˜éœ€è¦å±€éƒ¨å®‰è£…å‘¢ï¼Ÿ</p>
<ul>
<li><p>åœ¨ç»ˆç«¯ç›´æ¥æ‰§è¡Œwebpackå‘½ä»¤ï¼Œä½¿ç”¨çš„å…¨å±€å®‰è£…çš„webpack</p>
</li>
<li><p>å½“åœ¨package.jsonä¸­å®šä¹‰äº†scriptsæ—¶ï¼Œå…¶ä¸­åŒ…å«äº†webpackå‘½ä»¤ï¼Œé‚£ä¹ˆä½¿ç”¨çš„æ˜¯å±€éƒ¨webpack</p>
</li>
</ul>
</blockquote>
<h2 id="8-1-2-æ‰“åŒ…æ–‡ä»¶"><a href="#8-1-2-æ‰“åŒ…æ–‡ä»¶" class="headerlink" title="8.1.2 æ‰“åŒ…æ–‡ä»¶"></a>8.1.2 æ‰“åŒ…æ–‡ä»¶</h2><blockquote>
<p>webpackåªæ˜¯ä¸€ä¸ªå·¥å…· åç»­éƒ½æ˜¯æœ‰vue-cliè„šæ‰‹æ¶ï¼Œè¿™é‡Œä¸å†èµ˜è¿°æ‰“åŒ…çš„æ­¥éª¤ï¼</p>
</blockquote>
<h2 id="8-2-Webpackæ‰“åŒ…cssæ ·å¼"><a href="#8-2-Webpackæ‰“åŒ…cssæ ·å¼" class="headerlink" title="8.2 Webpackæ‰“åŒ…cssæ ·å¼"></a>8.2 Webpackæ‰“åŒ…cssæ ·å¼</h2><p><strong>å‚è€ƒå®˜ç½‘ï¼š<a href="https://www.webpackjs.com/concepts/loaders/">loader | webpack ä¸­æ–‡ç½‘ (webpackjs.com)</a></strong></p>
<p>åœ¨srcä¸‹æ–°å»ºä¸€ä¸ªç›®å½•css å†™ä¸€ä¸ªcssæ–‡ä»¶</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;  <span class="attribute">background-color</span>: aquamarine;&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨main.jsæ–‡ä»¶ä¸­å¯¼å…¥</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-26_13-59-05.png"></p>
<p>å‡ ä¸ªå‘½ä»¤æå®š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --save-dev css-loader$ npm install --save-dev style-loader$ webpack</span></span><br></pre></td></tr></table></figure>

<p><strong>å‚è€ƒç”Ÿæˆæ–‡ä»¶å¦‚ä¸‹ï¼</strong></p>
<p><strong>webpack.config.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: path.join(__dirname, <span class="string">&#x27;./src/main.js&#x27;</span>),<span class="comment">// å…¥å£ï¼Œè¡¨ç¤ºï¼Œè¦ä½¿ç”¨ webpack æ‰“åŒ…å“ªä¸ªæ–‡ä»¶</span></span><br><span class="line">  output: &#123; <span class="comment">// è¾“å‡ºæ–‡ä»¶ç›¸å…³çš„é…ç½®</span></span><br><span class="line">    path: path.join(__dirname, <span class="string">&#x27;./dist&#x27;</span>), <span class="comment">// æŒ‡å®š æ‰“åŒ…å¥½çš„æ–‡ä»¶ï¼Œè¾“å‡ºåˆ°å“ªä¸ªç›®å½•ä¸­å»</span></span><br><span class="line">    filename: <span class="string">&#x27;bundle.js&#x27;</span> <span class="comment">// è¿™æ˜¯æŒ‡å®š è¾“å‡ºçš„æ–‡ä»¶çš„åç§°</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>package.json</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;webpack_test&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;webpack&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨é¡µé¢å¯¼å…¥ç”Ÿæˆçš„bundle.jsæ–‡ä»¶å³å¯</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;./03-webpackçš„loader/dist/bundle.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h2 id="8-3-Webpackæ‰“åŒ…å›¾ç‰‡æ ·å¼"><a href="#8-3-Webpackæ‰“åŒ…å›¾ç‰‡æ ·å¼" class="headerlink" title="8.3 Webpackæ‰“åŒ…å›¾ç‰‡æ ·å¼"></a>8.3 Webpackæ‰“åŒ…å›¾ç‰‡æ ·å¼</h2><p><strong>å‚è€ƒå®˜ç½‘ï¼š<a href="https://www.webpackjs.com/loaders/url-loader/">url-loader | webpack ä¸­æ–‡ç½‘ (webpackjs.com)</a></strong></p>
<p>åœ¨srcç›®å½•ä¸‹æ–°å»ºimgç›®å½• éšä¾¿æ”¾è¿›å›¾ç‰‡</p>
<p>åœ¨cssæ–‡ä»¶ä¸­å½“èƒŒæ™¯ä½¿ç”¨</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;  <span class="comment">/*background-color: aquamarine;*/</span>  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&quot;../img/minibus.jpg&quot;</span>);&#125;</span><br></pre></td></tr></table></figure>

<p>å®‰è£…ä¾èµ–</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --save-dev url-loader</span></span><br></pre></td></tr></table></figure>

<p><strong>é…ç½®webpack.config.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: path.join(__dirname, <span class="string">&#x27;./src/main.js&#x27;</span>),<span class="comment">// å…¥å£ï¼Œè¡¨ç¤ºï¼Œè¦ä½¿ç”¨ webpack æ‰“åŒ…å“ªä¸ªæ–‡ä»¶</span></span><br><span class="line">  output: &#123; <span class="comment">// è¾“å‡ºæ–‡ä»¶ç›¸å…³çš„é…ç½®</span></span><br><span class="line">    path: path.join(__dirname, <span class="string">&#x27;./dist&#x27;</span>), <span class="comment">// æŒ‡å®š æ‰“åŒ…å¥½çš„æ–‡ä»¶ï¼Œè¾“å‡ºåˆ°å“ªä¸ªç›®å½•ä¸­å»</span></span><br><span class="line">    filename: <span class="string">&#x27;bundle.js&#x27;</span>, <span class="comment">// è¿™æ˜¯æŒ‡å®š è¾“å‡ºçš„æ–‡ä»¶çš„åç§°</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123; <span class="attr">loader</span>: <span class="string">&#x27;style-loader&#x27;</span> &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              modules: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: <span class="number">20</span>,</span><br><span class="line">              name: <span class="string">&#x27;img/[name].[hash:8].[ext]&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/(node_modules|bower_components)/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            presets: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  mode:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>limitå‚æ•°è¯¦è§£</strong></p>
<blockquote>
<p>å½“åŠ è½½çš„å›¾ç‰‡å°äºlimitï¼Œä¼šå°†å›¾ç‰‡ç¼–è¯‘ä¸ºbase64å­—ç¬¦ä¸²å½¢å¼</p>
<p>å¤§äºlimitï¼Œéœ€è¦ä½¿ç”¨file-loader å®‰è£…ä¾èµ–ï¼</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --save-dev file-loader</span></span><br></pre></td></tr></table></figure>

<p><strong>å†æ¬¡æ‰“åŒ…è¿è¡Œä¼šåœ¨distç›®å½•ä¸­å¤šå‡ºä¸€ä¸ªå¾ˆé•¿çš„æ–‡ä»¶</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-26_15-20-20.png"></p>
<p><strong>package.json</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;webpack_test&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;webpack&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;css-loader&quot;</span>: <span class="string">&quot;^5.2.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;file-loader&quot;</span>: <span class="string">&quot;^6.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;style-loader&quot;</span>: <span class="string">&quot;^2.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;url-loader&quot;</span>: <span class="string">&quot;^4.1.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack-cli&quot;</span>: <span class="string">&quot;^4.6.0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;@babel/core&quot;</span>: <span class="string">&quot;^7.13.16&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;@babel/preset-env&quot;</span>: <span class="string">&quot;^7.13.15&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-core&quot;</span>: <span class="string">&quot;^6.26.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-loader&quot;</span>: <span class="string">&quot;^8.0.0-beta.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-preset-env&quot;</span>: <span class="string">&quot;^1.7.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;less&quot;</span>: <span class="string">&quot;^4.1.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;less-loader&quot;</span>: <span class="string">&quot;^8.1.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack&quot;</span>: <span class="string">&quot;^5.35.1&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨webpack.config.jsæ–‡ä»¶ä¸­å¯ä»¥æŒ‡å®šå›¾ç‰‡ç”Ÿæˆçš„åå­—ï¼Œè¿™æ ·å°±ä¸ä¼šé‚£ä¹ˆé•¿äº†</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: <span class="number">20</span>,</span><br><span class="line">              name: <span class="string">&#x27;img/[name].[hash:8].[ext]&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-26_15-23-15.png"></p>
<h2 id="8-4-Webpack-ES6è½¬ä¸ºES5"><a href="#8-4-Webpack-ES6è½¬ä¸ºES5" class="headerlink" title="8.4 Webpack ES6è½¬ä¸ºES5"></a>8.4 Webpack ES6è½¬ä¸ºES5</h2><p><strong>å‚è€ƒåœ°å€ï¼š<a href="https://www.webpackjs.com/loaders/babel-loader/">babel-loader | webpack ä¸­æ–‡ç½‘ (webpackjs.com)</a></strong></p>
<p>å‡ ä¸ªå‘½ä»¤æå®šï¼Œæœ‰äº›æµè§ˆå™¨ä¸å…¼å®¹ES6è¯­æ³• æ‰€ä»¥è½¬ä¸ºES5è¯­æ³•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install babel-loader@8.0.0-beta.0 @babel/core @babel/preset-env webpack</span></span><br></pre></td></tr></table></figure>

<p><strong>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ rule</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/(node_modules|bower_components)/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            presets: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-5-Webpackæ·»åŠ æ’ä»¶"><a href="#8-5-Webpackæ·»åŠ æ’ä»¶" class="headerlink" title="8.5 Webpackæ·»åŠ æ’ä»¶"></a>8.5 Webpackæ·»åŠ æ’ä»¶</h2><p>æ’ä»¶ plugin</p>
<p><strong>pluginæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li><p>pluginæ˜¯æ’ä»¶çš„æ„æ€ï¼Œé€šå¸¸æ˜¯ç”¨äºå¯¹æŸä¸ªç°æœ‰çš„æ¶æ„è¿›è¡Œæ‰©å±•ã€‚</p>
</li>
<li><p>webpackä¸­çš„æ’ä»¶ï¼Œå°±æ˜¯å¯¹webpackç°æœ‰åŠŸèƒ½çš„å„ç§æ‰©å±•ï¼Œæ¯”å¦‚æ‰“åŒ…ä¼˜åŒ–ï¼Œæ–‡ä»¶å‹ç¼©ç­‰ç­‰ã€‚</p>
</li>
</ul>
<p><strong>loaderå’ŒpluginåŒºåˆ«</strong></p>
<ul>
<li><p>loaderä¸»è¦ç”¨äºè½¬æ¢æŸäº›ç±»å‹çš„æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªè½¬æ¢å™¨ã€‚</p>
</li>
<li><p>pluginæ˜¯æ’ä»¶ï¼Œå®ƒæ˜¯å¯¹webpackæœ¬èº«çš„æ‰©å±•ï¼Œæ˜¯ä¸€ä¸ªæ‰©å±•å™¨ã€‚</p>
</li>
</ul>
<p><strong>pluginçš„ä½¿ç”¨è¿‡ç¨‹ï¼š</strong></p>
<ul>
<li><p>æ­¥éª¤ä¸€ï¼šé€šè¿‡npmå®‰è£…éœ€è¦ä½¿ç”¨çš„plugins(æŸäº›webpackå·²ç»å†…ç½®çš„æ’ä»¶ä¸éœ€è¦å®‰è£…)</p>
</li>
<li><p>æ­¥éª¤äºŒï¼šåœ¨webpack.config.jsä¸­çš„pluginsä¸­é…ç½®æ’ä»¶</p>
</li>
</ul>
<h3 id="8-5-1-æ·»åŠ ç‰ˆæƒçš„Plugin"><a href="#8-5-1-æ·»åŠ ç‰ˆæƒçš„Plugin" class="headerlink" title="8.5.1 æ·»åŠ ç‰ˆæƒçš„Plugin"></a>8.5.1 <strong>æ·»åŠ ç‰ˆæƒçš„</strong>Plugin</h3><p>è¯¥æ’ä»¶åå­—å«BannerPluginï¼Œå±äºwebpackè‡ªå¸¦çš„æ’ä»¶</p>
<p><strong>ä¿®æ”¹webpack.config.jsçš„æ–‡ä»¶</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428172746941.png" alt="image-20210428172746941"></p>
<p>é‡æ–°æ‰“åŒ…ç¨‹åºï¼šæŸ¥çœ‹bundle.jsæ–‡ä»¶çš„å¤´éƒ¨ï¼Œçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428172808322.png" alt="image-20210428172808322"></p>
<h3 id="8-5-2-æ‰“åŒ…htmlçš„plugin"><a href="#8-5-2-æ‰“åŒ…htmlçš„plugin" class="headerlink" title="8.5.2 æ‰“åŒ…htmlçš„plugin"></a>8.5.2 æ‰“åŒ…htmlçš„plugin</h3><p>æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install html-webpack-plugin --save-dev</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªindex.htmlæ–‡ä»¶(å¯ä»¥æŒ‡å®šæ¨¡æ¿æ¥ç”Ÿæˆ)</p>
<p>å°†æ‰“åŒ…çš„jsæ–‡ä»¶ï¼Œè‡ªåŠ¨é€šè¿‡scriptæ ‡ç­¾æ’å…¥åˆ°bodyä¸­</p>
</blockquote>
<p><strong>ä¿®æ”¹webpack.config.jsçš„æ–‡ä»¶</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428172941733.png" alt="image-20210428172941733"></p>
<h3 id="8-5-3-æ­å»ºæœ¬åœ°æœåŠ¡å™¨"><a href="#8-5-3-æ­å»ºæœ¬åœ°æœåŠ¡å™¨" class="headerlink" title="8.5.3 æ­å»ºæœ¬åœ°æœåŠ¡å™¨"></a>8.5.3 æ­å»ºæœ¬åœ°æœåŠ¡å™¨</h3><p>æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --save-dev webpack-dev-server@2.9.1</span></span><br></pre></td></tr></table></figure>

<p>æä¾›äº†ä¸€ä¸ªå¯é€‰çš„æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼Œè¿™ä¸ªæœ¬åœ°æœåŠ¡å™¨åŸºäºnode.jsæ­å»ºï¼Œå†…éƒ¨ä½¿ç”¨expressæ¡†æ¶ï¼Œå¯ä»¥å®ç°æˆ‘ä»¬æƒ³è¦çš„è®©æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°æ˜¾ç¤ºæˆ‘ä»¬ä¿®æ”¹åçš„ç»“æœ</p>
<p>webpack.config.jsæ–‡ä»¶é…ç½®ä¿®æ”¹</p>
<p>æ˜¯å¦å®æ—¶æ›´æ–°ï¼Œç«‹å³æ‰“å¼€æµè§ˆå™¨</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428173609655.png" alt="image-20210428173609655"></p>
<h1 id="9ï¼ŒVue-CLI"><a href="#9ï¼ŒVue-CLI" class="headerlink" title="9ï¼ŒVue-CLI"></a>9ï¼ŒVue-CLI</h1><p><strong>å‚è€ƒåœ°å€ï¼š<a href="https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create">åˆ›å»ºä¸€ä¸ªé¡¹ç›® | Vue CLI (vuejs.org)</a></strong></p>
<p><strong>ç±»ä¼¼äºSpingBoot å¼€ç®±å³ç”¨</strong></p>
<p><strong>å¦‚æœä½ åªæ˜¯ç®€å•å†™å‡ ä¸ªVueçš„Demoç¨‹åº, é‚£ä¹ˆä½ ä¸éœ€è¦Vue CLI.</strong></p>
<p><strong>å¦‚æœä½ åœ¨å¼€å‘å¤§å‹é¡¹ç›®, é‚£ä¹ˆä½ éœ€è¦, å¹¶ä¸”å¿…ç„¶éœ€è¦ä½¿ç”¨Vue CLI</strong></p>
<blockquote>
<p>ä½¿ç”¨Vue.jså¼€å‘å¤§å‹åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»£ç ç›®å½•ç»“æ„ã€é¡¹ç›®ç»“æ„å’Œéƒ¨ç½²ã€çƒ­åŠ è½½ã€ä»£ç å•å…ƒæµ‹è¯•ç­‰äº‹æƒ…ã€‚</p>
<p>å¦‚æœæ¯ä¸ªé¡¹ç›®éƒ½è¦æ‰‹åŠ¨å®Œæˆè¿™äº›å·¥ä½œï¼Œé‚£æ— ä»¥æ•ˆç‡æ¯”è¾ƒä½æ•ˆï¼Œæ‰€ä»¥é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ä¸€äº›è„šæ‰‹æ¶å·¥å…·æ¥å¸®åŠ©å®Œæˆè¿™äº›äº‹æƒ…ã€‚</p>
</blockquote>
<p><strong>CLI</strong> <strong>æ˜¯ä»€ä¹ˆæ„æ€</strong></p>
<blockquote>
<p>CLIæ˜¯Command-Line Interface, ç¿»è¯‘ä¸ºå‘½ä»¤è¡Œç•Œé¢, ä½†æ˜¯ä¿—ç§°è„šæ‰‹æ¶.</p>
<p>Vue CLIæ˜¯ä¸€ä¸ªå®˜æ–¹å‘å¸ƒ vue.js é¡¹ç›®è„šæ‰‹æ¶</p>
<p>ä½¿ç”¨ vue-cli å¯ä»¥å¿«é€Ÿæ­å»ºVueå¼€å‘ç¯å¢ƒä»¥åŠå¯¹åº”çš„webpacké…ç½®</p>
</blockquote>
<p><strong>å‡†å¤‡å·¥ä½œ</strong></p>
<blockquote>
<p>cnpmå®‰è£…</p>
<p>ç”±äºå›½å†…ç›´æ¥ä½¿ç”¨ npm çš„å®˜æ–¹é•œåƒæ˜¯éå¸¸æ…¢çš„ï¼Œè¿™é‡Œæ¨èä½¿ç”¨æ·˜å® NPM é•œåƒã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨æ·˜å®å®šåˆ¶çš„ cnpm (gzip å‹ç¼©æ”¯æŒ) å‘½ä»¤è¡Œå·¥å…·ä»£æ›¿é»˜è®¤çš„ npm:</p>
<p>$ npm install -g cnpm â€“registry=<a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a></p>
<p>è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ cnpm å‘½ä»¤æ¥å®‰è£…æ¨¡å—äº†ï¼š</p>
<p>$ cnpm install [name]</p>
</blockquote>
<p><strong>ä»€ä¹ˆæ˜¯NPM?</strong></p>
<ul>
<li><p>NPMçš„å…¨ç§°æ˜¯Node Package Manager</p>
</li>
<li><p>æ˜¯ä¸€ä¸ªNodeJSåŒ…ç®¡ç†å’Œåˆ†å‘å·¥å…·ï¼Œå·²ç»æˆä¸ºäº†éå®˜æ–¹çš„å‘å¸ƒNodeæ¨¡å—ï¼ˆåŒ…ï¼‰çš„æ ‡å‡†ã€‚</p>
</li>
<li><p>æˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨NPMæ¥å®‰è£…ä¸€äº›å¼€å‘è¿‡ç¨‹ä¸­ä¾èµ–åŒ….</p>
</li>
</ul>
<p><strong>Vue.jså®˜æ–¹è„šæ‰‹æ¶å·¥å…·å°±ä½¿ç”¨äº†webpackæ¨¡æ¿</strong></p>
<ul>
<li><p>å¯¹æ‰€æœ‰çš„èµ„æºä¼šå‹ç¼©ç­‰ä¼˜åŒ–æ“ä½œ</p>
</li>
<li><p>å®ƒåœ¨å¼€å‘è¿‡ç¨‹ä¸­æä¾›äº†ä¸€å¥—å®Œæ•´çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿä½¿å¾—æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­å˜å¾—é«˜æ•ˆ</p>
</li>
</ul>
<p>å…ˆå…¨å±€å®‰è£…</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install webpack -g</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä»¥CLI2ç‰ˆæœ¬è®²è§£ åç»­éƒ½æ˜¯ç”¨CLI4ç‰ˆæœ¬ï¼</p>
<h2 id="9-1-CLI2è¯¦è§£"><a href="#9-1-CLI2è¯¦è§£" class="headerlink" title="9.1 CLI2è¯¦è§£"></a>9.1 CLI2è¯¦è§£</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428174409473.png" alt="image-20210428174409473"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428174425424.png" alt="image-20210428174425424"></p>
<p><strong>Runtime-Compilerå’ŒRuntime-onlyçš„åŒºåˆ«</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428174548295.png" alt="image-20210428174548295"></p>
<p><strong>Vueç¨‹åºè¿è¡Œè¿‡ç¨‹</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428174809941.png" alt="image-20210428174809941"></p>
<h2 id="9-2-Renderå‡½æ•°ä½¿ç”¨"><a href="#9-2-Renderå‡½æ•°ä½¿ç”¨" class="headerlink" title="9.2 Renderå‡½æ•°ä½¿ç”¨"></a>9.2 Renderå‡½æ•°ä½¿ç”¨</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428174949810.png" alt="image-20210428174949810"></p>
<p><strong>npm run build å‘½ä»¤</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428175012473.png" alt="image-20210428175012473"></p>
<p><strong>npm run dev å‘½ä»¤</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428175136301.png" alt="image-20210428175136301"></p>
<h2 id="9-3-CLI3è¯¦è§£"><a href="#9-3-CLI3è¯¦è§£" class="headerlink" title="9.3 CLI3è¯¦è§£"></a>9.3 CLI3è¯¦è§£</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428175219668.png" alt="image-20210428175219668"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210428175229649.png" alt="image-20210428175229649"></p>
<p>å¯åŠ¨å¯è§†åŒ–ç•Œé¢ ç®¡ç†é…ç½®</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> vue ui</span></span><br></pre></td></tr></table></figure>

<p><strong>åœ¨8080ç«¯å£è®¿é—®å³å¯çœ‹åˆ°ç•Œé¢ï¼</strong></p>
<h1 id="10-Vue-router"><a href="#10-Vue-router" class="headerlink" title="10, Vue-router"></a>10, Vue-router</h1><p>è·¯ç”±æ˜¯ä¸€ä¸ªç½‘ç»œå·¥ç¨‹é‡Œé¢çš„æœ¯è¯­ã€‚</p>
<p><strong>è·¯ç”±</strong>ï¼ˆ<strong>routing</strong>ï¼‰å°±æ˜¯é€šè¿‡äº’è”çš„ç½‘ç»œæŠŠä¿¡æ¯ä»æºåœ°å€ä¼ è¾“åˆ°ç›®çš„åœ°å€çš„æ´»åŠ¨. â€” ç»´åŸºç™¾ç§‘</p>
<p><strong>ä»€ä¹ˆæ˜¯è·¯ç”±å™¨ï¼Ÿ</strong></p>
<blockquote>
<p>è·¯ç”±å™¨æä¾›äº†ä¸¤ç§æœºåˆ¶: è·¯ç”±å’Œè½¬é€.</p>
<p>è·¯ç”±æ˜¯å†³å®šæ•°æ®åŒ…ä»<strong>æ¥æº</strong>åˆ°<strong>ç›®çš„åœ°</strong>çš„è·¯å¾„.</p>
<p>è½¬é€å°†<strong>è¾“å…¥ç«¯</strong>çš„æ•°æ®è½¬ç§»åˆ°åˆé€‚çš„<strong>è¾“å‡ºç«¯</strong>.</p>
<p>è·¯ç”±ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µå«è·¯ç”±è¡¨.</p>
<p>è·¯ç”±è¡¨æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ˜ å°„è¡¨, å†³å®šäº†æ•°æ®åŒ…çš„æŒ‡å‘</p>
</blockquote>
<h2 id="10-1-åç«¯è·¯ç”±çš„é˜¶æ®µ"><a href="#10-1-åç«¯è·¯ç”±çš„é˜¶æ®µ" class="headerlink" title="10.1 åç«¯è·¯ç”±çš„é˜¶æ®µ"></a>10.1 åç«¯è·¯ç”±çš„é˜¶æ®µ</h2><p>æ—©æœŸçš„ç½‘ç«™å¼€å‘æ•´ä¸ªHTMLé¡µé¢æ˜¯ç”±æœåŠ¡å™¨æ¥æ¸²æŸ“çš„.</p>
<p>æœåŠ¡å™¨ç›´æ¥ç”Ÿäº§æ¸²æŸ“å¥½å¯¹åº”çš„HTMLé¡µé¢, è¿”å›ç»™å®¢æˆ·ç«¯è¿›è¡Œå±•ç¤º.</p>
<p><strong>ä½†æ˜¯, ä¸€ä¸ªç½‘ç«™, è¿™ä¹ˆå¤šé¡µé¢æœåŠ¡å™¨å¦‚ä½•å¤„ç†å‘¢?</strong></p>
<p>ä¸€ä¸ªé¡µé¢æœ‰è‡ªå·±å¯¹åº”çš„ç½‘å€, ä¹Ÿå°±æ˜¯URL.<br>URLä¼šå‘é€åˆ°æœåŠ¡å™¨, æœåŠ¡å™¨ä¼šé€šè¿‡æ­£åˆ™å¯¹è¯¥URLè¿›è¡ŒåŒ¹é…, å¹¶ä¸”æœ€åäº¤ç»™ä¸€ä¸ªControllerè¿›è¡Œå¤„ç†.<br>Controllerè¿›è¡Œå„ç§å¤„ç†, æœ€ç»ˆç”ŸæˆHTMLæˆ–è€…æ•°æ®, è¿”å›ç»™å‰ç«¯.<br>è¿™å°±å®Œæˆäº†ä¸€ä¸ªIOæ“ä½œ.</p>
<p><strong>ä¸Šé¢çš„è¿™ç§æ“ä½œ, å°±æ˜¯åç«¯è·¯ç”±.</strong><br>å½“æˆ‘ä»¬é¡µé¢ä¸­éœ€è¦è¯·æ±‚ä¸åŒçš„è·¯å¾„å†…å®¹æ—¶, äº¤ç»™æœåŠ¡å™¨æ¥è¿›è¡Œå¤„ç†, æœåŠ¡å™¨æ¸²æŸ“å¥½æ•´ä¸ªé¡µé¢, å¹¶ä¸”å°†é¡µé¢è¿”å›ç»™å®¢æˆ·é¡¿.<br>è¿™ç§æƒ…å†µä¸‹æ¸²æŸ“å¥½çš„é¡µé¢, ä¸éœ€è¦å•ç‹¬åŠ è½½ä»»ä½•çš„jså’Œcss, å¯ä»¥ç›´æ¥äº¤ç»™æµè§ˆå™¨å±•ç¤º, è¿™æ ·ä¹Ÿæœ‰åˆ©äºSEOçš„ä¼˜åŒ–.</p>
<p><strong>åç«¯è·¯ç”±çš„ç¼ºç‚¹:</strong></p>
<ul>
<li>ä¸€ç§æƒ…å†µæ˜¯æ•´ä¸ªé¡µé¢çš„æ¨¡å—ç”±åç«¯äººå‘˜æ¥ç¼–å†™å’Œç»´æŠ¤çš„.</li>
<li>å¦ä¸€ç§æƒ…å†µæ˜¯å‰ç«¯å¼€å‘äººå‘˜å¦‚æœè¦å¼€å‘é¡µé¢, éœ€è¦é€šè¿‡PHPå’ŒJavaç­‰è¯­è¨€æ¥ç¼–å†™é¡µé¢ä»£ç .</li>
<li>è€Œä¸”é€šå¸¸æƒ…å†µä¸‹HTMLä»£ç å’Œæ•°æ®ä»¥åŠå¯¹åº”çš„é€»è¾‘ä¼šæ··åœ¨ä¸€èµ·, ç¼–å†™å’Œç»´æŠ¤éƒ½æ˜¯éå¸¸ç³Ÿç³•çš„äº‹æƒ…</li>
</ul>
<h2 id="10-2-å‰ç«¯è·¯ç”±çš„é˜¶æ®µ"><a href="#10-2-å‰ç«¯è·¯ç”±çš„é˜¶æ®µ" class="headerlink" title="10.2 å‰ç«¯è·¯ç”±çš„é˜¶æ®µ"></a>10.2 å‰ç«¯è·¯ç”±çš„é˜¶æ®µ</h2><p><strong>å‰åç«¯åˆ†ç¦»é˜¶æ®µï¼š</strong><br>éšç€Ajaxçš„å‡ºç°, æœ‰äº†å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼.</p>
<blockquote>
<p>åç«¯åªæä¾›APIæ¥è¿”å›æ•°æ®, å‰ç«¯é€šè¿‡Ajaxè·å–æ•°æ®, å¹¶ä¸”å¯ä»¥é€šè¿‡JavaScriptå°†æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸­.<br>è¿™æ ·åšæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯å‰åç«¯è´£ä»»çš„æ¸…æ™°, åç«¯ä¸“æ³¨äºæ•°æ®ä¸Š, å‰ç«¯ä¸“æ³¨äºäº¤äº’å’Œå¯è§†åŒ–ä¸Š.<br>å¹¶ä¸”å½“ç§»åŠ¨ç«¯(iOS/Android)å‡ºç°å, åç«¯ä¸éœ€è¦è¿›è¡Œä»»ä½•å¤„ç†, ä¾ç„¶ä½¿ç”¨ä¹‹å‰çš„ä¸€å¥—APIå³å¯.<br>ç›®å‰å¾ˆå¤šçš„ç½‘ç«™ä¾ç„¶é‡‡ç”¨è¿™ç§æ¨¡å¼å¼€å‘.</p>
</blockquote>
<p><strong>å•é¡µé¢å¯Œåº”ç”¨é˜¶æ®µ:</strong><br>å…¶å®SPAæœ€ä¸»è¦çš„ç‰¹ç‚¹å°±æ˜¯åœ¨å‰åç«¯åˆ†ç¦»çš„åŸºç¡€ä¸ŠåŠ äº†ä¸€å±‚å‰ç«¯è·¯ç”±.<br>ä¹Ÿå°±æ˜¯å‰ç«¯æ¥ç»´æŠ¤ä¸€å¥—è·¯ç”±è§„åˆ™.</p>
<p><strong>å‰ç«¯è·¯ç”±çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong><br>æ”¹å˜URLï¼Œä½†æ˜¯é¡µé¢ä¸è¿›è¡Œæ•´ä½“çš„åˆ·æ–°</p>
<h2 id="10-3-è®¤è¯†å’Œå®‰è£…-Vue-router"><a href="#10-3-è®¤è¯†å’Œå®‰è£…-Vue-router" class="headerlink" title="10.3 è®¤è¯†å’Œå®‰è£… Vue-router"></a>10.3 è®¤è¯†å’Œå®‰è£… Vue-router</h2><p>vue-routeræ˜¯Vue.jså®˜æ–¹çš„è·¯ç”±æ’ä»¶ï¼Œå®ƒå’Œvue.jsæ˜¯æ·±åº¦é›†æˆçš„ï¼Œé€‚åˆç”¨äºæ„å»ºå•é¡µé¢åº”ç”¨ã€‚</p>
<p><strong>æˆ‘ä»¬å¯ä»¥è®¿é—®å…¶å®˜æ–¹ç½‘ç«™å¯¹å…¶è¿›è¡Œå­¦ä¹  <a href="https://router.vuejs.org/zh/">Vue Router (vuejs.org)</a></strong></p>
<p><strong>vue-routeræ˜¯åŸºäºè·¯ç”±å’Œç»„ä»¶çš„</strong></p>
<ul>
<li><p>è·¯ç”±ç”¨äºè®¾å®šè®¿é—®è·¯å¾„, å°†è·¯å¾„å’Œç»„ä»¶æ˜ å°„èµ·æ¥.</p>
</li>
<li><p>åœ¨vue-routerçš„å•é¡µé¢åº”ç”¨ä¸­, é¡µé¢çš„è·¯å¾„çš„æ”¹å˜å°±æ˜¯ç»„ä»¶çš„åˆ‡æ¢</p>
</li>
</ul>
<ul>
<li>æ­¥éª¤ä¸€ï¼šå®‰è£…å‘½ä»¤</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install vue-router --save</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ­¥éª¤äºŒï¼šæ¨¡å—åŒ–å·¥ç¨‹ä¸­ä½¿ç”¨å®ƒ(å› ä¸ºæ˜¯ä¸€ä¸ªæ’ä»¶, æ‰€ä»¥å¯ä»¥é€šè¿‡Vue.use()æ¥å®‰è£…è·¯ç”±åŠŸèƒ½)</p>
<ul>
<li><p>ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥è·¯ç”±å¯¹è±¡ï¼Œå¹¶ä¸”è°ƒç”¨ Vue.use(VueRouter)</p>
</li>
<li><p>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºè·¯ç”±å®ä¾‹ï¼Œå¹¶ä¸”ä¼ å…¥è·¯ç”±æ˜ å°„é…ç½® </p>
</li>
<li><p>ç¬¬ä¸‰æ­¥ï¼šåœ¨Vueå®ä¾‹ä¸­æŒ‚è½½åˆ›å»ºçš„è·¯ç”±å®ä¾‹ </p>
</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> <span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span> Vue.use(VueRouter)</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨vue-routerçš„æ­¥éª¤:</strong></p>
<ul>
<li><p>ç¬¬ä¸€æ­¥: åˆ›å»ºè·¯ç”±ç»„ä»¶</p>
</li>
<li><p>ç¬¬äºŒæ­¥: é…ç½®è·¯ç”±æ˜ å°„: ç»„ä»¶å’Œè·¯å¾„æ˜ å°„å…³ç³»</p>
</li>
<li><p>ç¬¬ä¸‰æ­¥: ä½¿ç”¨è·¯ç”±: é€šè¿‡<router-link>å’Œ<router-view></p>
</li>
</ul>
<p><strong>åˆ›å»ºVue-routerå®ä¾‹</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-29_18-39-17.png"></p>
<p><strong>æŒ‚è½½åˆ°Vueå®ä¾‹ä¸­</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-29_18-40-34.png"></p>
<p><strong>æ­¥éª¤ä¸€ï¼šåˆ›å»ºè·¯ç”±ç»„ä»¶</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429184238044.png" alt="image-20210429184238044"></p>
<p><strong>Home.vue</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">  &lt;h2&gt;æˆ‘æ˜¯é¦–é¡µ&lt;&#x2F;h2&gt;</span><br><span class="line">  &lt;p&gt;æˆ‘æ˜¯é¦–é¡µå†…å®¹ï¼Œå“ˆå“ˆå“ˆ&lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line">  &lt;router-link to&#x3D;&quot;&#x2F;home&#x2F;news&quot;&gt;æ–°é—»&lt;&#x2F;router-link&gt;</span><br><span class="line">  &lt;router-link to&#x3D;&quot;&#x2F;home&#x2F;message&quot;&gt;æ¶ˆæ¯&lt;&#x2F;router-link&gt;</span><br><span class="line">  &lt;router-view&gt;&lt;&#x2F;router-view&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Home&quot;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>About.vue</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;h2&gt;æˆ‘æ˜¯å…³äº&lt;&#x2F;h2&gt;</span><br><span class="line">    &lt;p&gt;æˆ‘æ˜¯å…³äºå†…å®¹ï¼Œå“ˆå“ˆå“ˆ&lt;&#x2F;p&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;About&quot;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ­¥éª¤äºŒï¼šé…ç½®ç»„ä»¶å’Œè·¯ç”±çš„æ˜ å°„å…³ç³»</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429184406195.png" alt="image-20210429184406195"></p>
<p><strong>index.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é€šè¿‡vue.useæ’ä»¶ å®‰è£…æ’ä»¶</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"><span class="comment">// import About from &quot;@/components/About&quot;;</span></span><br><span class="line"><span class="comment">// import Home from &quot;@/components/Home&quot;;</span></span><br><span class="line"><span class="keyword">import</span> User <span class="keyword">from</span> <span class="string">&quot;@/components/User&quot;</span>;</span><br><span class="line"><span class="comment">// import HomeNews from &quot;@/components/HomeNews&quot;;</span></span><br><span class="line"><span class="comment">// import HomeMessage from &quot;@/components/HomeMessage&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Home=<span class="function">()=&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../components/Home&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> news=<span class="function">()=&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../components/HomeNews&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> message=<span class="function">()=&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../components/HomeMessage&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> about=<span class="function">()=&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../components/About&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> Profile=<span class="function">()=&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../components/Profile&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºVuerouterå¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    redirect: <span class="string">&#x27;/home&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">    component: Home,</span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">&#x27;news&#x27;</span>,</span><br><span class="line">        component: news</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        path: <span class="string">&#x27;message&#x27;</span>,</span><br><span class="line">        component: message</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    meta:&#123;</span><br><span class="line">      title:<span class="string">&#x27;é¦–é¡µ&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    component: about,</span><br><span class="line">    meta: &#123;</span><br><span class="line">      title: <span class="string">&#x27;å…³äº&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/user/:userId&#x27;</span>,</span><br><span class="line">    component: User</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/profile&#x27;</span>,</span><br><span class="line">    component:Profile,</span><br><span class="line">    meta: &#123;</span><br><span class="line">      title: <span class="string">&#x27;æ¡£æ¡ˆ&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes,</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.document.title=to.meta.title</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;å“ˆå“ˆå“ˆ&#x27;</span>)</span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//å°†routerå¯¹è±¡ä¼ å…¥vueå®ä¾‹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p><strong>æ­¥éª¤ä¸‰ï¼šä½¿ç”¨è·¯ç”±</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429184542990.png" alt="image-20210429184542990"></p>
<blockquote>
<ul>
<li><router-link>: è¯¥æ ‡ç­¾æ˜¯ä¸€ä¸ªvue-routerä¸­å·²ç»å†…ç½®çš„ç»„ä»¶, å®ƒä¼šè¢«æ¸²æŸ“æˆä¸€ä¸ª<a>æ ‡ç­¾.</li>
<li><router-view>: è¯¥æ ‡ç­¾ä¼šæ ¹æ®å½“å‰çš„è·¯å¾„, åŠ¨æ€æ¸²æŸ“å‡ºä¸åŒçš„ç»„ä»¶.</li>
<li>ç½‘é¡µçš„å…¶ä»–å†…å®¹, æ¯”å¦‚é¡¶éƒ¨çš„æ ‡é¢˜/å¯¼èˆª, æˆ–è€…åº•éƒ¨çš„ä¸€äº›ç‰ˆæƒä¿¡æ¯ç­‰ä¼šå’Œ<router-view>å¤„äºåŒä¸€ä¸ªç­‰çº§.</li>
<li>åœ¨è·¯ç”±åˆ‡æ¢æ—¶, åˆ‡æ¢çš„æ˜¯<router-view>æŒ‚è½½çš„ç»„ä»¶, å…¶ä»–å†…å®¹ä¸ä¼šå‘ç”Ÿæ”¹å˜.</li>
</ul>
</blockquote>
<p><strong>App.vue</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">&lt;!--    &lt;img alt&#x3D;&quot;Vue logo&quot; src&#x3D;&quot;.&#x2F;assets&#x2F;logo.png&quot;&gt;</span><br><span class="line">    &lt;HelloWorld msg&#x3D;&quot;Welcome to Your Vue.js App&quot;&#x2F;&gt;--&gt;</span><br><span class="line">    &lt;router-link to&#x3D;&quot;&#x2F;home&quot; tag&#x3D;&quot;button&quot; replace&gt;é¦–é¡µ&lt;&#x2F;router-link&gt;</span><br><span class="line">    &lt;router-link to&#x3D;&quot;&#x2F;about&quot; tag&#x3D;&quot;button&quot; replace&gt;å…³äº&lt;&#x2F;router-link&gt;</span><br><span class="line">    &lt;router-link v-bind:to&#x3D;&quot;&#39;&#x2F;user&#x2F;&#39;+userId&quot; tag&#x3D;&quot;button&quot; replace&gt;ç”¨æˆ·&lt;&#x2F;router-link&gt;</span><br><span class="line">    &lt;router-link :to&#x3D;&quot;&#123;</span><br><span class="line">      path:&#39;&#x2F;profile&#x2F;&#39;+123,</span><br><span class="line">      query:&#123;name:&#39;zk&#39;,age:20&#125;</span><br><span class="line">    &#125;&quot; tag&#x3D;&quot;button&quot; replace&gt;æ¡£æ¡ˆ&lt;&#x2F;router-link&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;&#x2F;router-view&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  data()&#123;</span><br><span class="line">    return&#123;</span><br><span class="line">      userId:&#39;zhuangkang&#39;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;*components: &#123;</span><br><span class="line">    HelloWorld,</span><br><span class="line">    About,</span><br><span class="line">    Home,</span><br><span class="line">  &#125;*&#x2F;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">&#x2F;*#app &#123;</span><br><span class="line">  font-family: Avenir, Helvetica, Arial, sans-serif;</span><br><span class="line">  -webkit-font-smoothing: antialiased;</span><br><span class="line">  -moz-osx-font-smoothing: grayscale;</span><br><span class="line">  text-align: center;</span><br><span class="line">  color: #2c3e50;</span><br><span class="line">  margin-top: 60px;</span><br><span class="line">&#125;*&#x2F;</span><br><span class="line">.router-link-active&#123;</span><br><span class="line">  color: crimson;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/image-20210429184737178.png"></p>
<p><strong>è®¾ç½®è·¯ç”±é»˜è®¤è·¯å¾„</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429184815709.png" alt="image-20210429184815709"></p>
<blockquote>
<p>æˆ‘ä»¬åœ¨routesä¸­åˆé…ç½®äº†ä¸€ä¸ªæ˜ å°„.<br>pathé…ç½®çš„æ˜¯æ ¹è·¯å¾„: /<br>redirectæ˜¯é‡å®šå‘, ä¹Ÿå°±æ˜¯æˆ‘ä»¬å°†æ ¹è·¯å¾„é‡å®šå‘åˆ°/homeçš„è·¯å¾„ä¸‹, è¿™æ ·å°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœäº†.</p>
</blockquote>
<p><strong>HTML5çš„Historyæ¨¡å¼</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429184907487.png" alt="image-20210429184907487"></p>
<p>æµ‹è¯•</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429184918287.png" alt="image-20210429184918287"></p>
<p><strong>router-linkè¡¥å……</strong></p>
<ul>
<li>åœ¨å‰é¢çš„<router-link>ä¸­, æˆ‘ä»¬åªæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªå±æ€§: to, ç”¨äºæŒ‡å®šè·³è½¬çš„è·¯å¾„.</li>
<li><router-link>è¿˜æœ‰ä¸€äº›å…¶ä»–å±æ€§:<ul>
<li>tag: tagå¯ä»¥æŒ‡å®š<router-link>ä¹‹åæ¸²æŸ“æˆä»€ä¹ˆç»„ä»¶, æ¯”å¦‚ä¸Šé¢çš„ä»£ç ä¼šè¢«æ¸²æŸ“æˆä¸€ä¸ª<li>å…ƒç´ , è€Œä¸æ˜¯<a></li>
<li>replace: replaceä¸ä¼šç•™ä¸‹historyè®°å½•, æ‰€ä»¥æŒ‡å®šreplaceçš„æƒ…å†µä¸‹, åé€€é”®è¿”å›ä¸èƒ½è¿”å›åˆ°ä¸Šä¸€ä¸ªé¡µé¢ä¸­</li>
<li>active-class: å½“<router-link>å¯¹åº”çš„è·¯ç”±åŒ¹é…æˆåŠŸæ—¶, ä¼šè‡ªåŠ¨ç»™å½“å‰å…ƒç´ è®¾ç½®ä¸€ä¸ªrouter-link-activeçš„class, è®¾ç½®active-classå¯ä»¥ä¿®æ”¹é»˜è®¤çš„åç§°.</li>
<li>åœ¨è¿›è¡Œé«˜äº®æ˜¾ç¤ºçš„å¯¼èˆªèœå•æˆ–è€…åº•éƒ¨tabbaræ—¶, ä¼šä½¿ç”¨åˆ°è¯¥ç±».<br>ä½†æ˜¯é€šå¸¸ä¸ä¼šä¿®æ”¹ç±»çš„å±æ€§, ä¼šç›´æ¥ä½¿ç”¨é»˜è®¤çš„router-link-activeå³å¯.  </li>
</ul>
</li>
</ul>
<p><img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\image-20210429185058134.png" alt="image-20210429185058134"></p>
<p><strong>è·¯ç”±ä»£ç è·³è½¬</strong></p>
<p>å°†ä»£ç ä¿®æ”¹å¦‚ä¸‹</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429185142200.png" alt="image-20210429185142200"></p>
<p><strong>åŠ¨æ€è·¯ç”±</strong></p>
<blockquote>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªé¡µé¢çš„pathè·¯å¾„å¯èƒ½æ˜¯ä¸ç¡®å®šçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿›å…¥ç”¨æˆ·ç•Œé¢æ—¶ï¼Œå¸Œæœ›æ˜¯å¦‚ä¸‹çš„è·¯å¾„ï¼š/user/aaaaæˆ–/user/bbbb<br>é™¤äº†æœ‰å‰é¢çš„/userä¹‹å¤–ï¼Œåé¢è¿˜è·Ÿä¸Šäº†ç”¨æˆ·çš„ID<br>è¿™ç§pathå’ŒComponentçš„åŒ¹é…å…³ç³»ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŠ¨æ€è·¯ç”±(ä¹Ÿæ˜¯è·¯ç”±ä¼ é€’æ•°æ®çš„ä¸€ç§æ–¹å¼)ã€‚</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429185250739.png" alt="image-20210429185250739"></p>
<h2 id="10-4-è·¯ç”±çš„æ‡’åŠ è½½"><a href="#10-4-è·¯ç”±çš„æ‡’åŠ è½½" class="headerlink" title="10.4 è·¯ç”±çš„æ‡’åŠ è½½"></a>10.4 è·¯ç”±çš„æ‡’åŠ è½½</h2><blockquote>
<p><strong>å®˜æ–¹ç»™å‡ºäº†è§£é‡Š:</strong><br>å½“æ‰“åŒ…æ„å»ºåº”ç”¨æ—¶ï¼ŒJavascript åŒ…ä¼šå˜å¾—éå¸¸å¤§ï¼Œå½±å“é¡µé¢åŠ è½½ã€‚<br>å¦‚æœæˆ‘ä»¬èƒ½æŠŠä¸åŒè·¯ç”±å¯¹åº”çš„ç»„ä»¶åˆ†å‰²æˆä¸åŒçš„ä»£ç å—ï¼Œç„¶åå½“è·¯ç”±è¢«è®¿é—®çš„æ—¶å€™æ‰åŠ è½½å¯¹åº”ç»„ä»¶ï¼Œè¿™æ ·å°±æ›´åŠ é«˜æ•ˆäº†</p>
<p><strong>å®˜æ–¹åœ¨è¯´ä»€ä¹ˆå‘¢?</strong><br>é¦–å…ˆ, æˆ‘ä»¬çŸ¥é“è·¯ç”±ä¸­é€šå¸¸ä¼šå®šä¹‰å¾ˆå¤šä¸åŒçš„é¡µé¢.<br>è¿™ä¸ªé¡µé¢æœ€åè¢«æ‰“åŒ…åœ¨å“ªé‡Œå‘¢? ä¸€èˆ¬æƒ…å†µä¸‹, æ˜¯æ”¾åœ¨ä¸€ä¸ªjsæ–‡ä»¶ä¸­.<br>ä½†æ˜¯, é¡µé¢è¿™ä¹ˆå¤šæ”¾åœ¨ä¸€ä¸ªjsæ–‡ä»¶ä¸­, å¿…ç„¶ä¼šé€ æˆè¿™ä¸ªé¡µé¢éå¸¸çš„å¤§.<br>å¦‚æœæˆ‘ä»¬ä¸€æ¬¡æ€§ä»æœåŠ¡å™¨è¯·æ±‚ä¸‹æ¥è¿™ä¸ªé¡µé¢, å¯èƒ½éœ€è¦èŠ±è´¹ä¸€å®šçš„æ—¶é—´, ç”šè‡³ç”¨æˆ·çš„ç”µè„‘ä¸Šè¿˜å‡ºç°äº†çŸ­æš‚ç©ºç™½çš„æƒ…å†µ.<br>å¦‚ä½•é¿å…è¿™ç§æƒ…å†µå‘¢? ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½å°±å¯ä»¥äº†.</p>
<p><strong>è·¯ç”±æ‡’åŠ è½½åšäº†ä»€ä¹ˆ?</strong><br>è·¯ç”±æ‡’åŠ è½½çš„ä¸»è¦ä½œç”¨å°±æ˜¯å°†è·¯ç”±å¯¹åº”çš„ç»„ä»¶æ‰“åŒ…æˆä¸€ä¸ªä¸ªçš„jsä»£ç å—.<br>åªæœ‰åœ¨è¿™ä¸ªè·¯ç”±è¢«è®¿é—®åˆ°çš„æ—¶å€™, æ‰åŠ è½½å¯¹åº”çš„ç»„ä»¶</p>
</blockquote>
<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429185731621.png" alt="image-20210429185731621"></p>
<p><strong>æ‡’åŠ è½½çš„æ–¹å¼</strong></p>
<p><img src="C:\Users\dell\Desktop\Notes\Vue\img\Snipaste_2021-04-29_18-58-37.png"></p>
<h2 id="10-5-åµŒå¥—è·¯ç”±"><a href="#10-5-åµŒå¥—è·¯ç”±" class="headerlink" title="10.5 åµŒå¥—è·¯ç”±"></a>10.5 åµŒå¥—è·¯ç”±</h2><p>åµŒå¥—è·¯ç”±æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„åŠŸèƒ½<br>æ¯”å¦‚åœ¨homeé¡µé¢ä¸­, æˆ‘ä»¬å¸Œæœ›é€šè¿‡/home/newså’Œ/home/messageè®¿é—®ä¸€äº›å†…å®¹.<br>ä¸€ä¸ªè·¯å¾„æ˜ å°„ä¸€ä¸ªç»„ä»¶, è®¿é—®è¿™ä¸¤ä¸ªè·¯å¾„ä¹Ÿä¼šåˆ†åˆ«æ¸²æŸ“ä¸¤ä¸ªç»„ä»¶.</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429190352003.png" alt="image-20210429190352003"></p>
<blockquote>
<ul>
<li>å®ç°åµŒå¥—è·¯ç”±æœ‰ä¸¤ä¸ªæ­¥éª¤:</li>
<li>åˆ›å»ºå¯¹åº”çš„å­ç»„ä»¶, å¹¶ä¸”åœ¨è·¯ç”±æ˜ å°„ä¸­é…ç½®å¯¹åº”çš„å­è·¯ç”±.</li>
<li>åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨<router-view>æ ‡ç­¾.</li>
</ul>
</blockquote>
<p><strong>åµŒå¥—è·¯ç”±å®ç°</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429191209978.png" alt="image-20210429191209978"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-29_19-11-29.png" alt="Snipaste_2021-04-29_19-11-29"></p>
<p><strong>åµŒå¥—é»˜è®¤è·¯å¾„</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429191558955.png" alt="image-20210429191558955"></p>
<blockquote>
<p><strong>æ¼”ç¤ºä¼ é€’å‚æ•°, æˆ‘ä»¬è¿™é‡Œå†åˆ›å»ºä¸€ä¸ªç»„ä»¶, å¹¶ä¸”å°†å…¶é…ç½®å¥½</strong><br>ç¬¬ä¸€æ­¥: åˆ›å»ºæ–°çš„ç»„ä»¶Profile.vue<br>ç¬¬äºŒæ­¥: é…ç½®è·¯ç”±æ˜ å°„<br>ç¬¬ä¸‰æ­¥: æ·»åŠ è·³è½¬çš„<router-link></p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429192013898.png" alt="image-20210429192013898"></p>
<p><strong>ä¼ é€’å‚æ•°çš„æ–¹å¼</strong></p>
<blockquote>
<p><strong>ä¼ é€’å‚æ•°ä¸»è¦æœ‰ä¸¤ç§ç±»å‹: paramså’Œquery</strong></p>
<ul>
<li><p><strong>paramsçš„ç±»å‹:</strong><br>é…ç½®è·¯ç”±æ ¼å¼: /router/:id<br>ä¼ é€’çš„æ–¹å¼: åœ¨pathåé¢è·Ÿä¸Šå¯¹åº”çš„å€¼<br>ä¼ é€’åå½¢æˆçš„è·¯å¾„: /router/123, /router/abc</p>
</li>
<li><p><strong>queryçš„ç±»å‹:</strong><br>é…ç½®è·¯ç”±æ ¼å¼: /router, ä¹Ÿå°±æ˜¯æ™®é€šé…ç½®<br>ä¼ é€’çš„æ–¹å¼: å¯¹è±¡ä¸­ä½¿ç”¨queryçš„keyä½œä¸ºä¼ é€’æ–¹å¼<br>ä¼ é€’åå½¢æˆçš„è·¯å¾„: /router?id=123, /router?id=abc</p>
</li>
</ul>
</blockquote>
<p><strong>ä¼ é€’å‚æ•°æ–¹å¼ä¸€: <router-link></strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429192148916.png" alt="image-20210429192148916"></p>
<p><strong>ä¼ é€’å‚æ•°æ–¹å¼äºŒ: JavaScriptä»£ç </strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210429192208324.png" alt="image-20210429192208324"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-04-29_19-24-27.png" alt="Snipaste_2021-04-29_19-24-27"></p>
<h2 id="10-6-å¯¼èˆªå®ˆå«"><a href="#10-6-å¯¼èˆªå®ˆå«" class="headerlink" title="10.6 å¯¼èˆªå®ˆå«"></a>10.6 å¯¼èˆªå®ˆå«</h2><blockquote>
<p>æˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸ªéœ€æ±‚: åœ¨ä¸€ä¸ªSPAåº”ç”¨ä¸­, å¦‚ä½•æ”¹å˜ç½‘é¡µçš„æ ‡é¢˜å‘¢?</p>
<ul>
<li>ç½‘é¡µæ ‡é¢˜æ˜¯é€šè¿‡<title>æ¥æ˜¾ç¤ºçš„, ä½†æ˜¯SPAåªæœ‰ä¸€ä¸ªå›ºå®šçš„HTML, åˆ‡æ¢ä¸åŒçš„é¡µé¢æ—¶, æ ‡é¢˜å¹¶ä¸ä¼šæ”¹å˜.</li>
<li>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡JavaScriptæ¥ä¿®æ”¹<title>çš„å†…å®¹.window.document.title = â€˜æ–°çš„æ ‡é¢˜â€™.</li>
<li>é‚£ä¹ˆåœ¨Vueé¡¹ç›®ä¸­, åœ¨å“ªé‡Œä¿®æ”¹? ä»€ä¹ˆæ—¶å€™ä¿®æ”¹æ¯”è¾ƒåˆé€‚å‘¢?<ul>
<li>æ™®é€šçš„ä¿®æ”¹æ–¹å¼:<ul>
<li>æˆ‘ä»¬æ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„ä¿®æ”¹æ ‡é¢˜çš„ä½ç½®æ˜¯æ¯ä¸€ä¸ªè·¯ç”±å¯¹åº”çš„ç»„ä»¶.vueæ–‡ä»¶ä¸­.<br>é€šè¿‡mountedå£°æ˜å‘¨æœŸå‡½æ•°, æ‰§è¡Œå¯¹åº”çš„ä»£ç è¿›è¡Œä¿®æ”¹å³å¯.<br>ä½†æ˜¯å½“é¡µé¢æ¯”è¾ƒå¤šæ—¶, è¿™ç§æ–¹å¼ä¸å®¹æ˜“ç»´æŠ¤(å› ä¸ºéœ€è¦åœ¨å¤šä¸ªé¡µé¢æ‰§è¡Œç±»ä¼¼çš„ä»£ç ).<br>æœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•å‘¢? ä½¿ç”¨å¯¼èˆªå®ˆå«å³å¯.</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p><strong>ä»€ä¹ˆæ˜¯å¯¼èˆªå®ˆå«?</strong>(<strong>â€œå¯¼èˆªâ€è¡¨ç¤ºè·¯ç”±æ­£åœ¨å‘ç”Ÿæ”¹å˜ã€‚</strong>)</p>
<ul>
<li>vue-routeræä¾›çš„å¯¼èˆªå®ˆå«ä¸»è¦ç”¨æ¥ç›‘å¬ç›‘å¬è·¯ç”±çš„è¿›å…¥å’Œç¦»å¼€çš„.</li>
<li>vue-routeræä¾›äº†beforeEachå’ŒafterEachçš„é’©å­å‡½æ•°, å®ƒä»¬ä¼šåœ¨è·¯ç”±å³å°†æ”¹å˜å‰å’Œæ”¹å˜åè§¦å‘.</li>
</ul>
<h3 id="å…¨å±€å‰ç½®å®ˆå«"><a href="#å…¨å±€å‰ç½®å®ˆå«" class="headerlink" title="å…¨å±€å‰ç½®å®ˆå«"></a>å…¨å±€å‰ç½®å®ˆå«</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123; ... &#125;)</span><br><span class="line"></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å½“ä¸€ä¸ªå¯¼èˆªè§¦å‘æ—¶ï¼Œå…¨å±€å‰ç½®å®ˆå«æŒ‰ç…§åˆ›å»ºé¡ºåºè°ƒç”¨ã€‚å®ˆå«æ˜¯å¼‚æ­¥è§£ææ‰§è¡Œï¼Œæ­¤æ—¶å¯¼èˆªåœ¨æ‰€æœ‰å®ˆå« resolve å®Œä¹‹å‰ä¸€ç›´å¤„äº <strong>ç­‰å¾…ä¸­</strong>ã€‚</p>
<p>æ¯ä¸ªå®ˆå«æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><strong><code>to: Route</code></strong>: å³å°†è¦è¿›å…¥çš„ç›®æ ‡ <a href="https://router.vuejs.org/zh/api/#%E8%B7%AF%E7%94%B1%E5%AF%B9%E8%B1%A1">è·¯ç”±å¯¹è±¡</a></li>
<li><strong><code>from: Route</code></strong>: å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±</li>
<li><strong><code>next: Function</code></strong>: ä¸€å®šè¦è°ƒç”¨è¯¥æ–¹æ³•æ¥ <strong>resolve</strong> è¿™ä¸ªé’©å­ã€‚æ‰§è¡Œæ•ˆæœä¾èµ– <code>next</code> æ–¹æ³•çš„è°ƒç”¨å‚æ•°ã€‚<ul>
<li><strong><code>next()</code></strong>: è¿›è¡Œç®¡é“ä¸­çš„ä¸‹ä¸€ä¸ªé’©å­ã€‚å¦‚æœå…¨éƒ¨é’©å­æ‰§è¡Œå®Œäº†ï¼Œåˆ™å¯¼èˆªçš„çŠ¶æ€å°±æ˜¯ <strong>confirmed</strong> (ç¡®è®¤çš„)ã€‚</li>
<li><strong><code>next(false)</code></strong>: ä¸­æ–­å½“å‰çš„å¯¼èˆªã€‚å¦‚æœæµè§ˆå™¨çš„ URL æ”¹å˜äº† (å¯èƒ½æ˜¯ç”¨æˆ·æ‰‹åŠ¨æˆ–è€…æµè§ˆå™¨åé€€æŒ‰é’®)ï¼Œé‚£ä¹ˆ URL åœ°å€ä¼šé‡ç½®åˆ° <code>from</code> è·¯ç”±å¯¹åº”çš„åœ°å€ã€‚</li>
<li><strong><code>next(&#39;/&#39;)</code> æˆ–è€… <code>next(&#123; path: &#39;/&#39; &#125;)</code></strong>: è·³è½¬åˆ°ä¸€ä¸ªä¸åŒçš„åœ°å€ã€‚å½“å‰çš„å¯¼èˆªè¢«ä¸­æ–­ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªæ–°çš„å¯¼èˆªã€‚ä½ å¯ä»¥å‘ <code>next</code> ä¼ é€’ä»»æ„ä½ç½®å¯¹è±¡ï¼Œä¸”å…è®¸è®¾ç½®è¯¸å¦‚ <code>replace: true</code>ã€<code>name: &#39;home&#39;</code> ä¹‹ç±»çš„é€‰é¡¹ä»¥åŠä»»ä½•ç”¨åœ¨ <a href="https://router.vuejs.org/zh/api/#to"><code>router-link</code> çš„ <code>to</code> prop</a> æˆ– <a href="https://router.vuejs.org/zh/api/#router-push"><code>router.push</code></a> ä¸­çš„é€‰é¡¹ã€‚</li>
<li><strong><code>next(error)</code></strong>: (2.4.0+) å¦‚æœä¼ å…¥ <code>next</code> çš„å‚æ•°æ˜¯ä¸€ä¸ª <code>Error</code> å®ä¾‹ï¼Œåˆ™å¯¼èˆªä¼šè¢«ç»ˆæ­¢ä¸”è¯¥é”™è¯¯ä¼šè¢«ä¼ é€’ç»™ <a href="https://router.vuejs.org/zh/api/#router-onerror"><code>router.onError()</code></a> æ³¨å†Œè¿‡çš„å›è°ƒã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç¡®ä¿ <code>next</code> å‡½æ•°åœ¨ä»»ä½•ç»™å®šçš„å¯¼èˆªå®ˆå«ä¸­éƒ½è¢«ä¸¥æ ¼è°ƒç”¨ä¸€æ¬¡ã€‚å®ƒå¯ä»¥å‡ºç°å¤šäºä¸€æ¬¡ï¼Œä½†æ˜¯åªèƒ½åœ¨æ‰€æœ‰çš„é€»è¾‘è·¯å¾„éƒ½ä¸é‡å çš„æƒ…å†µä¸‹ï¼Œå¦åˆ™é’©å­æ°¸è¿œéƒ½ä¸ä¼šè¢«è§£ææˆ–æŠ¥é”™</strong>ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåœ¨ç”¨æˆ·æœªèƒ½éªŒè¯èº«ä»½æ—¶é‡å®šå‘åˆ° <code>/login</code> çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// BAD</span></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.name !== <span class="string">&#x27;Login&#x27;</span> &amp;&amp; !isAuthenticated) next(&#123; <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span> &#125;)</span><br><span class="line">  <span class="comment">// å¦‚æœç”¨æˆ·æœªèƒ½éªŒè¯èº«ä»½ï¼Œåˆ™ `next` ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡</span></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// GOOD</span></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.name !== <span class="string">&#x27;Login&#x27;</span> &amp;&amp; !isAuthenticated) next(&#123; <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span> &#125;)</span><br><span class="line">  <span class="keyword">else</span> next()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>è¡¥å……ä¸€:å¦‚æœæ˜¯åç½®é’©å­, ä¹Ÿå°±æ˜¯afterEach, ä¸éœ€è¦ä¸»åŠ¨è°ƒç”¨next()å‡½æ•°.</p>
</li>
<li><p>è¡¥å……äºŒ: ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨çš„å¯¼èˆªå®ˆå«, è¢«ç§°ä¹‹ä¸ºå…¨å±€å®ˆå«.</p>
<ul>
<li>è·¯ç”±ç‹¬äº«çš„å®ˆå«.</li>
<li>ç»„ä»¶å†…çš„å®ˆå«.</li>
</ul>
</li>
</ul>
<p><strong>å…¶ä½™å‚è€ƒå®˜ç½‘ï¼š<a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E7%BB%84%E4%BB%B6%E5%86%85%E7%9A%84%E5%AE%88%E5%8D%AB">å¯¼èˆªå®ˆå« | Vue Router (vuejs.org)</a></strong></p>
<h3 id="router-view"><a href="#router-view" class="headerlink" title="router-view"></a>router-view</h3><p><code>&lt;router-view&gt;</code> ç»„ä»¶æ˜¯ä¸€ä¸ª functional ç»„ä»¶ï¼Œæ¸²æŸ“è·¯å¾„åŒ¹é…åˆ°çš„è§†å›¾ç»„ä»¶ã€‚<code>&lt;router-view&gt;</code> æ¸²æŸ“çš„ç»„ä»¶è¿˜å¯ä»¥å†…åµŒè‡ªå·±çš„ <code>&lt;router-view&gt;</code>ï¼Œæ ¹æ®åµŒå¥—è·¯å¾„ï¼Œæ¸²æŸ“åµŒå¥—ç»„ä»¶ã€‚</p>
<p>å…¶ä»–å±æ€§ (é router-view ä½¿ç”¨çš„å±æ€§) éƒ½ç›´æ¥ä¼ ç»™æ¸²æŸ“çš„ç»„ä»¶ï¼Œ å¾ˆå¤šæ—¶å€™ï¼Œæ¯ä¸ªè·¯ç”±çš„æ•°æ®éƒ½æ˜¯åŒ…å«åœ¨è·¯ç”±å‚æ•°ä¸­ã€‚</p>
<p>å› ä¸ºå®ƒä¹Ÿæ˜¯ä¸ªç»„ä»¶ï¼Œæ‰€ä»¥å¯ä»¥é…åˆ <code>&lt;transition&gt;</code> å’Œ <code>&lt;keep-alive&gt;</code> ä½¿ç”¨ã€‚å¦‚æœä¸¤ä¸ªç»“åˆä¸€èµ·ç”¨ï¼Œè¦ç¡®ä¿åœ¨å†…å±‚ä½¿ç”¨ <code>&lt;keep-alive&gt;</code>ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="11ï¼ŒPromise"><a href="#11ï¼ŒPromise" class="headerlink" title="11ï¼ŒPromise"></a>11ï¼ŒPromise</h1><p><strong>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise - JavaScript | MDN (mozilla.org)</a></strong></p>
<blockquote>
<p>ES6ä¸­ä¸€ä¸ªéå¸¸é‡è¦å’Œå¥½ç”¨çš„ç‰¹æ€§å°±æ˜¯Promise<br>ä½†æ˜¯åˆæ¬¡æ¥è§¦Promiseä¼šä¸€è„¸æ‡µé€¼ï¼Œè¿™TMæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</p>
<p>Promiseåˆ°åº•æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿ<br>Promiseæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚<br>é‚£ä»€ä¹ˆæ—¶å€™æˆ‘ä»¬ä¼šæ¥å¤„ç†å¼‚æ­¥äº‹ä»¶å‘¢ï¼Ÿ</p>
<p>ä¸€ç§å¾ˆå¸¸è§çš„åœºæ™¯åº”è¯¥å°±æ˜¯ç½‘ç»œè¯·æ±‚äº†ã€‚<br>æˆ‘ä»¬å°è£…ä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„å‡½æ•°ï¼Œå› ä¸ºä¸èƒ½ç«‹å³æ‹¿åˆ°ç»“æœï¼Œæ‰€ä»¥ä¸èƒ½åƒç®€å•çš„3+4=7ä¸€æ ·å°†ç»“æœè¿”å›ã€‚<br>æ‰€ä»¥å¾€å¾€æˆ‘ä»¬ä¼šä¼ å…¥å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æ•°æ®è¯·æ±‚æˆåŠŸæ—¶ï¼Œå°†æ•°æ®é€šè¿‡ä¼ å…¥çš„å‡½æ•°å›è°ƒå‡ºå»ã€‚<br>å¦‚æœåªæ˜¯ä¸€ä¸ªç®€å•çš„ç½‘ç»œè¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ç§æ–¹æ¡ˆä¸ä¼šç»™æˆ‘ä»¬å¸¦æ¥å¾ˆå¤§çš„éº»çƒ¦ã€‚</p>
</blockquote>
<h2 id="11-2-ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±"><a href="#11-2-ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±" class="headerlink" title="11.2 ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±"></a>11.2 ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±</h2><ul>
<li>æˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªurl1ä»æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªæ•°æ®data1ï¼Œdata1ä¸­åŒ…å«äº†ä¸‹ä¸€ä¸ªè¯·æ±‚çš„url2</li>
<li>æˆ‘ä»¬éœ€è¦é€šè¿‡data1å–å‡ºurl2ï¼Œä»æœåŠ¡å™¨åŠ è½½æ•°æ®data2ï¼Œdata2ä¸­åŒ…å«äº†ä¸‹ä¸€ä¸ªè¯·æ±‚çš„url3</li>
<li>æˆ‘ä»¬éœ€è¦é€šè¿‡data2å–å‡ºurl3ï¼Œä»æœåŠ¡å™¨åŠ è½½æ•°æ®data3ï¼Œdata3ä¸­åŒ…å«äº†ä¸‹ä¸€ä¸ªè¯·æ±‚çš„url4</li>
<li>å‘é€ç½‘ç»œè¯·æ±‚url4ï¼Œè·å–æœ€ç»ˆçš„æ•°æ®data4</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210504181753747.png" alt="image-20210504181753747"></p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå®šæ—¶å™¨æ¥æ¨¡æ‹Ÿå¼‚æ­¥äº‹ä»¶ï¼š</p>
<ul>
<li>å‡è®¾ä¸‹é¢çš„dataæ˜¯ä»ç½‘ç»œä¸Š1ç§’åè¯·æ±‚çš„æ•°æ®</li>
<li>console.logå°±æ˜¯æˆ‘ä»¬çš„å¤„ç†æ–¹å¼</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210504181837349.png" alt="image-20210504181837349"></p>
<p>æ¢æˆpromiseæ–¹æ³•</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210504181905331.png" alt="image-20210504181905331"></p>
<h2 id="11-2-å®šæ—¶å™¨å¼‚æ­¥äº‹ä»¶è§£æ"><a href="#11-2-å®šæ—¶å™¨å¼‚æ­¥äº‹ä»¶è§£æ" class="headerlink" title="11.2 å®šæ—¶å™¨å¼‚æ­¥äº‹ä»¶è§£æ"></a>11.2 å®šæ—¶å™¨å¼‚æ­¥äº‹ä»¶è§£æ</h2><p>new Promiseå¾ˆæ˜æ˜¾æ˜¯åˆ›å»ºä¸€ä¸ªPromiseå¯¹è±¡<br>å°æ‹¬å·ä¸­((resolve, reject) =&gt; {})ä¹Ÿå¾ˆæ˜æ˜¾å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸”æˆ‘ä»¬è¿™é‡Œç”¨çš„æ˜¯ä¹‹å‰åˆšåˆšå­¦ä¹ è¿‡çš„ç®­å¤´å‡½æ•°ã€‚</p>
<p>ä½†æ˜¯resolve, rejectå®ƒä»¬æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>æˆ‘ä»¬å…ˆçŸ¥é“ä¸€ä¸ªäº‹å®ï¼šåœ¨åˆ›å»ºPromiseæ—¶ï¼Œä¼ å…¥çš„è¿™ä¸ªç®­å¤´å‡½æ•°æ˜¯å›ºå®šçš„ï¼ˆä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šè¿™æ ·å†™ï¼‰<br>resolveå’Œrejectå®ƒä»¬ä¸¤ä¸ªä¹Ÿæ˜¯å‡½æ•°ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®è¯·æ±‚æ•°æ®çš„æˆåŠŸå’Œå¤±è´¥æ¥å†³å®šè°ƒç”¨å“ªä¸€ä¸ªã€‚</p>
<p>æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Ÿ<br><strong>å¦‚æœæ˜¯æˆåŠŸçš„ï¼Œé‚£ä¹ˆé€šå¸¸æˆ‘ä»¬ä¼šè°ƒç”¨resolve(messsage)ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åç»­çš„thenä¼šè¢«å›è°ƒ<br>å¦‚æœæ˜¯å¤±è´¥çš„ï¼Œé‚£ä¹ˆé€šå¸¸æˆ‘ä»¬ä¼šè°ƒç”¨reject(error)ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åç»­çš„catchä¼šè¢«å›è°ƒ</strong></p>
<h2 id="11-3-Promise-çŠ¶æ€"><a href="#11-3-Promise-çŠ¶æ€" class="headerlink" title="11.3 Promise çŠ¶æ€"></a>11.3 Promise çŠ¶æ€</h2><p>ä¸€ä¸ª <code>Promise</code> å¿…ç„¶å¤„äºä»¥ä¸‹å‡ ç§çŠ¶æ€ä¹‹ä¸€ï¼š</p>
<ul>
<li><em>å¾…å®šï¼ˆpendingï¼‰</em>: åˆå§‹çŠ¶æ€ï¼Œæ—¢æ²¡æœ‰è¢«å…‘ç°ï¼Œä¹Ÿæ²¡æœ‰è¢«æ‹’ç»ã€‚</li>
<li><em>å·²å…‘ç°ï¼ˆfulfilledï¼‰</em>: æ„å‘³ç€æ“ä½œæˆåŠŸå®Œæˆã€‚</li>
<li><em>å·²æ‹’ç»ï¼ˆrejectedï¼‰</em>: æ„å‘³ç€æ“ä½œå¤±è´¥ã€‚</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210504183229167.png" alt="image-20210504183229167"></p>
<h2 id="11-4-é“¾å¼è°ƒç”¨"><a href="#11-4-é“¾å¼è°ƒç”¨" class="headerlink" title="11.4 é“¾å¼è°ƒç”¨"></a>11.4 é“¾å¼è°ƒç”¨</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210504183328133.png" alt="image-20210504183328133"></p>
<p>ä½¿ç”¨é“¾å¼å†™æ³•å</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210504183346165.png" alt="image-20210504183346165"></p>
<h1 id="12ï¼ŒVueX"><a href="#12ï¼ŒVueX" class="headerlink" title="12ï¼ŒVueX"></a>12ï¼ŒVueX</h1><h2 id="12-1-ä»€ä¹ˆæ˜¯VueXï¼Ÿ"><a href="#12-1-ä»€ä¹ˆæ˜¯VueXï¼Ÿ" class="headerlink" title="12.1 ä»€ä¹ˆæ˜¯VueXï¼Ÿ"></a>12.1 ä»€ä¹ˆæ˜¯VueXï¼Ÿ</h2><p>Vuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„<strong>çŠ¶æ€ç®¡ç†æ¨¡å¼</strong>ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚</p>
<p><strong>ä»€ä¹ˆæ˜¯çŠ¶æ€ç®¡ç†æ¨¡å¼ï¼Ÿ</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  <span class="comment">// state</span></span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      count: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// view</span></span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  <span class="comment">// actions</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    increment () &#123;</span><br><span class="line">      <span class="built_in">this</span>.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªçŠ¶æ€è‡ªç®¡ç†åº”ç”¨åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>state</strong>ï¼Œé©±åŠ¨åº”ç”¨çš„æ•°æ®æºï¼›</li>
<li><strong>view</strong>ï¼Œä»¥å£°æ˜æ–¹å¼å°† <strong>state</strong> æ˜ å°„åˆ°è§†å›¾ï¼›</li>
<li><strong>actions</strong>ï¼Œå“åº”åœ¨ <strong>view</strong> ä¸Šçš„ç”¨æˆ·è¾“å…¥å¯¼è‡´çš„çŠ¶æ€å˜åŒ–</li>
</ul>
<p><strong>å•å‘æ•°æ®æµå›¾ç¤º</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210510101723005.png" alt="image-20210510101723005"></p>
<p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬çš„åº”ç”¨é‡åˆ°<strong>å¤šä¸ªç»„ä»¶å…±äº«çŠ¶æ€</strong>æ—¶ï¼Œå•å‘æ•°æ®æµçš„ç®€æ´æ€§å¾ˆå®¹æ˜“è¢«ç ´åï¼š</p>
<ul>
<li>å¤šä¸ªè§†å›¾ä¾èµ–äºåŒä¸€çŠ¶æ€ã€‚</li>
<li>æ¥è‡ªä¸åŒè§†å›¾çš„è¡Œä¸ºéœ€è¦å˜æ›´åŒä¸€çŠ¶æ€ã€‚</li>
</ul>
<p>å¯¹äºé—®é¢˜ä¸€ï¼Œä¼ å‚çš„æ–¹æ³•å¯¹äºå¤šå±‚åµŒå¥—çš„ç»„ä»¶å°†ä¼šéå¸¸ç¹çï¼Œå¹¶ä¸”å¯¹äºå…„å¼Ÿç»„ä»¶é—´çš„çŠ¶æ€ä¼ é€’æ— èƒ½ä¸ºåŠ›ã€‚å¯¹äºé—®é¢˜äºŒï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡‡ç”¨çˆ¶å­ç»„ä»¶ç›´æ¥å¼•ç”¨æˆ–è€…é€šè¿‡äº‹ä»¶æ¥å˜æ›´å’ŒåŒæ­¥çŠ¶æ€çš„å¤šä»½æ‹·è´ã€‚ä»¥ä¸Šçš„è¿™äº›æ¨¡å¼éå¸¸è„†å¼±ï¼Œé€šå¸¸ä¼šå¯¼è‡´æ— æ³•ç»´æŠ¤çš„ä»£ç ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸æŠŠç»„ä»¶çš„å…±äº«çŠ¶æ€æŠ½å–å‡ºæ¥ï¼Œä»¥ä¸€ä¸ªå…¨å±€å•ä¾‹æ¨¡å¼ç®¡ç†å‘¢ï¼Ÿåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬çš„ç»„ä»¶æ ‘æ„æˆäº†ä¸€ä¸ªå·¨å¤§çš„â€œè§†å›¾â€ï¼Œä¸ç®¡åœ¨æ ‘çš„å“ªä¸ªä½ç½®ï¼Œä»»ä½•ç»„ä»¶éƒ½èƒ½è·å–çŠ¶æ€æˆ–è€…è§¦å‘è¡Œä¸ºï¼</p>
<p>é€šè¿‡å®šä¹‰å’Œéš”ç¦»çŠ¶æ€ç®¡ç†ä¸­çš„å„ç§æ¦‚å¿µå¹¶é€šè¿‡å¼ºåˆ¶è§„åˆ™ç»´æŒè§†å›¾å’ŒçŠ¶æ€é—´çš„ç‹¬ç«‹æ€§ï¼Œæˆ‘ä»¬çš„ä»£ç å°†ä¼šå˜å¾—æ›´ç»“æ„åŒ–ä¸”æ˜“ç»´æŠ¤ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210510101835431.png" alt="image-20210510101835431"></p>
<ul>
<li>å®‰è£…VueX</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install vuex --save</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨ä¸€ä¸ªæ¨¡å—åŒ–çš„æ‰“åŒ…ç³»ç»Ÿä¸­ï¼Œæ‚¨å¿…é¡»æ˜¾å¼åœ°é€šè¿‡ <code>Vue.use()</code> æ¥å®‰è£… Vuexï¼š</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br></pre></td></tr></table></figure>

<ul>
<li>æ¯ä¸€ä¸ª Vuex åº”ç”¨çš„æ ¸å¿ƒå°±æ˜¯ storeï¼ˆä»“åº“ï¼‰ã€‚â€œstoreâ€åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„**çŠ¶æ€ (state)**ã€‚Vuex å’Œå•çº¯çš„å…¨å±€å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒï¼š</li>
</ul>
<ol>
<li>Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ã€‚å½“ Vue ç»„ä»¶ä» store ä¸­è¯»å–çŠ¶æ€çš„æ—¶å€™ï¼Œè‹¥ store ä¸­çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç›¸åº”çš„ç»„ä»¶ä¹Ÿä¼šç›¸åº”åœ°å¾—åˆ°é«˜æ•ˆæ›´æ–°ã€‚</li>
<li>ä½ ä¸èƒ½ç›´æ¥æ”¹å˜ store ä¸­çš„çŠ¶æ€ã€‚æ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°<strong>æäº¤ (commit) mutation</strong>ã€‚è¿™æ ·ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°è·Ÿè¸ªæ¯ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ–ï¼Œä»è€Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®ç°ä¸€äº›å·¥å…·å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°äº†è§£æˆ‘ä»¬çš„åº”ç”¨ã€‚</li>
</ol>
<p>æ¥åˆ›å»ºä¸€ä¸ª storeã€‚åˆ›å»ºè¿‡ç¨‹ç›´æˆªäº†å½“â€”â€”ä»…éœ€è¦æä¾›ä¸€ä¸ªåˆå§‹ state å¯¹è±¡å’Œä¸€äº› mutationï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥é€šè¿‡ <code>store.state</code> æ¥è·å–çŠ¶æ€å¯¹è±¡ï¼Œä»¥åŠé€šè¿‡ <code>store.commit</code> æ–¹æ³•è§¦å‘çŠ¶æ€å˜æ›´</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.commit(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(store.state.count) <span class="comment">// -&gt; 1</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†åœ¨ Vue ç»„ä»¶ä¸­è®¿é—® <code>this.$store</code> propertyï¼Œä½ éœ€è¦ä¸º Vue å®ä¾‹æä¾›åˆ›å»ºå¥½çš„ storeã€‚Vuex æä¾›äº†ä¸€ä¸ªä»æ ¹ç»„ä»¶å‘æ‰€æœ‰å­ç»„ä»¶ï¼Œä»¥ <code>store</code> é€‰é¡¹çš„æ–¹å¼â€œæ³¨å…¥â€è¯¥ store çš„æœºåˆ¶ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  store: store,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>ES6ç®€å†™</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥ä»ç»„ä»¶çš„æ–¹æ³•æäº¤ä¸€ä¸ªå˜æ›´ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="function"><span class="title">increment</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.$store.state.count)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬é€šè¿‡æäº¤ mutation çš„æ–¹å¼ï¼Œè€Œéç›´æ¥æ”¹å˜ <code>store.state.count</code>ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦æ›´æ˜ç¡®åœ°è¿½è¸ªåˆ°çŠ¶æ€çš„å˜åŒ–ã€‚è¿™ä¸ªç®€å•çš„çº¦å®šèƒ½å¤Ÿè®©ä½ çš„æ„å›¾æ›´åŠ æ˜æ˜¾ï¼Œè¿™æ ·ä½ åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™èƒ½æ›´å®¹æ˜“åœ°è§£è¯»åº”ç”¨å†…éƒ¨çš„çŠ¶æ€æ”¹å˜ã€‚</p>
<h2 id="12-2-VueXæ ¸å¿ƒæ¦‚å¿µ"><a href="#12-2-VueXæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="12.2 VueXæ ¸å¿ƒæ¦‚å¿µ"></a>12.2 VueXæ ¸å¿ƒæ¦‚å¿µ</h2><h3 id="12-2-1-State"><a href="#12-2-1-State" class="headerlink" title="12.2.1 State"></a>12.2.1 State</h3><p>Vuex ä½¿ç”¨<strong>å•ä¸€çŠ¶æ€æ ‘</strong>â€”â€”æ˜¯çš„ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡å°±åŒ…å«äº†å…¨éƒ¨çš„åº”ç”¨å±‚çº§çŠ¶æ€ã€‚è‡³æ­¤å®ƒä¾¿ä½œä¸ºä¸€ä¸ªâ€œå”¯ä¸€æ•°æ®æº (<a href="https://en.wikipedia.org/wiki/Single_source_of_truth">SSOT (opens new window)</a>)â€è€Œå­˜åœ¨ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œæ¯ä¸ªåº”ç”¨å°†ä»…ä»…åŒ…å«ä¸€ä¸ª store å®ä¾‹ã€‚å•ä¸€çŠ¶æ€æ ‘è®©æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥åœ°å®šä½ä»»ä¸€ç‰¹å®šçš„çŠ¶æ€ç‰‡æ®µï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ä¹Ÿèƒ½è½»æ˜“åœ°å–å¾—æ•´ä¸ªå½“å‰åº”ç”¨çŠ¶æ€çš„å¿«ç…§ã€‚</p>
<p><strong>å­˜å‚¨åœ¨ Vuex ä¸­çš„æ•°æ®å’Œ Vue å®ä¾‹ä¸­çš„ <code>data</code> éµå¾ªç›¸åŒçš„è§„åˆ™ï¼Œä¾‹å¦‚çŠ¶æ€å¯¹è±¡å¿…é¡»æ˜¯çº¯ç²¹ (plain) çš„</strong></p>
<p><strong>åœ¨ Vue ç»„ä»¶ä¸­è·å¾— Vuex çŠ¶æ€</strong></p>
<p>ç”±äº Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ï¼Œä» store å®ä¾‹ä¸­è¯»å–çŠ¶æ€æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åœ¨<a href="https://cn.vuejs.org/guide/computed.html">è®¡ç®—å±æ€§</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ª Counter ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> Counter = &#123;</span><br><span class="line">  template: <span class="string">`&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`</span>,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    count () &#123;</span><br><span class="line">      <span class="keyword">return</span> store.state.count</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¯å½“ <code>store.state.count</code> å˜åŒ–çš„æ—¶å€™, éƒ½ä¼šé‡æ–°æ±‚å–è®¡ç®—å±æ€§ï¼Œå¹¶ä¸”è§¦å‘æ›´æ–°ç›¸å…³è”çš„ DOMã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ç§æ¨¡å¼å¯¼è‡´ç»„ä»¶ä¾èµ–å…¨å±€çŠ¶æ€å•ä¾‹ã€‚åœ¨æ¨¡å—åŒ–çš„æ„å»ºç³»ç»Ÿä¸­ï¼Œåœ¨æ¯ä¸ªéœ€è¦ä½¿ç”¨ state çš„ç»„ä»¶ä¸­éœ€è¦é¢‘ç¹åœ°å¯¼å…¥ï¼Œå¹¶ä¸”åœ¨æµ‹è¯•ç»„ä»¶æ—¶éœ€è¦æ¨¡æ‹ŸçŠ¶æ€ã€‚</p>
<p>Vuex é€šè¿‡ <code>store</code> é€‰é¡¹ï¼Œæä¾›äº†ä¸€ç§æœºåˆ¶å°†çŠ¶æ€ä»æ ¹ç»„ä»¶â€œæ³¨å…¥â€åˆ°æ¯ä¸€ä¸ªå­ç»„ä»¶ä¸­ï¼ˆéœ€è°ƒç”¨ <code>Vue.use(Vuex)</code>ï¼‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  <span class="comment">// æŠŠ store å¯¹è±¡æä¾›ç»™ â€œstoreâ€ é€‰é¡¹ï¼Œè¿™å¯ä»¥æŠŠ store çš„å®ä¾‹æ³¨å…¥æ‰€æœ‰çš„å­ç»„ä»¶</span></span><br><span class="line">  store,</span><br><span class="line">  components: &#123; Counter &#125;,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;app&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;counter&gt;&lt;/counter&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡åœ¨æ ¹å®ä¾‹ä¸­æ³¨å†Œ <code>store</code> é€‰é¡¹ï¼Œè¯¥ store å®ä¾‹ä¼šæ³¨å…¥åˆ°æ ¹ç»„ä»¶ä¸‹çš„æ‰€æœ‰å­ç»„ä»¶ä¸­ï¼Œä¸”å­ç»„ä»¶èƒ½é€šè¿‡ <code>this.$store</code> è®¿é—®åˆ°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Counter = &#123;</span><br><span class="line">  template: <span class="string">`&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`</span>,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    count () &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.$store.state.count</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapState è¾…åŠ©å‡½æ•°</strong></p>
<p>å½“ä¸€ä¸ªç»„ä»¶éœ€è¦è·å–å¤šä¸ªçŠ¶æ€çš„æ—¶å€™ï¼Œå°†è¿™äº›çŠ¶æ€éƒ½å£°æ˜ä¸ºè®¡ç®—å±æ€§ä¼šæœ‰äº›é‡å¤å’Œå†—ä½™ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>mapState</code> è¾…åŠ©å‡½æ•°å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆè®¡ç®—å±æ€§ï¼Œè®©ä½ å°‘æŒ‰å‡ æ¬¡é”®ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åœ¨å•ç‹¬æ„å»ºçš„ç‰ˆæœ¬ä¸­è¾…åŠ©å‡½æ•°ä¸º Vuex.mapState</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  computed: mapState(&#123;</span><br><span class="line">    <span class="comment">// ç®­å¤´å‡½æ•°å¯ä½¿ä»£ç æ›´ç®€ç»ƒ</span></span><br><span class="line">    count: <span class="function"><span class="params">state</span> =&gt;</span> state.count,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼ å­—ç¬¦ä¸²å‚æ•° &#x27;count&#x27; ç­‰åŒäº `state =&gt; state.count`</span></span><br><span class="line">    countAlias: <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ `this` è·å–å±€éƒ¨çŠ¶æ€ï¼Œå¿…é¡»ä½¿ç”¨å¸¸è§„å‡½æ•°</span></span><br><span class="line">    countPlusLocalState (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count + <span class="built_in">this</span>.localCount</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æ˜ å°„çš„è®¡ç®—å±æ€§çš„åç§°ä¸ state çš„å­èŠ‚ç‚¹åç§°ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ <code>mapState</code> ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">computed: mapState([</span><br><span class="line">  <span class="comment">// æ˜ å°„ this.count ä¸º store.state.count</span></span><br><span class="line">  <span class="string">&#x27;count&#x27;</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>



<h3 id="12-2-2-Getters"><a href="#12-2-2-Getters" class="headerlink" title="12.2.2 Getters"></a>12.2.2 Getters</h3><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä»storeä¸­è·å–ä¸€äº›stateå˜å¼‚åçš„çŠ¶æ€ï¼Œæ¯”å¦‚ä¸‹é¢çš„Storeä¸­ï¼š</p>
<p>è·å–å­¦ç”Ÿå¹´é¾„å¤§äº20çš„ä¸ªæ•°</p>
<p><img src="C:\Users\dell\Desktop\Notes\Vue\img\image-20210510105113712.png" alt="image-20210510105113712"></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨Storeä¸­å®šä¹‰getters</p>
<p><img src="C:\Users\dell\Desktop\Notes\Vue\img\image-20210510105136807.png" alt="image-20210510105136807"></p>
<p><img src="C:\Users\dell\Desktop\Notes\Vue\img\image-20210510105144014.png" alt="image-20210510105144014"></p>
<p>å¦‚æœæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªè·å–æ‰€æœ‰å¹´é¾„å¤§äº20å²å­¦ç”Ÿåˆ—è¡¨çš„getters, é‚£ä¹ˆä»£ç å¯ä»¥è¿™æ ·æ¥å†™</p>
<p><img src="C:\Users\dell\Desktop\Notes\Vue\img\image-20210510105620419.png" alt="image-20210510105620419"></p>
<h3 id="12-2-3-Mutation"><a href="#12-2-3-Mutation" class="headerlink" title="12.2.3 Mutation"></a>12.2.3 Mutation</h3><p>æ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutationã€‚Vuex ä¸­çš„ mutation éå¸¸ç±»ä¼¼äºäº‹ä»¶ï¼šæ¯ä¸ª mutation éƒ½æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„ <strong>äº‹ä»¶ç±»å‹ (type)</strong> å’Œ ä¸€ä¸ª **å›è°ƒå‡½æ•° (handler)**ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°å°±æ˜¯æˆ‘ä»¬å®é™…è¿›è¡ŒçŠ¶æ€æ›´æ”¹çš„åœ°æ–¹ï¼Œå¹¶ä¸”å®ƒä¼šæ¥å— state ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      <span class="comment">// å˜æ›´çŠ¶æ€</span></span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä½ ä¸èƒ½ç›´æ¥è°ƒç”¨ä¸€ä¸ª mutation handlerã€‚è¿™ä¸ªé€‰é¡¹æ›´åƒæ˜¯äº‹ä»¶æ³¨å†Œï¼šâ€œå½“è§¦å‘ä¸€ä¸ªç±»å‹ä¸º <code>increment</code> çš„ mutation æ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•°ã€‚â€è¦å”¤é†’ä¸€ä¸ª mutation handlerï¼Œä½ éœ€è¦ä»¥ç›¸åº”çš„ type è°ƒç”¨ <strong>store.commit</strong> æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.commit(<span class="string">&#x27;increment&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>æäº¤è½½è·ï¼ˆPayloadï¼‰</strong></p>
<p>ä½ å¯ä»¥å‘ <code>store.commit</code> ä¼ å…¥é¢å¤–çš„å‚æ•°ï¼Œå³ mutation çš„ <strong>è½½è·ï¼ˆpayloadï¼‰</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">mutations: &#123;</span><br><span class="line">  increment (state, n) &#123;</span><br><span class="line">    state.count += n</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.commit(<span class="string">&#x27;increment&#x27;</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè½½è·åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µå¹¶ä¸”è®°å½•çš„ mutation ä¼šæ›´æ˜“è¯»ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">mutations: &#123;</span><br><span class="line">  increment (state, payload) &#123;</span><br><span class="line">    state.count += payload.amount</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">store.commit(<span class="string">&#x27;increment&#x27;</span>, &#123;</span><br><span class="line">  amount: <span class="number">10</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹è±¡é£æ ¼çš„æäº¤æ–¹å¼</strong></p>
<p>æäº¤ mutation çš„å¦ä¸€ç§æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨åŒ…å« <code>type</code> å±æ€§çš„å¯¹è±¡ï¼šæäº¤ mutation çš„å¦ä¸€ç§æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨åŒ…å« type å±æ€§çš„å¯¹è±¡ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.commit(&#123;</span><br><span class="line">  type: <span class="string">&#x27;increment&#x27;</span>,</span><br><span class="line">  amount: <span class="number">10</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å½“ä½¿ç”¨å¯¹è±¡é£æ ¼çš„æäº¤æ–¹å¼ï¼Œæ•´ä¸ªå¯¹è±¡éƒ½ä½œä¸ºè½½è·ä¼ ç»™ mutation å‡½æ•°ï¼Œå› æ­¤ handler ä¿æŒä¸å˜ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">  increment (state, payload) &#123;</span><br><span class="line">    state.count += payload.amount</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Mutation éœ€éµå®ˆ Vue çš„å“åº”è§„åˆ™</strong></p>
<p>æ—¢ç„¶ Vuex çš„ store ä¸­çš„çŠ¶æ€æ˜¯å“åº”å¼çš„ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬å˜æ›´çŠ¶æ€æ—¶ï¼Œç›‘è§†çŠ¶æ€çš„ Vue ç»„ä»¶ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ã€‚è¿™ä¹Ÿæ„å‘³ç€ Vuex ä¸­çš„ mutation ä¹Ÿéœ€è¦ä¸ä½¿ç”¨ Vue ä¸€æ ·éµå®ˆä¸€äº›æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>æœ€å¥½æå‰åœ¨ä½ çš„ store ä¸­åˆå§‹åŒ–å¥½æ‰€æœ‰æ‰€éœ€å±æ€§ã€‚</li>
<li>å½“éœ€è¦åœ¨å¯¹è±¡ä¸Šæ·»åŠ æ–°å±æ€§æ—¶ï¼Œä½ åº”è¯¥</li>
</ol>
<ul>
<li><p>ä½¿ç”¨ <code>Vue.set(obj, &#39;newProp&#39;, 123)</code>, æˆ–è€…</p>
</li>
<li><p>ä»¥æ–°å¯¹è±¡æ›¿æ¢è€å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œåˆ©ç”¨<a href="https://github.com/tc39/proposal-object-rest-spread">å¯¹è±¡å±•å¼€è¿ç®—ç¬¦ (opens new window)</a>æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">state.obj = &#123; ...state.obj, <span class="attr">newProp</span>: <span class="number">123</span> &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>ä½¿ç”¨å¸¸é‡æ›¿ä»£ Mutation äº‹ä»¶ç±»å‹</strong><br>ä½¿ç”¨å¸¸é‡æ›¿ä»£ mutation äº‹ä»¶ç±»å‹åœ¨å„ç§ Flux å®ç°ä¸­æ˜¯å¾ˆå¸¸è§çš„æ¨¡å¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mutation-types.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SOME_MUTATION = <span class="string">&#x27;SOME_MUTATION&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; SOME_MUTATION &#125; <span class="keyword">from</span> <span class="string">&#x27;./mutation-types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    <span class="comment">// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ES2015 é£æ ¼çš„è®¡ç®—å±æ€§å‘½ååŠŸèƒ½æ¥ä½¿ç”¨ä¸€ä¸ªå¸¸é‡ä½œä¸ºå‡½æ•°å</span></span><br><span class="line">    [SOME_MUTATION] (state) &#123;</span><br><span class="line">      <span class="comment">// mutate state</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä¾‹å­</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210510111422775.png" alt="image-20210510111422775"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210510111432070.png" alt="image-20210510111432070"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Vue%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210510111438694.png" alt="image-20210510111438694"></p>
<p><strong>MutationåŒæ­¥å‡½æ•°</strong></p>
<p>é€šå¸¸æƒ…å†µä¸‹, Vuexè¦æ±‚æˆ‘ä»¬Mutationä¸­çš„æ–¹æ³•å¿…é¡»æ˜¯åŒæ­¥æ–¹æ³•.</p>
<ul>
<li>ä¸»è¦çš„åŸå› æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨devtoolsæ—¶, å¯ä»¥devtoolså¯ä»¥å¸®åŠ©æˆ‘ä»¬æ•æ‰mutationçš„å¿«ç…§.</li>
<li>ä½†æ˜¯å¦‚æœæ˜¯å¼‚æ­¥æ“ä½œ, é‚£ä¹ˆdevtoolså°†ä¸èƒ½å¾ˆå¥½çš„è¿½è¸ªè¿™ä¸ªæ“ä½œä»€ä¹ˆæ—¶å€™ä¼šè¢«å®Œæˆ</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">  someMutation (state) &#123;</span><br><span class="line">    api.callAsyncMethod(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨æƒ³è±¡ï¼Œæˆ‘ä»¬æ­£åœ¨ debug ä¸€ä¸ª app å¹¶ä¸”è§‚å¯Ÿ devtool ä¸­çš„ mutation æ—¥å¿—ã€‚æ¯ä¸€æ¡ mutation è¢«è®°å½•ï¼Œdevtools éƒ½éœ€è¦æ•æ‰åˆ°å‰ä¸€çŠ¶æ€å’Œåä¸€çŠ¶æ€çš„å¿«ç…§ã€‚ç„¶è€Œï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ mutation ä¸­çš„å¼‚æ­¥å‡½æ•°ä¸­çš„å›è°ƒè®©è¿™ä¸å¯èƒ½å®Œæˆï¼šå› ä¸ºå½“ mutation è§¦å‘çš„æ—¶å€™ï¼Œå›è°ƒå‡½æ•°è¿˜æ²¡æœ‰è¢«è°ƒç”¨ï¼Œdevtools ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å›è°ƒå‡½æ•°å®é™…ä¸Šè¢«è°ƒç”¨â€”â€”å®è´¨ä¸Šä»»ä½•åœ¨å›è°ƒå‡½æ•°ä¸­è¿›è¡Œçš„çŠ¶æ€çš„æ”¹å˜éƒ½æ˜¯ä¸å¯è¿½è¸ªçš„</p>
<p><strong>åœ¨ç»„ä»¶ä¸­æäº¤ Mutation</strong><br>ä½ å¯ä»¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ this.$store.commit(â€˜xxxâ€™) æäº¤ mutationï¼Œæˆ–è€…ä½¿ç”¨ mapMutations è¾…åŠ©å‡½æ•°å°†ç»„ä»¶ä¸­çš„ methods æ˜ å°„ä¸º store.commit è°ƒç”¨ï¼ˆéœ€è¦åœ¨æ ¹èŠ‚ç‚¹æ³¨å…¥ storeï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    ...mapMutations([</span><br><span class="line">      <span class="string">&#x27;increment&#x27;</span>, <span class="comment">// å°† `this.increment()` æ˜ å°„ä¸º `this.$store.commit(&#x27;increment&#x27;)`</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// `mapMutations` ä¹Ÿæ”¯æŒè½½è·ï¼š</span></span><br><span class="line">      <span class="string">&#x27;incrementBy&#x27;</span> <span class="comment">// å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.commit(&#x27;incrementBy&#x27;, amount)`</span></span><br><span class="line">    ]),</span><br><span class="line">    ...mapMutations(&#123;</span><br><span class="line">      add: <span class="string">&#x27;increment&#x27;</span> <span class="comment">// å°† `this.add()` æ˜ å°„ä¸º `this.$store.commit(&#x27;increment&#x27;)`</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="12-2-4-Actions"><a href="#12-2-4-Actions" class="headerlink" title="12.2.4 Actions"></a>12.2.4 Actions</h3><p>Action ç±»ä¼¼äº mutationï¼Œä¸åŒåœ¨äºï¼š</p>
<ul>
<li>Action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚</li>
<li>Action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚</li>
</ul>
<p><strong>æ¥æ³¨å†Œä¸€ä¸ªç®€å•çš„ actionï¼š</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment (context) &#123;</span><br><span class="line">      context.commit(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>contextæ˜¯ä»€ä¹ˆ?</strong></p>
<ul>
<li>contextæ˜¯å’Œstoreå¯¹è±¡å…·æœ‰ç›¸åŒæ–¹æ³•å’Œå±æ€§çš„å¯¹è±¡.</li>
<li>ä¹Ÿå°±æ˜¯è¯´, æˆ‘ä»¬å¯ä»¥é€šè¿‡contextå»è¿›è¡Œcommitç›¸å…³çš„æ“ä½œ, ä¹Ÿå¯ä»¥è·å–context.state</li>
</ul>
<p><strong>åˆ†å‘ Action</strong><br>Action é€šè¿‡ store.dispatch æ–¹æ³•è§¦å‘ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.dispatch(<span class="string">&#x27;increment&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>mutation å¿…é¡»åŒæ­¥æ‰§è¡Œ</strong>è¿™ä¸ªé™åˆ¶ Action å°±ä¸å—çº¦æŸï¼æˆ‘ä»¬å¯ä»¥åœ¨ action å†…éƒ¨æ‰§è¡Œ<strong>å¼‚æ­¥</strong>æ“ä½œï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">  incrementAsync (&#123; commit &#125;) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      commit(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Actions æ”¯æŒåŒæ ·çš„è½½è·æ–¹å¼å’Œå¯¹è±¡æ–¹å¼è¿›è¡Œåˆ†å‘ï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä»¥è½½è·å½¢å¼åˆ†å‘</span></span><br><span class="line">store.dispatch(<span class="string">&#x27;incrementAsync&#x27;</span>, &#123;</span><br><span class="line">  amount: <span class="number">10</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥å¯¹è±¡å½¢å¼åˆ†å‘</span></span><br><span class="line">store.dispatch(&#123;</span><br><span class="line">  type: <span class="string">&#x27;incrementAsync&#x27;</span>,</span><br><span class="line">  amount: <span class="number">10</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="12-2-5-Modules"><a href="#12-2-5-Modules" class="headerlink" title="12.2.5 Modules"></a>12.2.5 Modules</h3><p>ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚</p>
<p>ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆ<strong>æ¨¡å—ï¼ˆmoduleï¼‰</strong>ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getterã€ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—â€”â€”ä»ä¸Šè‡³ä¸‹è¿›è¡ŒåŒæ ·æ–¹å¼çš„åˆ†å‰²ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;,</span><br><span class="line">  getters: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    a: moduleA,</span><br><span class="line">    b: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">store.state.a <span class="comment">// -&gt; moduleA çš„çŠ¶æ€</span></span><br><span class="line">store.state.b <span class="comment">// -&gt; moduleB çš„çŠ¶æ€</span></span><br></pre></td></tr></table></figure>

<p><strong>æ¨¡å—çš„å±€éƒ¨çŠ¶æ€</strong><br>å¯¹äºæ¨¡å—å†…éƒ¨çš„ mutation å’Œ getterï¼Œæ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€å¯¹è±¡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;),</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      <span class="comment">// è¿™é‡Œçš„ `state` å¯¹è±¡æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€</span></span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  getters: &#123;</span><br><span class="line">    doubleCount (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count * <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·ï¼Œå¯¹äºæ¨¡å—å†…éƒ¨çš„ actionï¼Œå±€éƒ¨çŠ¶æ€é€šè¿‡ <code>context.state</code> æš´éœ²å‡ºæ¥ï¼Œæ ¹èŠ‚ç‚¹çŠ¶æ€åˆ™ä¸º <code>context.rootState</code>ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  actions: &#123;</span><br><span class="line">    incrementIfOddOnRootSum (&#123; state, commit, rootState &#125;) &#123;</span><br><span class="line">      <span class="keyword">if</span> ((state.count + rootState.count) % <span class="number">2</span> === <span class="number">1</span>) &#123;</span><br><span class="line">        commit(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹äºæ¨¡å—å†…éƒ¨çš„ getterï¼Œæ ¹èŠ‚ç‚¹çŠ¶æ€ä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°æš´éœ²å‡ºæ¥ï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  getters: &#123;</span><br><span class="line">    sumWithRootCount (state, getters, rootState) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count + rootState.count</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="13ï¼ŒAxios"><a href="#13ï¼ŒAxios" class="headerlink" title="13ï¼ŒAxios"></a>13ï¼ŒAxios</h1><p>åç»­è¡¥å……â€¦</p>
<h1 id="14ï¼Œé¡¹ç›®å®æˆ˜"><a href="#14ï¼Œé¡¹ç›®å®æˆ˜" class="headerlink" title="14ï¼Œé¡¹ç›®å®æˆ˜"></a>14ï¼Œé¡¹ç›®å®æˆ˜</h1><p><strong>æºç ï¼š<a href="https://gitee.com/zhuang-kang/vue-project">Vue-Project: Vueè´­ç‰©è½¦å®æˆ˜é¡¹ç›® (gitee.com)</a></strong></p>
<p><strong>å­¦ä¹ è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV15741177Eh?p=148">https://www.bilibili.com/video/BV15741177Eh?p=148</a></strong></p>
<h2 id="14-1-è€¦åˆ"><a href="#14-1-è€¦åˆ" class="headerlink" title="14.1 è€¦åˆ"></a>14.1 è€¦åˆ</h2><ul>
<li>è€¦åˆæ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªä½“ç³»æˆ–è¿åŠ¨å½¢å¼é—´é€šè¿‡ç›¸äº’ä½œç”¨è€Œå½¼æ­¤å½±å“ä»¥è‡³è”åˆèµ·æ¥çš„ç°è±¡ã€‚</li>
<li>å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦å°±æ˜¯å¯¹è±¡ä¹‹é—´çš„ä¾èµ–æ€§ã€‚å¯¹è±¡ä¹‹é—´çš„è€¦åˆè¶Šé«˜ï¼Œç»´æŠ¤æˆæœ¬è¶Šé«˜</li>
</ul>
<p><strong>è§£è€¦ï¼š</strong><br>é™ä½è€¦åˆåº¦ï¼Œè®©æ•°æ®æ¨¡å‹ã€ä¸šåŠ¡é€»è¾‘å’Œè§†å›¾æ˜¾ç¤ºä¸‰å±‚å…³ç³»é™ä½è€¦åˆï¼ŒæŠŠå…³è”ä¾èµ–é™åˆ°æœ€ä½ï¼Œä¸è‡³äºç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ã€‚</p>
<p>ä¾‹ï¼šå¦‚æœä¸¤è€…é—´éœ€è¦äº¤äº’ï¼Œå¯ä»¥é€šè¿‡æ¥å£ã€é€šè¿‡æ¶ˆæ¯ã€ç”šè‡³å¼•å…¥æ¡†æ¶ï¼Œå°±æ˜¯ä¸è¦ç›´æ¥äº¤å‰å†™ã€‚<br>è§‚å¯Ÿè€…æ¨¡å¼ï¼šè§£è€¦çš„æ¨¡å¼ï¼Œå®ƒä½¿è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…çš„é€»è¾‘ä¸å†æ…åœ¨ä¸€èµ·ï¼Œè€Œæ˜¯å½¼æ­¤ç‹¬ç«‹ã€äº’ä¸ä¾èµ–ã€‚ä¾‹ï¼šå½“ç”¨æˆ·åˆ‡æ¢ä¸ºå¤œé—´æ¨¡å¼æ—¶ï¼Œè¢«è§‚å¯Ÿè€…å°±ä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…â€˜è®¾ç½®æ”¹å˜ï¼Œå¤§å®¶å¿«è’™ä¸Šé®ç½©â€™</p>
<p>ä¾‹ï¼šå°è£…å¤šä¸ªæ•°æ®çš„è¯·æ±‚<br>ä»æœåŠ¡å™¨æ‹¿æ•°æ®ï¼Œå°±æ˜¯å¯¹ç½‘ç»œæ¨¡å—è¿›è¡Œå°è£…ï¼Œå†ä½¿ç”¨ç½‘ç»œæ¨¡å—è¿›è¡Œå¯¹æ•°æ®è¯·æ±‚<br>å°è£… request.js ç›´æ¥åœ¨ç›¸åº”çš„é¡µé¢åšç½‘ç»œè¯·æ±‚<br>å•ç‹¬å°è£…é¦–é¡µçš„ç½‘ç»œè¯·æ±‚è‡³ home.js æ–‡ä»¶ä¸­<br>å› ä¸ºé¦–é¡µå¯èƒ½æœ‰å¤šä¸ªè¯·æ±‚ï¼Œå°è£…åå¯å¯¹å…¶åšç»Ÿä¸€ç®¡ç†ï¼Œæ•°æ®è¯·æ±‚çš„urlå°±ä¸ä¼šä¸é¦–é¡µç»„ä»¶å†…å®¹è€¦åˆ<br>ä½¿å¾— home.vue é¢å‘ home.js å¼€å‘ï¼Œå¯é™ä½è€¦åˆåº¦</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;request&#125; <span class="keyword">from</span> <span class="string">&#x27;./request&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getHomeMultidata</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> request(&#123;</span><br><span class="line">        url: <span class="string">&#x27;/home/multidata&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getHomeGoods</span>(<span class="params">type, page</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">      url: <span class="string">&#x27;/home/data&#x27;</span>,</span><br><span class="line">      params: &#123;</span><br><span class="line">          type,</span><br><span class="line">          page</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="14-2-å‘é€ç½‘ç»œè¯·æ±‚"><a href="#14-2-å‘é€ç½‘ç»œè¯·æ±‚" class="headerlink" title="14.2 å‘é€ç½‘ç»œè¯·æ±‚"></a>14.2 å‘é€ç½‘ç»œè¯·æ±‚</h2><p>created<br>è¦åœ¨ç»„ä»¶åˆ›å»ºå¥½ä¹‹åã€é¡µé¢æ¸²æŸ“ä¹‹å‰å‘é€è¯·æ±‚è·å–æ•°æ®ï¼Œåœ¨ created ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­åšè¯·æ±‚<br>ä¿å­˜æ•°æ®<br>è·å–æ•°æ®åï¼Œå°†æ•°æ®ä¿å­˜åœ¨ data ä¸­ï¼Œå› ä¸ºå‡½æ•°é‡Œéƒ½æ˜¯å±€éƒ¨å˜é‡ï¼Œå‡½æ•°ä¸€æ—¦æ‰§è¡Œå®Œï¼Œå‡½æ•°é‡Œçš„å˜é‡å°±ä¼šè¢«å›æ”¶æ‰<br>å‡½æ•°è°ƒç”¨æ—¶ï¼Œæ˜¯å°†æ•°æ®å‹å…¥å‡½æ•°æ ˆé‡Œï¼Œå‡½æ•°æ ˆå°±å¯ä¿å­˜å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€æœ‰å˜é‡ã€‚å‡½æ•°è°ƒç”¨ç»“æŸï¼Œå°±ä¼šå°†æ•°æ®å¼¹å‡ºå‡½æ•°æ ˆï¼Œå³é‡Šæ”¾å‡½æ•°ä¸­çš„æ‰€æœ‰å˜é‡<br>ç®€åŒ– created ä¸­çš„ä»£ç <br>created é’©å­ä¸­åªå¤„ç†ä¸»è¦é€»è¾‘ï¼Œå°†å…·ä½“çš„æ–¹æ³•å®ç°æ”¾åˆ° methods ä¸­</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">created () &#123;</span><br><span class="line">    <span class="comment">// å°†createdé’©å­ä¸­çš„ä»£ç ç®€åŒ–ï¼Œå¤„ç†ä¸»è¦é€»è¾‘ï¼Œå…·ä½“çš„æ–¹æ³•å®ç°äº¤ç»™methods</span></span><br><span class="line">    <span class="comment">// 1.è¯·æ±‚å¤šä¸ªæ•°æ®</span></span><br><span class="line">    <span class="built_in">this</span>.getHomeMultidata()</span><br><span class="line">    <span class="comment">// 2.è¯·æ±‚å•†å“æ•°æ®</span></span><br><span class="line">    <span class="built_in">this</span>.getHomeGoods(<span class="string">&#x27;pop&#x27;</span>)</span><br><span class="line">    <span class="built_in">this</span>.getHomeGoods(<span class="string">&#x27;new&#x27;</span>)</span><br><span class="line">    <span class="built_in">this</span>.getHomeGoods(<span class="string">&#x27;sell&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="comment">// ç½‘ç»œè¯·æ±‚ç›¸å…³æ–¹æ³•</span></span><br><span class="line">    getHomeMultidata () &#123;</span><br><span class="line">      getHomeMultidata().then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//   console.log(res)</span></span><br><span class="line">    <span class="comment">// this.result = res</span></span><br><span class="line">    <span class="built_in">this</span>.banners = res.data.banner.list</span><br><span class="line">    <span class="built_in">this</span>.recommends = res.data.recommend.list</span><br><span class="line">    &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    getHomeGoods (type) &#123;</span><br><span class="line">      <span class="keyword">const</span> page = <span class="built_in">this</span>.goods[type].page + <span class="number">1</span></span><br><span class="line">      getHomeGoods(type, page).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.goods[type].list.push(...res.data.list)</span><br><span class="line">      <span class="built_in">this</span>.goods[type].page += <span class="number">1</span>  <span class="comment">/* æ›´æ–°dataä¸­çš„é¡µç  */</span></span><br><span class="line">      <span class="built_in">this</span>.$refs.scroll.finishPullUp() <span class="comment">// è°ƒç”¨æ–¹æ³•ï¼Œå¤šæ¬¡ä¸Šæ‹‰åŠ è½½æ›´å¤š</span></span><br><span class="line">    &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<h2 id="14-3-better-scroll"><a href="#14-3-better-scroll" class="headerlink" title="14.3 better-scroll"></a>14.3 better-scroll</h2><p>åœ¨ç›¸åº”çš„ç»„ä»¶ä¸­ä¸º scroll ç»„ä»¶è®¾ç½®å›ºå®šé«˜åº¦ï¼Œæ‰èƒ½æ»šåŠ¨</p>
<p>è®¡ç®—é«˜åº¦</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">çˆ¶å…ƒç´ ï¼š<span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">æ»šåŠ¨å…ƒç´ ï¼š</span><br><span class="line"><span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">98px</span>); </span><br><span class="line"> <span class="attribute">overflow</span>:hidden;</span><br></pre></td></tr></table></figure>

<p>å®šä½</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">44px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">49px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p><strong>probeType</strong></p>
<ul>
<li>probe ä¾¦æµ‹</li>
<li>probeType 0 ä¸ä¾¦æµ‹ï¼Œ 1 å»¶æ—¶ä¾¦æµ‹ï¼Œ 2 æ‰‹æŒ‡æ»šåŠ¨çš„è¿‡ç¨‹ä¸­æ‰ä¾¦æµ‹ï¼Œæ‰‹æŒ‡ç¦»å¼€åçš„æƒ¯æ€§æ»šåŠ¨ä¸ä¾¦æµ‹ï¼Œ3 ä¾¦æµ‹æ‰€æœ‰æ»šåŠ¨</li>
</ul>
<ol>
<li>scroll ç»„ä»¶ä¸­é…ç½®</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 2.ç›‘å¬æ»šåŠ¨çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.probeType===<span class="number">2</span> || <span class="built_in">this</span>.probeType===<span class="number">3</span>)&#123;</span><br><span class="line">          <span class="built_in">this</span>.scroll.on(<span class="string">&#x27;scroll&#x27;</span>, <span class="function"><span class="params">position</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// console.log(position)</span></span><br><span class="line">          <span class="built_in">this</span>.$emit(<span class="string">&#x27;scroll&#x27;</span>,position)</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ä½¿ç”¨ scroll çš„ç»„ä»¶ä¸­è®¾ç½®ï¼Œé€šè¿‡ <code>@scroll=&#39;contentScroll&#39;</code> ä¼ é€’äº‹ä»¶</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">contentScroll</span>(<span class="params">position</span>)</span> &#123;</span><br><span class="line">      <span class="comment">// console.log(position.y)</span></span><br><span class="line">        <span class="comment">// this.showTop = (-position.y) &gt; 1000  ç»å¯¹å€¼Math.abs</span></span><br><span class="line">        <span class="built_in">this</span>.showTop = <span class="built_in">Math</span>.abs(position.y) &gt; <span class="number">1000</span></span><br><span class="line">        <span class="comment">// 2.è®¾ç½®å¸é¡¶æ•ˆæœ</span></span><br><span class="line">        <span class="built_in">this</span>.isTabFixed = (-position.y) &gt; <span class="built_in">this</span>.tabOffsetTop</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>pullUpLoad</strong></p>
<p>ä¸Šæ‹‰åŠ è½½æ›´å¤š</p>
<ol>
<li>scroll ç»„ä»¶ä¸­é…ç½®</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">this</span>.pullUpLoad)&#123; <span class="comment">// pullUpLoadä¸ºtrueæ—¶ï¼Œåˆ°è¾¾åº•éƒ¨ï¼Œä¸ºfalseçš„ç»„ä»¶ä¸ç”¨ç›‘å¬æ­¤äº‹ä»¶ï¼Œæå‡æ•ˆç‡</span></span><br><span class="line">        <span class="built_in">this</span>.scroll.on(<span class="string">&#x27;pullingUp&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          <span class="comment">// console.log(&#x27;bottom&#x27;); åˆ°è¾¾åº•éƒ¨æ—¶æ‰è§¦å‘å‡½æ•°</span></span><br><span class="line">          <span class="built_in">this</span>.$emit(<span class="string">&#x27;pullingUp&#x27;</span>)</span><br><span class="line">      &#125;)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ä½¿ç”¨ scroll çš„ç»„ä»¶ä¸­è®¾ç½®</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">getHomeGoods (type) &#123;</span><br><span class="line">      <span class="keyword">const</span> page = <span class="built_in">this</span>.goods[type].page + <span class="number">1</span></span><br><span class="line">      getHomeGoods(type, page).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.goods[type].list.push(...res.data.list)</span><br><span class="line">      <span class="built_in">this</span>.goods[type].page += <span class="number">1</span>  <span class="comment">/* æ›´æ–°dataä¸­çš„é¡µç  */</span></span><br><span class="line">      <span class="built_in">this</span>.$refs.scroll.finishPullUp() <span class="comment">// è°ƒç”¨æ–¹æ³•ï¼Œå¤šæ¬¡ä¸Šæ‹‰åŠ è½½æ›´å¤š</span></span><br><span class="line">    &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨æ›´æ–°å®Œç¬¬ä¸€é¡µçš„æ•°æ®åï¼Œæ»šåŠ¨åˆ°åº•éƒ¨æ—¶è§¦å‘ä¸Šæ‹‰åŠ è½½æ›´å¤šçš„æ–¹æ³•ï¼Œè¿™ä¸ªæ•°æ®è¯·æ±‚è¦åœ¨åˆå§‹åŒ–æ•°æ®æ–¹æ³•çš„åé¢æ‰§è¡Œ</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">activated () &#123;</span><br><span class="line">    <span class="comment">// è¿›å…¥æ—¶æ»šåŠ¨åˆ°ç¦»å¼€æ—¶çš„ä½ç½®this.saveY</span></span><br><span class="line">    <span class="built_in">this</span>.$refs.scroll.scrollTo(<span class="number">0</span>, <span class="built_in">this</span>.saveY, <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">this</span>.$refs.scroll.refresh() <span class="comment">// è¿›å…¥æ—¶å†åˆ·æ–°ï¼Œé¿å…å‡ºç°å°é—®é¢˜</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



<h2 id="14-4-å¯æ»šåŠ¨åŒºåŸŸbug"><a href="#14-4-å¯æ»šåŠ¨åŒºåŸŸbug" class="headerlink" title="14.4 å¯æ»šåŠ¨åŒºåŸŸbug"></a>14.4 å¯æ»šåŠ¨åŒºåŸŸbug</h2><p>better-scroll æ˜¯æ ¹æ® scrollerHeight å±æ€§å†³å®šæœ‰å¤šå°‘åŒºåŸŸå¯æ»šåŠ¨çš„ï¼Œè€Œ scrollerHeight å±æ€§å€¼æ˜¯æ ¹æ®contentä¸­å…ƒç´ çš„é«˜åº¦å†³å®šçš„<br>é‡åˆ°æ•°æ®è¯·æ±‚æ˜¯å¼‚æ­¥åŠ è½½æ—¶ï¼Œæ¯”å¦‚åŠ è½½å¼‚æ­¥åŠ è½½å›¾ç‰‡æ—¶ï¼Œåˆšå¼€å§‹çš„ scrollerHeight å¯èƒ½æ²¡æœ‰è®¡ç®—åˆ°å›¾ç‰‡ï¼Œå½“å›¾ç‰‡åŠ è½½å®Œæˆåï¼ŒscrollerHeight å€¼æ˜æ˜¾å°äºæƒ³è¦çš„å€¼ï¼Œæ‰€ä»¥æ»šåŠ¨ä¼šå‡ºç°é—®é¢˜</p>
<p>ç›‘å¬æ¯ä¸€å¼ å›¾ç‰‡æ˜¯å¦åŠ è½½å®Œæˆï¼Œæ¯ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆï¼Œéƒ½æ‰§è¡Œä¸€æ¬¡refresh<br>å¯åˆ©ç”¨ vuex çŠ¶æ€ç®¡ç†å™¨ï¼Œåœ¨ vuex é‡Œè®¾ç½®ä¸€ä¸ªå±æ€§ï¼Œå½“itemé‡Œå›¾ç‰‡åŠ è½½å®Œæˆååˆ‡æ¢çŠ¶æ€ï¼Œå½“åˆ‡æ¢çŠ¶æ€åï¼Œåœ¨homeç»„ä»¶ä¸­åˆ·æ–°<br>åˆ©ç”¨äº‹ä»¶æ€»çº¿ï¼ˆä¸“é—¨ç®¡ç†äº‹ä»¶çš„ï¼Œå¯ç”¨äºéçˆ¶å­ç»„ä»¶é—´çš„é€šä¿¡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">main.js  Vue.prototype.$bus = <span class="keyword">new</span> Vue()</span><br><span class="line">itemç»„ä»¶  @load=<span class="string">&#x27;imageLoad&#x27;</span>  methods: <span class="function"><span class="title">imageLoad</span>(<span class="params"></span>)</span>&#123;<span class="built_in">this</span>.$bus.$emit(<span class="string">&#x27;load&#x27;</span>)&#125;</span><br><span class="line">homeç»„ä»¶  mounted () &#123;<span class="built_in">this</span>.$bus.$on(<span class="string">&#x27;load&#x27;</span>,<span class="function">()=&gt;</span>&#123;<span class="built_in">this</span>.$refs.scroll.refresh()&#125;)&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ©ç”¨é˜²æŠ–å‡½æ•° <code>debounce</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">mounted () &#123;</span><br><span class="line">    <span class="comment">// 1.ç›‘å¬itemä¸­å›¾ç‰‡åŠ è½½å®Œæˆï¼Œåˆ·æ–°é˜²æŠ–å‡½æ•°æ”¾åˆ°äº†utils.jsä¸­ï¼Œå·¥å…·åº“</span></span><br><span class="line">     <span class="keyword">const</span> refresh = debounce(<span class="built_in">this</span>.$refs.scroll.refresh,<span class="number">50</span>)</span><br><span class="line">      <span class="comment">// å¯¹ç›‘å¬çš„äº‹ä»¶è¿›è¡Œä¿å­˜ï¼Œæ–¹ä¾¿ç¦»å¼€homeç»„ä»¶æ—¶å–æ¶ˆæ­¤äº‹ä»¶ç›‘å¬</span></span><br><span class="line">       <span class="built_in">this</span>.itemImgListener = <span class="function">() =&gt;</span> &#123; refresh() &#125;</span><br><span class="line">       <span class="built_in">this</span>.$bus.$on(<span class="string">&#x27;itemImageLoad&#x27;</span>,<span class="function">() =&gt;</span> &#123;</span><br><span class="line">         <span class="built_in">this</span>.$refs.scroll.refresh()</span><br><span class="line">         refresh() <span class="comment">// æ­¤å¤„æ˜¯é—­åŒ…ï¼Œå±€éƒ¨å˜é‡ä¸ä¼šè¢«é”€æ¯</span></span><br><span class="line">     &#125;)</span><br><span class="line">       <span class="built_in">this</span>.$bus.$on(<span class="string">&#x27;itemImageLoad&#x27;</span>, <span class="built_in">this</span>.itemImgListener)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



<h2 id="14-5-tabControl"><a href="#14-5-tabControl" class="headerlink" title="14.5 tabControl"></a>14.5 tabControl</h2><p><strong>ç‚¹å‡»åˆ‡æ¢æ•°æ®</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    itemClick (index) &#123;</span><br><span class="line">      <span class="built_in">this</span>.currentIndex = index</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&#x27;tabClick&#x27;</span>,index) <span class="comment">/* å°†å­ç»„ä»¶æ•°æ®ä¼ é€’åˆ°çˆ¶ç»„ä»¶ */</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">tabClick (index) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (index) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">          <span class="built_in">this</span>.currentType = <span class="string">&#x27;pop&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">          <span class="built_in">this</span>.currentType = <span class="string">&#x27;new&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">          <span class="built_in">this</span>.currentType= <span class="string">&#x27;sell&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¸é¡¶æ•ˆæœ</strong></p>
<ol>
<li>è·å–åˆ° tabControl çš„ offsetTop ï¼ˆæ»šåŠ¨è¿™ä¸ªè·ç¦»åå³å¸é¡¶ï¼‰</li>
<li>åˆ©ç”¨ $el è·å–ç»„ä»¶ä¸­çš„å…ƒç´ ï¼Œå›¾ç‰‡åŠ è½½å®Œæˆå offsetTop å€¼æ‰æ­£ç¡®</li>
<li>ç›‘å¬è½®æ’­å›¾å›¾ç‰‡åŠ è½½å®Œæˆ</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">swiperImageLoad () &#123;</span><br><span class="line">      <span class="comment">// è·å–tabOffsetTopçš„offsetTop</span></span><br><span class="line">    <span class="built_in">this</span>.tabOffsetTop = <span class="built_in">this</span>.$refs.tabControl2.$el.offsetTop</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">contentScroll</span>(<span class="params">position</span>)</span> &#123;</span><br><span class="line">      <span class="comment">// console.log(position.y)</span></span><br><span class="line">        <span class="comment">// this.showTop = (-position.y) &gt; 1000  ç»å¯¹å€¼Math.abs</span></span><br><span class="line">        <span class="built_in">this</span>.showTop = <span class="built_in">Math</span>.abs(position.y) &gt; <span class="number">1000</span></span><br><span class="line">        <span class="comment">// 2.è®¾ç½®å¸é¡¶æ•ˆæœ</span></span><br><span class="line">        <span class="built_in">this</span>.isTabFixed = (-position.y) &gt; <span class="built_in">this</span>.tabOffsetTop</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¤ä¸ª tabControl è§£å†³é—ªé€€</strong></p>
<p>åˆ†åˆ«è®¾ç½® ref=â€œtabControl1â€ å’Œ2ï¼Œå†æ‹¿åˆ° this.$refs.tabControl1.currentIndex<br>å†åœ¨ç‚¹å‡»æ—¶å°†å…¶ç­‰äºindexï¼Œå°±å¯å…³è”ä¸¤ä¸ª tabControl çš„ç‚¹å‡»</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">tabClick (index) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (index) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">          <span class="built_in">this</span>.currentType = <span class="string">&#x27;pop&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">          <span class="built_in">this</span>.currentType = <span class="string">&#x27;new&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">          <span class="built_in">this</span>.currentType= <span class="string">&#x27;sell&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">this</span>.$refs.tabControl1.currentIndex = index</span><br><span class="line">      <span class="built_in">this</span>.$refs.tabControl2.currentIndex = index</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="14-6-ä¿ç•™homeç»„ä»¶ç¦»å¼€æ—¶çš„çŠ¶æ€å’Œä½ç½®"><a href="#14-6-ä¿ç•™homeç»„ä»¶ç¦»å¼€æ—¶çš„çŠ¶æ€å’Œä½ç½®" class="headerlink" title="14.6 ä¿ç•™homeç»„ä»¶ç¦»å¼€æ—¶çš„çŠ¶æ€å’Œä½ç½®"></a>14.6 ä¿ç•™homeç»„ä»¶ç¦»å¼€æ—¶çš„çŠ¶æ€å’Œä½ç½®</h2><p>è·¯ç”±ç»„ä»¶ä¼šè‡ªåŠ¨ destroyedï¼Œè¦ç”¨ keep-alive ,è®©ç»„ä»¶ä¸è‡ªåŠ¨é”€æ¯<br>ç¦»å¼€homeç»„ä»¶æ—¶ï¼Œä¿å­˜ä¸€ä¸ªä½ç½®ä¿¡æ¯ saveYï¼Œå†è¿›æ¥æ—¶ï¼Œå°†ä½ç½®è®¾ç½®ä¸ºåŸæ¥ä¿å­˜çš„ä½ç½®ä¿¡æ¯å³å¯<br>åˆ©ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•° activated(){} å’Œå‡½æ•° deactivated(){}</p>
<ul>
<li>è¿›å…¥æ˜¯è§¦å‘ activated()ï¼Œé€€å‡ºæ—¶è§¦å‘ deactivated()</li>
<li>é¡µé¢ç¬¬ä¸€æ¬¡è¿›å…¥ï¼Œé’©å­çš„å‡ºå‘é¡ºåºæ˜¯ created -&gt; mounted -&gt; activatedï¼Œé€€å‡ºæ—¶è§¦å‘deactivated</li>
<li>å½“å†æ¬¡è¿›å…¥æ—¶ï¼Œåªè§¦å‘ activated</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">activated () &#123;</span><br><span class="line">    <span class="comment">// è¿›å…¥æ—¶æ»šåŠ¨åˆ°ç¦»å¼€æ—¶çš„ä½ç½®this.saveY</span></span><br><span class="line">    <span class="built_in">this</span>.$refs.scroll.scrollTo(<span class="number">0</span>, <span class="built_in">this</span>.saveY, <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">this</span>.$refs.scroll.refresh() <span class="comment">// è¿›å…¥æ—¶å†åˆ·æ–°ï¼Œé¿å…å‡ºç°å°é—®é¢˜</span></span><br><span class="line">  &#125;,</span><br><span class="line">  deactivated () &#123;</span><br><span class="line">    <span class="comment">// ä¿å­˜ç¦»å¼€æ—¶çš„ä½ç½®ä¿¡æ¯åˆ°this.saveY</span></span><br><span class="line">    <span class="built_in">this</span>.saveY = <span class="built_in">this</span>.$refs.scroll.getScrollY()</span><br><span class="line">    <span class="comment">// console.log(this.saveY);</span></span><br><span class="line">    <span class="comment">// 2.å–æ¶ˆå…¨å±€äº‹ä»¶ç›‘å¬ï¼ˆä¸»é¡µå›¾ç‰‡åŠ è½½çš„ç›‘å¬ï¼‰å› ä¸ºæ­¤æ—¶è®¾ç½®äº†keep-aliveï¼Œæ‰€ä»¥ç¦»å¼€æ—¶è°ƒç”¨çš„æ˜¯deactivated()</span></span><br><span class="line">    <span class="built_in">this</span>.$bus.$off(<span class="string">&#x27;itemImageLoad&#x27;</span>,<span class="built_in">this</span>.itemImgListener)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



<h2 id="14-7-homeç»„ä»¶è·³è½¬è‡³è¯¦æƒ…é¡µ"><a href="#14-7-homeç»„ä»¶è·³è½¬è‡³è¯¦æƒ…é¡µ" class="headerlink" title="14.7 homeç»„ä»¶è·³è½¬è‡³è¯¦æƒ…é¡µ"></a>14.7 homeç»„ä»¶è·³è½¬è‡³è¯¦æƒ…é¡µ</h2><ol>
<li>æ˜¯ GoodsListItem ä¸­çš„ç‚¹å‡»å¯¼è‡´è·³è½¬åˆ°è¯¦æƒ…é¡µï¼Œè¯¦æƒ…é¡µä¸ºè·¯ç”±ç»„ä»¶</li>
<li>è·³è½¬è¯¦æƒ…é¡µæ—¶ï¼Œè¦å°† itemçš„ id æºå¸¦è¿‡å»ï¼Œæ‰èƒ½æ ¹æ® id è¯·æ±‚ç›¸åº”çš„æ•°æ®</li>
<li>åŠ¨æ€ç»‘å®šidï¼Œ<code>pathï¼š&#39;/detail/:id&#39;</code></li>
<li>å†åœ¨ item ç»„ä»¶ä¸­è®¾ç½®ç‚¹å‡»äº‹ä»¶ï¼Œæ”¹å˜è·¯å¾„ï¼š</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">itemClick () &#123;</span><br><span class="line">      <span class="built_in">this</span>.$router.push(<span class="string">&#x27;/detail/&#x27;</span>+<span class="built_in">this</span>.goodsItem.iid)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>åœ¨ detail ç»„ä»¶ä¸­å¾—åˆ° id</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">created () &#123;</span><br><span class="line">   <span class="comment">// 1.ä¿å­˜ä¼ å…¥çš„id</span></span><br><span class="line">   <span class="built_in">this</span>.iid = <span class="built_in">this</span>.$route.params.iid</span><br><span class="line">   <span class="comment">// 2.æ ¹æ®idè¯·æ±‚æ•°æ®</span></span><br><span class="line">   getDetail(<span class="built_in">this</span>.iid).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ©ç”¨ $ router æ”¹å˜è·¯å¾„ï¼Œåˆ©ç”¨ $route å¯è·å¾—å½“å‰è·¯ç”±çš„ç›¸å…³ä¿¡æ¯ params</strong></p>
<h2 id="14-8-è¯¦æƒ…é¡µdetail"><a href="#14-8-è¯¦æƒ…é¡µdetail" class="headerlink" title="14.8 è¯¦æƒ…é¡µdetail"></a>14.8 è¯¦æƒ…é¡µdetail</h2><ol>
<li><strong>è½®æ’­å›¾</strong></li>
</ol>
<p>ç”±äºä¹‹å‰å°†æ‰€æœ‰çš„è·¯ç”±ç»„ä»¶ <code>keep-alive</code> ,æ‰€ä»¥æ­¤æ—¶ç‚¹æ¯ä¸ª goodsitem éƒ½æ˜¯åŒæ ·çš„è½®æ’­å›¾ï¼Œæ‰€ä»¥è¦ç”¨ <code>exclude=&quot;Detail&quot;</code>å–æ¶ˆå¯¹ detail è·¯ç”±ç»„ä»¶çš„ keep-alive</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;keep-alive exclude=<span class="string">&quot;Detail&quot;</span>&gt;</span><br><span class="line">      &lt;router-view/&gt;</span><br><span class="line">    &lt;/keep-alive&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>ç½‘ç»œè¯·æ±‚æ•°æ®æ‚ä¹±</strong></li>
</ol>
<p>æ•°æ®å¤šï¼Œä¸”ä¹±ï¼Œå¯åœ¨ä¼ é€’ç»™ç»„ä»¶æ—¶å…ˆå°†æ•°æ®å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå†å°†é‚£ä¸€ä¸ªå¯¹è±¡ä¼ ç»™ç»„ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">GoodsParam</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">info,rule</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// imageså¯èƒ½æ²¡æœ‰å€¼ï¼Œæ‰€ä»¥è¦åˆ¤æ–­ä¸€ä¸‹</span></span><br><span class="line">      <span class="built_in">this</span>.image = info.images ? info.images[<span class="number">0</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      <span class="built_in">this</span>.infos = info.set;</span><br><span class="line">      <span class="built_in">this</span>.sizes = rule.tables</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ detail.js ä¸­å°è£…ä¸ºä¸€ä¸ªç±»ï¼Œ<strong>é¢å‘å¯¹è±¡å°è£…</strong>ï¼Œå°±èƒ½å°†ä¸‰ä¸ªåœ°æ–¹çš„ä¿¡æ¯æ•´åˆåœ¨è¿™ä¸ªç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰é‡Œé¢ï¼Œå®ä¾‹å°±èƒ½å¾—åˆ°è¿™äº›æ•°æ®</p>
<ol start="3">
<li><p><strong>å±•ç¤ºæ•°æ®</strong></p>
</li>
<li><p>å±•ç¤ºæ•°ç»„ä¸­çš„å¤šä¸ªå›¾ç‰‡ï¼Œç”¨ä¸€ä¸ªimgæ ‡ç­¾éå†</p>
</li>
<li><p>å±•ç¤ºçš„å›¾ç‰‡è¾ƒå¤šæ—¶ï¼Œå¹¶ä¸”æ˜¯å‚ç›´æ’åˆ—çš„ï¼Œå°±ä¼šå½±å“ better-scroll çš„æ»šåŠ¨ï¼Œå°±æƒ³è¦å°†æ‰€æœ‰å›¾ç‰‡å…¨éƒ¨åŠ è½½å®Œæˆåå†æ»šåŠ¨ï¼Œ</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    imgLoad () &#123;</span><br><span class="line">    <span class="comment">//   this.counter +=1</span></span><br><span class="line">    <span class="comment">//   åˆ¤æ–­ï¼Œç­‰æ‰€æœ‰çš„å›¾ç‰‡éƒ½åŠ è½½å®Œåï¼Œåªç”¨è¿›è¡Œä¸€æ¬¡çš„äº‹ä»¶å‘é€</span></span><br><span class="line">    <span class="comment">// ç±»ä¼¼äºé˜²æŠ–å‡½æ•°ï¼Œé˜²æŠ–å‡½æ•°åœ¨detailç»„ä»¶ä¸­æ¥æ”¶æ—¶åº”ç”¨ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä½†ç”±äºdetailç»„ä»¶å·²ç»åšäº†æ··å…¥ï¼Œæ··å…¥ä¸­ä¹Ÿæœ‰é˜²æŠ–å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥å°†é˜²æŠ–å‡½æ•°ä¿å­˜åœ¨dataä¸­ï¼Œå°±å¯ä»¥åœ¨detailç»„ä»¶ä¸­ä»»æ„ä½ç½®éƒ½å¯ç”¨äº†</span></span><br><span class="line">      <span class="keyword">if</span>(++<span class="built_in">this</span>.counter === <span class="built_in">this</span>.imagesLengeth)&#123;</span><br><span class="line">          <span class="built_in">this</span>.$emit(<span class="string">&#x27;imgLoad&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨watché…ç½®ä¸­ç›‘è§†å›¾ç‰‡çš„length</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">    detailInfo () &#123;</span><br><span class="line">      <span class="built_in">this</span>.imagesLengeth = <span class="built_in">this</span>.detailInfo.detailImage[<span class="number">0</span>].list.length</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¾—åˆ°æ•°æ®çš„é”®åï¼Œä¹‹åæ‰å¼€å§‹</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div v-<span class="keyword">if</span>=<span class="string">&quot;Object.keys(detailInfo).length !== 0 &amp;&amp; detailInfo.detailImage[0].list !== null&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>v-for è¿˜å¯ä»¥éå†æ•°å­— ï¼Œä½†æ˜¯å±•ç¤ºçš„æ•°å­—æ˜¯ä»1å¼€å§‹çš„ï¼Œæ‰€ä»¥è¦å–åˆ°ä¸‹æ ‡è¿˜å¾—ç”¨ <code>index-1</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;info-service-item&quot;</span> v-<span class="keyword">for</span>=<span class="string">&quot;index in goods.services.length-1&quot;</span></span><br><span class="line">            :key=<span class="string">&quot;index&quot;</span>&gt;</span><br><span class="line">                &lt;img :src=<span class="string">&quot;goods.services[index-1].icon&quot;</span> alt=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">                &lt;span&gt;&#123;&#123;goods.services[index-<span class="number">1</span>].name&#125;&#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ—¶é—´æ•°æ®</strong></p>
<p>æœåŠ¡å™¨è¿”å›çš„æ—¶é—´èŠ‚ç‚¹ï¼Œä¸€å®šæ˜¯æ—¶é—´æˆ³ï¼ˆç§’ï¼‰ï¼Œéœ€è¦ç”¨ formatDate å‡½æ•°è½¬å˜æ—¶é—´æˆ³ä¸ºæ ¼å¼åŒ–çš„æ—¶é—´å­—ç¬¦ä¸²</p>
<p><strong>ç›‘å¬goodListItem ç»„ä»¶åœ¨ä¸åŒé¡µé¢å±•ç¤ºçš„å›¾ç‰‡çš„åŠ è½½</strong></p>
<p>åˆ©ç”¨è·¯ç”±ï¼š ifåˆ¤æ–­</p>
<ul>
<li>this.$route.path.indexOf(â€˜/homeâ€™) æ‰¾å‡ºè·¯å¾„ä¸­æœ‰/homeçš„è·¯ç”±ç»„ä»¶ï¼Œå‘é€ç›‘å¬ homeImageLoad</li>
<li>this.$route.path.indexOf(â€˜/detailâ€™) å¯¹è·¯å¾„ä¸­æœ‰/detailçš„è·¯ç”±ç»„ä»¶ï¼Œå‘é€ç›‘å¬detailImageLoad</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    imageLoad () &#123;</span><br><span class="line">      <span class="comment">// 1. åˆ©ç”¨è·¯ç”±çš„è·¯å¾„åˆ¤æ–­å‘é€å“ªä¸ªäº‹ä»¶</span></span><br><span class="line">       <span class="keyword">if</span>(<span class="built_in">this</span>.$route.indexOf(<span class="string">&#x27;/home&#x27;</span>))&#123;</span><br><span class="line">         <span class="built_in">this</span>.$bus.$emit(<span class="string">&#x27;homeImageLoad&#x27;</span>)</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">this</span>.$route.indexOf(<span class="string">&#x27;/detail&#x27;</span>))&#123;</span><br><span class="line">         <span class="built_in">this</span>.$bus.$emit(<span class="string">&#x27;detailImageLoad&#x27;</span>)</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>ç¦»å¼€ç»„ä»¶æ—¶å–æ¶ˆç›‘å¬</strong></p>
<p>åœ¨ goodListItem é‡Œé¢ä»ç„¶åªå‘é€ä¸€ä¸ª imageLoad å›¾ç‰‡åŠ è½½äº‹ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    imageLoad () &#123;</span><br><span class="line">      <span class="built_in">this</span>.$bus.$emit(<span class="string">&quot;itemImageLoad&quot;</span>)</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<ol>
<li>åœ¨ home ç»„ä»¶ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•° deactivated() ç¦»å¼€ç»„ä»¶æ—¶è§¦å‘çš„å‡½æ•°ä¸­åšå‡ºè®¾ç½®ï¼šå–æ¶ˆå…¨å±€äº‹ä»¶ç›‘å¬ <code>this.$bus.$off</code></li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">deactivated () &#123;</span><br><span class="line">    <span class="comment">// ä¿å­˜ç¦»å¼€æ—¶çš„ä½ç½®ä¿¡æ¯åˆ°this.saveY</span></span><br><span class="line">    <span class="built_in">this</span>.saveY = <span class="built_in">this</span>.$refs.scroll.getScrollY()</span><br><span class="line">    <span class="comment">// console.log(this.saveY);</span></span><br><span class="line">    <span class="comment">// 2.å–æ¶ˆå…¨å±€äº‹ä»¶ç›‘å¬ï¼ˆä¸»é¡µå›¾ç‰‡åŠ è½½çš„ç›‘å¬ï¼‰å› ä¸ºæ­¤æ—¶è®¾ç½®äº†keep-aliveï¼Œæ‰€ä»¥ç¦»å¼€æ—¶è°ƒç”¨çš„æ˜¯deactivated()</span></span><br><span class="line">    <span class="built_in">this</span>.$bus.$off(<span class="string">&#x27;itemImageLoad&#x27;</span>,<span class="built_in">this</span>.itemImgListener)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>this.$bus.$offå¦‚æœåªä¼ ä¸€ä¸ªå‚æ•°ï¼Œæ„å‘³ç€æ‰€æœ‰ç»„ä»¶ä¸­è¿™ä¸ªäº‹ä»¶ç›‘å¬éƒ½å°†è¢«å–æ¶ˆï¼Œåˆ©ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼šå‡½æ•°ï¼ŒæŒ‡å®šå–æ¶ˆçš„ä½ç½®ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ç›‘å¬è¿™ä¸ªäº‹ä»¶çš„å‡½æ•°ï¼Œå³mounted()ä¸­this.b u s . bus.bus.onåé¢è·Ÿçš„å‡½æ•°ï¼Œè¦æ‹¿åˆ°è¿™ä¸ªå‡½æ•°å°±è¦å°†å…¶ä¿å­˜åˆ°dataé‡Œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">mounted () &#123;</span><br><span class="line">    <span class="comment">// å¯åˆ©ç”¨æ··å…¥ï¼Œå‡å°‘é‡å¤ä»£ç </span></span><br><span class="line">    <span class="comment">// 1.ç›‘å¬itemä¸­å›¾ç‰‡åŠ è½½å®Œæˆï¼Œåˆ·æ–°é˜²æŠ–å‡½æ•°æ”¾åˆ°äº†utils.jsä¸­ï¼Œå·¥å…·åº“</span></span><br><span class="line">     <span class="keyword">const</span> refresh = debounce(<span class="built_in">this</span>.$refs.scroll.refresh,<span class="number">50</span>)</span><br><span class="line">      <span class="comment">// å¯¹ç›‘å¬çš„äº‹ä»¶è¿›è¡Œä¿å­˜ï¼Œæ–¹ä¾¿ç¦»å¼€homeç»„ä»¶æ—¶å–æ¶ˆæ­¤äº‹ä»¶ç›‘å¬</span></span><br><span class="line">       <span class="built_in">this</span>.itemImgListener = <span class="function">() =&gt;</span> &#123; refresh() &#125;</span><br><span class="line">       <span class="built_in">this</span>.$bus.$on(<span class="string">&#x27;itemImageLoad&#x27;</span>,<span class="function">() =&gt;</span> &#123;</span><br><span class="line">       <span class="comment">// this.$refs.scroll.refresh()</span></span><br><span class="line">       refresh() <span class="comment">// æ­¤å¤„æ˜¯é—­åŒ…ï¼Œå±€éƒ¨å˜é‡ä¸ä¼šè¢«é”€æ¯</span></span><br><span class="line">     &#125;)</span><br><span class="line">       <span class="built_in">this</span>.$bus.$on(<span class="string">&#x27;itemImageLoad&#x27;</span>, <span class="built_in">this</span>.itemImgListener)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å†åœ¨Detailç»„ä»¶ä¸­è®¾ç½® imageLoad å›¾ç‰‡åŠ è½½äº‹ä»¶çš„ç›‘å¬</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">mounted () &#123;</span><br><span class="line">   <span class="comment">// åˆ©ç”¨mixinæ··å…¥åï¼Œä»£æ›¿äº†ä¸‹é¢çš„ä»£ç </span></span><br><span class="line">      <span class="keyword">const</span> refresh = debounce(<span class="built_in">this</span>.$refs.scroll.refresh,<span class="number">50</span>)</span><br><span class="line">      <span class="built_in">this</span>.itemImgListener = <span class="function">() =&gt;</span> &#123; refresh() &#125;</span><br><span class="line">     <span class="comment">//  åœ¨æ­¤ç»„ä»¶ä¸­ç›‘å¬itemImageLoadå›¾ç‰‡åŠ è½½äº‹ä»¶</span></span><br><span class="line">      <span class="built_in">this</span>.$bus.$on(<span class="string">&#x27;itemImageLoad&#x27;</span>, <span class="built_in">this</span>.itemImgListener)</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰å¯¹ Detail ç»„ä»¶keep-aliveï¼Œæ‰€ä»¥åœ¨ç¦»å¼€ç»„ä»¶æ—¶å–æ¶ˆå›¾ç‰‡åŠ è½½äº‹ä»¶çš„ç›‘å¬ï¼Œè¦ç”¨ destroyed() ç”Ÿå‘½å‘¨æœŸå‡½æ•°å–æ¶ˆäº‹ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">destroyed () &#123;</span><br><span class="line">    <span class="comment">// ç¦»å¼€ç»„ä»¶æ—¶å–æ¶ˆå›¾ç‰‡åŠ è½½ç›‘å¬äº‹ä»¶</span></span><br><span class="line">    <span class="built_in">this</span>.$bus.$off(<span class="string">&#x27;itemImageLoad&#x27;</span>, <span class="built_in">this</span>.itemImgListener)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



<h2 id="14-9-ç‚¹å‡»åŠ å…¥è´­ç‰©è½¦"><a href="#14-9-ç‚¹å‡»åŠ å…¥è´­ç‰©è½¦" class="headerlink" title="14.9 ç‚¹å‡»åŠ å…¥è´­ç‰©è½¦"></a>14.9 ç‚¹å‡»åŠ å…¥è´­ç‰©è½¦</h2><p><strong>åŠ å…¥è´­ç‰©è½¦è¦æºå¸¦å•†å“çš„ iidï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ <code>vuex</code> æ¥é›†ä¸­ç®¡ç†æ•°æ®çš„å˜åŒ–</strong></p>
<ol>
<li>åœ¨detailç»„ä»¶ä¸­è·å–åˆ°éœ€è¦å±•ç¤ºçš„å•†å“çš„ä¿¡æ¯ï¼Œå°è£…åˆ°å¯¹è±¡productä¸­</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">addToCart () &#123;</span><br><span class="line">      <span class="comment">// 1.è·å–è´­ç‰©è½¦éœ€è¦å±•ç¤ºçš„ä¿¡æ¯ï¼Œå› ä¸ºæœ‰å¤šä¸ªä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œ</span></span><br><span class="line">      <span class="keyword">const</span> product = &#123;&#125;</span><br><span class="line">      product.image = <span class="built_in">this</span>.topImages[<span class="number">0</span>]</span><br><span class="line">      product.title = <span class="built_in">this</span>.goods.title</span><br><span class="line">      product.desc = <span class="built_in">this</span>.goods.desc</span><br><span class="line">      product.price = <span class="built_in">this</span>.goods.realPrice</span><br><span class="line">      product.iid = <span class="built_in">this</span>.iid <span class="comment">// idä¸€å®šè¦ä¼ ï¼Œå› ä¸ºidæ˜¯å•†å“çš„å”¯ä¸€æ ‡è¯†ï¼Œæ˜¯å°†idä¼ ç»™æœåŠ¡å™¨è·å–åˆ°å¯¹åº”çš„å•†å“</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å†å°†æ•°æ®ä¼ é€’åˆ°storeä¸­</li>
</ol>
<ul>
<li>ä¸èƒ½ç›´æ¥æ”¹å˜stateä¸­çš„æ•°æ®this.$store.state.cartList.push(product)ï¼Œå› ä¸ºæ”¹å˜ state ä¸­çš„æ•°æ®æœ€å¥½ä½¿ç”¨ mutations æˆ– actions æ–¹æ³•</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">addToCart () &#123;</span><br><span class="line">      <span class="comment">// 1.è·å–è´­ç‰©è½¦éœ€è¦å±•ç¤ºçš„ä¿¡æ¯ï¼Œå› ä¸ºæœ‰å¤šä¸ªä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œ</span></span><br><span class="line">      <span class="keyword">const</span> product = &#123;&#125;</span><br><span class="line">      product.image = <span class="built_in">this</span>.topImages[<span class="number">0</span>]</span><br><span class="line">      product.title = <span class="built_in">this</span>.goods.title</span><br><span class="line">      product.desc = <span class="built_in">this</span>.goods.desc</span><br><span class="line">      product.price = <span class="built_in">this</span>.goods.realPrice</span><br><span class="line">      product.iid = <span class="built_in">this</span>.iid <span class="comment">// idä¸€å®šè¦ä¼ ï¼Œå› ä¸ºidæ˜¯å•†å“çš„å”¯ä¸€æ ‡è¯†ï¼Œæ˜¯å°†idä¼ ç»™æœåŠ¡å™¨è·å–åˆ°å¯¹åº”çš„å•†å“</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 2.å°†å•†å“æ·»åŠ åˆ°è´­ç‰©è½¦é‡Œ</span></span><br><span class="line">       <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;addCart&#x27;</span>,product) <span class="comment">//commitæ˜¯å°†productæäº¤åˆ°storeä¸­mutationsé‡Œçš„æ–¹æ³• addCart</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨ store ä¸­çš„ addCart æ–¹æ³•ä¸­æ¥æ”¶æ•°æ®ï¼Œå¹¶å°†æ•°æ®æ·»åŠ åˆ° state çš„å¸¸é‡ä¸­å»</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">addCart</span>(<span class="params">state,payload</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> oldProduct = state.cartList.find(<span class="function"><span class="params">item</span> =&gt;</span> item.iid === payload.iid)</span><br><span class="line">        <span class="keyword">if</span>(oldProduct)&#123;</span><br><span class="line">             oldProduct.count += <span class="number">1</span> </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            payload.count =<span class="number">1</span></span><br><span class="line">             state.cartList.push(payload)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ·»åŠ è´­ç‰©è½¦æˆåŠŸçš„å¼¹çª— toast</strong></p>
<ul>
<li>æ·»åŠ æˆåŠŸ â€“&gt; å¼¹å‡ºæç¤º</li>
<li>åœ¨vuexé‡Œåšäº†æŸä¸ªæ“ä½œï¼Œæƒ³è®©å¤–é¢çš„ç»„ä»¶ç›‘å¬è¿™ä¸€æ“ä½œæ˜¯å¦æˆåŠŸï¼Œå°±è¦ç”¨åˆ° <code>promise</code></li>
<li>vuex ä¸­çš„ actions ä¸­çš„æ–¹æ³•å‡½æ•°å¯ä»¥è¿”å› promise å¯¹è±¡</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">addCart</span>(<span class="params">context,payload</span>)</span>&#123; <span class="comment">// dispatchå¯ä»¥è¿”å›ä¸€ä¸ªpromiseï¼Œå¯ç”¨æ¥ç›‘å¬äº‹ä»¶æˆåŠŸä¸å¦ï¼Œæ®æ­¤åšå¼¹çª—toastæ•ˆæœ</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> oldProduct = context.state.cartList.find(<span class="function"><span class="params">item</span> =&gt;</span> item.iid === payload.iid)</span><br><span class="line">        <span class="keyword">if</span>(oldProduct)&#123;</span><br><span class="line">            <span class="comment">// oldProduct.count += 1 è¿™æ ·å†™ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯æ— æ³•åœ¨devtoolsä¸­ç›‘è§†åˆ°çŠ¶æ€å˜åŒ–</span></span><br><span class="line">            <span class="comment">// å°†æ•°é‡åŠ 1çš„æƒ…å†µåˆ†å‘åˆ°ä¸€ä¸ªç‰¹å®šçš„æ–¹æ³•ä¸­</span></span><br><span class="line">            context.commit(ADD_COUNTER,oldProduct) <span class="comment">// commit æäº¤åˆ°storeä¸­mutationsé‡Œçš„æ–¹æ³•addCounterä¸­å»</span></span><br><span class="line">            resolve(<span class="string">&#x27;å½“å‰å•†å“æ•°é‡+1&#x27;</span>)</span><br><span class="line">            reject(<span class="string">&#x27;wrong&#x27;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            payload.count =<span class="number">1</span></span><br><span class="line">            <span class="comment">// context.state.cartList.push(payload)</span></span><br><span class="line">            <span class="comment">// å°†æ·»åŠ å•†å“çš„æƒ…å†µåˆ†å‘åˆ°å¦ä¸€ä¸ªç‰¹å®šçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—mutationsä¸­çš„æ–¹æ³•åªå¯¹åº”ä¸€ç§æ”¹å˜</span></span><br><span class="line">            context.commit(ADD_TO_CART,payload)</span><br><span class="line">            resolve(<span class="string">&#x27;æ·»åŠ æ–°çš„å•†å“&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>å°† Toast ç»„ä»¶å°è£…ä¸ºæ’ä»¶</strong></p>
<ol>
<li>toastæ–‡ä»¶å¤¹ä¸‹æ–°å»º index.js</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> obj</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ main.js ä¸­å¯¼å…¥</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> toast <span class="keyword">from</span> <span class="string">&#x27;components/common/toast&#x27;</span> <span class="comment">// 1.å¼•å…¥æ’ä»¶</span></span><br><span class="line"><span class="comment">// 2.å®‰è£…æ’ä»¶,å°±ç›¸å½“äºè°ƒç”¨äº†toastçš„installå‡½æ•°æ–¹æ³•</span></span><br><span class="line">Vue.use(toast) </span><br></pre></td></tr></table></figure>

<ol start="3">
<li>è¿”å› index.js ä¸­é…ç½®æ’ä»¶</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Toast <span class="keyword">from</span> <span class="string">&#x27;./Toast&#x27;</span> <span class="comment">// å°†toastç»„ä»¶å¯¼å…¥è¿›æ¥ï¼Œå¥½æ·»åŠ ç»„ä»¶ä¸­çš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line">obj.install = <span class="function"><span class="keyword">function</span>(<span class="params">Vue</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.åˆ›å»ºç»„ä»¶æ„é€ å™¨</span></span><br><span class="line">    <span class="keyword">const</span> toastConstructor = Vue.extend(Toast)</span><br><span class="line">    <span class="comment">// 2.ç”¨newçš„æ–¹å¼ï¼Œæ ¹æ®ç»„ä»¶æ„é€ å™¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªç»„ä»¶å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">const</span> toast = <span class="keyword">new</span> toastConstructor()</span><br><span class="line">    <span class="comment">// 3.å°†ç»„ä»¶å¯¹è±¡æ‰‹åŠ¨åœ°æŒ‚è½½åˆ°æŸä¸€ä¸ªå…ƒç´ ä¸Š</span></span><br><span class="line">    toast.$mount(<span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>)) <span class="comment">// å°†toastç»„ä»¶å¯¹è±¡æŒ‚è½½åˆ°divä¸Š</span></span><br><span class="line">    <span class="comment">// 4.æŒ‚è½½å®Œä¹‹åï¼Œtoast.$elå¯¹åº”çš„å°±æ˜¯div</span></span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(toast.$el)</span><br><span class="line">    Vue.prototype.$toast = toast <span class="comment">// å°†toastç»„ä»¶å¯¹è±¡æ”¾åœ¨vueåŸå‹ä¸Šï¼Œä½¿å¾—å…¶ä»–ä»»æ„ç»„ä»¶éƒ½å¯ä½¿ç”¨$toastæ–¹æ³•ä½¿ç”¨toastç»„ä»¶å¯¹è±¡</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> obj</span><br></pre></td></tr></table></figure>



<h2 id="14-10-cart-ç»„ä»¶æ•°æ®å±•ç¤º"><a href="#14-10-cart-ç»„ä»¶æ•°æ®å±•ç¤º" class="headerlink" title="14.10 cart ç»„ä»¶æ•°æ®å±•ç¤º"></a>14.10 cart ç»„ä»¶æ•°æ®å±•ç¤º</h2><p><strong>navbarä¸Šå•†å“çš„æ•°é‡</strong></p>
<ul>
<li>å¯å°†å®æ—¶å±•ç¤ºçš„è´­ç‰©è½¦çš„æ•°é‡ç”¨ vuex çš„ <code>getters</code> åšå°è£…ï¼Œå†å¼•å…¥vuex çš„ <code>mapGetters</code> åšè§£æ„å¼•å…¥</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">    <span class="comment">//   1.æ™®é€šå†™æ³•</span></span><br><span class="line">    <span class="comment">// cartLength () &#123;</span></span><br><span class="line">    <span class="comment">// //   return this.$store.state.cartLish.length  å°†æ–¹æ³•å°è£…åˆ°gettersä¹‹å‰çš„å†™æ³•</span></span><br><span class="line">    <span class="comment">//   return this.$store.getters.cartLength   å°è£…åˆ°gettersä¹‹åçš„å†™æ³•</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// 2.åˆ©ç”¨mapGettersè§£æ„ ï¼Œ è¿˜å¯ç”¨ mapState , mapActions</span></span><br><span class="line">    ...mapGetters([<span class="string">&#x27;cartLength&#x27;</span>])</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// getters.js ä¸­</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    cartLength (state) &#123;</span><br><span class="line">       <span class="keyword">return</span> state.cartList.length</span><br><span class="line">    &#125;,</span><br><span class="line">    cartList (state) &#123;</span><br><span class="line">        <span class="keyword">return</span> state.cartList</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è´­ç‰©è½¦å•†å“çš„å±•ç¤º</strong></p>
<ul>
<li>åˆ·æ–°ç•Œé¢</li>
</ul>
<p>ç”±äºæ–°åŠ å…¥çš„å•†å“å¯èƒ½æœªè¢« better-scroll æ‰€è·å–ï¼Œæ‰€ä»¥å¯¼è‡´ä¸èƒ½æ»šåŠ¨ï¼Œå¯ä»¥åœ¨è¿›å…¥è´­ç‰©è½¦æ—¶å°±åšä¸€æ¬¡åˆ·æ–°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">activated () &#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;0000&#x27;);</span></span><br><span class="line">    <span class="built_in">this</span>.$refs.scroll.refresh()</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å•†å“çš„é€‰ä¸­çŠ¶æ€</li>
</ul>
<p><strong>å•†å“çŠ¶æ€è¦ä¿å­˜åˆ° state ä¸­</strong></p>
<p>è®°å½•å•†å“çš„é€‰ä¸­çŠ¶æ€ï¼Œä¸èƒ½ç”¨å±æ€§è®°å½•ï¼Œè¦åœ¨å•†å“å¯¹åº”çš„å¯¹è±¡æ¨¡å‹é‡Œè®°å½•ï¼Œä¹‹åä¿®æ”¹ä¹Ÿæ˜¯ä¿®æ”¹å¯¹è±¡æ¨¡å‹é‡Œçš„æŸä¸ªå±æ€§æ¥è¿›è¡Œä¿®æ”¹<br>å¯¹è±¡æ¨¡å‹å³ cartList[å•†å“1ï¼Œå•†å“2] ä¸­çš„å•†å“æ¨¡å‹ï¼Œä¸ºå•†å“æ¨¡å‹è®¾ç½®ä¸€ä¸ª checked å±æ€§ï¼Œè®°å½•å®ƒçš„é€‰ä¸­ä¸å¦</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[ADD_TO_CART](state,payload)&#123;</span><br><span class="line">        payload.checked = <span class="literal">true</span> <span class="comment">// è´­ç‰©è½¦ä¸­å•†å“æ˜¯å¦é€‰ä¸­çš„å±æ€§ï¼Œé»˜è®¤æ·»åŠ å³é€‰ä¸­</span></span><br><span class="line">        state.cartList.push(payload)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;cart-list-item  v-<span class="keyword">for</span>=<span class="string">&quot;(item,index) in cartList&quot;</span> </span><br><span class="line">            :key=<span class="string">&quot;index&quot;</span> </span><br><span class="line">            :item-info=<span class="string">&#x27;item&#x27;</span>&gt;</span><br><span class="line">&lt;/cart-list-item&gt;</span><br><span class="line">computed: &#123;</span><br><span class="line">    ...mapGetters([<span class="string">&#x27;cartList&#x27;</span>])</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>å› ä¸ºæ¨¡å‹å‘ç”Ÿæ”¹å˜ï¼Œç•Œé¢æ‰å‘ç”Ÿæ”¹å˜ï¼Œåœ¨ mutations ä¸­æ·»åŠ payload.check=trueï¼Œç›¸å½“äºå¯¹ cartList ä¸­çš„å•†å“å¯¹è±¡ itemInfo æ·»åŠ äº†ä¸€ä¸ªå±æ€§ check</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    checkClick () &#123;</span><br><span class="line">      <span class="built_in">this</span>.itemInfo.checked = !<span class="built_in">this</span>.itemInfo.checked</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>åº•éƒ¨ä¿¡æ¯æ±‡æ€»</strong></p>
<ul>
<li>è®¡ç®—æ€»ä»·</li>
</ul>
<p>é€šè¿‡ <code>filter</code> é€‰å‡ºè¢«é€‰ä¸­çš„å•†å“ï¼Œå†é€šè¿‡ <code>reduce</code> è®¡ç®—æ€»é¢</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">    ...mapGetters([<span class="string">&#x27;cartList&#x27;</span>]),</span><br><span class="line">    totalPrice () &#123;</span><br><span class="line">    <span class="comment">//   return &#x27;ï¿¥&#x27; + this.$store.state.cartList.filter(item =&gt; &#123;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;ï¿¥&#x27;</span> + <span class="built_in">this</span>.cartList.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;  <span class="comment">// mapGettersç»“æ„ä¹‹åè¿™æ ·å†™</span></span><br><span class="line">          <span class="keyword">return</span> item.checked&#125;).reduce(<span class="function">(<span class="params">preValue,item</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">return</span> preValue + item.price * item.count</span><br><span class="line">          &#125;,<span class="number">0</span>).toFixed(<span class="number">2</span>) <span class="comment">// toFixed(2) è®¡ç®—ç»“æœä¿ç•™2ä½å°æ•°</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>è®¾ç½®å…¨é€‰æŒ‰é’®</strong></p>
<ul>
<li>åˆå§‹çŠ¶æ€ï¼šè´­ç‰©è½¦æ²¡æœ‰å•†å“æ—¶é»˜è®¤ä¸é€‰ä¸­</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">isSelectAll () &#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">this</span>.cartList.length === <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>  <span class="comment">// è´­ç‰©è½¦ä¸­æ²¡æœ‰å•†å“æ—¶ï¼Œé»˜è®¤ä¸é€‰ä¸­</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åªè¦æœ‰ä¸€ä¸ªæœªè¢«é€‰ä¸­ï¼Œåˆ™ä¸é€‰ä¸­å…¨é€‰æŒ‰é’®ï¼Œç”¨ <code>find</code> æ€§èƒ½æœ€é«˜</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">isSelectAll () &#123;</span><br><span class="line">        <span class="comment">// 1. filterä¼šå°†æ•°ç»„å…¨éƒ¨éå†å®Œ</span></span><br><span class="line">        <span class="comment">// if(this.cartList.length === 0) return false</span></span><br><span class="line">    <span class="comment">//   return !(this.cartList.filter(item =&gt; !item.checked).length) // å¯¹æœªè¢«é€‰ä¸­çš„å•†å“é•¿åº¦è¿›è¡Œå–åï¼Œ0å–åä¸ºtrue</span></span><br><span class="line">    <span class="comment">// 2.ç®€å•éå†ï¼Œä¹Ÿä¼šå…¨éƒ¨éå†å®Œ</span></span><br><span class="line">    <span class="comment">// for(let item of this.cartList)&#123;</span></span><br><span class="line">    <span class="comment">//     if(!item.checked)&#123; // æ²¡æœ‰é€‰ä¸­çš„æƒ…å†µä¸ºçœŸ</span></span><br><span class="line">    <span class="comment">//             return false</span></span><br><span class="line">    <span class="comment">//         &#125;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//         return true</span></span><br><span class="line">    <span class="comment">// 3. find åªæ‰¾åˆ°ä¸€ä¸ªå°±ä¸æ‰¾äº†ï¼Œæ€§èƒ½ä¼šé«˜ä¸€ç‚¹</span></span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">this</span>.cartList.length === <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>  <span class="comment">// è´­ç‰©è½¦ä¸­æ²¡æœ‰å•†å“æ—¶ï¼Œé»˜è®¤ä¸é€‰ä¸­</span></span><br><span class="line">      <span class="keyword">return</span> !(<span class="built_in">this</span>.cartList.find(<span class="function"><span class="params">item</span> =&gt;</span> !item.checked)) <span class="comment">// (æ‹¬å·é‡Œé¢æœ‰å€¼çš„æƒ…å†µä¸‹å†å–åï¼Œç»“æœå°±ä¸ºfalse)</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h2 id="14-11-fastclick"><a href="#14-11-fastclick" class="headerlink" title="14.11 fastclick"></a>14.11 fastclick</h2><p>è§£å†³ç§»åŠ¨ç«¯300mså»¶è¿Ÿ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> FastClick <span class="keyword">from</span> <span class="string">&#x27;fastclick&#x27;</span></span><br><span class="line"><span class="comment">// è§£å†³ç§»åŠ¨ç«¯300mså»¶è¿Ÿ</span></span><br><span class="line">FastClick.attach(<span class="built_in">document</span>.body)</span><br></pre></td></tr></table></figure>



<h2 id="14-12-å›¾ç‰‡æ‡’åŠ è½½"><a href="#14-12-å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="14.12 å›¾ç‰‡æ‡’åŠ è½½"></a>14.12 å›¾ç‰‡æ‡’åŠ è½½</h2><p>å›¾ç‰‡éœ€è¦æ˜¾ç¤ºåœ¨å±å¹•æ—¶å†åŠ è½½</p>
<p>å®‰è£…ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i vue-lazyload -s</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> VueLazyLoad <span class="keyword">from</span> <span class="string">&#x27;vue-lazyload&#x27;</span></span><br><span class="line">Vue.use(VueLazyLoad, &#123;</span><br><span class="line">  loading: <span class="built_in">require</span>(<span class="string">&#x27;./assets/img/common/placeholder.png&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;img v-lazy=<span class="string">&quot;showImage&quot;</span> alt=<span class="string">&quot;&quot;</span> @load=<span class="string">&quot;imageLoad&quot;</span>&gt;</span><br></pre></td></tr></table></figure>



<h2 id="14-13-æœåŠ¡å™¨"><a href="#14-13-æœåŠ¡å™¨" class="headerlink" title="14.13 æœåŠ¡å™¨"></a>14.13 æœåŠ¡å™¨</h2><p>æœåŠ¡å™¨ä¹Ÿæ˜¯ä¸€å°ç”µè„‘ï¼ˆæ²¡æœ‰æ˜¾ç¤ºå™¨ï¼Œåªæœ‰ä¸»æœºï¼‰ï¼Œ24å°æ—¶å¼€ç€ï¼Œä¸ºç”¨æˆ·æä¾›æœåŠ¡<br>å¤§éƒ¨åˆ†å…¬å¸éƒ½æ²¡æœ‰è‡ªå·±çš„æœåŠ¡å™¨ä¸»æœºï¼Œå› ä¸ºè‡ªå·±ä¹°ä¸»æœºè¿˜è¦å»ºä¸€ä¸ªæœºæˆ¿ï¼Œè¿˜è¦è€ƒè™‘æ•£çƒ­é—®é¢˜ï¼Œè¿˜æœ‰ç»´æŠ¤ä¸»æœºçš„æˆæœ¬ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½ä¼šç§Ÿå€Ÿé˜¿é‡Œäº‘ã€åä¸ºäº‘ã€è…¾è®¯äº‘çš„æœåŠ¡å™¨<br>æœåŠ¡å™¨ã€ä¸»æœºå°±å¿…é¡»è¦æœ‰ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œwindow(.net)/linux -&gt;å®‰è£…tomcat/nginx(æœåŠ¡å™¨ä¸Šçš„è½¯ä»¶ã€æœåŠ¡å™¨) [nginxå¯æœ‰æ•ˆå¤„ç†å¹¶å‘é¡¹ç›®ã€åå‘ä»£ç†]<br>buildæ‰“åŒ…ä¹‹åæœ‰ä¸€ä¸ªdistæ–‡ä»¶å¤¹ï¼Œå°†distæ–‡ä»¶å¤¹æ”¾åˆ°æœåŠ¡å™¨é‡Œå°±è¡Œ</p>
<p><strong>éƒ¨ç½²nginx</strong><br>mainline version ä¸»åŠ›åšçš„ç‰ˆæœ¬ï¼Œå¼€å‘ç‰ˆ<br>stable version æœ€æ–°ç¨³å®šç‰ˆï¼Œç”Ÿäº§ç¯å¢ƒä¸Šå»ºè®®ä½¿ç”¨çš„ç‰ˆæœ¬<br>legacy version é—ç•™çš„è€ç‰ˆæœ¬çš„ç¨³å®šç‰ˆ</p>
<p>å°†è‡ªå·±çš„ç”µè„‘å˜æˆä¸€å°æœåŠ¡å™¨ï¼Œåœ¨windowä¸Šé¢éƒ¨ç½²nginx<br><strong>ä¸‹è½½nginx</strong><br>å°†æ‰“åŒ…ç”Ÿæˆçš„distæ–‡ä»¶å¤¹æ”¾å…¥nginxæ–‡ä»¶å¤¹ä¸‹å°±å¯é€šè¿‡localhostè®¿é—®<br>è¿œç¨‹éƒ¨ç½²ï¼Œéœ€è¦å®‰è£…ä¸€äº›è½¯ä»¶å†æ“ä½œ<br>linux ubantuæ“ä½œç³»ç»Ÿï¼Œå°±å¯é€šè¿‡å›¾å½¢åŒ–ç•Œé¢çš„æ–¹å¼æ¥è¿›è¡Œç®¡ç†<br>linux centosæ“ä½œç³»ç»Ÿï¼Œç¨³å®šæ€§æ›´å¼º<br>åœ¨è¿œç¨‹ä¸»æœºä¸Šé€šè¿‡linux centos æ¥éƒ¨ç½²nginxï¼Œ<br>å®‰è£…ï¼šé€šè¿‡ç»ˆç«¯å‘½ä»¤æ¥å®‰è£…nginx</p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Rediså­¦ä¹ ç¬”è®°</title>
    <url>/2021/04/25/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Rediså­¦ä¹ ç¬”è®°"><a href="#Rediså­¦ä¹ ç¬”è®°" class="headerlink" title="Rediså­¦ä¹ ç¬”è®°"></a>Rediså­¦ä¹ ç¬”è®°</h1><h2 id="1-NoSQLæ¦‚è¿°"><a href="#1-NoSQLæ¦‚è¿°" class="headerlink" title="1.NoSQLæ¦‚è¿°"></a>1.NoSQLæ¦‚è¿°</h2><h3 id="1-1-ä¸ºä»€ä¹ˆç”¨NoSQL"><a href="#1-1-ä¸ºä»€ä¹ˆç”¨NoSQL" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆç”¨NoSQL"></a>1.1 ä¸ºä»€ä¹ˆç”¨NoSQL</h3><p>åœ¨90å¹´ä»£ï¼Œä¸€ä¸ªç½‘ç«™çš„è®¿é—®é‡ä¸€èˆ¬ä¸å¤§ï¼Œç”¨å•ä¸ªæ•°æ®åº“å®Œå…¨å¯ä»¥è½»æ¾åº”ä»˜ï¼<br>åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„éƒ½æ˜¯é™æ€ç½‘é¡µï¼ŒåŠ¨æ€äº¤äº’ç±»å‹çš„ç½‘ç«™ä¸å¤šã€‚<br>ä¸Šè¿°æ¶æ„ä¸‹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ•°æ®å­˜å‚¨çš„ç“¶é¢ˆæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ol>
<li>æ•°æ®é‡çš„æ€»å¤§å°ï¼Œä¸€ä¸ªæœºå™¨æ”¾ä¸ä¸‹æ—¶</li>
<li>æ•°æ®çš„ç´¢å¼•ï¼ˆB+ Treeï¼‰ä¸€ä¸ªæœºå™¨çš„å†…å­˜æ”¾ä¸ä¸‹æ—¶</li>
<li>è®¿é—®é‡ï¼ˆè¯»å†™æ··åˆï¼‰ä¸€ä¸ªå®ä¾‹ä¸èƒ½æ‰¿å—<br>å¦‚æœæ»¡è¶³äº†ä¸Šè¿° 1 or 3ä¸ªï¼Œè¿›åŒ–â€¦.<br>DALï¼šæ•°æ®åº“è®¿é—®å±‚</li>
</ol>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311174648225.png" alt="image-20210311174648225"></p>
<blockquote>
<p>2ã€Memcachedï¼ˆç¼“å­˜ï¼‰+ MySQL + å‚ç›´æ‹†åˆ†</p>
</blockquote>
<p>åæ¥ï¼Œéšç€è®¿é—®é‡çš„ä¸Šå‡ï¼Œå‡ ä¹å¤§éƒ¨åˆ†ä½¿ç”¨MySQLæ¶æ„çš„ç½‘ç«™åœ¨æ•°æ®åº“ä¸Šéƒ½å¼€å§‹å‡ºç°äº†æ€§èƒ½é—®é¢˜ï¼Œwebç¨‹åºä¸å†ä»…ä»…ä¸“æ³¨åœ¨åŠŸèƒ½ä¸Šï¼ŒåŒæ—¶ä¹Ÿåœ¨è¿½æ±‚æ€§èƒ½ã€‚ç¨‹åºçŒ¿ä»¬å¼€å§‹å¤§é‡ä½¿ç”¨ç¼“å­˜æŠ€æœ¯æ¥ç¼“è§£æ•°æ®åº“çš„å‹åŠ›ï¼Œä¼˜åŒ–æ•°æ®åº“çš„ç»“æ„å’Œç´¢å¼•ï¼Œå¼€å§‹æ¯”è¾ƒæµè¡Œçš„æ˜¯é€šè¿‡æ–‡ä»¶ç¼“å­˜æ¥ç¼“è§£æ•°æ®åº“å‹åŠ›ï¼Œä½†æ˜¯å½“è®¿é—®é‡ç»§ç»­å¢å¤§çš„æ—¶å€™ï¼Œå¤šå°webæœºå™¨é€šè¿‡æ–‡ä»¶ç¼“å­˜ä¸èƒ½å…±äº«ï¼Œå¤§é‡çš„å°æ–‡ä»¶ç¼“å­˜ä¹Ÿå¸¦äº†æ¯”è¾ƒé«˜çš„IOå‹åŠ›ï¼Œåœ¨è¿™ä¸ªæ—¶å€™ï¼ŒMemcachedå°±è‡ªç„¶çš„æˆä¸ºä¸€ä¸ªéå¸¸æ—¶å°šçš„æŠ€æœ¯äº§å“ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311174736061.png" alt="image-20210311174736061"></p>
<blockquote>
<p>3ã€MySQLä¸»ä»è¯»å†™åˆ†ç¦»</p>
</blockquote>
<p>ç”±äºæ•°æ®åº“çš„å†™å…¥å‹åŠ›å¢åŠ ï¼ŒMemcachedåªèƒ½ç¼“è§£æ•°æ®åº“çš„è¯»å–å‹åŠ›ï¼Œè¯»å†™é›†ä¸­åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸Šè®©æ•°æ®åº“ä¸å ªé‡è´Ÿï¼Œå¤§éƒ¨åˆ†ç½‘ç«™å¼€å§‹ä½¿ç”¨ä¸»ä»å¤åˆ¶æŠ€æœ¯æ¥è¾¾åˆ°è¯»å†™åˆ†ç¦»ï¼Œä»¥æé«˜è¯»å†™æ€§èƒ½å’Œè¯»åº“çš„å¯æ‰©å±•æ€§ï¼ŒMySQLçš„master-slaveæ¨¡å¼æˆä¸ºè¿™ä¸ªæ—¶å€™çš„ç½‘ç«™æ ‡é…äº†ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311174912875.png" alt="image-20210311174912875"></p>
<blockquote>
<p>4ã€åˆ†è¡¨åˆ†åº“ + æ°´å¹³æ‹†åˆ† + Mysql é›†ç¾¤</p>
</blockquote>
<p>åœ¨Memcachedçš„é«˜é€Ÿç¼“å­˜ï¼ŒMySQLçš„ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿™æ—¶MySQLä¸»åº“çš„å†™å‹åŠ›å¼€å§‹<br>å‡ºç°ç“¶é¢ˆï¼Œè€Œæ•°æ®é‡çš„æŒç»­çŒ›å¢ï¼Œç”±äºMyISAMä½¿ç”¨è¡¨é”ï¼Œåœ¨é«˜å¹¶å‘ä¸‹ä¼šå‡ºç°ä¸¥é‡çš„é”é—®é¢˜ï¼Œå¤§é‡çš„é«˜<br>å¹¶å‘MySQLåº”ç”¨å¼€å§‹ä½¿ç”¨InnoDBå¼•æ“ä»£æ›¿MyISAMã€‚<br>åŒæ—¶ï¼Œå¼€å§‹æµè¡Œä½¿ç”¨åˆ†è¡¨åˆ†åº“æ¥ç¼“è§£å†™å‹åŠ›å’Œæ•°æ®å¢é•¿çš„æ‰©å±•é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œåˆ†è¡¨åˆ†åº“æˆäº†ä¸€ä¸ªçƒ­é—¨<br>æŠ€æœ¯ï¼Œæ˜¯é¢è¯•çš„çƒ­é—¨é—®é¢˜ï¼Œä¹Ÿæ˜¯ä¸šç•Œè®¨è®ºçš„çƒ­é—¨æŠ€æœ¯é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªæ—¶å€™ï¼ŒMySQLæ¨å‡ºäº†è¿˜ä¸å¤ªç¨³<br>å®šçš„è¡¨åˆ†åŒºï¼Œè¿™ä¹Ÿç»™æŠ€æœ¯å®åŠ›ä¸€èˆ¬çš„å…¬å¸å¸¦æ¥äº†å¸Œæœ›ã€‚è™½ç„¶MySQLæ¨å‡ºäº†MySQL Clusteré›†ç¾¤ï¼Œä½†æ€§èƒ½<br>ä¹Ÿä¸èƒ½å¾ˆå¥½æ»¡è¶³äº’è”ç½‘çš„éœ€æ±‚ï¼Œåªæ˜¯åœ¨é«˜å¯é æ€§ä¸Šæä¾›äº†éå¸¸å¤§çš„ä¿è¯ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311175013360.png" alt="image-20210311175013360"></p>
<blockquote>
<p>5ã€MySQL çš„æ‰©å±•æ€§ç“¶é¢ˆ</p>
</blockquote>
<p>MySQLæ•°æ®åº“ä¹Ÿç»å¸¸å­˜å‚¨ä¸€äº›å¤§æ–‡æœ¬çš„å­—æ®µï¼Œå¯¼è‡´æ•°æ®åº“è¡¨éå¸¸çš„å¤§ï¼Œåœ¨åšæ•°æ®åº“æ¢å¤çš„æ—¶å€™å°±å¯¼è‡´é<br>å¸¸çš„æ…¢ï¼Œä¸å®¹æ˜“å¿«é€Ÿæ¢å¤æ•°æ®åº“ï¼Œæ¯”å¦‚1000ä¸‡4KBå¤§å°çš„æ–‡æœ¬å°±æ¥è¿‘40GBçš„å¤§å°ï¼Œå¦‚æœèƒ½æŠŠè¿™äº›æ•°æ®<br>ä»MySQLçœå»ï¼ŒMySQLå°†å˜çš„éå¸¸çš„å°ï¼Œå…³ç³»æ•°æ®åº“å¾ˆå¼ºå¤§ï¼Œä½†æ˜¯å®ƒå¹¶ä¸èƒ½å¾ˆå¥½çš„åº”ä»˜æ‰€æœ‰çš„åº”ç”¨åœº<br>æ™¯ï¼ŒMySQLçš„æ‰©å±•æ€§å·®ï¼ˆéœ€è¦å¤æ‚çš„æŠ€æœ¯æ¥å®ç°ï¼‰ï¼Œå¤§æ•°æ®ä¸‹IOå‹åŠ›å¤§ï¼Œè¡¨ç»“æ„æ›´æ”¹å›°éš¾ï¼Œæ­£æ˜¯å½“å‰ä½¿<br>ç”¨MySQLçš„å¼€å‘äººå‘˜é¢ä¸´çš„é—®é¢˜ã€‚</p>
<blockquote>
<p>6.å¦‚ä»Šçš„æ ·å­</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311175121803.png" alt="image-20210311175121803"></p>
<blockquote>
<p>7ã€ä¸ºä»€ä¹ˆç”¨NoSQLï¼Ÿ</p>
</blockquote>
<p>ä»Šå¤©æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆå¦‚ï¼šGoogleï¼ŒFaceBookç­‰ï¼‰å¯ä»¥å¾ˆå®¹æ˜“çš„è®¿é—®å’ŒæŠ“å–æ•°æ®ã€‚ç”¨æˆ·çš„ä¸ª<br>äººä¿¡æ¯ï¼Œç¤¾äº¤ç½‘ç»œï¼Œåœ°ç†ä½ç½®ï¼Œç”¨æˆ·ç”Ÿæˆçš„æ•°æ®å’Œç”¨æˆ·æ“ä½œæ—¥å¿—å·²ç»æˆå€çš„å¢åŠ ã€æˆ‘ä»¬å¦‚æœè¦å¯¹è¿™äº›ç”¨<br>æˆ·æ•°æ®è¿›è¡ŒæŒ–æ˜ï¼Œé‚£SQLæ•°æ®åº“å·²ç»ä¸é€‚åˆè¿™äº›åº”ç”¨äº†ï¼Œè€ŒNoSQLæ•°æ®åº“çš„å‘å±•å´èƒ½å¾ˆå¥½çš„å¤„ç†è¿™äº›å¤§<br>çš„æ•°æ®ï¼</p>
<h3 id="1-2-ä»€ä¹ˆæ˜¯NoSQL"><a href="#1-2-ä»€ä¹ˆæ˜¯NoSQL" class="headerlink" title="1.2 ä»€ä¹ˆæ˜¯NoSQL"></a>1.2 ä»€ä¹ˆæ˜¯NoSQL</h3><blockquote>
<p>NoSQL</p>
</blockquote>
<p>NoSQL = Not Only SQLï¼Œæ„æ€ï¼šä¸ä»…ä»…æ˜¯SQLï¼›<br>æ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ï¼Œéšç€äº’è”ç½‘Web2.0ç½‘ç«™çš„å…´èµ·ï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨åº”ä»˜web2.0ç½‘ç«™ï¼Œç‰¹åˆ«<br>æ˜¯è¶…å¤§è§„æ¨¡å’Œé«˜å¹¶å‘çš„ç¤¾äº¤ç½‘ç»œæœåŠ¡ç±»å‹çš„Web2.0çº¯åŠ¨æ€ç½‘ç«™å·²ç»æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œæš´éœ²äº†å¾ˆå¤šéš¾ä»¥å…‹æœ<br>çš„é—®é¢˜ï¼Œè€Œéå…³ç³»å‹çš„æ•°æ®åº“åˆ™ç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹å¾—åˆ°äº†éå¸¸è¿…é€Ÿçš„å‘å±•ï¼ŒNoSQLæ•°æ®åº“çš„äº§ç”Ÿå°±æ˜¯ä¸º<br>äº†è§£å†³å¤§è§„æ¨¡æ•°æ®é›†åˆå¤šç§æ•°æ®ç§ç±»å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯å¤§æ•°æ®åº”ç”¨éš¾é¢˜ï¼ŒåŒ…æ‹¬è¶…å¤§è§„æ¨¡æ•°æ®çš„å­˜å‚¨ã€‚<br>ï¼ˆä¾‹å¦‚è°·æ­Œæˆ–Facebookæ¯å¤©ä¸ºä»–ä»¬çš„ç”¨æˆ·æ”¶é›†ä¸‡äº¿æ¯”ç‰¹çš„æ•°æ®ï¼‰ã€‚è¿™äº›ç±»å‹çš„æ•°æ®å­˜å‚¨ä¸éœ€è¦å›ºå®šçš„æ¨¡<br>å¼ï¼Œæ— éœ€å¤šä½™æ“ä½œå°±å¯ä»¥æ¨ªå‘æ‰©å±•ã€‚</p>
<blockquote>
<p>NoSQLçš„ç‰¹ç‚¹</p>
</blockquote>
<ul>
<li>æ˜“æ‹“å±•</li>
</ul>
<p>NoSQL æ•°æ®åº“ç§ç±»ç¹å¤šï¼Œä½†æ˜¯ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹éƒ½æ˜¯å»æ‰å…³ç³»æ•°æ®åº“çš„å…³ç³»å‹ç‰¹æ€§ã€‚<br>æ•°æ®ä¹‹é—´æ— å…³ç³»ï¼Œè¿™æ ·å°±éå¸¸å®¹æ˜“æ‰©å±•ï¼Œä¹Ÿæ— å½¢ä¹‹é—´ï¼Œåœ¨æ¶æ„çš„å±‚é¢ä¸Šå¸¦æ¥äº†å¯æ‰©å±•çš„èƒ½åŠ›ã€‚</p>
<ul>
<li>å¤§æ•°æ®é‡é«˜æ€§èƒ½</li>
</ul>
<p>NoSQLæ•°æ®åº“éƒ½å…·æœ‰éå¸¸é«˜çš„è¯»å†™æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¤§æ•°æ®é‡ä¸‹ï¼ŒåŒæ ·è¡¨ç°ä¼˜ç§€ã€‚è¿™å¾—ç›Šäºå®ƒçš„éå…³ç³»<br>æ€§ï¼Œæ•°æ®åº“çš„ç»“æ„ç®€å•ã€‚<br>ä¸€èˆ¬MySQLä½¿ç”¨Query Cacheï¼Œæ¯æ¬¡è¡¨çš„æ›´æ–°Cacheå°±å¤±æ•ˆï¼Œæ˜¯ä¸€ç§å¤§åŠ›åº¦çš„Cacheï¼Œåœ¨é’ˆå¯¹Web2.0çš„<br>äº¤äº’é¢‘ç¹åº”ç”¨ï¼ŒCacheæ€§èƒ½ä¸é«˜ï¼Œè€ŒNoSQLçš„Cacheæ˜¯è®°å½•çº§çš„ï¼Œæ˜¯ä¸€ç§ç»†ç²’åº¦çš„Cacheï¼Œæ‰€ä»¥NoSQL<br>åœ¨è¿™ä¸ªå±‚é¢ä¸Šæ¥è¯´å°±è¦æ€§èƒ½é«˜å¾ˆå¤šäº†ã€‚</p>
<ul>
<li>å¤šæ ·çµæ´»çš„æ•°æ®æ¨¡å‹</li>
</ul>
<p>NoSQLæ— éœ€äº‹å…ˆä¸ºè¦å­˜å‚¨çš„æ•°æ®å»ºç«‹å­—æ®µï¼Œéšæ—¶å¯ä»¥å­˜å‚¨è‡ªå®šä¹‰çš„æ•°æ®æ ¼å¼ï¼Œè€Œåœ¨å…³ç³»æ•°æ®åº“é‡Œï¼Œå¢åˆ <br>å­—æ®µæ˜¯ä¸€ä»¶éå¸¸éº»çƒ¦çš„äº‹æƒ…ã€‚å¦‚æœæ˜¯éå¸¸å¤§æ•°æ®é‡çš„è¡¨ï¼Œå¢åŠ å­—æ®µç®€ç›´å°±æ˜¯å™©æ¢¦ã€‚</p>
<ul>
<li>ä¼ ç»Ÿçš„RDBMS VS NoSQL</li>
</ul>
<blockquote>
<p>â€‹    <strong>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ RDBMS</strong></p>
<ul>
<li><p>é«˜åº¦ç»„ç»‡åŒ–ç»“æ„åŒ–æ•°æ®</p>
</li>
<li><p>ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼ˆSQLï¼‰</p>
</li>
<li><p>æ•°æ®å’Œå…³ç³»éƒ½å­˜å‚¨åœ¨å•ç‹¬çš„è¡¨ä¸­</p>
</li>
<li><p>æ•°æ®æ“çºµè¯­è¨€ï¼Œæ•°æ®å®šä¹‰è¯­è¨€</p>
</li>
<li><p>ä¸¥æ ¼çš„ä¸€è‡´æ€§</p>
<p><strong>åŸºç¡€äº‹åŠ¡NoSQL</strong></p>
</li>
<li><p>ä»£è¡¨ç€ä¸ä»…ä»…æ˜¯SQL</p>
</li>
<li><p>æ²¡æœ‰å£°æ˜æ€§æŸ¥è¯¢è¯­è¨€</p>
</li>
<li><p>æ²¡æœ‰é¢„å®šä¹‰çš„æ¨¡å¼</p>
</li>
<li><p>é”®å€¼å¯¹å­˜å‚¨ï¼Œåˆ—å­˜å‚¨ï¼Œæ–‡æ¡£å­˜å‚¨ï¼Œå›¾å½¢æ•°æ®åº“</p>
</li>
<li><p>æœ€ç»ˆä¸€è‡´æ€§ï¼Œè€ŒéACIDå±æ€§</p>
</li>
<li><p>éç»“æ„åŒ–å’Œä¸å¯é¢„çŸ¥çš„æ•°æ®</p>
</li>
<li><p>CAPå®šç†</p>
</li>
<li><p>é«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨æ€§ å’Œ å¯ä¼¸ç¼©æ€§</p>
</li>
</ul>
</blockquote>
<p>å¤§æ•°æ®æ—¶ä»£çš„3V ï¼š ä¸»è¦æ˜¯å¯¹é—®é¢˜çš„æè¿°</p>
<ul>
<li>æµ·é‡ Volume</li>
<li>å¤šæ · Variety</li>
<li>å®æ—¶ Velocity</li>
</ul>
<p>äº’è”ç½‘éœ€æ±‚çš„3é«˜ ï¼š ä¸»è¦æ˜¯å¯¹ç¨‹åºçš„è¦æ±‚</p>
<ul>
<li>é«˜å¯ç”¨</li>
<li>é«˜å¹¶å‘</li>
<li>é«˜æ€§èƒ½</li>
</ul>
<h3 id="1-3-æ·˜å®æŠ€æœ¯åˆ†æ"><a href="#1-3-æ·˜å®æŠ€æœ¯åˆ†æ" class="headerlink" title="1.3 æ·˜å®æŠ€æœ¯åˆ†æ"></a>1.3 æ·˜å®æŠ€æœ¯åˆ†æ</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180349058.png" alt="image-20210311180349058"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180408024.png" alt="image-20210311180408024"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180425596.png" alt="image-20210311180425596"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180441641.png" alt="image-20210311180441641"></p>
<blockquote>
<p><strong>å¤§å‹äº’è”ç½‘åº”ç”¨ï¼ˆå¤§æ•°æ®ï¼Œé«˜å¹¶å‘ï¼Œå¤šæ ·æ•°æ®ç±»å‹ï¼‰çš„éš¾ç‚¹å’Œè§£å†³æ–¹æ¡ˆ</strong></p>
</blockquote>
<p><strong>éš¾ç‚¹ï¼š</strong></p>
<ul>
<li>æ•°æ®ç±»å‹çš„å¤šæ ·æ€§</li>
<li>æ•°æ®æºå¤šæ ·æ€§å’Œå˜åŒ–é‡æ„</li>
<li>æ•°æ®æºæ”¹é€ è€Œæ•°æ®æœåŠ¡å¹³å°ä¸éœ€è¦å¤§é¢ç§¯é‡æ„</li>
</ul>
<p><strong>è§£å†³åŠæ³•ï¼š</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180659495.png" alt="image-20210311180659495"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180720138.png" alt="image-20210311180720138"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180852111.png" alt="image-20210311180852111"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180910245.png" alt="image-20210311180910245"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311180924551.png" alt="image-20210311180924551"></p>
<h3 id="1-4-NoSQLå››å¤§åˆ†ç±»"><a href="#1-4-NoSQLå››å¤§åˆ†ç±»" class="headerlink" title="1.4 NoSQLå››å¤§åˆ†ç±»"></a>1.4 NoSQLå››å¤§åˆ†ç±»</h3><p><strong>KVé”®å€¼ï¼š</strong></p>
<ul>
<li>æ–°æµª</li>
<li>ç¾å›¢</li>
<li>é˜¿é‡Œ</li>
</ul>
<p><strong>æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆbsonæ ¼å¼è¾ƒå¤šï¼‰</strong></p>
<ul>
<li>CouchDB</li>
<li>MongoDB<ul>
<li>MongoDB æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”± C++ è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</li>
<li>MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚</li>
</ul>
</li>
</ul>
<p><strong>åˆ—å­˜å‚¨æ•°æ®åº“</strong></p>
<ul>
<li>Cassandra, HBase</li>
<li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</li>
</ul>
<p><strong>å›¾å…³ç³»æ•°æ®åº“</strong></p>
<ul>
<li>å®ƒä¸æ˜¯æ”¾å›¾å½¢çš„ï¼Œæ”¾çš„æ˜¯å…³ç³»æ¯”å¦‚:æœ‹å‹åœˆç¤¾äº¤ç½‘ç»œã€å¹¿å‘Šæ¨èç³»ç»Ÿ</li>
<li>ç¤¾äº¤ç½‘ç»œï¼Œæ¨èç³»ç»Ÿï¼Œä¸“æ³¨äºæ„å»ºå…³ç³»å›¾è°±</li>
</ul>
<blockquote>
<p>å››è€…å¯¹æ¯”</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311181647824.png" alt="image-20210311181647824"></p>
<h3 id="1-5-CAP-BASE"><a href="#1-5-CAP-BASE" class="headerlink" title="1.5 CAP+BASE"></a>1.5 CAP+BASE</h3><h4 id="1-5-1BASEçš„æ¦‚å¿µ"><a href="#1-5-1BASEçš„æ¦‚å¿µ" class="headerlink" title="1.5.1BASEçš„æ¦‚å¿µ"></a>1.5.1BASEçš„æ¦‚å¿µ</h4><ul>
<li>A (Atomicity) åŸå­æ€§</li>
</ul>
<blockquote>
<p>åŸå­æ€§å¾ˆå®¹æ˜“ç†è§£ï¼Œä¹Ÿå°±æ˜¯è¯´äº‹åŠ¡é‡Œçš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨åšå®Œï¼Œè¦ä¹ˆéƒ½ä¸åšï¼Œäº‹åŠ¡æˆåŠŸçš„æ¡ä»¶æ˜¯äº‹åŠ¡é‡Œçš„æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸï¼Œåªè¦æœ‰ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å°±å¤±è´¥ï¼Œéœ€è¦å›æ»šã€‚<br>æ¯”å¦‚é“¶è¡Œè½¬è´¦ï¼Œä»Aè´¦æˆ·è½¬100å…ƒè‡³Bè´¦æˆ·ï¼Œåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š<br>1ï¼‰ä»Aè´¦æˆ·å–100å…ƒï¼›<br>2ï¼‰å­˜å…¥100å…ƒè‡³Bè´¦æˆ·ã€‚<br>è¿™ä¸¤æ­¥è¦ä¹ˆä¸€èµ·å®Œæˆï¼Œè¦ä¹ˆä¸€èµ·ä¸å®Œæˆï¼Œå¦‚æœåªå®Œæˆç¬¬ä¸€æ­¥ï¼Œç¬¬äºŒæ­¥å¤±è´¥ï¼Œé’±ä¼šè«åå…¶å¦™å°‘äº†100å…ƒ</p>
</blockquote>
<ul>
<li>C (Consistency) ä¸€è‡´æ€§</li>
</ul>
<blockquote>
<p>äº‹ç‰©å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´</p>
</blockquote>
<ul>
<li>I (Isolation) éš”ç¦»æ€§</li>
</ul>
<blockquote>
<p>æ‰€è°“çš„ç‹¬ç«‹æ€§æ˜¯æŒ‡å¹¶å‘çš„äº‹åŠ¡ä¹‹é—´ä¸ä¼šäº’ç›¸å½±å“ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡è¦è®¿é—®çš„æ•°æ®æ­£åœ¨è¢«å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹ï¼Œåªè¦å¦å¤–ä¸€ä¸ªäº‹åŠ¡æœªæäº¤ï¼Œå®ƒæ‰€è®¿é—®çš„æ•°æ®å°±ä¸å—æœªæäº¤äº‹åŠ¡çš„å½±å“ã€‚æ¯”å¦‚ç°æœ‰æœ‰ä¸ªäº¤æ˜“æ˜¯ä»Aè´¦æˆ·è½¬100å…ƒè‡³Bè´¦æˆ·ï¼Œåœ¨è¿™ä¸ªäº¤æ˜“è¿˜æœªå®Œæˆçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ­¤æ—¶BæŸ¥è¯¢è‡ªå·±çš„è´¦æˆ·ï¼Œæ˜¯çœ‹ä¸åˆ°æ–°å¢åŠ çš„100å…ƒçš„</p>
</blockquote>
<ul>
<li>D (Durability) æŒä¹…æ€§</li>
</ul>
<blockquote>
<p>æŒä¹…æ€§æ˜¯æŒ‡ä¸€æ—¦äº‹åŠ¡æäº¤åï¼Œå®ƒæ‰€åšçš„ä¿®æ”¹å°†ä¼šæ°¸ä¹…çš„ä¿å­˜åœ¨æ•°æ®åº“ä¸Šï¼Œå³ä½¿å‡ºç°å®•æœºä¹Ÿä¸ä¼šä¸¢å¤±</p>
</blockquote>
<h4 id="1-5-2CAPçš„æ¦‚å¿µ"><a href="#1-5-2CAPçš„æ¦‚å¿µ" class="headerlink" title="1.5.2CAPçš„æ¦‚å¿µ"></a>1.5.2CAPçš„æ¦‚å¿µ</h4><ul>
<li>C : Consistencyï¼ˆå¼ºä¸€è‡´æ€§ï¼‰</li>
<li> A : Availabilityï¼ˆå¯ç”¨æ€§ï¼‰</li>
<li>P : Partition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰</li>
</ul>
<p>CAPç†è®ºå°±æ˜¯è¯´åœ¨åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œæœ€å¤šåªèƒ½å®ç°ä¸Šé¢çš„ä¸¤ç‚¹ã€‚<br>è€Œç”±äºå½“å‰çš„ç½‘ç»œç¡¬ä»¶è‚¯å®šä¼šå‡ºç°å»¶è¿Ÿä¸¢åŒ…ç­‰é—®é¢˜ï¼Œæ‰€ä»¥åˆ†åŒºå®¹é”™æ€§æ˜¯æˆ‘ä»¬å¿…é¡»éœ€è¦å®ç°çš„ã€‚<br>æ‰€ä»¥æˆ‘ä»¬åªèƒ½åœ¨ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¹‹é—´è¿›è¡Œæƒè¡¡ï¼Œæ²¡æœ‰NoSQLç³»ç»Ÿèƒ½åŒæ—¶ä¿è¯è¿™ä¸‰ç‚¹ã€‚<br>æ³¨æ„ï¼šåˆ†å¸ƒå¼æ¶æ„çš„æ—¶å€™å¿…é¡»åšå‡ºå–èˆã€‚<br>ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¹‹é—´å–ä¸€ä¸ªå¹³è¡¡ã€‚å¤šä½™å¤§å¤šæ•°webåº”ç”¨ï¼Œå…¶å®å¹¶ä¸éœ€è¦å¼ºä¸€è‡´æ€§</p>
<p>å› æ­¤ç‰ºç‰²Cæ¢å–Pï¼Œè¿™æ˜¯ç›®å‰åˆ†å¸ƒå¼æ•°æ®åº“äº§å“çš„æ–¹å‘</p>
<p><strong>ä¸€è‡´æ€§ä¸å¯ç”¨æ€§çš„å†³æ‹©</strong><br>å¯¹äºweb2.0ç½‘ç«™æ¥è¯´ï¼Œå…³ç³»æ•°æ®åº“çš„å¾ˆå¤šä¸»è¦ç‰¹æ€§å´å¾€å¾€æ— ç”¨æ­¦ä¹‹åœ°<br>æ•°æ®åº“äº‹åŠ¡ä¸€è‡´æ€§éœ€æ±‚<br>å¾ˆå¤šwebå®æ—¶ç³»ç»Ÿå¹¶ä¸è¦æ±‚ä¸¥æ ¼çš„æ•°æ®åº“äº‹åŠ¡ï¼Œå¯¹è¯»ä¸€è‡´æ€§çš„è¦æ±‚å¾ˆä½ï¼Œ æœ‰äº›åœºåˆå¯¹å†™ä¸€è‡´æ€§è¦æ±‚å¹¶ä¸<br>é«˜ã€‚å…è®¸å®ç°æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p><strong>æ•°æ®åº“çš„å†™å®æ—¶æ€§å’Œè¯»å®æ—¶æ€§éœ€æ±‚</strong><br>å¯¹å…³ç³»æ•°æ®åº“æ¥è¯´ï¼Œæ’å…¥ä¸€æ¡æ•°æ®ä¹‹åç«‹åˆ»æŸ¥è¯¢ï¼Œæ˜¯è‚¯å®šå¯ä»¥è¯»å‡ºæ¥è¿™æ¡æ•°æ®çš„ï¼Œä½†æ˜¯å¯¹äºå¾ˆå¤šwebåº”<br>ç”¨æ¥è¯´ï¼Œå¹¶ä¸è¦æ±‚è¿™ä¹ˆé«˜çš„å®æ—¶æ€§ï¼Œæ¯”æ–¹è¯´å‘ä¸€æ¡æ¶ˆæ¯ä¹‹ åï¼Œè¿‡å‡ ç§’ä¹ƒè‡³åå‡ ç§’ä¹‹åï¼Œæˆ‘çš„è®¢é˜…è€…æ‰çœ‹<br>åˆ°è¿™æ¡åŠ¨æ€æ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„ã€‚</p>
<p><strong>å¯¹å¤æ‚çš„SQLæŸ¥è¯¢ï¼Œç‰¹åˆ«æ˜¯å¤šè¡¨å…³è”æŸ¥è¯¢çš„éœ€æ±‚</strong><br>ä»»ä½•å¤§æ•°æ®é‡çš„webç³»ç»Ÿï¼Œéƒ½éå¸¸å¿Œè®³å¤šä¸ªå¤§è¡¨çš„å…³è”æŸ¥è¯¢ï¼Œä»¥åŠå¤æ‚çš„æ•°æ®åˆ†æç±»å‹çš„æŠ¥è¡¨æŸ¥è¯¢ï¼Œç‰¹<br>åˆ«æ˜¯SNSç±»å‹çš„ç½‘ç«™ï¼Œä»éœ€æ±‚ä»¥åŠäº§å“è®¾è®¡è§’åº¦ï¼Œå°±é¿å…äº†è¿™ç§æƒ…å†µçš„äº§ç”Ÿã€‚å¾€å¾€æ›´å¤šçš„åªæ˜¯å•è¡¨çš„ä¸»<br>é”®æŸ¥è¯¢ï¼Œä»¥åŠå•è¡¨çš„ç®€å•æ¡ä»¶åˆ†é¡µæŸ¥è¯¢ï¼ŒSQLçš„åŠŸèƒ½è¢«æå¤§çš„å¼±åŒ–äº†ã€‚</p>
<p><strong>CAPç†è®ºçš„æ ¸å¿ƒæ˜¯ï¼š</strong>ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶å¾ˆå¥½çš„æ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªéœ€æ±‚ï¼Œ<br>æœ€å¤šåªèƒ½åŒæ—¶è¾ƒå¥½çš„æ»¡è¶³ä¸¤ä¸ªã€‚å› æ­¤ï¼Œæ ¹æ® CAP åŸç†å°† NoSQL æ•°æ®åº“åˆ†æˆäº†æ»¡è¶³ CA åŸåˆ™ã€æ»¡è¶³ CP<br>åŸåˆ™å’Œæ»¡è¶³ AP åŸåˆ™ä¸‰ å¤§ç±»ï¼š</p>
<ul>
<li>CA - å•ç‚¹é›†ç¾¤ï¼Œæ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸åœ¨å¯æ‰©å±•æ€§ä¸Šä¸å¤ªå¼ºå¤§ã€‚</li>
<li>CP - æ»¡è¶³ä¸€è‡´æ€§ï¼Œåˆ†åŒºå®¹å¿å¿…çš„ç³»ç»Ÿï¼Œé€šå¸¸æ€§èƒ½ä¸æ˜¯ç‰¹åˆ«é«˜ã€‚</li>
<li>AP - æ»¡è¶³å¯ç”¨æ€§ï¼Œåˆ†åŒºå®¹å¿æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸å¯èƒ½å¯¹ä¸€è‡´æ€§è¦æ±‚ä½ä¸€äº›ã€‚</li>
</ul>
<h2 id="2-Redisæ¦‚è¿°"><a href="#2-Redisæ¦‚è¿°" class="headerlink" title="2.Redisæ¦‚è¿°"></a>2.Redisæ¦‚è¿°</h2><h3 id="2-1Redisä»‹ç»"><a href="#2-1Redisä»‹ç»" class="headerlink" title="2.1Redisä»‹ç»"></a>2.1Redisä»‹ç»</h3><p><strong>Redisï¼šREmote DIctionary Serverï¼ˆè¿œç¨‹å­—å…¸æœåŠ¡å™¨ï¼‰</strong></p>
<p>Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ä»2010å¹´3æœˆ15æ—¥èµ·ï¼ŒRedisçš„å¼€å‘å·¥ä½œç”±VMwareä¸»æŒã€‚ä»2013å¹´5æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±PivotalèµåŠ©ã€‚Redisæ˜¯ NoSQLæŠ€æœ¯é˜µè¥ä¸­çš„ä¸€å‘˜ï¼Œå®ƒé€šè¿‡å¤šç§é”®å€¼æ•°æ®ç±»å‹æ¥é€‚åº”ä¸åŒåœºæ™¯ä¸‹çš„å­˜å‚¨éœ€æ±‚ï¼Œå€ŸåŠ©ä¸€äº›é«˜å±‚çº§çš„æ¥å£ä½¿å…¶å¯ä»¥èƒœä»»å¦‚ç¼“å­˜ã€é˜Ÿåˆ—ç³»ç»Ÿçš„ä¸åŒè§’è‰²</p>
<p><strong>Redisä¸å…¶ä»–key-valueç¼“å­˜äº§å“æœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹</strong></p>
<ul>
<li>Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚</li>
<li>Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„ key-value ç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listã€setã€zsetã€hashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚</li>
<li>Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚</li>
</ul>
<p><strong>Redisçš„ä¼˜åŠ¿</strong></p>
<ul>
<li><p>æ€§èƒ½æé«˜ï¼šRedisèƒ½è¯»çš„é€Ÿåº¦æ˜¯110000æ¬¡/sï¼Œå†™çš„é€Ÿåº¦æ˜¯81000æ¬¡/s</p>
</li>
<li><p>ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼šRedisæ”¯æŒäºŒè¿›åˆ¶æ¡ˆä¾‹çš„Stringsã€Listsã€Hashesã€SetsåŠOrdered Setsæ•°æ®ç±»å‹æ“ä½œ</p>
</li>
<li><p>åŸå­æ€§ï¼šRedisçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼ŒåŒæ—¶Redisè¿˜æ”¯æŒå¯¹å‡ ä¸ªæ“ä½œå…¨å¹¶åçš„åŸå­æ€§æ‰§è¡Œ</p>
</li>
<li><p>ä¸°å¯Œçš„ç‰¹æ€§ï¼šRedisè¿˜æ”¯æŒpublish/subscribeã€é€šçŸ¥ã€key è¿‡æœŸç­‰ç­‰ç‰¹æ€§</p>
</li>
</ul>
<p>å®˜æ–¹ä¸­æ–‡ç½‘<a href="http://redis.cn/">http://redis.cn/</a></p>
<p>å®˜ç½‘<a href="https://redis.io/">https://redis.io/</a></p>
<h3 id="2-2Redisåœ¨Linuxç¯å¢ƒåœ¨å®‰è£…"><a href="#2-2Redisåœ¨Linuxç¯å¢ƒåœ¨å®‰è£…" class="headerlink" title="2.2Redisåœ¨Linuxç¯å¢ƒåœ¨å®‰è£…"></a>2.2Redisåœ¨Linuxç¯å¢ƒåœ¨å®‰è£…</h3><p>1ã€ä¸‹è½½è·å¾— redis-6.2.1.tar.gz åå°†å®ƒæ”¾åˆ°æˆ‘ä»¬Linuxçš„ç›®å½•ä¸‹ /opt</p>
<p>2ã€/opt ç›®å½•ä¸‹ï¼Œè§£å‹å‘½ä»¤ ï¼š tar -zxvf redis-6.2.1.tar.gz</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310200821842.png"></p>
<p>3ã€è§£å‹å®Œæˆåå‡ºç°æ–‡ä»¶å¤¹ï¼šredis-5.0.7</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310201019977.png" alt="image-20210310201019977"></p>
<blockquote>
<p><strong>è¿è¡Œmakeå‘½ä»¤æ—¶æ•…æ„å‡ºç°çš„é”™è¯¯è§£æ</strong>ï¼š</p>
<ol>
<li>å®‰è£…gcc (gccæ˜¯linuxä¸‹çš„ä¸€ä¸ªç¼–è¯‘ç¨‹åºï¼Œæ˜¯cç¨‹åºçš„ç¼–è¯‘å·¥å…·)<br>èƒ½ä¸Šç½‘: yum install gcc-c++<br>ç‰ˆæœ¬æµ‹è¯•: gcc-v</li>
<li>äºŒæ¬¡make</li>
<li>Jemalloc/jemalloc.h: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•<br>è¿è¡Œ make distclean ä¹‹åå†make</li>
<li>Redis Testï¼ˆå¯ä»¥ä¸ç”¨æ‰§è¡Œï¼‰</li>
</ol>
</blockquote>
<p>4ã€è¿›å…¥ç›®å½•ï¼š cd redis-6.2.1</p>
<p>5ã€åœ¨ redis-6.2.1 ç›®å½•ä¸‹æ‰§è¡Œ make å‘½ä»¤</p>
<p>6ã€å¦‚æœmakeå®Œæˆåç»§ç»­æ‰§è¡Œ make install</p>
<p>7ã€æŸ¥çœ‹é»˜è®¤å®‰è£…ç›®å½•ï¼šusr/local/bin</p>
<p>8ã€æ‹·è´è®¾ç½®æ–‡ä»¶</p>
<blockquote>
<p>/usr è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç±»ä¼¼äºwindowsä¸‹çš„Program Files,å­˜æ”¾ç”¨æˆ·çš„ç¨‹åº</p>
</blockquote>
<blockquote>
<p>cd /usr/local/bin<br>ls -l</p>
<p><strong>åœ¨redisçš„è§£å‹ç›®å½•ä¸‹å¤‡ä»½redis.conf</strong></p>
<p>mkdir myredis<br>cp redis.conf myredis  # æ‹·ä¸€ä¸ªå¤‡ä»½ï¼Œå…»æˆè‰¯å¥½çš„ä¹ æƒ¯ï¼Œæˆ‘ä»¬å°±ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶</p>
<p><strong>ä¿®æ”¹é…ç½®ä¿è¯å¯ä»¥åå°åº”ç”¨</strong></p>
<p>vim redis.conf</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310201256444.png" alt="image-20210310201256444"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310201323971.png" alt="image-20210310201323971"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310201530209.png" alt="image-20210310201530209"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310202030827.png" alt="image-20210310202030827"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310202158878.png" alt="image-20210310202158878"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311184758459.png" alt="image-20210311184758459"></p>
<ul>
<li>Aã€redis.confé…ç½®æ–‡ä»¶ä¸­daemonizeå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯NOã€‚</li>
<li>Bã€daemonizeæ˜¯ç”¨æ¥æŒ‡å®šredisæ˜¯å¦è¦ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ã€‚</li>
</ul>
<p><strong>daemonize è®¾ç½®yesæˆ–è€…noåŒºåˆ«</strong></p>
<ul>
<li><p>daemonize:yes</p>
<ul>
<li>redisé‡‡ç”¨çš„æ˜¯å•è¿›ç¨‹å¤šçº¿ç¨‹çš„æ¨¡å¼ã€‚å½“redis.confä¸­é€‰é¡¹daemonizeè®¾ç½®æˆyesæ—¶ï¼Œä»£è¡¨å¼€å¯<br>å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œredisä¼šåœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¿›ç¨‹pidå·å†™å…¥è‡³redis.confé€‰é¡¹<br>pidfileè®¾ç½®çš„æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶rediså°†ä¸€ç›´è¿è¡Œï¼Œé™¤éæ‰‹åŠ¨killè¯¥è¿›ç¨‹</li>
</ul>
</li>
<li><p>daemonize:no</p>
<ul>
<li>å½“daemonizeé€‰é¡¹è®¾ç½®æˆnoæ—¶ï¼Œå½“å‰ç•Œé¢å°†è¿›å…¥redisçš„å‘½ä»¤è¡Œç•Œé¢ï¼Œexitå¼ºåˆ¶é€€å‡ºæˆ–è€…å…³é—­<br>è¿æ¥å·¥å…·(putty,xshellç­‰)éƒ½ä¼šå¯¼è‡´redisè¿›ç¨‹é€€å‡ºã€‚</li>
</ul>
<p>9ã€å¯åŠ¨æµ‹è¯•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ã€shellã€‘å¯åŠ¨redisæœåŠ¡</span></span><br><span class="line"></span><br><span class="line">[root@192 bin]<span class="comment"># cd /usr/local/bin</span></span><br><span class="line">[root@192 bin]<span class="comment"># redis-server /opt/redis-5.0.7/redis.conf</span></span><br><span class="line"></span><br><span class="line">rediså®¢æˆ·ç«¯è¿æ¥===&gt; è§‚å¯Ÿåœ°å€çš„å˜åŒ–ï¼Œå¦‚æœè¿æ¥ok,æ˜¯ç›´æ¥è¿ä¸Šçš„ï¼Œredisé»˜è®¤ç«¯å£å· 6379</span><br><span class="line"></span><br><span class="line">[root@192 bin]<span class="comment"># redis-cli -p 6379</span></span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 helloworld</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get k1</span><br><span class="line"><span class="string">&quot;helloworld&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ã€shellã€‘psæ˜¾ç¤ºç³»ç»Ÿå½“å‰è¿›ç¨‹ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">[root@192 myredis]<span class="comment"># ps -ef|grep redis</span></span><br><span class="line">root    16005    1  0 04:45 ?     00:00:00 redis-server</span><br><span class="line">127.0.0.1:6379</span><br><span class="line">root    16031  15692  0 04:47 pts/0   00:00:00 redis-cli -p 6379</span><br><span class="line">root    16107  16076  0 04:51 pts/2   00:00:00 grep --color=auto redis</span><br><span class="line"></span><br><span class="line"><span class="comment">#ã€redisã€‘å…³é—­è¿æ¥</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; shutdown</span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ã€shellã€‘psæ˜¾ç¤ºç³»ç»Ÿå½“å‰è¿›ç¨‹ä¿¡æ¯</span></span><br><span class="line">[root@192 myredis]<span class="comment"># ps -ef|grep redis</span></span><br><span class="line">root Â Â Â 16140 Â 16076 Â 0 04:53 pts/2 Â Â 00:00:00 grep --color=auto redis</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310203013001.png" alt="image-20210310203013001"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310203227429.png" alt="image-20210310203227429"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310203328902.png" alt="image-20210310203328902"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210310204335734.png" alt="image-20210310204335734"></p>
<p>æ–‡ä»¶å‚æ•°è¯¦è§£</p>
<ul>
<li>redis-server ï¼šRedisæœåŠ¡å™¨</li>
<li>redis-cli ï¼šRediså®¢æˆ·ç«¯</li>
<li>redis-sentinel ï¼šRediså“¨å…µç«¯</li>
<li>redis-benchmarkï¼šRedisæ€§èƒ½æµ‹è¯•å·¥å…·</li>
<li>redis-check-aof ï¼šAOFæ–‡ä»¶ä¿®å¤å·¥å…·</li>
<li>redis-check-rdb ï¼šRDBæ–‡ä»¶æ£€ç´¢å·¥å…·</li>
</ul>
<h2 id="3-äº”å¤§æ•°æ®ç±»å‹"><a href="#3-äº”å¤§æ•°æ®ç±»å‹" class="headerlink" title="3.äº”å¤§æ•°æ®ç±»å‹"></a>3.äº”å¤§æ•°æ®ç±»å‹</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210311191512620.png" alt="image-20210311191512620"></p>
<p><strong>å…¨æ®µç¿»è¯‘ï¼š</strong><br>Redisæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç ï¼ˆBSDè®¸å¯ï¼‰çš„å†…å­˜ä¸­æ•°æ®ç»“æ„å­˜å‚¨ï¼Œç”¨ä½œæ•°æ®åº“ï¼Œç¼“å­˜å’Œæ¶ˆæ¯ä»£ç†ã€‚å®ƒæ”¯æŒæ•°<br>æ®ç»“æ„ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ï¼Œå“ˆå¸Œï¼Œåˆ—è¡¨ï¼Œé›†åˆï¼Œå¸¦èŒƒå›´æŸ¥è¯¢çš„æ’åºé›†åˆï¼Œä½å›¾ï¼Œè¶…æ—¥å¿—ï¼Œå¸¦æœ‰åŠå¾„æŸ¥è¯¢å’Œæµ<br>çš„åœ°ç†ç©ºé—´ç´¢å¼•ã€‚Rediså…·æœ‰å†…ç½®çš„å¤åˆ¶ï¼ŒLuaè„šæœ¬ï¼ŒLRUé©±é€ï¼Œäº‹åŠ¡å’Œä¸åŒçº§åˆ«çš„ç£ç›˜æŒä¹…æ€§ï¼Œå¹¶é€šè¿‡<br>Redis Sentinelå’ŒRedis Clusterè‡ªåŠ¨åˆ†åŒºæä¾›äº†é«˜å¯ç”¨æ€§ã€‚</p>
<p><strong>Redisé”®(Key)</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> keys * æŸ¥çœ‹æ‰€æœ‰çš„key</span></span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line">127.0.0.1:6379&gt; set name zhuangkang</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) &quot;name&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> exists key çš„åå­—ï¼Œåˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">127.0.0.1:6379&gt; EXISTS name</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; EXISTS name1</span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> move key db ---&gt; å½“å‰åº“å°±æ²¡æœ‰äº†ï¼Œè¢«ç§»é™¤äº†</span></span><br><span class="line">127.0.0.1:6379&gt; move name 1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line"><span class="meta">#</span><span class="bash"> expire key ç§’é’Ÿï¼šä¸ºç»™å®š key è®¾ç½®ç”Ÿå­˜æ—¶é—´ï¼Œå½“ key è¿‡æœŸæ—¶(ç”Ÿå­˜æ—¶é—´ä¸º 0 )ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ttl key æŸ¥çœ‹è¿˜æœ‰å¤šå°‘ç§’è¿‡æœŸï¼Œ-1 è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œ-2 è¡¨ç¤ºå·²è¿‡æœŸ</span></span><br><span class="line">127.0.0.1:6379&gt; set name zhuangkang</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; EXPIRE name 10</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(integer) -2</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">type</span> key æŸ¥çœ‹ä½ çš„keyæ˜¯ä»€ä¹ˆç±»å‹</span></span><br><span class="line">127.0.0.1:6379&gt; set name zhuangkang</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">&quot;zhuangkang&quot;</span><br><span class="line">127.0.0.1:6379&gt; type name</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<h3 id="3-1-String-å­—ç¬¦ä¸²ç±»å‹"><a href="#3-1-String-å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="3.1 String(å­—ç¬¦ä¸²ç±»å‹)"></a>3.1 String(å­—ç¬¦ä¸²ç±»å‹)</h3><p>Stringæ˜¯redisæœ€åŸºæœ¬çš„ç±»å‹ï¼Œä½ å¯ä»¥ç†è§£æˆMemcachedä¸€æ¨¡ä¸€æ ·çš„ç±»å‹ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueã€‚<br>Stringç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œæ„æ€æ˜¯redisçš„stringå¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ï¼Œæ¯”å¦‚jpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡ã€‚<br>Stringç±»å‹æ˜¯redisæœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¸€ä¸ªredisä¸­å­—ç¬¦ä¸²valueæœ€å¤šå¯ä»¥æ˜¯512Mã€‚</p>
<p><strong>å¸¸ç”¨å‘½ä»¤è§£æ</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span>ã€getã€delã€appendã€strlen</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; set key1 value1 Â # è®¾ç½®å€¼</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get key1 Â Â Â Â Â # è·å¾—key</span><br><span class="line">&quot;value1&quot;</span><br><span class="line">127.0.0.1:6379&gt; del key1 Â Â Â Â Â # åˆ é™¤key</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; keys * Â Â Â Â Â Â # æŸ¥çœ‹å…¨éƒ¨çš„key</span><br><span class="line">(empty list or set)</span><br><span class="line">127.0.0.1:6379&gt; exists key1 Â Â Â # ç¡®ä¿ key1 ä¸å­˜åœ¨</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; append key1 &quot;hello&quot; Â # å¯¹ä¸å­˜åœ¨çš„ key è¿›è¡Œ APPEND ï¼Œç­‰åŒäº SET</span><br><span class="line">key1 &quot;hello&quot;</span><br><span class="line">(integer) 5 Â Â # å­—ç¬¦é•¿åº¦</span><br><span class="line">127.0.0.1:6379&gt; APPEND key1 &quot;-2333&quot; Â # å¯¹å·²å­˜åœ¨çš„å­—ç¬¦ä¸²è¿›è¡Œ APPEND</span><br><span class="line">(integer) 10 Â Â # é•¿åº¦ä» 5 ä¸ªå­—ç¬¦å¢åŠ åˆ° 10 ä¸ªå­—ç¬¦</span><br><span class="line">127.0.0.1:6379&gt; get key1</span><br><span class="line">&quot;hello-2333&quot;</span><br><span class="line">127.0.0.1:6379&gt; STRLEN key1 Â Â Â # # è·å–å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">(integer) 10 </span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> incrã€decr Â Â ä¸€å®šè¦æ˜¯æ•°å­—æ‰èƒ½è¿›è¡ŒåŠ å‡ï¼Œ+1 å’Œ -1ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> incrbyã€decrby å‘½ä»¤å°† key ä¸­å‚¨å­˜çš„æ•°å­—åŠ ä¸ŠæŒ‡å®šçš„å¢é‡å€¼ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; set views 0 Â Â Â # è®¾ç½®æµè§ˆé‡ä¸º0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr views Â Â Â Â # æµè§ˆ + 1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; incr views Â Â Â Â # æµè§ˆ + 1</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; decr views Â Â Â Â # æµè§ˆ - 1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; incrby views 10 Â # +10</span><br><span class="line">(integer) 11</span><br><span class="line">127.0.0.1:6379&gt; decrby views 10 Â # -10</span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> range [èŒƒå›´]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> getrange è·å–æŒ‡å®šåŒºé—´èŒƒå›´å†…çš„å€¼ï¼Œç±»ä¼¼between...andçš„å…³ç³»ï¼Œä»é›¶åˆ°è´Ÿä¸€è¡¨ç¤ºå…¨éƒ¨</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; set key2 abcd123456 Â # è®¾ç½®key2çš„å€¼</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; getrange key2 0 -1 Â # è·å¾—å…¨éƒ¨çš„å€¼</span><br><span class="line">&quot;abcd123456&quot;</span><br><span class="line">127.0.0.1:6379&gt; getrange key2 0 2 Â Â # æˆªå–éƒ¨åˆ†å­—ç¬¦ä¸²</span><br><span class="line">&quot;abc&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> setrange è®¾ç½®æŒ‡å®šåŒºé—´èŒƒå›´å†…çš„å€¼ï¼Œæ ¼å¼æ˜¯setrange keyå€¼ å…·ä½“å€¼</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; get key2</span><br><span class="line">&quot;abcd123456&quot;</span><br><span class="line">127.0.0.1:6379&gt; SETRANGE key2 1 xx Â # æ›¿æ¢å€¼</span><br><span class="line">(integer) 10</span><br><span class="line">127.0.0.1:6379&gt; get key2</span><br><span class="line">&quot;axxd123456&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> setexï¼ˆ<span class="built_in">set</span> with expireï¼‰é”®ç§’å€¼</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> setnxï¼ˆ<span class="built_in">set</span> <span class="keyword">if</span> not existï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; setex key3 60 expire Â # è®¾ç½®è¿‡æœŸæ—¶é—´</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; ttl key3 Â # æŸ¥çœ‹å‰©ä½™çš„æ—¶é—´</span><br><span class="line">(integer) 55</span><br><span class="line">127.0.0.1:6379&gt; setnx mykey &quot;redis&quot; Â # å¦‚æœä¸å­˜åœ¨å°±è®¾ç½®ï¼ŒæˆåŠŸè¿”å›1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; setnx mykey &quot;mongodb&quot; Â # å¦‚æœå­˜åœ¨å°±è®¾ç½®ï¼Œå¤±è´¥è¿”å›0</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; get mykey</span><br><span class="line">&quot;redis&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> mset Â Â Mset å‘½ä»¤ç”¨äºåŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> mget Â Â Mget å‘½ä»¤è¿”å›æ‰€æœ‰(ä¸€ä¸ªæˆ–å¤šä¸ª)ç»™å®š key çš„å€¼ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Â Â Â Â Â å¦‚æœç»™å®šçš„ key é‡Œé¢ï¼Œæœ‰æŸä¸ª key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ª key è¿”å›ç‰¹æ®Šå€¼ nil ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> msetnx Â å½“æ‰€æœ‰ key éƒ½æˆåŠŸè®¾ç½®ï¼Œè¿”å› 1 ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Â Â Â Â Â å¦‚æœæ‰€æœ‰ç»™å®š key éƒ½è®¾ç½®å¤±è´¥(è‡³å°‘æœ‰ä¸€ä¸ª key å·²ç»å­˜åœ¨)ï¼Œé‚£ä¹ˆè¿”å› 0 ã€‚åŸå­æ“</span></span><br><span class="line">ä½œ</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; mset k10 v10 k11 v11 k12 v12</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) &quot;k12&quot;</span><br><span class="line">2) &quot;k11&quot;</span><br><span class="line">3) &quot;k10&quot;</span><br><span class="line">127.0.0.1:6379&gt; mget k10 k11 k12 k13</span><br><span class="line">1) &quot;v10&quot;</span><br><span class="line">2) &quot;v11&quot;</span><br><span class="line">3) &quot;v12&quot;</span><br><span class="line">4) (nil)</span><br><span class="line">127.0.0.1:6379&gt; msetnx k10 v10 k15 v15 # åŸå­æ€§æ“ä½œï¼</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; get key15</span><br><span class="line">(nil)</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¼ ç»Ÿå¯¹è±¡ç¼“å­˜</span></span><br><span class="line">set user:1 value(jsonæ•°æ®)</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯ä»¥ç”¨æ¥ç¼“å­˜å¯¹è±¡</span></span><br><span class="line">mset user:1:name zhangsan user:1:age 2</span><br><span class="line">mget user:1:name user:1:age</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> getsetï¼ˆå…ˆgetå†<span class="built_in">set</span>ï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; getset db mongodb Â # æ²¡æœ‰æ—§å€¼ï¼Œè¿”å› nil</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get db</span><br><span class="line">&quot;mongodb&quot;</span><br><span class="line">127.0.0.1:6379&gt; getset db redis Â Â # è¿”å›æ—§å€¼ mongodb</span><br><span class="line">&quot;mongodb&quot;</span><br><span class="line">127.0.0.1:6379&gt; get db</span><br><span class="line">&quot;redis&quot;</span><br></pre></td></tr></table></figure>

<p>Stringæ•°æ®ç»“æ„æ˜¯ç®€å•çš„key-valueç±»å‹ï¼Œvalueå…¶å®ä¸ä»…å¯ä»¥æ˜¯Stringï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°å­—ã€‚<br>å¸¸è§„key-valueç¼“å­˜åº”ç”¨ï¼š<br>å¸¸è§„è®¡æ•°ï¼šå¾®åšæ•°ï¼Œç²‰ä¸æ•°ç­‰</p>
<h3 id="3-2-List-é›†åˆç±»å‹"><a href="#3-2-List-é›†åˆç±»å‹" class="headerlink" title="3.2 List(é›†åˆç±»å‹)"></a>3.2 List(é›†åˆç±»å‹)</h3><p>åœ¨Redisä¸­ï¼ŒListç±»å‹æ˜¯æŒ‰ç…§æ’å…¥é¡ºåºæ’åºçš„å­—ç¬¦ä¸²é“¾è¡¨ã€‚å’Œæ•°æ®ç»“æ„ä¸­çš„æ™®é€šé“¾è¡¨ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶å¤´éƒ¨(left)å’Œå°¾éƒ¨(right)æ·»åŠ æ–°çš„å…ƒç´ ã€‚åœ¨æ’å…¥æ—¶ï¼Œå¦‚æœè¯¥é”®å¹¶ä¸å­˜åœ¨ï¼ŒRediså°†ä¸ºè¯¥é”®åˆ›å»ºä¸€ä¸ªæ–°çš„é“¾è¡¨ã€‚ä¸æ­¤ç›¸åï¼Œå¦‚æœé“¾è¡¨ä¸­æ‰€æœ‰çš„å…ƒç´ å‡è¢«ç§»é™¤ï¼Œé‚£ä¹ˆè¯¥é”®ä¹Ÿå°†ä¼šè¢«ä»æ•°æ®åº“ä¸­åˆ é™¤ã€‚Listä¸­å¯ä»¥åŒ…å«çš„æœ€å¤§å…ƒç´ æ•°é‡æ˜¯4294967295ã€‚ä»å…ƒç´ æ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡è§†è§’æ¥çœ‹ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯åœ¨é“¾è¡¨çš„ä¸¤å¤´æ’å…¥æˆ–åˆ é™¤å…ƒç´ ï¼Œè¿™å°†ä¼šæ˜¯éå¸¸é«˜æ•ˆçš„æ“ä½œï¼Œå³ä½¿é“¾è¡¨ä¸­å·²ç»å­˜å‚¨äº†ç™¾ä¸‡æ¡è®°å½•ï¼Œè¯¥æ“ä½œä¹Ÿå¯ä»¥åœ¨å¸¸é‡æ—¶é—´å†…å®Œæˆã€‚ç„¶è€Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœå…ƒç´ æ’å…¥æˆ–åˆ é™¤æ“ä½œæ˜¯ä½œç”¨äºé“¾è¡¨ä¸­é—´ï¼Œé‚£å°†ä¼šæ˜¯éå¸¸ä½æ•ˆçš„ã€‚</p>
<p><strong>å¸¸ç”¨å‘½ä»¤è§£æ</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Lpushï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ã€‚ï¼ˆå·¦ï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rpushï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å°¾éƒ¨ã€‚ï¼ˆå³ï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lrangeï¼šè¿”å›åˆ—è¡¨ä¸­æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼ŒåŒºé—´ä»¥åç§»é‡ START å’Œ END æŒ‡å®šã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å…¶ä¸­ 0 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ 1 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿæ•°ä¸‹æ ‡ï¼Œä»¥ -1 è¡¨ç¤ºåˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ -2 è¡¨ç¤ºåˆ—è¡¨çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤</span></span><br><span class="line">ç±»æ¨ã€‚</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; LPUSH list &quot;one&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; LPUSH list &quot;two&quot;</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; RPUSH list &quot;right&quot;</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; Lrange list 0 -1</span><br><span class="line">1) &quot;two&quot;</span><br><span class="line">2) &quot;one&quot;</span><br><span class="line">3) &quot;right&quot;</span><br><span class="line">127.0.0.1:6379&gt; Lrange list 0 1</span><br><span class="line">1) &quot;two&quot;</span><br><span class="line">2) &quot;one&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lpop å‘½ä»¤ç”¨äºç§»é™¤å¹¶è¿”å›åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å½“åˆ—è¡¨ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› nil ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rpop ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å€¼ä¸ºç§»é™¤çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; Lpop list</span><br><span class="line">&quot;two&quot;</span><br><span class="line">127.0.0.1:6379&gt; Rpop list</span><br><span class="line">&quot;right&quot;</span><br><span class="line">127.0.0.1:6379&gt; Lrange list 0 -1</span><br><span class="line">1) &quot;one&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Lindexï¼ŒæŒ‰ç…§ç´¢å¼•ä¸‹æ ‡è·å¾—å…ƒç´ ï¼ˆ-1ä»£è¡¨æœ€åä¸€ä¸ªï¼Œ0ä»£è¡¨æ˜¯ç¬¬ä¸€ä¸ªï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; Lindex list 1</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; Lindex list 0</span><br><span class="line">&quot;one&quot;</span><br><span class="line">127.0.0.1:6379&gt; Lindex list -1</span><br><span class="line">&quot;one&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> llen ç”¨äºè¿”å›åˆ—è¡¨çš„é•¿åº¦ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; flushdb</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; Lpush list &quot;one&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; Lpush list &quot;two&quot;</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; Lpush list &quot;three&quot;</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; Llen list Â # è¿”å›åˆ—è¡¨çš„é•¿åº¦</span><br><span class="line">(integer) 3</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lrem key æ ¹æ®å‚æ•° COUNT çš„å€¼ï¼Œç§»é™¤åˆ—è¡¨ä¸­ä¸å‚æ•° VALUE ç›¸ç­‰çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; lrem list 1 &quot;two&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; Lrange list 0 -1</span><br><span class="line">1) &quot;three&quot;</span><br><span class="line">2) &quot;one&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Ltrim key å¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œä¿®å‰ª(trim)ï¼Œå°±æ˜¯è¯´ï¼Œè®©åˆ—è¡¨åªä¿ç•™æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼Œä¸åœ¨æŒ‡å®šåŒº</span></span><br><span class="line">é—´ä¹‹å†…çš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤ã€‚</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; RPUSH mylist &quot;hello&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; RPUSH mylist &quot;hello&quot;</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; RPUSH mylist &quot;hello2&quot;</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; RPUSH mylist &quot;hello3&quot;</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; ltrim mylist 1 2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; lrange mylist 0 -1</span><br><span class="line">1) &quot;hello&quot;</span><br><span class="line">2) &quot;hello2&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rpoplpush ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ·»åŠ åˆ°å¦ä¸€ä¸ªåˆ—è¡¨å¹¶è¿”å›ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; rpush mylist &quot;hello&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; rpush mylist &quot;foo&quot;</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; rpush mylist &quot;bar&quot;</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; rpoplpush mylist myotherlist</span><br><span class="line">&quot;bar&quot;</span><br><span class="line">127.0.0.1:6379&gt; lrange mylist 0 -1</span><br><span class="line">1) &quot;hello&quot;</span><br><span class="line">2) &quot;foo&quot;</span><br><span class="line">127.0.0.1:6379&gt; lrange myotherlist 0 -1</span><br><span class="line">1) &quot;bar&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lset key index value å°†åˆ—è¡¨ key ä¸‹æ ‡ä¸º index çš„å…ƒç´ çš„å€¼è®¾ç½®ä¸º value ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; exists list Â # å¯¹ç©ºåˆ—è¡¨(key ä¸å­˜åœ¨)è¿›è¡Œ LSET</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; lset list 0 item # æŠ¥é”™</span><br><span class="line">(error) ERR no such key</span><br><span class="line">127.0.0.1:6379&gt; lpush list &quot;value1&quot; # å¯¹éç©ºåˆ—è¡¨è¿›è¡Œ LSET</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 0</span><br><span class="line">1) &quot;value1&quot;</span><br><span class="line">127.0.0.1:6379&gt; lset list 0 &quot;new&quot; Â # æ›´æ–°å€¼</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 0</span><br><span class="line">1) &quot;new&quot;</span><br><span class="line">127.0.0.1:6379&gt; lset list 1 &quot;new&quot; Â # index è¶…å‡ºèŒƒå›´æŠ¥é”™</span><br><span class="line">(error) ERR index out of range</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> linsert key before/after pivot value ç”¨äºåœ¨åˆ—è¡¨çš„å…ƒç´ å‰æˆ–è€…åæ’å…¥å…ƒç´ ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°†å€¼ value æ’å…¥åˆ°åˆ—è¡¨ key å½“ä¸­ï¼Œä½äºå€¼ pivot ä¹‹å‰æˆ–ä¹‹åã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> RPUSH mylist <span class="string">&quot;Hello&quot;</span></span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> RPUSH mylist <span class="string">&quot;World&quot;</span></span></span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> LINSERT mylist BEFORE <span class="string">&quot;World&quot;</span> <span class="string">&quot;There&quot;</span></span></span><br><span class="line">(integer) 3</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> LRANGE mylist 0 -1</span></span><br><span class="line">1) &quot;Hello&quot;</span><br><span class="line">2) &quot;There&quot;</span><br><span class="line">3) &quot;World&quot;</span><br></pre></td></tr></table></figure>

<p><strong>Listæ€»ç»“</strong></p>
<ul>
<li>å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²é“¾è¡¨ï¼Œleftï¼Œright éƒ½å¯ä»¥æ’å…¥æ·»åŠ </li>
<li>å¦‚æœé”®ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„é“¾è¡¨</li>
<li>å¦‚æœé”®å·²å­˜åœ¨ï¼Œæ–°å¢å†…å®¹</li>
<li>å¦‚æœå€¼å…¨ç§»é™¤ï¼Œå¯¹åº”çš„é”®ä¹Ÿå°±æ¶ˆå¤±äº†</li>
<li>é“¾è¡¨çš„æ“ä½œæ— è®ºæ˜¯å¤´å’Œå°¾æ•ˆç‡éƒ½æé«˜ï¼Œä½†å‡å¦‚æ˜¯å¯¹ä¸­é—´å…ƒç´ è¿›è¡Œæ“ä½œï¼Œæ•ˆç‡å°±å¾ˆæƒ¨æ·¡äº†</li>
</ul>
<p>listå°±æ˜¯é“¾è¡¨ï¼Œç•¥æœ‰æ•°æ®ç»“æ„çŸ¥è¯†çš„äººéƒ½åº”è¯¥èƒ½ç†è§£å…¶ç»“æ„ã€‚ä½¿ç”¨Listsç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°æœ€æ–°æ¶ˆæ¯æ’è¡Œç­‰åŠŸèƒ½ã€‚Listçš„å¦ä¸€ä¸ªåº”ç”¨å°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¯ä»¥åˆ©ç”¨Listçš„PUSHæ“ä½œï¼Œå°†ä»»åŠ¡å­˜åœ¨Listä¸­ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å†ç”¨POPæ“ä½œå°†ä»»åŠ¡å–å‡ºè¿›è¡Œæ‰§è¡Œã€‚Redisè¿˜æä¾›äº†æ“ä½œListä¸­æŸä¸€æ®µçš„apiï¼Œä½ å¯ä»¥ç›´æ¥æŸ¥è¯¢ï¼Œåˆ é™¤Listä¸­æŸä¸€æ®µçš„å…ƒç´ ã€‚<br>Redisçš„listæ˜¯æ¯ä¸ªå­å…ƒç´ éƒ½æ˜¯Stringç±»å‹çš„åŒå‘é“¾è¡¨ï¼Œå¯ä»¥é€šè¿‡pushå’Œpopæ“ä½œä»åˆ—è¡¨çš„å¤´éƒ¨æˆ–è€…å°¾éƒ¨æ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ ï¼Œè¿™æ ·Listå³å¯ä»¥ä½œä¸ºæ ˆï¼Œä¹Ÿå¯ä»¥ä½œä¸ºé˜Ÿåˆ—ã€‚</p>
<h3 id="3-3-Set-é›†åˆ"><a href="#3-3-Set-é›†åˆ" class="headerlink" title="3.3 Set(é›†åˆ)"></a>3.3 Set(é›†åˆ)</h3><p>Redisä¸­çš„Hashç±»å‹å¯ä»¥çœ‹æˆå…·æœ‰String Keyå’ŒString Valueçš„mapå®¹å™¨ã€‚æ‰€ä»¥è¯¥ç±»å‹éå¸¸é€‚åˆäºå­˜å‚¨å€¼å¯¹è±¡çš„ä¿¡æ¯ã€‚å¦‚ç”¨æˆ·ä¿¡æ¯ï¼šUsernameã€Passwordå’ŒAgeç­‰ã€‚æ¯ä¸€ä¸ªHashå¯ä»¥å­˜å‚¨4294967295ä¸ªé”®å€¼å¯¹ã€‚</p>
<p><strong>å¸¸ç”¨å‘½ä»¤è§£æ</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sadd å°†ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜å…ƒç´ åŠ å…¥åˆ°é›†åˆä¸­ï¼Œä¸èƒ½é‡å¤</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> smembers è¿”å›é›†åˆä¸­çš„æ‰€æœ‰çš„æˆå‘˜ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sismember å‘½ä»¤åˆ¤æ–­æˆå‘˜å…ƒç´ æ˜¯å¦æ˜¯é›†åˆçš„æˆå‘˜ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; sadd myset &quot;hello&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset &quot;zhuangkang&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset &quot;zhuangkang&quot;</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;hello&quot;</span><br><span class="line">127.0.0.1:6379&gt; SISMEMBER myset &quot;hello&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SISMEMBER myset &quot;world&quot;</span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> scardï¼Œè·å–é›†åˆé‡Œé¢çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; scard myset</span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> srem key value ç”¨äºç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜å…ƒç´ </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; srem myset &quot;zhuangkang&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) &quot;hello&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> srandmember key å‘½ä»¤ç”¨äºè¿”å›é›†åˆä¸­çš„ä¸€ä¸ªéšæœºå…ƒç´ ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;world&quot;</span><br><span class="line">3) &quot;hello&quot;</span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset</span><br><span class="line">&quot;hello&quot;</span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset 2</span><br><span class="line">1) &quot;world&quot;</span><br><span class="line">2) &quot;zhuangkang&quot;</span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset 2</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;hello&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> spop key ç”¨äºç§»é™¤é›†åˆä¸­çš„æŒ‡å®š key çš„ä¸€ä¸ªæˆ–å¤šä¸ªéšæœºå…ƒç´ </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) &quot;kuangshen&quot;</span><br><span class="line">2) &quot;world&quot;</span><br><span class="line">3) &quot;hello&quot;</span><br><span class="line">127.0.0.1:6379&gt; spop myset</span><br><span class="line">&quot;world&quot;</span><br><span class="line">127.0.0.1:6379&gt; spop myset</span><br><span class="line">&quot;kuangshen&quot;</span><br><span class="line">127.0.0.1:6379&gt; spop myset</span><br><span class="line">&quot;hello&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> smove SOURCE DESTINATION MEMBER</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°†æŒ‡å®šæˆå‘˜ member å…ƒç´ ä» <span class="built_in">source</span> é›†åˆç§»åŠ¨åˆ° destination é›†åˆã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; sadd myset &quot;hello&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset &quot;world&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset &quot;kuangshen&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset2 &quot;set2&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; smove myset myset2 &quot;kuangshen&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) &quot;world&quot;</span><br><span class="line">2) &quot;hello&quot;</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset2</span><br><span class="line">1) &quot;kuangshen&quot;</span><br><span class="line">2) &quot;set2&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">- æ•°å­—é›†åˆç±»</span><br><span class="line">Â - å·®é›†ï¼š sdiff</span><br><span class="line">Â - äº¤é›†ï¼š sinter</span><br><span class="line">Â - å¹¶é›†ï¼š sunion</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; sadd key1 &quot;a&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key1 &quot;b&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key1 &quot;c&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key2 &quot;c&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key2 &quot;d&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key2 &quot;e&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SDIFF key1 key2 # å·®é›†</span><br><span class="line">1) &quot;a&quot;</span><br><span class="line">2) &quot;b&quot;</span><br><span class="line">127.0.0.1:6379&gt; SINTER key1 key2 # äº¤é›†</span><br><span class="line">1) &quot;c&quot;</span><br><span class="line">127.0.0.1:6379&gt; SUNION key1 key2 # å¹¶é›†</span><br><span class="line">1) &quot;a&quot;</span><br><span class="line">2) &quot;b&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line">4) &quot;e&quot;</span><br><span class="line">5) &quot;d&quot;</span><br></pre></td></tr></table></figure>

<p>åœ¨å¾®åšåº”ç”¨ä¸­ï¼Œå¯ä»¥å°†ä¸€ä¸ªç”¨æˆ·æ‰€æœ‰çš„å…³æ³¨äººå­˜åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œå°†å…¶æ‰€æœ‰ç²‰ä¸å­˜åœ¨ä¸€ä¸ªé›†åˆã€‚Redisè¿˜ä¸ºé›†åˆæä¾›äº†æ±‚äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰æ“ä½œï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„å®ç°å¦‚å…±åŒå…³æ³¨ã€å…±åŒå–œå¥½ã€äºŒåº¦å¥½å‹ç­‰åŠŸèƒ½ï¼Œå¯¹ä¸Šé¢çš„æ‰€æœ‰é›†åˆæ“ä½œï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ä¸åŒçš„å‘½ä»¤é€‰æ‹©å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯è¿˜æ˜¯å­˜é›†åˆ°ä¸€ä¸ªæ–°çš„é›†åˆä¸­ã€‚</p>
<h3 id="3-4-Hash-é›†åˆ"><a href="#3-4-Hash-é›†åˆ" class="headerlink" title="3.4 Hash(é›†åˆ)"></a>3.4 Hash(é›†åˆ)</h3><p><strong>å¸¸ç”¨å‘½ä»¤è§£æ</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hsetã€hget å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µèµ‹å€¼ ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hmsetã€hmget åŒæ—¶å°†å¤šä¸ªfield-valueå¯¹è®¾ç½®åˆ°å“ˆå¸Œè¡¨ä¸­ã€‚ä¼šè¦†ç›–å“ˆå¸Œè¡¨ä¸­å·²å­˜åœ¨çš„å­—æ®µã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hgetall ç”¨äºè¿”å›å“ˆå¸Œè¡¨ä¸­ï¼Œæ‰€æœ‰çš„å­—æ®µå’Œå€¼ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hdel Â ç”¨äºåˆ é™¤å“ˆå¸Œè¡¨ key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šå­—æ®µ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; hset myhash field1 &quot;kuangshen&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hget myhash field1</span><br><span class="line">&quot;kuangshen&quot;</span><br><span class="line">127.0.0.1:6379&gt; HMSET myhash field1 &quot;Hello&quot; field2 &quot;World&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; HGET myhash field1</span><br><span class="line">&quot;Hello&quot;</span><br><span class="line">127.0.0.1:6379&gt; HGET myhash field2</span><br><span class="line">&quot;World&quot;</span><br><span class="line">127.0.0.1:6379&gt; hgetall myhash</span><br><span class="line">1) &quot;field1&quot;</span><br><span class="line">2) &quot;Hello&quot;</span><br><span class="line">3) &quot;field2&quot;</span><br><span class="line">4) &quot;World&quot;</span><br><span class="line">127.0.0.1:6379&gt; HDEL myhash field1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hgetall myhash</span><br><span class="line">1) &quot;field2&quot;</span><br><span class="line">2) &quot;World&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hlen è·å–å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; hlen myhash</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; HMSET myhash field1 &quot;Hello&quot; field2 &quot;World&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; hlen myhash</span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hexists æŸ¥çœ‹å“ˆå¸Œè¡¨çš„æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; hexists myhash field1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hexists myhash field3</span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hkeys è·å–å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰åŸŸï¼ˆfieldï¼‰ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hvals è¿”å›å“ˆå¸Œè¡¨æ‰€æœ‰åŸŸ(field)çš„å€¼ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; HKEYS myhash</span><br><span class="line">1) &quot;field2&quot;</span><br><span class="line">2) &quot;field1&quot;</span><br><span class="line">127.0.0.1:6379&gt; HVALS myhash</span><br><span class="line">1) &quot;World&quot;</span><br><span class="line">2) &quot;Hello&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hincrby ä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µå€¼åŠ ä¸ŠæŒ‡å®šå¢é‡å€¼ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; hset myhash field 5</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; HINCRBY myhash field 1</span><br><span class="line">(integer) 6</span><br><span class="line">127.0.0.1:6379&gt; HINCRBY myhash field -1</span><br><span class="line">(integer) 5</span><br><span class="line">127.0.0.1:6379&gt; HINCRBY myhash field -10</span><br><span class="line">(integer) -5</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> hsetnx ä¸ºå“ˆå¸Œè¡¨ä¸­ä¸å­˜åœ¨çš„çš„å­—æ®µèµ‹å€¼ ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; HSETNX myhash field1 &quot;hello&quot;</span><br><span class="line">(integer) 1 Â # è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚</span><br><span class="line">127.0.0.1:6379&gt; HSETNX myhash field1 &quot;world&quot;</span><br><span class="line">(integer) 0 Â # å¦‚æœç»™å®šå­—æ®µå·²ç»å­˜åœ¨ï¼Œè¿”å› 0 ã€‚</span><br><span class="line">127.0.0.1:6379&gt; HGET myhash field1</span><br><span class="line">&quot;hello&quot;</span><br></pre></td></tr></table></figure>

<p>Redis hashæ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚<br>å­˜å‚¨éƒ¨åˆ†å˜æ›´çš„æ•°æ®ï¼Œå¦‚ç”¨æˆ·ä¿¡æ¯ç­‰ã€‚</p>
<h3 id="3-5-Zset-é›†åˆ"><a href="#3-5-Zset-é›†åˆ" class="headerlink" title="3.5 Zset(é›†åˆ)"></a>3.5 Zset(é›†åˆ)</h3><p>åœ¨Redisä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†Setç±»å‹çœ‹ä½œä¸ºæ²¡æœ‰æ’åºçš„å­—ç¬¦ä¸²é›†åˆã€‚Setå¯åŒ…å«çš„æœ€å¤§å…ƒç´ æ•°é‡æ˜¯4294967295ã€‚Setç±»å‹åœ¨åŠŸèƒ½ä¸Šè¿˜å­˜åœ¨ç€ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œå³åœ¨æœåŠ¡å™¨ç«¯å®Œæˆå¤šä¸ªSetsä¹‹é—´çš„èšåˆè®¡ç®—æ“ä½œï¼Œå¦‚unionsã€intersectionså’Œdifferencesã€‚ç”±äºè¿™äº›æ“ä½œå‡åœ¨æœåŠ¡ç«¯å®Œæˆï¼Œå› æ­¤æ•ˆç‡æé«˜ï¼Œè€Œä¸”ä¹ŸèŠ‚çœäº†å¤§é‡çš„ç½‘ç»œIOå¼€é”€ã€‚</p>
<p><strong>å¸¸ç”¨å‘½ä»¤è§£æ</strong></p>
<p><strong>åœ¨setåŸºç¡€ä¸Šï¼ŒåŠ ä¸€ä¸ªscoreå€¼ã€‚ä¹‹å‰setæ˜¯k1 v1 v2 v3ï¼Œç°åœ¨zsetæ˜¯ k1 score1 v1 score2 v2</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zadd Â å°†ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜å…ƒç´ åŠå…¶åˆ†æ•°å€¼åŠ å…¥åˆ°æœ‰åºé›†å½“ä¸­ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zrange è¿”å›æœ‰åºé›†ä¸­ï¼ŒæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; zadd myset 1 &quot;one&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd myset 2 &quot;two&quot; 3 &quot;three&quot;</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE myset 0 -1</span><br><span class="line">1) &quot;one&quot;</span><br><span class="line">2) &quot;two&quot;</span><br><span class="line">3) &quot;three&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zrangebyscore è¿”å›æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°åŒºé—´çš„æˆå‘˜åˆ—è¡¨ã€‚æœ‰åºé›†æˆå‘˜æŒ‰åˆ†æ•°å€¼é€’å¢(ä»å°åˆ°å¤§)</span></span><br><span class="line">æ¬¡åºæ’åˆ—ã€‚</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; zadd salary 2500 xiaoming</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 5000 xiaohong</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 500 zhuangkang</span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> Infæ— ç©·å¤§é‡+âˆ,åŒæ ·åœ°,-âˆå¯ä»¥è¡¨ç¤ºä¸º-Infã€‚</span></span><br><span class="line">127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf +inf # æ˜¾ç¤ºæ•´ä¸ªæœ‰åºé›†</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;xiaoming&quot;</span><br><span class="line">3) &quot;xiaohong&quot;</span><br><span class="line">127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf +inf withscores # é€’å¢æ’åˆ—</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;500&quot;</span><br><span class="line">3) &quot;xiaoming&quot;</span><br><span class="line">4) &quot;2500&quot;</span><br><span class="line">5) &quot;xiaohong&quot;</span><br><span class="line">6) &quot;5000&quot;</span><br><span class="line">127.0.0.1:6379&gt; ZREVRANGE salary 0 -1 WITHSCORES Â # é€’å‡æ’åˆ—</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;5000&quot;</span><br><span class="line">3) &quot;xiaoming&quot;</span><br><span class="line">4) &quot;2500&quot;</span><br><span class="line">5) &quot;zhuangkang&quot;</span><br><span class="line">6) &quot;500&quot;</span><br><span class="line">127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf 2500 WITHSCORES # æ˜¾ç¤ºå·¥èµ„ &lt;=2500</span><br><span class="line">çš„æ‰€æœ‰æˆå‘˜</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;500&quot;</span><br><span class="line">3) &quot;xiaoming&quot;</span><br><span class="line">4) &quot;2500&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zrem ç§»é™¤æœ‰åºé›†ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; ZRANGE salary 0 -1</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;xiaoming&quot;</span><br><span class="line">3) &quot;xiaohong&quot;</span><br><span class="line">127.0.0.1:6379&gt; zrem salary kuangshen</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE salary 0 -1</span><br><span class="line">1) &quot;xiaoming&quot;</span><br><span class="line">2) &quot;xiaohong&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zcard Â å‘½ä»¤ç”¨äºè®¡ç®—é›†åˆä¸­å…ƒç´ çš„æ•°é‡ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; zcard salary</span><br><span class="line">(integer) 2</span><br><span class="line">OK</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zcount è®¡ç®—æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°åŒºé—´çš„æˆå‘˜æ•°é‡ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; zadd myset 1 &quot;hello&quot;</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd myset 2 &quot;world&quot; 3 &quot;zhuangkang&quot;</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; ZCOUNT myset 1 3</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; ZCOUNT myset 1 2</span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zrank è¿”å›æœ‰åºé›†ä¸­æŒ‡å®šæˆå‘˜çš„æ’åã€‚å…¶ä¸­æœ‰åºé›†æˆå‘˜æŒ‰åˆ†æ•°å€¼é€’å¢(ä»å°åˆ°å¤§)é¡ºåºæ’åˆ—ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; zadd salary 2500 xiaoming</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 5000 xiaohong</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 500 zhuangkang</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE salary 0 -1 WITHSCORES Â # æ˜¾ç¤ºæ‰€æœ‰æˆå‘˜åŠå…¶ score å€¼</span><br><span class="line">1) &quot;zhuangkang&quot;</span><br><span class="line">2) &quot;500&quot;</span><br><span class="line">3) &quot;xiaoming&quot;</span><br><span class="line">4) &quot;2500&quot;</span><br><span class="line">5) &quot;xiaohong&quot;</span><br><span class="line">6) &quot;5000&quot;</span><br><span class="line">127.0.0.1:6379&gt; zrank salary zhuangkang Â # æ˜¾ç¤º zhuangkang çš„è–ªæ°´æ’åï¼Œæœ€å°‘</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; zrank salary xiaohong Â # æ˜¾ç¤º xiaohong çš„è–ªæ°´æ’åï¼Œç¬¬ä¸‰</span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zrevrank è¿”å›æœ‰åºé›†ä¸­æˆå‘˜çš„æ’åã€‚å…¶ä¸­æœ‰åºé›†æˆå‘˜æŒ‰åˆ†æ•°å€¼é€’å‡(ä»å¤§åˆ°å°)æ’åºã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ===================================================</span></span><br><span class="line">127.0.0.1:6379&gt; ZREVRANK salary kuangshen # ç‹‚ç¥ç¬¬ä¸‰</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; ZREVRANK salary xiaohong Â # å°çº¢ç¬¬ä¸€</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>

<p>å’Œsetç›¸æ¯”ï¼Œsorted setå¢åŠ äº†ä¸€ä¸ªæƒé‡å‚æ•°scoreï¼Œä½¿å¾—é›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰scoreè¿›è¡Œæœ‰åºæ’åˆ—ï¼Œæ¯”å¦‚<br>ä¸€ä¸ªå­˜å‚¨å…¨ç­åŒå­¦æˆç»©çš„sorted setï¼Œå…¶é›†åˆvalueå¯ä»¥æ˜¯åŒå­¦çš„å­¦å·ï¼Œè€Œscoreå°±å¯ä»¥æ˜¯å…¶è€ƒè¯•å¾—åˆ†ï¼Œ<br>è¿™æ ·åœ¨æ•°æ®æ’å…¥é›†åˆçš„æ—¶å€™ï¼Œå°±å·²ç»è¿›è¡Œäº†å¤©ç„¶çš„æ’åºã€‚å¯ä»¥ç”¨sorted setæ¥åšå¸¦æƒé‡çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚æ™®é€šæ¶ˆæ¯çš„scoreä¸º1ï¼Œé‡è¦æ¶ˆæ¯çš„scoreä¸º2ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å¯ä»¥é€‰æ‹©æŒ‰scoreçš„å€’åºæ¥è·å–å·¥ä½œä»»åŠ¡ã€‚è®©é‡è¦çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œã€‚</p>
<h2 id="4-ç‰¹æ®Šæ•°æ®ç±»å‹"><a href="#4-ç‰¹æ®Šæ•°æ®ç±»å‹" class="headerlink" title="4.ç‰¹æ®Šæ•°æ®ç±»å‹"></a>4.ç‰¹æ®Šæ•°æ®ç±»å‹</h2><h3 id="4-1-GEOåœ°ç†ä½ç½®"><a href="#4-1-GEOåœ°ç†ä½ç½®" class="headerlink" title="4.1 GEOåœ°ç†ä½ç½®"></a>4.1 GEOåœ°ç†ä½ç½®</h3><blockquote>
<p>ç®€ä»‹</p>
</blockquote>
<p>Redis çš„ GEO ç‰¹æ€§åœ¨ Redis 3.2 ç‰ˆæœ¬ä¸­æ¨å‡ºï¼Œ è¿™ä¸ªåŠŸèƒ½å¯ä»¥å°†ç”¨æˆ·ç»™å®šçš„åœ°ç†ä½ç½®ä¿¡æ¯å‚¨å­˜èµ·æ¥ï¼Œ å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ“ä½œã€‚æ¥å®ç°è¯¸å¦‚é™„è¿‘ä½ç½®ã€æ‘‡ä¸€æ‘‡è¿™ç±»ä¾èµ–äºåœ°ç†ä½ç½®ä¿¡æ¯çš„åŠŸèƒ½ã€‚geoçš„æ•°æ®ç±»å‹ä¸º<strong>zset</strong>ã€‚<br>GEO çš„æ•°æ®ç»“æ„æ€»å…±æœ‰å…­ä¸ªå¸¸ç”¨å‘½ä»¤ï¼š<strong>geoaddã€geoposã€geodistã€georadiusã€georadiusbymemberã€gethash</strong></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.redis.net.cn/order/3685.html">https://www.redis.net.cn/order/3685.html</a></p>
<blockquote>
<p>geoadd</p>
</blockquote>
<p><strong>è§£æ</strong>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•</span></span><br><span class="line">geoadd key longitude latitude member ...</span><br><span class="line"><span class="comment"># å°†ç»™å®šçš„ç©ºé—´å…ƒç´ (çº¬åº¦ã€ç»åº¦ã€åå­—)æ·»åŠ åˆ°æŒ‡å®šçš„é”®é‡Œé¢ã€‚</span></span><br><span class="line"><span class="comment"># è¿™äº›æ•°æ®ä¼šä»¥æœ‰åºé›†heçš„å½¢å¼è¢«å‚¨å­˜åœ¨é”®é‡Œé¢ï¼Œä»è€Œä½¿å¾—georadiuså’Œgeoradiusbymemberè¿™æ ·çš„</span></span><br><span class="line">å‘½ä»¤å¯ä»¥åœ¨ä¹‹åé€šè¿‡ä½ç½®æŸ¥è¯¢å–å¾—è¿™äº›å…ƒç´ ã€‚</span><br><span class="line"><span class="comment"># geoaddå‘½ä»¤ä»¥æ ‡å‡†çš„x,yæ ¼å¼æ¥å—å‚æ•°,æ‰€ä»¥ç”¨æˆ·å¿…é¡»å…ˆè¾“å…¥ç»åº¦,ç„¶åå†è¾“å…¥çº¬åº¦ã€‚</span></span><br><span class="line"><span class="comment"># geoaddèƒ½å¤Ÿè®°å½•çš„åæ ‡æ˜¯æœ‰é™çš„:éå¸¸æ¥è¿‘ä¸¤æçš„åŒºåŸŸæ— æ³•è¢«ç´¢å¼•ã€‚</span></span><br><span class="line"><span class="comment"># æœ‰æ•ˆçš„ç»åº¦ä»‹äº-180-180åº¦ä¹‹é—´ï¼Œæœ‰æ•ˆçš„çº¬åº¦ä»‹äº-85.05112878 åº¦è‡³ 85.05112878 åº¦ä¹‹é—´ã€‚ï¼Œ</span></span><br><span class="line">å½“ç”¨æˆ·å°è¯•è¾“å…¥ä¸€ä¸ªè¶…å‡ºèŒƒå›´çš„ç»åº¦æˆ–è€…çº¬åº¦æ—¶,geoaddå‘½ä»¤å°†è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•æ¨¡æ‹ŸçœŸå®ç»çº¬åº¦(æ•°æ®æ¥æºï¼šç™¾åº¦)</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geoadd china:city 116.23 40.22 åŒ—äº¬</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 121.48 31.40 ä¸Šæµ· 113.88 22.55 æ·±åœ³ 120.21</span><br><span class="line">30.20 æ­å·</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 106.54 29.40 é‡åº† 108.93 34.23 è¥¿å®‰ 114.02</span><br><span class="line">30.58 æ­¦æ±‰</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure>

<blockquote>
<p>geopos</p>
</blockquote>
<p><strong>è§£æï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•</span></span><br><span class="line">geopos key member [member...]</span><br><span class="line"><span class="comment">#ä»keyé‡Œè¿”å›æ‰€æœ‰ç»™å®šä½ç½®å…ƒç´ çš„ä½ç½®ï¼ˆç»åº¦å’Œçº¬åº¦ï¼‰</span></span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geopos china:city åŒ—äº¬</span><br><span class="line">1) 1) <span class="string">&quot;116.23000055551528931&quot;</span></span><br><span class="line">Â 2) <span class="string">&quot;40.2200010338739844&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; geopos china:city ä¸Šæµ· é‡åº†</span><br><span class="line">1) 1) <span class="string">&quot;121.48000091314315796&quot;</span></span><br><span class="line">Â 2) <span class="string">&quot;31.40000025319353938&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;106.54000014066696167&quot;</span></span><br><span class="line">Â 2) <span class="string">&quot;29.39999880018641676&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; geopos china:city æ–°ç–†</span><br><span class="line">1) (nil)</span><br></pre></td></tr></table></figure>



<blockquote>
<p>geodist</p>
</blockquote>
<p><strong>è§£æï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•</span></span><br><span class="line">geodist key member1 member2 [unit]</span><br><span class="line"><span class="comment"># è¿”å›ä¸¤ä¸ªç»™å®šä½ç½®ä¹‹é—´çš„è·ç¦»ï¼Œå¦‚æœä¸¤ä¸ªä½ç½®ä¹‹é—´çš„å…¶ä¸­ä¸€ä¸ªä¸å­˜åœ¨,é‚£ä¹ˆå‘½ä»¤è¿”å›ç©ºå€¼ã€‚</span></span><br><span class="line"><span class="comment"># æŒ‡å®šå•ä½çš„å‚æ•°unitå¿…é¡»æ˜¯ä»¥ä¸‹å•ä½çš„å…¶ä¸­ä¸€ä¸ªï¼š</span></span><br><span class="line"><span class="comment"># Â mè¡¨ç¤ºå•ä½ä¸ºç±³</span></span><br><span class="line"><span class="comment"># Â kmè¡¨ç¤ºå•ä½ä¸ºåƒç±³</span></span><br><span class="line"><span class="comment"># Â miè¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œ</span></span><br><span class="line"><span class="comment"># Â ftè¡¨ç¤ºå•ä½ä¸ºè‹±å°º</span></span><br><span class="line"><span class="comment"># Â å¦‚æœç”¨æˆ·æ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šå•ä½å‚æ•°,é‚£ä¹ˆgeodisté»˜è®¤ä½¿ç”¨ç±³ä½œä¸ºå•ä½ã€‚</span></span><br><span class="line"><span class="comment">#geodistå‘½ä»¤åœ¨è®¡ç®—è·ç¦»æ—¶ä¼šå‡è®¾åœ°çƒä¸ºå®Œç¾çš„çƒå½¢,åœ¨æé™æƒ…å†µä¸‹,è¿™ä¸€å‡è®¾æœ€å¤§ä¼šé€ æˆ0.5%çš„è¯¯</span></span><br><span class="line">å·®ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geodist china:city åŒ—äº¬ ä¸Šæµ·</span><br><span class="line"><span class="string">&quot;1088785.4302&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; geodist china:city åŒ—äº¬ ä¸Šæµ· km</span><br><span class="line"><span class="string">&quot;1088.7854&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; geodist china:city é‡åº† åŒ—äº¬ km</span><br><span class="line"><span class="string">&quot;1491.6716&quot;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>georadius</p>
</blockquote>
<p><strong>è§£æï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•</span></span><br><span class="line">georadius key longitude latitude radius m|km|ft|mi [withcoord][withdist][withhash][asc|desc][count count]</span><br><span class="line"><span class="comment"># ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ </span></span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•ï¼šé‡æ–°è¿æ¥ redis-cliï¼Œå¢åŠ å‚æ•° â€“raw ï¼Œå¯ä»¥å¼ºåˆ¶è¾“å‡ºä¸­æ–‡ï¼Œä¸ç„¶ä¼šä¹±ç </strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@zhuangkang bin]<span class="comment"># redis-cli --raw -p 6379</span></span><br><span class="line"><span class="comment"># åœ¨ china:city ä¸­å¯»æ‰¾åæ ‡ 100 30 åŠå¾„ä¸º 1000km çš„åŸå¸‚</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 100 30 1000 km</span><br><span class="line">é‡åº†</span><br><span class="line">è¥¿å®‰</span><br><span class="line"><span class="comment"># withdist è¿”å›ä½ç½®åç§°å’Œä¸­å¿ƒè·ç¦»</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 100 30 1000 km withdist</span><br><span class="line">é‡åº†</span><br><span class="line">635.2850</span><br><span class="line">è¥¿å®‰</span><br><span class="line">963.3171</span><br><span class="line"><span class="comment"># withcoord è¿”å›ä½ç½®åç§°å’Œç»çº¬åº¦</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 100 30 1000 km withcoord</span><br><span class="line">é‡åº†</span><br><span class="line">106.54000014066696167</span><br><span class="line">29.39999880018641676</span><br><span class="line">è¥¿å®‰</span><br><span class="line">108.92999857664108276</span><br><span class="line">34.23000121926852302</span><br><span class="line"><span class="comment"># withdist withcoord è¿”å›ä½ç½®åç§° è·ç¦» å’Œç»çº¬åº¦ count é™å®šå¯»æ‰¾ä¸ªæ•°</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 100 30 1000 km withcoord withdist count</span><br><span class="line">1</span><br><span class="line">é‡åº†</span><br><span class="line">635.2850</span><br><span class="line">106.54000014066696167</span><br><span class="line">29.39999880018641676</span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 100 30 1000 km withcoord withdist count</span><br><span class="line">2</span><br><span class="line">é‡åº†</span><br><span class="line">635.2850</span><br><span class="line">106.54000014066696167</span><br><span class="line">29.39999880018641676</span><br><span class="line">è¥¿å®‰</span><br><span class="line">963.3171</span><br><span class="line">108.92999857664108276</span><br><span class="line">34.23000121926852302</span><br></pre></td></tr></table></figure>



<blockquote>
<p>georadiusbymember</p>
</blockquote>
<p><strong>è§£æï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•</span></span><br><span class="line">georadiusbymember key member radius m|km|ft|mi [withcoord][withdist][withhash][asc|desc][count count]</span><br><span class="line"><span class="comment"># æ‰¾å‡ºä½äºæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼Œä¸­å¿ƒç‚¹æ˜¯ç”±ç»™å®šçš„ä½ç½®å…ƒç´ å†³å®š</span></span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city åŒ—äº¬ 1000 km</span><br><span class="line">åŒ—äº¬</span><br><span class="line">è¥¿å®‰</span><br><span class="line">127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city ä¸Šæµ· 400 km</span><br><span class="line">æ­å·</span><br><span class="line">ä¸Šæµ·</span><br></pre></td></tr></table></figure>



<blockquote>
<p>geohash</p>
</blockquote>
<p><strong>è§£æï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•</span></span><br><span class="line">geohash key member [member...]</span><br><span class="line"><span class="comment"># Redisä½¿ç”¨geohashå°†äºŒç»´ç»çº¬åº¦è½¬æ¢ä¸ºä¸€ç»´å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²è¶Šé•¿è¡¨ç¤ºä½ç½®æ›´ç²¾ç¡®,ä¸¤ä¸ªå­—ç¬¦ä¸²è¶Šç›¸ä¼¼è¡¨ç¤ºè·ç¦»è¶Šè¿‘ã€‚</span></span><br></pre></td></tr></table></figure>



<h3 id="4-2-HyperLogLog"><a href="#4-2-HyperLogLog" class="headerlink" title="4.2 HyperLogLog"></a>4.2 HyperLogLog</h3><p>Redis åœ¨ 2.8.9 ç‰ˆæœ¬æ·»åŠ äº† HyperLogLog ç»“æ„ã€‚<br>Redis HyperLogLog æ˜¯ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ŒHyperLogLog çš„ä¼˜ç‚¹æ˜¯ï¼Œåœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯<br>éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®š çš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚<br>åœ¨ Redis é‡Œé¢ï¼Œæ¯ä¸ª HyperLogLog é”®åªéœ€è¦èŠ±è´¹ 12 KB å†…å­˜ï¼Œå°±å¯ä»¥è®¡ç®—æ¥è¿‘ 2^64 ä¸ªä¸åŒå…ƒç´ çš„åŸº<br>æ•°ã€‚è¿™å’Œè®¡ç®—åŸºæ•°æ—¶ï¼Œå…ƒç´ è¶Šå¤šè€—è´¹å†…å­˜å°±è¶Šå¤šçš„é›†åˆå½¢æˆé²œæ˜å¯¹æ¯”ã€‚<br>HyperLogLogåˆ™æ˜¯ä¸€ç§ç®—æ³•ï¼Œå®ƒæä¾›äº†ä¸ç²¾ç¡®çš„å»é‡è®¡æ•°æ–¹æ¡ˆã€‚<br>ä¸¾ä¸ªæ —å­ï¼šå‡å¦‚æˆ‘è¦ç»Ÿè®¡ç½‘é¡µçš„UVï¼ˆæµè§ˆç”¨æˆ·æ•°é‡ï¼Œä¸€å¤©å†…åŒä¸€ä¸ªç”¨æˆ·å¤šæ¬¡è®¿é—®åªèƒ½ç®—ä¸€æ¬¡ï¼‰ï¼Œä¼ ç»Ÿçš„<br>è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨Setæ¥ä¿å­˜ç”¨æˆ·idï¼Œç„¶åç»Ÿè®¡Setä¸­çš„å…ƒç´ æ•°é‡æ¥è·å–é¡µé¢UVã€‚ä½†è¿™ç§æ–¹æ¡ˆåªèƒ½æ‰¿è½½å°‘é‡<br>ç”¨æˆ·ï¼Œä¸€æ—¦ç”¨æˆ·æ•°é‡å¤§èµ·æ¥å°±éœ€è¦æ¶ˆè€—å¤§é‡çš„ç©ºé—´æ¥å­˜å‚¨ç”¨æˆ·idã€‚æˆ‘çš„ç›®çš„æ˜¯ç»Ÿè®¡ç”¨æˆ·æ•°é‡è€Œä¸æ˜¯ä¿å­˜<br>ç”¨æˆ·ï¼Œè¿™ç®€ç›´æ˜¯ä¸ªåƒåŠ›ä¸è®¨å¥½çš„æ–¹æ¡ˆï¼è€Œä½¿ç”¨Redisçš„HyperLogLogæœ€å¤šéœ€è¦12kå°±å¯ä»¥ç»Ÿè®¡å¤§é‡çš„ç”¨æˆ·<br>æ•°ï¼Œå°½ç®¡å®ƒå¤§æ¦‚æœ‰0.81%çš„é”™è¯¯ç‡ï¼Œä½†å¯¹äºç»Ÿè®¡UVè¿™ç§ä¸éœ€è¦å¾ˆç²¾ç¡®çš„æ•°æ®æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚</p>
<blockquote>
<p><strong>ä»€ä¹ˆæ˜¯åŸºæ•°</strong></p>
</blockquote>
<p>æ¯”å¦‚æ•°æ®é›† {1, 3, 5, 7, 5, 7, 8}ï¼Œ é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†çš„åŸºæ•°é›†ä¸º {1, 3, 5 ,7, 8}, åŸºæ•°(ä¸é‡å¤å…ƒç´ )ä¸º5ã€‚<br>åŸºæ•°ä¼°è®¡å°±æ˜¯åœ¨è¯¯å·®å¯æ¥å—çš„èŒƒå›´å†…ï¼Œå¿«é€Ÿè®¡ç®—åŸºæ•°ã€‚</p>
<p><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[PFADD key element [element ...]  <span class="comment"># æ·»åŠ æŒ‡å®šå…ƒç´ åˆ° HyperLogLog ä¸­ã€‚</span></span><br><span class="line">[PFCOUNT key [key ...] <span class="comment"># è¿”å›ç»™å®š HyperLogLog çš„åŸºæ•°ä¼°ç®—å€¼ã€‚</span></span><br><span class="line">[PFMERGE destkey sourcekey[sourcekey ...] <span class="comment"># å°†å¤šä¸ª HyperLogLog åˆå¹¶ä¸ºä¸€ä¸ª HyperLogLogï¼Œå¹¶é›†è®¡ç®—</span></span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PFADD mykey a b c d e f g h i j</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey</span><br><span class="line">10</span><br><span class="line">127.0.0.1:6379&gt; PFADD mykey2 i j z x c v b n m</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; PFMERGE mykey3 mykey mykey2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey3</span><br><span class="line">15</span><br></pre></td></tr></table></figure>

<h2 id="5-Redisé…ç½®æ–‡ä»¶è§£æ"><a href="#5-Redisé…ç½®æ–‡ä»¶è§£æ" class="headerlink" title="5.Redisé…ç½®æ–‡ä»¶è§£æ"></a>5.Redisé…ç½®æ–‡ä»¶è§£æ</h2><h3 id="5-1-ç†Ÿæ‚‰åŸºæœ¬é…ç½®"><a href="#5-1-ç†Ÿæ‚‰åŸºæœ¬é…ç½®" class="headerlink" title="5.1 ç†Ÿæ‚‰åŸºæœ¬é…ç½®"></a>5.1 ç†Ÿæ‚‰åŸºæœ¬é…ç½®</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312202909307.png" alt="image-20210312202909307"></p>
<p>1ã€é…ç½®å¤§å°å•ä½ï¼Œå¼€å¤´å®šä¹‰äº†ä¸€äº›åŸºæœ¬çš„åº¦é‡å•ä½ï¼Œåªæ”¯æŒbytesï¼Œä¸æ”¯æŒbit<br>2ã€å¯¹ å¤§å°å†™ ä¸æ•æ„Ÿ</p>
<blockquote>
<p>INCLUDE</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312202936947.png" alt="image-20210312202936947"></p>
<blockquote>
<p>NETWORKç½‘ç»œé…ç½®</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">bind</span> 127.0.0.1 Â Â Â <span class="comment"># ç»‘å®šçš„ip</span></span><br><span class="line">protected-mode yes Â <span class="comment"># ä¿æŠ¤æ¨¡å¼</span></span><br><span class="line">port 6379 Â Â Â Â Â <span class="comment"># é»˜è®¤ç«¯å£</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>GENERAL</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">daemonize yes Â <span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedisä¸ä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œã€‚éœ€è¦å¼€å¯çš„è¯ï¼Œæ”¹ä¸º yes</span></span><br><span class="line">supervised no Â <span class="comment"># å¯é€šè¿‡upstartå’Œsystemdç®¡ç†Rediså®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">pidfile /var/run/redis_6379.pid Â <span class="comment"># ä»¥åå°è¿›ç¨‹æ–¹å¼è¿è¡Œredisï¼Œåˆ™éœ€è¦æŒ‡å®špid æ–‡ä»¶</span></span><br><span class="line">loglevel notice <span class="comment"># æ—¥å¿—çº§åˆ«ã€‚å¯é€‰é¡¹æœ‰ï¼š</span></span><br><span class="line"><span class="comment"># debugï¼ˆè®°å½•å¤§é‡æ—¥å¿—ä¿¡æ¯ï¼Œé€‚ç”¨äºå¼€å‘ã€æµ‹è¯•é˜¶æ®µï¼‰ï¼› </span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment"># verboseï¼ˆè¾ƒå¤šæ—¥å¿—ä¿¡æ¯ï¼‰ï¼› </span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment"># noticeï¼ˆé€‚é‡æ—¥å¿—ä¿¡æ¯ï¼Œä½¿ç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰ï¼›</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment"># warningï¼ˆä»…æœ‰éƒ¨åˆ†é‡è¦ã€å…³é”®ä¿¡æ¯æ‰ä¼šè¢«è®°å½•ï¼‰ã€‚</span></span><br><span class="line">logfile <span class="string">&quot;&quot;</span> Â Â Â <span class="comment"># æ—¥å¿—æ–‡ä»¶çš„ä½ç½®ï¼Œå½“æŒ‡å®šä¸ºç©ºå­—ç¬¦ä¸²æ—¶ï¼Œä¸ºæ ‡å‡†è¾“å‡º</span></span><br><span class="line">databases 16 Â Â <span class="comment"># è®¾ç½®æ•°æ®åº“çš„æ•°ç›®ã€‚é»˜è®¤çš„æ•°æ®åº“æ˜¯DB 0</span></span><br><span class="line">always-show-logo yes Â <span class="comment"># æ˜¯å¦æ€»æ˜¯æ˜¾ç¤ºlogo</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>SNAPSHOPTING å¿«ç…§</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 900ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…è‡³å°‘1ä¸ªkeyå€¼æ”¹å˜ï¼ˆåˆ™è¿›è¡Œæ•°æ®åº“ä¿å­˜--æŒä¹…åŒ–ï¼‰</span></span><br><span class="line">save 900 1</span><br><span class="line"><span class="comment"># 300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…è‡³å°‘10ä¸ªkeyå€¼æ”¹å˜ï¼ˆåˆ™è¿›è¡Œæ•°æ®åº“ä¿å­˜--æŒä¹…åŒ–ï¼‰</span></span><br><span class="line">save 300 10</span><br><span class="line"><span class="comment"># 60ç§’ï¼ˆ1åˆ†é’Ÿï¼‰å†…è‡³å°‘10000ä¸ªkeyå€¼æ”¹å˜ï¼ˆåˆ™è¿›è¡Œæ•°æ®åº“ä¿å­˜--æŒä¹…åŒ–ï¼‰</span></span><br><span class="line">save 60 10000</span><br><span class="line">stop-writes-on-bgsave-error yes Â <span class="comment"># æŒä¹…åŒ–å‡ºç°é”™è¯¯åï¼Œæ˜¯å¦ä¾ç„¶è¿›è¡Œç»§ç»­è¿›è¡Œå·¥ä½œ</span></span><br><span class="line">rdbcompression yes Â <span class="comment"># ä½¿ç”¨å‹ç¼©rdbæ–‡ä»¶ yesï¼šå‹ç¼©ï¼Œä½†æ˜¯éœ€è¦ä¸€äº›cpuçš„æ¶ˆè€—ã€‚noï¼šä¸å‹</span></span><br><span class="line">ç¼©ï¼Œéœ€è¦æ›´å¤šçš„ç£ç›˜ç©ºé—´</span><br><span class="line">rdbchecksum yes Â Â Â <span class="comment"># æ˜¯å¦æ ¡éªŒrdbæ–‡ä»¶ï¼Œæ›´æœ‰åˆ©äºæ–‡ä»¶çš„å®¹é”™æ€§ï¼Œä½†æ˜¯åœ¨ä¿å­˜rdbæ–‡ä»¶çš„æ—¶</span></span><br><span class="line">å€™ï¼Œä¼šæœ‰å¤§æ¦‚10%çš„æ€§èƒ½æŸè€—</span><br><span class="line">dbfilename dump.rdb Â <span class="comment"># dbfilenamerdbæ–‡ä»¶åç§°</span></span><br><span class="line">dir ./ Â Â <span class="comment"># dir æ•°æ®ç›®å½•ï¼Œæ•°æ®åº“çš„å†™å…¥ä¼šåœ¨è¿™ä¸ªç›®å½•ã€‚rdbã€aofæ–‡ä»¶ä¹Ÿä¼šå†™åœ¨è¿™ä¸ªç›®å½•</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>SECURITYå®‰å…¨</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨redis</span></span><br><span class="line"><span class="comment"># è¿æ¥å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment"># è·å¾—å’Œè®¾ç½®å¯†ç </span></span><br><span class="line">config get requirepass</span><br><span class="line">config <span class="built_in">set</span> requirepass <span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="comment">#æµ‹è¯•pingï¼Œå‘ç°éœ€è¦éªŒè¯</span></span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">NOAUTH Authentication required.</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">127.0.0.1:6379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é™åˆ¶</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maxclients 10000 Â <span class="comment"># è®¾ç½®èƒ½è¿ä¸Šredisçš„æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°é‡</span></span><br><span class="line">maxmemory &lt;bytes&gt; Â <span class="comment"># redisé…ç½®çš„æœ€å¤§å†…å­˜å®¹é‡</span></span><br><span class="line">maxmemory-policy noeviction Â <span class="comment"># maxmemory-policy å†…å­˜è¾¾åˆ°ä¸Šé™çš„å¤„ç†ç­–ç•¥</span></span><br><span class="line">Â Â Â Â <span class="comment">#volatile-lruï¼šåˆ©ç”¨LRUç®—æ³•ç§»é™¤è®¾ç½®è¿‡è¿‡æœŸæ—¶é—´çš„keyã€‚</span></span><br><span class="line">Â Â Â Â <span class="comment">#volatile-randomï¼šéšæœºç§»é™¤è®¾ç½®è¿‡è¿‡æœŸæ—¶é—´çš„keyã€‚</span></span><br><span class="line">Â Â Â Â <span class="comment">#volatile-ttlï¼šç§»é™¤å³å°†è¿‡æœŸçš„keyï¼Œæ ¹æ®æœ€è¿‘è¿‡æœŸæ—¶é—´æ¥åˆ é™¤ï¼ˆè¾…ä»¥TTLï¼‰</span></span><br><span class="line">Â Â Â Â <span class="comment">#allkeys-lruï¼šåˆ©ç”¨LRUç®—æ³•ç§»é™¤ä»»ä½•keyã€‚</span></span><br><span class="line">Â Â Â Â <span class="comment">#allkeys-randomï¼šéšæœºç§»é™¤ä»»ä½•keyã€‚</span></span><br><span class="line">Â Â Â Â <span class="comment">#noevictionï¼šä¸ç§»é™¤ä»»ä½•keyï¼Œåªæ˜¯è¿”å›ä¸€ä¸ªå†™é”™è¯¯ã€‚</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>append onlyæ¨¡å¼</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">appendonly no Â <span class="comment"># æ˜¯å¦ä»¥append onlyæ¨¡å¼ä½œä¸ºæŒä¹…åŒ–æ–¹å¼ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯rdbæ–¹å¼æŒä¹…åŒ–ï¼Œè¿™ç§</span></span><br><span class="line">æ–¹å¼åœ¨è®¸å¤šåº”ç”¨ä¸­å·²ç»è¶³å¤Ÿç”¨äº†</span><br><span class="line">appendfilename <span class="string">&quot;appendonly.aof&quot;</span> Â <span class="comment"># appendfilename AOF æ–‡ä»¶åç§°</span></span><br><span class="line">appendfsync everysec Â <span class="comment"># appendfsync aofæŒä¹…åŒ–ç­–ç•¥çš„é…ç½®</span></span><br><span class="line">Â Â <span class="comment"># noè¡¨ç¤ºä¸æ‰§è¡Œfsyncï¼Œç”±æ“ä½œç³»ç»Ÿä¿è¯æ•°æ®åŒæ­¥åˆ°ç£ç›˜ï¼Œé€Ÿåº¦æœ€å¿«ã€‚</span></span><br><span class="line">Â Â <span class="comment"># alwaysè¡¨ç¤ºæ¯æ¬¡å†™å…¥éƒ½æ‰§è¡Œfsyncï¼Œä»¥ä¿è¯æ•°æ®åŒæ­¥åˆ°ç£ç›˜ã€‚</span></span><br><span class="line">Â Â <span class="comment"># everysecè¡¨ç¤ºæ¯ç§’æ‰§è¡Œä¸€æ¬¡fsyncï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸¢å¤±è¿™1sæ•°æ®ã€‚</span></span><br></pre></td></tr></table></figure>



<h3 id="5-2-å¸¸è§é…ç½®ä»‹ç»"><a href="#5-2-å¸¸è§é…ç½®ä»‹ç»" class="headerlink" title="5.2 å¸¸è§é…ç½®ä»‹ç»"></a>5.2 å¸¸è§é…ç½®ä»‹ç»</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1ã€Redisé»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨yeså¯ç”¨å®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">	daemonize no </span><br><span class="line"><span class="comment">#2ã€å½“Redisä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶ï¼ŒRedisé»˜è®¤ä¼šæŠŠpidå†™å…¥/var/run/redis.pidæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡pidfileæŒ‡å®š</span></span><br><span class="line">	pidfile /var/run/redis.pid	</span><br><span class="line"><span class="comment">#3ã€æŒ‡å®šRedisç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º6379</span></span><br><span class="line">	port 6379</span><br><span class="line"><span class="comment">#4ã€ç»‘å®šçš„ä¸»æœºåœ°å€</span></span><br><span class="line">	<span class="built_in">bind</span> 127.0.0.1</span><br><span class="line"><span class="comment">#5ã€å½“ å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½</span></span><br><span class="line">	timeout300</span><br><span class="line"><span class="comment">#6ã€æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedisæ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸ºverbose</span></span><br><span class="line">	loglevel verbose</span><br><span class="line"><span class="comment">#7ã€æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æœé…ç½®Redisä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ—¥å¿—è®°å½•æ–¹å¼ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šç»™/dev/null</span></span><br><span class="line">	logfile stdout</span><br><span class="line"><span class="comment">#8ã€è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨SELECT å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id</span></span><br><span class="line">	databases 16</span><br><span class="line"><span class="comment">#9ã€æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ</span></span><br><span class="line">	save</span><br><span class="line">	Redisé»˜è®¤é…ç½®æ–‡ä»¶ä¸­æä¾›äº†ä¸‰ä¸ªæ¡ä»¶ï¼š</span><br><span class="line">	save 900 1</span><br><span class="line">	save 300 10</span><br><span class="line">	save 60 10000</span><br><span class="line">	åˆ†åˆ«è¡¨ç¤º900ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…æœ‰1ä¸ªæ›´æ”¹ï¼Œ300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…æœ‰10ä¸ªæ›´æ”¹ä»¥åŠ60ç§’å†…æœ‰10000ä¸ªæ›´æ”¹</span><br><span class="line"><span class="comment">#10ã€æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyesï¼ŒRedisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§</span></span><br><span class="line">	rdbcompression yes</span><br><span class="line"><span class="comment">#11ã€æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºdump.rdb</span></span><br><span class="line">	dbfilename dump.rdb</span><br><span class="line"><span class="comment">#12ã€æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•</span></span><br><span class="line">	dir ./</span><br><span class="line"><span class="comment">#13ã€è®¾ç½®å½“æœ¬æœºä¸ºslavæœåŠ¡æ—¶ï¼Œè®¾ç½®masteræœåŠ¡çš„IPåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥</span></span><br><span class="line">	slaveof</span><br><span class="line"><span class="comment">#14ã€å½“masteræœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼ŒslavæœåŠ¡è¿æ¥masterçš„å¯†ç </span></span><br><span class="line">	masterauth</span><br><span class="line"><span class="comment">#15ã€è®¾ç½®Redisè¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥Redisæ—¶éœ€è¦é€šè¿‡AUTH å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­</span></span><br><span class="line">	requirepass foobared</span><br><span class="line"><span class="comment">#16ã€è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRediså¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸ºRedisè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œå¦‚æœè®¾ç½® maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚</span></span><br><span class="line">	maxclients 128</span><br><span class="line"><span class="comment">#17ã€æŒ‡å®šRedisæœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedisåœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedisä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„Keyï¼Œå½“æ­¤æ–¹æ³•å¤„ç† åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚Redisæ–°çš„vmæœºåˆ¶ï¼Œä¼šæŠŠKeyå­˜æ”¾å†…å­˜ï¼ŒValueä¼šå­˜æ”¾åœ¨swapåŒº</span></span><br><span class="line">	maxmemory</span><br><span class="line"><span class="comment">#18ã€æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼ŒRedisåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚</span></span><br><span class="line">	appendonly no</span><br><span class="line"><span class="comment">#19ã€æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºappendonly.aof</span></span><br><span class="line">	appendfilename appendonly.aof	</span><br><span class="line"><span class="comment">#20ã€æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰3ä¸ªå¯é€‰å€¼ï¼š</span></span><br><span class="line">	noï¼šè¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰</span><br><span class="line">	alwaysï¼šè¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰</span><br><span class="line">	everysecï¼šè¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜è¡·ï¼Œé»˜è®¤å€¼ï¼‰</span><br><span class="line">	appendfsync everysec</span><br><span class="line"><span class="comment">#21ã€æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸ºno</span></span><br><span class="line">	vm-enabled no</span><br><span class="line"><span class="comment">#22ã€è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/tmp/redis.swapï¼Œä¸å¯å¤šä¸ªRediså®ä¾‹å…±äº«</span></span><br><span class="line">	vm-swap-file /tmp/redis.swap</span><br><span class="line"><span class="comment">#23ã€å°†æ‰€æœ‰å¤§äºvm-max-memoryçš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜,æ— è®ºvm-max-memoryè®¾ç½®å¤šå°,æ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„(Redisçš„ç´¢å¼•æ•°æ® å°±æ˜¯keys),ä¹Ÿå°±æ˜¯è¯´,å½“vm-max-memoryè®¾ç½®ä¸º0çš„æ—¶å€™,å…¶å®æ˜¯æ‰€æœ‰valueéƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤å€¼ä¸º0</span></span><br><span class="line">	vm-max-memory 0</span><br><span class="line"><span class="comment">#24ã€Redis swapæ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ªpageä¸Šé¢ï¼Œä½†ä¸€ä¸ªpageä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº«ï¼Œvm-page-sizeæ˜¯è¦æ ¹æ®å­˜å‚¨çš„ æ•°æ®å¤§å°æ¥è®¾å®šçš„</span></span><br><span class="line">	vm-page-size 32</span><br><span class="line"><span class="comment">#25ã€è®¾ç½®swapæ–‡ä»¶ä¸­çš„pageæ•°é‡ï¼Œç”±äºé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„bitmapï¼‰æ˜¯åœ¨æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œåœ¨ç£ç›˜ä¸Šæ¯8ä¸ªpageså°†æ¶ˆè€—1byteçš„å†…å­˜ã€‚</span></span><br><span class="line">	vm-pages 134217728</span><br><span class="line"><span class="comment">#26ã€è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„çº¿ç¨‹æ•°,æœ€å¥½ä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°,å¦‚æœè®¾ç½®ä¸º0,é‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿã€‚é»˜è®¤å€¼ä¸º4</span></span><br><span class="line">	vm-max-threads 4</span><br><span class="line"><span class="comment">#27ã€è®¾ç½®åœ¨å‘å®¢æˆ·ç«¯åº”ç­”æ—¶ï¼Œæ˜¯å¦æŠŠè¾ƒå°çš„åŒ…åˆå¹¶ä¸ºä¸€ä¸ªåŒ…å‘é€ï¼Œé»˜è®¤ä¸ºå¼€å¯</span></span><br><span class="line">	glueoutputbuf yes</span><br><span class="line"><span class="comment">#28ã€æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³•	</span></span><br><span class="line">	hash-max-zipmap-entries 64</span><br><span class="line">	hash-max-zipmap-value 512</span><br><span class="line"><span class="comment">#29ã€æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯</span></span><br><span class="line">	activerehashing yes</span><br><span class="line"><span class="comment">#30ã€æŒ‡å®šåŒ…å«å…¶å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ªRediså®ä¾‹ä¹‹é—´ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€ŒåŒæ—¶å„ä¸ªå®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶</span></span><br><span class="line">	include /path/to/local.conf</span><br></pre></td></tr></table></figure>



<h2 id="6-åˆ é™¤ç­–ç•¥"><a href="#6-åˆ é™¤ç­–ç•¥" class="headerlink" title="6.åˆ é™¤ç­–ç•¥"></a>6.åˆ é™¤ç­–ç•¥</h2><h3 id="6-1-Redisä¸­çš„æ•°æ®ç‰¹å¾"><a href="#6-1-Redisä¸­çš„æ•°æ®ç‰¹å¾" class="headerlink" title="6.1 Redisä¸­çš„æ•°æ®ç‰¹å¾"></a>6.1 Redisä¸­çš„æ•°æ®ç‰¹å¾</h3><ul>
<li><p> Redisæ˜¯ä¸€ç§å†…å­˜çº§æ•°æ®åº“ï¼Œæ‰€æœ‰æ•°æ®å‡å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜ä¸­çš„æ•°æ®å¯ä»¥é€šè¿‡TTLæŒ‡ä»¤è·å–å…¶çŠ¶æ€</p>
</li>
<li><p> XX ï¼šå…·æœ‰æ—¶æ•ˆæ€§çš„æ•°æ®</p>
</li>
<li><p>-1 ï¼šæ°¸ä¹…æœ‰æ•ˆçš„æ•°æ®</p>
</li>
<li><p>-2 ï¼šå·²ç»è¿‡æœŸçš„æ•°æ® æˆ– è¢«åˆ é™¤çš„æ•°æ® æˆ– æœªå®šä¹‰çš„æ•°æ®</p>
</li>
</ul>
<h3 id="6-2-æ•°æ®åˆ é™¤ç­–ç•¥"><a href="#6-2-æ•°æ®åˆ é™¤ç­–ç•¥" class="headerlink" title="6.2 æ•°æ®åˆ é™¤ç­–ç•¥"></a>6.2 æ•°æ®åˆ é™¤ç­–ç•¥</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312210918949.png" alt="image-20210312210918949"> </p>
<p><strong>ç›®æ ‡ï¼š</strong>åœ¨å†…å­˜å ç”¨ä¸CPUå ç”¨ä¹‹é—´å¯»æ‰¾ä¸€ç§å¹³è¡¡ï¼Œé¡¾æ­¤å¤±å½¼éƒ½ä¼šé€ æˆæ•´ä½“redisæ€§èƒ½çš„ä¸‹é™ï¼Œç”šè‡³å¼•å‘æœåŠ¡å™¨å®•æœºæˆ–<br>å†…å­˜æ³„éœ²</p>
<h4 id="6-2-1-å®šæ—¶åˆ é™¤"><a href="#6-2-1-å®šæ—¶åˆ é™¤" class="headerlink" title="6.2.1 å®šæ—¶åˆ é™¤"></a>6.2.1 å®šæ—¶åˆ é™¤</h4><ul>
<li><p>åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œå½“KEYè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¸”è¿‡æœŸæ—¶é—´åˆ°è¾¾æ—¶ï¼Œæœ‰å®šæ—¶å™¨ç«‹å³æ‰§è¡Œå¯¹é”®çš„åˆ é™¤</p>
</li>
<li><p><strong>ä¼˜ç‚¹ï¼šèŠ‚çº¦å†…å­˜ï¼Œå¿«é€Ÿé‡Šæ”¾ä¸å¿…è¦çš„å†…å­˜å ç”¨</strong></p>
</li>
<li><p>ç¼ºç‚¹ï¼šCPUå‹åŠ›å¤§ï¼Œå ç”¨CPUï¼Œå½±å“RedisæœåŠ¡å™¨å“åº”æ—¶é—´</p>
</li>
<li><p>æ€»ç»“ï¼šç”¨å¤„ç†å™¨æ€§èƒ½æ¢å–å­˜å‚¨ç©ºé—´ ï¼ˆæ‹¿æ—¶é—´æ¢ç©ºé—´ï¼‰</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312211240858.png" alt="image-20210312211240858"></p>
<h4 id="6-2-2-æƒ°æ€§åˆ é™¤ç­–ç•¥"><a href="#6-2-2-æƒ°æ€§åˆ é™¤ç­–ç•¥" class="headerlink" title="6.2.2 æƒ°æ€§åˆ é™¤ç­–ç•¥"></a>6.2.2 æƒ°æ€§åˆ é™¤ç­–ç•¥</h4><ul>
<li><p>æ•°æ®åˆ°è¾¾è¿‡æœŸæ—¶é—´ï¼Œä¸åšå¤„ç†ã€‚ç­‰ä¸‹æ¬¡è®¿é—®è¯¥æ•°æ®æ—¶</p>
<ul>
<li>å¦‚æœæœªè¿‡æœŸï¼Œè¿”å›æ•°æ®</li>
<li> å‘ç°å·²è¿‡æœŸï¼Œåˆ é™¤ï¼Œè¿”å›ä¸å­˜åœ¨</li>
</ul>
</li>
<li><p><strong>ä¼˜ç‚¹ï¼š</strong>CPUæ€§èƒ½ï¼Œå‘ç°å¿…é¡»åˆ é™¤çš„æ—¶å€™æ‰åˆ é™¤</p>
</li>
<li><p>ç¼ºç‚¹ï¼šå†…å­˜å‹åŠ›å¤§ï¼Œå‡ºç°é•¿æœŸå ç”¨å†…å­˜çš„æ•°æ®</p>
</li>
<li><p>æ€»ç»“ï¼šç”¨å­˜å‚¨ç©ºé—´æ¢å–å¤„ç†å™¨æ€§èƒ½expireIfNeeded()(æ‹¿æ—¶é—´æ¢ç©ºé—´ï¼‰</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312211500020.png" alt="image-20210312211500020"></p>
<h4 id="6-2-3-å®šæœŸåˆ é™¤ç­–ç•¥"><a href="#6-2-3-å®šæœŸåˆ é™¤ç­–ç•¥" class="headerlink" title="6.2.3 å®šæœŸåˆ é™¤ç­–ç•¥"></a>6.2.3 å®šæœŸåˆ é™¤ç­–ç•¥</h4><ul>
<li>å‘¨æœŸæ€§è½®è¯¢redisåº“ä¸­çš„æ—¶æ•ˆæ€§æ•°æ®ï¼Œé‡‡ç”¨éšæœºæŠ½å–çš„ç­–ç•¥ï¼Œåˆ©ç”¨è¿‡æœŸæ•°æ®å æ¯”çš„æ–¹å¼æ§åˆ¶åˆ é™¤é¢‘åº¦</li>
<li>ç‰¹ç‚¹1ï¼šCPUæ€§èƒ½å ç”¨è®¾ç½®æœ‰å³°å€¼ï¼Œæ£€æµ‹é¢‘åº¦å¯è‡ªå®šä¹‰è®¾ç½®</li>
<li>ç‰¹ç‚¹2ï¼šå†…å­˜å‹åŠ›ä¸æ˜¯å¾ˆå¤§ï¼Œé•¿æœŸå ç”¨å†…å­˜çš„å†·æ•°æ®ä¼šè¢«æŒç»­æ¸…ç†</li>
<li>æ€»ç»“ï¼šå‘¨æœŸæ€§æŠ½æŸ¥å­˜å‚¨ç©ºé—´ï¼ˆéšæœºæŠ½æŸ¥ï¼Œé‡ç‚¹æŠ½æŸ¥ï¼‰</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312211646091.png" alt="image-20210312211646091"></p>
<h2 id="7-Redisçš„æŒä¹…åŒ–"><a href="#7-Redisçš„æŒä¹…åŒ–" class="headerlink" title="7.Redisçš„æŒä¹…åŒ–"></a>7.Redisçš„æŒä¹…åŒ–</h2><p>Redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœä¸å°†å†…å­˜ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜ï¼Œé‚£ä¹ˆä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼ŒæœåŠ¡å™¨ä¸­<br>çš„æ•°æ®åº“çŠ¶æ€ä¹Ÿä¼šæ¶ˆå¤±ã€‚æ‰€ä»¥ Redis æä¾›äº†æŒä¹…åŒ–åŠŸèƒ½ï¼</p>
<p>æŒä¹…åŒ–è¿‡ç¨‹ä¿å­˜ä»€ä¹ˆï¼Ÿ</p>
<blockquote>
<p><strong>å°†å½“å‰æ•°æ®çŠ¶æ€è¿›è¡Œä¿å­˜ï¼Œå¿«ç…§å½¢å¼ï¼Œå­˜å‚¨æ•°æ®ç»“æœï¼Œå­˜å‚¨æ ¼å¼ç®€å•ï¼Œå…³æ³¨ç‚¹åœ¨æ•°æ®</strong></p>
<p> <strong>å°†æ•°æ®çš„æ“ä½œè¿‡ç¨‹è¿›è¡Œä¿å­˜ï¼Œæ—¥å¿—å½¢å¼ï¼Œå­˜å‚¨æ“ä½œè¿‡ç¨‹ï¼Œå­˜å‚¨æ ¼å¼å¤æ‚ï¼Œå…³æ³¨ç‚¹åœ¨æ•°æ®çš„æ“ä½œè¿‡ç¨‹</strong></p>
</blockquote>
<h3 id="7-1-1RDB"><a href="#7-1-1RDB" class="headerlink" title="7.1.1RDB"></a>7.1.1RDB</h3><p>åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯è¡Œè¯è®²çš„Snapshotå¿«ç…§ï¼Œå®ƒæ¢å¤æ—¶æ˜¯å°†å¿«<br>ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œã€‚</p>
<p>Redisä¼šå•ç‹¬åˆ›å»ºï¼ˆforkï¼‰ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹<br>éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IOæ“ä½œçš„ã€‚<br>è¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£<br>RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚</p>
<p><strong>RDBå¯åŠ¨æ–¹å¼ â€”â€” saveæŒ‡ä»¤å·¥ä½œåŸç†</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡ä¿å­˜æ“ä½œ</span></span><br><span class="line">	save</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šè®¾ç½®æœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb</span></span><br><span class="line"><span class="comment">#ç»éªŒï¼šé€šå¸¸è®¾ç½®ä¸ºdump-ç«¯å£å·.rdb</span></span><br><span class="line">	dbfilename dump.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šè®¾ç½®å­˜å‚¨.rdbæ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">#ç»éªŒï¼šé€šå¸¸è®¾ç½®æˆå­˜å‚¨ç©ºé—´è¾ƒå¤§çš„ç›®å½•ä¸­ï¼Œç›®å½•åç§°data</span></span><br><span class="line">	dir</span><br><span class="line">	</span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šè®¾ç½®å­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸º yesï¼Œé‡‡ç”¨ LZF å‹ç¼©</span></span><br><span class="line"><span class="comment">#ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çœ CPU è¿è¡Œæ—¶é—´ï¼Œä½†ä¼šä½¿å­˜å‚¨çš„æ–‡ä»¶å˜å¤§ï¼ˆå·¨å¤§ï¼‰</span></span><br><span class="line">	rdbcompression yes</span><br><span class="line">	</span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šè®¾ç½®æ˜¯å¦è¿›è¡ŒRDBæ–‡ä»¶æ ¼å¼æ ¡éªŒï¼Œè¯¥æ ¡éªŒè¿‡ç¨‹åœ¨å†™æ–‡ä»¶å’Œè¯»æ–‡ä»¶è¿‡ç¨‹å‡è¿›è¡Œ</span></span><br><span class="line"><span class="comment">#ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çº¦è¯»å†™æ€§è¿‡ç¨‹çº¦10%æ—¶é—´æ¶ˆè€—ï¼Œä½†æ˜¯å­˜å‚¨ä¸€å®šçš„æ•°æ®æŸåé£é™©	</span></span><br><span class="line">	 rdbchecksum yes</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312212649363.png" alt="image-20210312212649363"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312212709577.png" alt="image-20210312212709577"></p>
<p><strong>RDBå¯åŠ¨æ–¹å¼ â€”â€” bgsaveæŒ‡ä»¤</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ‰‹åŠ¨å¯åŠ¨åå°ä¿å­˜æ“ä½œï¼Œä½†ä¸æ˜¯ç«‹å³æ‰§è¡Œ</span></span><br><span class="line">	bgsave</span><br><span class="line">	</span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šåå°å­˜å‚¨è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ç°è±¡ï¼Œæ˜¯å¦åœæ­¢ä¿å­˜æ“ä½œ</span></span><br><span class="line"><span class="comment">#ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€</span></span><br><span class="line">    dbfilename dump.rdb</span><br><span class="line">	dir</span><br><span class="line"> 	rdbcompression yes</span><br><span class="line"> 	rdbchecksum yes</span><br><span class="line"> 	stop-writes-on-bgsave-error yes</span><br><span class="line">	</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312212940908.png" alt="image-20210312212940908"></p>
<p><strong>RDBå¯åŠ¨æ–¹å¼ â€”â€”saveé…ç½®</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ»¡è¶³é™å®šæ—¶é—´èŒƒå›´å†…keyçš„å˜åŒ–æ•°é‡è¾¾åˆ°æŒ‡å®šæ•°é‡å³è¿›è¡ŒæŒä¹…åŒ–</span></span><br><span class="line">å‚æ•°</span><br><span class="line">	secondï¼šç›‘æ§æ—¶é—´èŒƒå›´</span><br><span class="line">	changesï¼šç›‘æ§keyçš„å˜åŒ–é‡</span><br><span class="line">	$ save second changes</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312213134359.png" alt="image-20210312213134359"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312213202725.png" alt="image-20210312213202725"></p>
<p><strong>RDBä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>RDBæ˜¯ä¸€ä¸ªç´§å‡‘å‹ç¼©çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå­˜å‚¨æ•ˆç‡è¾ƒé«˜</li>
<li> RDBå†…éƒ¨å­˜å‚¨çš„æ˜¯redisåœ¨æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ï¼Œéå¸¸é€‚åˆç”¨äºæ•°æ®å¤‡ä»½ï¼Œå…¨é‡å¤åˆ¶ç­‰åœºæ™¯</li>
<li> RDBæ¢å¤æ•°æ®çš„é€Ÿåº¦è¦æ¯”AOFå¿«å¾ˆå¤š</li>
<li> åº”ç”¨ï¼šæœåŠ¡å™¨ä¸­æ¯Xå°æ—¶æ‰§è¡Œbgsaveå¤‡ä»½ï¼Œå¹¶å°†RDBæ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹æœºå™¨ä¸­ï¼Œç”¨äºç¾éš¾æ¢å¤ã€‚</li>
</ul>
<p><strong>RDBç¼ºç‚¹ï¼š</strong></p>
<ul>
<li> RDBæ–¹å¼æ— è®ºæ˜¯æ‰§è¡ŒæŒ‡ä»¤è¿˜æ˜¯åˆ©ç”¨é…ç½®ï¼Œæ— æ³•åšåˆ°å®æ—¶æŒä¹…åŒ–ï¼Œå…·æœ‰è¾ƒå¤§çš„å¯èƒ½æ€§ä¸¢å¤±æ•°æ®</li>
<li>bgsaveæŒ‡ä»¤æ¯æ¬¡è¿è¡Œè¦æ‰§è¡Œforkæ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼Œè¦ç‰ºç‰²æ‰ä¸€äº›æ€§èƒ½</li>
<li> Redisçš„ä¼—å¤šç‰ˆæœ¬ä¸­æœªè¿›è¡ŒRDBæ–‡ä»¶æ ¼å¼çš„ç‰ˆæœ¬ç»Ÿä¸€ï¼Œæœ‰å¯èƒ½å‡ºç°å„ç‰ˆæœ¬æœåŠ¡ä¹‹é—´æ•°æ®æ ¼å¼æ— æ³•å…¼å®¹ç°è±¡</li>
</ul>
<h3 id="7-1-2-AOF"><a href="#7-1-2-AOF" class="headerlink" title="7.1.2 AOF"></a>7.1.2 AOF</h3><p><strong>RDBå­˜å‚¨çš„å¼Šç«¯</strong></p>
<ul>
<li>å­˜å‚¨æ•°æ®è¾ƒå¤§ï¼Œæ•ˆç‡è¾ƒä½</li>
<li>å¿«ç…§æ€æƒ³ï¼Œæ¯æ¬¡è¯»å†™å…¨éƒ¨æ•°æ®ï¼Œæ•°æ®å¤šæ—¶ï¼Œæ•ˆç‡ä½</li>
<li>å¤§æ•°æ®ä¸‹çš„IOæ€§èƒ½ä½</li>
<li>åŸºäºForkåˆ›å»ºå­è¿›ç¨‹ï¼Œå†…å­˜é¢å¤–æ¶ˆè€—</li>
<li>å®•æœºå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é£é™©</li>
</ul>
<p><strong>è§£å†³æ€è·¯</strong></p>
<ul>
<li>ä¸å…¨å†™æ•°æ®ï¼Œä»…ä»…è®°å½•éƒ¨åˆ†æ•°æ®</li>
<li>é™ä½åŒºåˆ†æ•°æ®æ˜¯å¦æ”¹å˜çš„éš¾åº¦ï¼Œæ”¹å˜è®°å½•æ•°æ®ä¸ºè®°å½•æ“ä½œè¿‡ç¨‹</li>
<li>å¯¹æ‰€æœ‰æ“ä½œè¿›è¡Œè®°å½•ï¼Œæ’é™¤ä¸¢å¤±æ•°æ®çš„é£é™©</li>
</ul>
<p>AOFæ¦‚å¿µ</p>
<ul>
<li><p>AOF(append only file)æŒä¹…åŒ–ï¼šä»¥ç‹¬ç«‹æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯æ¬¡å†™å‘½ä»¤ï¼Œé‡å¯æ—¶å†é‡æ–°æ‰§è¡ŒAOFæ–‡ä»¶ä¸­å‘½ä»¤<br>è¾¾åˆ°æ¢å¤æ•°æ®çš„ç›®çš„ã€‚ä¸RDBç›¸æ¯”å¯ä»¥ç®€å•æè¿°ä¸ºæ”¹è®°å½•æ•°æ®ä¸ºè®°å½•æ•°æ®äº§ç”Ÿçš„è¿‡ç¨‹</p>
</li>
<li><p>AOFçš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³äº†æ•°æ®æŒä¹…åŒ–çš„å®æ—¶æ€§ï¼Œç›®å‰å·²ç»æ˜¯RedisæŒä¹…åŒ–çš„ä¸»æµæ–¹å¼</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312213813782.png" alt="image-20210312213813782"></p>
<p><strong>AOFå†™æ•°æ®ä¸‰ç§ç­–ç•¥(appendfsync)</strong></p>
<ul>
<li>always(æ¯æ¬¡ï¼‰<ul>
<li>æ¯æ¬¡å†™å…¥æ“ä½œå‡åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œ<strong>æ•°æ®é›¶è¯¯å·®ï¼Œæ€§èƒ½è¾ƒä½</strong>ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>everysecï¼ˆæ¯ç§’ï¼‰<ul>
<li>æ¯ç§’å°†ç¼“å†²åŒºä¸­çš„æŒ‡ä»¤åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œæ•°æ®å‡†ç¡®æ€§è¾ƒé«˜ï¼Œæ€§èƒ½è¾ƒé«˜ï¼Œå»ºè®®ä½¿ç”¨ï¼Œä¹Ÿæ˜¯é»˜è®¤é…ç½®</li>
<li>åœ¨ç³»ç»Ÿçªç„¶å®•æœºçš„æƒ…å†µä¸‹ä¸¢å¤±1ç§’å†…çš„æ•°æ®</li>
</ul>
</li>
<li>no(ç³»ç»Ÿæ§åˆ¶)<ul>
<li>ç”±æ“ä½œç³»ç»Ÿæ§åˆ¶æ¯æ¬¡åŒæ­¥åˆ°AOFæ–‡ä»¶çš„å‘¨æœŸï¼Œæ•´ä½“è¿‡ç¨‹ä¸å¯æ§</li>
</ul>
</li>
</ul>
<p><strong>AOFåŠŸèƒ½å¼€å¯</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ˜¯å¦å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½ï¼Œé»˜è®¤ä¸ºä¸å¼€å¯çŠ¶æ€</span></span><br><span class="line">	appendonly yes|no</span><br><span class="line"><span class="comment">#AOFå†™æ•°æ®ç­–ç•¥</span></span><br><span class="line">	appendfsync always|everysec|no</span><br></pre></td></tr></table></figure>

<p><strong>AOFç›¸å…³é…ç½®</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#AOFæŒä¹…åŒ–æ–‡ä»¶åï¼Œé»˜è®¤æ–‡ä»¶åæœªappendonly.aofï¼Œå»ºè®®é…ç½®ä¸ºappendonly-ç«¯å£å·.aof</span></span><br><span class="line">	appendfilename filename</span><br><span class="line"><span class="comment">#AOFæŒä¹…åŒ–æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œä¸RDBæŒä¹…åŒ–æ–‡ä»¶ä¿æŒä¸€è‡´å³å¯</span></span><br><span class="line">	dir</span><br></pre></td></tr></table></figure>

<p><strong>AOFé‡å†™</strong></p>
<p>éšç€å‘½ä»¤ä¸æ–­å†™å…¥AOFï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRediså¼•å…¥äº†AOFé‡å†™æœºåˆ¶å‹ç¼©æ–‡ä»¶ä½“ç§¯ã€‚AOFæ–‡ä»¶é‡<br>å†™æ˜¯å°†Redisè¿›ç¨‹å†…çš„æ•°æ®è½¬åŒ–ä¸ºå†™å‘½ä»¤åŒæ­¥åˆ°æ–°AOFæ–‡ä»¶çš„è¿‡ç¨‹ã€‚ç®€å•è¯´å°±æ˜¯å°†å¯¹åŒä¸€ä¸ªæ•°æ®çš„è‹¥å¹²ä¸ªæ¡å‘½ä»¤æ‰§è¡Œç»“<br>æœè½¬åŒ–æˆæœ€ç»ˆç»“æœæ•°æ®å¯¹åº”çš„æŒ‡ä»¤è¿›è¡Œè®°å½•</p>
<p><strong>AOFé‡å†™ä½œç”¨</strong></p>
<ul>
<li>é™ä½ç£ç›˜å ç”¨é‡ï¼Œæé«˜ç£ç›˜åˆ©ç”¨ç‡</li>
<li> æé«˜æŒä¹…åŒ–æ•ˆç‡ï¼Œé™ä½æŒä¹…åŒ–å†™æ—¶é—´ï¼Œæé«˜IOæ€§èƒ½</li>
<li> é™ä½æ•°æ®æ¢å¤ç”¨æ—¶ï¼Œæé«˜æ•°æ®æ¢å¤æ•ˆç‡</li>
</ul>
<p><strong>AOFé‡å†™æ–¹å¼</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰‹åŠ¨é‡å†™</span></span><br><span class="line"></span><br><span class="line"> bgrewriteaof</span><br><span class="line"><span class="comment"># è‡ªåŠ¨é‡å†™</span></span><br><span class="line"></span><br><span class="line">auto-aof-rewrite-min-size size</span><br><span class="line">auto-aof-rewrite-percentage percentage</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312214538566.png" alt="image-20210312214538566"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312214607099.png" alt="image-20210312214607099"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312214623014.png" alt="image-20210312214623014"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312214648792.png" alt="image-20210312214648792"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312214737258.png" alt="image-20210312214737258"></p>
<p><strong>RDBä¸AOFçš„é€‰æ‹©ä¹‹æƒ‘</strong></p>
<ul>
<li><p><strong>å¯¹æ•°æ®éå¸¸æ•æ„Ÿï¼Œå»ºè®®ä½¿ç”¨é»˜è®¤çš„AOFæŒä¹…åŒ–æ–¹æ¡ˆ</strong></p>
<ul>
<li>AOFæŒä¹…åŒ–ç­–ç•¥ä½¿ç”¨everysecondï¼Œæ¯ç§’é’Ÿfsyncä¸€æ¬¡ã€‚è¯¥ç­–ç•¥redisä»å¯ä»¥ä¿æŒå¾ˆ å¥½çš„å¤„ç†æ€§èƒ½ï¼Œå½“å‡º<br>ç°é—®é¢˜æ—¶ï¼Œæœ€å¤šä¸¢å¤±0-1ç§’å†…çš„æ•°æ®ã€‚</li>
<li>æ³¨æ„ï¼šç”±äºAOFæ–‡ä»¶å­˜å‚¨ä½“ç§¯è¾ƒå¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦è¾ƒæ…¢</li>
</ul>
</li>
<li><p><strong>æ•°æ®å‘ˆç°é˜¶æ®µæœ‰æ•ˆæ€§ï¼Œå»ºè®®ä½¿ç”¨RDBæŒä¹…åŒ–æ–¹æ¡ˆ</strong></p>
<ul>
<li>æ•°æ®å¯ä»¥è‰¯å¥½çš„åšåˆ°é˜¶æ®µå†…æ— ä¸¢å¤±ï¼ˆè¯¥é˜¶æ®µæ˜¯å¼€å‘è€…æˆ–è¿ç»´äººå‘˜æ‰‹å·¥ç»´æŠ¤çš„ï¼‰ï¼Œä¸”æ¢å¤é€Ÿåº¦è¾ƒå¿«ï¼Œé˜¶æ®µ<br>ç‚¹æ•°æ®æ¢å¤é€šå¸¸é‡‡ç”¨RDBæ–¹æ¡ˆ</li>
<li> æ³¨æ„ï¼šåˆ©ç”¨RDBå®ç°ç´§å‡‘çš„æ•°æ®æŒä¹…åŒ–ä¼šä½¿Redisé™çš„å¾ˆä½</li>
</ul>
</li>
<li><p><strong>ç»¼åˆæ¯”å¯¹</strong></p>
<ul>
<li>RDBä¸AOFçš„é€‰æ‹©å®é™…ä¸Šæ˜¯åœ¨åšä¸€ç§æƒè¡¡ï¼Œæ¯ç§éƒ½æœ‰åˆ©æœ‰å¼Š</li>
<li> å¦‚ä¸èƒ½æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œå¯¹ä¸šåŠ¡æ•°æ®éå¸¸æ•æ„Ÿï¼Œé€‰ç”¨AOF</li>
<li> å¦‚èƒ½æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œä¸”è¿½æ±‚å¤§æ•°æ®é›†çš„æ¢å¤é€Ÿåº¦ï¼Œé€‰ç”¨RDB</li>
<li>ç¾éš¾æ¢å¤é€‰ç”¨RDB</li>
<li>åŒä¿é™©ç­–ç•¥ï¼ŒåŒæ—¶å¼€å¯ RDB å’Œ AOFï¼Œé‡å¯åï¼ŒRedisä¼˜å…ˆä½¿ç”¨ AOF æ¥æ¢å¤æ•°æ®ï¼Œé™ä½ä¸¢å¤±æ•°æ®çš„é‡</li>
</ul>
</li>
</ul>
<h3 id="7-1-3-æŒä¹…åŒ–åº”ç”¨åœºæ™¯"><a href="#7-1-3-æŒä¹…åŒ–åº”ç”¨åœºæ™¯" class="headerlink" title="7.1.3 æŒä¹…åŒ–åº”ç”¨åœºæ™¯"></a>7.1.3 æŒä¹…åŒ–åº”ç”¨åœºæ™¯</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312215304344.png" alt="image-20210312215304344"></p>
<h2 id="8-Redisäº‹åŠ¡"><a href="#8-Redisäº‹åŠ¡" class="headerlink" title="8.Redisäº‹åŠ¡"></a>8.Redisäº‹åŠ¡</h2><p><strong>Redisäº‹åŠ¡çš„æ¦‚å¿µï¼š</strong><br>Redis äº‹åŠ¡çš„æœ¬è´¨æ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆã€‚äº‹åŠ¡æ”¯æŒä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—<br>åŒ–ã€‚åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ï¼Œä¼šæŒ‰ç…§é¡ºåºä¸²è¡ŒåŒ–æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„å‘½ä»¤ï¼Œå…¶ä»–å®¢æˆ·ç«¯æäº¤çš„å‘½ä»¤è¯·æ±‚ä¸ä¼šæ’å…¥åˆ°äº‹<br>åŠ¡æ‰§è¡Œå‘½ä»¤åºåˆ—ä¸­ã€‚<br>æ€»ç»“è¯´ï¼šredisäº‹åŠ¡å°±æ˜¯ä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§çš„æ‰§è¡Œä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚<br><strong>Redisäº‹åŠ¡æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µï¼š</strong><br>æ‰¹é‡æ“ä½œåœ¨å‘é€ EXEC å‘½ä»¤å‰è¢«æ”¾å…¥é˜Ÿåˆ—ç¼“å­˜ï¼Œå¹¶ä¸ä¼šè¢«å®é™…æ‰§è¡Œï¼<br><strong>Redisä¸ä¿è¯åŸå­æ€§ï¼š</strong><br>Redisä¸­ï¼Œå•æ¡å‘½ä»¤æ˜¯åŸå­æ€§æ‰§è¡Œçš„ï¼Œä½†äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§ï¼Œä¸”æ²¡æœ‰å›æ»šã€‚äº‹åŠ¡ä¸­ä»»æ„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶<br>ä½™çš„å‘½ä»¤ä»ä¼šè¢«æ‰§è¡Œã€‚</p>
<p><strong>Redisäº‹åŠ¡çš„ä¸‰ä¸ªé˜¶æ®µï¼š</strong></p>
<ul>
<li>å¼€å§‹äº‹åŠ¡</li>
<li>å‘½ä»¤å…¥é˜Ÿ</li>
<li>æ‰§è¡Œäº‹åŠ¡</li>
</ul>
<p><strong>Redisäº‹åŠ¡ç›¸å…³å‘½ä»¤</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">watch key1 key2 ... Â <span class="comment">#ç›‘è§†ä¸€æˆ–å¤šä¸ªkey,å¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰ï¼Œè¢«ç›‘è§†çš„keyè¢«å…¶ä»–å‘½ä»¤æ”¹åŠ¨ï¼Œåˆ™</span></span><br><span class="line">äº‹åŠ¡è¢«æ‰“æ–­ ï¼ˆ ç±»ä¼¼ä¹è§‚é” ï¼‰</span><br><span class="line">multi <span class="comment"># æ ‡è®°ä¸€ä¸ªäº‹åŠ¡å—çš„å¼€å§‹ï¼ˆ queued ï¼‰</span></span><br><span class="line"><span class="built_in">exec</span> <span class="comment"># æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å—çš„å‘½ä»¤ ï¼ˆ ä¸€æ—¦æ‰§è¡Œexecåï¼Œä¹‹å‰åŠ çš„ç›‘æ§é”éƒ½ä¼šè¢«å–æ¶ˆæ‰ ï¼‰</span></span><br><span class="line">discard <span class="comment"># å–æ¶ˆäº‹åŠ¡ï¼Œæ”¾å¼ƒäº‹åŠ¡å—ä¸­çš„æ‰€æœ‰å‘½ä»¤</span></span><br><span class="line">unwatch <span class="comment"># å–æ¶ˆwatchå¯¹æ‰€æœ‰keyçš„ç›‘æ§</span></span><br></pre></td></tr></table></figure>

<p>æ­£å¸¸æ‰§è¡Œ</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312215653001.png" alt="image-20210312215653001"></p>
<p><strong>æ”¾å¼ƒäº‹åŠ¡</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312215711723.png" alt="image-20210312215711723"></p>
<p><strong>å­˜åœ¨é”™è¯¯</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312215734036.png" alt="image-20210312215734036"></p>
<p><strong>å‡ºç°è¯­æ³•æ€§é”™è¯¯</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312215810395.png" alt="image-20210312215810395"></p>
<p><strong>æ‚²è§‚é”ï¼š</strong><br>æ‚²è§‚é”(Pessimistic Lock),é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿åˆ°è¿™ä¸ªæ•°æ®å°±ä¼šblockç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œé¢å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨æ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚<br><strong>ä¹è§‚é”ï¼š</strong><br>ä¹è§‚é”(Optimistic Lock),é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ã€‚ä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹å†æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ï¼Œä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œä¹è§‚é”ç­–ç•¥ï¼šæäº¤ç‰ˆæœ¬å¿…é¡»å¤§äºè®°å½•å½“å‰ç‰ˆæœ¬æ‰èƒ½æ‰§è¡Œæ›´æ–°ã€‚</p>
<ul>
<li>1ã€åˆå§‹åŒ–ä¿¡ç”¨å¡å¯ç”¨ä½™é¢å’Œæ¬ é¢</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> balance 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> debt 0</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<ul>
<li>2ã€ä½¿ç”¨watchæ£€æµ‹balanceï¼Œäº‹åŠ¡æœŸé—´balanceæ•°æ®æœªå˜åŠ¨ï¼Œäº‹åŠ¡æ‰§è¡ŒæˆåŠŸ</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; watch balance</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; decrby balance 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incrby debt 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span></span><br><span class="line">1) (<span class="built_in">integer</span>) 80</span><br><span class="line">2) (<span class="built_in">integer</span>) 20</span><br></pre></td></tr></table></figure>

<ul>
<li>3ã€ä½¿ç”¨watchæ£€æµ‹balanceï¼Œäº‹åŠ¡æœŸé—´balanceæ•°æ®å˜åŠ¨ï¼Œäº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># çª—å£ä¸€</span></span><br><span class="line">127.0.0.1:6379&gt; watch balance</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI Â <span class="comment"># æ‰§è¡Œå®Œæ¯•åï¼Œæ‰§è¡Œçª—å£äºŒä»£ç æµ‹è¯•</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; decrby balance 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incrby debt 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span> Â <span class="comment"># ä¿®æ”¹å¤±è´¥ï¼</span></span><br><span class="line">(nil)</span><br><span class="line"><span class="comment"># çª—å£äºŒ</span></span><br><span class="line">127.0.0.1:6379&gt; get balance</span><br><span class="line"><span class="string">&quot;80&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> balance 200</span><br><span class="line">OK</span><br><span class="line"><span class="comment"># çª—å£ä¸€ï¼šå‡ºç°é—®é¢˜åæ”¾å¼ƒç›‘è§†ï¼Œç„¶åé‡æ¥ï¼</span></span><br><span class="line">127.0.0.1:6379&gt; UNWATCH Â <span class="comment"># æ”¾å¼ƒç›‘è§†</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; watch balance</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; decrby balance 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incrby debt 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span> Â <span class="comment"># æˆåŠŸï¼</span></span><br><span class="line">1) (<span class="built_in">integer</span>) 180</span><br><span class="line">2) (<span class="built_in">integer</span>) 40</span><br></pre></td></tr></table></figure>

<p><strong>è¯´æ˜ï¼š</strong><br>ä¸€ä½†æ‰§è¡Œ EXEC å¼€å¯äº‹åŠ¡çš„æ‰§è¡Œåï¼Œæ— è®ºäº‹åŠ¡ä½¿ç”¨æ‰§è¡ŒæˆåŠŸï¼Œ WARCH å¯¹å˜é‡çš„ç›‘æ§éƒ½å°†è¢«å–æ¶ˆã€‚æ•…å½“äº‹åŠ¡æ‰§è¡Œå¤±è´¥åï¼Œéœ€é‡æ–°æ‰§è¡ŒWATCHå‘½ä»¤å¯¹å˜é‡è¿›è¡Œç›‘æ§ï¼Œå¹¶å¼€å¯æ–°çš„äº‹åŠ¡è¿›è¡Œæ“ä½œã€‚<br><strong>å°ç»“</strong><br>watchæŒ‡ä»¤ç±»ä¼¼äºä¹è§‚é”ï¼Œåœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œå¦‚æœwatchç›‘æ§çš„å¤šä¸ªKEYä¸­ä»»ä½•KEYçš„å€¼å·²ç»è¢«å…¶ä»–å®¢æˆ·ç«¯<br>æ›´æ”¹ï¼Œåˆ™ä½¿ç”¨EXECæ‰§è¡Œäº‹åŠ¡æ—¶ï¼Œäº‹åŠ¡é˜Ÿåˆ—å°†ä¸ä¼šè¢«æ‰§è¡Œï¼ŒåŒæ—¶è¿”å›Nullmulti-bulkåº”ç­”ä»¥é€šçŸ¥è°ƒç”¨è€…äº‹åŠ¡æ‰§è¡Œå¤±è´¥ã€‚</p>
<h2 id="9-Rediså‘å¸ƒè®¢é˜…"><a href="#9-Rediså‘å¸ƒè®¢é˜…" class="headerlink" title="9.Rediså‘å¸ƒè®¢é˜…"></a>9.Rediså‘å¸ƒè®¢é˜…</h2><p><strong>Redis å‘å¸ƒè®¢é˜…(pub/sub)æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼</strong>ï¼šå‘é€è€…(pub)å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…(sub)æ¥æ”¶æ¶ˆæ¯ã€‚<br>Redis å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312220231575.png" alt="image-20210312220231575"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312220244949.png" alt="image-20210312220244949"></p>
<p>å½“æœ‰æ–°æ¶ˆæ¯é€šè¿‡ PUBLISH å‘½ä»¤å‘é€ç»™é¢‘é“ channel1 æ—¶ï¼Œ è¿™ä¸ªæ¶ˆæ¯å°±ä¼šè¢«å‘é€ç»™è®¢é˜…å®ƒçš„ä¸‰ä¸ªå®¢æˆ·ç«¯</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312220305354.png" alt="image-20210312220305354"></p>
<p><strong>å¸¸ç”¨å‘½ä»¤</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210312220332321.png" alt="image-20210312220332321"></p>
<p>ä»¥ä¸‹å®ä¾‹æ¼”ç¤ºäº†å‘å¸ƒè®¢é˜…æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚åœ¨æˆ‘ä»¬å®ä¾‹ä¸­æˆ‘ä»¬åˆ›å»ºäº†è®¢é˜…é¢‘é“åä¸º redisChat:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; SUBSCRIBE redisChat</span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) <span class="string">&quot;subscribe&quot;</span></span><br><span class="line">2) <span class="string">&quot;redisChat&quot;</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆé‡æ–°å¼€å¯ä¸ª redis å®¢æˆ·ç«¯ï¼Œç„¶ååœ¨åŒä¸€ä¸ªé¢‘é“ redisChat å‘å¸ƒä¸¤æ¬¡æ¶ˆæ¯ï¼Œè®¢é˜…è€…å°±èƒ½æ¥æ”¶åˆ°æ¶ˆæ¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; PUBLISH redisChat <span class="string">&quot;Hello,Redis&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; PUBLISH redisChat <span class="string">&quot;Helloï¼Œ123&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"><span class="comment"># è®¢é˜…è€…çš„å®¢æˆ·ç«¯ä¼šæ˜¾ç¤ºå¦‚ä¸‹æ¶ˆæ¯</span></span><br><span class="line">1) <span class="string">&quot;message&quot;</span></span><br><span class="line">2) <span class="string">&quot;redisChat&quot;</span></span><br><span class="line">3) <span class="string">&quot;Hello,Redis&quot;</span></span><br><span class="line">1) <span class="string">&quot;message&quot;</span></span><br><span class="line">2) <span class="string">&quot;redisChat&quot;</span></span><br><span class="line">3) <span class="string">&quot;Helloï¼Œ123&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>åŸç†è§£æ</strong></p>
<p>Redisæ˜¯ä½¿ç”¨Cå®ç°çš„ï¼Œé€šè¿‡åˆ†æ Redis æºç é‡Œçš„ pubsub.c æ–‡ä»¶ï¼Œäº†è§£å‘å¸ƒå’Œè®¢é˜…æœºåˆ¶çš„åº•å±‚å®ç°ï¼Œç±<br>æ­¤åŠ æ·±å¯¹ Redis çš„ç†è§£ã€‚<br>Redis é€šè¿‡ PUBLISH ã€SUBSCRIBE å’Œ PSUBSCRIBE ç­‰å‘½ä»¤å®ç°å‘å¸ƒå’Œè®¢é˜…åŠŸèƒ½ã€‚</p>
<ul>
<li><p>é€šè¿‡ SUBSCRIBE å‘½ä»¤è®¢é˜…æŸé¢‘é“åï¼Œredis-server é‡Œç»´æŠ¤äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®å°±æ˜¯ä¸€ä¸ªä¸ª channel<br>ï¼Œè€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ª channel çš„å®¢æˆ·ç«¯ã€‚SUBSCRIBE å‘½ä»¤çš„å…³<br>é”®ï¼Œå°±æ˜¯å°†å®¢æˆ·ç«¯æ·»åŠ åˆ°ç»™å®š channel çš„è®¢é˜…é“¾è¡¨ä¸­ã€‚</p>
</li>
<li><p>é€šè¿‡ PUBLISH å‘½ä»¤å‘è®¢é˜…è€…å‘é€æ¶ˆæ¯ï¼Œredis-server ä¼šä½¿ç”¨ç»™å®šçš„é¢‘é“ä½œä¸ºé”®ï¼Œåœ¨å®ƒæ‰€ç»´æŠ¤çš„ channel<br>å­—å…¸ä¸­æŸ¥æ‰¾è®°å½•äº†è®¢é˜…è¿™ä¸ªé¢‘é“çš„æ‰€æœ‰å®¢æˆ·ç«¯çš„é“¾è¡¨ï¼Œéå†è¿™ä¸ªé“¾è¡¨ï¼Œå°†æ¶ˆæ¯å‘å¸ƒç»™æ‰€æœ‰è®¢é˜…è€…ã€‚<br>Pub/Sub ä»å­—é¢ä¸Šç†è§£å°±æ˜¯å‘å¸ƒï¼ˆPublishï¼‰ä¸è®¢é˜…ï¼ˆSubscribeï¼‰ï¼Œåœ¨Redisä¸­ï¼Œä½ å¯ä»¥è®¾å®šå¯¹æŸä¸€ä¸ª<br>keyå€¼è¿›è¡Œæ¶ˆæ¯å‘å¸ƒåŠæ¶ˆæ¯è®¢é˜…ï¼Œå½“ä¸€ä¸ªkeyå€¼ä¸Šè¿›è¡Œäº†æ¶ˆæ¯å‘å¸ƒåï¼Œæ‰€æœ‰è®¢é˜…å®ƒçš„å®¢æˆ·ç«¯éƒ½ä¼šæ”¶åˆ°ç›¸åº”<br>çš„æ¶ˆæ¯ã€‚è¿™ä¸€åŠŸèƒ½æœ€æ˜æ˜¾çš„ç”¨æ³•å°±æ˜¯ç”¨ä½œå®æ—¶æ¶ˆæ¯ç³»ç»Ÿï¼Œæ¯”å¦‚æ™®é€šçš„å³æ—¶èŠå¤©ï¼Œç¾¤èŠç­‰åŠŸèƒ½ã€‚</p>
</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong></p>
<p>Pub/Subæ„å»ºå®æ—¶æ¶ˆæ¯ç³»ç»Ÿ<br>Redisçš„Pub/Subç³»ç»Ÿå¯ä»¥æ„å»ºå®æ—¶çš„æ¶ˆæ¯ç³»ç»Ÿ<br>æ¯”å¦‚å¾ˆå¤šç”¨Pub/Subæ„å»ºçš„å®æ—¶èŠå¤©ç³»ç»Ÿçš„ä¾‹å­</p>
<h2 id="10-Redisä¸»ä»å¤åˆ¶"><a href="#10-Redisä¸»ä»å¤åˆ¶" class="headerlink" title="10.Redisä¸»ä»å¤åˆ¶"></a>10.Redisä¸»ä»å¤åˆ¶</h2><p><strong>æ¦‚å¿µ</strong><br>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master/leader)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave/follower)ï¼›æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚</p>
<p>Masterä»¥å†™ä¸ºä¸»ï¼ŒSlave ä»¥è¯»ä¸ºä¸»ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼›ä¸”ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªä»èŠ‚ç‚¹(æˆ–æ²¡æœ‰ä»èŠ‚ç‚¹)ï¼Œä½†ä¸€ä¸ªä»èŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</p>
<p>ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š<br><strong>1ã€æ•°æ®å†—ä½™ï¼š</strong>ä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</p>
<p>2ã€æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</p>
<p><strong>3ã€è´Ÿè½½å‡è¡¡ï¼š</strong>åœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œ</p>
<p>ç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›</p>
<p>å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</p>
<p><strong>4ã€é«˜å¯ç”¨åŸºçŸ³ï¼š</strong>é™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯<br>Redisé«˜å¯ç”¨çš„åŸºç¡€ã€‚</p>
<p><strong>ç‰¹å¾ï¼šä¸€ä¸ªmasterå¯ä»¥æ‹¥æœ‰å¤šä¸ªslaveï¼Œä¸€ä¸ªslaveåªå¯¹åº”ä¸€ä¸ªmaster</strong></p>
<p><strong>èŒè´£ï¼š</strong></p>
<ul>
<li><p>master</p>
<ul>
<li>å†™æ•°æ®</li>
<li>æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œå°†å‡ºç°å˜åŒ–çš„æ•°æ®è‡ªåŠ¨åŒæ­¥åˆ°slave</li>
<li>è¯»æ•°æ®</li>
</ul>
</li>
<li><p>slave</p>
<ul>
<li>è¯»æ•°æ®</li>
<li>å†™æ•°æ®ï¼ˆç¦æ­¢ï¼‰</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313203215765.png" alt="image-20210313203215765"></p>
<p>ä¸»ä»å¤åˆ¶è¿‡ç¨‹3ä¸ªé˜¶æ®µ</p>
<ul>
<li>å»ºç«‹è¿æ¥é˜¶æ®µ</li>
<li>æ•°æ®åŒæ­¥é˜¶æ®µ</li>
<li>å‘½ä»¤ä¼ æ’­é˜¶æ®µ</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313203317194.png" alt="image-20210313203317194"></p>
<h3 id="ä¸»ä»å¤åˆ¶å·¥ä½œæµç¨‹"><a href="#ä¸»ä»å¤åˆ¶å·¥ä½œæµç¨‹" class="headerlink" title="ä¸»ä»å¤åˆ¶å·¥ä½œæµç¨‹"></a><strong>ä¸»ä»å¤åˆ¶å·¥ä½œæµç¨‹</strong></h3><h4 id="é˜¶æ®µä¸€-å»ºç«‹è¿æ¥é˜¶æ®µ"><a href="#é˜¶æ®µä¸€-å»ºç«‹è¿æ¥é˜¶æ®µ" class="headerlink" title="é˜¶æ®µä¸€:å»ºç«‹è¿æ¥é˜¶æ®µ"></a>é˜¶æ®µä¸€:å»ºç«‹è¿æ¥é˜¶æ®µ</h4><p> <strong>å»ºç«‹slaveåˆ°masterçš„è¿æ¥ï¼Œä½¿masterèƒ½å¤Ÿè¯†åˆ«slaveï¼Œå¹¶ä¿å­˜slaveç«¯å£å·</strong></p>
<p>æ­¥éª¤</p>
<blockquote>
<p>æ­¥éª¤1ï¼šè®¾ç½®masterçš„åœ°å€å’Œç«¯å£ï¼Œä¿å­˜masterä¿¡æ¯<br>æ­¥éª¤2ï¼šå»ºç«‹socketè¿æ¥<br>æ­¥éª¤3ï¼šå‘é€pingå‘½ä»¤ï¼ˆå®šæ—¶å™¨ä»»åŠ¡ï¼‰<br>æ­¥éª¤4ï¼šèº«ä»½éªŒè¯<br>æ­¥éª¤5ï¼šå‘é€slaveç«¯å£ä¿¡æ¯</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313203608886.png" alt="image-20210313203608886"></p>
<p><strong>ä¸»ä»è¿æ¥ï¼ˆslaveè¿æ¥masterï¼‰</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ–¹å¼ä¸€ï¼šå®¢æˆ·ç«¯å‘é€å‘½ä»¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> slaveof &lt;masterip&gt; &lt;masterport&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–¹å¼äºŒï¼šå¯åŠ¨æœåŠ¡å™¨å‚æ•°</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> redis-server -slaveof &lt;masterip&gt; &lt;masterport&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">æ–¹å¼ä¸‰ï¼šæœåŠ¡å™¨é…ç½®</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> slaveof &lt;masterip&gt; &lt;masterport&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>ä¸»ä»æ–­å¼€è¿æ¥</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å®¢æˆ·ç«¯å‘é€å‘½ä»¤ slaveæ–­å¼€è¿æ¥åï¼Œä¸ä¼šåˆ é™¤å·²æœ‰æ•°æ®ï¼Œåªæ˜¯ä¸å†æ¥å—masterå‘é€çš„æ•°æ®</span></span><br><span class="line">slaveof no one </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>æˆæƒè®¿é—®</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> masterå®¢æˆ·ç«¯å‘é€å‘½ä»¤è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> requirepass &lt;password&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> masteré…ç½®æ–‡ä»¶è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> config <span class="built_in">set</span> requirepass &lt;password&gt;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> config get requirepass</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slaveå®¢æˆ·ç«¯å‘é€å‘½ä»¤è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> auth &lt;password&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slaveé…ç½®æ–‡ä»¶è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> masterauth &lt;password&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slaveå¯åŠ¨æœåŠ¡å™¨è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> redis-server â€“a &lt;password&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="é˜¶æ®µäºŒ-æ•°æ®åŒæ­¥é˜¶æ®µå·¥ä½œæµç¨‹"><a href="#é˜¶æ®µäºŒ-æ•°æ®åŒæ­¥é˜¶æ®µå·¥ä½œæµç¨‹" class="headerlink" title="é˜¶æ®µäºŒ:æ•°æ®åŒæ­¥é˜¶æ®µå·¥ä½œæµç¨‹"></a>é˜¶æ®µäºŒ:æ•°æ®åŒæ­¥é˜¶æ®µå·¥ä½œæµç¨‹</h4><ul>
<li><p>åœ¨slaveåˆæ¬¡è¿æ¥masteråï¼Œå¤åˆ¶masterä¸­çš„æ‰€æœ‰æ•°æ®åˆ°slave</p>
</li>
<li><p>å°†slaveçš„æ•°æ®åº“çŠ¶æ€æ›´æ–°æˆmasterå½“å‰çš„æ•°æ®åº“çŠ¶æ€</p>
</li>
</ul>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<blockquote>
<p>æ­¥éª¤1ï¼šè¯·æ±‚åŒæ­¥æ•°æ®<br>æ­¥éª¤2ï¼šåˆ›å»ºRDBåŒæ­¥æ•°æ®<br>æ­¥éª¤3ï¼šæ¢å¤RDBåŒæ­¥æ•°æ®<br>æ­¥éª¤4ï¼šè¯·æ±‚éƒ¨åˆ†åŒæ­¥æ•°æ®<br>æ­¥éª¤5ï¼šæ¢å¤éƒ¨åˆ†åŒæ­¥æ•°æ®</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313204536575.png" alt="image-20210313204536575"></p>
<h4 id="é˜¶æ®µä¸‰ï¼šå‘½ä»¤ä¼ æ’­é˜¶æ®µ"><a href="#é˜¶æ®µä¸‰ï¼šå‘½ä»¤ä¼ æ’­é˜¶æ®µ" class="headerlink" title="é˜¶æ®µä¸‰ï¼šå‘½ä»¤ä¼ æ’­é˜¶æ®µ"></a>é˜¶æ®µä¸‰ï¼šå‘½ä»¤ä¼ æ’­é˜¶æ®µ</h4><ul>
<li> å½“masteræ•°æ®åº“çŠ¶æ€è¢«ä¿®æ”¹åï¼Œå¯¼è‡´ä¸»ä»æœåŠ¡å™¨æ•°æ®åº“çŠ¶æ€ä¸ä¸€è‡´ï¼Œéœ€è¦è®©ä¸»ä»æ•°æ®åŒæ­¥åˆ°ä¸€è‡´çš„çŠ¶æ€ï¼ŒåŒæ­¥çš„åŠ¨ä½œç§°ä¸ºå‘½ä»¤ä¼ æ’­</li>
<li> masterå°†æ¥æ”¶åˆ°çš„æ•°æ®å˜æ›´å‘½ä»¤å‘é€ç»™slaveï¼Œslaveæ¥æ”¶å‘½ä»¤åæ‰§è¡Œå‘½ä»¤</li>
</ul>
<p> <strong>å‘½ä»¤ä¼ æ’­é˜¶æ®µçš„éƒ¨åˆ†å¤åˆ¶</strong></p>
<ul>
<li><p><strong>å‘½ä»¤ä¼ æ’­é˜¶æ®µå‡ºç°æ–­ç½‘ç°è±¡</strong></p>
<ul>
<li>ç½‘ç»œé—ªæ–­é—ªè¿  <strong>å¿½ç•¥</strong></li>
<li>çŸ­æ—¶é—´ç½‘ç»œä¸­æ–­   <strong>éƒ¨åˆ†å¤åˆ¶</strong></li>
<li>é•¿æ—¶é—´ç½‘ç»œä¸­æ–­   å…¨é‡å¤åˆ¶</li>
</ul>
</li>
<li><p><strong>éƒ¨åˆ†å¤åˆ¶çš„ä¸‰ä¸ªæ ¸å¿ƒè¦ç´ </strong></p>
<ul>
<li>æœåŠ¡å™¨çš„è¿è¡Œid</li>
<li>ä¸»æœåŠ¡å™¨çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒº</li>
<li>ä¸»ä»æœåŠ¡å™¨çš„èµ‹å€¼åç§»é‡</li>
</ul>
</li>
</ul>
<p><strong>æœåŠ¡å™¨è¿è¡ŒIDï¼ˆrunidï¼‰</strong></p>
<p>æœåŠ¡å™¨è¿è¡ŒIDæ˜¯æ¯ä¸€å°æœåŠ¡å™¨æ¯æ¬¡è¿è¡Œçš„èº«ä»½è¯†åˆ«ç ï¼Œä¸€å°æœåŠ¡å™¨å¤šæ¬¡è¿è¡Œå¯ä»¥ç”Ÿæˆå¤šä¸ªè¿è¡Œid</p>
<ul>
<li><p>ä½œç”¨ï¼šè¿è¡Œidè¢«ç”¨äºåœ¨æœåŠ¡å™¨é—´è¿›è¡Œä¼ è¾“ï¼Œè¯†åˆ«èº«ä»½å¦‚æœæƒ³ä¸¤æ¬¡æ“ä½œå‡å¯¹åŒä¸€å°æœåŠ¡å™¨è¿›è¡Œï¼Œå¿…é¡»æ¯æ¬¡æ“ä½œæºå¸¦å¯¹åº”çš„è¿è¡Œidï¼Œç”¨äºå¯¹æ–¹è¯†åˆ«</p>
</li>
<li><p>å®ç°æ–¹å¼ï¼šè¿è¡Œidåœ¨æ¯å°æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œmasteråœ¨é¦–æ¬¡è¿æ¥slaveæ—¶ï¼Œä¼šå°†è‡ªå·±çš„è¿è¡ŒIDå‘é€ç»™slaveï¼Œslaveä¿å­˜æ­¤IDï¼Œé€šè¿‡<strong>info Server</strong>å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹èŠ‚ç‚¹çš„runid</p>
</li>
</ul>
<p><strong>å¤åˆ¶ç¼“å†²åŒº</strong></p>
<p>å¤åˆ¶ç¼“å†²åŒºï¼Œåˆåå¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼Œ<strong>æ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„é˜Ÿåˆ—ï¼Œç”¨äºå­˜å‚¨æœåŠ¡å™¨æ‰§è¡Œè¿‡çš„å‘½ä»¤</strong>ï¼Œæ¯æ¬¡ä¼ æ’­å‘½ä»¤ï¼Œmasteréƒ½ä¼šå°†ä¼ æ’­çš„å‘½ä»¤è®°å½•ä¸‹æ¥ï¼Œå¹¶å­˜å‚¨åœ¨å¤åˆ¶ç¼“å†²åŒº</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313205206305.png" alt="image-20210313205206305"></p>
<p><strong>ä¸»ä»æœåŠ¡å™¨å¤åˆ¶åç§»é‡ï¼ˆoffsetï¼‰</strong></p>
<ul>
<li><p><strong>æ¦‚å¿µï¼š</strong>ä¸€ä¸ªæ•°å­—ï¼Œæè¿°å¤åˆ¶ç¼“å†²åŒºä¸­çš„æŒ‡ä»¤å­—èŠ‚ä½ç½®</p>
</li>
<li><p><strong>åˆ†ç±»</strong>ï¼š</p>
<ul>
<li>masterå¤åˆ¶åç§»é‡ï¼šè®°å½•å‘é€ç»™æ‰€æœ‰slaveçš„æŒ‡ä»¤å­—èŠ‚å¯¹åº”çš„ä½ç½®ï¼ˆå¤šä¸ªï¼‰</li>
<li> slaveå¤åˆ¶åç§»é‡ï¼šè®°å½•slaveæ¥æ”¶masterå‘é€è¿‡æ¥çš„æŒ‡ä»¤å­—èŠ‚å¯¹åº”çš„ä½ç½®ï¼ˆä¸€ä¸ªï¼‰</li>
</ul>
</li>
<li><p><strong>æ•°æ®æ¥æºï¼š</strong></p>
<ul>
<li>masterç«¯ï¼šå‘é€ä¸€æ¬¡è®°å½•ä¸€æ¬¡</li>
<li>slaveç«¯ï¼šæ¥æ”¶ä¸€æ¬¡è®°å½•ä¸€æ¬¡</li>
</ul>
</li>
<li><p><strong>ä½œç”¨ï¼š</strong>åŒæ­¥ä¿¡æ¯ï¼Œæ¯”å¯¹masterä¸slaveçš„å·®å¼‚ï¼Œå½“slaveæ–­çº¿åï¼Œæ¢å¤æ•°æ®ä½¿ç”¨</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313205648993.png" alt="image-20210313205648993"></p>
<p><strong>å¿ƒè·³æœºåˆ¶</strong><br>è¿›å…¥å‘½ä»¤ä¼ æ’­é˜¶æ®µå€™ï¼Œmasterä¸slaveé—´éœ€è¦è¿›è¡Œä¿¡æ¯äº¤æ¢ï¼Œä½¿ç”¨å¿ƒè·³æœºåˆ¶è¿›è¡Œç»´æŠ¤ï¼Œå®ç°åŒæ–¹è¿æ¥ä¿æŒåœ¨çº¿</p>
<ul>
<li><p><strong>masterå¿ƒè·³ï¼š</strong></p>
<ul>
<li>æŒ‡ä»¤ï¼šPING</li>
<li> å‘¨æœŸï¼šç”±repl-ping-slave-periodå†³å®šï¼Œé»˜è®¤10ç§’</li>
<li> ä½œç”¨ï¼šåˆ¤æ–­slaveæ˜¯å¦åœ¨çº¿</li>
<li> æŸ¥è¯¢ï¼šINFO replication è·å–slaveæœ€åä¸€æ¬¡è¿æ¥æ—¶é—´é—´éš”ï¼Œlagé¡¹ç»´æŒåœ¨0æˆ–1è§†ä¸ºæ­£å¸¸</li>
</ul>
</li>
<li><p><strong>slaveå¿ƒè·³ä»»åŠ¡</strong>:</p>
<ul>
<li>æŒ‡ä»¤ï¼šREPLCONF ACK {offset}</li>
<li> å‘¨æœŸï¼š1ç§’</li>
<li> ä½œç”¨1ï¼šæ±‡æŠ¥slaveè‡ªå·±çš„å¤åˆ¶åç§»é‡ï¼Œè·å–æœ€æ–°çš„æ•°æ®å˜æ›´æŒ‡ä»¤</li>
<li> ä½œç”¨2ï¼šåˆ¤æ–­masteræ˜¯å¦åœ¨çº¿</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313205954713.png" alt="image-20210313205954713"></p>
<h3 id="ä¸»ä»å¤åˆ¶å¸¸è§é—®é¢˜"><a href="#ä¸»ä»å¤åˆ¶å¸¸è§é—®é¢˜" class="headerlink" title="ä¸»ä»å¤åˆ¶å¸¸è§é—®é¢˜"></a>ä¸»ä»å¤åˆ¶å¸¸è§é—®é¢˜</h3><h4 id="é¢‘ç¹çš„å…¨é‡å¤åˆ¶"><a href="#é¢‘ç¹çš„å…¨é‡å¤åˆ¶" class="headerlink" title="é¢‘ç¹çš„å…¨é‡å¤åˆ¶"></a>é¢‘ç¹çš„å…¨é‡å¤åˆ¶</h4><p>ä¼´éšç€ç³»ç»Ÿçš„è¿è¡Œï¼Œmasterçš„æ•°æ®é‡ä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸€æ—¦masteré‡å¯ï¼Œrunidå°†å‘ç”Ÿå˜åŒ–ï¼Œä¼šå¯¼è‡´å…¨éƒ¨slaveçš„å…¨é‡å¤åˆ¶æ“ä½œ</p>
<p><strong>å†…éƒ¨ä¼˜åŒ–è°ƒæ•´æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>masterå†…éƒ¨åˆ›å»ºmaster_replidå˜é‡ï¼Œä½¿ç”¨runidç›¸åŒçš„ç­–ç•¥ç”Ÿæˆï¼Œé•¿åº¦41ä½ï¼Œå¹¶å‘é€ç»™æ‰€æœ‰slave</li>
<li>åœ¨masterå…³é—­æ—¶æ‰§è¡Œå‘½ä»¤ shutdown saveï¼Œè¿›è¡ŒRDBæŒä¹…åŒ–,å°†runidä¸offsetä¿å­˜åˆ°RDBæ–‡ä»¶ä¸­</li>
</ol>
<ul>
<li><strong>epl-id repl-offset</strong></li>
<li><strong>é€šè¿‡redis-check-rdbå‘½ä»¤å¯ä»¥æŸ¥çœ‹è¯¥ä¿¡æ¯</strong></li>
</ul>
<ol start="3">
<li>masteré‡å¯ååŠ è½½RDBæ–‡ä»¶ï¼Œæ¢å¤æ•°æ®<br> é‡å¯åï¼Œå°†RDBæ–‡ä»¶ä¸­ä¿å­˜çš„repl-idä¸repl-offsetåŠ è½½åˆ°å†…å­˜ä¸­</li>
</ol>
<ul>
<li><strong>master_repl_id = repl master_repl_offset = repl-offset</strong></li>
<li><strong>é€šè¿‡infoå‘½ä»¤å¯ä»¥æŸ¥çœ‹è¯¥ä¿¡æ¯</strong></li>
</ul>
<ol start="4">
<li>ä½œç”¨ï¼šæœ¬æœºä¿å­˜ä¸Šæ¬¡runidï¼Œé‡å¯åæ¢å¤è¯¥å€¼ï¼Œä½¿æ‰€æœ‰slaveè®¤ä¸ºè¿˜æ˜¯ä¹‹å‰çš„master </li>
</ol>
<h4 id="é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ1ï¼‰"><a href="#é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ1ï¼‰" class="headerlink" title="é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ1ï¼‰"></a>é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ1ï¼‰</h4><ul>
<li><p><strong>é—®é¢˜ç°è±¡</strong>ï¼šmasterçš„CPUå ç”¨è¿‡é«˜ æˆ– slaveé¢‘ç¹æ–­å¼€è¿æ¥</p>
</li>
<li><p><strong>é—®é¢˜åŸå› </strong></p>
<ul>
<li> slaveæ¯1ç§’å‘é€REPLCONF ACKå‘½ä»¤åˆ°master</li>
<li>å½“slaveæ¥åˆ°äº†æ…¢æŸ¥è¯¢æ—¶ï¼ˆkeys * ï¼Œhgetallç­‰ï¼‰ï¼Œä¼šå¤§é‡å ç”¨CPUæ€§èƒ½</li>
<li> masteræ¯1ç§’è°ƒç”¨å¤åˆ¶å®šæ—¶å‡½æ•°replicationCron()ï¼Œæ¯”å¯¹slaveå‘ç°é•¿æ—¶é—´æ²¡æœ‰è¿›è¡Œå“åº”</li>
</ul>
</li>
<li><p><strong>æœ€ç»ˆç»“æœ</strong></p>
<ul>
<li>masterå„ç§èµ„æºï¼ˆè¾“å‡ºç¼“å†²åŒºã€å¸¦å®½ã€è¿æ¥ç­‰ï¼‰è¢«ä¸¥é‡å ç”¨</li>
</ul>
</li>
<li><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<ul>
<li>é€šè¿‡è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œç¡®è®¤æ˜¯å¦é‡Šæ”¾slave ï¼ˆrepl-timeoutï¼‰<br>è¯¥å‚æ•°å®šä¹‰äº†è¶…æ—¶æ—¶é—´çš„é˜ˆå€¼ï¼ˆé»˜è®¤60ç§’ï¼‰ï¼Œè¶…è¿‡è¯¥å€¼ï¼Œé‡Šæ”¾slave</li>
</ul>
</li>
</ul>
<h4 id="é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ2ï¼‰"><a href="#é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ2ï¼‰" class="headerlink" title="é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ2ï¼‰"></a>é¢‘ç¹çš„ç½‘ç»œä¸­æ–­ï¼ˆ2ï¼‰</h4><p><strong>é—®é¢˜ç°è±¡</strong>ï¼šslaveä¸masterè¿æ¥æ–­å¼€</p>
<ul>
<li><strong>é—®é¢˜åŸå› </strong><ul>
<li>masterå‘é€pingæŒ‡ä»¤é¢‘åº¦æ¯”è¾ƒä½</li>
<li>masterè®¾å®šè¶…æ—¶æ—¶é—´è¾ƒçŸ­</li>
<li>pingç½‘ç»œä¸­å­˜åœ¨ä¸¢åŒ…</li>
</ul>
</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong><ul>
<li>æé«˜pingæŒ‡ä»¤çš„é¢‘åº¦ï¼ˆrepl-ping-slave-periodï¼‰</li>
</ul>
</li>
</ul>
<p><strong>è¶…æ—¶é—´repl-timeçš„æ—¶é—´è‡³å°‘æ˜¯pingæŒ‡ä»¤é¢‘åº¦çš„5-10å€ï¼Œå¦åˆ™slaveå®¹æ˜“åˆ¤å®šè¶…æ—¶</strong></p>
<h4 id="æ•°æ®ä¸ä¸€è‡´"><a href="#æ•°æ®ä¸ä¸€è‡´" class="headerlink" title="æ•°æ®ä¸ä¸€è‡´"></a>æ•°æ®ä¸ä¸€è‡´</h4><p>é—®é¢˜ç°è±¡ï¼šå¤šä¸ªslaveè·å–ç›¸åŒæ•°æ®ä¸åŒæ­¥</p>
<ul>
<li><strong>é—®é¢˜åŸå› </strong><ul>
<li>ç½‘ç»œä¿¡æ¯ä¸åŒæ­¥ï¼Œå‘é€æ•°æ®æœ‰å»¶è¿Ÿ</li>
</ul>
</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong><ul>
<li>ä¼˜åŒ–ä¸»ä»é—´çš„ç½‘ç»œç¯å¢ƒ</li>
<li>ç›‘æ§ä»èŠ‚ç‚¹å»¶è¿Ÿï¼ˆé€šè¿‡offsetï¼‰åˆ¤æ–­ï¼Œå¦‚æœslaveå»¶è¿Ÿè¿‡å¤§ï¼Œæš‚æ—¶å±è”½ç¨‹åºå¯¹slaveçš„æ•°æ®è®¿é—®(slave-serve-stale-data  yes|no)</li>
</ul>
</li>
</ul>
<h2 id="11-å“¨å…µæ¨¡å¼"><a href="#11-å“¨å…µæ¨¡å¼" class="headerlink" title="11.å“¨å…µæ¨¡å¼"></a>11.å“¨å…µæ¨¡å¼</h2><p>å“¨å…µ(sentinel) æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç”¨äºå¯¹ä¸»ä»ç»“æ„ä¸­çš„æ¯å°æœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå½“å‡ºç°æ•…éšœæ—¶é€šè¿‡æŠ•ç¥¨æœºåˆ¶é€‰æ‹©æ–°çš„masterå¹¶å°†æ‰€æœ‰slaveè¿æ¥åˆ°æ–°çš„masterã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313211546132.png" alt="image-20210313211546132"></p>
<p><strong>å“¨å…µçš„ä½œç”¨</strong></p>
<ul>
<li><p><strong>ç›‘æ§</strong><br>ä¸æ–­çš„æ£€æŸ¥masterå’Œslaveæ˜¯å¦æ­£å¸¸è¿è¡Œã€‚masterå­˜æ´»æ£€æµ‹ã€masterä¸slaveè¿è¡Œæƒ…å†µæ£€æµ‹</p>
</li>
<li><p>é€šçŸ¥ï¼ˆæé†’ï¼‰å½“è¢«ç›‘æ§çš„æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œå‘å…¶ä»–ï¼ˆå“¨å…µé—´ï¼Œå®¢æˆ·ç«¯ï¼‰å‘é€é€šçŸ¥ã€‚</p>
</li>
<li><p><strong>è‡ªåŠ¨æ•…éšœè½¬ç§»</strong><br>æ–­å¼€masterä¸slaveè¿æ¥ï¼Œé€‰å–ä¸€ä¸ªslaveä½œä¸ºmasterï¼Œå°†å…¶ä»–slaveè¿æ¥åˆ°æ–°çš„masterï¼Œå¹¶å‘ŠçŸ¥å®¢æˆ·ç«¯æ–°çš„æœåŠ¡å™¨åœ°å€</p>
</li>
</ul>
<p><strong>æ³¨æ„ï¼šå“¨å…µä¹Ÿæ˜¯ä¸€å°redisæœåŠ¡å™¨ï¼Œåªæ˜¯ä¸æä¾›æ•°æ®æœåŠ¡é€šå¸¸å“¨å…µé…ç½®æ•°é‡ä¸ºå•æ•°</strong></p>
<p><strong>å¯ç”¨å“¨å…µæ¨¡å¼</strong></p>
<p>é…ç½®å“¨å…µ</p>
<ul>
<li>é…ç½®ä¸€æ‹–äºŒçš„ä¸»ä»ç»“æ„</li>
<li>é…ç½®ä¸‰ä¸ªå“¨å…µ(é…ç½®ç›¸åŒï¼Œç«¯å£ä¸åŒ)</li>
<li>å¯åŠ¨å“¨å…µ</li>
</ul>
<blockquote>
<p>redis-sentinel sentinel- ç«¯å£å· .conf</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313211842733.png" alt="image-20210313211842733"></p>
<p><strong>å“¨å…µå·¥ä½œåŸè·¯</strong></p>
<p>ä¸»ä»åˆ‡æ¢ä¸‰ä¸ªé˜¶æ®µ</p>
<ul>
<li>ç›‘æ§</li>
<li>é€šçŸ¥</li>
<li>æ•…éšœè½¬ç§»</li>
</ul>
<p><strong>é˜¶æ®µä¸€ï¼šç›‘æ§é˜¶æ®µ</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313212005678.png" alt="image-20210313212005678"></p>
<ul>
<li><p>ç”¨äºåŒæ­¥å„ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ä¿¡æ¯</p>
<ul>
<li><p>è·å–å„ä¸ªsentineçš„çŠ¶æ€(æ˜¯å¦åœ¨çº¿)</p>
</li>
<li><p>è·å–masterçŠ¶æ€</p>
<ul>
<li>masterå±æ€§<ul>
<li>runid</li>
<li>role:master</li>
</ul>
</li>
</ul>
</li>
<li><p>è·å–æ‰€æœ‰slaveçš„çŠ¶æ€</p>
<ul>
<li>slaveå±æ€§<ul>
<li>runid</li>
<li>role:master</li>
<li>offset</li>
<li>mater_host.master_port</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313212233484.png" alt="image-20210313212233484"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313212243342.png" alt="image-20210313212243342"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313212257746.png" alt="image-20210313212257746"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313212313110.png" alt="image-20210313212313110"></p>
<p><strong>é˜¶æ®µä¸‰ï¼šæ•…éšœè½¬ç§»é˜¶æ®µ</strong></p>
<ul>
<li><p>æœåŠ¡å™¨åˆ—è¡¨ä¸­æŒ‘é€‰å¤‡é€‰master</p>
<ul>
<li>åœ¨çº¿çš„</li>
<li>å“åº”æ…¢çš„</li>
<li>ä¸åŸmasteræ–­å¼€æ—¶é—´ä¹…çš„</li>
<li>ä¼˜å…ˆåŸåˆ™<ul>
<li>ä¼˜å…ˆçº§</li>
<li>offset</li>
<li>runid</li>
</ul>
</li>
</ul>
</li>
<li><p>å‘é€æŒ‡ä»¤ sentinel</p>
<ul>
<li> å‘æ–°çš„masterå‘é€slaveof no one</li>
<li> å‘å…¶ä»–slaveå‘é€slaveof æ–°masterIPç«¯å£</li>
</ul>
</li>
<li><p>ç›‘æ§</p>
<ul>
<li>åŒæ­¥ä¿¡æ¯</li>
</ul>
</li>
<li><p>é€šçŸ¥</p>
<ul>
<li>ä¿æŒè”é€š</li>
</ul>
</li>
<li><p>æ•…éšœè½¬ç§»</p>
<ul>
<li>å‘ç°é—®é¢˜</li>
<li>ç«é€‰è´Ÿè´£äºº</li>
<li>ä¼˜é€‰å¿ƒmaster</li>
<li>æ–°masterä¸Šä»»ï¼Œå…¶ä»–slaveåˆ‡æ¢masterï¼ŒåŸmasterä½œä¸ºslaveæ•…éšœå›å¤åè¿æ¥</li>
</ul>
</li>
</ul>
<h2 id="12-ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ"><a href="#12-ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ" class="headerlink" title="12.ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ"></a>12.ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ</h2><h3 id="ç¼“å­˜é¢„çƒ­"><a href="#ç¼“å­˜é¢„çƒ­" class="headerlink" title="ç¼“å­˜é¢„çƒ­"></a>ç¼“å­˜é¢„çƒ­</h3><p>é—®é¢˜ï¼š</p>
<ul>
<li>è¯·æ±‚æ•°é‡è¾ƒé«˜</li>
<li>ä¸»ä»ä¹‹é—´æ•°æ®ååé‡è¾ƒå¤§ï¼Œæ•°æ®åŒæ­¥æ“ä½œé¢‘åº¦é«˜</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p><strong>å‰ç½®å‡†å¤‡å·¥ä½œï¼š</strong></p>
<ol>
<li>æ—¥å¸¸ä¾‹è¡Œç»Ÿè®¡æ•°æ®è®¿é—®è®°å½•ï¼Œç»Ÿè®¡è®¿é—®é¢‘åº¦è¾ƒé«˜çš„çƒ­ç‚¹æ•°æ®</li>
<li>åˆ©ç”¨LRUæ•°æ®åˆ é™¤ç­–ç•¥ï¼Œæ„å»ºæ•°æ®ç•™å­˜é˜Ÿåˆ—</li>
</ol>
<p><strong>å‡†å¤‡å·¥ä½œï¼š</strong></p>
<ol>
<li>å°†ç»Ÿè®¡ç»“æœä¸­çš„æ•°æ®åˆ†ç±»ï¼Œæ ¹æ®çº§åˆ«ï¼Œredisä¼˜å…ˆåŠ è½½çº§åˆ«è¾ƒé«˜çš„çƒ­ç‚¹æ•°æ®</li>
<li>åˆ©ç”¨åˆ†å¸ƒå¼å¤šæœåŠ¡å™¨åŒæ—¶è¿›è¡Œæ•°æ®è¯»å–ï¼Œæé€Ÿæ•°æ®åŠ è½½è¿‡ç¨‹</li>
<li>çƒ­ç‚¹æ•°æ®ä¸»ä»åŒæ—¶é¢„çƒ­</li>
</ol>
<p><strong>å®æ–½ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨è„šæœ¬ç¨‹åºå›ºå®šè§¦å‘æ•°æ®é¢„çƒ­è¿‡ç¨‹</li>
<li>å¦‚æœæ¡ä»¶å…è®¸ï¼Œä½¿ç”¨äº†CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰ï¼Œæ•ˆæœä¼šæ›´å¥½</li>
</ol>
<p> <strong>æ€»ç»“ï¼š<br>ç¼“å­˜é¢„çƒ­å°±æ˜¯ç³»ç»Ÿå¯åŠ¨å‰ï¼Œæå‰å°†ç›¸å…³çš„ç¼“å­˜æ•°æ®ç›´æ¥åŠ è½½åˆ°ç¼“å­˜ç³»ç»Ÿã€‚é¿å…åœ¨ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå†å°†æ•°æ®ç¼“<br>å­˜çš„é—®é¢˜ï¼ç”¨æˆ·ç›´æ¥æŸ¥è¯¢äº‹å…ˆè¢«é¢„çƒ­çš„ç¼“å­˜æ•°æ®ï¼</strong></p>
<h3 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h3><p><strong>æ•°æ®åº“æœåŠ¡å™¨å´©æºƒï¼ˆ1ï¼‰</strong></p>
<ol>
<li>ç³»ç»Ÿå¹³ç¨³è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¿½ç„¶æ•°æ®åº“è¿æ¥é‡æ¿€å¢</li>
<li>åº”ç”¨æœåŠ¡å™¨æ— æ³•åŠæ—¶å¤„ç†è¯·æ±‚</li>
<li>å¤§é‡408ï¼Œ500é”™è¯¯é¡µé¢å‡ºç°</li>
<li>å®¢æˆ·åå¤åˆ·æ–°é¡µé¢è·å–æ•°æ®</li>
<li>æ•°æ®åº“å´©æºƒ</li>
<li>åº”ç”¨æœåŠ¡å™¨å´©æºƒ</li>
<li>é‡å¯åº”ç”¨æœåŠ¡å™¨æ— æ•ˆ</li>
<li>RedisæœåŠ¡å™¨å´©æºƒ</li>
<li>Redisé›†ç¾¤å´©æºƒ</li>
<li>é‡å¯æ•°æ®åº“åå†æ¬¡è¢«ç¬é—´æµé‡æ”¾å€’</li>
</ol>
<p><strong>é—®é¢˜æ’æŸ¥</strong></p>
<ol>
<li>åœ¨ä¸€ä¸ªè¾ƒçŸ­çš„æ—¶é—´å†…ï¼Œç¼“å­˜ä¸­è¾ƒå¤šçš„keyé›†ä¸­è¿‡æœŸ</li>
<li>æ­¤å‘¨æœŸå†…è¯·æ±‚è®¿é—®è¿‡æœŸçš„æ•°æ®ï¼Œredisæœªå‘½ä¸­ï¼Œrediså‘æ•°æ®åº“è·å–æ•°æ®</li>
<li>æ•°æ®åº“åŒæ—¶æ¥æ”¶åˆ°å¤§é‡çš„è¯·æ±‚æ— æ³•åŠæ—¶å¤„ç†</li>
<li>Rediså¤§é‡è¯·æ±‚è¢«ç§¯å‹ï¼Œå¼€å§‹å‡ºç°è¶…æ—¶ç°è±¡</li>
<li>æ•°æ®åº“æµé‡æ¿€å¢ï¼Œæ•°æ®åº“å´©æºƒ</li>
<li>é‡å¯åä»ç„¶é¢å¯¹ç¼“å­˜ä¸­æ— æ•°æ®å¯ç”¨</li>
<li>RedisæœåŠ¡å™¨èµ„æºè¢«ä¸¥é‡å ç”¨ï¼ŒRedisæœåŠ¡å™¨å´©æºƒ</li>
<li>Redisé›†ç¾¤å‘ˆç°å´©å¡Œï¼Œé›†ç¾¤ç“¦è§£</li>
<li>åº”ç”¨æœåŠ¡å™¨æ— æ³•åŠæ—¶å¾—åˆ°æ•°æ®å“åº”è¯·æ±‚ï¼Œæ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚æ•°é‡è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨æœåŠ¡å™¨å´©æºƒ</li>
<li>åº”ç”¨æœåŠ¡å™¨ï¼Œredisï¼Œæ•°æ®åº“å…¨éƒ¨é‡å¯ï¼Œæ•ˆæœä¸ç†æƒ³</li>
</ol>
<p><strong>é—®é¢˜</strong></p>
<ul>
<li>çŸ­æ—¶é—´èŒƒå›´å†…</li>
<li>å¤§é‡keyé›†ä¸­è¿‡æœŸ</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<ol>
<li>æ›´å¤šçš„é¡µé¢é™æ€åŒ–å¤„ç†</li>
<li>æ„å»ºå¤šçº§ç¼“å­˜æ¶æ„<br>Nginxç¼“å­˜+redisç¼“å­˜+ehcacheç¼“å­˜</li>
<li>æ£€æµ‹Mysqlä¸¥é‡è€—æ—¶ä¸šåŠ¡è¿›è¡Œä¼˜åŒ–<br>å¯¹æ•°æ®åº“çš„ç“¶é¢ˆæ’æŸ¥ï¼šä¾‹å¦‚è¶…æ—¶æŸ¥è¯¢ã€è€—æ—¶è¾ƒé«˜äº‹åŠ¡ç­‰</li>
<li>ç¾éš¾é¢„è­¦æœºåˆ¶<br>ç›‘æ§redisæœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡</li>
</ol>
<ul>
<li>CPUå ç”¨ã€CPUä½¿ç”¨ç‡</li>
<li> å†…å­˜å®¹é‡</li>
<li> æŸ¥è¯¢å¹³å‡å“åº”æ—¶é—´</li>
<li> çº¿ç¨‹æ•°</li>
</ul>
<ol start="5">
<li>é™æµã€é™çº§<br>çŸ­æ—¶é—´èŒƒå›´å†…ç‰ºç‰²ä¸€äº›å®¢æˆ·ä½“éªŒï¼Œé™åˆ¶ä¸€éƒ¨åˆ†è¯·æ±‚è®¿é—®ï¼Œé™ä½åº”ç”¨æœåŠ¡å™¨å‹åŠ›ï¼Œå¾…ä¸šåŠ¡ä½é€Ÿè¿è½¬åå†é€æ­¥æ”¾å¼€è®¿é—®</li>
</ol>
<p><strong>æ€»ç»“<br>ç¼“å­˜é›ªå´©å°±æ˜¯ç¬é—´è¿‡æœŸæ•°æ®é‡å¤ªå¤§ï¼Œå¯¼è‡´å¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆå‹åŠ›ã€‚å¦‚èƒ½å¤Ÿæœ‰æ•ˆé¿å…è¿‡æœŸæ—¶é—´é›†ä¸­ï¼Œå¯ä»¥æœ‰æ•ˆè§£å†³é›ªå´©ç°è±¡çš„å‡ºç°<br>ï¼ˆçº¦40%ï¼‰ï¼Œé…åˆå…¶ä»–ç­–ç•¥ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ç›‘æ§æœåŠ¡å™¨çš„è¿è¡Œæ•°æ®ï¼Œæ ¹æ®è¿è¡Œè®°å½•åšå¿«é€Ÿè°ƒæ•´ã€‚</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313213728118.png" alt="image-20210313213728118"></p>
<h3 id="ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜å‡»ç©¿</h3><p><strong>æ•°æ®åº“æœåŠ¡å™¨å´©æºƒï¼ˆ2ï¼‰</strong></p>
<ol>
<li>ç³»ç»Ÿå¹³ç¨³è¿è¡Œè¿‡ç¨‹ä¸­</li>
<li>æ•°æ®åº“è¿æ¥é‡ç¬é—´æ¿€å¢</li>
<li>RedisæœåŠ¡å™¨æ— å¤§é‡keyè¿‡æœŸ</li>
<li>Rediså†…å­˜å¹³ç¨³ï¼Œæ— æ³¢åŠ¨</li>
<li>RedisæœåŠ¡å™¨CPUæ­£å¸¸</li>
<li>æ•°æ®åº“å´©æºƒ</li>
</ol>
<p><strong>é—®é¢˜</strong></p>
<ul>
<li>Redisä¸­æŸä¸ªkeyè¿‡æœŸï¼Œè¯¥keyè®¿é—®é‡å·¨å¤§</li>
<li>å¤šä¸ªæ•°æ®è¯·æ±‚ä»æœåŠ¡å™¨å‹åˆ°Redisåï¼Œå‡æœªå‘½ä¸­</li>
<li>Redisåœ¨çŸ­æ—¶é—´å†…å‘èµ·äº†å¤§é‡å¯¹æ•°æ®åº“ä¸­åŒä¸€æ•°æ®çš„è®¿é—®</li>
</ul>
<p><strong>åˆ†æ</strong></p>
<ul>
<li>å•ä¸ªkeyé«˜çƒ­æ•°æ®</li>
<li>keyè¿‡æœŸ</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼ˆæœ¯ï¼‰</strong></p>
<ol>
<li>é¢„å…ˆè®¾å®š<br>ä»¥ç”µå•†ä¸ºä¾‹ï¼Œæ¯ä¸ªå•†å®¶æ ¹æ®åº—é“ºç­‰çº§ï¼ŒæŒ‡å®šè‹¥å¹²æ¬¾ä¸»æ‰“å•†å“ï¼Œåœ¨è´­ç‰©èŠ‚æœŸé—´ï¼ŒåŠ å¤§æ­¤ç±»ä¿¡æ¯keyçš„è¿‡æœŸæ—¶é•¿<br>æ³¨æ„ï¼šè´­ç‰©èŠ‚ä¸ä»…ä»…æŒ‡å½“å¤©ï¼Œä»¥åŠåç»­è‹¥å¹²å¤©ï¼Œè®¿é—®å³°å€¼å‘ˆç°é€æ¸é™ä½çš„è¶‹åŠ¿</li>
<li>ç°åœºè°ƒæ•´<br>ç›‘æ§è®¿é—®é‡ï¼Œå¯¹è‡ªç„¶æµé‡æ¿€å¢çš„æ•°æ®å»¶é•¿è¿‡æœŸæ—¶é—´æˆ–è®¾ç½®ä¸ºæ°¸ä¹…æ€§key</li>
<li>åå°åˆ·æ–°æ•°æ®<br>å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼Œé«˜å³°æœŸæ¥ä¸´ä¹‹å‰ï¼Œåˆ·æ–°æ•°æ®æœ‰æ•ˆæœŸï¼Œç¡®ä¿ä¸ä¸¢å¤±</li>
<li>äºŒçº§ç¼“å­˜<br>è®¾ç½®ä¸åŒçš„å¤±æ•ˆæ—¶é—´ï¼Œä¿éšœä¸ä¼šè¢«åŒæ—¶æ·˜æ±°å°±è¡Œ</li>
<li>åŠ é”<br>åˆ†å¸ƒå¼é”ï¼Œé˜²æ­¢è¢«å‡»ç©¿ï¼Œä½†æ˜¯è¦æ³¨æ„ä¹Ÿæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œæ…é‡ï¼</li>
</ol>
<p><strong>æ€»ç»“<br>ç¼“å­˜å‡»ç©¿å°±æ˜¯å•ä¸ªé«˜çƒ­æ•°æ®è¿‡æœŸçš„ç¬é—´ï¼Œæ•°æ®è®¿é—®é‡è¾ƒå¤§ï¼Œæœªå‘½ä¸­redisåï¼Œå‘èµ·äº†å¤§é‡å¯¹åŒä¸€æ•°æ®çš„æ•°æ®åº“è®¿é—®ï¼Œå¯¼è‡´å¯¹æ•°æ®åº“æœ<br>åŠ¡å™¨é€ æˆå‹åŠ›ã€‚åº”å¯¹ç­–ç•¥åº”è¯¥åœ¨ä¸šåŠ¡æ•°æ®åˆ†æä¸é¢„é˜²æ–¹é¢è¿›è¡Œï¼Œé…åˆè¿è¡Œç›‘æ§æµ‹è¯•ä¸å³æ—¶è°ƒæ•´ç­–ç•¥ï¼Œæ¯•ç«Ÿå•ä¸ªkeyçš„è¿‡æœŸç›‘æ§éš¾åº¦<br>è¾ƒé«˜ï¼Œé…åˆé›ªå´©å¤„ç†ç­–ç•¥å³å¯ã€‚</strong></p>
<h3 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h3><p><strong>æ•°æ®åº“æœåŠ¡å™¨å´©æºƒï¼ˆ3ï¼‰</strong></p>
<ol>
<li>ç³»ç»Ÿå¹³ç¨³è¿è¡Œè¿‡ç¨‹ä¸­</li>
<li>åº”ç”¨æœåŠ¡å™¨æµé‡éšæ—¶é—´å¢é‡è¾ƒå¤§</li>
<li>RedisæœåŠ¡å™¨å‘½ä¸­ç‡éšæ—¶é—´é€æ­¥é™ä½</li>
<li>Rediså†…å­˜å¹³ç¨³ï¼Œå†…å­˜æ— å‹åŠ›</li>
<li>RedisæœåŠ¡å™¨CPUå ç”¨æ¿€å¢</li>
<li>æ•°æ®åº“æœåŠ¡å™¨å‹åŠ›æ¿€å¢</li>
<li>æ•°æ®åº“å´©æºƒ</li>
</ol>
<p><strong>é—®é¢˜</strong></p>
<ul>
<li>Redisä¸­å‡ºç°å¤§é¢ç§¯æœªå‘½ä¸­</li>
<li>å‡ºç°éæ­£å¸¸URLè®¿é—®</li>
</ul>
<p><strong>åˆ†æ</strong></p>
<ul>
<li>è·å–çš„æ•°æ®åœ¨æ•°æ®åº“ä¸­ä¹Ÿä¸å­˜åœ¨ï¼Œæ•°æ®åº“æŸ¥è¯¢æœªå¾—åˆ°ç›¸åº”çš„æ•°æ®</li>
<li>Redisè·å–åˆ°nullæ•°æ®æœªè¿›è¡ŒæŒä¹…åŒ–ï¼Œç›´æ¥è¿”å›</li>
<li>å‡ºç°é»‘å®¢æ”»å‡»æœåŠ¡å™¨</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼ˆæœ¯ï¼‰</strong></p>
<ol>
<li>ç¼“å­˜null<br>å¯¹æŸ¥è¯¢ç»“æœä¸ºnullçš„æ•°æ®è¿›è¡Œç¼“å­˜ï¼ˆé•¿æœŸä½¿ç”¨ï¼Œå®šæœŸæ¸…ç†ï¼‰ï¼Œè®¾å®šçŸ­æ—¶é™ï¼Œä¾‹å¦‚30-60ç§’ï¼Œæœ€é«˜5åˆ†é’Ÿ</li>
<li>ç™½åå•ç­–ç•¥</li>
</ol>
<ul>
<li>æå‰é¢„çƒ­å„ç§åˆ†ç±»æ•°æ®i då¯¹åº”çš„bitmapsï¼Œidä½œä¸ºbitmapsçš„offsetï¼Œç›¸å½“äºè®¾ç½®äº†æ•°æ®ç™½åå•ã€‚å½“åŠ è½½æ­£å¸¸æ•°æ®æ—¶ï¼Œæ”¾<br>è¡Œï¼ŒåŠ è½½å¼‚å¸¸æ•°æ®æ—¶ç›´æ¥æ‹¦æˆªï¼ˆæ•ˆç‡åä½ï¼‰</li>
<li> ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆæœ‰å…³å¸ƒéš†è¿‡æ»¤å™¨çš„å‘½ä¸­é—®é¢˜å¯¹å½“å‰çŠ¶å†µå¯ä»¥å¿½ç•¥ï¼‰</li>
</ul>
<ol start="3">
<li>å®æ–½ç›‘æ§<br>å®æ—¶ç›‘æ§rediså‘½ä¸­ç‡ï¼ˆä¸šåŠ¡æ­£å¸¸èŒƒå›´æ—¶ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªæ³¢åŠ¨å€¼ï¼‰ä¸nullæ•°æ®çš„å æ¯”</li>
</ol>
<ul>
<li>éæ´»åŠ¨æ—¶æ®µæ³¢åŠ¨ï¼šé€šå¸¸æ£€æµ‹3-5å€ï¼Œè¶…è¿‡5å€çº³å…¥é‡ç‚¹æ’æŸ¥å¯¹è±¡</li>
<li>æ´»åŠ¨æ—¶æ®µæ³¢åŠ¨ï¼šé€šå¸¸æ£€æµ‹10-50å€ï¼Œè¶…è¿‡50å€çº³å…¥é‡ç‚¹æ’æŸ¥å¯¹è±¡<br>æ ¹æ®å€æ•°ä¸åŒï¼Œå¯åŠ¨ä¸åŒçš„æ’æŸ¥æµç¨‹ã€‚ç„¶åä½¿ç”¨é»‘åå•è¿›è¡Œé˜²æ§ï¼ˆè¿è¥ï¼‰</li>
</ul>
<ol start="4">
<li>keyåŠ å¯†<br> é—®é¢˜å‡ºç°åï¼Œä¸´æ—¶å¯åŠ¨é˜²ç¾ä¸šåŠ¡keyï¼Œå¯¹keyè¿›è¡Œä¸šåŠ¡å±‚ä¼ è¾“åŠ å¯†æœåŠ¡ï¼Œè®¾å®šæ ¡éªŒç¨‹åºï¼Œè¿‡æ¥çš„keyæ ¡éªŒ<br> ä¾‹å¦‚æ¯å¤©éšæœºåˆ†é…60ä¸ªåŠ å¯†ä¸²ï¼ŒæŒ‘é€‰2åˆ°3ä¸ªï¼Œæ··æ·†åˆ°é¡µé¢æ•°æ®idä¸­ï¼Œå‘ç°è®¿é—®keyä¸æ»¡è¶³è§„åˆ™ï¼Œé©³å›æ•°æ®è®¿é—®</li>
</ol>
<p><strong>æ€»ç»“<br>ç¼“å­˜å‡»ç©¿è®¿é—®äº†ä¸å­˜åœ¨çš„æ•°æ®ï¼Œè·³è¿‡äº†åˆæ³•æ•°æ®çš„redisæ•°æ®ç¼“å­˜é˜¶æ®µï¼Œæ¯æ¬¡è®¿é—®æ•°æ®åº“ï¼Œå¯¼è‡´å¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆå‹åŠ›ã€‚é€šå¸¸æ­¤ç±»<br>æ•°æ®çš„å‡ºç°é‡æ˜¯ä¸€ä¸ªè¾ƒä½çš„å€¼ï¼Œå½“å‡ºç°æ­¤ç±»æƒ…å†µä»¥æ¯’æ”»æ¯’ï¼Œå¹¶åŠæ—¶æŠ¥è­¦ã€‚åº”å¯¹ç­–ç•¥åº”è¯¥åœ¨ä¸´æ—¶é¢„æ¡ˆé˜²èŒƒæ–¹é¢å¤šåšæ–‡ç« ã€‚<br>æ— è®ºæ˜¯é»‘åå•è¿˜æ˜¯ç™½åå•ï¼Œéƒ½æ˜¯å¯¹æ•´ä½“ç³»ç»Ÿçš„å‹åŠ›ï¼Œè­¦æŠ¥è§£é™¤åå°½å¿«ç§»é™¤ã€‚</strong></p>
<h3 id="æ€§èƒ½æŒ‡æ ‡ç›‘æ§"><a href="#æ€§èƒ½æŒ‡æ ‡ç›‘æ§" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡ç›‘æ§"></a>æ€§èƒ½æŒ‡æ ‡ç›‘æ§</h3><p><strong>ç›‘æ§æŒ‡æ ‡</strong></p>
<ul>
<li>æ€§èƒ½æŒ‡æ ‡ï¼šPerformance</li>
<li> å†…å­˜æŒ‡æ ‡ï¼šMemory</li>
<li> åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic activity</li>
<li> æŒä¹…æ€§æŒ‡æ ‡ï¼šPersistence</li>
<li> é”™è¯¯æŒ‡æ ‡ï¼šError</li>
</ul>
<ul>
<li><strong>æ€§èƒ½æŒ‡æ ‡ï¼šPerformance</strong></li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>latency</td>
<td>Rediså“åº”ä¸€ä¸ªè¯·æ±‚çš„æ—¶é—´</td>
</tr>
<tr>
<td>instantaneous_ops_per_sec</td>
<td>å¹³å‡æ¯ç§’å¤„ç†è¯·æ±‚æ€»æ•°</td>
</tr>
<tr>
<td>hit rate(calculated)</td>
<td>ç¼“å­˜å‘½ä¸­ç‡</td>
</tr>
</tbody></table>
<ul>
<li><strong>å†…å­˜æŒ‡æ ‡ï¼šMemory</strong></li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>used_memory</td>
<td>å·²ä½¿ç”¨å†…å­˜</td>
</tr>
<tr>
<td>mem_fragmentation_ratio</td>
<td>å†…å­˜ç¢ç‰‡ç‡</td>
</tr>
<tr>
<td>evicted_keys</td>
<td>ç”±äºæœ€å¤§å†…å­˜é™åˆ¶è¢«ç§»çš„keyæ•°é‡</td>
</tr>
<tr>
<td>blocked_clients</td>
<td>ç”±äºBLPOP,BRPOP,or BRPOPLPUSHè€Œé˜»å¡çš„å®¢æˆ·ç«¯</td>
</tr>
</tbody></table>
<ul>
<li><strong>åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic activity</strong></li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>connected_clients</td>
<td>å®¢æˆ·ç«¯è¿æ¥æ•°</td>
</tr>
<tr>
<td>connected_slaves</td>
<td>Slaveæ•°é‡</td>
</tr>
<tr>
<td>master_last_io_seconds_ago</td>
<td>æœ€è¿‘ä¸€æ¬¡ä¸»ä»äº¤äº’ä¹‹åçš„ç§’æ•°</td>
</tr>
<tr>
<td>keyspace</td>
<td>æ•°æ®åº“ä¸­çš„keyå€¼æ€»æ•°</td>
</tr>
</tbody></table>
<ul>
<li><strong>æŒä¹…æ€§æŒ‡æ ‡ï¼šPersistence</strong></li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>rdb_last_save_time</td>
<td>æœ€åä¸€æ¬¡æŒä¹…åŒ–ä¿å­˜åˆ°ç£ç›˜çš„æ—¶é—´æˆ³</td>
</tr>
<tr>
<td>rdb_changes_since_last_save</td>
<td>è‡ªæœ€åä¸€æ¬¡æŒä¹…åŒ–ä»¥æ¥çš„æ•°æ®åº“æ›´æ”¹æ•°</td>
</tr>
</tbody></table>
<ul>
<li><strong>é”™è¯¯æŒ‡æ ‡ï¼šError</strong></li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>rejected_connections</td>
<td>ç”±äºè¾¾åˆ°maxclienté™åˆ¶è€Œè¢«æ‹’ç»çš„è¿æ¥æ•°</td>
</tr>
<tr>
<td>keyspace_misses</td>
<td>keyå€¼æŸ¥æ‰¾å¤±è´¥ï¼ˆæ²¡æœ‰å‘½ä¸­ï¼‰æ¬¡æ•°</td>
</tr>
<tr>
<td>master_link_down_since_seconds</td>
<td>ä¸»ä»æ–­å¼€çš„æŒç»­æ—¶é—´(ä»¥ç§’ä¸ºå•ä½)</td>
</tr>
</tbody></table>
<p>ç›‘æ§æ–¹å¼</p>
<ul>
<li><p>å·¥å…·</p>
<ul>
<li>Cloud Insight Redis</li>
<li>Prometheus</li>
<li>Redis-stat</li>
<li>Redis-faina</li>
<li>RedisLive</li>
<li>zabbix</li>
</ul>
</li>
<li><p>å‘½ä»¤</p>
<ul>
<li>benchmark</li>
<li>redis cli<ul>
<li>monitor</li>
<li>showlog</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> redis-benchmark [-h ] [-p ] [-c ] [-n &lt;requests]&gt; [-k ]</span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> æ‰“å°æœåŠ¡å™¨è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> monitor</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> showlong [operator]</span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> get ï¼šè·å–æ…¢æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> len ï¼šè·å–æ…¢æŸ¥è¯¢æ—¥å¿—æ¡ç›®æ•°</span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> reset ï¼šé‡ç½®æ…¢æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> slowlog-log-slower-than 1000 <span class="comment">#è®¾ç½®æ…¢æŸ¥è¯¢çš„æ—¶é—´ä¸‹çº¿ï¼Œå•ä½ï¼šå¾®å¦™</span></span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> slowlog-max-len 100 <span class="comment">#è®¾ç½®æ…¢æŸ¥è¯¢å‘½ä»¤å¯¹åº”çš„æ—¥å¿—æ˜¾ç¤ºé•¿åº¦ï¼Œå•ä½ï¼šå‘½ä»¤æ•°</span></span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313215951231.png" alt="image-20210313215951231"></p>
<h2 id="13-Jedis"><a href="#13-Jedis" class="headerlink" title="13.Jedis"></a>13.Jedis</h2><p><strong>Jedisæ˜¯Rediså®˜æ–¹æ¨èçš„Javaè¿æ¥å¼€å‘å·¥å…·ã€‚è¦åœ¨Javaå¼€å‘ä¸­ä½¿ç”¨å¥½Redisä¸­é—´ä»¶ï¼Œå¿…é¡»å¯¹Jedisç†Ÿæ‚‰æ‰èƒ½å†™æˆæ¼‚äº®çš„ä»£ç </strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/Redis%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313220249208.png" alt="image-20210313220249208"></p>
<p><strong>æµ‹è¯•</strong></p>
<p>1ã€æ–°å»ºä¸€ä¸ªæ™®é€šçš„Mavené¡¹ç›®<br>2ã€å¯¼å…¥redisçš„ä¾èµ–ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/redis.clients/jedis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.58<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™æµ‹è¯•ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Ping</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">6379</span>);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è¿æ¥æˆåŠŸ&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//æŸ¥çœ‹æœåŠ¡æ˜¯å¦è¿è¡Œ</span></span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æœåŠ¡æ­£åœ¨è¿è¡Œ: &quot;</span>+jedis.ping());</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨redisæœåŠ¡<br>5ã€å¯åŠ¨æµ‹è¯•ï¼Œç»“æœ</p>
<blockquote>
<p>è¿æ¥æˆåŠŸ<br>æœåŠ¡æ­£åœ¨è¿è¡Œ: PONG</p>
</blockquote>
<p><strong>å¯¹keyå¸¸ç”¨å‘½ä»¤</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestKey</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ¸…ç©ºæ•°æ®ï¼š&quot;</span>+jedis.flushDB());</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ¤æ–­æŸä¸ªé”®æ˜¯å¦å­˜åœ¨ï¼š&quot;</span>+jedis.exists(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ–°å¢&lt;&#x27;username&#x27;,&#x27;kuangshen&#x27;&gt;çš„é”®å€¼</span></span><br><span class="line"><span class="string">å¯¹ï¼š&quot;</span>+jedis.set(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;kuangshen&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ–°å¢&lt;&#x27;password&#x27;,&#x27;password&#x27;&gt;çš„é”®å€¼</span></span><br><span class="line"><span class="string">å¯¹ï¼š&quot;</span>+jedis.set(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;password&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.print(<span class="string">&quot;ç³»ç»Ÿä¸­æ‰€æœ‰çš„é”®å¦‚ä¸‹ï¼š&quot;</span>);</span><br><span class="line">Â Â Â Â Set&lt;String&gt; keys = jedis.keys(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(keys);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤é”®password:&quot;</span>+jedis.del(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ¤æ–­é”®passwordæ˜¯å¦å­˜</span></span><br><span class="line"><span class="string">åœ¨ï¼š&quot;</span>+jedis.exists(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æŸ¥çœ‹é”®usernameæ‰€å­˜å‚¨çš„å€¼çš„ç±»</span></span><br><span class="line"><span class="string">å‹ï¼š&quot;</span>+jedis.type(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;éšæœºè¿”å›keyç©ºé—´çš„ä¸€ä¸ªï¼š&quot;</span>+jedis.randomKey());</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;é‡å‘½åkeyï¼š&quot;</span>+jedis.rename(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;name&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;å–å‡ºæ”¹åçš„nameï¼š&quot;</span>+jedis.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æŒ‰ç´¢å¼•æŸ¥è¯¢ï¼š&quot;</span>+jedis.select(<span class="number">0</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤å½“å‰é€‰æ‹©æ•°æ®åº“ä¸­çš„æ‰€æœ‰keyï¼š&quot;</span>+jedis.flushDB());</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è¿”å›å½“å‰æ•°æ®åº“ä¸­keyçš„æ•°ç›®ï¼š&quot;</span>+jedis.dbSize());</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰keyï¼š&quot;</span>+jedis.flushAll());</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹Stringæ“ä½œçš„å‘½ä»¤</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestString</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">Â Â Â Â jedis.flushDB();</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===========å¢åŠ æ•°æ®===========&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(jedis.set(<span class="string">&quot;key1&quot;</span>,<span class="string">&quot;value1&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.set(<span class="string">&quot;key2&quot;</span>,<span class="string">&quot;value2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.set(<span class="string">&quot;key3&quot;</span>, <span class="string">&quot;value3&quot;</span>));</span><br><span class="line">      System.out.println(<span class="string">&quot;åˆ é™¤é”®key2:&quot;</span>+jedis.del(<span class="string">&quot;key2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–é”®key2:&quot;</span>+jedis.get(<span class="string">&quot;key2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;ä¿®æ”¹key1:&quot;</span>+jedis.set(<span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1Changed&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–key1çš„å€¼ï¼š&quot;</span>+jedis.get(<span class="string">&quot;key1&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åœ¨key3åé¢åŠ å…¥å€¼ï¼š&quot;</span>+jedis.append(<span class="string">&quot;key3&quot;</span>, <span class="string">&quot;End&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;key3çš„å€¼ï¼š&quot;</span>+jedis.get(<span class="string">&quot;key3&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;å¢åŠ å¤šä¸ªé”®å€¼å¯¹ï¼š&quot;</span>+jedis.mset(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;value01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;value02&quot;</span>,<span class="string">&quot;key03&quot;</span>,<span class="string">&quot;value03&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–å¤šä¸ªé”®å€¼å¯¹ï¼š&quot;</span>+jedis.mget(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;key03&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–å¤šä¸ªé”®å€¼å¯¹ï¼š&quot;</span>+jedis.mget(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;key03&quot;</span>,<span class="string">&quot;key04&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤å¤šä¸ªé”®å€¼å¯¹ï¼š&quot;</span>+jedis.del(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–å¤šä¸ªé”®å€¼å¯¹ï¼š&quot;</span>+jedis.mget(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;key03&quot;</span>));</span><br><span class="line">Â Â Â Â jedis.flushDB();</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===========æ–°å¢é”®å€¼å¯¹é˜²æ­¢è¦†ç›–åŸå…ˆå€¼==============&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(jedis.setnx(<span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.setnx(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.setnx(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2-new&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.get(<span class="string">&quot;key1&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.get(<span class="string">&quot;key2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===========æ–°å¢é”®å€¼å¯¹å¹¶è®¾ç½®æœ‰æ•ˆæ—¶é—´=============&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(jedis.setex(<span class="string">&quot;key3&quot;</span>, <span class="number">2</span>, <span class="string">&quot;value3&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.get(<span class="string">&quot;key3&quot;</span>));</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â TimeUnit.SECONDS.sleep(<span class="number">3</span>);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â Â Â Â System.out.println(jedis.get(<span class="string">&quot;key3&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===========è·å–åŸå€¼ï¼Œæ›´æ–°ä¸ºæ–°å€¼==========&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(jedis.getSet(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;key2GetSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.get(<span class="string">&quot;key2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å¾—key2çš„å€¼çš„å­—ä¸²ï¼š&quot;</span>+jedis.getrange(<span class="string">&quot;key2&quot;</span>, <span class="number">2</span>,<span class="number">4</span>));</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹Listæ“ä½œå‘½ä»¤</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestList</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">Â Â Â Â jedis.flushDB();</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===========æ·»åŠ ä¸€ä¸ªlist===========&quot;</span>);</span><br><span class="line">Â Â Â Â jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;ArrayList&quot;</span>, <span class="string">&quot;Vector&quot;</span>, <span class="string">&quot;Stack&quot;</span>,</span><br><span class="line"><span class="string">&quot;HashMap&quot;</span>, <span class="string">&quot;WeakHashMap&quot;</span>, <span class="string">&quot;LinkedHashMap&quot;</span>);</span><br><span class="line">Â Â Â Â jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;HashSet&quot;</span>);</span><br><span class="line">Â Â Â Â jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;TreeSet&quot;</span>);</span><br><span class="line">Â Â Â Â jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;TreeMap&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„å†…å®¹ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">      <span class="comment">//-1ä»£è¡¨å€’æ•°ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ-2ä»£è¡¨å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ,endä¸º-1è¡¨ç¤ºæŸ¥è¯¢å…¨éƒ¨</span></span><br><span class="line">      System.out.println(<span class="string">&quot;collectionsåŒºé—´0-3çš„å…ƒç´ ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>,<span class="number">3</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===============================&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">// åˆ é™¤åˆ—è¡¨æŒ‡å®šçš„å€¼ ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºåˆ é™¤çš„ä¸ªæ•°ï¼ˆæœ‰é‡å¤æ—¶ï¼‰ï¼Œåaddè¿›å»çš„å€¼å…ˆè¢«åˆ ï¼Œç±»ä¼¼äºå‡ºæ ˆ</span></span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤æŒ‡å®šå…ƒç´ ä¸ªæ•°ï¼š&quot;</span>+jedis.lrem(<span class="string">&quot;collections&quot;</span>, <span class="number">2</span>,<span class="string">&quot;HashMap&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„å†…å®¹ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤ä¸‹è¡¨0-3åŒºé—´ä¹‹å¤–çš„å…ƒç´ ï¼š&quot;</span>+jedis.ltrim(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„å†…å®¹ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsåˆ—è¡¨å‡ºæ ˆï¼ˆå·¦ç«¯ï¼‰ï¼š&quot;</span>+jedis.lpop(<span class="string">&quot;collections&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„å†…å®¹ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsæ·»åŠ å…ƒç´ ï¼Œä»åˆ—è¡¨å³ç«¯ï¼Œä¸lpushç›¸å¯¹åº”ï¼š&quot;</span>+jedis.rpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;EnumMap&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„å†…å®¹ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsåˆ—è¡¨å‡ºæ ˆï¼ˆå³ç«¯ï¼‰ï¼š&quot;</span>+jedis.rpop(<span class="string">&quot;collections&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„å†…å®¹ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;ä¿®æ”¹collectionsæŒ‡å®šä¸‹æ ‡1çš„å†…å®¹ï¼š&quot;</span>+jedis.lset(<span class="string">&quot;collections&quot;</span>, <span class="number">1</span>, <span class="string">&quot;LinkedArrayList&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„å†…å®¹ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===============================&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;collectionsçš„é•¿åº¦ï¼š&quot;</span>+jedis.llen(<span class="string">&quot;collections&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–collectionsä¸‹æ ‡ä¸º2çš„å…ƒç´ ï¼š&quot;</span>+jedis.lindex(<span class="string">&quot;collections&quot;</span>, <span class="number">2</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;===============================&quot;</span>);</span><br><span class="line">Â Â Â Â jedis.lpush(<span class="string">&quot;sortedList&quot;</span>, <span class="string">&quot;3&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;0&quot;</span>,<span class="string">&quot;7&quot;</span>,<span class="string">&quot;4&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;sortedListæ’åºå‰ï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;sortedList&quot;</span>, <span class="number">0</span>,-<span class="number">1</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.sort(<span class="string">&quot;sortedList&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;sortedListæ’åºåï¼š&quot;</span>+jedis.lrange(<span class="string">&quot;sortedList&quot;</span>, <span class="number">0</span>,-<span class="number">1</span>));</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹Setçš„æ“ä½œå‘½ä»¤</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSet</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">Â Â Â Â jedis.flushDB();</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;============å‘é›†åˆä¸­æ·»åŠ å…ƒç´ ï¼ˆä¸é‡å¤ï¼‰============&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(jedis.sadd(<span class="string">&quot;eleSet&quot;</span>,<span class="string">&quot;e1&quot;</span>,<span class="string">&quot;e2&quot;</span>,<span class="string">&quot;e4&quot;</span>,<span class="string">&quot;e3&quot;</span>,<span class="string">&quot;e0&quot;</span>,<span class="string">&quot;e8&quot;</span>,<span class="string">&quot;e7&quot;</span>,<span class="string">&quot;e5&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.sadd(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e6&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.sadd(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e6&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤ä¸€ä¸ªå…ƒç´ e0ï¼š&quot;</span>+jedis.srem(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e0&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤ä¸¤ä¸ªå…ƒç´ e7å’Œe6ï¼š&quot;</span>+jedis.srem(<span class="string">&quot;eleSet&quot;</span>,<span class="string">&quot;e7&quot;</span>,<span class="string">&quot;e6&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;éšæœºçš„ç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼š&quot;</span>+jedis.spop(<span class="string">&quot;eleSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;éšæœºçš„ç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼š&quot;</span>+jedis.spop(<span class="string">&quot;eleSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSetä¸­åŒ…å«å…ƒç´ çš„ä¸ªæ•°ï¼š&quot;</span>+jedis.scard(<span class="string">&quot;eleSet&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;e3æ˜¯å¦åœ¨eleSetä¸­ï¼š&quot;</span>+jedis.sismember(<span class="string">&quot;eleSet&quot;</span>,<span class="string">&quot;e3&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;e1æ˜¯å¦åœ¨eleSetä¸­ï¼š&quot;</span>+jedis.sismember(<span class="string">&quot;eleSet&quot;</span>,<span class="string">&quot;e1&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;e1æ˜¯å¦åœ¨eleSetä¸­ï¼š&quot;</span>+jedis.sismember(<span class="string">&quot;eleSet&quot;</span>,<span class="string">&quot;e5&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;=================================&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(jedis.sadd(<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;e1&quot;</span>,<span class="string">&quot;e2&quot;</span>,<span class="string">&quot;e4&quot;</span>,<span class="string">&quot;e3&quot;</span>,<span class="string">&quot;e0&quot;</span>,<span class="string">&quot;e8&quot;</span>,<span class="string">&quot;e7&quot;</span>,<span class="string">&quot;e5&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(jedis.sadd(<span class="string">&quot;eleSet2&quot;</span>,<span class="string">&quot;e1&quot;</span>,<span class="string">&quot;e2&quot;</span>,<span class="string">&quot;e4&quot;</span>,<span class="string">&quot;e3&quot;</span>,<span class="string">&quot;e0&quot;</span>,<span class="string">&quot;e8&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;å°†eleSet1ä¸­åˆ é™¤e1å¹¶å­˜å…¥eleSet3ä¸­ï¼š&quot;</span>+jedis.smove(<span class="string">&quot;eleSet1&quot;</span>, <span class="string">&quot;eleSet3&quot;</span>, <span class="string">&quot;e1&quot;</span>));</span><br><span class="line">      <span class="comment">//ç§»åˆ°é›†åˆå…ƒç´ </span></span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;å°†eleSet1ä¸­åˆ é™¤e2å¹¶å­˜å…¥eleSet3ä¸­ï¼š&quot;</span>+jedis.smove(<span class="string">&quot;eleSet1&quot;</span>, <span class="string">&quot;eleSet3&quot;</span>, <span class="string">&quot;e2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet1ä¸­çš„å…ƒç´ ï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet1&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet3ä¸­çš„å…ƒç´ ï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet3&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;============é›†åˆè¿ç®—=================&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet1ä¸­çš„å…ƒç´ ï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet1&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet2ä¸­çš„å…ƒç´ ï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet1å’ŒeleSet2çš„äº¤é›†:&quot;</span>+jedis.sinter(<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet1å’ŒeleSet2çš„å¹¶é›†:&quot;</span>+jedis.sunion(<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet1å’ŒeleSet2çš„å·®é›†:&quot;</span>+jedis.sdiff(<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>));<span class="comment">//eleSet1ä¸­æœ‰ï¼ŒeleSet2ä¸­æ²¡æœ‰</span></span><br><span class="line">Â Â Â Â jedis.sinterstore(<span class="string">&quot;eleSet4&quot;</span>,<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>);<span class="comment">//æ±‚äº¤é›†å¹¶å°†äº¤é›†ä¿å­˜åˆ°dstkeyçš„é›†åˆ</span></span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;eleSet4ä¸­çš„å…ƒç´ ï¼š&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet4&quot;</span>));</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹Hashçš„æ“ä½œå‘½ä»¤</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHash</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">Â Â Â Â jedis.flushDB();</span><br><span class="line">Â Â Â Â Map&lt;String,String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">Â Â Â Â map.put(<span class="string">&quot;key1&quot;</span>,<span class="string">&quot;value1&quot;</span>);</span><br><span class="line">Â Â Â Â map.put(<span class="string">&quot;key2&quot;</span>,<span class="string">&quot;value2&quot;</span>);</span><br><span class="line">Â Â Â Â map.put(<span class="string">&quot;key3&quot;</span>,<span class="string">&quot;value3&quot;</span>);</span><br><span class="line">Â Â Â Â map.put(<span class="string">&quot;key4&quot;</span>,<span class="string">&quot;value4&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//æ·»åŠ åç§°ä¸ºhashï¼ˆkeyï¼‰çš„hashå…ƒç´ </span></span><br><span class="line">Â Â Â Â jedis.hmset(<span class="string">&quot;hash&quot;</span>,map);</span><br><span class="line">Â Â Â Â <span class="comment">//å‘åç§°ä¸ºhashçš„hashä¸­æ·»åŠ keyä¸ºkey5ï¼Œvalueä¸ºvalue5å…ƒç´ </span></span><br><span class="line">Â Â Â Â jedis.hset(<span class="string">&quot;hash&quot;</span>, <span class="string">&quot;key5&quot;</span>, <span class="string">&quot;value5&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ•£åˆ—hashçš„æ‰€æœ‰é”®å€¼å¯¹ä¸ºï¼š&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));<span class="comment">//return Map&lt;String,String&gt;</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ•£åˆ—hashçš„æ‰€æœ‰é”®ä¸ºï¼š&quot;</span>+jedis.hkeys(<span class="string">&quot;hash&quot;</span>));<span class="comment">//returnSet&lt;String&gt;</span></span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ•£åˆ—hashçš„æ‰€æœ‰å€¼ä¸ºï¼š&quot;</span>+jedis.hvals(<span class="string">&quot;hash&quot;</span>));<span class="comment">//returnList&lt;String&gt;</span></span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;å°†key6ä¿å­˜çš„å€¼åŠ ä¸Šä¸€ä¸ªæ•´æ•°ï¼Œå¦‚æœkey6ä¸å­˜åœ¨åˆ™æ·»åŠ key6ï¼š&quot;</span>+jedis.hincrBy(<span class="string">&quot;hash&quot;</span>, <span class="string">&quot;key6&quot;</span>, <span class="number">6</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ•£åˆ—hashçš„æ‰€æœ‰é”®å€¼å¯¹ä¸ºï¼š&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;å°†key6ä¿å­˜çš„å€¼åŠ ä¸Šä¸€ä¸ªæ•´æ•°ï¼Œå¦‚æœkey6ä¸å­˜åœ¨åˆ™æ·»åŠ key6ï¼š&quot;</span>+jedis.hincrBy(<span class="string">&quot;hash&quot;</span>, <span class="string">&quot;key6&quot;</span>, <span class="number">3</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ•£åˆ—hashçš„æ‰€æœ‰é”®å€¼å¯¹ä¸ºï¼š&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ é™¤ä¸€ä¸ªæˆ–è€…å¤šä¸ªé”®å€¼å¯¹ï¼š&quot;</span>+jedis.hdel(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ•£åˆ—hashçš„æ‰€æœ‰é”®å€¼å¯¹ä¸ºï¼š&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ•£åˆ—hashä¸­é”®å€¼å¯¹çš„ä¸ªæ•°ï¼š&quot;</span>+jedis.hlen(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ¤æ–­hashä¸­æ˜¯å¦å­˜åœ¨key2ï¼š&quot;</span>+jedis.hexists(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key2&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;åˆ¤æ–­hashä¸­æ˜¯å¦å­˜åœ¨key3ï¼š&quot;</span>+jedis.hexists(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key3&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–hashä¸­çš„å€¼ï¼š&quot;</span>+jedis.hmget(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key3&quot;</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;è·å–hashä¸­çš„å€¼ï¼š&quot;</span>+jedis.hmget(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key3&quot;</span>,<span class="string">&quot;key4&quot;</span>));</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>äº‹åŠ¡</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMulti</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//åˆ›å»ºå®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯ï¼ŒredisæœåŠ¡ç«¯éœ€è¦è¢«å¼€å¯</span></span><br><span class="line">Â Â Â Â Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">Â Â Â Â jedis.flushDB();</span><br><span class="line">Â Â Â Â JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">Â Â Â Â jsonObject.put(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">Â Â Â Â jsonObject.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;java&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line">Â Â Â Â Transaction multi = jedis.multi();</span><br><span class="line">Â Â Â Â String result = jsonObject.toJSONString();</span><br><span class="line">Â Â Â Â <span class="keyword">try</span>&#123;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//å‘rediså­˜å…¥ä¸€æ¡æ•°æ®</span></span><br><span class="line">Â Â Â Â Â Â multi.set(<span class="string">&quot;json&quot;</span>, result);</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//å†å­˜å…¥ä¸€æ¡æ•°æ®</span></span><br><span class="line">Â Â Â Â Â Â multi.set(<span class="string">&quot;json2&quot;</span>, result);</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//è¿™é‡Œå¼•å‘äº†å¼‚å¸¸ï¼Œç”¨0ä½œä¸ºè¢«é™¤æ•°</span></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">int</span> i = <span class="number">100</span>/<span class="number">0</span>;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//å¦‚æœæ²¡æœ‰å¼•å‘å¼‚å¸¸ï¼Œæ‰§è¡Œè¿›å…¥é˜Ÿåˆ—çš„å‘½ä»¤</span></span><br><span class="line">        multi.exec();</span><br><span class="line">Â Â Â &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œå›æ»š</span></span><br><span class="line">Â Â Â Â Â Â multi.discard();</span><br><span class="line">Â Â Â &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">Â Â Â Â Â Â System.out.println(jedis.get(<span class="string">&quot;json&quot;</span>));</span><br><span class="line">Â Â Â Â Â Â System.out.println(jedis.get(<span class="string">&quot;json2&quot;</span>));</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//æœ€ç»ˆå…³é—­å®¢æˆ·ç«¯</span></span><br><span class="line">Â Â Â Â Â Â jedis.close();</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="13-SpringBootæ•´åˆRedis"><a href="#13-SpringBootæ•´åˆRedis" class="headerlink" title="13.SpringBootæ•´åˆRedis"></a>13.SpringBootæ•´åˆRedis</h2><p>åœ¨SpringBootä¸­ä¸€èˆ¬ä½¿ç”¨RedisTemplateæä¾›çš„æ–¹æ³•æ¥æ“ä½œRedisã€‚é‚£ä¹ˆä½¿ç”¨SpringBootæ•´åˆRediséœ€è¦é‚£äº›æ­¥éª¤å‘¢ã€‚<br><strong>1ã€ JedisPoolConfig (è¿™ä¸ªæ˜¯é…ç½®è¿æ¥æ± )</strong></p>
<p><strong>2ã€ RedisConnectionFactory è¿™ä¸ªæ˜¯é…ç½®è¿æ¥ä¿¡æ¯ï¼Œè¿™é‡Œçš„RedisConnectionFactoryæ˜¯ä¸€ä¸ªæ¥å£</strong>ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å®ƒçš„å®ç°ç±»ï¼Œåœ¨SpringD Data Redisæ–¹æ¡ˆä¸­æä¾›äº†ä»¥ä¸‹å››ç§å·¥å‚æ¨¡å‹ï¼š</p>
<ul>
<li>JredisConnectionFactory</li>
<li>JedisConnectionFactory</li>
<li>LettuceConnectionFactory</li>
<li>SrpConnectionFactory</li>
</ul>
<p><strong>3ã€ RedisTemplate åŸºæœ¬æ“ä½œ</strong> </p>
<p>å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ymlé…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">Â <span class="attr">redis:</span></span><br><span class="line">Â Â <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">Â Â <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">Â Â <span class="attr">password:</span> <span class="string">*****</span></span><br><span class="line">Â Â <span class="attr">jedis:</span></span><br><span class="line">Â Â Â <span class="attr">pool:</span></span><br><span class="line">Â Â Â Â <span class="attr">max-active:</span> <span class="number">8</span></span><br><span class="line">Â Â Â Â <span class="attr">max-wait:</span> <span class="string">-1ms</span></span><br><span class="line">Â Â Â Â <span class="attr">max-idle:</span> <span class="number">500</span></span><br><span class="line">Â Â Â Â <span class="attr">min-idle:</span> <span class="number">0</span></span><br><span class="line">Â Â <span class="attr">lettuce:</span></span><br><span class="line">Â Â Â <span class="attr">shutdown-timeout:</span> <span class="string">0ms</span></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootRedisApplicationTests</span> </span>&#123;</span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="keyword">private</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â Â Â Â redisTemplate.opsForValue().set(<span class="string">&quot;myKey&quot;</span>,<span class="string">&quot;myValue&quot;</span>);</span><br><span class="line">Â Â Â Â System.out.println(redisTemplate.opsForValue().get(<span class="string">&quot;myKey&quot;</span>));</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å°è£…å·¥å…·ç±»</strong></p>
<p>åˆ†æ RedisAutoConfiguration è‡ªåŠ¨é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(RedisOperations.class)</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(RedisProperties.class)</span></span><br><span class="line"><span class="meta">@Import(&#123; LettuceConnectionConfiguration.class,JedisConnectionConfiguration.class &#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisAutoConfiguration</span> </span>&#123;</span><br><span class="line">    	<span class="meta">@Bean</span></span><br><span class="line">    	<span class="meta">@ConditionalOnMissingBean(name = &quot;redisTemplate&quot;)</span></span><br><span class="line">    	<span class="keyword">public</span> RedisTemplate&lt;Object, Object&gt;redisTemplate(RedisConnectionFactory redisConnectionFactory)</span><br><span class="line">    	<span class="keyword">throws</span> UnknownHostException &#123;</span><br><span class="line">    		RedisTemplate&lt;Object, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">    		template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">    		<span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">    	<span class="meta">@Bean</span></span><br><span class="line">   	 	<span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    	<span class="function"><span class="keyword">public</span> StringRedisTemplate <span class="title">stringRedisTemplate</span><span class="params">(RedisConnectionFactoryredisConnectionFactory)</span></span></span><br><span class="line"><span class="function">   		 <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">    		StringRedisTemplate template = <span class="keyword">new</span> StringRedisTemplate();</span><br><span class="line">    		template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">    		<span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æºç å¯ä»¥çœ‹å‡ºï¼ŒSpringBootè‡ªåŠ¨å¸®æˆ‘ä»¬åœ¨å®¹å™¨ä¸­ç”Ÿæˆäº†ä¸€ä¸ª<strong>RedisTemplate</strong>å’Œä¸€ä¸ª<strong>StringRedisTemplate</strong>ã€‚<br>ä½†æ˜¯ï¼Œè¿™ä¸ªRedisTemplateçš„æ³›å‹æ˜¯&lt;Object,Object&gt;ï¼Œå†™ä»£ç ä¸æ–¹ä¾¿ï¼Œ<strong>éœ€è¦å†™å¥½å¤šç±»å‹è½¬æ¢çš„ä»£ç </strong>ï¼›æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ³›å‹ä¸º&lt;String,Object&gt;å½¢å¼çš„RedisTemplateã€‚å¹¶ä¸”ï¼Œè¿™ä¸ªRedisTemplateæ²¡æœ‰è®¾ç½®æ•°æ®å­˜åœ¨Redisæ—¶ï¼ŒkeyåŠvalueçš„åºåˆ—åŒ–æ–¹å¼ã€‚<br>çœ‹åˆ°è¿™ä¸ª@ConditionalOnMissingBeanæ³¨è§£åï¼Œå°±çŸ¥é“å¦‚æœSpringå®¹å™¨ä¸­æœ‰äº†RedisTemplateå¯¹è±¡äº†ï¼Œè¿™ä¸ªè‡ªåŠ¨é…ç½®çš„RedisTemplateä¸ä¼šå®ä¾‹åŒ–ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥è‡ªå·±å†™ä¸ªé…ç½®ç±»ï¼Œ<strong>é…ç½®RedisTemplate</strong></p>
<p><strong>RedisTemplate</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> </span>&#123;</span><br><span class="line">Â <span class="meta">@Bean</span></span><br><span class="line">Â <span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">Â Â Â RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;String,Object&gt;();</span><br><span class="line">Â Â Â template.setConnectionFactory(factory);</span><br><span class="line">Â Â Â Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">Â Â Â ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">Â Â Â om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">Â Â Â om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">Â Â Â jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">Â Â Â StringRedisSerializer stringRedisSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line">Â Â </span><br><span class="line">Â Â Â <span class="comment">// keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span></span><br><span class="line">Â Â Â template.setKeySerializer(stringRedisSerializer);</span><br><span class="line">Â Â Â <span class="comment">// hashçš„keyä¹Ÿé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span></span><br><span class="line">Â Â Â template.setHashKeySerializer(stringRedisSerializer);</span><br><span class="line">Â Â Â <span class="comment">// valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span></span><br><span class="line">Â Â Â template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">Â Â Â <span class="comment">// hashçš„valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span></span><br><span class="line">Â Â Â template.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">Â Â Â template.afterPropertiesSet();</span><br><span class="line">Â Â </span><br><span class="line">Â Â Â <span class="keyword">return</span> template;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å†™ä¸€ä¸ªRediså·¥å…·ç±»ï¼ˆç›´æ¥ç”¨RedisTemplateæ“ä½œRedisï¼Œéœ€è¦å¾ˆå¤šè¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥å°è£…å¥½ä¸€ä¸ªRedisUtilsï¼Œè¿™æ ·å†™ä»£ç æ›´æ–¹ä¾¿ç‚¹ã€‚è¿™ä¸ªRedisUtilsäº¤ç»™Springå®¹å™¨å®ä¾‹åŒ–ï¼Œä½¿ç”¨æ—¶ç›´æ¥æ³¨è§£æ³¨å…¥ã€‚ï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisUtil</span> </span>&#123;</span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line">Â </span><br><span class="line">Â Â <span class="comment">// =============================common============================</span></span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æŒ‡å®šç¼“å­˜å¤±æ•ˆæ—¶é—´</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">expire</span><span class="params">(String key, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â redisTemplate.expire(key, time, TimeUnit.SECONDS);</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ ¹æ®key è·å–è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> æ—¶é—´(ç§’) è¿”å›0ä»£è¡¨ä¸ºæ°¸ä¹…æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getExpire</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.getExpire(key, TimeUnit.SECONDS);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasKey</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.hasKey(key);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * åˆ é™¤ç¼“å­˜</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key å¯ä»¥ä¼ ä¸€ä¸ªå€¼ æˆ–å¤šä¸ª</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">del</span><span class="params">(String... key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span> (key != <span class="keyword">null</span> &amp;&amp; key.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span> (key.length == <span class="number">1</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â redisTemplate.delete(key[<span class="number">0</span>]);</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â redisTemplate.delete(CollectionUtils.arrayToList(key));</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">    <span class="comment">// ============================String=============================</span></span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ™®é€šç¼“å­˜è·å–</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> å€¼</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> key == <span class="keyword">null</span> ? <span class="keyword">null</span> : redisTemplate.opsForValue().get(key);</span><br><span class="line">Â &#125;</span><br><span class="line">Â </span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ™®é€šç¼“å­˜æ”¾å…¥</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> trueæˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForValue().set(key, value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ™®é€šç¼“å­˜æ”¾å…¥å¹¶è®¾ç½®æ—¶é—´</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> time æ—¶é—´(ç§’) timeè¦å¤§äº0 å¦‚æœtimeå°äºç­‰äº0 å°†è®¾ç½®æ— é™æœŸ</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> trueæˆåŠŸ false å¤±è´¥</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(String key, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â redisTemplate.opsForValue().set(key, value, time,TimeUnit.SECONDS);</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â set(key, value);</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * é€’å¢</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> delta è¦å¢åŠ å‡ (å¤§äº0)</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">incr</span><span class="params">(String key, <span class="keyword">long</span> delta)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;é€’å¢å› å­å¿…é¡»å¤§äº0&quot;</span>);</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, delta);</span><br><span class="line">Â &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * é€’å‡</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> delta è¦å‡å°‘å‡ (å°äº0)</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">decr</span><span class="params">(String key, <span class="keyword">long</span> delta)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;é€’å‡å› å­å¿…é¡»å¤§äº0&quot;</span>);</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, -delta);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">// ================================Map=================================</span></span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * HashGet</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> item é¡¹ ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> Object <span class="title">hget</span><span class="params">(String key, String item)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForHash().get(key, item);</span><br><span class="line">Â &#125;</span><br><span class="line">Â </span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * è·å–hashKeyå¯¹åº”çš„æ‰€æœ‰é”®å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> å¯¹åº”çš„å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> Map&lt;Object, Object&gt; <span class="title">hmget</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForHash().entries(key);</span><br><span class="line">Â &#125;</span><br><span class="line">Â </span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * HashSet</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> map å¯¹åº”å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * HashSet å¹¶è®¾ç½®æ—¶é—´</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> map å¯¹åº”å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> trueæˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â expire(key, time);</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> true æˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hset</span><span class="params">(String key, String item, Object value)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> time æ—¶é—´(ç§’) æ³¨æ„:å¦‚æœå·²å­˜åœ¨çš„hashè¡¨æœ‰æ—¶é—´,è¿™é‡Œå°†ä¼šæ›¿æ¢åŸæœ‰çš„æ—¶é—´</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> true æˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hset</span><span class="params">(String key, String item, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â expire(key, time);</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * åˆ é™¤hashè¡¨ä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> item é¡¹ å¯ä»¥ä½¿å¤šä¸ª ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hdel</span><span class="params">(String key, Object... item)</span> </span>&#123;</span><br><span class="line">Â Â Â Â redisTemplate.opsForHash().delete(key, item);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * åˆ¤æ–­hashè¡¨ä¸­æ˜¯å¦æœ‰è¯¥é¡¹çš„å€¼</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> item é¡¹ ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hHasKey</span><span class="params">(String key, String item)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForHash().hasKey(key, item);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * hashé€’å¢ å¦‚æœä¸å­˜åœ¨,å°±ä¼šåˆ›å»ºä¸€ä¸ª å¹¶æŠŠæ–°å¢åçš„å€¼è¿”å›</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> by Â è¦å¢åŠ å‡ (å¤§äº0)</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">hincr</span><span class="params">(String key, String item, <span class="keyword">double</span> by)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, by);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * hashé€’å‡</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> by Â è¦å‡å°‘è®°(å°äº0)</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">hdecr</span><span class="params">(String key, String item, <span class="keyword">double</span> by)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, -by);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">// ============================set=============================</span></span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ ¹æ®keyè·å–Setä¸­çš„æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> Set&lt;Object&gt; <span class="title">sGet</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForSet().members(key);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ ¹æ®valueä»ä¸€ä¸ªsetä¸­æŸ¥è¯¢,æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">sHasKey</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForSet().isMember(key, value);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å°†æ•°æ®æ”¾å…¥setç¼“å­˜</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> æˆåŠŸä¸ªæ•°</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sSet</span><span class="params">(String key, Object... values)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForSet().add(key, values);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å°†setæ•°æ®æ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> time Â æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> æˆåŠŸä¸ªæ•°</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sSetAndTime</span><span class="params">(String key, <span class="keyword">long</span> time, Object... values)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Long count = redisTemplate.opsForSet().add(key, values);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â expire(key, time);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> count;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * è·å–setç¼“å­˜çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sGetSetSize</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForSet().size(key);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * ç§»é™¤å€¼ä¸ºvalueçš„</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> ç§»é™¤çš„ä¸ªæ•°</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">setRemove</span><span class="params">(String key, Object... values)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Long count = redisTemplate.opsForSet().remove(key, values);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> count;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">// ===============================list=================================</span></span><br><span class="line">Â </span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * è·å–listç¼“å­˜çš„å†…å®¹</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> start å¼€å§‹</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> end Â ç»“æŸ 0 åˆ° -1ä»£è¡¨æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> List&lt;Object&gt; <span class="title">lGet</span><span class="params">(String key, <span class="keyword">long</span> start, <span class="keyword">long</span> end)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForList().range(key, start, end);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * è·å–listç¼“å­˜çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">lGetListSize</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForList().size(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * é€šè¿‡ç´¢å¼• è·å–listä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> index ç´¢å¼• index&gt;=0æ—¶ï¼Œ 0 è¡¨å¤´ï¼Œ1 ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ï¼›index&lt;0</span></span><br><span class="line"><span class="comment">æ—¶ï¼Œ-1ï¼Œè¡¨å°¾ï¼Œ-2å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> Object <span class="title">lGetIndex</span><span class="params">(String key, <span class="keyword">long</span> index)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> redisTemplate.opsForList().index(key, index);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â expire(key, time);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">      &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, List&lt;Object&gt; value)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, List&lt;Object&gt; value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â expire(key, time);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ ¹æ®ç´¢å¼•ä¿®æ”¹listä¸­çš„æŸæ¡æ•°æ®</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> index ç´¢å¼•</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lUpdateIndex</span><span class="params">(String key, <span class="keyword">long</span> index, Object value)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â redisTemplate.opsForList().set(key, index, value);</span><br><span class="line">Â Â Â Â Â Â ren <span class="keyword">true</span>;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * ç§»é™¤Nä¸ªå€¼ä¸ºvalue</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> key Â é”®</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> count ç§»é™¤å¤šå°‘ä¸ª</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span> ç§»é™¤çš„ä¸ªæ•°</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">lRemove</span><span class="params">(String key, <span class="keyword">long</span> count, Object value)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Long remove = redisTemplate.opsForList().remove(key, count,value);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> remove;</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">	Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å­¦ä¹ åœ°å€<a href="https://www.bilibili.com/video/BV1oW411u75R?from=search&amp;seid=3220241811845891398">https://www.bilibili.com/video/BV1oW411u75R?from=search&amp;seid=3220241811845891398</a></strong></p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxå­¦ä¹ ç¬”è®°</title>
    <url>/2021/04/20/Linux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Linuxå­¦ä¹ ç¬”è®°"><a href="#Linuxå­¦ä¹ ç¬”è®°" class="headerlink" title="Linuxå­¦ä¹ ç¬”è®°"></a>Linuxå­¦ä¹ ç¬”è®°</h1><p><strong>å­¦ä¹ åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1Sv411r7vd">ã€å°ç™½å…¥é—¨ é€šä¿—æ˜“æ‡‚ã€‘2021éŸ©é¡ºå¹³ ä¸€å‘¨å­¦ä¼šLinux_å“”å“©å“”å“© (ã‚œ-ã‚œ)ã¤ãƒ­ å¹²æ¯~-bilibili</a></strong></p>
<p>éŸ©è€å¸ˆå¿ å®å°ç²‰ä¸~~~</p>
<p><strong>æ„Ÿè°¢éŸ©è€å¸ˆçš„è®²è§£è§†é¢‘ï¼Œååˆ†æ„Ÿè°¢ï¼</strong></p>
<h2 id="1-æ–‡ä»¶å’Œç›®å½•"><a href="#1-æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="1. æ–‡ä»¶å’Œç›®å½•"></a>1. æ–‡ä»¶å’Œç›®å½•</h2><h3 id="1-1-cd-å‘½ä»¤"><a href="#1-1-cd-å‘½ä»¤" class="headerlink" title="1.1 cd å‘½ä»¤"></a>1.1 cd å‘½ä»¤</h3><ul>
<li>cd ~ å›åˆ°è‡ªå·±çš„å®¶ç›®å½•</li>
<li>cd /home è¿›å…¥ â€˜/ homeâ€™ ç›®å½•â€™ </li>
<li>cd .. è¿”å›ä¸Šä¸€çº§ç›®å½• </li>
<li>cd ../.. è¿”å›ä¸Šä¸¤çº§ç›®å½• </li>
<li>cd è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• </li>
<li>cd - è¿”å›ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½• </li>
</ul>
<h3 id="1-2-pwd-å‘½ä»¤"><a href="#1-2-pwd-å‘½ä»¤" class="headerlink" title="1.2 pwd å‘½ä»¤"></a>1.2 pwd å‘½ä»¤</h3><ul>
<li>pwd æ˜¾ç¤ºå·¥ä½œè·¯å¾„</li>
</ul>
<h3 id="1-3-ls-å‘½ä»¤"><a href="#1-3-ls-å‘½ä»¤" class="headerlink" title="1.3 ls å‘½ä»¤"></a>1.3 ls å‘½ä»¤</h3><ul>
<li>ls æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ </li>
<li>ls -F æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ </li>
<li>ls -l æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™ </li>
<li>ls -a æ˜¾ç¤ºéšè—æ–‡ä»¶ </li>
<li>ls <em>[0-9]</em> æ˜¾ç¤ºåŒ…å«æ•°å­—çš„æ–‡ä»¶åå’Œç›®å½•å</li>
<li>ls -l &gt;æ–‡ä»¶ åˆ—è¡¨çš„å†…å®¹å†™å…¥æ–‡ä»¶ä¸­ è¦†ç›–å†™</li>
<li>ls -al &gt;&gt;æ–‡ä»¶ åˆ—è¡¨çš„å†…å®¹è¿½åŠ åˆ°æ–‡ä»¶ä¸­çš„æœ«å°¾</li>
</ul>
<h3 id="1-4-cp-å‘½ä»¤"><a href="#1-4-cp-å‘½ä»¤" class="headerlink" title="1.4 cp å‘½ä»¤"></a>1.4 cp å‘½ä»¤</h3><ul>
<li>cp file1 file2 å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶ </li>
<li>cp dir/* . å¤åˆ¶ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°å½“å‰å·¥ä½œç›®å½• </li>
<li>cp -a /tmp/dir1 . å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½• </li>
<li>cp -a dir1 dir2 å¤åˆ¶ä¸€ä¸ªç›®å½• </li>
<li>cp -r dir1 dir2 å¤åˆ¶ä¸€ä¸ªç›®å½•åŠå­ç›®å½•</li>
</ul>
<h3 id="1-5-mv-å‘½ä»¤"><a href="#1-5-mv-å‘½ä»¤" class="headerlink" title="1.5 mv å‘½ä»¤"></a>1.5 mv å‘½ä»¤</h3><ul>
<li>mv oldNameFile newNameFile åŠŸèƒ½æè¿°:é‡å‘½å</li>
<li>mv /temp/movefile /targetFolder åŠŸèƒ½æè¿°:ç§»åŠ¨æ–‡ä»¶</li>
</ul>
<h3 id="1-6-rm-å‘½ä»¤"><a href="#1-6-rm-å‘½ä»¤" class="headerlink" title="1.6 rm å‘½ä»¤"></a>1.6 rm å‘½ä»¤</h3><ul>
<li>rm -f file1 åˆ é™¤ä¸€ä¸ªå«åš â€˜file1â€™ çš„æ–‡ä»¶â€™ </li>
<li>rmdir dir1 åˆ é™¤ä¸€ä¸ªå«åš â€˜dir1â€™ çš„ç›®å½•â€™ </li>
<li>rm -rf dir1 åˆ é™¤ä¸€ä¸ªå«åš â€˜dir1â€™ çš„ç›®å½•å¹¶åŒæ—¶åˆ é™¤å…¶å†…å®¹ </li>
<li>rm -rf dir1 dir2 åŒæ—¶åˆ é™¤ä¸¤ä¸ªç›®å½•åŠå®ƒä»¬çš„å†…å®¹ </li>
<li>mv dir1 new_dir é‡å‘½å/ç§»åŠ¨ ä¸€ä¸ªç›®å½• </li>
</ul>
<h3 id="1-7-mkdir-å‘½ä»¤"><a href="#1-7-mkdir-å‘½ä»¤" class="headerlink" title="1.7 mkdir å‘½ä»¤"></a>1.7 mkdir å‘½ä»¤</h3><ul>
<li>mkdir dir1 åˆ›å»ºä¸€ä¸ªå«åš â€˜dir1â€™ çš„ç›®å½•â€™ </li>
<li>mkdir dir1 dir2 åŒæ—¶åˆ›å»ºä¸¤ä¸ªç›®å½• </li>
<li>mkdir -p /tmp/dir1/dir2 åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘ </li>
</ul>
<h3 id="1-8-gt-å’Œ-gt-gt-å‘½ä»¤"><a href="#1-8-gt-å’Œ-gt-gt-å‘½ä»¤" class="headerlink" title="1.8 &gt; å’Œ &gt;&gt; å‘½ä»¤"></a>1.8 &gt; å’Œ &gt;&gt; å‘½ä»¤</h3><p>è¾“å‡ºå’Œé‡å®šå‘</p>
<ul>
<li> ls -l &gt; æ–‡ä»¶ åˆ—è¡¨çš„å†…å®¹å†™å…¥æ–‡ä»¶(è¦†ç›–å†™)</li>
<li>cat  æ–‡ä»¶1&gt; æ–‡ä»¶2 å°†æ–‡ä»¶1çš„å†…å®¹è¦†ç›–åˆ°æ–‡ä»¶2</li>
<li>echo â€œå†…å®¹â€ &gt;&gt; æ–‡ä»¶ è¿½åŠ  </li>
</ul>
<h2 id="2-æŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#2-æŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="2. æŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>2. æŸ¥çœ‹æ–‡ä»¶å†…å®¹</h2><h3 id="2-1-cat-å‘½ä»¤"><a href="#2-1-cat-å‘½ä»¤" class="headerlink" title="2.1 cat å‘½ä»¤"></a>2.1 cat å‘½ä»¤</h3><ul>
<li>cat file1 ä»ç¬¬ä¸€ä¸ªå­—èŠ‚æŸ¥çœ‹æ–‡ä»¶å†…å®¹</li>
<li>head æ–‡ä»¶   ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ† é»˜è®¤æ˜¯å‰10è¡Œå†…å®¹</li>
<li>head -n 5 æ–‡ä»¶ æ˜¾ç¤ºå‰5è¡Œ</li>
<li>tail æ–‡ä»¶   ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„æœ«å°¾éƒ¨åˆ† é»˜è®¤æ˜¯å10è¡Œå†…å®¹</li>
<li>tail -f æ–‡ä»¶ å®æ—¶è¿½è¸ªæ‰€æœ‰æ–‡æ¡£çš„æ›´æ–°</li>
<li>cat æ–‡ä»¶1&gt;æ–‡ä»¶2 å°†æ–‡ä»¶1çš„å†…å®¹è¦†ç›–åˆ°æ–‡ä»¶2</li>
</ul>
<h3 id="2-2-find-å‘½ä»¤"><a href="#2-2-find-å‘½ä»¤" class="headerlink" title="2.2 find å‘½ä»¤"></a>2.2 find å‘½ä»¤</h3><ul>
<li>find -name æŒ‰ç…§æŒ‡å®šçš„æ–‡ä»¶åæŸ¥æ‰¾æ¨¡å¼æŸ¥æ‰¾æ–‡ä»¶</li>
<li>find -user ç”¨æˆ·å æŸ¥æ‰¾å±äºæŒ‡å®šç”¨æˆ·åæ‰€æœ‰æ–‡ä»¶</li>
<li>find -size æŒ‰ç…§æŒ‡å®šçš„æ–‡ä»¶å¤§å°æŸ¥æ‰¾æ–‡ä»¶</li>
</ul>
<h2 id="3-æ–‡ä»¶æƒé™"><a href="#3-æ–‡ä»¶æƒé™" class="headerlink" title="3. æ–‡ä»¶æƒé™"></a>3. æ–‡ä»¶æƒé™</h2><h3 id="3-1-chmod-å‘½ä»¤"><a href="#3-1-chmod-å‘½ä»¤" class="headerlink" title="3.1 chmod å‘½ä»¤"></a>3.1 chmod å‘½ä»¤</h3><ul>
<li>ls -lh æ˜¾ç¤ºæƒé™</li>
<li>chmod ugo+rwx directory1 è®¾ç½®ç›®å½•æ‰€æœ‰äºº(u),ç¾¤ç»„(g),å…¶ä»–äºº(o)ä»¥è¯»(r,4),å†™(w,2),æ‰§è¡Œ(x,1)</li>
<li>chown ç”¨æˆ·å æ–‡ä»¶å  ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…</li>
<li>chown newowner æ–‡ä»¶/ç›®å½•  æ”¹å˜æ‰€æœ‰è€…</li>
<li>chown newowner:newgroup æ–‡ä»¶/ç›®å½• æ”¹å˜æ‰€æœ‰è€…å’Œæ‰€åœ¨ç»„</li>
<li>chgrp newgroup æ–‡ä»¶/ç›®å½• æ”¹å˜æ‰€åœ¨ç»„</li>
</ul>
<h3 id="3-2-ç»„åç›¸å…³å‘½ä»¤"><a href="#3-2-ç»„åç›¸å…³å‘½ä»¤" class="headerlink" title="3.2 ç»„åç›¸å…³å‘½ä»¤"></a>3.2 ç»„åç›¸å…³å‘½ä»¤</h3><ul>
<li>groupadd ç»„å åˆ›å»ºç»„</li>
<li>useradd -g ç»„å ç”¨æˆ·å </li>
<li>chgro ç»„å æ–‡ä»¶å/ç›®å½•å   ä¿®æ”¹æ–‡ä»¶æ‰€åœ¨çš„ç»„</li>
<li>usermod -g ç»„å ç”¨æˆ·å </li>
<li>usermod -d ç›®å½•å ç”¨æˆ·å æ”¹å˜è¯¥ç”¨æˆ·ç™»å½•çš„åˆå§‹ç›®å½•</li>
</ul>
<h3 id="3-3-grepæŒ‡ä»¤"><a href="#3-3-grepæŒ‡ä»¤" class="headerlink" title="3.3 grepæŒ‡ä»¤"></a>3.3 grepæŒ‡ä»¤</h3><p>grep é€‰é¡¹ æŸ¥æ‰¾å†…å®¹ æºæ–‡ä»¶</p>
<ul>
<li>grep é€‰é¡¹ æŸ¥æ‰¾å†…å®¹ æºæ–‡ä»¶</li>
<li>grep -n æ˜¾ç¤ºåŒ¹é…è¡ŒåŠè¡Œå·</li>
<li>grep -i  å¿½ç•¥å­—æ¯å¤§å°å†™</li>
</ul>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>-n</td>
<td>å¿½ç•¥åŒ¹é…åŠè¡Œå·</td>
</tr>
<tr>
<td>-i</td>
<td>å¿½ç•¥å­—æ¯å¤§å°å†™</td>
</tr>
</tbody></table>
<h2 id="4-æ–‡ä»¶æ‰“åŒ…å’Œè§£å‹"><a href="#4-æ–‡ä»¶æ‰“åŒ…å’Œè§£å‹" class="headerlink" title="4. æ–‡ä»¶æ‰“åŒ…å’Œè§£å‹"></a>4. æ–‡ä»¶æ‰“åŒ…å’Œè§£å‹</h2><h3 id="4-1-tar-å‘½ä»¤"><a href="#4-1-tar-å‘½ä»¤" class="headerlink" title="4.1 tar å‘½ä»¤"></a>4.1 tar å‘½ä»¤</h3><ul>
<li>tar é€‰é¡¹ XXX.tar.gz æ‰“åŒ…çš„å†…å®¹   æ‰“åŒ…ç›®å½•ï¼Œå‹ç¼©åçš„æ–‡ä»¶æ ¼å¼.tar.gz</li>
<li>tar -c äº§ç”Ÿ.taræ‰“åŒ…æ–‡ä»¶</li>
<li>tar -v æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</li>
<li>tar -f æŒ‡å®šå‹ç¼©åçš„æ–‡ä»¶å</li>
<li>tar -z æ‰“åŒ…åŒæ—¶å‹ç¼©</li>
<li>tar -x è§£åŒ….taræ–‡ä»¶</li>
<li>gzip æ–‡ä»¶ å‹ç¼©æ–‡ä»¶ åªèƒ½å°†æ–‡ä»¶å‹ç¼©ä¸º*.gzæ–‡ä»¶</li>
<li>gunzip æ–‡ä»¶.gz è§£å‹ç¼©æ–‡ä»¶å‘½ä»¤</li>
<li>zip é€‰é¡¹ XXX.zip å°†è¦å‹ç¼©çš„å†…å®¹ å‹ç¼©æ–‡ä»¶å’Œç›®å½•çš„å‘½ä»¤</li>
<li>unzip é€‰é¡¹ XXX.zip è§£å‹ç¼©æ–‡ä»¶ </li>
<li>zip -r é€’å½’å‹ç¼© å³å‹ç¼©ç›®å½•</li>
<li>unzip -d ç›®å½• æŒ‡å®šè§£å‹åæ–‡ä»¶çš„å­˜æ”¾ç›®å½•</li>
</ul>
<h2 id="5-ç³»ç»Ÿç›¸å…³å‘½ä»¤"><a href="#5-ç³»ç»Ÿç›¸å…³å‘½ä»¤" class="headerlink" title="5. ç³»ç»Ÿç›¸å…³å‘½ä»¤"></a>5. ç³»ç»Ÿç›¸å…³å‘½ä»¤</h2><h3 id="5-1-ps-å‘½ä»¤"><a href="#5-1-ps-å‘½ä»¤" class="headerlink" title="5.1 ps å‘½ä»¤"></a>5.1 ps å‘½ä»¤</h3><ul>
<li>ps -a æ˜¾ç¤ºå½“å‰ç»ˆç«¯çš„æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯</li>
<li>ps -u ä»¥ç”¨æˆ·çš„æ ¼å¼æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯</li>
<li>ps -x æ˜¾ç¤ºåå°è¿›ç¨‹è¿è¡Œçš„å‚æ•°</li>
</ul>
<h3 id="5-2-kill-å‘½ä»¤"><a href="#5-2-kill-å‘½ä»¤" class="headerlink" title="5.2 kill å‘½ä»¤"></a>5.2 kill å‘½ä»¤</h3><ul>
<li>kill é€‰é¡¹ è¿›ç¨‹å· é€šè¿‡è¿›ç¨‹å·æ€æ­»è¿›ç¨‹</li>
<li>kill all è¿›ç¨‹åç§°  é€šè¿‡è¿›ç¨‹åç§°æ€æ­»è¿›ç¨‹ ä¹Ÿæ”¯æŒé€šé…ç¬¦ </li>
<li>kill -9 è¡¨ç¤ºå¼ºè¿«è¿›ç¨‹ç«‹å³åœæ­¢</li>
</ul>
<h3 id="5-3-postree-å‘½ä»¤"><a href="#5-3-postree-å‘½ä»¤" class="headerlink" title="5.3 postree å‘½ä»¤"></a>5.3 postree å‘½ä»¤</h3><ul>
<li>pstree é€‰é¡¹ å¯ä»¥æ›´åŠ ç›´è§‚çš„æ¥æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</li>
<li>pstree -p æ˜¾ç¤ºè¿›ç¨‹çš„PID</li>
<li>pstree -u æ˜¾ç¤ºè¿›ç¨‹çš„æ‰€å±ç”¨æˆ·</li>
</ul>
<h3 id="5-4-systemctl-å‘½ä»¤"><a href="#5-4-systemctl-å‘½ä»¤" class="headerlink" title="5.4 systemctl å‘½ä»¤"></a>5.4 systemctl å‘½ä»¤</h3><ul>
<li>systemctl list-unit-files |æœåŠ¡å æŸ¥çœ‹æœåŠ¡å™¨å¼€æœºå¯åŠ¨çŠ¶æ€ ï¼Œgrepå¯ä»¥è¿‡æ»¤</li>
<li>systemctl enable æœåŠ¡å è®¾ç½®æœåŠ¡å¼€æœºå¯åŠ¨</li>
<li>systemctl disable æœåŠ¡å å…³é—­æœåŠ¡å¼€æœºå¯åŠ¨</li>
<li>systemctl is-enabled æœåŠ¡å æŸ¥è¯¢æŸä¸ªæœåŠ¡æ˜¯å¦è‡ªå¯åŠ¨</li>
</ul>
<h3 id="5-5-crontab-å‘½ä»¤"><a href="#5-5-crontab-å‘½ä»¤" class="headerlink" title="5.5  crontab  å‘½ä»¤"></a>5.5  crontab  å‘½ä»¤</h3><ul>
<li> crontab -e ç¼–è¾‘crontabå®šæ—¶ä»»</li>
<li>crontab -l æŸ¥è¯¢crontabä»»åŠ¡ </li>
<li>crontab -r åˆ é™¤å½“å‰ç”¨æˆ·æ‰€æœ‰çš„crontabä»»åŠ¡</li>
</ul>
<h3 id="5-6-top-å‘½ä»¤"><a href="#5-6-top-å‘½ä»¤" class="headerlink" title="5.6 top å‘½ä»¤"></a>5.6 top å‘½ä»¤</h3><ul>
<li>top -P ä»¥CPUä½¿ç”¨ç‡æ’åºï¼Œé»˜è®¤æ˜¯æ­¤é¡¹</li>
<li>top -M ä»¥å†…å­˜çš„ä½¿ç”¨ç‡æ’åº</li>
<li>top -N ä»¥PIDæ’åº</li>
<li>top -q é€€å‡ºtop</li>
</ul>
<h3 id="5-7-æŸ¥çœ‹è¿›ç¨‹å‘½ä»¤"><a href="#5-7-æŸ¥çœ‹è¿›ç¨‹å‘½ä»¤" class="headerlink" title="5.7 æŸ¥çœ‹è¿›ç¨‹å‘½ä»¤"></a>5.7 æŸ¥çœ‹è¿›ç¨‹å‘½ä»¤</h3><ul>
<li>netstat -an æŸ¥çœ‹ç³»ç»Ÿç½‘ç»œæƒ…å†µ æŒ‰ä¸€å®šé¡ºåºæ’åˆ—è¾“å‡º</li>
<li>netstat -p æ˜¾ç¤ºå“ªä¸ªè¿›ç¨‹åœ¨è°ƒç”¨</li>
<li>nestat -tunlp|grep ç«¯å£å· ç­›é€‰æŸ¥è¯¢</li>
</ul>
<h3 id="5-8-å…³æœºå‘½ä»¤ç›¸å…³"><a href="#5-8-å…³æœºå‘½ä»¤ç›¸å…³" class="headerlink" title="5.8 å…³æœºå‘½ä»¤ç›¸å…³"></a>5.8 å…³æœºå‘½ä»¤ç›¸å…³</h3><ul>
<li>shutdown -h now å…³é—­ç³»ç»Ÿ</li>
<li>init 0 å…³é—­ç³»ç»Ÿ</li>
<li>telinit 0 å…³é—­ç³»ç»Ÿ</li>
<li>shutdown -h hours:minutes &amp; æŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ </li>
<li>shutdown -c å–æ¶ˆæŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ </li>
<li>shutdown -r now é‡å¯</li>
<li>reboot é‡å¯</li>
<li>logout æ³¨é”€ </li>
</ul>
<h3 id="5-9-firewall-å‘½ä»¤"><a href="#5-9-firewall-å‘½ä»¤" class="headerlink" title="5.9 firewall å‘½ä»¤"></a>5.9 firewall å‘½ä»¤</h3><ul>
<li>æ‰“å¼€ç«¯å£ firewall-cmd-permanent-add-port=ç«¯å£å·/åè®®</li>
<li>å…³é—­ç«¯å£ firewall-cmd-permanet-remove-port=ç«¯å£å·/åè®®</li>
<li>é‡æ–°è½½å…¥ï¼Œæ‰èƒ½ç”Ÿæ•ˆ firewall-cmd â€“reload</li>
<li>æŸ¥è¯¢ç«¯å£æ˜¯å¦å¼€æ”¾ firewall-cmd â€“query-port=ç«¯å£/åè®®</li>
</ul>
<h2 id="6-å…¶ä»–å‘½ä»¤æ–¹ä¾¿æŸ¥é˜…"><a href="#6-å…¶ä»–å‘½ä»¤æ–¹ä¾¿æŸ¥é˜…" class="headerlink" title="6. å…¶ä»–å‘½ä»¤æ–¹ä¾¿æŸ¥é˜…"></a>6. å…¶ä»–å‘½ä»¤æ–¹ä¾¿æŸ¥é˜…</h2><blockquote>
<p>arch æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<br>uname -m æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<br>uname -r æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬<br>dmidecode -q æ˜¾ç¤ºç¡¬ä»¶ç³»ç»Ÿéƒ¨ä»¶ - (SMBIOS / DMI)<br>hdparm -i /dev/hda ç½—åˆ—ä¸€ä¸ªç£ç›˜çš„æ¶æ„ç‰¹æ€§<br>hdparm -tT /dev/sda åœ¨ç£ç›˜ä¸Šæ‰§è¡Œæµ‹è¯•æ€§è¯»å–æ“ä½œ<br>cat /proc/cpuinfo æ˜¾ç¤ºCPU infoçš„ä¿¡æ¯<br>cat /proc/interrupts æ˜¾ç¤ºä¸­æ–­<br>cat /proc/meminfo æ ¡éªŒå†…å­˜ä½¿ç”¨<br>cat /proc/swaps æ˜¾ç¤ºå“ªäº›swapè¢«ä½¿ç”¨<br>cat /proc/version æ˜¾ç¤ºå†…æ ¸çš„ç‰ˆæœ¬<br>cat /proc/net/dev æ˜¾ç¤ºç½‘ç»œé€‚é…å™¨åŠç»Ÿè®¡<br>cat /proc/mounts æ˜¾ç¤ºå·²åŠ è½½çš„æ–‡ä»¶ç³»ç»Ÿ<br>lspci -tv ç½—åˆ— PCI è®¾å¤‡<br>lsusb -tv æ˜¾ç¤º USB è®¾å¤‡<br>date æ˜¾ç¤ºç³»ç»Ÿæ—¥æœŸ<br>cal 2007 æ˜¾ç¤º2007å¹´çš„æ—¥å†è¡¨<br>date 041217002007.00 è®¾ç½®æ—¥æœŸå’Œæ—¶é—´ - æœˆæ—¥æ—¶åˆ†å¹´.ç§’<br>clock -w å°†æ—¶é—´ä¿®æ”¹ä¿å­˜åˆ° BIOS </p>
<p>locate æ–‡ä»¶å æœç´¢æ–‡ä»¶</p>
<p>which æŒ‡ä»¤ å¯ä»¥æŸ¥çœ‹æŸä¸ªæŒ‡ä»¤åœ¨å“ªä¸ªç›®å½•ä¸‹ </p>
<p>xï¼šè¡¨ç¤ºå¯ä»¥è¿›å…¥åˆ°è¯¥ç›®å½•ï¼Œæ¯”å¦‚cd</p>
<p>rï¼šè¡¨ç¤ºå¯ä»¥ls å°†ç›®å½•çš„å†…å®¹æ˜¾ç¤º</p>
<p>wï¼š è¡¨ç¤ºå¯ä»¥åœ¨è¯¥ç›®å½•ï¼Œåˆ é™¤æˆ–è€…åˆ›å»ºæ–‡ä»¶</p>
<p>chkconfig â€“ list |grep xxx</p>
<p>chkconfig æœåŠ¡å â€“list</p>
<p>chkconfig â€“level 5 æœåŠ¡å on/off</p>
<p>tree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„<br>lstree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„</p>
<p>ln -s file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„è½¯é“¾æ¥<br>ln file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„ç‰©ç†é“¾æ¥<br>touch -t 0712250000 file1 ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³ - (YYMMDDhhmm)<br>file file1 outputs the mime type of the file as text<br>iconv -l åˆ—å‡ºå·²çŸ¥çš„ç¼–ç  </p>
<p>echo è¾“å‡ºå†…å®¹åˆ°æ§åˆ¶å°</p>
<p>echo â€œå†…å®¹â€ &gt;&gt;æ–‡ä»¶ è¿½åŠ </p>
<p>ln -såŸæ–‡ä»¶æˆ–ç›®å½• è½¯è¿æ¥å  ç»™åŸæ–‡ä»¶åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥</p>
<p>history æŸ¥çœ‹æ›¾ç»æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤ history 10 æœ€è¿‘10æ¡</p>
<p>ï¼5 æ›¾ç»æ‰§è¡Œçš„ç¬¬äº”æ¡å‘½ä»¤</p>
<p>ls -ahl æŸ¥çœ‹æ–‡ä»¶çš„æ‰€æœ‰è€…</p>
<p>ps -ef æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</p>
<p>ps -ef | grep atd å¯ä»¥æ£€æµ‹atdæ˜¯å¦åœ¨è¿è¡Œ</p>
<p>at é€‰é¡¹ æ—¶é—´</p>
<p>Ctrl +D ç»“æŸatå‘½ä»¤çš„è¾“å…¥</p>
<p>lsblk æŸ¥çœ‹æ‰€æœ‰è®¾å¤‡æŒ‚è½½æƒ…å†µ</p>
<p>mount è®¾å¤‡åç§° æŒ‚è½½ç›®å½•</p>
<p>unmount è®¾å¤‡åç§°æˆ–æŒ‚è½½ç›®å½•</p>
</blockquote>
<p><strong>more è¦æŸ¥çœ‹çš„æ–‡ä»¶</strong></p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>åŠŸèƒ½è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>ç©ºç™½é”®(space)</td>
<td>ä»£è¡¨å‘ä¸‹ç¿»ä¸€é¡µ</td>
</tr>
<tr>
<td>Enter</td>
<td>ä»£è¡¨å‘ä¸‹ç¿»ä¸€è¡Œ</td>
</tr>
<tr>
<td>q</td>
<td>ä»£è¡¨ç«‹åˆ»ç¦»å¼€moreï¼Œä¸å†æ˜¾ç¤ºè¯¥æ–‡ä»¶å†…å®¹</td>
</tr>
<tr>
<td>Ctrl+F</td>
<td>å‘ä¸‹æ»šåŠ¨ä¸€å±</td>
</tr>
<tr>
<td>Ctrl+B</td>
<td>è¿”å›ä¸Šä¸€å±</td>
</tr>
<tr>
<td>=</td>
<td>è¾“å‡ºå½“å‰è¡Œçš„è¡Œå·</td>
</tr>
<tr>
<td>:f</td>
<td>è¾“å‡ºæ–‡ä»¶åå’Œå½“å‰è¡Œçš„è¡Œå·</td>
</tr>
</tbody></table>
<p><strong>find æŒ‡ä»¤</strong></p>
<p>find æœç´¢èŒƒå›´ é€‰é¡¹</p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>-name&lt;æŸ¥è¯¢æ–¹å¼&gt;</td>
<td>å®‰è£…æŒ‡å®šçš„æ–‡ä»¶åæŸ¥æ‰¾æ¨¡å¼æŸ¥æ‰¾æ–‡ä»¶</td>
</tr>
<tr>
<td>-user&lt;ç”¨æˆ·å&gt;</td>
<td>æŒ‰ç…§æŒ‡å®šç”¨æˆ·åæ‰€æœ‰æ–‡ä»¶</td>
</tr>
<tr>
<td>-size&lt;æ–‡ä»¶å¤§å°&gt;</td>
<td>æŒ‰ç…§æŒ‡å®šæ–‡ä»¶å¤§å°æŸ¥æ‰¾æ–‡ä»¶</td>
</tr>
</tbody></table>
<p><strong>tar æŒ‡ä»¤</strong></p>
<p>tar é€‰é¡¹ XXX.tar.gz æ‰“åŒ…çš„å†…å®¹ (åŠŸèƒ½æè¿°ï¼Œæ‰“åŒ…ç›®å½•ï¼Œå‹ç¼©åçš„æ–‡ä»¶æ ¼å¼æ˜¯tar.gz)</p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>äº§ç”Ÿ.taræ‰“åŒ…æ–‡ä»¶</td>
</tr>
<tr>
<td>-v</td>
<td>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td>-f</td>
<td>æŒ‡å®šå‹ç¼©åçš„æ–‡ä»¶å</td>
</tr>
<tr>
<td>-z</td>
<td>æ‰“åŒ…åŒæ—¶å‹ç¼©</td>
</tr>
<tr>
<td>-x</td>
<td>è§£åŒ….taræ–‡ä»¶</td>
</tr>
</tbody></table>
<p><strong>crontab é€‰é¡¹</strong></p>
<table>
<thead>
<tr>
<th>-e</th>
<th>ç¼–è¾‘crontabå®šæ—¶ä»»åŠ¡</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>æŸ¥è¯¢crontabçš„ä»»åŠ¡</td>
</tr>
<tr>
<td>-r</td>
<td>åˆ é™¤å½“å‰æ‰€æœ‰ç”¨æˆ·çš„crontabä»»åŠ¡</td>
</tr>
</tbody></table>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-05-18_15-12-46.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-05-18_15-13-09.png" alt="Snipaste_2021-05-18_15-13-09"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-05-18_15-13-15.png" alt="Snipaste_2021-05-18_15-13-15"></p>
<blockquote>
<p>æ¡ˆä¾‹  æ¯éš”1åˆ†é’Ÿï¼Œå°†å½“å‰ä¿¡æ¯çš„æ—¥æœŸä¿¡æ¯è¿½åŠ åˆ° /tmp/mydate ç›®å½•ä¸‹</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> */**** date&gt;&gt; /tmp/mydate</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¡ˆä¾‹2 æ¯éš”1åˆ†é’Ÿï¼Œå°†å½“å‰æ—¥æœŸå’Œæ—¥å†éƒ½è¿½åŠ åˆ° /home/mycal æ–‡ä»¶ä¸­</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> vim /home/my.sh å†™å…¥å†…å®¹ date&gt;&gt; /home/mycal å’Œ cal &gt;&gt; /home/mycal</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> ç»™my.sh å¢åŠ æ‰§è¡Œæƒé™ chomd u+x /home/my.sh</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> crontab -e å¢åŠ  */1**** /home/my.sh</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¡ˆä¾‹3  æ¯äººå‡Œæ™¨2:00 å°†mysqlæ•°æ®åº“ testdbï¼Œå¤‡ä»½åˆ°æ–‡ä»¶ä¸­ï¼Œæç¤º æŒ‡ä»¤ä¸º: mysqldump -u root -p å¯†ç  æ•°æ®åº“ &gt; /home/db.bak</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> crontab -e</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> 0 2 *** mysqldump -u root -proot æ•°æ®åº“å &gt;home/db.bak</span></span><br></pre></td></tr></table></figure>



<h2 id="7-å®‰è£…ç›¸å…³è½¯ä»¶"><a href="#7-å®‰è£…ç›¸å…³è½¯ä»¶" class="headerlink" title="7. å®‰è£…ç›¸å…³è½¯ä»¶"></a>7. å®‰è£…ç›¸å…³è½¯ä»¶</h2><h3 id="7-1-å®‰è£…JDK"><a href="#7-1-å®‰è£…JDK" class="headerlink" title="7.1 å®‰è£…JDK"></a>7.1 å®‰è£…JDK</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mkdir /opt/jdk</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> é€šè¿‡xtfpä¸Šä¼ åˆ° /opt/jdkä¸‹</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /opt/jdk</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> è§£å‹ tar -zxvf å‹ç¼©åŒ…å</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> mkdir /usr/<span class="built_in">local</span>/java</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> mv /opt/jkd/jdk1.8.0_261 /usr/<span class="built_in">local</span>/java</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> é…ç½®ç¯å¢ƒå˜é‡ vim/etc/profile</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">export</span> JAVA_HOME=/usr/<span class="built_in">local</span>/java/jdk1.8.0_261</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">source</span> /etc/profile è®©æ–°çš„ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</span></span><br></pre></td></tr></table></figure>



<h3 id="7-2å®‰è£…tomcat"><a href="#7-2å®‰è£…tomcat" class="headerlink" title="7.2å®‰è£…tomcat"></a>7.2å®‰è£…tomcat</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ä¸Šä¼ æ–‡ä»¶åˆ°/opt/tomcat å¹¶è§£å‹</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> è¿›å…¥binç›®å½• å¯åŠ¨tomact ./startup.sh</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> å¼€æ”¾ç«¯å£8080 æµ‹è¯• ip+8080</span></span><br></pre></td></tr></table></figure>



<h3 id="7-3å®‰è£…mysql"><a href="#7-3å®‰è£…mysql" class="headerlink" title="7.3å®‰è£…mysql"></a>7.3å®‰è£…mysql</h3><blockquote>
<ol>
<li><p>æ–°å»ºæ–‡ä»¶å¤¹/opt/mysqlï¼Œå¹¶cdè¿›å»</p>
</li>
<li><p>è¿è¡Œwget <a href="http://dev.mysql.com/get/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar%EF%BC%8C%E4%B8%8B%E8%BD%BDmysql%E5%AE%89%E8%A3%85%E5%8C%85">http://dev.mysql.com/get/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tarï¼Œä¸‹è½½mysqlå®‰è£…åŒ…</a></p>
</li>
</ol>
<p>PSï¼šcentos7.6è‡ªå¸¦çš„ç±»mysqlæ•°æ®åº“æ˜¯mariadbï¼Œä¼šè·Ÿmysqlå†²çªï¼Œè¦å…ˆåˆ é™¤ã€‚</p>
<ol start="3">
<li><p>è¿è¡Œtar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar </p>
</li>
<li><p>è¿è¡Œrpm -qa|grep mariï¼ŒæŸ¥è¯¢mariadbç›¸å…³å®‰è£…åŒ…</p>
<p>5.è¿è¡Œrpm -e â€“nodeps mariadb-libsï¼Œå¸è½½</p>
</li>
<li><p>ç„¶åå¼€å§‹çœŸæ­£å®‰è£…mysqlï¼Œä¾æ¬¡è¿è¡Œä»¥ä¸‹å‡ æ¡</p>
</li>
</ol>
<p>â€‹    rpm -ivh mysql-community-common-5.7.26-1.el7.x86_64.rpm</p>
<p>â€‹    rpm -ivh mysql-community-libs-5.7.26-1.el7.x86_64.rpm</p>
<p>â€‹    rpm -ivh mysql-community-client-5.7.26-1.el7.x86_64.rpm</p>
<p>â€‹    rpm -ivh mysql-community-server-5.7.26-1.el7.x86_64.rpm</p>
<ol start="7">
<li><p>è¿è¡Œsystemctl start mysqld.serviceï¼Œå¯åŠ¨mysql</p>
</li>
<li><p>ç„¶åå¼€å§‹è®¾ç½®rootç”¨æˆ·å¯†ç </p>
<p>Mysqlè‡ªåŠ¨ç»™rootç”¨æˆ·è®¾ç½®éšæœºå¯†ç ï¼Œè¿è¡Œgrep â€œpasswordâ€ /var/log/mysqld.logå¯çœ‹åˆ°å½“å‰å¯†ç </p>
</li>
<li><p>è¿è¡Œmysql -u root -pï¼Œç”¨rootç”¨æˆ·ç™»å½•ï¼Œæç¤ºè¾“å…¥å¯†ç å¯ç”¨ä¸Šè¿°çš„ï¼Œå¯ä»¥æˆåŠŸç™»é™†è¿›å…¥mysqlå‘½ä»¤è¡Œ</p>
</li>
</ol>
<ol start="10">
<li><p>è®¾ç½®rootå¯†ç ï¼Œå¯¹äºä¸ªäººå¼€å‘ç¯å¢ƒï¼Œå¦‚æœè¦è®¾æ¯”è¾ƒç®€å•çš„å¯†ç ï¼ˆ<strong>ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨è¦è®¾å¤æ‚å¯†ç </strong>ï¼‰ï¼Œå¯ä»¥è¿è¡Œ</p>
<p>set global validate_password_policy=0; æç¤ºå¯†ç è®¾ç½®ç­–ç•¥</p>
<p>ï¼ˆvalidate_password_policyé»˜è®¤å€¼1ï¼Œï¼‰</p>
</li>
<li><p>set password for â€˜rootâ€™@â€™localhostâ€™ =password(â€˜hspedu100â€™);</p>
<p>è¿è¡Œflush privileges;ä½¿å¯†ç è®¾ç½®ç”Ÿæ•ˆ</p>
</li>
</ol>
</blockquote>
<h2 id="8-Linux-é¢è¯•é¢˜"><a href="#8-Linux-é¢è¯•é¢˜" class="headerlink" title="8. Linux é¢è¯•é¢˜"></a>8. Linux é¢è¯•é¢˜</h2><ul>
<li>åˆ†ææ—¥å¿—t.log(è®¿é—®é‡),å°†å„ä¸ªipåœ°å€æˆªå–ï¼Œå¹¶ç»Ÿè®¡å‡ºç°æ¬¡æ•°ï¼Œå¹¶æŒ‰ä»å°åˆ°å¤§çš„æ’åº</li>
</ul>
<p><img src="C:\Users\dell\Desktop\Notes\Linux\img\Snipaste_2021-05-18_15-50-02.png"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat t.txt | cut -d <span class="string">&#x27;/&#x27;</span> -f3 |sort|uniq -c |sort -nr</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p> å¿˜è®°mysqlæ•°æ®åº“çš„å¯†ç ï¼Œå¦‚ä½•æ‰¾å›ï¼Ÿ</p>
</blockquote>
<ul>
<li>é¦–å…ˆï¼Œå¯åŠ¨ç³»ç»Ÿï¼Œè¿›å…¥å¼€æœºç•Œé¢ï¼Œåœ¨ç•Œé¢ä¸­æŒ‰â€œeâ€è¿›å…¥ç¼–è¾‘ç•Œé¢ã€‚å¦‚å›¾</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210518155401846.png" alt="image-20210518155401846"></p>
<ul>
<li>è¿›å…¥ç¼–è¾‘ç•Œé¢ï¼Œä½¿ç”¨é”®ç›˜ä¸Šçš„ä¸Šä¸‹é”®æŠŠå…‰æ ‡å¾€ä¸‹ç§»åŠ¨ï¼Œæ‰¾åˆ°ä»¥â€œâ€œLinux16â€å¼€å¤´å†…å®¹æ‰€åœ¨çš„è¡Œæ•°â€ï¼Œåœ¨è¡Œçš„æœ€åé¢è¾“å…¥ï¼šinit=/bin/shã€‚å¦‚å›¾</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210518155436939.png" alt="image-20210518155436939"></p>
<ul>
<li> æ¥ç€ï¼Œè¾“å…¥å®Œæˆåï¼Œç›´æ¥æŒ‰å¿«æ·é”®ï¼šCtrl+x è¿›å…¥<strong>å•ç”¨æˆ·æ¨¡å¼</strong>ã€‚</li>
<li>æ¥ç€ï¼Œåœ¨å…‰æ ‡é—ªçƒçš„ä½ç½®ä¸­è¾“å…¥ï¼šmount -o remount,rw /ï¼ˆæ³¨æ„ï¼šå„ä¸ªå•è¯é—´æœ‰ç©ºæ ¼ï¼‰ï¼Œå®ŒæˆåæŒ‰é”®ç›˜çš„å›è½¦é”®ï¼ˆEnterï¼‰ã€‚å¦‚å›¾</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210518155507278.png" alt="image-20210518155507278"></p>
<ul>
<li> åœ¨æ–°çš„ä¸€è¡Œæœ€åé¢è¾“å…¥ï¼špasswdï¼Œ å®ŒæˆåæŒ‰é”®ç›˜çš„å›è½¦é”®ï¼ˆEnterï¼‰ã€‚è¾“å…¥å¯†ç ï¼Œ<strong>ç„¶åå†æ¬¡ç¡®è®¤å¯†ç å³</strong>å¯(<strong>æç¤º:</strong> <strong>å¯†ç é•¿åº¦æœ€å¥½8ä½ä»¥ä¸Š,ä½†ä¸æ˜¯å¿…é¡»çš„</strong>), å¯†ç ä¿®æ”¹æˆåŠŸåï¼Œä¼šæ˜¾ç¤ºpasswdâ€¦..çš„æ ·å¼ï¼Œè¯´æ˜å¯†ç ä¿®æ”¹æˆåŠŸ</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210518155541924.png" alt="image-20210518155541924"></p>
<ul>
<li>  æ¥ç€ï¼Œåœ¨é¼ æ ‡é—ªçƒçš„ä½ç½®ä¸­ï¼ˆæœ€åä¸€è¡Œä¸­ï¼‰è¾“å…¥ï¼štouch /.autorelabelï¼ˆæ³¨æ„ï¼štouchä¸ /åé¢æœ‰ä¸€ä¸ªç©ºæ ¼ï¼‰ï¼Œå®ŒæˆåæŒ‰é”®ç›˜çš„å›è½¦é”®ï¼ˆEnterï¼‰</li>
<li>  ç»§ç»­åœ¨å…‰æ ‡é—ªçƒçš„ä½ç½®ä¸­ï¼Œè¾“å…¥ï¼šexec /sbin/initï¼ˆæ³¨æ„ï¼šexecä¸ /åé¢æœ‰ä¸€ä¸ªç©ºæ ¼ï¼‰ï¼Œå®ŒæˆåæŒ‰é”®ç›˜çš„å›è½¦é”®ï¼ˆEnterï¼‰,ç­‰å¾…ç³»ç»Ÿè‡ªåŠ¨ä¿®æ”¹å¯†ç (<strong>æç¤ºï¼šè¿™ä¸ªè¿‡ç¨‹æ—¶é—´å¯èƒ½æœ‰ç‚¹é•¿ï¼Œè€å¿ƒç­‰å¾…</strong>)ï¼Œå®Œæˆåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é‡å¯, <strong>æ–°çš„å¯†ç ç”Ÿæ•ˆ</strong>äº†</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210518155611979.png" alt="image-20210518155611979"></p>
<blockquote>
<p>ç»Ÿè®¡ipè®¿é—®æƒ…å†µï¼Œè¦æ±‚åˆ†ænginxè®¿é—®æ—¥å¿—(access.log)æ‰¾å‡ºè®¿é—®é¡µé¢æ•°é‡å‰2ä½çš„ip</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat access.log |awk -F <span class="string">&quot; &quot;</span> <span class="string">&#x27;&#123;print$1&#125;&#x27;</span>|sort|uniq -c |sort -nr |head -2</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>å¦‚æœä½ æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ï¼Œåœ¨è¿›è¡ŒLinuxç³»ç»Ÿæƒé™åˆ’åˆ†æ—¶ï¼Œè€ƒè™‘å“ªäº›å› ç´ </p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-05-18_15-59-59.png"></p>
<ul>
<li>æ³¨æ„æƒé™åˆ†ç¦»</li>
<li>æƒé™æœ€å°åŸåˆ™</li>
<li>å‡å°‘ä½¿ç”¨rootç”¨æˆ· å°½é‡ç”¨æ™®é€šç”¨æˆ·+sudoææƒè¿›è¡Œæ—¥å¸¸æ“ä½œ</li>
<li>é‡è¦çš„ç³»ç»Ÿæ–‡ä»¶ æ¯”å¦‚ /etc/password /etc/shadow æ—¥å¸¸å»ºè®®ä½¿ç”¨ chattr(change attribute)é”å®š éœ€è¦æ“ä½œå†æ‰“å¼€</li>
</ul>
<blockquote>
<p>æƒé™æ“ä½œæ€è€ƒé¢˜</p>
</blockquote>
<ul>
<li>l)ç”¨æˆ· tomå¯¹ç›®å½•/home/test æœ‰æ‰§è¡Œxå’Œè¯»rå†™wæƒé™ï¼Œ/homeltesthelo.javaæ˜¯åªè¯»æ–‡ä»¶ï¼Œé—®tomå¯¹ hellojavaæ–‡ä»¶<br>èƒ½è¯»å—(ok)?èƒ½ä¿®æ”¹å—(no)?èƒ½åˆ é™¤å—?(ok)</li>
<li>2)ç”¨æˆ·tomå¯¹ç›®å½•/homeltest åªæœ‰è¯»å†™æƒé™, home/testhellojavaæ˜¯åªè¯»æ–‡ä»¶,é—®tomå¯¹hello.javaæ–‡ä»¶èƒ½è¯»å—(no)?èƒ½<br>ä¿®æ”¹å—(no)?èƒ½åˆ é™¤å—(no)?</li>
<li>3)ç”¨æˆ·tomå¯¹ç›®å½•/home/test åªæœ‰æ‰§è¡Œæƒé™xï¼Œ /home/test/hello.javaæ˜¯åªè¯»æ–‡ä»¶ï¼Œé—® tomå¯¹ hello.java æ–‡ä»¶èƒ½è¯»å—(ok)?<br>èƒ½ä¿®æ”¹å—(no)?èƒ½åˆ é™¤å—(no)?</li>
<li>4)ç”¨æˆ·tom å¯¹ç›®å½•/homeltest åªæœ‰æ‰§è¡Œå’Œå†™æƒé™ï¼Œhomeltesthello.java æ˜¯åªè¯»æ–‡ä»¶ï¼Œé—®tomå¯¹ hello.javaæ–‡ä»¶èƒ½è¯»å—<br>(ok)?èƒ½ä¿®æ”¹å—(no)?èƒ½åˆ é™¤å—(ok)?</li>
</ul>
<blockquote>
<p>åˆ—ä¸¾Linuxé«˜çº§å‘½ä»¤</p>
</blockquote>
<p>netstat//ç½‘ç»œçŠ¶æ€ç›‘æ§    topllç³»ç»Ÿè¿è¡ŒçŠ¶æ€      lsblk//æŸ¥çœ‹ç¡¬ç›˜åˆ†åŒºfind<br>ps -aux/læŸ¥çœ‹è¿è¡Œè¿›ç¨‹               chkconfig/læŸ¥çœ‹æœåŠ¡å¯åŠ¨çŠ¶æ€       systemctl//ç®¡ç†ç³»ç»ŸæœåŠ¡å™¨</p>
<blockquote>
<p>LinuxæŸ¥çœ‹å†…å­˜ã€io è¯»å†™ã€ç£ç›˜å­˜å‚¨ã€ç«¯å£å ç”¨ã€è¿›ç¨‹æŸ¥çœ‹å‘½ä»¤æ˜¯ä»€ä¹ˆ?(ç“œå­)</p>
</blockquote>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> top, iotop, df -lh , netstat -tunlp , ps -aux | grepå…³å¿ƒçš„è¿›ç¨‹</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½¿ç”¨Linuxå‘½ä»¤è®¡ç®—t2.txtç¬¬äºŒåˆ—çš„å’Œå¹¶è¾“å‡º</p>
<p>å¼ ä¸‰ 40</p>
<p>æå››50</p>
<p>ç‹äº”60</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat t2.txt|awk -F <span class="string">&quot; &quot;</span> <span class="string">&#x27;&#123;sum+=S2&#125; END &#123;print sum&#125;&#x27;</span></span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>è¯·ç”¨æŒ‡ä»¤å†™å‡ºæŸ¥æ‰¾å½“å‰æ–‡ä»¶å¤¹(/homeï¼‰ä¸‹æ‰€æœ‰çš„æ–‡æœ¬æ–‡ä»¶å†…å®¹ä¸­åŒ…å«æœ‰å­—ç¬¦â€œcatâ€</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> grep -r <span class="string">&quot;cat&quot;</span> /home |cut -d <span class="string">&quot;:&quot;</span> -f 1</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>æ¯å¤©æ™šä¸Š10ç‚¹30åˆ†ï¼Œæ‰“åŒ…ç«™ç‚¹ç›®å½•/var/spool/mailå¤‡ä»½åˆ°/homeç›®å½•ä¸‹(æ¯æ¬¡å¤‡ä»½<br>æŒ‰æ—¶é—´ç”Ÿæˆä¸åŒçš„å¤‡ä»½åŒ…æ¯”å¦‚æŒ‰ç…§å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Linux%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Snipaste_2021-05-18_16-21-30.png"></p>
<blockquote>
<p>å¦‚ä½•ä¼˜åŒ–Linux è¯´å‡ºå‡ ç‚¹</p>
</blockquote>
<blockquote>
<p>(1)å¯¹linuxç³»ç»Ÿæœ¬èº«çš„ä¼˜åŒ–-è§„åˆ™(1)ä¸ç”¨root ,ä½¿ç”¨sudoæç¤ºæƒé™<br>(2)å®šæ—¶çš„è‡ªåŠ¨æ›´æ–°æœåŠ¡æ—¶é—´.ä½¿ç”¨nptdate npt1.aliyun.com . è®© croudå®šæ—¶æ›´æ–°</p>
<p>(3)é…ç½®yumæºï¼ŒæŒ‡å‘å›½å†…é•œåƒ(æ¸…åï¼Œ163)</p>
<p>(4)é…ç½®åˆç†çš„é˜²ç«å¢™ç­–ç•¥,æ‰“å¼€å¿…è¦çš„ç«¯å£ï¼Œå…³é—­ä¸å¿…è¦çš„ç«¯å£</p>
<p>(5)æ‰“å¼€æœ€å¤§æ–‡ä»¶æ•°(è°ƒæ•´æ–‡ä»¶çš„æè¿°çš„æ•°é‡)vim/etc/profile ulimit -SHn 65535</p>
<p>(6)é…ç½®åˆç†çš„ç›‘æ§ç­–ç•¥</p>
<p>(7)é…ç½®åˆç†çš„ç³»ç»Ÿé‡è¦æ–‡ä»¶çš„å¤‡ä»½ç­–ç•¥(</p>
<p>8)å¯¹å®‰è£…çš„è½¯ä»¶è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚ nginx ,apache</p>
<p>(9)å†…æ ¸å‚æ•°è¿›è¡Œä¼˜åŒ–letc/sysctl.conf</p>
<p>(10)é”å®šä¸€äº›é‡è¦çš„ç³»ç»Ÿæ–‡ä»¶chattr /etc/passwd lect/shadow /etc/inittab</p>
<p>(11)ç¦ç”¨ä¸å¿…è¦çš„æœåŠ¡ setup , ntsysv</p>
</blockquote>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>RabbitMQç¬”è®°</title>
    <url>/2021/04/18/RabbitMQ%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="RabbitMQå­¦ä¹ ç¬”è®°"><a href="#RabbitMQå­¦ä¹ ç¬”è®°" class="headerlink" title="RabbitMQå­¦ä¹ ç¬”è®°"></a>RabbitMQå­¦ä¹ ç¬”è®°</h1><p><strong>å­¦ä¹ åœ°å€:<a href="https://www.bilibili.com/video/BV1dX4y1V73G">https://www.bilibili.com/video/BV1dX4y1V73G</a></strong></p>
<p><strong>ä»“åº“åœ°å€:<a href="https://gitee.com/zhuang-kang/rabbit-mq">https://gitee.com/zhuang-kang/rabbit-mq</a></strong></p>
<h1 id="1ï¼Œä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"><a href="#1ï¼Œä»€ä¹ˆæ˜¯ä¸­é—´ä»¶" class="headerlink" title="1ï¼Œä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"></a>1ï¼Œä»€ä¹ˆæ˜¯ä¸­é—´ä»¶</h1><p>ä¸€ä¸ªä¼ä¸šå¯èƒ½è¿è¡Œå¤šä¸ªä¸åŒä¸šåŠ¡ç³»ç»Ÿï¼Œå¯èƒ½åŸºäºä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œä¸åŒæ•°æ®åº“ï¼Œå¼‚æ„çš„ç½‘ç»œç¯å¢ƒï¼Œé—®é¢˜æ˜¯ï¼Œå¦‚ä½•æŠŠè¿™äº›ä¿¡æ¯ç³»ç»Ÿç»“åˆç»“åˆæˆä¸€ä¸ªæœ‰æœºåœ°ååŒå·¥ä½œçš„æ•´ä½“ï¼ŒçœŸæ­£å®ç°è·¨å¹³å°ï¼Œåˆ†å¸ƒå¼åº”ç”¨ï¼Œä¸­é—´ä»¶ä¾¿æ˜¯è§£å†³ä¹‹é“</p>
<ul>
<li><strong>ä¸­é—´ä»¶ï¼š</strong>å¤„äºæ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„è½¯ä»¶ï¼Œåœ¨ä¸­é—´ä»¶ä¸­å¿…é¡»è¦æœ‰ä¸€ä¸ªé€šä¿¡ä¸­é—´ä»¶ï¼Œå³ ä¸­é—´ä»¶=å¹³å°ï¼‹é€šä¿¡ï¼Œè¿™ä¸ªå®šä¹‰ä¹Ÿé™å®šåªæœ‰ç”¨äºåˆ†å¸ƒå¼ï¼ŒåŒæ—¶è¿˜å¯ä»¥æŠŠå®ƒä¸æ”¯æ’‘è½¯ä»¶å’Œè¯•ç”¨è½¯ä»¶åˆ†å¼€æ¥</li>
</ul>
<blockquote>
<p>1,RMI è¿œç¨‹è°ƒç”¨</p>
<p>2ï¼ŒLoad Balancing è´Ÿè½½å‡è¡¡ å°†è®¿é—®è´Ÿè·åˆ†æ•£åˆ°å„ä¸ªæœåŠ¡å™¨ä¸­</p>
<p>3ï¼ŒClustering é›†ç¾¤ ç”¨å¤šä¸ªå°æœåŠ¡å™¨ä»£æ›¿å¤§å‹æœº</p>
<p>4ï¼ŒThreading å¤šçº¿ç¨‹å¤„ç†</p>
<p>5ï¼ŒTransaction äº‹åŠ¡</p>
<p>6ï¼ŒComponent Life Cycle ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†</p>
<p>â€¦â€¦</p>
</blockquote>
<span id="more"></span>

<h2 id="1-2-ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ä¸­é—´ä»¶"><a href="#1-2-ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ä¸­é—´ä»¶" class="headerlink" title="1.2 ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ä¸­é—´ä»¶"></a>1.2 ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ä¸­é—´ä»¶</h2><p>å…·ä½“è¯´ï¼Œä¸­é—´ä»¶å±è”½åº•å±‚æ“ä½œç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œä½¿ç¨‹åºå‘˜é¢å¯¹ä¸€ä¸ªç®€å•è€Œç»Ÿä¸€çš„å¼€å‘ç¯å¢ƒï¼Œå‡å°‘ç¨‹åºè®¾è®¡çš„å¤æ‚æ€§ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨è‡ªå·±çš„ä¸šåŠ¡ä¸Šï¼Œä¸å¿…ä¸ºç¨‹åºåœ¨ä¸åŒè½¯ä»¶ä¸Šçš„ç§»æ¤è€Œé‡å¤å·¥ä½œï¼Œå‡å°‘æŠ€æœ¯è´Ÿæ‹…ï¼Œå¼€å‘çš„ç®€ä¾¿ï¼Œå¼€å‘å‘¨æœŸçŸ­ï¼Œå‡å°‘ç³»ç»Ÿç»´æŠ¤ï¼Œå‡å°‘è´¹ç”¨æŠ•å…¥</p>
<h2 id="1-3-ä¸­é—´ä»¶çš„ç‰¹ç‚¹"><a href="#1-3-ä¸­é—´ä»¶çš„ç‰¹ç‚¹" class="headerlink" title="1.3 ä¸­é—´ä»¶çš„ç‰¹ç‚¹"></a>1.3 ä¸­é—´ä»¶çš„ç‰¹ç‚¹</h2><p>ä¸­é—´ä»¶æ˜¯ä½äºå¹³å°ï¼ˆç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿï¼‰å’Œåº”ç”¨ä¹‹é—´çš„é€šç”¨æœåŠ¡ï¼Œé’ˆå¯¹ä¸åŒæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ï¼Œå¯ä»¥æœ‰ç¬¦åˆæ¥å£å’Œåè®®çš„å¤šç§å®ç°</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-14_14-43-35.png"></p>
<p><strong>ç‰¹ç‚¹å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>æ»¡è¶³å¤§é‡åº”ç”¨çš„éœ€æ±‚</li>
<li>è¿è¡Œäºå¤šç§ç¡¬ä»¶å’ŒOSå¹³å°</li>
<li>æ”¯æŒåˆ†å¸ƒè®¡ç®—ï¼Œæä¾›ç½‘ç»œï¼Œç¡¬ä»¶å’ŒOSå¹³å°çš„é€æ˜æ€§çš„åº”ç”¨æˆ–æœåŠ¡çš„äº¤äº’</li>
<li>æ”¯æŒæ ‡å‡†çš„åè®®</li>
<li>æ”¯æŒæ ‡å‡†çš„æ¥å£</li>
</ul>
<blockquote>
<p>ç®€å•è¯´ï¼Œä¸­é—´ä»¶æœ‰ä¸ªå¾ˆå¤§çš„ç‰¹ç‚¹ï¼Œè„±ç¦»äºå…·ä½“è®¾è®¡ç›®æ ‡ï¼Œè€Œå…·å¤‡æä¾›æ™®éç‹¬ç«‹åŠŸèƒ½éœ€æ±‚çš„æ¨¡å—ã€‚ä½¿å¾—ä¸­é—´ä»¶æ˜¯å¯æ›¿æ¢çš„ï¼Œå¦‚æœä¸€ä¸ªç³»ç»Ÿè®¾è®¡ä¸­ï¼Œä¸­é—´ä»¶æ˜¯ä¸å¯æ›¿æ¢çš„ï¼Œä¸æ˜¯æ¶æ„ï¼Œæ¡†æ¶è®¾è®¡æœ‰é—®é¢˜ï¼Œå°±æ˜¯ä¸­é—´ä»¶å‡ºç°é—®é¢˜</p>
</blockquote>
<h2 id="1-4-ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸­é—´ä»¶æŠ€æœ¯"><a href="#1-4-ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸­é—´ä»¶æŠ€æœ¯" class="headerlink" title="1.4 ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸­é—´ä»¶æŠ€æœ¯"></a>1.4 ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸­é—´ä»¶æŠ€æœ¯</h2><p>åœ¨é¡¹ç›®çš„æ¶æ„å’Œé‡æ„ä¸­ï¼Œä½¿ç”¨ä»»ä½•æŠ€æœ¯å’Œæ¶æ„çš„æ”¹å˜æˆ‘ä»¬éƒ½éœ€è¦è°¨æ…æ–Ÿé…Œå’Œæ€è€ƒï¼Œå› ä¸ºä»»ä½•æŠ€æœ¯çš„èå…¥å’Œå˜åŒ–éƒ½å¯èƒ½äººå‘˜ï¼ŒæŠ€æœ¯ï¼Œå’Œå¨æœ¬çš„å¢åŠ ï¼Œä¸­é—´ä»¶çš„æŠ€æœ¯ä¸€èˆ¬ç°åœ¨ä¸€äº›äº’è”ç½‘å…¬å¸æˆ–è€…é¡¹ç›®ä¸­ä½¿ç”¨æ¯”è¾ƒå¤šï¼Œå¦‚æœä½ ä»…ä»…è¿˜åªæ˜¯ä¸€ä¸ªåˆåˆ›å…¬å¸å»ºè®®è¿˜æ˜¯ä½¿ç”¨å•ä½“æ¶æ„ï¼Œæœ€å¤šåŠ ä¸ªç¼“å­˜ä¸­é—´ä»¶å³å¯ï¼Œä¸è¦ç›²ç›®è¿½æ±‚æ–°æˆ–è€…æ‰€è°“çš„é«˜æ€§èƒ½ï¼Œè€Œè¿½æ±‚çš„èƒŒåä¸€å®šæ˜¯ä¸šåŠ¡çš„é©±åŠ¨å’Œé¡¹ç›®çš„é©±åŠ¨ï¼Œå› ä¸ºä¸€æ—¦è¿½æ±‚å°±æ„å‘³ç€ä½ çš„å­¦ä¹ æˆæœ¬ï¼Œå…¬å¸çš„äººå‘˜ç»“æ„ä»¥åŠæœåŠ¡å™¨æˆæœ¬ï¼Œç»´æŠ¤å’Œè¿ç»´çš„æˆæœ¬éƒ½ä¼šå¢åŠ ï¼Œæ‰€ä»¥éœ€è¦è°¨æ…é€‰æ‹©å’Œè€ƒè™‘ã€‚</p>
<p>ä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¼€æ”¾äººå‘˜ï¼Œä¸€å®šè¦æœ‰å­¦ä¹ ä¸­é—´ä»¶æŠ€æœ¯çš„èƒ½åŠ›å’Œæ€ç»´ï¼Œå¦åˆ™å¾ˆå®¹æ˜“å½“é¡¹ç›®å‘å±•åˆ°ä¸€ä¸ªé˜¶æ®µåœ¨å»æŒæ¡ä¼°è®¡æˆ–è€…åœ¨é¢è¯•ä¸­æåŠï¼Œå°±ä¼šç»™è‡ªå·±å¸¦æ¥ä¸å°çš„å›°æ‰°ï¼Œåœ¨å½“ä»Šè¿™ä¸ªæ—¶ä»£è¿™äº›æŠ€æœ¯ä¹Ÿå¹¶ä¸æ˜¯ä»€ä¹ˆæ–°é²œçš„ä¸œè¥¿ï¼Œå¦‚æœå»æŒæ¡å’ŒæŒ–æ˜æœ€å…³é”®çš„è¿˜æ˜¯è‡ªå·±èŠ±æ—¶é—´å’ŒèŠ±ç²¾åŠ›å»æ¢è®¨å’Œç ”ç©¶</p>
<h1 id="2ï¼Œä¸­é—´ä»¶æŠ€æœ¯åŠæ¶æ„çš„æ¦‚è¿°"><a href="#2ï¼Œä¸­é—´ä»¶æŠ€æœ¯åŠæ¶æ„çš„æ¦‚è¿°" class="headerlink" title="2ï¼Œä¸­é—´ä»¶æŠ€æœ¯åŠæ¶æ„çš„æ¦‚è¿°"></a>2ï¼Œä¸­é—´ä»¶æŠ€æœ¯åŠæ¶æ„çš„æ¦‚è¿°</h1><h2 id="2-1-ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"><a href="#2-1-ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶" class="headerlink" title="2.1 ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"></a>2.1 ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-14_14-54-46.png"></p>
<h2 id="2-2-å•ä½“æ¶æ„"><a href="#2-2-å•ä½“æ¶æ„" class="headerlink" title="2.2 å•ä½“æ¶æ„"></a>2.2 å•ä½“æ¶æ„</h2><p>åœ¨ä¼ä¸šå¼€å‘çš„ä¸­ï¼Œå¤§éƒ¨åˆ†çš„åˆæœŸæ¶æ„éƒ½é‡‡ç”¨çš„æ˜¯å•ä½“æ¶æ„çš„æ¨¡å¼è¿›è¡Œæ¶æ„ï¼Œè€Œè¿™ç§æ¶æ„çš„å…¸å‹çš„ç‰¹ç‚¹:å°±æ˜¯æŠŠæ‰€æœ‰çš„ä¸šåŠ¡å’Œæ¨¡å—ï¼Œæºä»£ç ï¼Œé™æ€èµ„æºæ–‡ä»¶ç­‰éƒ½æ”¾åœ¨ä¸€ä¸ªä¸€å·¥ç¨‹ä¸­ï¼Œå¦‚æœå…¶ä¸­çš„ä¸€ä¸ªæ¨¡å—å‡çº§æˆ–è€…è¿­ä»£å‘ç”Ÿä¸€ä¸ªå¾ˆå°å˜åŠ¨éƒ½ä¼šé‡æ–°ç¼–è¯‘å’Œé‡æ–°éƒ¨çœ‹é¡¹ç›®ã€‚è¿™ç§çš„æ¶æ„å­˜åœ¨çš„é—®é¢˜å°±æ˜¯:</p>
<ul>
<li>è€¦åˆåº¦å¤ªé«˜</li>
<li>è¿ç»´æˆæœ¬è¿‡é«˜</li>
<li>ä¸æ˜“ç»´æŠ¤</li>
<li>æœåŠ¡å™¨æˆæœ¬é«˜</li>
<li>åç»­å¤æ‚åº¦å¢åŠ </li>
</ul>
<h2 id="2-3-åˆ†å¸ƒå¼æ¶æ„"><a href="#2-3-åˆ†å¸ƒå¼æ¶æ„" class="headerlink" title="2.3 åˆ†å¸ƒå¼æ¶æ„"></a>2.3 åˆ†å¸ƒå¼æ¶æ„</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-14_14-58-39.png"></p>
<p>ä½•è°“åˆ†å¸ƒå¼ç³»ç»Ÿå‘¢:</p>
<blockquote>
<p>é€šä¿—ä¸€ç‚¹:å°±æ˜¯ä¸€ä¸ªè¯·æ±‚ç”±æœåŠ¡å™¨ç«¯çš„å¤šä¸ªæœåŠ¡(æœåŠ¡æˆ–è€…ç³»ç»Ÿ)ååŒå¤„ç†å®Œæˆ</p>
</blockquote>
<p>å’Œå•ä½“æ¶æ„ä¸åŒçš„æ˜¯ï¼Œå•ä½“æ¶æ„æ˜¯ä¸€ä¸ªè¯·æ±‚å‘èµ·ivmè°ƒåº¦çº¿ç¨‹ï¼ˆç¡®åˆ‡çš„æ˜¯tomcatçº¿ç¨‹æ± ï¼‰åˆ†é…çº¿ç¨‹Threadæ¥å¤„ç†è¯·æ±‚ç›´åˆ°é‡Šæ”¾ï¼Œè€Œåˆ†å¸ƒå¼æ˜¯ç³»ç»Ÿæ˜¯:ä¸€ä¸ªè¯·æ±‚æ˜¯ç”±å¤šä¸ªç³»ç»Ÿå…±åŒæ¥ååŒå®Œæˆï¼Œjvmå’Œç¯å¢ƒéƒ½å¯èƒ½æ˜¯ç‹¬ç«‹ã€‚å¦‚æœç”Ÿæ´»ä¸­çš„æ¯”å–»çš„è¯ï¼Œå•ä½“æ¶æ„å°±æƒ³å»ºè®¾ä¸€ä¸ªå°æˆ¿å­å¾ˆå¿«å°±èƒ½å¤Ÿæå®šï¼Œå¦‚æœä½ è¦å»ºè®¾ä¸€ä¸ªé¸Ÿå·¢è€…å¤§å‹çš„å»ºç­‘ï¼Œä½ å°±å¿…é¡»æ˜¯å„ä¸ªç¯èŠ‚çš„ååŒå’Œåˆ†å¸ƒï¼Œè¿™æ ·ç›®çš„ä¹Ÿæ˜¯é¡¹ç›®å‘å±•éƒ½åæœŸçš„æ—¶å€™è¦å»éƒ¨ç½²å’Œæ€è€ƒçš„é—®é¢˜ã€‚æˆ‘ä»¬ä¹Ÿä¸èƒ½çœ‹å‡ºæ¥:åˆ†å¸ƒå¼æ¶æ„ç³»ç»Ÿå­˜åœ¨çš„ç‰¹ç‚¹å’Œé—®é¢˜å¦‚ä¸‹:</p>
<p><strong>å­˜åœ¨é—®é¢˜</strong></p>
<ul>
<li>å­¦ä¹ æˆæœ¬é«˜ï¼ŒæŠ€æœ¯æ ˆè¿‡å¤š</li>
<li>è¿ç»´æˆæœ¬å’ŒæœåŠ¡å™¨æˆæœ¬å¢åŠ </li>
<li>äººå‘˜æˆæœ¬å¢é«˜</li>
<li>é¡¹ç›®è´Ÿè½½åº¦ä¸Šå‡</li>
<li>é¢ä¸´é”™è¯¯å’Œå®¹é”™æ€§å¢åŠ </li>
<li>å ç”¨æœåŠ¡å™¨ç«¯å£å’Œé€šè®¯é€‰æ‹©æˆæœ¬é«˜</li>
<li>å®‰å…¨æ€§çš„è€ƒè™‘å’Œå› ç´ é€¼è¿«é€‰æ‹©RMI/MQç›¸å…³æœåŠ¡å™¨é€šè®¯</li>
</ul>
<p><strong>å¥½å¤„</strong></p>
<ul>
<li>æœåŠ¡ç³»ç»Ÿçš„ç‹¬ç«‹ï¼Œå ç”¨çš„æœåŠ¡å™¨èµ„æºå‡å°‘å’Œå ç”¨çš„ç¡¬ä»¶æˆæœ¬å‡å°‘ï¼Œç¡®åˆ‡çš„è¯´æ˜¯:å¯ä»¥åˆç†çš„åˆ†é…æœåŠ¡èµ„æºï¼Œä¸é€ æˆæœåŠ¡å™¨èµ„æºçš„æµªè´¹</li>
<li>ç³»ç»Ÿçš„ç‹¬ç«‹ç»´æŠ¤å’Œéƒ¨ç½²ï¼Œè€¦åˆåº¦é™ä½ï¼Œå¯æ’æ‹”æ€§ã€‚</li>
<li>ç³»ç»Ÿçš„æ¶æ„å’ŒæŠ€æœ¯æ ˆçš„é€‰æ‹©å¯ä»¥å˜çš„çµæ´»(è€Œä¸æ˜¯å•çº¯çš„é€‰æ‹©java)</li>
</ul>
<p>OAOAOAOAOA# 3ï¼ŒåŸºäºä¸­é—´ä»¶æŠ€æœ¯çš„æ¶æ„</p>
<p>OAOAOA## 3.1 æ¶ˆæ¯ä¸­é—´ä»·çš„æ¶æ„</p>
<p>OAOAOAOAOAOAOAOAOA<img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-14_15-04-20.png"></p>
<blockquote>
<p>ä»ä¸Šå›¾çœ‹å‡º æ¶ˆæ¯ä¸­é—´ä»¶æ˜¯</p>
<p>1ï¼Œåˆ©ç”¨å¯é çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶è¿›è¡Œç³»ç»Ÿç›´æ¥é€šè®¯</p>
<p>2ï¼Œé€šè¿‡æä¾›å¯é æ¶ˆæ¯å’Œæ¶ˆæ¯çš„æ’é˜Ÿæœºåˆ¶ï¼Œå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹æ‰©å±•è¿›ç¨‹é—´çš„é€šè®¯</p>
</blockquote>
<h2 id="3-2-æ¶ˆæ¯ä¸­é—´ä»¶çš„åº”ç”¨åœºæ™¯"><a href="#3-2-æ¶ˆæ¯ä¸­é—´ä»¶çš„åº”ç”¨åœºæ™¯" class="headerlink" title="3.2 æ¶ˆæ¯ä¸­é—´ä»¶çš„åº”ç”¨åœºæ™¯"></a>3.2 æ¶ˆæ¯ä¸­é—´ä»¶çš„åº”ç”¨åœºæ™¯</h2><ul>
<li>è·¨ç³»ç»Ÿæ•°æ®ä¼ é€’</li>
<li>é«˜å¹¶å‘çš„æµé‡å‰Šå³°</li>
<li>æ•°æ®çš„åˆ†å‘å’Œå¼‚æ­¥å¤„ç†</li>
<li>å¤§æ•°æ®åˆ†æä¸ä¼ é€’</li>
<li>åˆ†å¸ƒå¼äº‹åŠ¡</li>
</ul>
<h2 id="3-3-å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶"><a href="#3-3-å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶" class="headerlink" title="3.3 å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶"></a>3.3 å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶</h2><p>OAOAOAOAOAOA<br>ActiveMQã€RabbitMQã€Kafkaã€RocketMQç­‰ã€‚</p>
<h2 id="3-4-æ¶ˆæ¯ä¸­é—´ä»¶çš„æœ¬è´¨åŠè®¾è®¡"><a href="#3-4-æ¶ˆæ¯ä¸­é—´ä»¶çš„æœ¬è´¨åŠè®¾è®¡" class="headerlink" title="3.4 æ¶ˆæ¯ä¸­é—´ä»¶çš„æœ¬è´¨åŠè®¾è®¡"></a>3.4 æ¶ˆæ¯ä¸­é—´ä»¶çš„æœ¬è´¨åŠè®¾è®¡</h2><p>OAOAOAOAOAOAå®ƒæ˜¯ä¸€ç§æ¥å—æ•°æ®ï¼Œæ¥å—è¯·æ±‚ã€å­˜å‚¨æ•°æ®ã€å‘é€æ•°æ®ç­‰åŠŸèƒ½çš„æŠ€æœ¯æœåŠ¡ã€‚</p>
<blockquote>
<p>MQæ¶ˆæ¯é˜Ÿåˆ—:è´Ÿè´£æ•°æ®çš„ä¼ æ¥å—ï¼Œå­˜å‚¨å’Œä¼ é€’ï¼Œæ‰€ä»¥æ€§èƒ½è¦è¿‡äºæ™®é€šæœåŠ¡å’ŒæŠ€æœ¯ã€‚</p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-14_15-12-04.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-14_15-12-12.png" alt="Snipaste_2021-04-14_15-12-12"></p>
<h2 id="3-5-æ¶ˆæ¯ä¸­é—´ä»¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†"><a href="#3-5-æ¶ˆæ¯ä¸­é—´ä»¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†" class="headerlink" title="3.5 æ¶ˆæ¯ä¸­é—´ä»¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†"></a>3.5 æ¶ˆæ¯ä¸­é—´ä»¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†</h2><ul>
<li>æ¶ˆæ¯çš„åè®®</li>
<li>æ¶ˆæ¯çš„æŒä¹…åŒ–æœºåˆ¶</li>
<li>æ¶ˆæ¯çš„åˆ†å‘ç­–ç•¥</li>
<li>æ¶ˆæ¯çš„é«˜å¯ç”¨</li>
<li>æ¶ˆæ¯çš„å®¹é”™æœºåˆ¶<br>OAOAOA<h2 id="3-6-å°ç»“"><a href="#3-6-å°ç»“" class="headerlink" title="3.6 å°ç»“"></a>3.6 å°ç»“</h2></li>
</ul>
<p>å…¶å®ä¸è®ºé€‰æ‹©å•ä½“æ¶æ„è¿˜æ˜¯åˆ†å¸ƒå¼æ¶æ„éƒ½æ˜¯é¡¹ç›®å¼€å‘çš„ä¸€ä¸ªé˜¶æ®µï¼Œåœ¨ä»€ä¹ˆé˜¶æ®µé€‰æ‹©é€‚åˆçš„æ¶æ„æ–¹å¼ï¼Œè€Œä¸èƒ½ç›²ç›®è¿½æ±‚,æœ€åé€ æˆçš„åæœå’Œé—®é¢˜éƒ½éœ€è¦è‡ªå·±ä¹°å•ã€‚ä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¼€å‘äººå‘˜å­¦ä¹ å’Œæ¢è®¨æ–°çš„æŠ€æœ¯æ˜¯æˆ‘ä»¬æ¯ä¸ªç¨‹åºå¼€å‘è€…éƒ½åº”è¯¥å»ä¿æŒå’Œæ€è€ƒçš„é—®é¢˜ã€‚å½“æˆ‘ä»¬æ²¡åŠæ³•å»æ”¹å˜ç¤¾ä¼šå’Œä¸–ç•Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ºäº†ç”Ÿæ´»å’Œç”Ÿå­˜é‚£å°±å¿…é¡»è¦è¿åˆä¼ä¸šå’Œå¸‚åœºçš„éœ€æ±‚ï¼Œå‘æŒ¥ä½ çš„ä»·å€¼å’Œæ‰€å­¦çš„æ‰èƒ½ï¼Œåˆ›é€ ä»·å€¼å’Œå®ç°è‡ªæˆ‘ã€‚</p>
<h1 id="4ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åè®®"><a href="#4ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åè®®" class="headerlink" title="4ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åè®®"></a>4ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åè®®</h1><h2 id="4-1-ä»€ä¹ˆæ˜¯åè®®"><a href="#4-1-ä»€ä¹ˆæ˜¯åè®®" class="headerlink" title="4.1 ä»€ä¹ˆæ˜¯åè®®"></a>4.1 ä»€ä¹ˆæ˜¯åè®®</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-04-58.png"></p>
<p>æˆ‘ä»¬çŸ¥é“æ¶ˆæ¯ä¸­é—´ä»¶è´Ÿè´£æ•°æ®çš„ä¼ é€’ï¼Œå­˜å‚¨ï¼Œå’Œåˆ†å‘æ¶ˆè´¹ä¸‰ä¸ªéƒ¨åˆ†ï¼Œæ•°æ®çš„å­˜å‚¨å’Œåˆ†å‘çš„è¿‡ç¨‹ä¸­è‚¯å®šè¦éµå¾ªæŸç§çº¦å®šæˆä¿—çš„è§„èŒƒï¼Œä½ æ˜¯é‡‡ç”¨åº•å±‚çš„TCP/IPJT, UDPåè®®è¿˜æ˜¯å…¶ä»–çš„è‡ªå·±å–æ„å»ºç­‰ï¼Œè€Œè¿™äº›çº¦å®šæˆä¿—çš„è§„èŒƒå°±ç§°ä¹‹ä¸º:åè®®ã€‚</p>
<blockquote>
<p>æ‰€è°“åè®®æ˜¯æŒ‡:<br>1:è®¡ç®—æœºåº•å±‚æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºé€šè®¯æ—¶å…±åŒéµå®ˆçš„ä¸€ç»„çº¦å®šï¼Œåªæœ‰éµå¾ªå…±åŒçš„çº¦å®šå’Œè§„èŒƒï¼Œç³»ç»Ÿå’Œåº•å±‚æ“ä½œç³»ç»Ÿä¹‹é—´æ‰èƒ½ç›¸äº’äº¤æµã€‚<br>2:å’Œä¸€èˆ¬çš„ç½‘ç»œåº”ç”¨ç¨‹åºçš„ä¸åŒå®ƒä¸»è¦è´Ÿè´£æ•°æ®çš„æ¥å—å’Œä¼ é€’ï¼Œæ‰€ä»¥æ€§èƒ½æ¯”è¾ƒçš„é«˜ã€‚</p>
<p>3:åè®®å¯¹æ•°æ®æ ¼å¼å’Œè®¡ç®—æœºä¹‹é—´äº¤æ¢æ•°æ®éƒ½å¿…é¡»ä¸¥æ ¼éµå®ˆè§„èŒƒã€‚</p>
</blockquote>
<h2 id="4-2-ç½‘ç»œåè®®çš„ä¸‰è¦ç´ "><a href="#4-2-ç½‘ç»œåè®®çš„ä¸‰è¦ç´ " class="headerlink" title="4.2 ç½‘ç»œåè®®çš„ä¸‰è¦ç´ "></a>4.2 ç½‘ç»œåè®®çš„ä¸‰è¦ç´ </h2><p>1.è¯­æ³•ã€‚è¯­æ³•æ˜¯ç”¨æˆ·æ•°æ®ä¸æ§åˆ¶ä¿¡æ¯çš„ç»“æ„ä¸æ ¼å¼,ä»¥åŠæ•°æ®å‡ºç°çš„é¡ºåºã€‚<br>2.è¯­ä¹‰ã€‚è¯­ä¹‰æ˜¯è§£é‡Šæ§åˆ¶ä¿¡æ¯æ¯ä¸ªéƒ¨åˆ†çš„æ„ä¹‰ã€‚å®ƒè§„å®šäº†éœ€è¦å‘å‡ºä½•ç§æ§åˆ¶ä¿¡æ¯,ä»¥åŠå®Œæˆçš„åŠ¨ä½œä¸åšå‡ºä»€ä¹ˆæ ·çš„å“åº”ã€‚3.æ—¶åºã€‚æ—¶åºæ˜¯å¯¹äº‹ä»¶å‘ç”Ÿé¡ºåºçš„è¯¦ç»†è¯´æ˜ã€‚</p>
<p>æ¯”å¦‚æˆ‘MQå‘é€ä¸€ä¸ªä¿¡æ¯ï¼Œæ˜¯ä»¥ä»€ä¹ˆæ•°æ®æ ¼å¼å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œç„¶åæ¯ä¸ªéƒ¨åˆ†çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Œå‘é€å®Œæ¯•ä»¥åçš„æ‰§è¡Œçš„åŠ¨ä½œ,ä»¥åŠæ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯çš„åŠ¨ä½œï¼Œæ¶ˆè´¹å®Œæ¯•çš„å“åº”ç»“æœå’Œåé¦ˆæ˜¯ä»€ä¹ˆï¼Œç„¶åæŒ‰ç…§å¯¹åº”çš„æ‰§è¡Œé¡ºåºè¿›è¡Œå¤„ç†ã€‚å¦‚æœä½ è¿˜æ˜¯ä¸ç†è§£:å¤§å®¶æ¯å¤©éƒ½åœ¨æ¥è§¦çš„httpè¯·æ±‚åè®®:</p>
<p><strong>1:è¯­æ³•:httpè§„å®šäº†è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„æ ¼å¼ã€‚</strong></p>
<p><strong>2:è¯­ä¹‰:å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·è¯·æ±‚ç§°ä¹‹ä¸ºè¯·æ±‚ã€‚(è¿™æ˜¯ä¸€ç§å®šä¹‰ï¼ŒåŒæ—¶ä½ å‘èµ·çš„æ˜¯post/getè¯·æ±‚)</strong></p>
<p><strong>3:æ—¶åº:ä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªå“åº”ã€‚(ä¸€å®šå…ˆæœ‰è¯·æ±‚åœ¨æœ‰å“åº”ï¼Œè¿™ä¸ªæ˜¯æ—¶åº)</strong></p>
<p>è€Œæ¶ˆæ¯ä¸­é—´ä»¶é‡‡ç”¨çš„å¹¶ä¸æ˜¯httpåè®®ï¼Œè€Œå¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶åè®®æœ‰:OpenWireã€AMQPã€MQTTã€Kafka,OpenMessageåè®®ã€‚<br><strong>é¢è¯•é¢˜:ä¸ºä»€ä¹ˆæ¶ˆæ¯ä¸­é—´ä»¶ä¸ç›´æ¥ä½¿ç”¨httpåè®®å‘¢?</strong></p>
<ul>
<li>1:å› ä¸ºhttpè¯·æ±‚æŠ¥æ–‡æ–™å’Œå“åº”æŠ¥æ–‡å¤´æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼ŒåŒ…å«äº†cookieï¼Œæ•°æ®çš„åŠ å¯†è§£å¯†ï¼ŒçŠ¶æ€ç ï¼Œå“åº”ç ç­‰é™„åŠ çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªæ¶ˆæ¯è€Œè¨€ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¹ˆå¤æ‚ï¼Œä¹Ÿæ²¡æœ‰è¿™ä¸ªå¿…è¦æ€§ï¼Œå®ƒå…¶å®å°±æ˜¯è´Ÿè´£æ•°æ®ä¼ é€’ï¼Œå­˜å‚¨ï¼Œåˆ†å‘å°±è¡Œï¼Œä¸€å®šè¦è¿½æ±‚çš„æ˜¯é«˜æ€§èƒ½ã€‚å°½é‡ç®€æ´ï¼Œå¿«é€Ÿã€‚</li>
<li>2:å¤§éƒ¨åˆ†æƒ…å†µä¸‹httpå¤§éƒ¨åˆ†éƒ½æ˜¯çŸ­é“¾æ¥ï¼Œåœ¨å®é™…çš„äº¤äº’è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚åˆ°å“åº”å¾ˆæœ‰å¯èƒ½ä¼šä¸­æ–­ï¼Œä¸­æ–­ä»¥åå°±ä¸ä¼šå°±è¡ŒæŒä¹…åŒ–ï¼Œå°±ä¼šé€ æˆè¯·æ±‚çš„ä¸¢å¤±ã€‚è¿™æ ·å°±ä¸åˆ©äºæ¶ˆæ¯ä¸­é—´ä»¶çš„ä¸šåŠ¡åœºæ™¯ï¼Œå› ä¸ºæ¶ˆæ¯ä¸­é—´ä»¶å¯èƒ½æ˜¯ä¸€ä¸ªé•¿æœŸçš„è·å–æ¶ˆæ¯çš„è¿‡ç¨‹ï¼Œå‡ºç°é—®é¢˜å’Œæ•…éšœè¦å¯¹æ•°æ®æˆ–æ¶ˆæ¯å°±è¡ŒæŒä¹…åŒ–ç­‰ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¿è¯æ¶ˆæ¯å’Œæ•°æ®çš„é«˜å¯é å’Œç¨³å¥çš„è¿è¡Œã€‚</li>
</ul>
<h2 id="4-3-AMQPåè®®"><a href="#4-3-AMQPåè®®" class="headerlink" title="4.3 AMQPåè®®"></a>4.3 AMQPåè®®</h2><p>AMQP:(å…¨ç§°: Advanced Message Queuing Protocol)æ˜¯é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ã€‚ç”±æ‘©æ ¹å¤§é€šé›†å›¢è”åˆå…¶ä»–å…¬å¸å…±åŒè®¾è®¡ã€‚æ˜¯ä¸€ä¸ªæä¾›ç»Ÿä¸€æ¶ˆæ¯æœåŠ¡çš„åº”ç”¨å±‚æ ‡å‡†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚åŸºäºæ­¤åè®®çš„å®¢æˆ·ç«¯ä¸æ¶ˆæ¯ä¸­é—´ä»¶å¯ä¼ é€’æ¶ˆæ¯ï¼Œå¹¶ä¸å—å®¢æˆ·ç«¯/ä¸­é—´ä»¶ä¸åŒäº§å“ï¼Œä¸åŒçš„å¼€å‘è¯­è¨€ç­‰æ¡ä»¶çš„é™åˆ¶ã€‚Erlangä¸­çš„å®ç°æœ‰RabbitMQç­‰ã€‚</p>
<p>ç‰¹æ€§:<br>1:åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒã€‚</p>
<p>2:æ¶ˆæ¯çš„æŒä¹…åŒ–æ”¯æŒã€‚</p>
<p>3:é«˜æ€§èƒ½å’Œé«˜å¯é çš„æ¶ˆæ¯å¤„ç†ä¼˜åŠ¿ã€‚</p>
<h2 id="4-4-MQTTåè®®"><a href="#4-4-MQTTåè®®" class="headerlink" title="4.4 MQTTåè®®"></a>4.4 MQTTåè®®</h2><p>MQTTåè®®: (Message Queueing Telemetry Transport)æ¶ˆæ¯é˜Ÿåˆ—æ˜¯IBMå¼€æ”¾çš„ä¸€ä¸ªå³æ—¶é€šè®¯åè®®ï¼Œç‰©è”ç½‘ç³»ç»Ÿæ¶æ„ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
<p><strong>ç‰¹ç‚¹:</strong></p>
<ul>
<li><p>è½»é‡</p>
</li>
<li><p>ç»“æ„ç®€å•</p>
</li>
<li><p>ä¼ è¾“å¿«ï¼Œä¸æ”¯æŒäº‹åŠ¡</p>
</li>
<li><p>æ²¡æœ‰æŒä¹…åŒ–è®¾è®¡</p>
</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><p>é€‚ç”¨äºè®¡ç®—èƒ½åŠ›æœ‰é™</p>
</li>
<li><p>ä½å¸¦å®½</p>
</li>
<li><p>ç½‘ç»œä¸ç¨³å®šçš„åœºæ™¯ã€‚æ”¯æŒè€…:</p>
</li>
</ul>
<h2 id="4-5-OpenMessageåè®®"><a href="#4-5-OpenMessageåè®®" class="headerlink" title="4.5 OpenMessageåè®®"></a>4.5 OpenMessageåè®®</h2><p>æ˜¯è¿‘å‡ å¹´ç”±é˜¿é‡Œã€é›…rè™å’Œæ»´æ»´å‡ºè¡Œã€Stremalioç­‰å…¬å¸å…±åŒå‚ä¸åˆ›ç«‹çš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ã€æµå¤„ç†ç­‰é¢†åŸŸçš„åº”ç”¨å¼€å‘æ ‡å‡†ã€‚<br>ç‰¹ç‚¹:</p>
<p>1âˆ¶ç»“æ„ç®€å•</p>
<p>2âˆ¶è§£æé€Ÿåº¦å¿«</p>
<p>3:æ”¯æŒäº‹åŠ¡å’ŒæŒä¹…åŒ–è®¾è®¡ã€‚</p>
<h2 id="4-6-Kafakaåè®®"><a href="#4-6-Kafakaåè®®" class="headerlink" title="4.6 Kafakaåè®®"></a>4.6 Kafakaåè®®</h2><p>Kafkaåè®®æ˜¯åŸºäºTCP/IPçš„äºŒè¿›åˆ¶åè®®ã€‚æ¶ˆæƒ³å†…éƒ¨æ˜¯é€šè¿‡é•¿åº¦æ¥åˆ†å‰²ï¼Œç”±ä¸€äº›åŸºæœ¬æ•°æ®ç±»å‹ç»„æˆç‰¹ç‚¹æ˜¯:<br>1:ç»“æ„çš„å•ä¸€</p>
<p>2:è§£æé€Ÿåº¦å¿«</p>
<p>3:æ— äº‹åŠ¡æ”¯æŒ</p>
<p>4:æœ‰æŒä¹…åŒ–è®¾è®¡</p>
<h2 id="4-7-å°ç»“"><a href="#4-7-å°ç»“" class="headerlink" title="4.7 å°ç»“"></a>4.7 å°ç»“</h2><p>åè®®:æ˜¯åœ¨tcp/ipåè®®åŸºç¡€ä¹‹ä¸Šæ„å»ºçš„ä¸€ç§çº¦å®šæˆä¿—çš„è§„èŒƒå’Œæœºåˆ¶ã€å®ƒçš„ä¸»è¦ç›®çš„å¯ä»¥è®©å®¢æˆ·ç«¯ï¼ˆåº”ç”¨ç¨‹åºjavaï¼Œgo)è¿›è¡Œæ²Ÿé€šå’Œé€šè®¯ã€‚å¹¶ä¸”è¿™ç§åè®®ä¸‹è§„èŒƒå¿…é¡»å…·æœ‰æŒä¹…æ€§ï¼Œé«˜å¯ç”¨ï¼Œé«˜å¯é çš„æ€§èƒ½ã€‚</p>
<h1 id="5ï¼Œæ¶ˆæ¯åˆ†å‘ç­–ç•¥"><a href="#5ï¼Œæ¶ˆæ¯åˆ†å‘ç­–ç•¥" class="headerlink" title="5ï¼Œæ¶ˆæ¯åˆ†å‘ç­–ç•¥"></a>5ï¼Œæ¶ˆæ¯åˆ†å‘ç­–ç•¥</h1><p><strong>MQæ¶ˆæ¯é˜Ÿåˆ—æœ‰å¦‚ä¸‹å‡ ä¸ªè§’è‰²</strong></p>
<p>1:ç”Ÿäº§è€…</p>
<p>2:å­˜å‚¨æ¶ˆæ¯</p>
<p>3âˆ¶æ¶ˆè´¹è€…<br>é‚£ä¹ˆç”Ÿäº§è€…ç”Ÿæˆæ¶ˆæ¯ä»¥åï¼ŒMQè¿›è¡Œå­˜å‚¨ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•è·å–æ¶ˆæ¯çš„å‘¢?ä¸€èˆ¬è·å–æ•°æ®çš„æ–¹å¼æ— å¤–ä¹æ¨(pushï¼‰æˆ–è€…æ‹‰(pull)ä¸¤ç§æ–¹å¼ï¼Œå…¸å‹çš„gitå°±æœ‰æ¨æ‹‰æœºåˆ¶ï¼Œæˆ‘ä»¬å‘é€çš„httpè¯·æ±‚å°±æ˜¯ä¸€ç§å…¸å‹çš„æ‹‰å–æ•°æ®åº“æ•°æ®è¿”å›çš„è¿‡ç¨‹ã€‚è€Œæ¶ˆæ¯é˜Ÿåˆ—MQæ˜¯ä¸€ç§æ¨é€çš„è¿‡ç¨‹ï¼Œè€Œè¿™äº›æ¨æœºåˆ¶ä¼šé€‚ç”¨åˆ°å¾ˆå¤šçš„ä¸šåŠ¡åœºæ™¯ä¹Ÿæœ‰å¾ˆå¤šå¯¹åº”æ¨æœºåˆ¶ç­–ç•¥ã€‚</p>
<h2 id="5-2-åœºæ™¯åˆ†æ1"><a href="#5-2-åœºæ™¯åˆ†æ1" class="headerlink" title="5.2 åœºæ™¯åˆ†æ1"></a>5.2 åœºæ™¯åˆ†æ1</h2><p><img src=""><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-18-03.png" alt="Snipaste_2021-04-15_21-18-03"></p>
<blockquote>
<p>æ¯”å¦‚æˆ‘åœ¨APPä¸Šä¸‹äº†ä¸€ä¸ªè®¢å•ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå’ŒæœåŠ¡å¾ˆå¤šï¼Œæˆ‘ä»¬å¦‚ä½•å¾—çŸ¥è¿™ä¸ªæ¶ˆæ¯è¢«é‚£ä¸ªç³»ç»Ÿæˆ–è€…é‚£äº›æœåŠ¡æˆ–è€…ç³»ç»Ÿè¿›è¡Œæ¶ˆè´¹ï¼Œé‚£è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€ä¸ªåˆ†å‘çš„ç­–ç•¥ã€‚è¿™å°±éœ€è¦æ¶ˆè´¹ç­–ç•¥ã€‚æˆ–è€…ç§°ä¹‹ä¸ºæ¶ˆè´¹çš„æ–¹æ³•è®ºã€‚</p>
</blockquote>
<h2 id="5-2-åœºæ™¯åˆ†æ2"><a href="#5-2-åœºæ™¯åˆ†æ2" class="headerlink" title="5.2 åœºæ™¯åˆ†æ2"></a>5.2 åœºæ™¯åˆ†æ2</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-20-37.png"></p>
<blockquote>
<p>åœ¨å‘é€æ¶ˆæ¯çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°å¼‚å¸¸ï¼Œæˆ–è€…ç½‘ç»œçš„æŠ–åŠ¨ï¼Œæ•…éšœç­‰ç­‰å› ä¸ºé€ æˆæ¶ˆæ¯çš„æ— æ³•æ¶ˆè´¹ï¼Œæ¯”å¦‚ç”¨æˆ·åœ¨ä¸‹è®¢å•ï¼Œæ¶ˆè´¹MQæ¥å—ï¼Œè®¢å•ç³»ç»Ÿå‡ºç°æ•…éšœï¼Œå¯¼è‡´ç”¨æˆ·æ”¯ä»˜å¤±è´¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ¶ˆæ¯ä¸­é—´ä»¶å°±å¿…é¡»æ”¯æŒæ¶ˆæ¯é‡è¯•æœºåˆ¶ç­–ç•¥ã€‚ä¹Ÿå°±æ˜¯æ”¯æŒ:å‡ºç°é—®é¢˜å’Œæ•…éšœçš„æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯ä¸ä¸¢å¤±è¿˜å¯ä»¥è¿›è¡Œé‡å‘ã€‚</p>
</blockquote>
<h2 id="5-3-æ¶ˆæ¯åˆ†å‘ç­–ç•¥çš„æœºåˆ¶å’Œå¯¹æ¯”"><a href="#5-3-æ¶ˆæ¯åˆ†å‘ç­–ç•¥çš„æœºåˆ¶å’Œå¯¹æ¯”" class="headerlink" title="5.3 æ¶ˆæ¯åˆ†å‘ç­–ç•¥çš„æœºåˆ¶å’Œå¯¹æ¯”"></a>5.3 æ¶ˆæ¯åˆ†å‘ç­–ç•¥çš„æœºåˆ¶å’Œå¯¹æ¯”</h2><table>
<thead>
<tr>
<th></th>
<th><strong>ActiveMQ</strong></th>
<th><strong>RabbitMQ</strong></th>
<th><strong>Kafaka</strong></th>
<th><strong>RocketMQ</strong></th>
</tr>
</thead>
<tbody><tr>
<td>å‘å¸ƒè®¢é˜…</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td>è½®è¯¢å‘å¸ƒ</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>/</td>
</tr>
<tr>
<td>å…¬å¹³åˆ†å‘</td>
<td>/</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>/</td>
</tr>
<tr>
<td>é‡å‘</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>/</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td>æ¶ˆæ¯æ‹‰å–</td>
<td>/</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
</tr>
</tbody></table>
<h1 id="6ï¼Œæ¶ˆæ¯é˜Ÿåˆ—é«˜å¯é å’Œé«˜å¯ç”¨"><a href="#6ï¼Œæ¶ˆæ¯é˜Ÿåˆ—é«˜å¯é å’Œé«˜å¯ç”¨" class="headerlink" title="6ï¼Œæ¶ˆæ¯é˜Ÿåˆ—é«˜å¯é å’Œé«˜å¯ç”¨"></a>6ï¼Œæ¶ˆæ¯é˜Ÿåˆ—é«˜å¯é å’Œé«˜å¯ç”¨</h1><p>æ‰€è°“é«˜å¯ç”¨ï¼šæ˜¯æŒ‡äº§å“åœ¨è§„å®šçš„æ¡ä»¶å’Œè§„å®šçš„æ—¶åˆ»æˆ–æ—¶é—´å†…å¤„äºå¯æ‰§è¡Œè§„å®šåŠŸèƒ½çŠ¶æ€çš„èƒ½åŠ›ï¼Œå½“ä¸šåŠ¡é‡å¢åŠ æ—¶ï¼Œè¯·æ±‚ä¹Ÿè¿‡å¤§ï¼Œä¸€å°æ¶ˆæ¯ä¸­é—´ä»¶æœåŠ¡å™¨çš„ä¼šè§¦åŠç¡¬ä»¶ æ¯”å¦‚CPU å†…å­˜ ç£ç›˜ çš„æé™ï¼Œä¸€å°æ¶ˆæ¯æœåŠ¡å™¨æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶å¿…é¡»æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œæ¥è¾¾åˆ°é«˜å¯ç”¨</p>
<h2 id="6-1-é›†ç¾¤æ¨¡å¼1-Master-slave-ä¸»ä»å…±äº«æ•°æ®çš„éƒ¨ç½²æ–¹å¼"><a href="#6-1-é›†ç¾¤æ¨¡å¼1-Master-slave-ä¸»ä»å…±äº«æ•°æ®çš„éƒ¨ç½²æ–¹å¼" class="headerlink" title="6.1 é›†ç¾¤æ¨¡å¼1- Master-slave ä¸»ä»å…±äº«æ•°æ®çš„éƒ¨ç½²æ–¹å¼"></a>6.1 é›†ç¾¤æ¨¡å¼1- Master-slave ä¸»ä»å…±äº«æ•°æ®çš„éƒ¨ç½²æ–¹å¼</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-25-24.png"></p>
<blockquote>
<p>ç”Ÿäº§è€…å°†æ¶ˆè´¹å‘é€åˆ°MasterèŠ‚ç‚¹,æ‰€æœ‰çš„éƒ½è¿æ¥è¿™ä¸ªæ¶ˆæ¯é˜Ÿåˆ—å…±äº«è¿™å—æ•°æ®åŒºåŸŸï¼ŒMasterèŠ‚ç‚¹è´Ÿè´£å†™å…¥ï¼Œä¸€æ—¦MasteræŒ‚æ‰ï¼ŒslaveèŠ‚ç‚¹ç»§ç»­æœåŠ¡ï¼Œå½¢æˆé«˜å¯ç”¨</p>
</blockquote>
<h2 id="6-2-é›†ç¾¤æ¨¡å¼2-Master-slaveä¸»ä»åŒæ­¥éƒ¨ç½²æ–¹å¼"><a href="#6-2-é›†ç¾¤æ¨¡å¼2-Master-slaveä¸»ä»åŒæ­¥éƒ¨ç½²æ–¹å¼" class="headerlink" title="6.2 é›†ç¾¤æ¨¡å¼2 Master-slaveä¸»ä»åŒæ­¥éƒ¨ç½²æ–¹å¼"></a>6.2 é›†ç¾¤æ¨¡å¼2 Master-slaveä¸»ä»åŒæ­¥éƒ¨ç½²æ–¹å¼</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-25-57.png"></p>
<blockquote>
<p>è¿™ç§æ¨¡å¼å†™å…¥æ¶ˆæ¯åŒæ ·åœ¨Masterä¸»èŠ‚ç‚¹ä¸Šï¼Œä½†æ˜¯ä¸»èŠ‚ç‚¹ä¼šåŒæ­¥æ•°æ®åˆ°slaveèŠ‚ç‚¹å½¢æˆå‰¯æœ¬ï¼Œå’Œzookeeperæˆ–è€…redisä¸»ä»æœºåˆ¶å¾ˆç±»åŒï¼Œå¯ä»¥è¾¾åˆ°è´Ÿè½½å‡è¡¡çš„æ•ˆæœï¼Œå¦‚æœæ¶ˆè´¹è€…æœ‰å¤šä¸ªè¿™æ ·å¯ä»¥å»ä¸åŒçš„èŠ‚ç‚¹è¿›è¡Œæ¶ˆè´¹ï¼Œå› ä¸ºæ¶ˆè´¹çš„æ‹·è´å’ŒåŒæ­¥ä¼šå›å ç”¨å¾ˆå¤§çš„å¸¦å®½å’Œç½‘ç»œèµ„æºï¼Œrabbitmqä¸­æœ‰ä½¿ç”¨</p>
</blockquote>
<h2 id="6-3-é›†ç¾¤æ¨¡å¼3-å¤šä¸»é›†åŒæ­¥éƒ¨ç½²æ¨¡å¼"><a href="#6-3-é›†ç¾¤æ¨¡å¼3-å¤šä¸»é›†åŒæ­¥éƒ¨ç½²æ¨¡å¼" class="headerlink" title="6.3 é›†ç¾¤æ¨¡å¼3 å¤šä¸»é›†åŒæ­¥éƒ¨ç½²æ¨¡å¼"></a>6.3 é›†ç¾¤æ¨¡å¼3 å¤šä¸»é›†åŒæ­¥éƒ¨ç½²æ¨¡å¼</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-34-05.png"></p>
<blockquote>
<p>å’Œä¸Šé¢å·®ä¸å¤šçš„æ¨¡å¼</p>
</blockquote>
<h2 id="6-4-é›†ç¾¤æ¨¡å¼4-å¤šä¸»é›†ç¾¤è½¬å‘éƒ¨ç½²æ¨¡å¼"><a href="#6-4-é›†ç¾¤æ¨¡å¼4-å¤šä¸»é›†ç¾¤è½¬å‘éƒ¨ç½²æ¨¡å¼" class="headerlink" title="6.4 é›†ç¾¤æ¨¡å¼4 å¤šä¸»é›†ç¾¤è½¬å‘éƒ¨ç½²æ¨¡å¼"></a>6.4 é›†ç¾¤æ¨¡å¼4 å¤šä¸»é›†ç¾¤è½¬å‘éƒ¨ç½²æ¨¡å¼</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-35-51.png"></p>
<blockquote>
<p>è§£é‡Š:å¦‚æœä½ æ’å…¥çš„æ•°æ®æ˜¯broker-1ä¸­ï¼Œå…ƒæ•°æ®ä¿¡æ¯ä¼šå­˜å‚¨æ•°æ®çš„ç›¸å…³æè¿°å’Œè®°å½•å­˜æ”¾çš„ä½ç½®(é˜Ÿåˆ—)ã€‚<br>å®ƒä¼šå¯¹æè¿°ä¿¡æ¯ä¹Ÿå°±æ˜¯å…ƒæ•°æ®ä¿¡æ¯å°±è¡ŒåŒæ­¥ï¼Œå¦‚æœæ¶ˆè´¹è€…åœ¨broker-2ä¸­è¿›è¡Œæ¶ˆè´¹ï¼Œå‘ç°è‡ªå·±å‡ ç‚¹æ²¡æœ‰å¯¹åº”çš„æ¶ˆæ¯ï¼Œå¯ä»¥ä»å¯¹åº”çš„å…ƒæ•°æ®ä¿¡æ¯ä¸­å»æŸ¥è¯¢ï¼Œç„¶åè¿”å›å¯¹åº”çš„æ¶ˆæ¯ä¿¡æ¯ï¼Œåœºæ™¯:æ¯”å¦‚ä¹°ç«è½¦ç¥¨æˆ–è€…é»„ç‰›ä¹°æ¼”å”±ä¼šé—¨ç¥¨ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªé»„ç‰›æœ‰é¡¾å®¢è¯´è¦ä¹°çš„æ¼”å”±ä¼šé—¨ç¥¨ï¼Œä½†æ˜¯æ²¡æœ‰ä½†æ˜¯ä»–ä¼šå»è”ç³»å…¶ä»–çš„é»„ç‰›è¯¢é—®ï¼Œå¦‚æœæœ‰å°±è¿”å›ã€‚</p>
</blockquote>
<h2 id="6-5-é›†ç¾¤æ¨¡å¼5-Mater-slave-ä¸Broker-clusterç»„åˆçš„æ–¹æ¡ˆ"><a href="#6-5-é›†ç¾¤æ¨¡å¼5-Mater-slave-ä¸Broker-clusterç»„åˆçš„æ–¹æ¡ˆ" class="headerlink" title="6.5 é›†ç¾¤æ¨¡å¼5 Mater-slave ä¸Broker-clusterç»„åˆçš„æ–¹æ¡ˆ"></a>6.5 é›†ç¾¤æ¨¡å¼5 Mater-slave ä¸Broker-clusterç»„åˆçš„æ–¹æ¡ˆ</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-37-31.png"></p>
<blockquote>
<p>è§£é‡Š:å®ç°å¤šä¸»å¤šä»çš„çƒ­å¤‡æœºåˆ¶æ¥å®Œæˆæ¶ˆæ¯çš„é«˜å¯ç”¨ä»¥åŠæ•°æ®çš„çƒ­å¤‡æœºåˆ¶ï¼Œåœ¨ç”Ÿäº§è§„æ¨¡è¾¾åˆ°ä¸€å®šçš„é˜¶æ®µçš„æ—¶å€™ï¼Œè¿™ç§ä½¿ç”¨çš„é¢‘ç‡æ¯”è¾ƒé«˜ã€‚<br>è¿™ä¹ˆé›†ç¾¤æ¨¡å¼ï¼Œå…·ä½“åœ¨åç»­çš„è¯¾ç¨‹ä¸­ä¼šè¿›è¡Œä¸€ä¸ªåˆ†æå’Œè®²è§£ã€‚ä»–ä»¬çš„æœ€ç»ˆç›®çš„éƒ½æ˜¯ä¸ºä¿è¯ï¸°æ¶ˆæ¯æœåŠ¡å™¨ä¸ä¼šæŒ‚æ‰ï¼Œå‡ºç°äº†æ•…éšœä¾ç„¶å¯ä»¥æŠ±ç€æ¶ˆæ¯æœåŠ¡ç»§ç»­ä½¿ç”¨ã€‚</p>
</blockquote>
<p><strong>ä¸‰å¥è¯:</strong><br>1:è¦ä¹ˆæ¶ˆæ¯å…±äº«</p>
<p>2:è¦ä¹ˆæ¶ˆæ¯åŒæ­¥</p>
<p>3:è¦ä¹ˆå…ƒæ•°æ®å…±äº«</p>
<h2 id="6-6-ä»€ä¹ˆæ˜¯é«˜å¯é æœºåˆ¶"><a href="#6-6-ä»€ä¹ˆæ˜¯é«˜å¯é æœºåˆ¶" class="headerlink" title="6.6 ä»€ä¹ˆæ˜¯é«˜å¯é æœºåˆ¶"></a>6.6 ä»€ä¹ˆæ˜¯é«˜å¯é æœºåˆ¶</h2><p>æ‰€è°“é«˜å¯ç”¨æ˜¯æŒ‡:æ˜¯æŒ‡ç³»ç»Ÿå¯ä»¥æ— æ•…éšœä½æŒç»­è¿è¡Œï¼Œæ¯”å¦‚ä¸€ä¸ªç³»ç»Ÿçªç„¶å´©æºƒï¼ŒæŠ¥é”™ï¼Œå¼‚å¸¸ç­‰ç­‰å¹¶ä¸å½±å“çº¿ä¸Šä¸šåŠ¡çš„æ­£å¸¸è¿è¡Œï¼Œå‡ºé”™çš„å‡ ç‡æä½ï¼Œå°±ç§°ä¹‹ä¸º:é«˜å¯é ã€‚</p>
<p>åœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¦‚æœä¸èƒ½ä¿è¯ç³»ç»Ÿçš„é«˜å¯é ï¼Œé‚£é€ æˆçš„éšæ‚£å’ŒæŸå¤±æ˜¯éå¸¸ä¸¥é‡çš„ã€‚</p>
<p>å¦‚ä½•ä¿è¯ä¸­é—´ä»¶æ¶ˆæ¯çš„å¯é æ€§å‘¢?å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢è€ƒè™‘:<br>1:æ¶ˆæ¯çš„ä¼ è¾“:é€šè¿‡åè®®æ¥ä¿è¯ç³»ç»Ÿé—´æ•°æ®è§£æçš„æ­£ç¡®æ€§ã€‚</p>
<p>2:æ¶ˆæ¯çš„å­˜å‚¨å¯é :é€šè¿‡æŒä¹…åŒ–æ¥ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ã€‚</p>
<h2 id="7ï¼ŒRabbitMQå®‰è£…"><a href="#7ï¼ŒRabbitMQå®‰è£…" class="headerlink" title="7ï¼ŒRabbitMQå®‰è£…"></a>7ï¼ŒRabbitMQå®‰è£…</h2><p><strong>å‚è€ƒå®˜ç½‘ï¼š<a href="https://www.rabbitmq.com/">https://www.rabbitmq.com/</a></strong></p>
<h2 id="7-1-Dockerå®‰è£…"><a href="#7-1-Dockerå®‰è£…" class="headerlink" title="7.1 Dockerå®‰è£…"></a>7.1 Dockerå®‰è£…</h2><p>ä¸€ä¸ªå‘½ä»¤æå®š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -it --rm --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3-management</span><br></pre></td></tr></table></figure>

<p>ç„¶åé€šè¿‡IPåœ°å€+15672ç«¯å£è®¿é—®å³å¯</p>
<p>ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯guest</p>
<h1 id="8ï¼ŒRabbitMQè§’è‰²åˆ†ç±»"><a href="#8ï¼ŒRabbitMQè§’è‰²åˆ†ç±»" class="headerlink" title="8ï¼ŒRabbitMQè§’è‰²åˆ†ç±»"></a>8ï¼ŒRabbitMQè§’è‰²åˆ†ç±»</h1><h2 id="8-1-none"><a href="#8-1-none" class="headerlink" title="8.1 none"></a>8.1 none</h2><ul>
<li>ä¸èƒ½è®¿é—®management plugin</li>
</ul>
<h2 id="8-2-management-æŸ¥çœ‹è‡ªå·±ç›¸å…³èŠ‚ç‚¹ä¿¡æ¯"><a href="#8-2-management-æŸ¥çœ‹è‡ªå·±ç›¸å…³èŠ‚ç‚¹ä¿¡æ¯" class="headerlink" title="8.2 management:æŸ¥çœ‹è‡ªå·±ç›¸å…³èŠ‚ç‚¹ä¿¡æ¯"></a>8.2 management:æŸ¥çœ‹è‡ªå·±ç›¸å…³èŠ‚ç‚¹ä¿¡æ¯</h2><ul>
<li><p>åˆ—å‡ºè‡ªå·±å¯ä»¥é€šè¿‡AMQPç™»å…¥çš„è™šæ‹Ÿæœº</p>
</li>
<li><p>æŸ¥çœ‹è‡ªå·±çš„è™šæ‹ŸæœºèŠ‚ç‚¹ virtual hostsçš„queues,exchangeså’Œbindingsä¿¡æ¯</p>
</li>
<li><p>æŸ¥çœ‹å’Œå…³é—­è‡ªå·±çš„channelså’Œconnections</p>
</li>
</ul>
<h2 id="8-3-Policymaker"><a href="#8-3-Policymaker" class="headerlink" title="8.3 Policymaker"></a>8.3 Policymaker</h2><ul>
<li><p>åŒ…å«managementæ‰€æœ‰æƒé™</p>
</li>
<li><p>æŸ¥çœ‹å’Œåˆ›å»ºå’Œåˆ é™¤è‡ªå·±çš„virtual hostsæ‰€å±çš„policieså’Œparametersä¿¡æ¯</p>
</li>
</ul>
<h2 id="8-4-Monitoring"><a href="#8-4-Monitoring" class="headerlink" title="8.4 Monitoring"></a>8.4 Monitoring</h2><ul>
<li>åŒ…å«managementæ‰€æœ‰æƒé™</li>
<li>ç½—åˆ—å‡ºæ‰€æœ‰virtual hostsï¼ŒåŒ…æ‹¬ä¸èƒ½ç™»å½•çš„virtual hosts</li>
<li>æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„connectionså’Œchannelsä¿¡æ¯</li>
<li>æŸ¥çœ‹èŠ‚ç‚¹çº§åˆ«çš„æ•°æ®å¦‚clusteringå’Œmemoryä½¿ç”¨æƒ…å†µ</li>
<li>æŸ¥çœ‹æ‰€æœ‰çš„virtual hostsçš„å…¨å±€ç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<h2 id="8-5-Administrator"><a href="#8-5-Administrator" class="headerlink" title="8.5  Administrator"></a>8.5  Administrator</h2><ul>
<li>æœ€é«˜æƒé™</li>
<li>å¯ä»¥åˆ›å»ºå’Œåˆ é™¤virtual hostsÂ·å¯ä»¥æŸ¥çœ‹ï¼Œåˆ›å»ºå’Œåˆ é™¤users</li>
<li>æŸ¥çœ‹åˆ›å»ºpermisssions</li>
</ul>
<h1 id="9ï¼Œå…¥é—¨æ¡ˆä¾‹-ç®€å•æ¨¡å¼"><a href="#9ï¼Œå…¥é—¨æ¡ˆä¾‹-ç®€å•æ¨¡å¼" class="headerlink" title="9ï¼Œå…¥é—¨æ¡ˆä¾‹ ç®€å•æ¨¡å¼"></a>9ï¼Œå…¥é—¨æ¡ˆä¾‹ ç®€å•æ¨¡å¼</h1><p><strong>å…·ä½“æµç¨‹</strong></p>
<ul>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯<ol>
<li>ç”Ÿäº§è€…åˆ›å»ºè¿æ¥ï¼ˆConnectionï¼‰ï¼Œå¼€å¯ä¸€ä¸ªä¿¡é“ï¼ˆChannelï¼‰ï¼Œè¿æ¥åˆ°RabbitMQ Brokerï¼›</li>
<li>å£°æ˜é˜Ÿåˆ—å¹¶è®¾ç½®å±æ€§ï¼›å¦‚æ˜¯å¦æ’å®ƒï¼Œæ˜¯å¦æŒä¹…åŒ–ï¼Œæ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼›</li>
<li>å°†è·¯ç”±é”®ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ä¸é˜Ÿåˆ—ç»‘å®šèµ·æ¥ï¼›</li>
<li>å‘é€æ¶ˆæ¯è‡³RabbitMQ Brokerï¼›</li>
<li>å…³é—­ä¿¡é“ï¼›</li>
<li>å…³é—­è¿æ¥ï¼›</li>
</ol>
</li>
<li>æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯<ol>
<li>æ¶ˆè´¹è€…åˆ›å»ºè¿æ¥ï¼ˆConnectionï¼‰ï¼Œå¼€å¯ä¸€ä¸ªä¿¡é“ï¼ˆChannelï¼‰ï¼Œè¿æ¥åˆ°RabbitMQ Broker</li>
<li>å‘Broker è¯·æ±‚æ¶ˆè´¹ç›¸åº”é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œè®¾ç½®ç›¸åº”çš„å›è°ƒå‡½æ•°ï¼›</li>
<li>ç­‰å¾…Brokerå›åº”é—­å…³æŠ•é€’å“åº”é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯ï¼›</li>
<li>ç¡®è®¤ï¼ˆackï¼Œè‡ªåŠ¨ç¡®è®¤ï¼‰æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼›</li>
<li>RabbitMQä»é˜Ÿåˆ—ä¸­åˆ é™¤ç›¸åº”å·²ç»è¢«ç¡®è®¤çš„æ¶ˆæ¯ï¼›</li>
<li>å…³é—­ä¿¡é“ï¼›</li>
<li>å…³é—­è¿æ¥ï¼›</li>
</ol>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_15-31-15.png"></p>
<p>å…ˆå¯¼å…¥ä¾èµ– åˆ›å»ºMavenå·¥ç¨‹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.rabbitmq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>amqp-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.11.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.amqp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.amqp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-rabbit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™Producerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.simple;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Producer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            String queueName = <span class="string">&quot;queue1&quot;</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">            æ’ä»–æ€§</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">            æºå¸¦é™„å±å‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.queueDeclare(queueName, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">null</span>);</span><br><span class="line">            String message = <span class="string">&quot;hello kang xiao zhuang&quot;</span>;</span><br><span class="line">            <span class="comment">//å‘é€æ¶ˆæ¯ç»™é˜Ÿåˆ—</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, queueName, <span class="keyword">null</span>, message.getBytes());</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™Consumerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.simple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.generic.NEW;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue1&quot;</span>, <span class="keyword">true</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.in.read();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œå³å¯ï¼</p>
<p>æŸ¥çœ‹Webç«¯æ§åˆ¶å™¨</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_16-45-31.png"></p>
<p><strong>å…ˆå¯åŠ¨ç”Ÿäº§è€…ä¼šå‘ç°æ¶ˆæ¯ï¼Œå†å¯åŠ¨æ¶ˆè´¹è€… æ§åˆ¶å°æ‰“å°å‡ºæ¶ˆè´¹çš„æ¶ˆæ¯</strong></p>
<h1 id="10ï¼ŒAMQPåè®®"><a href="#10ï¼ŒAMQPåè®®" class="headerlink" title="10ï¼ŒAMQPåè®®"></a>10ï¼ŒAMQPåè®®</h1><p>AMQPï¼Œå³Advanced Message Queuing Protocolï¼Œä¸€ä¸ªæä¾›ç»Ÿä¸€æ¶ˆæ¯æœåŠ¡çš„åº”ç”¨å±‚æ ‡å‡†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚åŸºäºæ­¤åè®®çš„å®¢æˆ·ç«¯ä¸æ¶ˆæ¯ä¸­é—´ä»¶å¯ä¼ é€’æ¶ˆæ¯ï¼Œå¹¶ä¸å—å®¢æˆ·ç«¯/ä¸­é—´ä»¶ä¸åŒäº§å“ï¼Œä¸åŒçš„å¼€å‘è¯­è¨€ç­‰æ¡ä»¶çš„é™åˆ¶ã€‚Erlangä¸­çš„å®ç°æœ‰RabbitMQç­‰</p>
<h2 id="10-1-AMQPç”Ÿäº§è€…æµè½¬è¿‡ç¨‹"><a href="#10-1-AMQPç”Ÿäº§è€…æµè½¬è¿‡ç¨‹" class="headerlink" title="10.1 AMQPç”Ÿäº§è€…æµè½¬è¿‡ç¨‹"></a>10.1 AMQPç”Ÿäº§è€…æµè½¬è¿‡ç¨‹</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-58-26.png"></p>
<h2 id="10-2-AMQPæ¶ˆè´¹è€…æµè½¬è¿‡ç¨‹"><a href="#10-2-AMQPæ¶ˆè´¹è€…æµè½¬è¿‡ç¨‹" class="headerlink" title="10.2 AMQPæ¶ˆè´¹è€…æµè½¬è¿‡ç¨‹"></a>10.2 AMQPæ¶ˆè´¹è€…æµè½¬è¿‡ç¨‹</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_21-59-12.png"></p>
<h1 id="11ï¼ŒRabbitMQæ ¸å¿ƒåŠŸèƒ½éƒ¨åˆ†"><a href="#11ï¼ŒRabbitMQæ ¸å¿ƒåŠŸèƒ½éƒ¨åˆ†" class="headerlink" title="11ï¼ŒRabbitMQæ ¸å¿ƒåŠŸèƒ½éƒ¨åˆ†"></a>11ï¼ŒRabbitMQæ ¸å¿ƒåŠŸèƒ½éƒ¨åˆ†</h1><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_22-02-02.png"></p>
<h2 id="11-1-æ ¸å¿ƒæ¦‚å¿µ"><a href="#11-1-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="11.1 æ ¸å¿ƒæ¦‚å¿µ"></a>11.1 æ ¸å¿ƒæ¦‚å¿µ</h2><p>**Server:**åˆç§°Broker ,æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå®ç°AMQPå®ä½“æœåŠ¡ã€‚å®‰è£…rabbitmq-serverConnection:è¿æ¥ï¼Œåº”ç”¨ç¨‹åºä¸Brokerçš„ç½‘ç»œè¿æ¥TCP/IP/ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹</p>
<p>**Channel :**ç½‘ç»œä¿¡é“ï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½åœ¨Channelä¸­è¿›è¡Œï¼ŒChannelæ˜¯è¿›k%æ¯è¯»å†™çš„é€šé“ï¼Œå®¢æˆ·ç«¯å¯ä»¥å»ºç«‹å¯¹å„Channelï¼Œæ¯ä¸ªChannelä»£è¡¨ä¸€ä¸ªä¼šè¯ä»»åŠ¡ã€‚</p>
<p>**Message :**æ¶ˆæ¯:æœåŠ¡ä¸åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€çš„æ•°æ®ï¼Œç”±Propertieså’Œbodyç»„æˆï¼ŒPropertieså¯æ˜¯å¯¹æ¶ˆæ¯è¿›è¡Œä¿®é¥°ï¼Œæ¯”å¦‚æ¶ˆæ¯çš„ä¼˜å…ˆçº§ï¼Œå»¶è¿Ÿç­‰é«˜çº§ç‰¹æ€§ï¼ŒBodyåˆ™å°±æ˜¯æ¶ˆæ¯ä½“çš„å†…å®¹ã€‚</p>
<p><strong>Virtual Hostï¼š</strong>è™šæ‹Ÿåœ°å€ï¼Œç”¨äºè¿›è¡Œé€»è¾‘éš”ç¦»ï¼Œæœ€ä¸Šå±‚çš„æ¶ˆæ¯è·¯ç”±ï¼Œä¸€ä¸ªè™šæ‹Ÿä¸»æœºç†ç”±å¯ä»¥æœ‰è‹¥åƒä¸ªExhangeå’ŒQueueuï¼ŒåŒä¸€ä¸ªè™šæ‹Ÿä¸»æœºé‡Œé¢ä¸èƒ½æœ‰ç›¸åŒåå­—çš„Exchange</p>
<p>**Exchange:**äº¤æ¢æœºï¼Œæ¥å—æ¶ˆæ¯ï¼Œæ ¹æ®è·¯ç”±é”®å‘é€æ¶ˆæ¯åˆ°ç»‘å®šçš„é˜Ÿåˆ—ã€‚(==ä¸å…·å¤‡æ¶ˆæ¯å­˜å‚¨çš„èƒ½åŠ›==)Bindings : Exchangeå’ŒQueueä¹‹é—®çš„è™šæ‹Ÿè¿æ¥ï¼Œbindingä¸­å¯ä»¥ä¿æŠ¤å¤šä¸ªrouting key.</p>
<p>**Routing key :**æ˜¯ä¸€ä¸ªè·¯ç”±è§„åˆ™ï¼Œè™šæ‹Ÿæœºå¯ä»¥ç”¨å®ƒæ¥ç¡®å®šå¦‚ä½•è·¯ç”±ä¸€ä¸ªç‰¹å®šæ¶ˆæ¯ã€‚</p>
<p>**Queue :**é˜Ÿåˆ—:ä¹Ÿæˆä¸ºMessage Queue,æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¿å­˜æ¶ˆæ¯å¹¶å°†å®ƒä»¬è½¬å‘ç»™æ¶ˆè´¹è€…ã€‚</p>
<h2 id="11-2-æ ¸å¿ƒæ¶æ„"><a href="#11-2-æ ¸å¿ƒæ¶æ„" class="headerlink" title="11.2 æ ¸å¿ƒæ¶æ„"></a>11.2 æ ¸å¿ƒæ¶æ„</h2><p><img src=""><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_22-04-54.png" alt="Snipaste_2021-04-15_22-04-54"></p>
<h2 id="11-3-è¿è¡Œæµç¨‹"><a href="#11-3-è¿è¡Œæµç¨‹" class="headerlink" title="11.3 è¿è¡Œæµç¨‹"></a>11.3 è¿è¡Œæµç¨‹</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_22-05-59.png"></p>
<h2 id="11-4-å·¥ä½œæ¨¡å¼åˆ†ç±»"><a href="#11-4-å·¥ä½œæ¨¡å¼åˆ†ç±»" class="headerlink" title="11.4 å·¥ä½œæ¨¡å¼åˆ†ç±»"></a>11.4 å·¥ä½œæ¨¡å¼åˆ†ç±»</h2><h3 id="11-4-1-ç®€å•æ¨¡å¼-simple"><a href="#11-4-1-ç®€å•æ¨¡å¼-simple" class="headerlink" title="11.4.1 ç®€å•æ¨¡å¼ simple"></a>11.4.1 ç®€å•æ¨¡å¼ simple</h3><ul>
<li>å‚è€ƒå…¥é—¨æ¡ˆä¾‹</li>
</ul>
<h3 id="11-4-2-å·¥ä½œæ¨¡å¼-work"><a href="#11-4-2-å·¥ä½œæ¨¡å¼-work" class="headerlink" title="11.4.2 å·¥ä½œæ¨¡å¼ work"></a>11.4.2 å·¥ä½œæ¨¡å¼ work</h3><ul>
<li>ç±»å‹ ï¼šæ— </li>
<li>ç‰¹ç‚¹ï¼šåˆ†å‘æœºåˆ¶</li>
</ul>
<h3 id="11-4-3-å‘å¸ƒè®¢é˜…æ¨¡å¼-fanout"><a href="#11-4-3-å‘å¸ƒè®¢é˜…æ¨¡å¼-fanout" class="headerlink" title="11.4.3 å‘å¸ƒè®¢é˜…æ¨¡å¼ fanout"></a>11.4.3 å‘å¸ƒè®¢é˜…æ¨¡å¼ fanout</h3><ul>
<li>ç±»å‹ï¼šfanout</li>
<li>ç‰¹ç‚¹ï¼šå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œæ˜¯ä¸€ç§å¹¿æ’­æœºåˆ¶ï¼Œæ²¡æœ‰è·¯ç”±key</li>
</ul>
<h3 id="11-4-4-è·¯ç”±æ¨¡å¼"><a href="#11-4-4-è·¯ç”±æ¨¡å¼" class="headerlink" title="11.4.4 è·¯ç”±æ¨¡å¼"></a>11.4.4 è·¯ç”±æ¨¡å¼</h3><ul>
<li>ç±»å‹ ï¼šdirect</li>
<li>ç‰¹ç‚¹ï¼šæœ‰routing-key çš„åŒ¹é…æ¨¡å¼</li>
</ul>
<h3 id="11-4-5-ä¸»é¢˜æ¨¡å¼"><a href="#11-4-5-ä¸»é¢˜æ¨¡å¼" class="headerlink" title="11.4.5 ä¸»é¢˜æ¨¡å¼"></a>11.4.5 ä¸»é¢˜æ¨¡å¼</h3><ul>
<li>ç±»å‹ï¼štopic</li>
<li>ç‰¹ç‚¹ï¼šæ¨¡ç³Šçš„routing-keyçš„åŒ¹é…æ¨¡å¼</li>
</ul>
<h1 id="12ï¼ŒFanoutæ¨¡å¼"><a href="#12ï¼ŒFanoutæ¨¡å¼" class="headerlink" title="12ï¼ŒFanoutæ¨¡å¼"></a>12ï¼ŒFanoutæ¨¡å¼</h1><p>ç”Ÿäº§è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.routing;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Producer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//    String queueName = &quot;queue1&quot;;</span></span><br><span class="line"></span><br><span class="line">            String message = <span class="string">&quot;hello fanoutï¼ï¼ï¼&quot;</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">            æ’ä»–æ€§</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">            æºå¸¦é™„å±å‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="comment">//å‡†å¤‡äº¤æ¢æœº</span></span><br><span class="line">            String exchangeName=<span class="string">&quot;fanout_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å®šä¹‰è·¯ç”±Key</span></span><br><span class="line">            String routeKey=<span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="comment">//å®šä¹‰äº¤æ¢æœºç±»å‹</span></span><br><span class="line">            String type=<span class="string">&quot;fanout&quot;</span>;</span><br><span class="line">          <span class="comment">//  channel.queueDeclare(queueName, false, false, false, null);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//å‘é€æ¶ˆæ¯ç»™é˜Ÿåˆ—</span></span><br><span class="line">            channel.basicPublish(exchangeName, routeKey, <span class="keyword">null</span>, message.getBytes());</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¶ˆè´¹è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.routing;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue2&quot;</span>, <span class="keyword">true</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.in.read();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="13ï¼ŒDirectæ¨¡å¼"><a href="#13ï¼ŒDirectæ¨¡å¼" class="headerlink" title="13ï¼ŒDirectæ¨¡å¼"></a>13ï¼ŒDirectæ¨¡å¼</h1><p>ç”Ÿäº§è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.direct;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Producer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¶ˆè´¹è€…direct</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//    String queueName = &quot;queue1&quot;;</span></span><br><span class="line"></span><br><span class="line">            String message = <span class="string">&quot;hello direct !!!&quot;</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">            æ’ä»–æ€§</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">            æºå¸¦é™„å±å‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="comment">//å‡†å¤‡äº¤æ¢æœº</span></span><br><span class="line">            String exchangeName=<span class="string">&quot;direct_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å®šä¹‰è·¯ç”±Key</span></span><br><span class="line">            String routeKey=<span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="comment">//å®šä¹‰äº¤æ¢æœºç±»å‹</span></span><br><span class="line">            String type=<span class="string">&quot;direct&quot;</span>;</span><br><span class="line">          <span class="comment">//  channel.queueDeclare(queueName, false, false, false, null);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//å‘é€æ¶ˆæ¯ç»™é˜Ÿåˆ—</span></span><br><span class="line">            channel.basicPublish(exchangeName, routeKey, <span class="keyword">null</span>, message.getBytes());</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¶ˆè´¹è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.direct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> directæ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue1&quot;</span>, <span class="keyword">true</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.in.read();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="14ï¼ŒTopicæ¨¡å¼"><a href="#14ï¼ŒTopicæ¨¡å¼" class="headerlink" title="14ï¼ŒTopicæ¨¡å¼"></a>14ï¼ŒTopicæ¨¡å¼</h1><p>ç”Ÿäº§è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.topics;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Producer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”Ÿäº§è€…ä¸»é¢˜æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//    String queueName = &quot;queue1&quot;;</span></span><br><span class="line"></span><br><span class="line">            String message = <span class="string">&quot;hello topics !!!&quot;</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">            æ’ä»–æ€§</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">            æºå¸¦é™„å±å‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="comment">//å‡†å¤‡äº¤æ¢æœº</span></span><br><span class="line">            String exchangeName=<span class="string">&quot;topic_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å®šä¹‰è·¯ç”±Key</span></span><br><span class="line">            String routeKey=<span class="string">&quot;com.order.user.test.xxxx&quot;</span>;</span><br><span class="line">            <span class="comment">//å®šä¹‰äº¤æ¢æœºç±»å‹</span></span><br><span class="line">            String type=<span class="string">&quot;topic&quot;</span>;</span><br><span class="line">          <span class="comment">//  channel.queueDeclare(queueName, false, false, false, null);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//å‘é€æ¶ˆæ¯ç»™é˜Ÿåˆ—</span></span><br><span class="line">            channel.basicPublish(exchangeName, routeKey, <span class="keyword">null</span>, message.getBytes());</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¶ˆè´¹è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.topics;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä¸»é¢˜æ¨¡å¼çš„æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue3&quot;</span>, <span class="keyword">true</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.in.read();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_16-45-37.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_16-46-06.png" alt="Snipaste_2021-04-15_16-46-06"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_16-49-47.png" alt="Snipaste_2021-04-15_16-49-47"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-15_16-50-18.png" alt="Snipaste_2021-04-15_16-50-18"></p>
<p><strong>ä»¥ä¸Šå›¾ç‰‡ä»…ä¾›å‚è€ƒï¼Œéœ€è¦è‡ªå·±åˆ›å»ºäº¤æ¢æœºï¼ŒæŒ‡å®šè·¯ç”±key</strong></p>
<h1 id="15ï¼Œä»£ç åˆ›å»ºäº¤æ¢æœº"><a href="#15ï¼Œä»£ç åˆ›å»ºäº¤æ¢æœº" class="headerlink" title="15ï¼Œä»£ç åˆ›å»ºäº¤æ¢æœº"></a>15ï¼Œä»£ç åˆ›å»ºäº¤æ¢æœº</h1><p>ä¸Šé¢éƒ½æ˜¯ç”¨webå®¢æˆ·ç«¯åˆ›å»ºçš„ï¼Œç°åœ¨ç”¨ä»£ç çš„æ–¹å¼åˆ›å»ºäº¤æ¢æœºå’Œå®šä¹‰é˜Ÿåˆ—ï¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.all;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Producer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å£°æ˜äº¤æ¢æœºåç§°</span></span><br><span class="line">            String exchangeName=<span class="string">&quot;all_message_exchange&quot;</span>;</span><br><span class="line">            <span class="comment">//äº¤æ¢æœºç±»å‹</span></span><br><span class="line">            String exchangeType=<span class="string">&quot;direct&quot;</span>;</span><br><span class="line">            <span class="comment">//å®šä¹‰ä¸€ä¸ªäº¤æ¢æœº</span></span><br><span class="line">            channel.exchangeDeclare(exchangeName,exchangeType,<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">            channel.queueDeclare(<span class="string">&quot;queue5&quot;</span>,<span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">null</span>);</span><br><span class="line">            channel.queueDeclare(<span class="string">&quot;queue6&quot;</span>,<span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">null</span>);</span><br><span class="line">            channel.queueDeclare(<span class="string">&quot;queue7&quot;</span>,<span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœºçš„å…³ç³»</span></span><br><span class="line">            channel.queueBind(<span class="string">&quot;queue5&quot;</span>,exchangeName,<span class="string">&quot;order&quot;</span>);</span><br><span class="line">            channel.queueBind(<span class="string">&quot;queue6&quot;</span>,exchangeName,<span class="string">&quot;order&quot;</span>);</span><br><span class="line">            channel.queueBind(<span class="string">&quot;queue7&quot;</span>,exchangeName,<span class="string">&quot;order&quot;</span>);</span><br><span class="line">          <span class="comment">//  String queueName = &quot;queue1&quot;;</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">            æ’ä»–æ€§</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">            æºå¸¦é™„å±å‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            String message = <span class="string">&quot;hello kang xiao zhuang&quot;</span>;</span><br><span class="line">            <span class="comment">//å‘é€æ¶ˆæ¯ç»™é˜Ÿåˆ—</span></span><br><span class="line">            channel.basicPublish(exchangeName,<span class="string">&quot;order&quot;</span>, <span class="keyword">null</span>, message.getBytes());</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°webç«¯åˆ›å»ºäº†äº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼Œå…³ç³»ä¹Ÿç»‘å®šä¸Šå»äº†</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_13-19-13.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_13-19-56.png" alt="Snipaste_2021-04-17_13-19-56"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_13-20-20.png" alt="Snipaste_2021-04-17_13-20-20"></p>
<p>æ¶ˆè´¹è€…ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.all;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä»£ç åˆ›å»ºäº¤æ¢æœºçš„æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue5&quot;</span>, <span class="keyword">true</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.in.read();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç éƒ½æ˜¯å¤§åŒå°å¼‚ï¼Œä¸»è¦æ˜¯çœ‹ç”¨ä»€ä¹ˆæ–¹å¼åˆ›å»ºå’Œå®šä¹‰äº¤æ¢æœºï¼Œé˜Ÿåˆ—</p>
<h1 id="16ï¼ŒWorkæ¨¡å¼-è½®è¯¢æ¨¡å¼"><a href="#16ï¼ŒWorkæ¨¡å¼-è½®è¯¢æ¨¡å¼" class="headerlink" title="16ï¼ŒWorkæ¨¡å¼-è½®è¯¢æ¨¡å¼"></a>16ï¼ŒWorkæ¨¡å¼-è½®è¯¢æ¨¡å¼</h1><p>å½“æœ‰å¤šä¸ªæ¶ˆè´¹è€…æ—¶ï¼Œæ¶ˆæ¯ä¼šè¢«å“ªä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹å‘¢ï¼Œä¸»è¦æœ‰ä¸¤ç§æ¨¡å¼ï¼Œå¦‚ä½•å‡è¡¡æ¶ˆè´¹è€…æ¶ˆè´¹çš„ä¿¡æ¯å¤šå°‘</p>
<p>1ï¼Œè½®è¯¢æ¨¡å¼çš„åˆ†å‘ï¼šä¸€ä¸ªæ¶ˆè´¹è€…ä¸€æ¡ï¼ŒæŒ‰å‡åˆ†é…</p>
<p>2ï¼Œå…¬å¹³åˆ†å‘ï¼šæ ¹æ®æ¶ˆè´¹è€…çš„æ¶ˆè´¹èƒ½åŠ›è¿›è¡Œå…¬å¹³åˆ†å‘ï¼Œå¤„ç†å¿«å¤„ç†çš„å¤šï¼Œæ…¢å¤„ç†çš„å°‘ï¼ŒæŒ‰åŠ³åˆ†é…ï¼</p>
<p><strong>å®æˆ˜æ¨¡æ‹Ÿ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.work.lunxun;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Producer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            String queueName = <span class="string">&quot;queue1&quot;</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">            æ’ä»–æ€§</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">            æºå¸¦é™„å±å‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.queueDeclare(queueName, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">                String message = <span class="string">&quot;hello kang xiao zhuang--&gt;è½®è¯¢æ¨¡å¼&quot;</span>+i;</span><br><span class="line">                <span class="comment">//å‘é€æ¶ˆæ¯ç»™é˜Ÿåˆ—</span></span><br><span class="line">                channel.basicPublish(<span class="string">&quot;&quot;</span>, queueName, <span class="keyword">null</span>, message.getBytes());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸¤ä¸ªæ¶ˆè´¹è€… åŒæ—¶è¿è¡Œçœ‹ç»“æœ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.work.lunxun;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è½®è¯¢æ¨¡å¼çš„æ¡ˆä¾‹ æ¶ˆè´¹è€…1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 13:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue1&quot;</span>, <span class="keyword">true</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Consumer1å·æ”¶åˆ°æ¶ˆæ¯æ˜¯ï¼š&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer1å·å¼€å§‹æ¥æ”¶æ¶ˆæ¯&quot;</span>);</span><br><span class="line">            System.in.read();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ª</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.work.lunxun;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è½®è¯¢æ¨¡å¼çš„æ¡ˆä¾‹ æ¶ˆè´¹è€…2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 13:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue1&quot;</span>, <span class="keyword">true</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Consumer2å·æ”¶åˆ°æ¶ˆæ¯æ˜¯ï¼š&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer2å·å¼€å§‹æ¥æ”¶æ¶ˆæ¯&quot;</span>);</span><br><span class="line">            System.in.read();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_13-49-05.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_13-48-58.png" alt="Snipaste_2021-04-17_13-48-58"></p>
<p><strong>æ€»ç»“ ï¼šä¸ä¼šå› ä¸ºæœåŠ¡å™¨çš„æ€§èƒ½è€Œå½±å“æ¶ˆè´¹çš„å¤šå°‘ï¼Œéƒ½æ˜¯å¯¹ç­‰ï¼</strong></p>
<h1 id="17ï¼ŒWorkæ¨¡å¼-å…¬å¹³æ¨¡å¼"><a href="#17ï¼ŒWorkæ¨¡å¼-å…¬å¹³æ¨¡å¼" class="headerlink" title="17ï¼ŒWorkæ¨¡å¼-å…¬å¹³æ¨¡å¼"></a>17ï¼ŒWorkæ¨¡å¼-å…¬å¹³æ¨¡å¼</h1><p>æ”¹æˆæ‰‹åŠ¨åº”ç­”æœºåˆ¶ï¼ŒæŒ‡æ ‡è®¾ç½®å‚æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.work.fair;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Producer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/15 15:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            String queueName = <span class="string">&quot;queue1&quot;</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">            æ’ä»–æ€§</span></span><br><span class="line"><span class="comment">            æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">            æºå¸¦é™„å±å‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line"></span><br><span class="line">            channel.queueDeclare(queueName, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">                String message = <span class="string">&quot;hello kang xiao zhuang--&gt;å…¬å¹³æ¨¡å¼&quot;</span>+i;</span><br><span class="line">                <span class="comment">//å‘é€æ¶ˆæ¯ç»™é˜Ÿåˆ—</span></span><br><span class="line">                channel.basicPublish(<span class="string">&quot;&quot;</span>, queueName, <span class="keyword">null</span>, message.getBytes());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.work.fair;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…¬å¹³æ¨¡å¼çš„æ¡ˆä¾‹ æ¶ˆè´¹è€…1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 13:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            <span class="comment">//è®¾å®šæŒ‡æ ‡çš„å€¼</span></span><br><span class="line">            channel.basicQos(<span class="number">1</span>);</span><br><span class="line">            Channel finalChannel = channel;</span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue1&quot;</span>, <span class="keyword">false</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;Consumer1å·æ”¶åˆ°æ¶ˆæ¯æ˜¯ï¼š&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                        Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                        finalChannel.basicAck(delivery.getEnvelope().getDeliveryTag(), <span class="keyword">false</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer1å·å¼€å§‹æ¥æ”¶æ¶ˆæ¯&quot;</span>);</span><br><span class="line">            System.in.read();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.rabbitmq.work.fair;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Consumer2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…¬å¹³æ¨¡å¼çš„æ¡ˆä¾‹ æ¶ˆè´¹è€…2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 13:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥å·¥ç¨‹</span></span><br><span class="line">        ConnectionFactory connectionFactory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.152.130&quot;</span>);</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        connectionFactory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Channel channel = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection(<span class="string">&quot;ç”Ÿäº§è€…&quot;</span>);</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿æ¥è·å¾—é€šé“Channel</span></span><br><span class="line">            channel = connection.createChannel();</span><br><span class="line">            <span class="comment">//é€šè¿‡äº¤æ¢æœºåˆ›å»º å£°æ˜é˜Ÿåˆ— ç»‘å®šå…³ç³» è·¯ç”±key å‘é€æ¶ˆæ¯ å’Œæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">            <span class="comment">//è®¾å®šæŒ‡æ ‡çš„å€¼</span></span><br><span class="line">            channel.basicQos(<span class="number">1</span>);</span><br><span class="line">            Channel finalChannel = channel;</span><br><span class="line">            channel.basicConsume(<span class="string">&quot;queue1&quot;</span>, <span class="keyword">false</span>, <span class="keyword">new</span> DeliverCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s, Delivery delivery)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;Consumer2å·æ”¶åˆ°æ¶ˆæ¯æ˜¯ï¼š&quot;</span> + <span class="keyword">new</span> String(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                        finalChannel.basicAck(delivery.getEnvelope().getDeliveryTag(), <span class="keyword">false</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="keyword">new</span> CancelCallback() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String s)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ¥å—å¤±è´¥...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer2å·å¼€å§‹æ¥æ”¶æ¶ˆæ¯&quot;</span>);</span><br><span class="line">            System.in.read();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="keyword">null</span> &amp;&amp; channel.isOpen()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="18ï¼ŒRabbitMQåº”ç”¨åœºæ™¯"><a href="#18ï¼ŒRabbitMQåº”ç”¨åœºæ™¯" class="headerlink" title="18ï¼ŒRabbitMQåº”ç”¨åœºæ™¯"></a>18ï¼ŒRabbitMQåº”ç”¨åœºæ™¯</h1><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_14-26-09.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_14-27-07.png" alt="Snipaste_2021-04-17_14-27-07"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_14-28-53.png" alt="Snipaste_2021-04-17_14-28-53"></p>
<p><strong>å¥½å¤„ï¼š</strong></p>
<ul>
<li>å®Œå…¨è§£è€¦ï¼Œç”¨MQå»ºç«‹æ¡¥æ¥</li>
<li>æœ‰ç‹¬ç«‹çš„çº¿ç¨‹æ± å’Œè¿è¡Œæ¨¡å‹</li>
<li>å‡ºç°äº†æ¶ˆæ¯å¯èƒ½ä¼šä¸¢å¤±ï¼ŒMQæœ‰æŒä¹…åŒ–åŠŸèƒ½</li>
<li>å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Œæ­»ä¿¡é˜Ÿåˆ—å’Œæ¶ˆæ¯è½¬ç§»åŠŸèƒ½</li>
<li>å¦‚æœæœåŠ¡å™¨æ‰¿è½½ä¸äº†ï¼Œä½ éœ€è¦è‡ªå·±å»å†™é«˜å¯ç”¨ï¼ŒHAé•œåƒæ¨¡å‹é«˜å¯ç”¨</li>
</ul>
<p>æŒ‰ç…§ä¸Šé¢çº¦å®šï¼Œç”¨æˆ·çš„å“åº”æ—¶é—´ç›¸å½“äºæ˜¯è®¢å•ä¿¡æ¯çš„å†™å…¥æ•°æ®åº“çš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯50æ¯«ç§’ï¼Œæ³¨å†Œé‚®ä»¶ï¼Œå‘é€æ¶ˆæ¯å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—åï¼Œç›´æ¥è¿”å›ï¼Œå› æ­¤å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—çš„é€Ÿåº¦å¾ˆå¿«ï¼ŒåŸºæœ¬å¯ä»¥å¿½ç•¥ï¼Œæ¶æ„æ”¹å˜åï¼Œæ¯”ä¸²è¡Œæé«˜3å€ï¼Œå¹¶è¡Œæé«˜2å€</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_14-30-05.png" alt="Snipaste_2021-04-17_14-30-05"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_14-30-21.png" alt="Snipaste_2021-04-17_14-30-21"></p>
<p>åœºæ™¯</p>
<ul>
<li>æµé‡çš„å‰Šå³°</li>
<li>åˆ†å¸ƒå¼äº‹åŠ¡çš„å¯é æ¶ˆè´¹å’Œå¯é ç”Ÿäº§</li>
<li>ç´¢å¼•ï¼Œç¼“å­˜ï¼Œé™æ€åŒ–å¤„ç†çš„æ•°æ®åŒæ­¥</li>
<li>æµé‡ç›‘æ§</li>
<li>æ—¥å¿—ç›‘æ§</li>
<li>ä¸‹å•ï¼Œè®¢å•åˆ†å‘ï¼ŒæŠ¢ç¥¨</li>
</ul>
<h1 id="19ï¼ŒSpringBootæ•´åˆRabbitMQ"><a href="#19ï¼ŒSpringBootæ•´åˆRabbitMQ" class="headerlink" title="19ï¼ŒSpringBootæ•´åˆRabbitMQ"></a>19ï¼ŒSpringBootæ•´åˆRabbitMQ</h1><p>åœ¨Springé¡¹ç›®ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Spring-Rabbitå»æ“ä½œRabbitMQ<br><a href="https://github.com/spring-projects/spring-amqp">https://github.com/spring-projects/spring-amqp</a></p>
<p>å°¤å…¶æ˜¯åœ¨spring booté¡¹ç›®ä¸­åªéœ€è¦å¼•å…¥å¯¹åº”çš„amqpå¯åŠ¨å™¨ä¾èµ–å³å¯ï¼Œæ–¹ä¾¿çš„ä½¿ç”¨RabbitTemplateå‘é€æ¶ˆæ¯ï¼Œä½¿ç”¨æ³¨è§£æ¥æ”¶æ¶ˆæ¯ã€‚</p>
<p><em>ä¸€èˆ¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­</em>ï¼š</p>
<p><strong>ç”Ÿäº§è€…å·¥ç¨‹ï¼š</strong></p>
<ol>
<li><p>application.ymlæ–‡ä»¶é…ç½®RabbitMQç›¸å…³ä¿¡æ¯ï¼›</p>
</li>
<li><p>åœ¨ç”Ÿäº§è€…å·¥ç¨‹ä¸­ç¼–å†™é…ç½®ç±»ï¼Œç”¨äºåˆ›å»ºäº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼Œå¹¶è¿›è¡Œç»‘å®š</p>
</li>
<li><p>æ³¨å…¥RabbitTemplateå¯¹è±¡ï¼Œé€šè¿‡RabbitTemplateå¯¹è±¡å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœº</p>
</li>
</ol>
<p><strong>æ¶ˆè´¹è€…å·¥ç¨‹ï¼š</strong></p>
<ol>
<li><p>application.ymlæ–‡ä»¶é…ç½®RabbitMQç›¸å…³ä¿¡æ¯</p>
</li>
<li><p>åˆ›å»ºæ¶ˆæ¯å¤„ç†ç±»ï¼Œç”¨äºæ¥æ”¶é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†</p>
</li>
</ol>
<p>æ–°å»ºä¸€ä¸ªæ¨¡å— å¯¼å…¥ç›¸å…³ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.amqp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-rabbit-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™ymlæ–‡ä»¶</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#rabbitmqæœåŠ¡</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">admin</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">admin</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.152</span><span class="number">.130</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br></pre></td></tr></table></figure>



<p>åˆ›å»ºä¸šåŠ¡å±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.springboot_rabbitmq.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> OrderService</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä¸šåŠ¡å±‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 14:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¨¡æ‹Ÿç”¨æˆ·ä¸‹å•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeOrder</span><span class="params">(String userid,String productid,<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ ¹æ®å•†å“idæŸ¥è¯¢åº“å­˜æ˜¯å¦å……è¶³</span></span><br><span class="line">        String orderId = UUID.randomUUID().toString();</span><br><span class="line">        <span class="comment">//ä¿å­˜è®¢å•</span></span><br><span class="line">        System.out.println(<span class="string">&quot;è®¢å•ç”Ÿäº§æˆåŠŸ&quot;</span>+orderId);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡MQæ¥å®Œæˆæ¶ˆæ¯çš„åˆ†å‘</span></span><br><span class="line">        String exchangeName=<span class="string">&quot;fanout_order_exchange&quot;</span>;</span><br><span class="line">        String routingKey=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        rabbitTemplate.convertAndSend(exchangeName,routingKey,orderId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™é…ç½®ç±» å®šä¹‰äº¤æ¢æœºå’Œé˜Ÿåˆ—</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.springboot_rabbitmq.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Binding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.BindingBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.FanoutExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> RabbitMQConfiguration</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> rabbitmqçš„é…ç½®ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 14:53</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RabbitMQConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜æ³¨å†Œfanoutæ¨¡å¼çš„äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FanoutExchange <span class="title">fanoutExchange</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> FanoutExchange(<span class="string">&quot;fanout_order_exchange&quot;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜é˜Ÿåˆ—sms.fanout.queue email.fanout.queue duanxin.fanout.queue</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">smsQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Queue(<span class="string">&quot;sms.fanout.queue&quot;</span>, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">duanxinQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Queue(<span class="string">&quot;duanxin.fanout.queue&quot;</span>, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">emailQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Queue(<span class="string">&quot;email.fanout.queue&quot;</span>, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®Œæˆç»‘å®šå…³ç³»</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">smsBinding</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(smsQueue()).to(fanoutExchange());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">duanxinBinding</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(duanxinQueue()).to(fanoutExchange());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">emailBinding</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(emailQueue()).to(fanoutExchange());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸‰ä¸ªæ¶ˆè´¹è€… ç±»ä¸Šæ·»åŠ æ³¨è§£å³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.springboot_rabbitmq.service.fanout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FanoutDuanXinConsumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> FanoutDuanXinConsumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 15:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &#123;&quot;duanxin.fanout.queue&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FanoutDuanXinConsumer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitHandler</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dunaxin fanout --- æ¥å—åˆ°äº†è®¢å•æ¶ˆæ¯æ˜¯ï¼š-&gt;&quot;</span>+ message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.springboot_rabbitmq.service.fanout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FanoutEmailConsumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> FanoutEmailConsumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 15:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &#123;&quot;email.fanout.queue&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FanoutEmailConsumer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RabbitHandler</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;email fanout --- æ¥å—åˆ°äº†è®¢å•æ¶ˆæ¯æ˜¯ï¼š-&gt;&quot;</span>+ message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.springboot_rabbitmq.service.fanout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FanoutSMSConsumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> FanoutSMSConsumer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/4/17 15:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &#123;&quot;sms.fanout.queue&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FanoutSMSConsumer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RabbitHandler</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;sms fanout --- æ¥å—åˆ°äº†è®¢å•æ¶ˆæ¯æ˜¯ï¼š-&gt;&quot;</span>+ message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæµ‹è¯•</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-17_15-13-10.png"></p>
<p><strong>çœ‹åˆ°æ¶ˆæ¯è¢«åˆ›å»ºè€Œä¸”è¢«æ¶ˆè´¹</strong></p>
<h1 id="20ï¼ŒRabbitMQæ¨¡å¼æ€»ç»“"><a href="#20ï¼ŒRabbitMQæ¨¡å¼æ€»ç»“" class="headerlink" title="20ï¼ŒRabbitMQæ¨¡å¼æ€»ç»“"></a>20ï¼ŒRabbitMQæ¨¡å¼æ€»ç»“</h1><p>RabbitMQå·¥ä½œæ¨¡å¼ï¼š<br><strong>1ã€ç®€å•æ¨¡å¼ HelloWorld</strong><br>ä¸€ä¸ªç”Ÿäº§è€…ã€ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰</p>
<p><strong>2ã€å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ Work Queue</strong><br>ä¸€ä¸ªç”Ÿäº§è€…ã€å¤šä¸ªæ¶ˆè´¹è€…ï¼ˆç«äº‰å…³ç³»ï¼‰ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰</p>
<p><strong>3ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ Publish/subscribe</strong><br>éœ€è¦è®¾ç½®ç±»å‹ä¸ºfanoutçš„äº¤æ¢æœºï¼Œå¹¶ä¸”äº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šå°†æ¶ˆæ¯å‘é€åˆ°ç»‘å®šçš„é˜Ÿåˆ—</p>
<p><strong>4ã€è·¯ç”±æ¨¡å¼ Routing</strong><br>éœ€è¦è®¾ç½®ç±»å‹ä¸ºdirectçš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®šrouting keyï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šæ ¹æ®routing keyå°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—</p>
<p><strong>5ã€é€šé…ç¬¦æ¨¡å¼ Topic</strong><br>éœ€è¦è®¾ç½®ç±»å‹ä¸ºtopicçš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®šé€šé…ç¬¦æ–¹å¼çš„routing keyï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šæ ¹æ®routing keyå°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—</p>
<h1 id="21ï¼ŒRabbitMQé«˜çº§ç‰¹æ€§"><a href="#21ï¼ŒRabbitMQé«˜çº§ç‰¹æ€§" class="headerlink" title="21ï¼ŒRabbitMQé«˜çº§ç‰¹æ€§"></a>21ï¼ŒRabbitMQé«˜çº§ç‰¹æ€§</h1><h2 id="21-1-æ¶ˆæ¯çš„å¯é æŠ•é€’"><a href="#21-1-æ¶ˆæ¯çš„å¯é æŠ•é€’" class="headerlink" title="21.1 æ¶ˆæ¯çš„å¯é æŠ•é€’"></a>21.1 æ¶ˆæ¯çš„å¯é æŠ•é€’</h2><p>åœ¨ä½¿ç”¨ RabbitMQ çš„æ—¶å€™ï¼Œä½œä¸ºæ¶ˆæ¯å‘é€æ–¹å¸Œæœ›æœç»ä»»ä½•æ¶ˆæ¯ä¸¢å¤±æˆ–è€…æŠ•é€’å¤±è´¥åœºæ™¯ã€‚RabbitMQ ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§æ–¹å¼ç”¨æ¥æ§åˆ¶æ¶ˆæ¯çš„æŠ•é€’å¯é æ€§æ¨¡å¼ã€‚</p>
<ul>
<li><p>confirm ç¡®è®¤æ¨¡å¼</p>
</li>
<li><p>return é€€å›æ¨¡å¼</p>
</li>
</ul>
<p>rabbitmq æ•´ä¸ªæ¶ˆæ¯æŠ•é€’çš„è·¯å¾„ä¸ºï¼š</p>
<p>producerâ€”&gt;rabbitmq brokerâ€”&gt;exchangeâ€”&gt;queueâ€”&gt;consumer</p>
<ul>
<li><p>æ¶ˆæ¯ä» producer åˆ° exchange åˆ™ä¼šè¿”å›ä¸€ä¸ª confirmCallback ã€‚</p>
</li>
<li><p>æ¶ˆæ¯ä» exchangeâ€“&gt;queue æŠ•é€’å¤±è´¥åˆ™ä¼šè¿”å›ä¸€ä¸ª returnCallback ã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬å°†åˆ©ç”¨è¿™ä¸¤ä¸ª callback æ§åˆ¶æ¶ˆæ¯çš„å¯é æ€§æŠ•é€’</p>
<h2 id="21-2-Consumer-Ack"><a href="#21-2-Consumer-Ack" class="headerlink" title="21.2 Consumer Ack"></a>21.2 Consumer Ack</h2><p>ackæŒ‡Acknowledgeï¼Œç¡®è®¤ã€‚ è¡¨ç¤ºæ¶ˆè´¹ç«¯æ”¶åˆ°æ¶ˆæ¯åçš„ç¡®è®¤æ–¹å¼ã€‚</p>
<p>æœ‰ä¸‰ç§ç¡®è®¤æ–¹å¼ï¼š</p>
<ul>
<li><p>è‡ªåŠ¨ç¡®è®¤ï¼šacknowledge=â€noneâ€</p>
</li>
<li><p>æ‰‹åŠ¨ç¡®è®¤ï¼šacknowledge=â€manualâ€</p>
</li>
<li><p>æ ¹æ®å¼‚å¸¸æƒ…å†µç¡®è®¤ï¼šacknowledge=â€autoâ€ï¼‰</p>
</li>
</ul>
<p>å…¶ä¸­è‡ªåŠ¨ç¡®è®¤æ˜¯æŒ‡ï¼Œå½“æ¶ˆæ¯ä¸€æ—¦è¢«Consumeræ¥æ”¶åˆ°ï¼Œåˆ™è‡ªåŠ¨ç¡®è®¤æ”¶åˆ°ï¼Œå¹¶å°†ç›¸åº” message ä» RabbitMQ çš„æ¶ˆæ¯ç¼“å­˜ä¸­ç§»é™¤ã€‚ä½†æ˜¯åœ¨å®é™…ä¸šåŠ¡å¤„ç†ä¸­ï¼Œå¾ˆå¯èƒ½æ¶ˆæ¯æ¥æ”¶åˆ°ï¼Œä¸šåŠ¡å¤„ç†å‡ºç°å¼‚å¸¸ï¼Œé‚£ä¹ˆè¯¥æ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚å¦‚æœè®¾ç½®äº†æ‰‹åŠ¨ç¡®è®¤æ–¹å¼ï¼Œåˆ™éœ€è¦åœ¨ä¸šåŠ¡å¤„ç†æˆåŠŸåï¼Œè°ƒç”¨channel.basicAck()ï¼Œæ‰‹åŠ¨ç­¾æ”¶ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™è°ƒç”¨channel.basicNack()æ–¹æ³•ï¼Œè®©å…¶è‡ªåŠ¨é‡æ–°å‘é€æ¶ˆæ¯ã€‚</p>
<h2 id="21-3-TTL"><a href="#21-3-TTL" class="headerlink" title="21.3 TTL"></a>21.3 TTL</h2><ul>
<li><p>TTL å…¨ç§° Time To Liveï¼ˆå­˜æ´»æ—¶é—´/è¿‡æœŸæ—¶é—´ï¼‰ã€‚</p>
</li>
<li><p>å½“æ¶ˆæ¯åˆ°è¾¾å­˜æ´»æ—¶é—´åï¼Œè¿˜æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œä¼šè¢«è‡ªåŠ¨æ¸…é™¤ã€‚</p>
</li>
<li><p>RabbitMQå¯ä»¥å¯¹æ¶ˆæ¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå¯ä»¥å¯¹æ•´ä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰è®¾ç½®è¿‡æœŸæ—¶é—´</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-18_13-52-32.png"></p>
<p><strong>å°ç»“</strong></p>
<ul>
<li><p>è®¾ç½®é˜Ÿåˆ—è¿‡æœŸæ—¶é—´ä½¿ç”¨å‚æ•°ï¼šx-message-ttlï¼Œå•ä½ï¼šms(æ¯«ç§’)ï¼Œä¼šå¯¹æ•´ä¸ªé˜Ÿåˆ—æ¶ˆæ¯ç»Ÿä¸€è¿‡æœŸã€‚</p>
</li>
<li><p>è®¾ç½®æ¶ˆæ¯è¿‡æœŸæ—¶é—´ä½¿ç”¨å‚æ•°ï¼šexpirationã€‚å•ä½ï¼šms(æ¯«ç§’)ï¼Œå½“è¯¥æ¶ˆæ¯åœ¨é˜Ÿåˆ—å¤´éƒ¨æ—¶ï¼ˆæ¶ˆè´¹æ—¶ï¼‰ï¼Œä¼šå•ç‹¬åˆ¤æ–­è¿™ä¸€æ¶ˆæ¯æ˜¯å¦è¿‡æœŸã€‚</p>
</li>
<li><p>å¦‚æœä¸¤è€…éƒ½è¿›è¡Œäº†è®¾ç½®ï¼Œä»¥æ—¶é—´çŸ­çš„ä¸ºå‡†ã€‚</p>
</li>
</ul>
<h2 id="21-4-æ­»ä¿¡é˜Ÿåˆ—"><a href="#21-4-æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="21.4 æ­»ä¿¡é˜Ÿåˆ—"></a>21.4 æ­»ä¿¡é˜Ÿåˆ—</h2><p>æ­»ä¿¡é˜Ÿåˆ—ï¼Œè‹±æ–‡ç¼©å†™ï¼šDLX ã€‚Dead Letter Exchangeï¼ˆæ­»ä¿¡äº¤æ¢æœºï¼‰ï¼Œå½“æ¶ˆæ¯æˆä¸ºDead messageåï¼Œå¯ä»¥è¢«é‡æ–°å‘é€åˆ°å¦ä¸€ä¸ªäº¤æ¢æœºï¼Œè¿™ä¸ªäº¤æ¢æœºå°±æ˜¯DLXã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-18_13-54-09.png"></p>
<p><strong>æ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µï¼š</strong></p>
<ol>
<li><p>é˜Ÿåˆ—æ¶ˆæ¯é•¿åº¦åˆ°è¾¾é™åˆ¶ï¼›</p>
</li>
<li><p>æ¶ˆè´¹è€…æ‹’æ¥æ¶ˆè´¹æ¶ˆæ¯ï¼ŒbasicNack/basicReject,å¹¶ä¸”ä¸æŠŠæ¶ˆæ¯é‡æ–°æ”¾å…¥åŸç›®æ ‡é˜Ÿåˆ—,requeue=falseï¼›</p>
</li>
<li><p>åŸé˜Ÿåˆ—å­˜åœ¨æ¶ˆæ¯è¿‡æœŸè®¾ç½®ï¼Œæ¶ˆæ¯åˆ°è¾¾è¶…æ—¶æ—¶é—´æœªè¢«æ¶ˆè´¹ï¼›</p>
</li>
</ol>
<p><strong>é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœºï¼š</strong></p>
<p>ç»™é˜Ÿåˆ—è®¾ç½®å‚æ•°ï¼š x-dead-letter-exchange å’Œ x-dead-letter-routing-key</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-18_13-55-53.png"></p>
<h2 id="21-5-æ—¥å¿—ç›‘æ§"><a href="#21-5-æ—¥å¿—ç›‘æ§" class="headerlink" title="21.5 æ—¥å¿—ç›‘æ§"></a>21.5 æ—¥å¿—ç›‘æ§</h2><p>é…ç½®è¯¦è§£è§</p>
<p><a href="https://www.rabbitmq.com/configure.html">https://www.rabbitmq.com/configure.html</a></p>
<h3 id="21-5-1-rabbitmqctlç®¡ç†å’Œç›‘æ§"><a href="#21-5-1-rabbitmqctlç®¡ç†å’Œç›‘æ§" class="headerlink" title="21.5.1 rabbitmqctlç®¡ç†å’Œç›‘æ§"></a>21.5.1 <strong>rabbitmqctlç®¡ç†å’Œç›‘æ§</strong></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹é˜Ÿåˆ—</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_queues</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹exchanges</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_exchanges</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ç”¨æˆ·</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_users</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹è¿æ¥</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_connections</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹æ¶ˆè´¹è€…ä¿¡æ¯</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_consumers</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ç¯å¢ƒå˜é‡</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl environment</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹æœªè¢«ç¡®è®¤çš„é˜Ÿåˆ—</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_queues  name messages_unacknowledged</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å•ä¸ªé˜Ÿåˆ—çš„å†…å­˜ä½¿ç”¨</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_queues name memory</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å‡†å¤‡å°±ç»ªçš„é˜Ÿåˆ—</span><br><span class="line"><span class="meta">#</span><span class="bash"> rabbitmqctl list_queues name messages_ready</span></span><br></pre></td></tr></table></figure>



<h1 id="22ï¼ŒRabbitMQåº”ç”¨é—®é¢˜"><a href="#22ï¼ŒRabbitMQåº”ç”¨é—®é¢˜" class="headerlink" title="22ï¼ŒRabbitMQåº”ç”¨é—®é¢˜"></a>22ï¼ŒRabbitMQåº”ç”¨é—®é¢˜</h1><ol>
<li>æ¶ˆæ¯å¯é æ€§ä¿éšœ</li>
</ol>
<ul>
<li>æ¶ˆæ¯è¡¥å¿æœºåˆ¶</li>
</ul>
<ol start="2">
<li>æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ</li>
</ol>
<ul>
<li>ä¹è§‚é”è§£å†³æ–¹æ¡ˆ</li>
</ul>
<h2 id="22-1-æ¶ˆæ¯å¯é æ€§ä¿éšœ"><a href="#22-1-æ¶ˆæ¯å¯é æ€§ä¿éšœ" class="headerlink" title="22.1 æ¶ˆæ¯å¯é æ€§ä¿éšœ"></a>22.1 <strong>æ¶ˆæ¯å¯é æ€§ä¿éšœ</strong></h2><p><strong>æ¶ˆæ¯è¡¥å¿</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-18_13-59-14.png"></p>
<h2 id="22-2-æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ"><a href="#22-2-æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ" class="headerlink" title="22.2 æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ"></a>22.2 æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ</h2><p>å¹‚ç­‰æ€§æŒ‡ä¸€æ¬¡å’Œå¤šæ¬¡è¯·æ±‚æŸä¸€ä¸ªèµ„æºï¼Œå¯¹äºèµ„æºæœ¬èº«åº”è¯¥å…·æœ‰åŒæ ·çš„ç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œå¯¹èµ„æºæœ¬èº«æ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚</p>
<p>åœ¨MQä¸­æŒ‡ï¼Œæ¶ˆè´¹å¤šæ¡ç›¸åŒçš„æ¶ˆæ¯ï¼Œå¾—åˆ°ä¸æ¶ˆè´¹è¯¥æ¶ˆæ¯ä¸€æ¬¡ç›¸åŒçš„ç»“æœã€‚</p>
<p><strong>ä¹è§‚é”æœºåˆ¶</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/RabbitMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/RabbitMQSnipaste_2021-04-18_14-00-32.png"></p>
<h1 id="23ï¼ŒRabbitMQé›†ç¾¤æ­å»º"><a href="#23ï¼ŒRabbitMQé›†ç¾¤æ­å»º" class="headerlink" title="23ï¼ŒRabbitMQé›†ç¾¤æ­å»º"></a>23ï¼ŒRabbitMQé›†ç¾¤æ­å»º</h1><h2 id="æ­¤ç« èŠ‚åç»­è¡¥ä¸Šï¼"><a href="#æ­¤ç« èŠ‚åç»­è¡¥ä¸Šï¼" class="headerlink" title="æ­¤ç« èŠ‚åç»­è¡¥ä¸Šï¼"></a>æ­¤ç« èŠ‚åç»­è¡¥ä¸Šï¼</h2>]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaæ­£åˆ™è¡¨è¾¾å¼</title>
    <url>/2021/04/13/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Javaæ­£åˆ™è¡¨è¾¾å¼"><a href="#Javaæ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="Javaæ­£åˆ™è¡¨è¾¾å¼"></a>Javaæ­£åˆ™è¡¨è¾¾å¼</h1><p><strong>å†™åœ¨å‰é¢</strong></p>
<p><strong>å­¦ä¹ åœ°å€ï¼š</strong></p>
<p><strong><a href="https://www.bilibili.com/video/BV1Eq4y1E79W?p=1">ã€éŸ©é¡ºå¹³è®²Javaã€‘Java æ­£åˆ™è¡¨è¾¾å¼ä¸“é¢˜ </a></strong></p>
<p><strong><a href="https://www.runoob.com/java/java-regular-expressions.html">Java æ­£åˆ™è¡¨è¾¾å¼ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></strong></p>
<p><strong>æ„Ÿè°¢éŸ©è€å¸ˆçš„è®²è§£è§†é¢‘ï¼Œååˆ†æ„Ÿè°¢ï¼ï¼ï¼</strong></p>
<h1 id="1-è®¤è¯†æ­£åˆ™è¡¨è¾¾å¼"><a href="#1-è®¤è¯†æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="1. è®¤è¯†æ­£åˆ™è¡¨è¾¾å¼"></a>1. è®¤è¯†æ­£åˆ™è¡¨è¾¾å¼</h1><p>é¦–å…ˆé€šè¿‡ä¸€ä¸ªä¾‹å­æ¥ä½“éªŒæ­£åˆ™è¡¨è¾¾å¼çš„å¨åŠ›</p>
<p><strong>éšä¾¿æ‰¾æ®µè¯ï¼Œæ‰¾å‡ºæ‰€æœ‰4ä¸ªè¿ç»­æ•°å­—çš„å¼å­</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä½“éªŒæ­£åˆ™è¡¨è¾¾å¼çš„å¨åŠ›</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 12:58</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;1998 å¹´ 12 æœˆ 8 æ—¥ï¼Œç¬¬äºŒä»£ Java å¹³å°çš„ä¼ä¸šç‰ˆ J2EE å‘å¸ƒã€‚1999 å¹´ 6 æœˆï¼ŒSun å…¬å¸å‘å¸ƒäº†&quot;</span> +</span><br><span class="line">                <span class="string">&quot;ç¬¬äºŒä»£ Java å¹³å°ï¼ˆç®€ç§°ä¸º Java2ï¼‰çš„ 3 ä¸ªç‰ˆæœ¬ï¼šJ2MEï¼ˆJava2 Micro Editionï¼ŒJava2 å¹³å°çš„å¾®å‹&quot;</span> +</span><br><span class="line">                <span class="string">&quot;ç‰ˆï¼‰ï¼Œåº”ç”¨äºç§»åŠ¨ã€æ— çº¿åŠæœ‰é™èµ„æºçš„ç¯å¢ƒï¼›J2SEï¼ˆJava 2 Standard Editionï¼ŒJava 2 å¹³å°çš„&quot;</span> +</span><br><span class="line">                <span class="string">&quot;æ ‡å‡†ç‰ˆï¼‰ï¼Œåº”ç”¨äºæ¡Œé¢ç¯å¢ƒï¼›J2EEï¼ˆJava 2Enterprise Editionï¼ŒJava 2 å¹³å°çš„ä¼ä¸šç‰ˆï¼‰ï¼Œåº”&quot;</span> +</span><br><span class="line">                <span class="string">&quot;ç”¨ 3443 äºåŸºäº Java çš„åº”ç”¨æœåŠ¡å™¨ã€‚Java 2 å¹³å°çš„å‘å¸ƒï¼Œæ˜¯ Java å‘å±•è¿‡ç¨‹ä¸­æœ€é‡è¦çš„ä¸€ä¸ª&quot;</span> +</span><br><span class="line">                <span class="string">&quot;é‡Œç¨‹ç¢‘ï¼Œæ ‡å¿—ç€ Java çš„åº”ç”¨å¼€å§‹æ™®åŠ 9889 &quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//ç›®æ ‡åŒ¹é…æ‰€æœ‰å››ä¸ªæ•°å­—</span></span><br><span class="line">        <span class="comment">// \\dè¡¨ç¤ºä»»æ„ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">        String regStr=<span class="string">&quot;\\d\\d\\d\\d&quot;</span>;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ¨¡å¼å¯¹è±¡ å³ æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡</span></span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        <span class="comment">// åˆ›å»ºåŒ¹é…å™¨ æŒ‰ç…§æ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™å»åŒ¹é…contentå­—ç¬¦ä¸²</span></span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line"></span><br><span class="line">        matcher.find();</span><br><span class="line">        <span class="keyword">while</span> (matcher.find())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ°-&gt;&quot;</span>+matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_13-08-55.png"></p>
<p>é€šè¿‡å‡ ä¸ªå¼å­ï¼Œå°±å¯ä»¥ç²¾ç¡®çš„æ‰¾åˆ°è¿ç»­çš„å››ä¸ªæ•°å­—ï¼</p>
<p>æ¥ä¸‹æ¥åˆ†æä¸¤ä¸ªé‡è¦çš„è¡¨è¾¾å¼</p>
<ul>
<li><strong>matcher.find();</strong></li>
</ul>
<p>ä½œç”¨ï¼šè€ƒè™‘åˆ†ç»„</p>
<p>ä»€ä¹ˆæ˜¯åˆ†ç»„ï¼Ÿ æ¯”å¦‚(\\d)(\\d) è¡¨è¾¾å¼ä¸­æœ‰()è¡¨ç¤ºåˆ†ç»„ï¼Œç¬¬ä¸€ä¸ª()è¡¨ç¤ºç¬¬1ç»„ï¼Œç¬¬äºŒè¡¨ç¤ºç¬¬2ç»„</p>
<ol>
<li>æ ¹æ®æŒ‡å®šçš„è§„åˆ™ï¼Œå®šä½æ»¡è¶³è§„åˆ™çš„å­å­—ç¬¦ä¸² æ¯”å¦‚(20)(66)</li>
<li>æ‰¾åˆ°åï¼Œå°† <strong>å­å­—ç¬¦ä¸²çš„å¼€å§‹ç´¢å¼•è®°å½•åˆ°matcherå¯¹è±¡çš„å±æ€§</strong>  int[] groupsï¼›</li>
</ol>
<ul>
<li>2.1 groups[0] = 0 , æŠŠè¯¥å­å­—ç¬¦ä¸²çš„ç»“æŸçš„ç´¢å¼•+1 çš„å€¼è®°å½•åˆ° groups[1] = 4 </li>
<li>2.2 è®°å½• 1 ç»„()åŒ¹é…åˆ°çš„å­—ç¬¦ä¸² groups[2] = 0 groups[3] = 2 </li>
<li>2.3 è®°å½• 2 ç»„()åŒ¹é…åˆ°çš„å­—ç¬¦ä¸² groups[4] = 2 groups[5] = 4</li>
<li>2.4.å¦‚æœæœ‰æ›´å¤šçš„åˆ†ç»„â€¦..</li>
</ul>
<ol start="3">
<li>åŒæ—¶è®°å½•oldLastçš„å€¼ å­å­—ç¬¦ä¸²çš„ç»“æŸçš„ ç´¢å¼•+1çš„å€¼å³ 35 ä¸‹æ¬¡æ‰§è¡Œfindæ—¶ï¼Œå°±ä»35å¼€å§‹åŒ¹é…</li>
</ol>
<ul>
<li><strong>matcher.group();</strong></li>
</ul>
<p>å…ˆçœ‹æºç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">group</span><span class="params">(<span class="keyword">int</span> group)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (first &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">&quot;No match found&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (group &lt; <span class="number">0</span> || group &gt; groupCount())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">&quot;No group &quot;</span> + group);</span><br><span class="line">        <span class="keyword">if</span> ((groups[group*<span class="number">2</span>] == -<span class="number">1</span>) || (groups[group*<span class="number">2</span>+<span class="number">1</span>] == -<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> getSubSequence(groups[group * <span class="number">2</span>], groups[group * <span class="number">2</span> + <span class="number">1</span>]).toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ ¹æ® groups[0]=31 å’Œ groups[1]=35 çš„è®°å½•çš„ä½ç½®ï¼Œä» content å¼€å§‹æˆªå–å­å­—ç¬¦ä¸²è¿”å› </p>
</li>
<li><p>å°±æ˜¯ [31,35) åŒ…å« 31 ä½†æ˜¯ä¸åŒ…å«ç´¢å¼•ä¸º 35 çš„ä½ç½® </p>
</li>
<li><p>å¦‚æœå†æ¬¡æŒ‡å‘ find æ–¹æ³•.ä»ç„¶æŒ‰ç…§ä¸Šé¢åˆ†ææ¥æ‰§è¡Œ</p>
</li>
</ul>
<p>æˆ‘ä»¬å°†åŸæ¥çš„ä»£ç ä¿®æ”¹ä¸‹ çœ‹çœ‹åˆ†ç»„çš„åŒ¹é…æƒ…å†µ</p>
<p>å°† <code>String regStr=&quot;\\d\\d\\d\\d&quot;;</code> æ”¹ä¸º<code>String regStr=&quot;(\\d\\d)(\\d\\d)&quot;;</code></p>
<p><strong>debugå¯åŠ¨</strong> æ–­ç‚¹ä½ç½®å¦‚ä¸‹</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_13-30-55.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä½“éªŒæ­£åˆ™è¡¨è¾¾å¼çš„å¨åŠ›</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 12:58</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;1998 å¹´ 12 æœˆ 8 æ—¥ï¼Œç¬¬äºŒä»£ Java å¹³å°çš„ä¼ä¸šç‰ˆ J2EE å‘å¸ƒã€‚1999 å¹´ 6 æœˆï¼ŒSun å…¬å¸å‘å¸ƒäº†&quot;</span> +</span><br><span class="line">                <span class="string">&quot;ç¬¬äºŒä»£ Java å¹³å°ï¼ˆç®€ç§°ä¸º Java2ï¼‰çš„ 3 ä¸ªç‰ˆæœ¬ï¼šJ2MEï¼ˆJava2 Micro Editionï¼ŒJava2 å¹³å°çš„å¾®å‹&quot;</span> +</span><br><span class="line">                <span class="string">&quot;ç‰ˆï¼‰ï¼Œåº”ç”¨äºç§»åŠ¨ã€æ— çº¿åŠæœ‰é™èµ„æºçš„ç¯å¢ƒï¼›J2SEï¼ˆJava 2 Standard Editionï¼ŒJava 2 å¹³å°çš„&quot;</span> +</span><br><span class="line">                <span class="string">&quot;æ ‡å‡†ç‰ˆï¼‰ï¼Œåº”ç”¨äºæ¡Œé¢ç¯å¢ƒï¼›J2EEï¼ˆJava 2Enterprise Editionï¼ŒJava 2 å¹³å°çš„ä¼ä¸šç‰ˆï¼‰ï¼Œåº”&quot;</span> +</span><br><span class="line">                <span class="string">&quot;ç”¨ 3443 äºåŸºäº Java çš„åº”ç”¨æœåŠ¡å™¨ã€‚Java 2 å¹³å°çš„å‘å¸ƒï¼Œæ˜¯ Java å‘å±•è¿‡ç¨‹ä¸­æœ€é‡è¦çš„ä¸€ä¸ª&quot;</span> +</span><br><span class="line">                <span class="string">&quot;é‡Œç¨‹ç¢‘ï¼Œæ ‡å¿—ç€ Java çš„åº”ç”¨å¼€å§‹æ™®åŠ 9889 &quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//ç›®æ ‡åŒ¹é…æ‰€æœ‰å››ä¸ªæ•°å­—</span></span><br><span class="line">        <span class="comment">// \\dè¡¨ç¤ºä»»æ„ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">        String regStr=<span class="string">&quot;(\\d\\d)(\\d\\d)&quot;</span>;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ¨¡å¼å¯¹è±¡ å³ æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡</span></span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        <span class="comment">// åˆ›å»ºåŒ¹é…å™¨ æŒ‰ç…§æ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™å»åŒ¹é…contentå­—ç¬¦ä¸²</span></span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line"></span><br><span class="line">        matcher.find();</span><br><span class="line">        <span class="keyword">while</span> (matcher.find())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ°-&gt;&quot;</span>+matcher.group(<span class="number">0</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¬¬ä¸€ç»„æ‰¾åˆ°çš„å€¼-&gt;&quot;</span>+matcher.group(<span class="number">1</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¬¬äºŒç»„æ‰¾åˆ°çš„å€¼-&gt;&quot;</span>+matcher.group(<span class="number">2</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨åè¿›å…¥æ–¹æ³•æŸ¥çœ‹å±æ€§  <strong>çœ‹åˆ°groupsä¸­çš„ç´¢å¼•å…ƒç´ åœ¨å¢åŠ ï¼</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_13-29-17.png"></p>
<p><strong>å°ç»“</strong></p>
<ol>
<li><p>å¦‚æœæ­£åˆ™è¡¨è¾¾å¼æœ‰() å³åˆ†ç»„ </p>
</li>
<li><p>å–å‡ºåŒ¹é…çš„å­—ç¬¦ä¸²è§„åˆ™å¦‚ä¸‹ </p>
</li>
<li><p>group(0) è¡¨ç¤ºåŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸² </p>
</li>
<li><p>group(1) è¡¨ç¤ºåŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²çš„ç¬¬ä¸€ç»„å­—ä¸² </p>
</li>
<li><p>group(2) è¡¨ç¤ºåŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²çš„ç¬¬ 2 ç»„å­—ä¸² </p>
</li>
<li><p> ä½†æ˜¯åˆ†ç»„çš„æ•°ä¸èƒ½è¶Šç•Œ</p>
</li>
</ol>
<h1 id="2-æ­£åˆ™è¡¨è¾¾å¼ä»‹ç»"><a href="#2-æ­£åˆ™è¡¨è¾¾å¼ä»‹ç»" class="headerlink" title="2. æ­£åˆ™è¡¨è¾¾å¼ä»‹ç»"></a>2. æ­£åˆ™è¡¨è¾¾å¼ä»‹ç»</h1><p>æ­£åˆ™è¡¨è¾¾å¼(Regular Expression)æ˜¯ä¸€ç§æ–‡æœ¬æ¨¡å¼ï¼ŒåŒ…æ‹¬æ™®é€šå­—ç¬¦ï¼ˆä¾‹å¦‚ï¼Œa åˆ° z ä¹‹é—´çš„å­—æ¯ï¼‰å’Œç‰¹æ®Šå­—ç¬¦ï¼ˆç§°ä¸ºâ€å…ƒå­—ç¬¦â€ï¼‰ã€‚</p>
<p>æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨å•ä¸ªå­—ç¬¦ä¸²æ¥æè¿°ã€åŒ¹é…ä¸€ç³»åˆ—åŒ¹é…æŸä¸ªå¥æ³•è§„åˆ™çš„å­—ç¬¦ä¸²ã€‚</p>
<p>å…ƒå­—ç¬¦ä»åŠŸèƒ½ä¸Šå¤§æ¦‚åˆ†ä¸º</p>
<ul>
<li>é™å®šç¬¦</li>
<li>é€‰æ‹©åŒ¹é…ç¬¦</li>
<li>åˆ†ç»„ç»„åˆå’Œåå‘å¼•ç”¨ç¬¦</li>
<li>ç‰¹æ®Šå­—ç¬¦</li>
<li>å­—ç¬¦åŒ¹é…ç¬¦</li>
<li>å®šä½ç¬¦</li>
</ul>
<h2 id="2-1-å…ƒå­—ç¬¦-è½¬ä¹‰å·"><a href="#2-1-å…ƒå­—ç¬¦-è½¬ä¹‰å·" class="headerlink" title="2.1 å…ƒå­—ç¬¦-è½¬ä¹‰å·\\"></a>2.1 å…ƒå­—ç¬¦-è½¬ä¹‰å·\\</h2><p><code>\\</code>ç¬¦å· è¯´æ˜ï¼šæˆ‘ä»¬ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€ç´¢æŸäº›ç‰¹æ®Šçš„å­—ç¬¦çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ°è½¬ä¹‰ç¬¦å·ï¼Œå¦åˆ™æ£€ç´¢ä¸åˆ°ç»“æœ</p>
<p><font color="red">æ³¨æ„ï¼šJavaçš„æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œä¸¤ä¸ª<code>\\</code>ä»£è¡¨å…¶ä»–è¯­è¨€ä¸­çš„ä¸€ä¸ª<code>\</code></font></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºè½¬ä¹‰å­—ç¬¦çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 13:37</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;abc$(a.bc(123( )&quot;</span>;</span><br><span class="line">        <span class="comment">//åŒ¹é…( =&gt; \\(</span></span><br><span class="line">        <span class="comment">//åŒ¹é…. =&gt; \\. //String regStr = &quot;\\.&quot;;</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\d\\d\\d&quot;;</span></span><br><span class="line">        String regStr = <span class="string">&quot;\\d&#123;3&#125;&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ° &quot;</span> + matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String regStr = <span class="string">&quot;\\d\\d\\d&quot;</span>;<span class="comment">//å¯ä»¥å†™æˆä¸‹é¢çš„æ–¹å¼</span></span><br><span class="line">String regStr = <span class="string">&quot;\\d&#123;3&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_13-43-52.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_13-44-19.png"></p>
<h2 id="2-2-å…ƒå­—ç¬¦-å­—ç¬¦åŒ¹é…ç¬¦"><a href="#2-2-å…ƒå­—ç¬¦-å­—ç¬¦åŒ¹é…ç¬¦" class="headerlink" title="2.2 å…ƒå­—ç¬¦-å­—ç¬¦åŒ¹é…ç¬¦"></a>2.2 å…ƒå­—ç¬¦-å­—ç¬¦åŒ¹é…ç¬¦</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_16-51-49.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_16-52-17.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºè½¬ä¹‰å­—ç¬¦çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 13:58</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;a11c8abc _ABCy @&quot;</span>;</span><br><span class="line">        String regStr = <span class="string">&quot;[a-z]&quot;</span>;<span class="comment">//åŒ¹é… a-z ä¹‹é—´ä»»æ„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;[A-Z]&quot;;//åŒ¹é… A-Z ä¹‹é—´ä»»æ„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;abc&quot;;//åŒ¹é… abc å­—ç¬¦ä¸²[é»˜è®¤åŒºåˆ†å¤§å°å†™]</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;(?i)abc&quot;;//åŒ¹é… abc å­—ç¬¦ä¸²[ä¸åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;[0-9]&quot;;//åŒ¹é… 0-9 ä¹‹é—´ä»»æ„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;[^a-z]&quot;;//åŒ¹é… ä¸åœ¨ a-z ä¹‹é—´ä»»æ„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;[^0-9]&quot;;//åŒ¹é… ä¸åœ¨ 0-9 ä¹‹é—´ä»»æ„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;[abcd]&quot;;//åŒ¹é… åœ¨ abcd ä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\D&quot;;//åŒ¹é… ä¸åœ¨ 0-9 çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\w&quot;;//åŒ¹é… å¤§å°å†™è‹±æ–‡å­—æ¯, æ•°å­—ï¼Œä¸‹åˆ’çº¿</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\W&quot;;//åŒ¹é… ç­‰ä»·äº [^a-zA-Z0-9_]</span></span><br><span class="line">        <span class="comment">//\\s åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦(ç©ºæ ¼,åˆ¶è¡¨ç¬¦ç­‰)</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\s&quot;;</span></span><br><span class="line">        <span class="comment">//\\S åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ ,å’Œ\\s åˆšå¥½ç›¸å</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\S&quot;;</span></span><br><span class="line">        <span class="comment">//. åŒ¹é…å‡º \n ä¹‹å¤–çš„æ‰€æœ‰å­—ç¬¦,å¦‚æœè¦åŒ¹é….æœ¬èº«åˆ™éœ€è¦ä½¿ç”¨ \\. </span></span><br><span class="line">        <span class="comment">// String regStr = &quot;.&quot;;</span></span><br><span class="line">        <span class="comment">//è¯´æ˜</span></span><br><span class="line">        <span class="comment">//1. å½“åˆ›å»º Pattern å¯¹è±¡æ—¶ï¼ŒæŒ‡å®š Pattern.CASE_INSENSITIVE, è¡¨ç¤ºåŒ¹é…æ˜¯ä¸åŒºåˆ†å­—æ¯å¤§å°å†™.</span></span><br><span class="line">        Pattern pattern = Pattern.compile(regStr<span class="comment">/*, Pattern.CASE_INSENSITIVE*/</span>);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ° &quot;</span> + matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-3-å…ƒå­—ç¬¦-é€‰æ‹©åŒ¹é…å­—ç¬¦"><a href="#2-3-å…ƒå­—ç¬¦-é€‰æ‹©åŒ¹é…å­—ç¬¦" class="headerlink" title="2.3 å…ƒå­—ç¬¦-é€‰æ‹©åŒ¹é…å­—ç¬¦"></a>2.3 å…ƒå­—ç¬¦-é€‰æ‹©åŒ¹é…å­—ç¬¦</h2><p>åœ¨åŒ¹é…æŸä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™æ˜¯é€‰æ‹©æ€§çš„ æ—¢å¯ä»¥åŒ¹é…è¿™ä¸ªï¼Œä¹Ÿå¯ä»¥åŒ¹é…é‚£ä¸ªï¼Œéœ€è¦ç”¨åˆ°åŒ¹é…ç¬¦å·<code>|</code></p>
<table>
<thead>
<tr>
<th>ç¬¦å·</th>
<th>ç¬¦å·</th>
<th>ç¤ºä¾‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td>|</td>
<td>åŒ¹é…â€|â€ä¹‹å‰æˆ–ä¹‹åçš„è¡¨è¾¾å¼</td>
<td>ab|cd</td>
<td>abæˆ–è€…cd</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex04</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é€‰æ‹©åŒ¹é…ç¬¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:04</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex04</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;kangxiaozhuang åº· æ‰›æŠ—&quot;</span>;</span><br><span class="line">        String regStr = <span class="string">&quot;kang|åº·|æ‰›&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(regStr<span class="comment">/*, Pattern.CASE_INSENSITIVE*/</span>);</span><br><span class="line">        Matcher matcher =pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ° &quot;</span> + matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_14-06-12.png"></p>
<h2 id="2-4-å…ƒå­—ç¬¦-é™å®šç¬¦"><a href="#2-4-å…ƒå­—ç¬¦-é™å®šç¬¦" class="headerlink" title="2.4 å…ƒå­—ç¬¦-é™å®šç¬¦"></a>2.4 å…ƒå­—ç¬¦-é™å®šç¬¦</h2><p>ç”¨äºæŒ‡å®šå…¶å‰é¢çš„å­—ç¬¦å’Œç»„åˆé¡¹è¿ç»­å‡ºç°å¤šå°‘æ¬¡</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_16-52-55.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex05</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;a211111aaaaaahello&quot;</span>;</span><br><span class="line">        <span class="comment">//a&#123;3&#125;,1&#123;4&#125;,\\d&#123;2&#125;</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;a&#123;3&#125;&quot;;// è¡¨ç¤ºåŒ¹é… aaa</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;1&#123;4&#125;&quot;;// è¡¨ç¤ºåŒ¹é… 1111</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\d&#123;2&#125;&quot;;// è¡¨ç¤ºåŒ¹é… ä¸¤ä½çš„ä»»æ„æ•°å­—å­—ç¬¦</span></span><br><span class="line">        <span class="comment">//a&#123;3,4&#125;,1&#123;4,5&#125;,\\d&#123;2,5&#125;</span></span><br><span class="line">        <span class="comment">//ç»†èŠ‚ï¼šjava åŒ¹é…é»˜è®¤è´ªå©ªåŒ¹é…ï¼Œå³å°½å¯èƒ½åŒ¹é…å¤šçš„</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;a&#123;3,4&#125;&quot;; //è¡¨ç¤ºåŒ¹é… aaa æˆ–è€… aaaa</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;1&#123;4,5&#125;&quot;; //è¡¨ç¤ºåŒ¹é… 1111 æˆ–è€… 11111</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\d&#123;2,5&#125;&quot;; //åŒ¹é… 2 ä½æ•°æˆ–è€… 3,4,5</span></span><br><span class="line">        <span class="comment">//1+</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;1+&quot;; //åŒ¹é…ä¸€ä¸ª 1 æˆ–è€…å¤šä¸ª 1</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;\\d+&quot;; //åŒ¹é…ä¸€ä¸ªæ•°å­—æˆ–è€…å¤šä¸ªæ•°å­—</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;1*&quot;; //åŒ¹é… 0 ä¸ª 1 æˆ–è€…å¤šä¸ª 1</span></span><br><span class="line">        <span class="comment">//æ¼”ç¤º?çš„ä½¿ç”¨, éµå®ˆè´ªå©ªåŒ¹é…</span></span><br><span class="line">        String regStr = <span class="string">&quot;a1?&quot;</span>; <span class="comment">//åŒ¹é… a æˆ–è€… a1</span></span><br><span class="line">        Pattern pattern = Pattern.compile(regStr<span class="comment">/*, Pattern.CASE_INSENSITIVE*/</span>);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ° &quot;</span> + matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-5-å…ƒå­—ç¬¦-å®šä½ç¬¦"><a href="#2-5-å…ƒå­—ç¬¦-å®šä½ç¬¦" class="headerlink" title="2.5 å…ƒå­—ç¬¦-å®šä½ç¬¦"></a>2.5 å…ƒå­—ç¬¦-å®šä½ç¬¦</h2><p>å®šä½ç¬¦ï¼Œè§„å®šè¦åŒ¹é…çš„å­—ç¬¦ä¸²å‡ºç°çš„ä½ç½®ï¼Œæ¯”å¦‚åœ¨å­—ç¬¦ä¸²çš„å¼€å§‹è¿˜æ˜¯åœ¨ç»“æŸçš„ä½ç½®</p>
<table>
<thead>
<tr>
<th>ç¬¦å·</th>
<th>å«ä¹‰</th>
<th>ç¤ºä¾‹</th>
<th>è¯´æ˜</th>
<th>åŒ¹é…è¾“å…¥</th>
</tr>
</thead>
<tbody><tr>
<td>^</td>
<td>æŒ‡å®šèµ·å§‹å­—ç¬¦</td>
<td><code>^[0-9]+[a-z]*</code></td>
<td>ä»¥è‡³å°‘1ä¸ªæ•°å­—å¼€å¤´ï¼Œåæ¥ä»»æ„ä¸ªå°å†™å­—æ¯çš„å­—ç¬¦ä¸²</td>
<td>123,6aa</td>
</tr>
<tr>
<td>$</td>
<td>æŒ‡å®šç»“æŸå­—ç¬¦</td>
<td><code>^[0-9]\\\\-[a-z]+$</code></td>
<td>ä»¥1ä¸ªæ•°å­—å¼€å¤´åè¿æ¥å­—ç¬¦â€-â€œï¼Œå¹¶ä»¥è‡³å°‘1ä¸ªå°å†™å­—æ¯ç»“å°¾çš„å­—ç¬¦ä¸²</td>
<td>1-a</td>
</tr>
<tr>
<td>\\b</td>
<td>åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„è¾¹ç•Œ</td>
<td>kang\\b</td>
<td>è¿™é‡Œè¯´çš„å­—ç¬¦ä¸²çš„è¾¹ç•ŒæŒ‡çš„æ˜¯å­ä¸²é—´æœ‰ç©ºæ ¼ï¼Œæˆ–è€…æ˜¯ç›®æ ‡å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®</td>
<td>spkang,hhkang</td>
</tr>
<tr>
<td>\\B</td>
<td>åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„éè¾¹ç•Œ</td>
<td>kang\\B</td>
<td>å’Œ\\bçš„å«ä¹‰åˆšåˆšç›¸å</td>
<td>kangzk,niukang</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºå®šä½ç¬¦çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex06</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;kangxiaozhuang spkang nnkang&quot;</span>;</span><br><span class="line">    <span class="comment">//String content = &quot;123-abc&quot;;</span></span><br><span class="line">    <span class="comment">//ä»¥è‡³å°‘ 1 ä¸ªæ•°å­—å¼€å¤´ï¼Œåæ¥ä»»æ„ä¸ªå°å†™å­—æ¯çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">//String regStr = &quot;^[0-9]+[a-z]*&quot;;</span></span><br><span class="line">    <span class="comment">//ä»¥è‡³å°‘ 1 ä¸ªæ•°å­—å¼€å¤´, å¿…é¡»ä»¥è‡³å°‘ä¸€ä¸ªå°å†™å­—æ¯ç»“æŸ</span></span><br><span class="line">    <span class="comment">//String regStr = &quot;^[0-9]+\\-[a-z]+$&quot;;</span></span><br><span class="line">    <span class="comment">//è¡¨ç¤ºåŒ¹é…è¾¹ç•Œçš„ han[è¿™é‡Œçš„è¾¹ç•Œæ˜¯æŒ‡ï¼šè¢«åŒ¹é…çš„å­—ç¬¦ä¸²æœ€å, // ä¹Ÿå¯ä»¥æ˜¯ç©ºæ ¼çš„å­å­—ç¬¦ä¸²çš„åé¢]</span></span><br><span class="line">    String regStr = <span class="string">&quot;kang\\b&quot;</span>;</span><br><span class="line">    <span class="comment">//å’Œ\\b çš„å«ä¹‰åˆšåˆšç›¸å</span></span><br><span class="line"><span class="comment">//        String regStr = &quot;kang\\B&quot;;</span></span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ°=&quot;</span> + matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="3-åˆ†ç»„"><a href="#3-åˆ†ç»„" class="headerlink" title="3. åˆ†ç»„"></a>3. åˆ†ç»„</h1><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_16-54-39.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_16-54-37.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex07</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åˆ†ç»„æ¼”ç¤º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:34</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex07</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String content = <span class="string">&quot;kangxiaozhuang s7789 nn1189h&quot;</span>;</span><br><span class="line">        <span class="comment">// 1. matcher.group(0) å¾—åˆ°åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="comment">// 2. matcher.group(1) å¾—åˆ°åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²çš„ç¬¬ 1 ä¸ªåˆ†ç»„å†…å®¹</span></span><br><span class="line">        <span class="comment">// 3. matcher.group(2) å¾—åˆ°åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²çš„ç¬¬ 2 ä¸ªåˆ†ç»„å†…å®¹</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;(\\d\\d)(\\d\\d)&quot;;//åŒ¹é… 4 ä¸ªæ•°å­—çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="comment">//å‘½ååˆ†ç»„ï¼š å³å¯ä»¥ç»™åˆ†ç»„å–å</span></span><br><span class="line">        String regStr = <span class="string">&quot;(?&lt;g1&gt;\\d\\d)(?&lt;g2&gt;\\d\\d)&quot;</span>;<span class="comment">//åŒ¹é… 4 ä¸ªæ•°å­—çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ°=&quot;</span> + matcher.group(<span class="number">0</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¬¬ 1 ä¸ªåˆ†ç»„å†…å®¹=&quot;</span> + matcher.group(<span class="number">1</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¬¬ 1 ä¸ªåˆ†ç»„å†…å®¹[é€šè¿‡ç»„å]=&quot;</span> + matcher.group(<span class="string">&quot;g1&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¬¬ 2 ä¸ªåˆ†ç»„å†…å®¹=&quot;</span> + matcher.group(<span class="number">2</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¬¬ 2 ä¸ªåˆ†ç»„å†…å®¹[é€šè¿‡ç»„å]=&quot;</span> + matcher.group(<span class="string">&quot;g2&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_14-35-48.png"></p>
<h1 id="4-ç»ƒä¹ "><a href="#4-ç»ƒä¹ " class="headerlink" title="4. ç»ƒä¹ "></a>4. ç»ƒä¹ </h1><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_14-37-53.png"></p>
<p>è¦æ±‚å¦‚ä¸Š å¯¹å­—ç¬¦ä¸²è¿›è¡ŒéªŒè¯ï¼</p>
<p>æ³¨æ„ æ±‰å­—çš„ç¼–ç å¦‚ä¸‹èŒƒå›´</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String regStr = <span class="string">&quot;^[\u0391-\uffe5]+$&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex08</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åº”ç”¨å®ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex08</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;13588889999&quot;</span>;</span><br><span class="line">        <span class="comment">// æ±‰å­—</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;^[\u0391-\uffe5]+$&quot;;</span></span><br><span class="line">        <span class="comment">// é‚®æ”¿ç¼–ç </span></span><br><span class="line">        <span class="comment">// è¦æ±‚ï¼šæ˜¯ 1-9 å¼€å¤´çš„ä¸€ä¸ªå…­ä½æ•°. æ¯”å¦‚ï¼š123890</span></span><br><span class="line">        <span class="comment">//  String regStr = &quot;^[1-9]\\d&#123;5&#125;$&quot;;</span></span><br><span class="line">        <span class="comment">// QQ å·ç </span></span><br><span class="line">        <span class="comment">// è¦æ±‚: æ˜¯ 1-9 å¼€å¤´çš„ä¸€ä¸ª(5 ä½æ•°-10 ä½æ•°) æ¯”å¦‚: 12389 , 1345687 , 187698765</span></span><br><span class="line">        <span class="comment">//String regStr = &quot;^[1-9]\\d&#123;4,9&#125;$&quot;;</span></span><br><span class="line">        <span class="comment">// æ‰‹æœºå·ç </span></span><br><span class="line">        <span class="comment">// è¦æ±‚: å¿…é¡»ä»¥ 13,14,15,18 å¼€å¤´çš„ 11 ä½æ•° , æ¯”å¦‚ 13588889999</span></span><br><span class="line">        String regStr = <span class="string">&quot;^1[3|4|5|8]\\d&#123;9&#125;$&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">if</span>(matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ»¡è¶³æ ¼å¼&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä¸æ»¡è¶³æ ¼å¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åŒ¹é…URLçš„æ€è·¯</strong></p>
<ul>
<li>å…ˆç¡®å®š url çš„å¼€å§‹éƒ¨åˆ† https:// | http://</li>
<li>ç„¶åé€šè¿‡ ([\w-]+.)+[\w-]+ åŒ¹é…<code>www.bilibili.com</code></li>
<li>/video/BV1fh411y7R8?from=sear åŒ¹é…(/[\w-?=&amp;/%.#]*)?</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> dell</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex09</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åˆ¤æ–­URLçš„è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:42</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex09</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//String content = &quot;https://www.bilibili.com/video/BV1fh411y7R8?from=search&amp;seid=1831060912083761326&quot;;</span></span><br><span class="line">        String content =<span class="string">&quot;https://www.runoob.com/regexp/regexp-syntax.html&quot;</span>;</span><br><span class="line">        <span class="comment">//æ³¨æ„ï¼š[. ? *]è¡¨ç¤ºåŒ¹é…å°±æ˜¯.æœ¬èº«</span></span><br><span class="line">        String regStr = <span class="string">&quot;^((http|https)://)?([\\w-]+\\.)+[\\w-]+(\\/[\\w-?=&amp;/%.#]*)?$&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">if</span>(matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ»¡è¶³æ ¼å¼&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä¸æ»¡è¶³æ ¼å¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è¿™é‡Œå¦‚æœä½¿ç”¨ Pattern çš„ matches æ•´ä½“åŒ¹é… æ¯”è¾ƒç®€æ´</span></span><br><span class="line">        System.out.println(Pattern.matches(regStr, content));<span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="5-æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨çš„ä¸‰ä¸ªå¸¸ç”¨ç±»"><a href="#5-æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨çš„ä¸‰ä¸ªå¸¸ç”¨ç±»" class="headerlink" title="5. æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨çš„ä¸‰ä¸ªå¸¸ç”¨ç±»"></a>5. æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨çš„ä¸‰ä¸ªå¸¸ç”¨ç±»</h1><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_14-48-48.png"></p>
<p>æ›´å¤šæ–¹æ³•å‚è€ƒï¼š<a href="https://www.runoob.com/java/java-regular-expressions.html">Java æ­£åˆ™è¡¨è¾¾å¼ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PatternMethod</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤º matches æ–¹æ³•ï¼Œç”¨äºæ•´ä½“åŒ¹é…, åœ¨éªŒè¯è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦æ»¡è¶³æ¡ä»¶ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PatternMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;hello abc hello, kang&quot;</span>;</span><br><span class="line">        <span class="comment">//String regStr = &quot;hello&quot;;</span></span><br><span class="line">        String regStr = <span class="string">&quot;hello.*&quot;</span>;</span><br><span class="line">        <span class="keyword">boolean</span> matches = Pattern.matches(regStr, content);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ•´ä½“åŒ¹é…= &quot;</span> + matches);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Matcherç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MatcherMethod</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  Matcherå¸¸ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 14:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MatcherMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;hello edu jack kangxiaohhh hello hhkxz hello kkxxaa kxzkxz&quot;</span>;</span><br><span class="line">        String regStr = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">            System.out.println(matcher.start());</span><br><span class="line">            System.out.println(matcher.end());</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ°: &quot;</span> + content.substring(matcher.start(), matcher.end()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ•´ä½“åŒ¹é…æ–¹æ³•ï¼Œå¸¸ç”¨äºï¼Œå»æ ¡éªŒæŸä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ»¡è¶³æŸä¸ªè§„åˆ™</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ•´ä½“åŒ¹é…=&quot;</span> + matcher.matches());</span><br><span class="line">        <span class="comment">//å®Œæˆå¦‚æœ content æœ‰ kang æ›¿æ¢æˆ åº·å°åº„ï¼ï¼ï¼</span></span><br><span class="line">        regStr = <span class="string">&quot;kang&quot;</span>;</span><br><span class="line">        pattern = Pattern.compile(regStr);</span><br><span class="line">        matcher = pattern.matcher(content);</span><br><span class="line">        <span class="comment">//æ³¨æ„ï¼šè¿”å›çš„å­—ç¬¦ä¸²æ‰æ˜¯æ›¿æ¢åçš„å­—ç¬¦ä¸² åŸæ¥çš„ content ä¸å˜åŒ–</span></span><br><span class="line">        String newContent = matcher.replaceAll(<span class="string">&quot;åº·å°åº„ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;newContent=&quot;</span> + newContent);</span><br><span class="line">        System.out.println(<span class="string">&quot;content=&quot;</span> + content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_14-55-34.png"></p>
<h1 id="6-åˆ†ç»„ï¼Œæ•è·ï¼Œåå‘å¼•ç”¨"><a href="#6-åˆ†ç»„ï¼Œæ•è·ï¼Œåå‘å¼•ç”¨" class="headerlink" title="6.åˆ†ç»„ï¼Œæ•è·ï¼Œåå‘å¼•ç”¨"></a>6.åˆ†ç»„ï¼Œæ•è·ï¼Œåå‘å¼•ç”¨</h1><p><strong>åˆ†ç»„</strong></p>
<ul>
<li>å¯ä»¥ç”¨åœ†æ‹¬å·ç»„æˆä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„åŒ¹é…æ¨¡å¼ï¼Œé‚£ä¹ˆä¸€ä¸ªåœ†æ‹¬å·çš„éƒ¨åˆ†æˆ‘ä»¬å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªå­è¡¨è¾¾å¼/ä¸€ä¸ªåˆ†ç»„</li>
</ul>
<p><strong>æ•è·</strong></p>
<ul>
<li>æŠŠæ­£åˆ™è¡¨è¾¾å¼ä¸­å­è¡¨è¾¾å¼/åˆ†ç»„åŒ¹é…çš„å†…å®¹ï¼Œä¿å­˜åˆ°å†…å­˜ä¸­ä»¥æ•°å­—ç¼–å·æˆ–æ˜¾å¼å‘½åçš„ç»„é‡Œï¼Œæ–¹ä¾¿åé¢å¼•ç”¨ï¼Œä»å·¦å‘å³ï¼Œä»¥åˆ†ç»„çš„å·¦æ‹¬å·ä¸ºæ ‡å¿—ï¼Œç¬¬ä¸€ä¸ªå‡ºç°çš„åˆ†ç»„çš„ç»„å¥½ä¸º1ï¼Œç¬¬äºŒä¸ªä½2ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç»„0ä»£è¡¨çš„æ˜¯æ•´ä¸ªæ­£åˆ™å¼</li>
</ul>
<p><strong>åå‘å¼•ç”¨</strong></p>
<ul>
<li>åœ†æ‹¬å·çš„å†…å®¹è¢«æ•è·åï¼Œå¯ä»¥åœ¨è¿™ä¸ªæ‹¬å·åä½¿ç”¨ï¼Œå†™å‡ºä¸€ä¸ªå®ç”¨çš„åŒ¹é…æ¨¡å¼ <strong>ç§°ä¸ºåå‘å¼•ç”¨</strong> å¯ä»¥åœ¨è¡¨è¾¾å¼å†…éƒ¨æˆ–è€…å¤–éƒ¨</li>
<li>å†…éƒ¨åå‘å¼•ç”¨<strong>\\åˆ†ç»„å·</strong>ï¼Œå¤–éƒ¨åå‘å¼•ç”¨çš„**$åˆ†ç»„å·**</li>
</ul>
<p>çœ‹å‡ ä¸ªæ¡ˆä¾‹</p>
<ul>
<li>è¦åŒ¹é…ä¸¤ä¸ªè¿ç»­çš„ç›¸åŒæ•°å­—  <code>(\\d)\\1</code></li>
<li>è¦åŒ¹é…äº”ä¸ªè¿ç»­çš„ç›¸åŒæ•°å­— <code>(\\d)\\1&#123;4&#125;</code></li>
<li>è¦åŒ¹é…ä¸ªä½ä¸åƒä½ç›¸åŒï¼Œåä½ä¸ç™¾ä½ç›¸åŒçš„æ•°ï¼Œ5225,1551  <code>(\\d)(\\d)\\2\\1</code></li>
<li>åŒ¹é… å½¢å¦‚12321-333666999 è¿™æ ·çš„å·ç æ»¡è¶³å‰é¢ä¸€ä¸ªäº”ä½æ•°<br> ç„¶åä¸€ä¸ª- ç„¶åæ˜¯ä¸€ä¸ªä¹ä½æ•°ï¼Œè¿ç»­çš„æ¯ä¸‰ä½è¦ç›¸åŒ</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex10</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¡ˆä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 15:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex10</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;h23423288888856666 jackangdaxxxiiit6886  65432-999888777&quot;</span>;</span><br><span class="line">        <span class="comment">// åŒ¹é…è¿ç»­ä¸¤ä¸ªç›¸åŒçš„æ•°å­—</span></span><br><span class="line">       <span class="comment">// String regStr=&quot;(\\d)\\1&quot;;</span></span><br><span class="line">       <span class="comment">// åŒ¹é…è¿ç»­äº”ä¸ªç›¸åŒçš„æ•°å­—</span></span><br><span class="line">       <span class="comment">// String regStr=&quot;(\\d)\\1&#123;4&#125;&quot;;</span></span><br><span class="line">       <span class="comment">//åŒ¹é… ä¸ªä½å’Œåƒä½ç›¸åŒ åä½å’Œç™¾ä½ç›¸åŒçš„æ•°å­—</span></span><br><span class="line">       <span class="comment">//   String regStr=&quot;(\\d)(\\d)\\2\\1&quot;;</span></span><br><span class="line">        <span class="comment">// åŒ¹é… å½¢å¦‚12321-333666999 è¿™æ ·çš„å·ç æ»¡è¶³å‰é¢ä¸€ä¸ªäº”ä½æ•°</span></span><br><span class="line"><span class="comment">//        ç„¶åä¸€ä¸ª- ç„¶åæ˜¯ä¸€ä¸ªä¹ä½æ•°ï¼Œè¿ç»­çš„æ¯ä¸‰ä½è¦ç›¸åŒ</span></span><br><span class="line">        String regStr=<span class="string">&quot;\\d&#123;5&#125;-(\\d)\\1&#123;2&#125;(\\d)\\2&#123;2&#125;(\\d)\\3&#123;2&#125;&quot;</span>;</span><br><span class="line">       Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‰¾åˆ°-&gt;&quot;</span>+matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7-String-ç±»ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾"><a href="#7-String-ç±»ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾" class="headerlink" title="7.String ç±»ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾"></a>7.String ç±»ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾</h1><p>æ›¿æ¢åŠŸèƒ½</p>
<p> StringReg.java String ç±»</p>
<ul>
<li>public String replaceAll(String regex,String replacement)</li>
</ul>
<p> åˆ¤æ–­åŠŸèƒ½ </p>
<p>String ç±» </p>
<ul>
<li>public boolean matches(String regex){} //ä½¿ç”¨ Pattern å’Œ Matcher ç±» </li>
</ul>
<p>åˆ†å‰²åŠŸèƒ½ </p>
<p>String ç±» </p>
<ul>
<li>public String[] split(String regex)</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Regex11</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Stringç±»ä¸­çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 15:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Regex11</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;2000 å¹´ 5 æœˆï¼ŒJDK1.3ã€JDK1.4 å’Œ J2SE1.3 ç›¸ç»§å‘å¸ƒï¼Œå‡ å‘¨åå…¶&quot;</span> +</span><br><span class="line">                <span class="string">&quot;è·å¾—äº† Apple å…¬å¸ Mac OS X çš„å·¥ä¸šæ ‡å‡†çš„æ”¯æŒã€‚2001 å¹´ 9 æœˆ 24 æ—¥ï¼ŒJ2EE1.3 å‘&quot;</span> +</span><br><span class="line">                <span class="string">&quot;å¸ƒã€‚&quot;</span> +</span><br><span class="line">                <span class="string">&quot;2002 å¹´ 2 æœˆ 26 æ—¥ï¼ŒJ2SE1.4 å‘å¸ƒã€‚è‡ªæ­¤ Java çš„è®¡ç®—èƒ½åŠ›æœ‰äº†å¤§å¹…æå‡&quot;</span>;</span><br><span class="line"><span class="comment">//ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ–¹å¼ï¼Œå°† JDK1.3 å’Œ JDK1.4 æ›¿æ¢æˆ JDK</span></span><br><span class="line">        content = content.replaceAll(<span class="string">&quot;JDK1\\.3|JDK1\\.4&quot;</span>, <span class="string">&quot;JDK&quot;</span>);</span><br><span class="line">        System.out.println(content);</span><br><span class="line"><span class="comment">//è¦æ±‚ éªŒè¯ä¸€ä¸ª æ‰‹æœºå·ï¼Œ è¦æ±‚å¿…é¡»æ˜¯ä»¥ 138 139 å¼€å¤´çš„</span></span><br><span class="line">        content = <span class="string">&quot;13888889999&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (content.matches(<span class="string">&quot;1(38|39)\\d&#123;8&#125;&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;éªŒè¯æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;éªŒè¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è¦æ±‚æŒ‰ç…§ # æˆ–è€… - æˆ–è€… ~ æˆ–è€… æ•°å­— æ¥åˆ†å‰²</span></span><br><span class="line">        System.out.println(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line">        content = <span class="string">&quot;hello#abc-jack12smith~åŒ—äº¬&quot;</span>;</span><br><span class="line">        String[] split = content.split(<span class="string">&quot;#|-|~|\\d+&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String s : split) &#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="8-ç»¼åˆç»ƒä¹ "><a href="#8-ç»¼åˆç»ƒä¹ " class="headerlink" title="8. ç»¼åˆç»ƒä¹ "></a>8. ç»¼åˆç»ƒä¹ </h1><h2 id="8-1-éªŒè¯ç”µå­é‚®ä»¶æ ¼å¼æ˜¯å¦åˆæ³•"><a href="#8-1-éªŒè¯ç”µå­é‚®ä»¶æ ¼å¼æ˜¯å¦åˆæ³•" class="headerlink" title="8.1 éªŒè¯ç”µå­é‚®ä»¶æ ¼å¼æ˜¯å¦åˆæ³•"></a>8.1 éªŒè¯ç”µå­é‚®ä»¶æ ¼å¼æ˜¯å¦åˆæ³•</h2><ul>
<li><p>åªèƒ½æœ‰ä¸€ä¸ª@</p>
</li>
<li><p>@å‰é¢æ˜¯ç”¨æˆ·åï¼Œå¯ä»¥æ˜¯a-zï¼ŒA-Zï¼Œ0-9 - _ å­—ç¬¦</p>
</li>
<li><p>@åé¢æ˜¯åŸŸå å¹¶ä¸”åŸŸååªèƒ½æ˜¯è‹±æ–‡å­—æ¯ æ¯”å¦‚ <code>itkxz@qq.com</code></p>
</li>
<li><p>å†™å‡ºå¯¹åº”çš„æ­£åˆ™è¡¨è¾¾å¼éªŒè¯è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦æ»¡è¶³è§„åˆ™</p>
</li>
</ul>
<blockquote>
<p>å…ˆå†™å‡ºç®€å•çš„è¡¨è¾¾å¼ï¼Œå†é€æ­¥å®Œå–„ï¼</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Homework01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¡ˆä¾‹1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 16:08</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Homework01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;itkxz@qq.com&quot;</span>;</span><br><span class="line">        String regStr=<span class="string">&quot;[\\w-_]+@([a-zA-Z]+\\.)+[a-zA-Z]+&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (content.matches(regStr))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;åŒ¹é…æˆåŠŸï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;åŒ¹é…å¤±è´¥ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-2-éªŒè¯æ˜¯ä¸æ˜¯æ•´æ•°æˆ–å°æ•°"><a href="#8-2-éªŒè¯æ˜¯ä¸æ˜¯æ•´æ•°æˆ–å°æ•°" class="headerlink" title="8.2 éªŒè¯æ˜¯ä¸æ˜¯æ•´æ•°æˆ–å°æ•°"></a>8.2 éªŒè¯æ˜¯ä¸æ˜¯æ•´æ•°æˆ–å°æ•°</h2><ul>
<li>è€ƒè™‘åˆ°æ­£æ•°å’Œè´Ÿæ•°</li>
<li>123 34.55 0.58ç­‰</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Homework01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¡ˆä¾‹2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 16:08</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Homework02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;-0.58&quot;</span>;</span><br><span class="line">        String regStr=<span class="string">&quot;^[+-]?([1-9]\\d*|0)(\\.\\d+)?$&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (content.matches(regStr))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;åŒ¹é…æˆåŠŸ æ˜¯æ­£æ•°æˆ–è€…å°æ•°ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;åŒ¹é…å¤±è´¥ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-3-éªŒè¯æ˜¯å¦ä¸ºURL"><a href="#8-3-éªŒè¯æ˜¯å¦ä¸ºURL" class="headerlink" title="8.3 éªŒè¯æ˜¯å¦ä¸ºURL"></a>8.3 éªŒè¯æ˜¯å¦ä¸ºURL</h2><ul>
<li>åè®®</li>
<li>åŸŸå</li>
<li>ç«¯å£</li>
<li>æ–‡ä»¶å</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.regex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Homework03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¡ˆä¾‹3</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/23 16:08</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Homework03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;http://space.bilibili.com:8080/abc/favlist&quot;</span>;</span><br><span class="line">        String regStr=<span class="string">&quot;^([a-zA-Z]+)://([a-zA-Z.]+):(\\d+)[\\w-/]*/([\\w.]+)$&quot;</span>;</span><br><span class="line"></span><br><span class="line">        Pattern pattern = Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher = pattern.matcher(content);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (matcher.matches())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;åŒ¹é…æˆåŠŸï¼ï¼ï¼&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;åè®®-&gt;&quot;</span>+ matcher.group(<span class="number">0</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;åŸŸå-&gt;&quot;</span>+ matcher.group(<span class="number">1</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç«¯å£-&gt;&quot;</span>+ matcher.group(<span class="number">2</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–‡ä»¶å-&gt;&quot;</span>+ matcher.group(<span class="number">3</span>));</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;åŒ¹é…å¤±è´¥ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE%E7%89%87/Snipaste_2021-05-23_16-37-48.png"></p>
<p><strong>å†™åœ¨æœ€åï¼šç”¨éŸ©è€å¸ˆçš„ä¸€å¥è¯æ¥é­ç­–è‡ªå·±â€æˆ‘äº¦æ— ä»–ï¼ŒæƒŸæ‰‹ç†Ÿå°”ï¼â€</strong></p>
<p><strong>è‹¥æœ‰é”™è¯¯ï¼Œè¿˜è¯·å„ä½æŒ‡å‡ºé”™è¯¯ï¼ŒåŠæ—¶æ›´æ”¹ï¼</strong></p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>23ç§è®¾è®¡æ¨¡å¼å­¦ä¹ ç¬”è®°</title>
    <url>/2021/04/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p><strong>å­¦ä¹ åœ°å€</strong></p>
<p><strong><a href="https://www.bilibili.com/video/BV1G4411c7N4">https://www.bilibili.com/video/BV1G4411c7N4</a></strong></p>
<p><strong><a href="https://www.bilibili.com/video/BV1Np4y1z7BU">https://www.bilibili.com/video/BV1Np4y1z7BU</a></strong></p>
<p><strong>å‚è€ƒæ–‡ç« </strong></p>
<p><strong><a href="http://c.biancheng.net/view/1317.html">http://c.biancheng.net/view/1317.html</a></strong></p>
<h1 id="1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°"><a href="#1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°" class="headerlink" title="1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°"></a>1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°</h1><h2 id="1-1-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯"><a href="#1-1-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯" class="headerlink" title="1.1 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯"></a>1.1 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯</h2><p>â€œè®¾è®¡æ¨¡å¼â€æœ€åˆå¹¶ä¸æ˜¯å‡ºç°åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼Œè€Œæ˜¯è¢«ç”¨äºå»ºç­‘é¢†åŸŸçš„è®¾è®¡ä¸­ã€‚</p>
<p>1977å¹´ç¾å›½è‘—åå»ºç­‘å¤§å¸ˆã€åŠ åˆ©ç¦å°¼äºšå¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡ç¯å¢ƒç»“æ„ä¸­å¿ƒä¸»ä»»<code>å…‹é‡Œæ–¯æ‰˜å¤«Â·äºšå†å±±å¤§ï¼ˆChristopher Alexanderï¼‰</code>åœ¨ä»–çš„è‘—ä½œã€Šå»ºç­‘æ¨¡å¼è¯­è¨€ï¼šåŸé•‡ã€å»ºç­‘ã€æ„é€ ã€‹ä¸­æè¿°äº†ä¸€äº›å¸¸è§çš„å»ºç­‘è®¾è®¡é—®é¢˜ï¼Œå¹¶æå‡ºäº† 253 ç§å…³äºå¯¹åŸé•‡ã€é‚»é‡Œã€ä½å®…ã€èŠ±å›­å’Œæˆ¿é—´ç­‰è¿›è¡Œè®¾è®¡çš„åŸºæœ¬æ¨¡å¼ã€‚</p>
<p>1990å¹´è½¯ä»¶å·¥ç¨‹ç•Œå¼€å§‹ç ”è®¨è®¾è®¡æ¨¡å¼çš„è¯é¢˜ï¼Œåæ¥å¬å¼€äº†å¤šæ¬¡å…³äºè®¾è®¡æ¨¡å¼çš„ç ”è®¨ä¼šã€‚ç›´åˆ°1995 å¹´ï¼Œè‰¾ç‘å…‹Â·ä¼½é©¬ï¼ˆErichGammaï¼‰ã€ç†æŸ»å¾·Â·æµ·å°”å§†ï¼ˆRichard Helmï¼‰ã€æ‹‰å°”å¤«Â·çº¦ç¿°æ£®ï¼ˆRalph Johnsonï¼‰ã€çº¦ç¿°Â·å¨åˆ©æ–¯è¿ªæ–¯ï¼ˆJohn Vlissidesï¼‰ç­‰ 4 ä½ä½œè€…åˆä½œå‡ºç‰ˆäº†ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ä¸€ä¹¦ï¼Œåœ¨æ­¤ä¹¦ä¸­æ”¶å½•äº† 23 ä¸ªè®¾è®¡æ¨¡å¼ï¼Œè¿™æ˜¯è®¾è®¡æ¨¡å¼é¢†åŸŸé‡Œç¨‹ç¢‘çš„äº‹ä»¶ï¼Œå¯¼è‡´äº†è½¯ä»¶è®¾è®¡æ¨¡å¼çš„çªç ´ã€‚è¿™ 4 ä½ä½œè€…åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸé‡Œä¹Ÿä»¥ä»–ä»¬çš„â€œå››äººç»„â€ï¼ˆGang of Fourï¼ŒGoFï¼‰è‘—ç§°ã€‚  </p>
<h2 id="1-2-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ"><a href="#1-2-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ" class="headerlink" title="1.2 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ"></a>1.2 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ</h2><p>è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼ˆSoftware Design Patternï¼‰ï¼Œåˆç§°è®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚å®ƒæè¿°äº†åœ¨è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­çš„ä¸€äº›ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ï¼Œä»¥åŠè¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯è§£å†³ç‰¹å®šé—®é¢˜çš„ä¸€ç³»åˆ—å¥—è·¯ï¼Œæ˜¯å‰è¾ˆä»¬çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå…·æœ‰ä¸€å®šçš„æ™®éæ€§ï¼Œå¯ä»¥åå¤ä½¿ç”¨ã€‚</p>
<h2 id="1-3-å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§"><a href="#1-3-å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§" class="headerlink" title="1.3 å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§"></a>1.3 å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§</h2><p>è®¾è®¡æ¨¡å¼çš„æœ¬è´¨æ˜¯é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™çš„å®é™…è¿ç”¨ï¼Œæ˜¯å¯¹ç±»çš„å°è£…æ€§ã€ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ä»¥åŠç±»çš„å…³è”å…³ç³»å’Œç»„åˆå…³ç³»çš„å……åˆ†ç†è§£ã€‚</p>
<p>æ­£ç¡®ä½¿ç”¨è®¾è®¡æ¨¡å¼å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ã€‚</p>
<ul>
<li>å¯ä»¥æé«˜ç¨‹åºå‘˜çš„æ€ç»´èƒ½åŠ›ã€ç¼–ç¨‹èƒ½åŠ›å’Œè®¾è®¡èƒ½åŠ›ã€‚</li>
<li>ä½¿ç¨‹åºè®¾è®¡æ›´åŠ æ ‡å‡†åŒ–ã€ä»£ç ç¼–åˆ¶æ›´åŠ å·¥ç¨‹åŒ–ï¼Œä½¿è½¯ä»¶å¼€å‘æ•ˆç‡å¤§å¤§æé«˜ï¼Œä»è€Œç¼©çŸ­è½¯ä»¶çš„å¼€å‘å‘¨æœŸã€‚</li>
<li>ä½¿è®¾è®¡çš„ä»£ç å¯é‡ç”¨æ€§é«˜ã€å¯è¯»æ€§å¼ºã€å¯é æ€§é«˜ã€çµæ´»æ€§å¥½ã€å¯ç»´æŠ¤æ€§å¼ºã€‚</li>
</ul>
<h2 id="1-4-è®¾è®¡æ¨¡å¼åˆ†ç±»"><a href="#1-4-è®¾è®¡æ¨¡å¼åˆ†ç±»" class="headerlink" title="1.4 è®¾è®¡æ¨¡å¼åˆ†ç±»"></a>1.4 è®¾è®¡æ¨¡å¼åˆ†ç±»</h2><ul>
<li><p><strong>åˆ›å»ºå‹æ¨¡å¼</strong></p>
<p>ç”¨äºæè¿°â€œæ€æ ·åˆ›å»ºå¯¹è±¡â€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€ã€‚GoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†å•ä¾‹ã€åŸå‹ã€å·¥å‚æ–¹æ³•ã€æŠ½è±¡å·¥å‚ã€å»ºé€ è€…ç­‰ 5 ç§åˆ›å»ºå‹æ¨¡å¼ã€‚</p>
</li>
<li><p><strong>ç»“æ„å‹æ¨¡å¼</strong></p>
<p>ç”¨äºæè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ï¼ŒGoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†ä»£ç†ã€é€‚é…å™¨ã€æ¡¥æ¥ã€è£…é¥°ã€å¤–è§‚ã€äº«å…ƒã€ç»„åˆç­‰ 7 ç§ç»“æ„å‹æ¨¡å¼ã€‚</p>
</li>
<li><p><strong>è¡Œä¸ºå‹æ¨¡å¼</strong></p>
<p>ç”¨äºæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡ï¼Œä»¥åŠæ€æ ·åˆ†é…èŒè´£ã€‚GoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†æ¨¡æ¿æ–¹æ³•ã€ç­–ç•¥ã€å‘½ä»¤ã€èŒè´£é“¾ã€çŠ¶æ€ã€è§‚å¯Ÿè€…ã€ä¸­ä»‹è€…ã€è¿­ä»£å™¨ã€è®¿é—®è€…ã€å¤‡å¿˜å½•ã€è§£é‡Šå™¨ç­‰ 11 ç§è¡Œä¸ºå‹æ¨¡å¼ã€‚<br><img src="https://pic.imgdb.cn/item/60c8bb16844ef46bb2444684.jpg"></p>
</li>
</ul>
<h1 id="2ï¼ŒUMLå›¾"><a href="#2ï¼ŒUMLå›¾" class="headerlink" title="2ï¼ŒUMLå›¾"></a>2ï¼ŒUMLå›¾</h1><p>ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼ŒUMLï¼‰æ˜¯ç”¨æ¥è®¾è®¡è½¯ä»¶çš„å¯è§†åŒ–å»ºæ¨¡è¯­è¨€ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ç®€å•ã€ç»Ÿä¸€ã€å›¾å½¢åŒ–ã€èƒ½è¡¨è¾¾è½¯ä»¶è®¾è®¡ä¸­çš„åŠ¨æ€ä¸é™æ€ä¿¡æ¯ã€‚</p>
<p>UML ä»ç›®æ ‡ç³»ç»Ÿçš„ä¸åŒè§’åº¦å‡ºå‘ï¼Œå®šä¹‰äº†ç”¨ä¾‹å›¾ã€ç±»å›¾ã€å¯¹è±¡å›¾ã€çŠ¶æ€å›¾ã€æ´»åŠ¨å›¾ã€æ—¶åºå›¾ã€åä½œå›¾ã€æ„ä»¶å›¾ã€éƒ¨ç½²å›¾ç­‰ 9 ç§å›¾ã€‚</p>
<h2 id="2-1-ç±»å›¾æ¦‚è¿°"><a href="#2-1-ç±»å›¾æ¦‚è¿°" class="headerlink" title="2.1 ç±»å›¾æ¦‚è¿°"></a>2.1 ç±»å›¾æ¦‚è¿°</h2><p>ç±»å›¾(Class diagram)æ˜¯æ˜¾ç¤ºäº†æ¨¡å‹çš„é™æ€ç»“æ„ï¼Œç‰¹åˆ«æ˜¯æ¨¡å‹ä¸­å­˜åœ¨çš„ç±»ã€ç±»çš„å†…éƒ¨ç»“æ„ä»¥åŠå®ƒä»¬ä¸å…¶ä»–ç±»çš„å…³ç³»ç­‰ã€‚ç±»å›¾ä¸æ˜¾ç¤ºæš‚æ—¶æ€§çš„ä¿¡æ¯ã€‚ç±»å›¾æ˜¯é¢å‘å¯¹è±¡å»ºæ¨¡çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
<h2 id="2-2-ç±»å›¾çš„ä½œç”¨"><a href="#2-2-ç±»å›¾çš„ä½œç”¨" class="headerlink" title="2.2 ç±»å›¾çš„ä½œç”¨"></a>2.2 ç±»å›¾çš„ä½œç”¨</h2><ul>
<li>åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œç±»å›¾æ˜¯ä¸€ç§é™æ€çš„ç»“æ„å›¾ï¼Œæè¿°äº†ç³»ç»Ÿçš„ç±»çš„é›†åˆï¼Œç±»çš„å±æ€§å’Œç±»ä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥ç®€åŒ–äº†äººä»¬å¯¹ç³»ç»Ÿçš„ç†è§£ï¼›</li>
<li>ç±»å›¾æ˜¯ç³»ç»Ÿåˆ†æå’Œè®¾è®¡é˜¶æ®µçš„é‡è¦äº§ç‰©ï¼Œæ˜¯ç³»ç»Ÿç¼–ç å’Œæµ‹è¯•çš„é‡è¦æ¨¡å‹ã€‚</li>
</ul>
<h2 id="2-3-ç±»å›¾è¡¨ç¤ºæ³•"><a href="#2-3-ç±»å›¾è¡¨ç¤ºæ³•" class="headerlink" title="2.3 ç±»å›¾è¡¨ç¤ºæ³•"></a>2.3 ç±»å›¾è¡¨ç¤ºæ³•</h2><h3 id="2-3-1-ç±»çš„è¡¨ç¤ºæ–¹å¼"><a href="#2-3-1-ç±»çš„è¡¨ç¤ºæ–¹å¼" class="headerlink" title="2.3.1 ç±»çš„è¡¨ç¤ºæ–¹å¼"></a>2.3.1 ç±»çš„è¡¨ç¤ºæ–¹å¼</h3><p>åœ¨UMLç±»å›¾ä¸­ï¼Œç±»ä½¿ç”¨åŒ…å«ç±»åã€å±æ€§(field) å’Œæ–¹æ³•(method) ä¸”å¸¦æœ‰åˆ†å‰²çº¿çš„çŸ©å½¢æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ä¸‹å›¾è¡¨ç¤ºä¸€ä¸ªEmployeeç±»ï¼Œå®ƒåŒ…å«name,ageå’Œaddressè¿™3ä¸ªå±æ€§ï¼Œä»¥åŠwork()æ–¹æ³•ã€‚ </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/Employee.jpg"></p>
<p>å±æ€§/æ–¹æ³•åç§°å‰åŠ çš„åŠ å·å’Œå‡å·è¡¨ç¤ºäº†è¿™ä¸ªå±æ€§/æ–¹æ³•çš„å¯è§æ€§ï¼ŒUMLç±»å›¾ä¸­è¡¨ç¤ºå¯è§æ€§çš„ç¬¦å·æœ‰ä¸‰ç§ï¼š</p>
<ul>
<li><p>+ï¼šè¡¨ç¤ºpublic</p>
</li>
<li><p>-ï¼šè¡¨ç¤ºprivate</p>
</li>
<li><p>#ï¼šè¡¨ç¤ºprotected</p>
</li>
</ul>
<p>å±æ€§çš„å®Œæ•´è¡¨ç¤ºæ–¹å¼æ˜¯ï¼š <strong>å¯è§æ€§  åç§° ï¼šç±»å‹ [ = ç¼ºçœå€¼]</strong>  </p>
<p>æ–¹æ³•çš„å®Œæ•´è¡¨ç¤ºæ–¹å¼æ˜¯ï¼š <strong>å¯è§æ€§  åç§°(å‚æ•°åˆ—è¡¨) [ ï¼š è¿”å›ç±»å‹]</strong></p>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<pre><code>1ï¼Œä¸­æ‹¬å·ä¸­çš„å†…å®¹è¡¨ç¤ºæ˜¯å¯é€‰çš„
                                                
2ï¼Œä¹Ÿæœ‰å°†ç±»å‹æ”¾åœ¨å˜é‡åå‰é¢ï¼Œè¿”å›å€¼ç±»å‹æ”¾åœ¨æ–¹æ³•åå‰é¢
</code></pre>
</blockquote>
<p><strong>ä¸¾ä¸ªæ —å­ï¼š</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/demo.png"></p>
<p>ä¸Šå›¾Demoç±»å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li>method()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºpublicï¼Œæ²¡æœ‰å‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</li>
<li>method1()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºprivateï¼Œæ²¡æœ‰å‚æ•°ï¼Œè¿”å›å€¼ç±»å‹ä¸ºStringã€‚</li>
<li>method2()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºprotectedï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ºintï¼Œç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸ºStringï¼Œè¿”å›å€¼ç±»å‹æ˜¯intã€‚</li>
</ul>
<h3 id="2-3-2-ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼"><a href="#2-3-2-ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼" class="headerlink" title="2.3.2 ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼"></a>2.3.2 ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼</h3><h4 id="2-3-2-1-å…³è”å…³ç³»"><a href="#2-3-2-1-å…³è”å…³ç³»" class="headerlink" title="2.3.2.1 å…³è”å…³ç³»"></a>2.3.2.1 å…³è”å…³ç³»</h4><p>å…³è”å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œç”¨äºè¡¨ç¤ºä¸€ç±»å¯¹è±¡ä¸å¦ä¸€ç±»å¯¹è±¡ä¹‹é—´çš„è”ç³»ï¼Œå¦‚è€å¸ˆå’Œå­¦ç”Ÿã€å¸ˆå‚…å’Œå¾’å¼Ÿã€ä¸ˆå¤«å’Œå¦»å­ç­‰ã€‚å…³è”å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´æœ€å¸¸ç”¨çš„ä¸€ç§å…³ç³»ï¼Œåˆ†ä¸ºä¸€èˆ¬å…³è”å…³ç³»ã€èšåˆå…³ç³»å’Œç»„åˆå…³ç³»ã€‚æˆ‘ä»¬å…ˆä»‹ç»ä¸€èˆ¬å…³è”ã€‚</p>
<p>å…³è”åˆå¯ä»¥åˆ†ä¸ºå•å‘å…³è”ï¼ŒåŒå‘å…³è”ï¼Œè‡ªå…³è”ã€‚</p>
<p><strong>1ï¼Œå•å‘å…³è”</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/customer_address.png"></p>
<p>åœ¨UMLç±»å›¾ä¸­å•å‘å…³è”ç”¨ä¸€ä¸ªå¸¦ç®­å¤´çš„å®çº¿è¡¨ç¤ºã€‚ä¸Šå›¾è¡¨ç¤ºæ¯ä¸ªé¡¾å®¢éƒ½æœ‰ä¸€ä¸ªåœ°å€ï¼Œè¿™é€šè¿‡è®©Customerç±»æŒæœ‰ä¸€ä¸ªç±»å‹ä¸ºAddressçš„æˆå‘˜å˜é‡ç±»å®ç°ã€‚</p>
<p><strong>2ï¼ŒåŒå‘å…³è”</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/customer_product.png"></p>
<p>ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œæ‰€è°“çš„åŒå‘å…³è”å°±æ˜¯åŒæ–¹å„è‡ªæŒæœ‰å¯¹æ–¹ç±»å‹çš„æˆå‘˜å˜é‡ã€‚</p>
<p>åœ¨UMLç±»å›¾ä¸­ï¼ŒåŒå‘å…³è”ç”¨ä¸€ä¸ªä¸å¸¦ç®­å¤´çš„ç›´çº¿è¡¨ç¤ºã€‚ä¸Šå›¾ä¸­åœ¨Customerç±»ä¸­ç»´æŠ¤ä¸€ä¸ªList&lt;Product&gt;ï¼Œè¡¨ç¤ºä¸€ä¸ªé¡¾å®¢å¯ä»¥è´­ä¹°å¤šä¸ªå•†å“ï¼›åœ¨Productç±»ä¸­ç»´æŠ¤ä¸€ä¸ªCustomerç±»å‹çš„æˆå‘˜å˜é‡è¡¨ç¤ºè¿™ä¸ªäº§å“è¢«å“ªä¸ªé¡¾å®¢æ‰€è´­ä¹°ã€‚</p>
<p><strong>3ï¼Œè‡ªå…³è”</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/node.png"></p>
<p>è‡ªå…³è”åœ¨UMLç±»å›¾ä¸­ç”¨ä¸€ä¸ªå¸¦æœ‰ç®­å¤´ä¸”æŒ‡å‘è‡ªèº«çš„çº¿è¡¨ç¤ºã€‚ä¸Šå›¾çš„æ„æ€å°±æ˜¯Nodeç±»åŒ…å«ç±»å‹ä¸ºNodeçš„æˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯â€œè‡ªå·±åŒ…å«è‡ªå·±â€ã€‚</p>
<h4 id="2-3-2-2-èšåˆå…³ç³»"><a href="#2-3-2-2-èšåˆå…³ç³»" class="headerlink" title="2.3.2.2 èšåˆå…³ç³»"></a>2.3.2.2 èšåˆå…³ç³»</h4><p>èšåˆå…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯å¼ºå…³è”å…³ç³»ï¼Œæ˜¯æ•´ä½“å’Œéƒ¨åˆ†ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>èšåˆå…³ç³»ä¹Ÿæ˜¯é€šè¿‡æˆå‘˜å¯¹è±¡æ¥å®ç°çš„ï¼Œå…¶ä¸­æˆå‘˜å¯¹è±¡æ˜¯æ•´ä½“å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æˆå‘˜å¯¹è±¡å¯ä»¥è„±ç¦»æ•´ä½“å¯¹è±¡è€Œç‹¬ç«‹å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå­¦æ ¡ä¸è€å¸ˆçš„å…³ç³»ï¼Œå­¦æ ¡åŒ…å«è€å¸ˆï¼Œä½†å¦‚æœå­¦æ ¡åœåŠäº†ï¼Œè€å¸ˆä¾ç„¶å­˜åœ¨ã€‚</p>
<p>åœ¨ UML ç±»å›¾ä¸­ï¼Œèšåˆå…³ç³»å¯ä»¥ç”¨å¸¦ç©ºå¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œè±å½¢æŒ‡å‘æ•´ä½“ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¤§å­¦å’Œæ•™å¸ˆçš„å…³ç³»å›¾ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20191229173422328.png"></p>
<h4 id="2-3-2-3-ç»„åˆå…³ç³»"><a href="#2-3-2-3-ç»„åˆå…³ç³»" class="headerlink" title="2.3.2.3 ç»„åˆå…³ç³»"></a>2.3.2.3 ç»„åˆå…³ç³»</h4><p>ç»„åˆè¡¨ç¤ºç±»ä¹‹é—´çš„æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ï¼Œä½†å®ƒæ˜¯ä¸€ç§æ›´å¼ºçƒˆçš„èšåˆå…³ç³»ã€‚</p>
<p>åœ¨ç»„åˆå…³ç³»ä¸­ï¼Œæ•´ä½“å¯¹è±¡å¯ä»¥æ§åˆ¶éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦æ•´ä½“å¯¹è±¡ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¹Ÿå°†ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¸èƒ½è„±ç¦»æ•´ä½“å¯¹è±¡è€Œå­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå¤´å’Œå˜´çš„å…³ç³»ï¼Œæ²¡æœ‰äº†å¤´ï¼Œå˜´ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚</p>
<p>åœ¨ UML ç±»å›¾ä¸­ï¼Œç»„åˆå…³ç³»ç”¨å¸¦å®å¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œè±å½¢æŒ‡å‘æ•´ä½“ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¤´å’Œå˜´çš„å…³ç³»å›¾ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20191229173455149.png"></p>
<h4 id="2-3-2-4-ä¾èµ–å…³ç³»"><a href="#2-3-2-4-ä¾èµ–å…³ç³»" class="headerlink" title="2.3.2.4 ä¾èµ–å…³ç³»"></a>2.3.2.4 ä¾èµ–å…³ç³»</h4><p>ä¾èµ–å…³ç³»æ˜¯ä¸€ç§ä½¿ç”¨å…³ç³»ï¼Œå®ƒæ˜¯å¯¹è±¡ä¹‹é—´è€¦åˆåº¦æœ€å¼±çš„ä¸€ç§å…³è”æ–¹å¼ï¼Œæ˜¯ä¸´æ—¶æ€§çš„å…³è”ã€‚åœ¨ä»£ç ä¸­ï¼ŒæŸä¸ªç±»çš„æ–¹æ³•é€šè¿‡å±€éƒ¨å˜é‡ã€æ–¹æ³•çš„å‚æ•°æˆ–è€…å¯¹é™æ€æ–¹æ³•çš„è°ƒç”¨æ¥è®¿é—®å¦ä¸€ä¸ªç±»ï¼ˆè¢«ä¾èµ–ç±»ï¼‰ä¸­çš„æŸäº›æ–¹æ³•æ¥å®Œæˆä¸€äº›èŒè´£ã€‚</p>
<p>åœ¨ UML ç±»å›¾ä¸­ï¼Œä¾èµ–å…³ç³»ä½¿ç”¨å¸¦ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»ä½¿ç”¨ç±»æŒ‡å‘è¢«ä¾èµ–çš„ç±»ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¸æœºå’Œæ±½è½¦çš„å…³ç³»å›¾ï¼Œå¸æœºé©¾é©¶æ±½è½¦ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20191229173518926.png"></p>
<h4 id="2-3-2-5-ç»§æ‰¿å…³ç³»"><a href="#2-3-2-5-ç»§æ‰¿å…³ç³»" class="headerlink" title="2.3.2.5 ç»§æ‰¿å…³ç³»"></a>2.3.2.5 ç»§æ‰¿å…³ç³»</h4><p>ç»§æ‰¿å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´è€¦åˆåº¦æœ€å¤§çš„ä¸€ç§å…³ç³»ï¼Œè¡¨ç¤ºä¸€èˆ¬ä¸ç‰¹æ®Šçš„å…³ç³»ï¼Œæ˜¯çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ä¸€ç§ç»§æ‰¿å…³ç³»ã€‚</p>
<p>åœ¨ UML ç±»å›¾ä¸­ï¼Œæ³›åŒ–å…³ç³»ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„å®çº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å­ç±»æŒ‡å‘çˆ¶ç±»ã€‚åœ¨ä»£ç å®ç°æ—¶ï¼Œä½¿ç”¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿æœºåˆ¶æ¥å®ç°æ³›åŒ–å…³ç³»ã€‚ä¾‹å¦‚ï¼ŒStudent ç±»å’Œ Teacher ç±»éƒ½æ˜¯ Person ç±»çš„å­ç±»ï¼Œå…¶ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20191229173539838.png"></p>
<h4 id="2-3-2-6-å®ç°å…³ç³»"><a href="#2-3-2-6-å®ç°å…³ç³»" class="headerlink" title="2.3.2.6 å®ç°å…³ç³»"></a>2.3.2.6 å®ç°å…³ç³»</h4><p>å®ç°å…³ç³»æ˜¯æ¥å£ä¸å®ç°ç±»ä¹‹é—´çš„å…³ç³»ã€‚åœ¨è¿™ç§å…³ç³»ä¸­ï¼Œç±»å®ç°äº†æ¥å£ï¼Œç±»ä¸­çš„æ“ä½œå®ç°äº†æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰çš„æŠ½è±¡æ“ä½œã€‚</p>
<p>åœ¨ UML ç±»å›¾ä¸­ï¼Œå®ç°å…³ç³»ä½¿ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å®ç°ç±»æŒ‡å‘æ¥å£ã€‚ä¾‹å¦‚ï¼Œæ±½è½¦å’Œèˆ¹å®ç°äº†äº¤é€šå·¥å…·ï¼Œå…¶ç±»å›¾å¦‚å›¾ 9 æ‰€ç¤ºã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20191229173554296.png"></p>
<h1 id="3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™"><a href="#3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™" class="headerlink" title="3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™"></a>3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™</h1><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œä¸ºäº†æé«˜è½¯ä»¶ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ï¼Œå¢åŠ è½¯ä»¶çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼Œç¨‹åºå‘˜è¦å°½é‡æ ¹æ®6æ¡åŸåˆ™æ¥å¼€å‘ç¨‹åºï¼Œä»è€Œæé«˜è½¯ä»¶å¼€å‘æ•ˆç‡ã€èŠ‚çº¦è½¯ä»¶å¼€å‘æˆæœ¬å’Œç»´æŠ¤æˆæœ¬ã€‚</p>
<h2 id="3-1-å¼€é—­åŸåˆ™"><a href="#3-1-å¼€é—­åŸåˆ™" class="headerlink" title="3.1 å¼€é—­åŸåˆ™"></a>3.1 å¼€é—­åŸåˆ™</h2><p><strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</strong>ã€‚åœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‹“å±•çš„æ—¶å€™ï¼Œä¸èƒ½å»ä¿®æ”¹åŸæœ‰çš„ä»£ç ï¼Œå®ç°ä¸€ä¸ªçƒ­æ’æ‹”çš„æ•ˆæœã€‚ç®€è¨€ä¹‹ï¼Œæ˜¯ä¸ºäº†ä½¿ç¨‹åºçš„æ‰©å±•æ€§å¥½ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ã€‚</p>
<p>æƒ³è¦è¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»ã€‚</p>
<p>å› ä¸ºæŠ½è±¡çµæ´»æ€§å¥½ï¼Œé€‚åº”æ€§å¹¿ï¼Œåªè¦æŠ½è±¡çš„åˆç†ï¼Œå¯ä»¥åŸºæœ¬ä¿æŒè½¯ä»¶æ¶æ„çš„ç¨³å®šã€‚è€Œè½¯ä»¶ä¸­æ˜“å˜çš„ç»†èŠ‚å¯ä»¥ä»æŠ½è±¡æ´¾ç”Ÿæ¥çš„å®ç°ç±»æ¥è¿›è¡Œæ‰©å±•ï¼Œå½“è½¯ä»¶éœ€è¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªéœ€è¦æ ¹æ®éœ€æ±‚é‡æ–°æ´¾ç”Ÿä¸€ä¸ªå®ç°ç±»æ¥æ‰©å±•å°±å¯ä»¥äº†ã€‚</p>
<h2 id="3-2-é‡Œæ°ä»£æ¢åŸåˆ™"><a href="#3-2-é‡Œæ°ä»£æ¢åŸåˆ™" class="headerlink" title="3.2 é‡Œæ°ä»£æ¢åŸåˆ™"></a>3.2 é‡Œæ°ä»£æ¢åŸåˆ™</h2><p>é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€ã€‚</p>
<p>é‡Œæ°ä»£æ¢åŸåˆ™ï¼šä»»ä½•åŸºç±»å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ã€‚é€šä¿—ç†è§£ï¼šå­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ã€‚æ¢å¥è¯è¯´ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œé™¤æ·»åŠ æ–°çš„æ–¹æ³•å®Œæˆæ–°å¢åŠŸèƒ½å¤–ï¼Œå°½é‡ä¸è¦é‡å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚</p>
<p>å¦‚æœé€šè¿‡é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ¥å®Œæˆæ–°çš„åŠŸèƒ½ï¼Œè¿™æ ·å†™èµ·æ¥è™½ç„¶ç®€å•ï¼Œä½†æ˜¯æ•´ä¸ªç»§æ‰¿ä½“ç³»çš„å¯å¤ç”¨æ€§ä¼šæ¯”è¾ƒå·®ï¼Œç‰¹åˆ«æ˜¯è¿ç”¨å¤šæ€æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œç¨‹åºè¿è¡Œå‡ºé”™çš„æ¦‚ç‡ä¼šéå¸¸å¤§ã€‚</p>
<p><strong>é‡Œæ°ä»£æ¢åŸåˆ™é”™è¯¯ç¤ºèŒƒ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.principle.liskov;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Liskov</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é‡Œæ°ä»£æ¢åŸåˆ™é”™è¯¯ç¤ºèŒƒ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/15 13:58</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Liskov</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        System.out.println(<span class="string">&quot;11-3=&quot;</span> +a.fun1(<span class="number">11</span>,<span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;11-8=&quot;</span> +a.fun1(<span class="number">11</span>,<span class="number">8</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        B b = <span class="keyword">new</span> B();</span><br><span class="line">        System.out.println(<span class="string">&quot;11-3=&quot;</span>+b.fun1(<span class="number">11</span>,<span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;1-8=&quot;</span>+b.fun1(<span class="number">1</span>,<span class="number">8</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;11+3+9=&quot;</span>+b.fun2(<span class="number">11</span>,<span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="comment">//è¿”å›ä¸¤ä¸ªæ•°çš„å·®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">fun1</span><span class="params">(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num1-num2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Bç±»ç»§æ‰¿A å¢åŠ æ–°åŠŸèƒ½ï¼Œå®Œæˆä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œç„¶åå’Œ9æ±‚å’Œ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">fun1</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">fun2</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fun1(a,b)+<span class="number">9</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é‡Œæ°ä»£æ¢åŸåˆ™æ­£ç¡®ç¤ºèŒƒ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.principle.liskov;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Liskov2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é‡Œæ°ä»£æ¢åŸåˆ™</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/15 14:13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Liskov2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Base base = <span class="keyword">new</span> Base();</span><br><span class="line">        base.add(<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line">        base.sub(<span class="number">6</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        Sub sub = <span class="keyword">new</span> Sub();</span><br><span class="line">        sub.mul(<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line">        sub.div(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é€šç”¨åŠ æ³•è¿ç®—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        System.out.println(a + <span class="string">&quot;+&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a + b));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šç”¨å‡æ³•è¿ç®—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        System.out.println(a + <span class="string">&quot;-&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a - b));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span> <span class="keyword">extends</span> <span class="title">Base</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å­ç±»ç‰¹æœ‰ä¹˜æ³•è¿ç®—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        System.out.println(a + <span class="string">&quot;*&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a * b));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å­ç±»ç‰¹æœ‰é™¤æ³•è¿ç®—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">div</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        System.out.println(a + <span class="string">&quot;/&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a / b));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-ä¾èµ–å€’è½¬åŸåˆ™"><a href="#3-3-ä¾èµ–å€’è½¬åŸåˆ™" class="headerlink" title="3.3 ä¾èµ–å€’è½¬åŸåˆ™"></a>3.3 ä¾èµ–å€’è½¬åŸåˆ™</h2><p>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚ç®€å•çš„è¯´å°±æ˜¯è¦æ±‚å¯¹æŠ½è±¡è¿›è¡Œç¼–ç¨‹ï¼Œä¸è¦å¯¹å®ç°è¿›è¡Œç¼–ç¨‹ï¼Œè¿™æ ·å°±é™ä½äº†å®¢æˆ·ä¸å®ç°æ¨¡å—é—´çš„è€¦åˆã€‚</p>
<p><strong>ä¾èµ–å€’è½¬åŸåˆ™é”™è¯¯ç¤ºèŒƒ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.principle.inversion;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> DependenceInversion1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä¾èµ–å€’è½¬åŸåˆ™é”™è¯¯ç¤ºèŒƒ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/15 13:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DependenceInversion1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person();</span><br><span class="line">        person.receive(<span class="keyword">new</span> Email());</span><br><span class="line">        person.receive(<span class="keyword">new</span> WeiXin());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰æ¥å£</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IReceiver</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeiXin</span> <span class="keyword">implements</span> <span class="title">IReceiver</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å‘é€å¾®ä¿¡æ¶ˆæ¯...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span> <span class="keyword">implements</span> <span class="title">IReceiver</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å‘é€é‚®ä»¶æ¶ˆæ¯...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¯¹æ¥å£çš„ä¾èµ–</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(IReceiver receiver)</span></span>&#123;</span><br><span class="line">        System.out.println(receiver.getInfo());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¾èµ–å€’è½¬åŸåˆ™æ­£ç¡®ç¤ºèŒƒ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.principle.inversion;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> DependenceInversion2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä¾èµ–å€’è½¬åŸåˆ™æ­£ç¡®ç¤ºèŒƒ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/15 13:27</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DependenceInversion2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Client client = <span class="keyword">new</span> Client();</span><br><span class="line">        client.receive(<span class="keyword">new</span> Emailiml());</span><br><span class="line">        client.receive(<span class="keyword">new</span> WXimpl());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IReceive</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printInfo</span><span class="params">(Integer uid)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WXimpl</span> <span class="keyword">implements</span> <span class="title">IReceive</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printInfo</span><span class="params">(Integer uid)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘é€å¾®ä¿¡æ¶ˆæ¯&quot;</span>+uid);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Emailiml</span> <span class="keyword">implements</span> <span class="title">IReceive</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printInfo</span><span class="params">(Integer uid)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘é€é‚®ä»¶ä¿¡æ¯&quot;</span>+uid);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Client</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(IReceive receive)</span></span>&#123;</span><br><span class="line">        receive.printInfo(<span class="number">12345</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<p>é¢å‘å¯¹è±¡çš„å¼€å‘å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æŠ½è±¡çš„å˜åŒ–æ¦‚ç‡å¾ˆå°ï¼Œè®©ç”¨æˆ·ç¨‹åºä¾èµ–äºæŠ½è±¡ï¼Œå®ç°çš„ç»†èŠ‚ä¹Ÿä¾èµ–äºæŠ½è±¡ã€‚å³ä½¿å®ç°ç»†èŠ‚ä¸æ–­å˜åŠ¨ï¼Œåªè¦æŠ½è±¡ä¸å˜ï¼Œå®¢æˆ·ç¨‹åºå°±ä¸éœ€è¦å˜åŒ–ã€‚è¿™å¤§å¤§é™ä½äº†å®¢æˆ·ç¨‹åºä¸å®ç°ç»†èŠ‚çš„è€¦åˆåº¦ã€‚</p>
<h2 id="3-4-æ¥å£éš”ç¦»åŸåˆ™"><a href="#3-4-æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="3.4 æ¥å£éš”ç¦»åŸåˆ™"></a>3.4 æ¥å£éš”ç¦»åŸåˆ™</h2><p>å®¢æˆ·ç«¯ä¸åº”è¯¥è¢«è¿«ä¾èµ–äºå®ƒä¸ä½¿ç”¨çš„æ–¹æ³•ï¼›ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚</p>
<p><strong>æ¥å£éš”ç¦»åŸåˆ™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.principle.segregation;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Sergregation</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¥å£éš”ç¦»åŸåˆ™</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/15 13:02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sergregation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        C c = <span class="keyword">new</span> C();</span><br><span class="line">        c.depend1(<span class="keyword">new</span> A());</span><br><span class="line">        c.depend2(<span class="keyword">new</span> A());<span class="comment">//Cç±»é€šè¿‡æ¥å£å»ä¾èµ–Aç±»</span></span><br><span class="line">        c.depend3(<span class="keyword">new</span> A());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=======================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        D d = <span class="keyword">new</span> D();</span><br><span class="line">        d.depend1(<span class="keyword">new</span> B());</span><br><span class="line">        d.depend4(<span class="keyword">new</span> B());<span class="comment">//Dç±»é€šè¿‡æ¥å£å»ä¾èµ–Bç±»</span></span><br><span class="line">        d.depend5(<span class="keyword">new</span> B());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">interface1</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">interface2</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operation2</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operation3</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">interface3</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operation4</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operation5</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">interface1</span>,<span class="title">interface2</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A å®ç°äº†operation1.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A å®ç°äº†operation2......&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A å®ç°äº†operation3......&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">implements</span> <span class="title">interface1</span>,<span class="title">interface3</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;B å®ç°äº†operation1.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;B å®ç°äº†operation4.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;B å®ç°äº†operation5.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Cç±»é€šè¿‡æ¥å£interface1ï¼Œinterface2ä¾èµ–ä½¿ç”¨Aç±» åªä¼šä½¿ç”¨åˆ°1,2,3æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend1</span><span class="params">(interface1 i)</span></span>&#123;</span><br><span class="line">        i.operation1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend2</span><span class="params">(interface2 i)</span></span>&#123;</span><br><span class="line">        i.operation2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend3</span><span class="params">(interface2 i)</span></span>&#123;</span><br><span class="line">        i.operation3();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Dç±»é€šè¿‡æ¥å£interface1ï¼Œinterface3 ä¾èµ–ä½¿ç”¨Bç±»ï¼Œç”¨åˆ°1,4,5æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend1</span><span class="params">(interface1 i)</span></span>&#123;</span><br><span class="line">        i.operation1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend4</span><span class="params">(interface3 i)</span></span>&#123;</span><br><span class="line">        i.operation4();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend5</span><span class="params">(interface3 i)</span></span>&#123;</span><br><span class="line">        i.operation5();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="3-5-è¿ªç±³ç‰¹æ³•åˆ™"><a href="#3-5-è¿ªç±³ç‰¹æ³•åˆ™" class="headerlink" title="3.5 è¿ªç±³ç‰¹æ³•åˆ™"></a>3.5 è¿ªç±³ç‰¹æ³•åˆ™</h2><p>è¿ªç±³ç‰¹æ³•åˆ™åˆå«æœ€å°‘çŸ¥è¯†åŸåˆ™ã€‚</p>
<p>åªå’Œä½ çš„ç›´æ¥æœ‹å‹äº¤è°ˆï¼Œä¸è·Ÿâ€œé™Œç”Ÿäººâ€è¯´è¯ï¼ˆTalk only to your immediate friends and not to strangersï¼‰ã€‚</p>
<p>å…¶å«ä¹‰æ˜¯ï¼šå¦‚æœä¸¤ä¸ªè½¯ä»¶å®ä½“æ— é¡»ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆå°±ä¸åº”å½“å‘ç”Ÿç›´æ¥çš„ç›¸äº’è°ƒç”¨ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹è½¬å‘è¯¥è°ƒç”¨ã€‚å…¶ç›®çš„æ˜¯é™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ï¼Œæé«˜æ¨¡å—çš„ç›¸å¯¹ç‹¬ç«‹æ€§ã€‚</p>
<p>è¿ªç±³ç‰¹æ³•åˆ™ä¸­çš„â€œæœ‹å‹â€æ˜¯æŒ‡ï¼šå½“å‰å¯¹è±¡æœ¬èº«ã€å½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡ã€å½“å‰å¯¹è±¡æ‰€åˆ›å»ºçš„å¯¹è±¡ã€å½“å‰å¯¹è±¡çš„æ–¹æ³•å‚æ•°ç­‰ï¼Œè¿™äº›å¯¹è±¡åŒå½“å‰å¯¹è±¡å­˜åœ¨å…³è”ã€èšåˆæˆ–ç»„åˆå…³ç³»ï¼Œå¯ä»¥ç›´æ¥è®¿é—®è¿™äº›å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿ªç±³ç‰¹æ³•åˆ™</p>
<p>ã€ä¾‹ã€‘æ˜æ˜Ÿä¸ç»çºªäººçš„å…³ç³»å®ä¾‹</p>
<p>æ˜æ˜Ÿç”±äºå…¨èº«å¿ƒæŠ•å…¥è‰ºæœ¯ï¼Œæ‰€ä»¥è®¸å¤šæ—¥å¸¸äº‹åŠ¡ç”±ç»çºªäººè´Ÿè´£å¤„ç†ï¼Œå¦‚å’Œç²‰ä¸çš„è§é¢ä¼šï¼Œå’Œåª’ä½“å…¬å¸çš„ä¸šåŠ¡æ´½æ·¡ç­‰ã€‚è¿™é‡Œçš„ç»çºªäººæ˜¯æ˜æ˜Ÿçš„æœ‹å‹ï¼Œè€Œç²‰ä¸å’Œåª’ä½“å…¬å¸æ˜¯é™Œç”Ÿäººï¼Œæ‰€ä»¥é€‚åˆä½¿ç”¨è¿ªç±³ç‰¹æ³•åˆ™ã€‚</p>
<p>ç±»å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99.png"></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<p><strong>æ˜æ˜Ÿç±»ï¼ˆStarï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Star</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Star</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç²‰ä¸ç±»ï¼ˆFansï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fans</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Fans</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åª’ä½“å…¬å¸ç±»ï¼ˆCompanyï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Company</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Company</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç»çºªäººç±»ï¼ˆAgentï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Agent</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Star star;</span><br><span class="line">    <span class="keyword">private</span> Fans fans;</span><br><span class="line">    <span class="keyword">private</span> Company company;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStar</span><span class="params">(Star star)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.star = star;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFans</span><span class="params">(Fans fans)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fans = fans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompany</span><span class="params">(Company company)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.company = company;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">meeting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(fans.getName() + <span class="string">&quot;ä¸æ˜æ˜Ÿ&quot;</span> + star.getName() + <span class="string">&quot;è§é¢äº†ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">business</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(company.getName() + <span class="string">&quot;ä¸æ˜æ˜Ÿ&quot;</span> + star.getName() + <span class="string">&quot;æ´½æ·¡ä¸šåŠ¡ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="3-6-åˆæˆå¤ç”¨åŸåˆ™"><a href="#3-6-åˆæˆå¤ç”¨åŸåˆ™" class="headerlink" title="3.6 åˆæˆå¤ç”¨åŸåˆ™"></a>3.6 åˆæˆå¤ç”¨åŸåˆ™</h2><p>åˆæˆå¤ç”¨åŸåˆ™æ˜¯æŒ‡ï¼šå°½é‡å…ˆä½¿ç”¨ç»„åˆæˆ–è€…èšåˆç­‰å…³è”å…³ç³»æ¥å®ç°ï¼Œå…¶æ¬¡æ‰è€ƒè™‘ä½¿ç”¨ç»§æ‰¿å…³ç³»æ¥å®ç°ã€‚</p>
<p>é€šå¸¸ç±»çš„å¤ç”¨åˆ†ä¸ºç»§æ‰¿å¤ç”¨å’Œåˆæˆå¤ç”¨ä¸¤ç§ã€‚</p>
<p>ç»§æ‰¿å¤ç”¨è™½ç„¶æœ‰ç®€å•å’Œæ˜“å®ç°çš„ä¼˜ç‚¹ï¼Œä½†å®ƒä¹Ÿå­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>
<ol>
<li>ç»§æ‰¿å¤ç”¨ç ´åäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºç»§æ‰¿ä¼šå°†çˆ¶ç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å­ç±»ï¼Œçˆ¶ç±»å¯¹å­ç±»æ˜¯é€æ˜çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œç™½ç®±â€å¤ç”¨ã€‚</li>
<li>å­ç±»ä¸çˆ¶ç±»çš„è€¦åˆåº¦é«˜ã€‚çˆ¶ç±»çš„å®ç°çš„ä»»ä½•æ”¹å˜éƒ½ä¼šå¯¼è‡´å­ç±»çš„å®ç°å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸åˆ©äºç±»çš„æ‰©å±•ä¸ç»´æŠ¤ã€‚</li>
<li>å®ƒé™åˆ¶äº†å¤ç”¨çš„çµæ´»æ€§ã€‚ä»çˆ¶ç±»ç»§æ‰¿è€Œæ¥çš„å®ç°æ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶å·²ç»å®šä¹‰ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶ä¸å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚</li>
</ol>
<p>é‡‡ç”¨ç»„åˆæˆ–èšåˆå¤ç”¨æ—¶ï¼Œå¯ä»¥å°†å·²æœ‰å¯¹è±¡çº³å…¥æ–°å¯¹è±¡ä¸­ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œæ–°å¯¹è±¡å¯ä»¥è°ƒç”¨å·²æœ‰å¯¹è±¡çš„åŠŸèƒ½ï¼Œå®ƒæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p>
<ol>
<li>å®ƒç»´æŒäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºæˆåˆ†å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚æ˜¯æ–°å¯¹è±¡çœ‹ä¸è§çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œé»‘ç®±â€å¤ç”¨ã€‚</li>
<li>å¯¹è±¡é—´çš„è€¦åˆåº¦ä½ã€‚å¯ä»¥åœ¨ç±»çš„æˆå‘˜ä½ç½®å£°æ˜æŠ½è±¡ã€‚</li>
<li>å¤ç”¨çš„çµæ´»æ€§é«˜ã€‚è¿™ç§å¤ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€è¿›è¡Œï¼Œæ–°å¯¹è±¡å¯ä»¥åŠ¨æ€åœ°å¼•ç”¨ä¸æˆåˆ†å¯¹è±¡ç±»å‹ç›¸åŒçš„å¯¹è±¡ã€‚</li>
</ol>
<p>ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£åˆæˆå¤ç”¨åŸåˆ™</p>
<p>ã€ä¾‹ã€‘æ±½è½¦åˆ†ç±»ç®¡ç†ç¨‹åº</p>
<p>æ±½è½¦æŒ‰â€œåŠ¨åŠ›æºâ€åˆ’åˆ†å¯åˆ†ä¸ºæ±½æ²¹æ±½è½¦ã€ç”µåŠ¨æ±½è½¦ç­‰ï¼›æŒ‰â€œé¢œè‰²â€åˆ’åˆ†å¯åˆ†ä¸ºç™½è‰²æ±½è½¦ã€é»‘è‰²æ±½è½¦å’Œçº¢è‰²æ±½è½¦ç­‰ã€‚å¦‚æœåŒæ—¶è€ƒè™‘è¿™ä¸¤ç§åˆ†ç±»ï¼Œå…¶ç»„åˆå°±å¾ˆå¤šã€‚ç±»å›¾å¦‚ä¸‹ï¼š </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99.png"></p>
<p>ä»ä¸Šé¢ç±»å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä½¿ç”¨ç»§æ‰¿å¤ç”¨äº§ç”Ÿäº†å¾ˆå¤šå­ç±»ï¼Œå¦‚æœç°åœ¨åˆæœ‰æ–°çš„åŠ¨åŠ›æºæˆ–è€…æ–°çš„é¢œè‰²çš„è¯ï¼Œå°±éœ€è¦å†å®šä¹‰æ–°çš„ç±»ã€‚æˆ‘ä»¬è¯•ç€å°†ç»§æ‰¿å¤ç”¨æ”¹ä¸ºèšåˆå¤ç”¨çœ‹ä¸€ä¸‹ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%991.png"></p>
<h1 id="4ï¼Œåˆ›å»ºè€…æ¨¡å¼"><a href="#4ï¼Œåˆ›å»ºè€…æ¨¡å¼" class="headerlink" title="4ï¼Œåˆ›å»ºè€…æ¨¡å¼"></a>4ï¼Œåˆ›å»ºè€…æ¨¡å¼</h1><p>åˆ›å»ºå‹æ¨¡å¼çš„ä¸»è¦å…³æ³¨ç‚¹æ˜¯â€œæ€æ ·åˆ›å»ºå¯¹è±¡ï¼Ÿâ€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€ã€‚</p>
<p>è¿™æ ·å¯ä»¥é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ï¼Œä½¿ç”¨è€…ä¸éœ€è¦å…³æ³¨å¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ã€‚</p>
<p>åˆ›å»ºå‹æ¨¡å¼åˆ†ä¸ºï¼š</p>
<ul>
<li>å•ä¾‹æ¨¡å¼</li>
<li>å·¥å‚æ–¹æ³•æ¨¡å¼</li>
<li>æŠ½è±¡å·¥ç¨‹æ¨¡å¼</li>
<li>åŸå‹æ¨¡å¼</li>
<li>å»ºé€ è€…æ¨¡å¼</li>
</ul>
<h1 id="5ï¼Œå•ä¾‹æ¨¡å¼"><a href="#5ï¼Œå•ä¾‹æ¨¡å¼" class="headerlink" title="5ï¼Œå•ä¾‹æ¨¡å¼"></a>5ï¼Œå•ä¾‹æ¨¡å¼</h1><h2 id="5-1-å•ä¾‹æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#5-1-å•ä¾‹æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="5.1 å•ä¾‹æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>5.1 å•ä¾‹æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p><strong>å•ä¾‹ï¼ˆSingletonï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š</strong>æŒ‡ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œä¸”è¯¥ç±»èƒ½è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹çš„ä¸€ç§æ¨¡å¼ã€‚ä¾‹å¦‚ï¼ŒWindows ä¸­åªèƒ½æ‰“å¼€ä¸€ä¸ªä»»åŠ¡ç®¡ç†å™¨ï¼Œè¿™æ ·å¯ä»¥é¿å…å› æ‰“å¼€å¤šä¸ªä»»åŠ¡ç®¡ç†å™¨çª—å£è€Œé€ æˆå†…å­˜èµ„æºçš„æµªè´¹ï¼Œæˆ–å‡ºç°å„ä¸ªçª—å£æ˜¾ç¤ºå†…å®¹çš„ä¸ä¸€è‡´ç­‰é”™è¯¯ã€‚</p>
<p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œè¿˜æœ‰ Windows çš„å›æ”¶ç«™ã€æ“ä½œç³»ç»Ÿä¸­çš„æ–‡ä»¶ç³»ç»Ÿã€å¤šçº¿ç¨‹ä¸­çš„çº¿ç¨‹æ± ã€æ˜¾å¡çš„é©±åŠ¨ç¨‹åºå¯¹è±¡ã€æ‰“å°æœºçš„åå°å¤„ç†æœåŠ¡ã€åº”ç”¨ç¨‹åºçš„æ—¥å¿—å¯¹è±¡ã€æ•°æ®åº“çš„è¿æ¥æ± ã€ç½‘ç«™çš„è®¡æ•°å™¨ã€Web åº”ç”¨çš„é…ç½®å¯¹è±¡ã€åº”ç”¨ç¨‹åºä¸­çš„å¯¹è¯æ¡†ã€ç³»ç»Ÿä¸­çš„ç¼“å­˜ç­‰å¸¸å¸¸è¢«è®¾è®¡æˆå•ä¾‹ã€‚</p>
<p>å•ä¾‹æ¨¡å¼åœ¨ç°å®ç”Ÿæ´»ä¸­çš„åº”ç”¨ä¹Ÿéå¸¸å¹¿æ³›ï¼Œä¾‹å¦‚å…¬å¸ CEOã€éƒ¨é—¨ç»ç†ç­‰éƒ½å±äºå•ä¾‹æ¨¡å‹ã€‚<strong>J2EE æ ‡å‡†ä¸­çš„ ServletgContext å’Œ ServletContextConfigã€Spring æ¡†æ¶åº”ç”¨ä¸­çš„ ApplicationContextã€æ•°æ®åº“ä¸­çš„è¿æ¥æ± ç­‰ä¹Ÿéƒ½æ˜¯å•ä¾‹æ¨¡å¼ã€‚</strong></p>
<p><strong>å•ä¾‹æ¨¡å¼æœ‰ 3 ä¸ªç‰¹ç‚¹ï¼š</strong></p>
<ol>
<li>å•ä¾‹ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼›</li>
<li>è¯¥å•ä¾‹å¯¹è±¡å¿…é¡»ç”±å•ä¾‹ç±»è‡ªè¡Œåˆ›å»ºï¼›</li>
<li>å•ä¾‹ç±»å¯¹å¤–æä¾›ä¸€ä¸ªè®¿é—®è¯¥å•ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ã€‚</li>
</ol>
<p><strong>å•ä¾‹æ¨¡å¼çš„ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>å•ä¾‹æ¨¡å¼å¯ä»¥ä¿è¯å†…å­˜é‡Œåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜çš„å¼€é”€ã€‚</li>
<li>å¯ä»¥é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ã€‚</li>
<li>å•ä¾‹æ¨¡å¼è®¾ç½®å…¨å±€è®¿é—®ç‚¹ï¼Œå¯ä»¥ä¼˜åŒ–å’Œå…±äº«èµ„æºçš„è®¿é—®ã€‚</li>
</ul>
<p>  <strong>å•ä¾‹æ¨¡å¼çš„ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>å•ä¾‹æ¨¡å¼ä¸€èˆ¬æ²¡æœ‰æ¥å£ï¼Œæ‰©å±•å›°éš¾ã€‚å¦‚æœè¦æ‰©å±•ï¼Œåˆ™é™¤äº†ä¿®æ”¹åŸæ¥çš„ä»£ç ï¼Œæ²¡æœ‰ç¬¬äºŒç§é€”å¾„ï¼Œè¿èƒŒå¼€é—­åŸåˆ™ã€‚</li>
<li>åœ¨å¹¶å‘æµ‹è¯•ä¸­ï¼Œå•ä¾‹æ¨¡å¼ä¸åˆ©äºä»£ç è°ƒè¯•ã€‚åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå•ä¾‹ä¸­çš„ä»£ç æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä¹Ÿä¸èƒ½æ¨¡æ‹Ÿç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</li>
<li>å•ä¾‹æ¨¡å¼çš„åŠŸèƒ½ä»£ç é€šå¸¸å†™åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå¦‚æœåŠŸèƒ½è®¾è®¡ä¸åˆç†ï¼Œåˆ™å¾ˆå®¹æ˜“è¿èƒŒå•ä¸€èŒè´£åŸåˆ™ã€‚</li>
</ul>
<h2 id="5-2-å•ä¾‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#5-2-å•ä¾‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="5.2 å•ä¾‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>5.2 å•ä¾‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="5-2-1-å•ä¾‹æ¨¡å¼çš„ç»“æ„"><a href="#5-2-1-å•ä¾‹æ¨¡å¼çš„ç»“æ„" class="headerlink" title="5.2.1 å•ä¾‹æ¨¡å¼çš„ç»“æ„"></a>5.2.1 å•ä¾‹æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>å•ä¾‹ç±»ï¼šåŒ…å«ä¸€ä¸ªå®ä¾‹ä¸”èƒ½è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹çš„ç±»ã€‚</li>
<li>è®¿é—®ç±»ï¼šä½¿ç”¨å•ä¾‹çš„ç±»ã€‚</li>
</ol>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_14-52-45.png"></p>
<h3 id="5-2-ä»£ç å®ç°"><a href="#5-2-ä»£ç å®ç°" class="headerlink" title="5.2 ä»£ç å®ç°"></a>5.2 ä»£ç å®ç°</h3><blockquote>
<p>å•ä¾‹è®¾è®¡æ¨¡å¼åˆ†ç±»ä¸¤ç§ï¼š</p>
<p>â€‹    é¥¿æ±‰å¼ï¼šç±»åŠ è½½å°±ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»º    </p>
<p>â€‹    æ‡’æ±‰å¼ï¼šç±»åŠ è½½ä¸ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»ºï¼Œè€Œæ˜¯é¦–æ¬¡ä½¿ç”¨è¯¥å¯¹è±¡æ—¶æ‰ä¼šåˆ›å»º</p>
</blockquote>
<p><strong>é¥¿æ±‰å¼(é™æ€å˜é‡)</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  é¥¿æ±‰å¼(é™æ€å˜é‡)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 9:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        Singleton instance2 = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.æ„é€ å™¨ç§æœ‰åŒ–ï¼Œå¤–éƒ¨èƒ½newã€</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–éƒ¨æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-40-53.png"></p>
<p><font color='red'>è¯´æ˜ï¼š</font></p>
<p>â€‹    è¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œå¹¶åˆ›å»ºSingletonç±»çš„å¯¹è±¡instanceã€‚instanceå¯¹è±¡æ˜¯éšç€ç±»çš„åŠ è½½è€Œåˆ›å»ºçš„ã€‚å¦‚æœè¯¥å¯¹è±¡è¶³å¤Ÿå¤§çš„è¯ï¼Œè€Œä¸€ç›´æ²¡æœ‰ä½¿ç”¨å°±ä¼šé€ æˆå†…å­˜çš„æµªè´¹ã€‚</p>
<p><strong>é™æ€ä»£ç å—</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  é™æ€ä»£ç å—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 9:35</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Singleton2 instance = Singleton2.getInstance();</span><br><span class="line">        Singleton2 instance2 = Singleton2.getInstance();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.æ„é€ å™¨ç§æœ‰åŒ–ï¼Œå¤–éƒ¨èƒ½newã€</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton2 instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    åœ¨é™æ€ä»£ç å—ä¸­åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> Singleton2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–éƒ¨æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton2 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-43-38.png"></p>
<p><font color='red'>è¯´æ˜ï¼š</font></p>
<p>â€‹    è¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œè€Œå¯¹è±¡çš„åˆ›å»ºæ˜¯åœ¨é™æ€ä»£ç å—ä¸­ï¼Œä¹Ÿæ˜¯å¯¹ç€ç±»çš„åŠ è½½è€Œåˆ›å»ºã€‚æ‰€ä»¥å’Œé¥¿æ±‰å¼çš„æ–¹å¼1åŸºæœ¬ä¸Šä¸€æ ·ï¼Œ<strong>å½“ç„¶è¯¥æ–¹å¼ä¹Ÿå­˜åœ¨å†…å­˜æµªè´¹é—®é¢˜ã€‚</strong></p>
<p><strong>æ‡’æ±‰å¼ çº¿ç¨‹ä¸å®‰å…¨</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type3;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æ‡’æ±‰å¼ çº¿ç¨‹ä¸å®‰å…¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 9:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        Singleton instance2 = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³• å½“ä½¿ç”¨åˆ°è¯¥æ–¹æ³•æ—¶ï¼Œæ‰å»åˆ›å»ºinstance</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-43-52.png"></p>
<p><font color='red'>è¯´æ˜ï¼š</font></p>
<p>â€‹    ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå¯¹è±¡çš„èµ‹å€¼æ“ä½œï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„å‘¢ï¼Ÿå½“è°ƒç”¨getInstance()æ–¹æ³•è·å–Singletonç±»çš„å¯¹è±¡çš„æ—¶å€™æ‰åˆ›å»ºSingletonç±»çš„å¯¹è±¡ï¼Œè¿™æ ·å°±å®ç°äº†æ‡’åŠ è½½çš„æ•ˆæœã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹ç¯å¢ƒï¼Œä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p>
<p><strong>æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ ï¼Œ åŒæ­¥æ–¹æ³•)</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type4;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest04</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ ï¼Œ åŒæ­¥æ–¹æ³•)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 9:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest04</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        Singleton instance2 = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥åŒæ­¥å¤„ç†çš„ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-44-06.png"></p>
<p><font color='red'>è¯´æ˜ï¼š</font></p>
<p>â€‹    è¯¥æ–¹å¼ä¹Ÿå®ç°äº†æ‡’åŠ è½½æ•ˆæœï¼ŒåŒæ—¶åˆè§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯åœ¨getInstance()æ–¹æ³•ä¸Šæ·»åŠ äº†synchronizedå…³é”®å­—ï¼Œå¯¼è‡´è¯¥æ–¹æ³•çš„æ‰§è¡Œæ•ˆæœç‰¹åˆ«ä½ã€‚ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå…¶å®å°±æ˜¯åœ¨åˆå§‹åŒ–instanceçš„æ—¶å€™æ‰ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸€æ—¦åˆå§‹åŒ–å®Œæˆå°±ä¸å­˜åœ¨äº†ã€‚</p>
<p><strong>æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ ï¼Œ åŒæ­¥ä»£ç å—)</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type5;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest05</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ ï¼Œ åŒæ­¥ä»£ç å—)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 9:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼,åŒæ­¥ä»£ç å—&quot;</span>);</span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        Singleton instance2 = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥åŒæ­¥å¤„ç†çš„ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-44-38.png"></p>
<p>åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§éå¸¸å¥½çš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œè§£å†³äº†å•ä¾‹ã€æ€§èƒ½ã€çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸Šé¢çš„åŒé‡æ£€æµ‹é”æ¨¡å¼çœ‹ä¸Šå»å®Œç¾æ— ç¼ºï¼Œå…¶å®æ˜¯å­˜åœ¨é—®é¢˜ï¼Œåœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°ç©ºæŒ‡é’ˆé—®é¢˜ï¼Œå‡ºç°é—®é¢˜çš„åŸå› æ˜¯JVMåœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šè¿›è¡Œä¼˜åŒ–å’ŒæŒ‡ä»¤é‡æ’åºæ“ä½œã€‚</p>
<p>è¦è§£å†³åŒé‡æ£€æŸ¥é”æ¨¡å¼å¸¦æ¥ç©ºæŒ‡é’ˆå¼‚å¸¸çš„é—®é¢˜ï¼Œåªéœ€è¦ä½¿ç”¨ <code>volatile</code> å…³é”®å­—, <code>volatile</code> å…³é”®å­—å¯ä»¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type6;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  åŒé‡æ£€æŸ¥ï¼Œæ¨èä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 9:54</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest06</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼ï¼ŒåŒé‡æ£€æŸ¥ï¼Œæ¨èä½¿ç”¨&quot;</span>);</span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        Singleton instance2 = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥åŒé‡æ£€æŸ¥ä»£ç ï¼ŒåŠ å…¥åŒæ­¥å¤„ç†çš„ä»£ç ï¼Œè§£å†³æ‡’åŠ è½½çš„é—®é¢˜</span></span><br><span class="line">    <span class="comment">//ä¿è¯æ•ˆç‡ã€‚æ¨èä½¿ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-45-29.png"></p>
<p><font color="red">å°ç»“ï¼š</font></p>
<p><strong>æ·»åŠ  <code>volatile</code> å…³é”®å­—ä¹‹åçš„åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¥½çš„å•ä¾‹å®ç°æ¨¡å¼</strong>ï¼Œèƒ½å¤Ÿä¿è¯åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹çº¿ç¨‹å®‰å…¨ä¹Ÿä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚</p>
<p><strong>é™æ€å†…éƒ¨ç±»å®ç°å•ä¾‹æ¨¡å¼ï¼</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type7;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest07</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  é™æ€å†…éƒ¨ç±»å®ç°å•ä¾‹æ¨¡å¼ï¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 9:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest07</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é™æ€å†…éƒ¨ç±»å®ç°å•ä¾‹æ¨¡å¼&quot;</span>);</span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        Singleton instance2 = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å†™ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œè¯¥ç±»ä¸­æœ‰ä¸ªé™æ€å±æ€§ï¼ŒSingleton</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonInstance</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼Œç›´æ¥è¿”å›SingletonInstance.INSTANCE;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonInstance.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-45-43.png"></p>
<p><font color='red'>è¯´æ˜ï¼š</font></p>
<p>â€‹    ç¬¬ä¸€æ¬¡åŠ è½½Singletonç±»æ—¶ä¸ä¼šå»åˆå§‹åŒ–INSTANCEï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceï¼Œè™šæ‹ŸæœºåŠ è½½SingletonHolder</p>
<p>å¹¶åˆå§‹åŒ–INSTANCEï¼Œè¿™æ ·ä¸ä»…èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½ä¿è¯ Singleton ç±»çš„å”¯ä¸€æ€§ã€‚</p>
<p><font color="red">å°ç»“ï¼š</font></p>
<p>â€‹    é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§ä¼˜ç§€çš„å•ä¾‹æ¨¡å¼ï¼Œæ˜¯å¼€æºé¡¹ç›®ä¸­æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§å•ä¾‹æ¨¡å¼ã€‚åœ¨æ²¡æœ‰åŠ ä»»ä½•é”çš„æƒ…å†µä¸‹ï¼Œä¿è¯äº†å¤šçº¿ç¨‹ä¸‹çš„å®‰å…¨ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•æ€§èƒ½å½±å“å’Œç©ºé—´çš„æµªè´¹ã€‚</p>
<p><strong>æšä¸¾çš„æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.singleton.type8;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SingletonTest08</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æšä¸¾çš„æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/17 10:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest08</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æšä¸¾çš„æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼ï¼Œæ¨èä½¿ç”¨&quot;</span>);</span><br><span class="line">        Singleton instance = Singleton.INSTANCE;</span><br><span class="line">        Singleton instance2 = Singleton.INSTANCE;</span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå•ä¾‹</span></span><br><span class="line">        System.out.println(instance == instance2);</span><br><span class="line">        System.out.println(<span class="string">&quot;intstanceçš„å“ˆå¸Œå€¼&quot;</span> + instance.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;intstance2çš„å“ˆå¸Œå€¼&quot;</span> + instance2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æšä¸¾</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    INSTANCE;<span class="comment">//å±æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;method()æ–¹æ³•è¢«è°ƒç”¨...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-47-27.png"></p>
<p><font color='red'>è¯´æ˜ï¼š</font></p>
<p>â€‹    æšä¸¾æ–¹å¼å±äºæ¶æ±‰å¼æ–¹å¼ã€‚</p>
<h2 id="5-3-å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#5-3-å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="5.3 å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>5.3 å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ul>
<li>éœ€è¦é¢‘ç¹åˆ›å»ºçš„ä¸€äº›ç±»ï¼Œä½¿ç”¨å•ä¾‹å¯ä»¥é™ä½ç³»ç»Ÿçš„å†…å­˜å‹åŠ›ï¼Œå‡å°‘ GCã€‚</li>
<li>æŸç±»åªè¦æ±‚ç”Ÿæˆä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚ä¸€ä¸ªç­ä¸­çš„ç­é•¿ã€æ¯ä¸ªäººçš„èº«ä»½è¯å·ç­‰ã€‚</li>
<li>æŸäº›ç±»åˆ›å»ºå®ä¾‹æ—¶å ç”¨èµ„æºè¾ƒå¤šï¼Œæˆ–å®ä¾‹åŒ–è€—æ—¶è¾ƒé•¿ï¼Œä¸”ç»å¸¸ä½¿ç”¨ã€‚</li>
<li>æŸç±»éœ€è¦é¢‘ç¹å®ä¾‹åŒ–ï¼Œè€Œåˆ›å»ºçš„å¯¹è±¡åˆé¢‘ç¹è¢«é”€æ¯çš„æ—¶å€™ï¼Œå¦‚å¤šçº¿ç¨‹çš„çº¿ç¨‹æ± ã€ç½‘ç»œè¿æ¥æ± ç­‰ã€‚</li>
<li>é¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡ã€‚</li>
<li>å¯¹äºä¸€äº›æ§åˆ¶ç¡¬ä»¶çº§åˆ«çš„æ“ä½œï¼Œæˆ–è€…ä»ç³»ç»Ÿä¸Šæ¥è®²åº”å½“æ˜¯å•ä¸€æ§åˆ¶é€»è¾‘çš„æ“ä½œï¼Œå¦‚æœæœ‰å¤šä¸ªå®ä¾‹ï¼Œåˆ™ç³»ç»Ÿä¼šå®Œå…¨ä¹±å¥—ã€‚</li>
<li>å½“å¯¹è±¡éœ€è¦è¢«å…±äº«çš„åœºåˆã€‚ç”±äºå•ä¾‹æ¨¡å¼åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå…±äº«è¯¥å¯¹è±¡å¯ä»¥èŠ‚çœå†…å­˜ï¼Œå¹¶åŠ å¿«å¯¹è±¡è®¿é—®é€Ÿåº¦ã€‚å¦‚ Web ä¸­çš„é…ç½®å¯¹è±¡ã€æ•°æ®åº“çš„è¿æ¥æ± ç­‰ã€‚</li>
</ul>
<h2 id="5-4-å­˜åœ¨çš„é—®é¢˜"><a href="#5-4-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="5.4 å­˜åœ¨çš„é—®é¢˜"></a>5.4 å­˜åœ¨çš„é—®é¢˜</h2><p>ç ´åå•ä¾‹æ¨¡å¼ï¼š</p>
<p>ä½¿ä¸Šé¢å®šä¹‰çš„å•ä¾‹ç±»ï¼ˆSingletonï¼‰å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œæšä¸¾æ–¹å¼é™¤å¤–ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯åºåˆ—åŒ–å’Œåå°„ã€‚</p>
<ul>
<li><p>åºåˆ—åŒ–ååºåˆ—åŒ–</p>
<p><strong>Singletonç±»ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Testç±»ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//å¾€æ–‡ä»¶ä¸­å†™å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//writeObject2File();</span></span><br><span class="line">        <span class="comment">//ä»æ–‡ä»¶ä¸­è¯»å–å¯¹è±¡</span></span><br><span class="line">        Singleton s1 = readObjectFromFile();</span><br><span class="line">        Singleton s2 = readObjectFromFile();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­ä¸¤ä¸ªååºåˆ—åŒ–åçš„å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Singleton <span class="title">readObjectFromFile</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å…¥æµå¯¹è±¡</span></span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;C:\\Users\\dell\\Desktop\\a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ä¸ªè¯»å–Singletonå¯¹è±¡</span></span><br><span class="line">        Singleton instance = (Singleton) ois.readObject();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeObject2File</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„å¯¹è±¡</span></span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å‡ºæµ</span></span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;C:\\Users\\dell\\Desktop\\a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//å°†instanceå¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">        oos.writeObject(instance);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯<code>false</code>ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚</p>
</blockquote>
</li>
<li><p>åå°„</p>
<p><strong>Singletonç±»ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Testç±»ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">        Class clazz = Singleton.class;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„ç§æœ‰æ— å‚æ„é€ æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        Constructor constructor = clazz.getDeclaredConstructor();</span><br><span class="line">        <span class="comment">//å–æ¶ˆè®¿é—®æ£€æŸ¥</span></span><br><span class="line">        constructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºSingletonç±»çš„å¯¹è±¡s1</span></span><br><span class="line">        Singleton s1 = (Singleton) constructor.newInstance();</span><br><span class="line">        <span class="comment">//åˆ›å»ºSingletonç±»çš„å¯¹è±¡s2</span></span><br><span class="line">        Singleton s2 = (Singleton) constructor.newInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­é€šè¿‡åå°„åˆ›å»ºçš„ä¸¤ä¸ªSingletonå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯<code>false</code>ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼</p>
</blockquote>
</li>
</ul>
<blockquote>
<p><font color="red">æ³¨æ„ï¼š</font>æšä¸¾æ–¹å¼ä¸ä¼šå‡ºç°è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p>
</blockquote>
<p><strong>é—®é¢˜çš„è§£å†³</strong></p>
<ul>
<li><p>åºåˆ—åŒ–ã€ååºåˆ—æ–¹å¼ç ´åå•ä¾‹æ¨¡å¼çš„è§£å†³æ–¹æ³•</p>
<p>åœ¨Singletonç±»ä¸­æ·»åŠ <code>readResolve()</code>æ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–æ—¶è¢«åå°„è°ƒç”¨ï¼Œå¦‚æœå®šä¹‰äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°±è¿”å›è¿™ä¸ªæ–¹æ³•çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™è¿”å›æ–°newå‡ºæ¥çš„å¯¹è±¡ã€‚</p>
<p><strong>Singletonç±»ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹é¢æ˜¯ä¸ºäº†è§£å†³åºåˆ—åŒ–ååºåˆ—åŒ–ç ´è§£å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æºç è§£æï¼š</strong></p>
<p>ObjectInputStreamç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Object <span class="title">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// if nested read, passHandle contains handle of enclosing object</span></span><br><span class="line">    <span class="keyword">int</span> outerHandle = passHandle;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Object obj = readObject0(<span class="keyword">false</span>);<span class="comment">//é‡ç‚¹æŸ¥çœ‹readObject0æ–¹æ³•</span></span><br><span class="line">    .....</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">private</span> Object <span class="title">readObject0</span><span class="params">(<span class="keyword">boolean</span> unshared)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="keyword">switch</span> (tc) &#123;</span><br><span class="line">			...</span><br><span class="line">			<span class="keyword">case</span> TC_OBJECT:</span><br><span class="line">				<span class="keyword">return</span> checkResolve(readOrdinaryObject(unshared));<span class="comment">//é‡ç‚¹æŸ¥çœ‹readOrdinaryObjectæ–¹æ³•</span></span><br><span class="line">			...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        depth--;</span><br><span class="line">        bin.setBlockDataMode(oldMode);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">private</span> Object <span class="title">readOrdinaryObject</span><span class="params">(<span class="keyword">boolean</span> unshared)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="comment">//isInstantiable è¿”å›trueï¼Œæ‰§è¡Œ desc.newInstance()ï¼Œé€šè¿‡åå°„åˆ›å»ºæ–°çš„å•ä¾‹ç±»ï¼Œ</span></span><br><span class="line">    obj = desc.isInstantiable() ? desc.newInstance() : <span class="keyword">null</span>; </span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// åœ¨Singletonç±»ä¸­æ·»åŠ  readResolve æ–¹æ³•å desc.hasReadResolveMethod() æ–¹æ³•æ‰§è¡Œç»“æœä¸ºtrue</span></span><br><span class="line">    <span class="keyword">if</span> (obj != <span class="keyword">null</span> &amp;&amp; handles.lookupException(passHandle) == <span class="keyword">null</span> &amp;&amp; desc.hasReadResolveMethod()) &#123;</span><br><span class="line">    	<span class="comment">// é€šè¿‡åå°„è°ƒç”¨ Singleton ç±»ä¸­çš„ readResolve æ–¹æ³•ï¼Œå°†è¿”å›å€¼èµ‹å€¼ç»™repå˜é‡</span></span><br><span class="line">    	<span class="comment">// è¿™æ ·å¤šæ¬¡è°ƒç”¨ObjectInputStreamç±»ä¸­çš„readObjectæ–¹æ³•ï¼Œç»§è€Œå°±ä¼šè°ƒç”¨æˆ‘ä»¬å®šä¹‰çš„readResolveæ–¹æ³•ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</span></span><br><span class="line">    	Object rep = desc.invokeReadResolve(obj);</span><br><span class="line">     	...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>åå°„æ–¹å¼ç ´è§£å•ä¾‹çš„è§£å†³æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">           åå°„ç ´è§£å•ä¾‹æ¨¡å¼éœ€è¦æ·»åŠ çš„ä»£ç </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red">è¯´æ˜:</font></p>
<pre><code>è¿™ç§æ–¹å¼æ¯”è¾ƒå¥½ç†è§£ã€‚å½“é€šè¿‡åå°„æ–¹å¼è°ƒç”¨æ„é€ æ–¹æ³•è¿›è¡Œåˆ›å»ºåˆ›å»ºæ—¶ï¼Œç›´æ¥æŠ›å¼‚å¸¸ã€‚ä¸è¿è¡Œæ­¤ä¸­æ“ä½œã€‚
</code></pre>
</li>
</ul>
<h2 id="5-5-JDKæºç è§£æ-Runtimeç±»"><a href="#5-5-JDKæºç è§£æ-Runtimeç±»" class="headerlink" title="5.5 JDKæºç è§£æ-Runtimeç±»"></a>5.5 JDKæºç è§£æ-Runtimeç±»</h2><p>Runtimeç±»å°±æ˜¯ä½¿ç”¨çš„å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚</p>
<ol>
<li><p>é€šè¿‡æºä»£ç æŸ¥çœ‹ä½¿ç”¨çš„æ˜¯å“ªå„¿ç§å•ä¾‹æ¨¡å¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Runtime</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Runtime currentRuntime = <span class="keyword">new</span> Runtime();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the runtime object associated with the current Java application.</span></span><br><span class="line"><span class="comment">     * Most of the methods of class &lt;code&gt;Runtime&lt;/code&gt; are instance</span></span><br><span class="line"><span class="comment">     * methods and must be invoked with respect to the current runtime object.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  the &lt;code&gt;Runtime&lt;/code&gt; object associated with the current</span></span><br><span class="line"><span class="comment">     *          Java application.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Runtime <span class="title">getRuntime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentRuntime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Don&#x27;t let anyone else instantiate this class */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Runtime</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»ä¸Šé¢æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºRuntimeç±»ä½¿ç”¨çš„æ˜¯æ¶æ±‰å¼ï¼ˆé™æ€å±æ€§ï¼‰æ–¹å¼æ¥å®ç°å•ä¾‹æ¨¡å¼çš„ã€‚</p>
</li>
<li><p>ä½¿ç”¨Runtimeç±»ä¸­çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RuntimeDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–Runtimeç±»å¯¹è±¡</span></span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿”å› Java è™šæ‹Ÿæœºä¸­çš„å†…å­˜æ€»é‡ã€‚</span></span><br><span class="line">        System.out.println(runtime.totalMemory());</span><br><span class="line">        <span class="comment">//è¿”å› Java è™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡ã€‚</span></span><br><span class="line">        System.out.println(runtime.maxMemory());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æ‰§è¡ŒæŒ‡å®šçš„å­—ç¬¦ä¸²å‘½ä»¤ï¼Œè¿”å›è¿›ç¨‹å¯¹è±¡</span></span><br><span class="line">        Process process = runtime.exec(<span class="string">&quot;ipconfig&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœï¼Œé€šè¿‡è¾“å…¥æµè·å–</span></span><br><span class="line">        InputStream inputStream = process.getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] arr = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>* <span class="number">100</span>];</span><br><span class="line">        <span class="keyword">int</span> b = inputStream.read(arr);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(arr,<span class="number">0</span>,b,<span class="string">&quot;gbk&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="6ï¼ŒåŸå‹æ¨¡å¼"><a href="#6ï¼ŒåŸå‹æ¨¡å¼" class="headerlink" title="6ï¼ŒåŸå‹æ¨¡å¼"></a>6ï¼ŒåŸå‹æ¨¡å¼</h1><h2 id="6-1åŸå½¢æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#6-1åŸå½¢æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="6.1åŸå½¢æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>6.1åŸå½¢æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>åŸå‹ï¼ˆPrototypeï¼‰æ¨¡å¼çš„å®šä¹‰å¦‚ä¸‹ï¼š<strong>ç”¨ä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®ä¾‹ä½œä¸ºåŸå‹ï¼Œé€šè¿‡å¤åˆ¶è¯¥åŸå‹å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå’ŒåŸå‹ç›¸åŒæˆ–ç›¸ä¼¼çš„æ–°å¯¹è±¡ã€‚åœ¨è¿™é‡Œï¼ŒåŸå‹å®ä¾‹æŒ‡å®šäº†è¦åˆ›å»ºçš„å¯¹è±¡çš„ç§ç±»ã€‚</strong>ç”¨è¿™ç§æ–¹å¼åˆ›å»ºå¯¹è±¡éå¸¸é«˜æ•ˆï¼Œæ ¹æœ¬æ— é¡»çŸ¥é“å¯¹è±¡åˆ›å»ºçš„ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼ŒWindows æ“ä½œç³»ç»Ÿçš„å®‰è£…é€šå¸¸è¾ƒè€—æ—¶ï¼Œå¦‚æœå¤åˆ¶å°±å¿«äº†å¾ˆå¤šã€‚</p>
<p><strong>åŸå‹æ¨¡å¼çš„ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>Javaè‡ªå¸¦çš„åŸå‹æ¨¡å¼åŸºäºå†…å­˜äºŒè¿›åˆ¶æµçš„å¤åˆ¶ï¼Œåœ¨æ€§èƒ½ä¸Šæ¯”ç›´æ¥ new ä¸€ä¸ªå¯¹è±¡æ›´åŠ ä¼˜è‰¯ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨æ·±å…‹éš†æ–¹å¼ä¿å­˜å¯¹è±¡çš„çŠ¶æ€ï¼Œä½¿ç”¨åŸå‹æ¨¡å¼å°†å¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œå¹¶å°†å…¶çŠ¶æ€ä¿å­˜èµ·æ¥ï¼Œç®€åŒ–äº†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ï¼Œä»¥ä¾¿åœ¨éœ€è¦çš„æ—¶å€™ä½¿ç”¨ï¼ˆä¾‹å¦‚æ¢å¤åˆ°å†å²æŸä¸€çŠ¶æ€ï¼‰ï¼Œå¯è¾…åŠ©å®ç°æ’¤é”€æ“ä½œã€‚</li>
</ul>
<p><strong>åŸå‹æ¨¡å¼çš„ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>éœ€è¦ä¸ºæ¯ä¸€ä¸ªç±»éƒ½é…ç½®ä¸€ä¸ª clone æ–¹æ³•</li>
<li>clone æ–¹æ³•ä½äºç±»çš„å†…éƒ¨ï¼Œå½“å¯¹å·²æœ‰ç±»è¿›è¡Œæ”¹é€ çš„æ—¶å€™ï¼Œéœ€è¦ä¿®æ”¹ä»£ç ï¼Œè¿èƒŒäº†å¼€é—­åŸåˆ™ã€‚</li>
<li>å½“å®ç°æ·±å…‹éš†æ—¶ï¼Œéœ€è¦ç¼–å†™è¾ƒä¸ºå¤æ‚çš„ä»£ç ï¼Œè€Œä¸”å½“å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤šé‡åµŒå¥—å¼•ç”¨æ—¶ï¼Œä¸ºäº†å®ç°æ·±å…‹éš†ï¼Œæ¯ä¸€å±‚å¯¹è±¡å¯¹åº”çš„ç±»éƒ½å¿…é¡»æ”¯æŒæ·±å…‹éš†ï¼Œå®ç°èµ·æ¥ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚å› æ­¤ï¼Œæ·±å…‹éš†ã€æµ…å…‹éš†éœ€è¦è¿ç”¨å¾—å½“ã€‚</li>
</ul>
<h2 id="6-2-åŸå‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#6-2-åŸå‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="6.2 åŸå‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>6.2 åŸå‹æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="6-2-1-åŸå½¢æ¨¡å¼çš„ç»“æ„"><a href="#6-2-1-åŸå½¢æ¨¡å¼çš„ç»“æ„" class="headerlink" title="6.2.1 åŸå½¢æ¨¡å¼çš„ç»“æ„"></a>6.2.1 åŸå½¢æ¨¡å¼çš„ç»“æ„</h3><p>åŸå‹æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ã€‚</p>
<ol>
<li>æŠ½è±¡åŸå‹ç±»ï¼šè§„å®šäº†å…·ä½“åŸå‹å¯¹è±¡å¿…é¡»å®ç°çš„æ¥å£ã€‚</li>
<li>å…·ä½“åŸå‹ç±»ï¼šå®ç°æŠ½è±¡åŸå‹ç±»çš„ clone() æ–¹æ³•ï¼Œå®ƒæ˜¯å¯è¢«å¤åˆ¶çš„å¯¹è±¡ã€‚</li>
<li>è®¿é—®ç±»ï¼šä½¿ç”¨å…·ä½“åŸå‹ç±»ä¸­çš„ clone() æ–¹æ³•æ¥å¤åˆ¶æ–°çš„å¯¹è±¡ã€‚</li>
</ol>
<h3 id="6-2-2-ä»£ç å®ç°"><a href="#6-2-2-ä»£ç å®ç°" class="headerlink" title="6.2.2 ä»£ç å®ç°"></a>6.2.2 ä»£ç å®ç°</h3><blockquote>
<p>æµ…å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œæ–°å¯¹è±¡çš„å±æ€§å’ŒåŸæ¥å¯¹è±¡å®Œå…¨ç›¸åŒï¼Œå¯¹äºéåŸºæœ¬ç±»å‹å±æ€§ï¼Œä»æŒ‡å‘åŸæœ‰å±æ€§æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p>
<p>æ·±å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå±æ€§ä¸­å¼•ç”¨çš„å…¶ä»–å¯¹è±¡ä¹Ÿä¼šè¢«å…‹éš†ï¼Œä¸å†æŒ‡å‘åŸæœ‰å¯¹è±¡åœ°å€ã€‚</p>
</blockquote>
<h4 id="6-2-2-1-æµ…æ‹·è´"><a href="#6-2-2-1-æµ…æ‹·è´" class="headerlink" title="6.2.2.1 æµ…æ‹·è´"></a>6.2.2.1 æµ…æ‹·è´</h4><p><strong>IdCard</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.shallowclone;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> IdCard</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æµ…æ‹·è´çš„ç¤ºä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:16</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdCard</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IdCard</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IdCard&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Person</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.shallowclone;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Person</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æµ…æ‹·è´çš„ç¤ºä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:17</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> IdCard idCard;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age, IdCard idCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.idCard = idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IdCard <span class="title">getIdCard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIdCard</span><span class="params">(IdCard idCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.idCard = idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, idCard=&quot;</span> + idCard + <span class="string">&quot;, idCard.hashCode=&quot;</span> + idCard.hashCode() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PersonTest</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.shallowclone;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PersonTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æµ…æ‹·è´æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:17</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>, <span class="keyword">new</span> IdCard(<span class="string">&quot;10086&quot;</span>));</span><br><span class="line"></span><br><span class="line">        Person person1 = (Person) person.clone();</span><br><span class="line">        Person person2 = (Person) person.clone();</span><br><span class="line"></span><br><span class="line">        System.out.println(person);</span><br><span class="line">        System.out.println(person1);</span><br><span class="line">        System.out.println(person2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-51-19.png"></p>
<p>æˆ‘ä»¬å‘ç°å¯ä»¥é€šè¿‡å®ç°<code>implements Cloneable</code>æ¥å®Œæˆæµ…æ‹·è´ï¼ŒåŸºæœ¬å˜é‡æ˜¯å€¼ä¼ é€’å…‹éš†ï¼Œè€Œå¼•ç”¨å¯¹è±¡<code>IdCard</code>åˆ™æ˜¯å¼•ç”¨ä¼ é€’ï¼Œè¿™ä¸ç¬¦åˆæˆ‘ä»¬é¢å‘å¯¹è±¡æ€æƒ³ï¼Œæ¯ä¸€ä¸ª<code>Person</code>åº”è¯¥éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„<code>IdCard</code>ï¼Œè€Œä¸æ˜¯å…±ç”¨ä¸€ä¸ªï¼Œè€Œè¦è§£å†³è¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ·±å…‹éš†</p>
<h4 id="6-2-2-2-æ·±æ‹·è´-ç¬¬ä¸€ç§"><a href="#6-2-2-2-æ·±æ‹·è´-ç¬¬ä¸€ç§" class="headerlink" title="6.2.2.2 æ·±æ‹·è´(ç¬¬ä¸€ç§)"></a>6.2.2.2 æ·±æ‹·è´(ç¬¬ä¸€ç§)</h4><p><strong>IdCard</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.deepclone.one;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> IdCard</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ·±å…‹éš†çš„ç¤ºä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//å®ç°Cloneableæ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdCard</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IdCard</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IdCard&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&#x27;&quot;</span> + id + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Person</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.deepclone.one;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Person</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ·±å…‹éš†çš„ç¤ºä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> IdCard idCard;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age, IdCard idCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.idCard = idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IdCard <span class="title">getIdCard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIdCard</span><span class="params">(IdCard idCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.idCard = idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;personHashCode=&quot;</span> + <span class="keyword">this</span>.hashCode() +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, idCard=&quot;</span> + idCard +</span><br><span class="line">                <span class="string">&quot;, idCardHashCode=&quot;</span> + idCard.hashCode() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·±å…‹éš†éœ€è¦è‡ªå·±æ‰‹åŠ¨å®ç°ï¼Œåœ¨å¯¹è±¡å¼•ç”¨ä¸­ä¹Ÿè¦å®ç°cloneæ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="comment">//å®ŒæˆåŸºæœ¬æ•°æ®ç±»å‹çš„æ‹·è´</span></span><br><span class="line">        <span class="comment">//é€šè¿‡newå…³é”®å­—åˆ›å»ºçš„å¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹</span></span><br><span class="line"></span><br><span class="line">        Object person = <span class="keyword">super</span>.clone();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¯¹å¼•ç”¨ç±»å‹å•ç‹¬å¤„ç†</span></span><br><span class="line">        Person p = (Person) person;</span><br><span class="line">        IdCard idCard = (IdCard) p.getIdCard().clone(); <span class="comment">//å®ç°è‡ªå·±çš„å…‹éš†</span></span><br><span class="line">        p.setIdCard(idCard);</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PersonTest</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.deepclone.one;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PersonTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ·±å…‹éš†æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonTest</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>, <span class="keyword">new</span> IdCard(<span class="string">&quot;10086&quot;</span>));</span><br><span class="line"></span><br><span class="line">        Person person1 = (Person) person.clone();</span><br><span class="line">        Person person2 = (Person) person.clone();</span><br><span class="line"></span><br><span class="line">        System.out.println(person);</span><br><span class="line">        System.out.println(person1);</span><br><span class="line">        System.out.println(person2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-51-19.png"></p>
<p>ä½¿ç”¨è¿™ç§æ·±å…‹éš†çš„æ–¹å¼ï¼Œå®Œç¾çš„è§£å†³äº†å½“æ•°æ®ç±»å‹ä¸ºå¼•ç”¨ç±»å‹æ—¶ï¼Œåªæ˜¯æ‹·è´åŸå¼•ç”¨å¯¹è±¡åœ°å€è€Œä¸æ˜¯ä¸€ä¸ªå…¨æ–°çš„å¼•ç”¨å¯¹è±¡çš„å¼•ç”¨ï¼Œä½†æ˜¯è¿™ç§å®ç°æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼Šç«¯ï¼Œéœ€è¦åœ¨æ¯ä¸€ä¸ªå¯¹è±¡ä¸­éƒ½å®ç°cloneæ–¹æ³•ï¼Œå¦‚æœç±»å…¨æ˜¯ä½ è‡ªå·±å†™çš„ï¼Œé‚£è‡ªç„¶æ²¡é—®é¢˜ï¼Œå®ç°ä¸€ä¸‹å°±è¡Œäº†ï¼Œä¸è¿‡æœ‰ç‚¹éº»çƒ¦ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ å¼•ç”¨çš„æ˜¯ç¬¬ä¸‰æ–¹çš„ä¸€ä¸ªç±»ï¼Œæ— æ³•ä¿®æ”¹æºä»£ç ï¼Œè¿™ç§æ–¹å¼ï¼Œæ˜¾ç„¶å°±æ— æ³•å®ç°æ·±å…‹éš†äº†</p>
<h4 id="6-2-2-2-æ·±æ‹·è´-ç¬¬äºŒç§"><a href="#6-2-2-2-æ·±æ‹·è´-ç¬¬äºŒç§" class="headerlink" title="6.2.2.2 æ·±æ‹·è´(ç¬¬äºŒç§)"></a>6.2.2.2 æ·±æ‹·è´(ç¬¬äºŒç§)</h4><p><strong>IdCard</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.deepclone.two;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> IdCard</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ·±å…‹éš†çš„ç¤ºä¾‹2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//å®ç°Serializableæ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdCard</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IdCard</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IdCard&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&#x27;&quot;</span> + id + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Person</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.deepclone.two;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Person</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ·±å…‹éš†çš„ç¤ºä¾‹2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> IdCard idCard;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age, IdCard idCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.idCard = idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IdCard <span class="title">getIdCard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIdCard</span><span class="params">(IdCard idCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.idCard = idCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;personHashCode=&quot;</span> + <span class="keyword">this</span>.hashCode() +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, idCard=&quot;</span> + idCard +</span><br><span class="line">                <span class="string">&quot;, idCardHashCode=&quot;</span> + idCard.hashCode() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åºåˆ—åŒ–çš„æ–¹å¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">deelClone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºæµå¯¹è±¡</span></span><br><span class="line">        ByteArrayOutputStream bos = <span class="keyword">null</span>;</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">        ByteArrayInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//åºåˆ—åŒ–</span></span><br><span class="line">            bos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            oos = <span class="keyword">new</span> ObjectOutputStream(bos);</span><br><span class="line">            oos.writeObject(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ååºåˆ—åŒ–</span></span><br><span class="line">            bis = <span class="keyword">new</span> ByteArrayInputStream(bos.toByteArray());</span><br><span class="line">            ois = <span class="keyword">new</span> ObjectInputStream(bis);</span><br><span class="line">            <span class="keyword">return</span> (Person) ois.readObject();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                ois.close();</span><br><span class="line">                bis.close();</span><br><span class="line">                oos.close();</span><br><span class="line">                bos.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PersonTest</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.prototype.deepclone.two;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PersonTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ·±å…‹éš†æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/19 12:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>, <span class="keyword">new</span> IdCard(<span class="string">&quot;10086&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…‹éš†ä¸¤ä¸ªå¯¹è±¡</span></span><br><span class="line">        Person person1 = (Person) person.deelClone();</span><br><span class="line">        Person person2 = (Person) person.deelClone();</span><br><span class="line">		System.out.println(<span class="string">&quot;æ·±æ‹·è´(ç¬¬äºŒç§ å®ç°åºåˆ—åŒ–æ¥å£)&quot;</span>);</span><br><span class="line">        <span class="comment">//æ‰“å°ä¸‰äººä¿¡æ¯</span></span><br><span class="line">        System.out.println(person);</span><br><span class="line">        System.out.println(person1);</span><br><span class="line">        System.out.println(person2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_07-52-49.png"></p>
<p>è¿™ç§æ–¹å¼æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç¼–å†™deepCloneæ–¹æ³•ï¼Œä½¿ç”¨Javaæµä¸­çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ¥å®ç°æ·±å…‹éš†ï¼Œä½†æ˜¯è¿™ç§å®ç°ï¼Œéœ€è¦åœ¨æ¯ä¸€ä¸ªç±»ä¸­éƒ½ç»§æ‰¿åºåˆ—åŒ–Serializableæ¥å£ï¼Œè¿™ç§æ–¹å¼ï¼Œå¦‚æœä½ è°ƒç”¨çš„æ˜¯ç¬¬ä¸‰æ–¹ç±»ï¼Œä¹Ÿæœ‰å¯èƒ½ç¬¬ä¸‰æ–¹ç±»ä¸Šæ²¡æœ‰å®ç°Serializableåºåˆ—åŒ–æ¥å£ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œå¤§å¤šéƒ½ä¼šå®ç°ï¼Œæ€»çš„æ¥è¯´ï¼Œè¿™ç§æ¯”è¾ƒæ¨èä½¿ç”¨ï¼Œè€Œä¸”æ•ˆç‡ä¹Ÿé«˜</p>
<h2 id="6-3-åŸå‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#6-3-åŸå‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="6.3 åŸå‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>6.3 åŸå‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ul>
<li>å¯¹è±¡ä¹‹é—´ç›¸åŒæˆ–ç›¸ä¼¼ï¼Œå³åªæ˜¯ä¸ªåˆ«çš„å‡ ä¸ªå±æ€§ä¸åŒçš„æ—¶å€™ã€‚</li>
<li>åˆ›å»ºå¯¹è±¡æˆæœ¬è¾ƒå¤§ï¼Œä¾‹å¦‚åˆå§‹åŒ–æ—¶é—´é•¿ï¼Œå ç”¨CPUå¤ªå¤šï¼Œæˆ–è€…å ç”¨ç½‘ç»œèµ„æºå¤ªå¤šç­‰ï¼Œéœ€è¦ä¼˜åŒ–èµ„æºã€‚</li>
<li>åˆ›å»ºä¸€ä¸ªå¯¹è±¡éœ€è¦ç¹ççš„æ•°æ®å‡†å¤‡æˆ–è®¿é—®æƒé™ç­‰ï¼Œéœ€è¦æé«˜æ€§èƒ½æˆ–è€…æé«˜å®‰å…¨æ€§ã€‚</li>
<li>ç³»ç»Ÿä¸­å¤§é‡ä½¿ç”¨è¯¥ç±»å¯¹è±¡ï¼Œä¸”å„ä¸ªè°ƒç”¨è€…éƒ½éœ€è¦ç»™å®ƒçš„å±æ€§é‡æ–°èµ‹å€¼ã€‚</li>
<li>åœ¨ Springä¸­ï¼ŒåŸå‹æ¨¡å¼åº”ç”¨çš„éå¸¸å¹¿æ³›ï¼Œ<strong>ä¾‹å¦‚ scope=â€™prototypeâ€™ã€JSON.parseObject()</strong> ç­‰éƒ½æ˜¯åŸå‹æ¨¡å¼çš„å…·ä½“åº”ç”¨ã€‚</li>
</ul>
<h2 id="6-4-åŸå‹æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"><a href="#6-4-åŸå‹æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚" class="headerlink" title="6.4 åŸå‹æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"></a>6.4 åŸå‹æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚</h2><ul>
<li>åˆ›å»ºæ–°çš„å¯¹è±¡æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½æé«˜æ•ˆç‡</li>
<li>ä¸ç”¨é‡æ–°åˆå§‹åŒ–å¯¹è±¡ï¼ŒåŠ¨æ€åœ°è·å¾—å¯¹è±¡è¿è¡Œæ—¶çš„çŠ¶æ€</li>
<li>å¦‚æœåŸå§‹å¯¹è±¡å‘ç”Ÿå˜åŒ–(å¢åŠ æˆ–å‡å°‘å±æ€§)ï¼Œå…¶ä»–å…‹éš†å¯¹è±¡ä¹Ÿä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–ï¼Œæ— éœ€ä¿®æ”¹ä»£ç </li>
</ul>
<h1 id="7ï¼Œå·¥å‚æ¨¡å¼"><a href="#7ï¼Œå·¥å‚æ¨¡å¼" class="headerlink" title="7ï¼Œå·¥å‚æ¨¡å¼"></a>7ï¼Œå·¥å‚æ¨¡å¼</h1><h2 id="7-1-å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#7-1-å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="7.1 å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>7.1 å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p><strong>å·¥å‚æ¨¡å¼çš„å®šä¹‰</strong>ï¼šå®šä¹‰ä¸€ä¸ªåˆ›å»ºäº§å“å¯¹è±¡çš„å·¥å‚æ¥å£ï¼Œå°†äº§å“å¯¹è±¡çš„å®é™…åˆ›å»ºå·¥ä½œæ¨è¿Ÿåˆ°å…·ä½“å­å·¥å‚ç±»å½“ä¸­ã€‚è¿™æ»¡è¶³åˆ›å»ºå‹æ¨¡å¼ä¸­æ‰€è¦æ±‚çš„â€œåˆ›å»ºä¸ä½¿ç”¨ç›¸åˆ†ç¦»â€çš„ç‰¹ç‚¹ã€‚</p>
<p>æŒ‰å®é™…ä¸šåŠ¡åœºæ™¯åˆ’åˆ†ï¼Œå·¥å‚æ¨¡å¼æœ‰ 3 ç§ä¸åŒçš„å®ç°æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ç®€å•å·¥å‚æ¨¡å¼ã€å·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼ã€‚</p>
<p>æˆ‘ä»¬æŠŠè¢«åˆ›å»ºçš„å¯¹è±¡ç§°ä¸ºâ€œäº§å“â€ï¼ŒæŠŠåˆ›å»ºäº§å“çš„å¯¹è±¡ç§°ä¸ºâ€œå·¥å‚â€ã€‚å¦‚æœè¦åˆ›å»ºçš„äº§å“ä¸å¤šï¼Œåªè¦ä¸€ä¸ªå·¥å‚ç±»å°±å¯ä»¥å®Œæˆï¼Œè¿™ç§æ¨¡å¼å«â€œç®€å•å·¥å‚æ¨¡å¼â€ã€‚</p>
<p>åœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­åˆ›å»ºå®ä¾‹çš„æ–¹æ³•é€šå¸¸ä¸ºé™æ€ï¼ˆstaticï¼‰æ–¹æ³•ï¼Œå› æ­¤ç®€å•å·¥å‚æ¨¡å¼ï¼ˆSimple Factory Patternï¼‰åˆå«ä½œé™æ€å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆStatic Factory Method Patternï¼‰ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œç®€å•å·¥å‚æ¨¡å¼æœ‰ä¸€ä¸ªå…·ä½“çš„å·¥å‚ç±»ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªä¸åŒçš„äº§å“ï¼Œå±äºåˆ›å»ºå‹è®¾è®¡æ¨¡å¼ã€‚ç®€å•å·¥å‚æ¨¡å¼ä¸åœ¨ GoF 23 ç§è®¾è®¡æ¨¡å¼ä¹‹åˆ—ã€‚</p>
<p>ç®€å•å·¥å‚æ¨¡å¼æ¯å¢åŠ ä¸€ä¸ªäº§å“å°±è¦å¢åŠ ä¸€ä¸ªå…·ä½“äº§å“ç±»å’Œä¸€ä¸ªå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œè¿™å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ol>
<li>å·¥å‚ç±»åŒ…å«å¿…è¦çš„é€»è¾‘åˆ¤æ–­ï¼Œå¯ä»¥å†³å®šåœ¨ä»€ä¹ˆæ—¶å€™åˆ›å»ºå“ªä¸€ä¸ªäº§å“çš„å®ä¾‹ã€‚å®¢æˆ·ç«¯å¯ä»¥å…é™¤ç›´æ¥åˆ›å»ºäº§å“å¯¹è±¡çš„èŒè´£ï¼Œå¾ˆæ–¹ä¾¿çš„åˆ›å»ºå‡ºç›¸åº”çš„äº§å“ã€‚å·¥å‚å’Œäº§å“çš„èŒè´£åŒºåˆ†æ˜ç¡®ã€‚</li>
<li>å®¢æˆ·ç«¯æ— éœ€çŸ¥é“æ‰€åˆ›å»ºå…·ä½“äº§å“çš„ç±»åï¼Œåªéœ€çŸ¥é“å‚æ•°å³å¯ã€‚</li>
<li>ä¹Ÿå¯ä»¥å¼•å…¥é…ç½®æ–‡ä»¶ï¼Œåœ¨ä¸ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç çš„æƒ…å†µä¸‹æ›´æ¢å’Œæ·»åŠ æ–°çš„å…·ä½“äº§å“ç±»ã€‚</li>
</ol>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ol>
<li>ç®€å•å·¥å‚æ¨¡å¼çš„å·¥å‚ç±»å•ä¸€ï¼Œè´Ÿè´£æ‰€æœ‰äº§å“çš„åˆ›å»ºï¼ŒèŒè´£è¿‡é‡ï¼Œä¸€æ—¦å¼‚å¸¸ï¼Œæ•´ä¸ªç³»ç»Ÿå°†å—å½±å“ã€‚ä¸”å·¥å‚ç±»ä»£ç ä¼šéå¸¸è‡ƒè‚¿ï¼Œè¿èƒŒé«˜èšåˆåŸåˆ™ã€‚</li>
<li>ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ä¼šå¢åŠ ç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°ï¼ˆå¼•å…¥æ–°çš„å·¥å‚ç±»ï¼‰ï¼Œå¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦å’Œç†è§£éš¾åº¦</li>
<li>ç³»ç»Ÿæ‰©å±•å›°éš¾ï¼Œä¸€æ—¦å¢åŠ æ–°äº§å“ä¸å¾—ä¸ä¿®æ”¹å·¥å‚é€»è¾‘ï¼Œåœ¨äº§å“ç±»å‹è¾ƒå¤šæ—¶ï¼Œå¯èƒ½é€ æˆé€»è¾‘è¿‡äºå¤æ‚</li>
<li>ç®€å•å·¥å‚æ¨¡å¼ä½¿ç”¨äº† static å·¥å‚æ–¹æ³•ï¼Œé€ æˆå·¥å‚è§’è‰²æ— æ³•å½¢æˆåŸºäºç»§æ‰¿çš„ç­‰çº§ç»“æ„ã€‚</li>
</ol>
<h2 id="7-2-å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#7-2-å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="7.2 å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>7.2 å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><p>ç®€å•å·¥å‚æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç®€å•å·¥å‚ï¼ˆSimpleFactoryï¼‰ï¼šæ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„æ ¸å¿ƒï¼Œè´Ÿè´£å®ç°åˆ›å»ºæ‰€æœ‰å®ä¾‹çš„å†…éƒ¨é€»è¾‘ã€‚å·¥å‚ç±»çš„åˆ›å»ºäº§å“ç±»çš„æ–¹æ³•å¯ä»¥è¢«å¤–ç•Œç›´æ¥è°ƒç”¨ï¼Œåˆ›å»ºæ‰€éœ€çš„äº§å“å¯¹è±¡ã€‚</li>
<li>æŠ½è±¡äº§å“ï¼ˆProductï¼‰ï¼šæ˜¯ç®€å•å·¥å‚åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æè¿°æ‰€æœ‰å®ä¾‹å…±æœ‰çš„å…¬å…±æ¥å£ã€‚</li>
<li>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰ï¼šæ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„åˆ›å»ºç›®æ ‡ã€‚</li>
</ul>
<p><strong>Shape</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Shape</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  äº§å“æ¥å£ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Circle</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Circle</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Rectangle--&gt;ç»˜åˆ¶åœ†å½¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Rectangle</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Rectangle</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Rectangle--&gt;ç»˜åˆ¶é•¿æ–¹å½¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Square</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Square</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Rectangle--&gt;ç»˜åˆ¶æ–¹å½¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShapeFactory</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ShapeFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç®€å•å·¥å‚ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShapeFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Shape <span class="title">createShape</span><span class="params">(String shapeType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Rectangle&quot;</span>.equalsIgnoreCase(shapeType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Rectangle();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Circle&quot;</span>.equalsIgnoreCase(shapeType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Circle();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Square&quot;</span>.equalsIgnoreCase(shapeType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Square();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShapeFactoryTest</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ShapeFactoryTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç®€å•å·¥å‚æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShapeFactoryTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Shape rectangle = ShapeFactory.createShape(<span class="string">&quot;Rectangle&quot;</span>);</span><br><span class="line">        rectangle.draw();</span><br><span class="line"></span><br><span class="line">        Shape circle = ShapeFactory.createShape(<span class="string">&quot;Circle&quot;</span>);</span><br><span class="line">        circle.draw();</span><br><span class="line"></span><br><span class="line">        Shape square = ShapeFactory.createShape(<span class="string">&quot;Square&quot;</span>);</span><br><span class="line">        square.draw();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-01-45.png"></p>
<p><strong>Java.util.Calendar æºç ä½¿ç”¨åˆ°äº†ç®€å•å·¥å‚æ¨¡å¼</strong></p>
<h2 id="7-3-æŠ½è±¡å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#7-3-æŠ½è±¡å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="7.3 æŠ½è±¡å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>7.3 æŠ½è±¡å·¥å‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰æ˜¯å›´ç»•ä¸€ä¸ªè¶…çº§å·¥å‚åˆ›å»ºå…¶ä»–å·¥å‚ã€‚è¯¥è¶…çº§å·¥å‚åˆç§°ä¸ºå…¶ä»–å·¥å‚çš„å·¥å‚ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚åœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œæ¥å£æ˜¯è´Ÿè´£åˆ›å»ºä¸€ä¸ªç›¸å…³å¯¹è±¡çš„å·¥å‚ï¼Œä¸éœ€è¦æ˜¾å¼æŒ‡å®šå®ƒä»¬çš„ç±»ï¼Œæ¯ä¸ªç”Ÿæˆçš„å·¥å‚éƒ½èƒ½æŒ‰ç…§å·¥å‚æ¨¡å¼æä¾›å¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸€èˆ¬è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ã€‚</p>
<ul>
<li>ç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œæ¯ä¸ªå…·ä½“å·¥å‚åˆ›å»ºåŒä¸€æ—ä½†å±äºä¸åŒç­‰çº§ç»“æ„çš„äº§å“ã€‚</li>
<li>ç³»ç»Ÿä¸€æ¬¡åªå¯èƒ½æ¶ˆè´¹å…¶ä¸­æŸä¸€æ—äº§å“ï¼Œå³åŒæ—çš„äº§å“ä¸€èµ·ä½¿ç”¨ã€‚</li>
</ul>
<p><strong>ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>å¯ä»¥åœ¨ç±»çš„å†…éƒ¨å¯¹äº§å“æ—ä¸­ç›¸å…³è”çš„å¤šç­‰çº§äº§å“å…±åŒç®¡ç†ï¼Œè€Œä¸å¿…ä¸“é—¨å¼•å…¥å¤šä¸ªæ–°çš„ç±»æ¥è¿›è¡Œç®¡ç†ã€‚</li>
<li>å½“éœ€è¦äº§å“æ—æ—¶ï¼ŒæŠ½è±¡å·¥å‚å¯ä»¥ä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“çš„äº§å“ç»„ã€‚</li>
<li>æŠ½è±¡å·¥å‚å¢å¼ºäº†ç¨‹åºçš„å¯æ‰©å±•æ€§ï¼Œå½“å¢åŠ ä¸€ä¸ªæ–°çš„äº§å“æ—æ—¶ï¼Œä¸éœ€è¦ä¿®æ”¹åŸä»£ç ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™ã€‚</li>
</ul>
<p><strong>å…¶ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>å½“äº§å“æ—ä¸­éœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„äº§å“æ—¶ï¼Œæ‰€æœ‰çš„å·¥å‚ç±»éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚å¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦ã€‚</li>
</ul>
<h3 id="7-4-æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#7-4-æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="7.4 æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>7.4 æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h3><h4 id="7-4-1-æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„"><a href="#7-4-1-æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„" class="headerlink" title="7.4.1 æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„"></a>7.4.1 æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç»“æ„</h4><ol>
<li>æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œå®ƒåŒ…å«å¤šä¸ªåˆ›å»ºäº§å“çš„æ–¹æ³• newProduct()ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªä¸åŒç­‰çº§çš„äº§å“ã€‚</li>
<li>å…·ä½“å·¥å‚ï¼ˆConcrete Factoryï¼‰ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚</li>
<li>æŠ½è±¡äº§å“ï¼ˆProductï¼‰ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¤šä¸ªæŠ½è±¡äº§å“ã€‚</li>
<li>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒåŒå…·ä½“å·¥å‚ä¹‹é—´æ˜¯å¤šå¯¹ä¸€çš„å…³ç³»ã€‚</li>
</ol>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_19-59-50.png"></p>
<h4 id="7-3-2-ä»£ç å®ç°"><a href="#7-3-2-ä»£ç å®ç°" class="headerlink" title="7.3.2 ä»£ç å®ç°"></a>7.3.2 ä»£ç å®ç°</h4><p><strong>Shape</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Shape</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  äº§å“æ¥å£ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Circle</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Circle</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Rectangle--&gt;ç»˜åˆ¶åœ†å½¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Square</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Square</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Rectangle--&gt;ç»˜åˆ¶æ–¹å½¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Rectangle</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Rectangle</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Rectangle--&gt;ç»˜åˆ¶é•¿æ–¹å½¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShapeFactory</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ShapeFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç®€å•å·¥å‚ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 15:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShapeFactory</span> <span class="keyword">extends</span> <span class="title">AbstractFactory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Shape <span class="title">createShape</span><span class="params">(String shapeType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Rectangle&quot;</span>.equalsIgnoreCase(shapeType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Rectangle();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Circle&quot;</span>.equalsIgnoreCase(shapeType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Circle();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Square&quot;</span>.equalsIgnoreCase(shapeType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Square();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Color <span class="title">createColor</span><span class="params">(String colorType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Color</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Color</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  é¢œè‰²äº§å“æ¥å£ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Color</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fill</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Red</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Red</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  é¢œè‰²äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Red</span> <span class="keyword">implements</span> <span class="title">Color</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fill</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Red--&gt;å¡«å……çº¢è‰²&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Yellow</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Yellow</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é¢œè‰²äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:04</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Yellow</span> <span class="keyword">implements</span> <span class="title">Color</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fill</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Red--&gt;å¡«å……é»„è‰²&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Black</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Black</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é¢œè‰²äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:05</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Black</span> <span class="keyword">implements</span> <span class="title">Color</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fill</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Red--&gt;å¡«å……é»‘è‰²&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ColorFactory</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.factory.simplefactory.Circle;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.factory.simplefactory.Rectangle;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.factory.simplefactory.Square;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ColorFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é¢œè‰²å·¥å‚ç±»çš„ç¼–å†™</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:05</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColorFactory</span> <span class="keyword">extends</span> <span class="title">AbstractFactory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Shape <span class="title">createShape</span><span class="params">(String shapeType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Color <span class="title">createColor</span><span class="params">(String colorType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Red&quot;</span>.equalsIgnoreCase(colorType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Red();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Black&quot;</span>.equalsIgnoreCase(colorType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Black();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Yellow&quot;</span>.equalsIgnoreCase(colorType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Yellow();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>AbstractFactory</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AbstractFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº§å“å®¶æ—æŠ½è±¡ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Shape <span class="title">createShape</span><span class="params">(String shapeType)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Color <span class="title">createColor</span><span class="params">(String colorType)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>AbstractFactoryProducer</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AbstractFactoryProducer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡ç±»çš„å·¥å‚ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:10</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractFactoryProducer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AbstractFactory <span class="title">createFactory</span><span class="params">(String choice)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Shape&quot;</span>.equalsIgnoreCase(choice)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ShapeFactory();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Color&quot;</span>.equalsIgnoreCase(choice)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ColorFactory();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>AbstractFactoryProducerTest</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.factory.absfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AbstractFactoryProcucerTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡ç±»çš„å·¥å‚ç±»æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/18 16:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractFactoryProducerTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AbstractFactory shapeFactory = AbstractFactoryProducer.createFactory(<span class="string">&quot;Shape&quot;</span>);</span><br><span class="line">        <span class="keyword">assert</span> shapeFactory != <span class="keyword">null</span>;</span><br><span class="line">        Shape rectangle = shapeFactory.createShape(<span class="string">&quot;Rectangle&quot;</span>);</span><br><span class="line">        Shape circle = shapeFactory.createShape(<span class="string">&quot;Circle&quot;</span>);</span><br><span class="line">        Shape square = shapeFactory.createShape(<span class="string">&quot;Square&quot;</span>);</span><br><span class="line">        rectangle.draw();</span><br><span class="line">        circle.draw();</span><br><span class="line">        square.draw();</span><br><span class="line">        System.out.println(<span class="string">&quot;====================================&quot;</span>);</span><br><span class="line">        AbstractFactory colorFactory = AbstractFactoryProducer.createFactory(<span class="string">&quot;Color&quot;</span>);</span><br><span class="line">        Color red = colorFactory.createColor(<span class="string">&quot;Red&quot;</span>);</span><br><span class="line">        Color yellow = colorFactory.createColor(<span class="string">&quot;Yellow&quot;</span>);</span><br><span class="line">        Color black = colorFactory.createColor(<span class="string">&quot;Black&quot;</span>);</span><br><span class="line">        red.fill();</span><br><span class="line">        yellow.fill();</span><br><span class="line">        black.fill();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-02-04.png"></p>
<h3 id="7-5-æŠ½è±¡å·¥å‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#7-5-æŠ½è±¡å·¥å‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="7.5 æŠ½è±¡å·¥å‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>7.5 æŠ½è±¡å·¥å‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h3><ol>
<li>å½“éœ€è¦åˆ›å»ºçš„å¯¹è±¡æ˜¯ä¸€ç³»åˆ—ç›¸äº’å…³è”æˆ–ç›¸äº’ä¾èµ–çš„äº§å“æ—æ—¶ï¼Œå¦‚ç”µå™¨å·¥å‚ä¸­çš„ç”µè§†æœºã€æ´—è¡£æœºã€ç©ºè°ƒç­‰ã€‚</li>
<li>ç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œä½†æ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„æŸä¸€æ—äº§å“ã€‚å¦‚æœ‰äººåªå–œæ¬¢ç©¿æŸä¸€ä¸ªå“ç‰Œçš„è¡£æœå’Œé‹ã€‚</li>
<li>ç³»ç»Ÿä¸­æä¾›äº†äº§å“çš„ç±»åº“ï¼Œä¸”æ‰€æœ‰äº§å“çš„æ¥å£ç›¸åŒï¼Œå®¢æˆ·ç«¯ä¸ä¾èµ–äº§å“å®ä¾‹çš„åˆ›å»ºç»†èŠ‚å’Œå†…éƒ¨ç»“æ„ã€‚</li>
</ol>
<h1 id="8ï¼Œå»ºé€ è€…æ¨¡å¼"><a href="#8ï¼Œå»ºé€ è€…æ¨¡å¼" class="headerlink" title="8ï¼Œå»ºé€ è€…æ¨¡å¼"></a>8ï¼Œå»ºé€ è€…æ¨¡å¼</h1><h2 id="8-1-å»ºé€ è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#8-1-å»ºé€ è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="8.1 å»ºé€ è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>8.1 å»ºé€ è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>å»ºé€ è€…ï¼ˆBuilderï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>æŒ‡å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„é€ ä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º</strong>ï¼Œè¿™æ ·çš„è®¾è®¡æ¨¡å¼è¢«ç§°ä¸ºå»ºé€ è€…æ¨¡å¼ã€‚å®ƒæ˜¯å°†ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡åˆ†è§£ä¸ºå¤šä¸ªç®€å•çš„å¯¹è±¡ï¼Œç„¶åä¸€æ­¥ä¸€æ­¥æ„å»ºè€Œæˆã€‚å®ƒå°†å˜ä¸ä¸å˜ç›¸åˆ†ç¦»ï¼Œå³äº§å“çš„ç»„æˆéƒ¨åˆ†æ˜¯ä¸å˜çš„ï¼Œä½†æ¯ä¸€éƒ¨åˆ†æ˜¯å¯ä»¥çµæ´»é€‰æ‹©çš„ã€‚</p>
<p><strong>è¯¥æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li>å°è£…æ€§å¥½ï¼Œæ„å»ºå’Œè¡¨ç¤ºåˆ†ç¦»ã€‚</li>
<li>æ‰©å±•æ€§å¥½ï¼Œå„ä¸ªå…·ä½“çš„å»ºé€ è€…ç›¸äº’ç‹¬ç«‹ï¼Œæœ‰åˆ©äºç³»ç»Ÿçš„è§£è€¦ã€‚</li>
<li>å®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œå»ºé€ è€…å¯ä»¥å¯¹åˆ›å»ºè¿‡ç¨‹é€æ­¥ç»†åŒ–ï¼Œè€Œä¸å¯¹å…¶å®ƒæ¨¡å—äº§ç”Ÿä»»ä½•å½±å“ï¼Œä¾¿äºæ§åˆ¶ç»†èŠ‚é£é™©ã€‚</li>
</ol>
<p><strong>å…¶ç¼ºç‚¹å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li>äº§å“çš„ç»„æˆéƒ¨åˆ†å¿…é¡»ç›¸åŒï¼Œè¿™é™åˆ¶äº†å…¶ä½¿ç”¨èŒƒå›´ã€‚</li>
<li>å¦‚æœäº§å“çš„å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œå¦‚æœäº§å“å†…éƒ¨å‘ç”Ÿå˜åŒ–ï¼Œåˆ™å»ºé€ è€…ä¹Ÿè¦åŒæ­¥ä¿®æ”¹ï¼ŒåæœŸç»´æŠ¤æˆæœ¬è¾ƒå¤§ã€‚</li>
</ol>
<h2 id="8-2-å»ºé€ è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#8-2-å»ºé€ è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="8.2 å»ºé€ è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>8.2 å»ºé€ è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="8-2-1-å»ºé€ è€…æ¨¡å¼çš„ç»“æ„"><a href="#8-2-1-å»ºé€ è€…æ¨¡å¼çš„ç»“æ„" class="headerlink" title="8.2.1 å»ºé€ è€…æ¨¡å¼çš„ç»“æ„"></a>8.2.1 å»ºé€ è€…æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>äº§å“è§’è‰²ï¼ˆProductï¼‰ï¼šå®ƒæ˜¯åŒ…å«å¤šä¸ªç»„æˆéƒ¨ä»¶çš„å¤æ‚å¯¹è±¡ï¼Œç”±å…·ä½“å»ºé€ è€…æ¥åˆ›å»ºå…¶å„ä¸ªé›¶éƒ¨ä»¶ã€‚</li>
<li>æŠ½è±¡å»ºé€ è€…ï¼ˆBuilderï¼‰ï¼šå®ƒæ˜¯ä¸€ä¸ªåŒ…å«åˆ›å»ºäº§å“å„ä¸ªå­éƒ¨ä»¶çš„æŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œé€šå¸¸è¿˜åŒ…å«ä¸€ä¸ªè¿”å›å¤æ‚äº§å“çš„æ–¹æ³• getResult()ã€‚</li>
<li>å…·ä½“å»ºé€ è€…(Concrete Builderï¼‰ï¼šå®ç° Builder æ¥å£ï¼Œå®Œæˆå¤æ‚äº§å“çš„å„ä¸ªéƒ¨ä»¶çš„å…·ä½“åˆ›å»ºæ–¹æ³•ã€‚</li>
<li>æŒ‡æŒ¥è€…ï¼ˆDirectorï¼‰ï¼šå®ƒè°ƒç”¨å»ºé€ è€…å¯¹è±¡ä¸­çš„éƒ¨ä»¶æ„é€ ä¸è£…é…æ–¹æ³•å®Œæˆå¤æ‚å¯¹è±¡çš„åˆ›å»ºï¼Œåœ¨æŒ‡æŒ¥è€…ä¸­ä¸æ¶‰åŠå…·ä½“äº§å“çš„ä¿¡æ¯ã€‚</li>
</ol>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_20-14-58.png"></p>
<h3 id="8-2-2-ä»£ç å®ç°"><a href="#8-2-2-ä»£ç å®ç°" class="headerlink" title="8.2.2 ä»£ç å®ç°"></a>8.2.2 ä»£ç å®ç°</h3><p><strong>House äº§å“è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> House</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  äº§å“å®ç°ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/20 11:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">House</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String ground;</span><br><span class="line">    <span class="keyword">private</span> String wall;</span><br><span class="line">    <span class="keyword">private</span> String roofed;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">House</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">House</span><span class="params">(String ground, String wall, String roofed)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ground = ground;</span><br><span class="line">        <span class="keyword">this</span>.wall = wall;</span><br><span class="line">        <span class="keyword">this</span>.roofed = roofed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGround</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ground;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGround</span><span class="params">(String ground)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ground = ground;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wall;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWall</span><span class="params">(String wall)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.wall = wall;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRoofed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roofed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoofed</span><span class="params">(String roofed)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roofed = roofed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;House&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;ground=&#x27;&quot;</span> + ground + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, wall=&#x27;&quot;</span> + wall + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, roofed=&#x27;&quot;</span> + roofed + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HouseBuilder æŠ½è±¡å»ºé€ è€…</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HouseBuilder</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡å»ºé€ è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/20 11:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºäº§å“å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">protected</span> House house = <span class="keyword">new</span> House();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”Ÿäº§äº§å“æµç¨‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildGround</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildRoofed</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›äº§å“å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">getHouse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> house;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HighHouse å…·ä½“å»ºé€ è€…</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HighHouse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“å»ºé€ è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/20 11:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HighHouse</span> <span class="keyword">extends</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildGround</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setGround(<span class="string">&quot;100å¹³&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;é«˜æ¥¼ï¼šæ‰“åœ°åŸº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setWall(<span class="string">&quot;50ç±³&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;é«˜æ¥¼ï¼šç Œå¢™50ç±³&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoofed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setRoofed(<span class="string">&quot;å¤©çª—&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ«å¢…ï¼šç›–å¤©çª—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>VillaHouse å…·ä½“å»ºé€ è€…</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> VillaHouse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å…·ä½“å»ºé€ è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/20 11:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VillaHouse</span> <span class="keyword">extends</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildGround</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setGround(<span class="string">&quot;200å¹³&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ«å¢…ï¼šæ‰“åœ°åŸº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setWall(<span class="string">&quot;10ç±³&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ«å¢…ï¼šç Œå¢™10ç±³&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoofed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setRoofed(<span class="string">&quot;å¤©èŠ±æ¿&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ«å¢…ï¼šç›–å¤©èŠ±æ¿&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HouseDirector æŒ‡æŒ¥è€…</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HouseDirector</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å·¥ç¨‹æŒ‡æŒ¥è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/20 11:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseDirector</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> HouseBuilder houseBuilder;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HouseDirector</span><span class="params">(HouseBuilder houseBuilder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.houseBuilder = houseBuilder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        houseBuilder.buildGround();</span><br><span class="line">        houseBuilder.buildWall();</span><br><span class="line">        houseBuilder.buildRoofed();</span><br><span class="line">        <span class="keyword">return</span> houseBuilder.getHouse();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  äº§å“è¯•ç”¨å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/20 11:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        House house1 = <span class="keyword">new</span> HouseDirector(<span class="keyword">new</span> VillaHouse()).build();</span><br><span class="line">        System.out.println(house1);</span><br><span class="line">        System.out.println(<span class="string">&quot;============================================&quot;</span>);</span><br><span class="line">        House house2 = <span class="keyword">new</span> HouseDirector(<span class="keyword">new</span> HighHouse()).build();</span><br><span class="line">        System.out.println(house2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-06-26.png"></p>
<h2 id="8-3-å»ºé€ è€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#8-3-å»ºé€ è€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="8.3 å»ºé€ è€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>8.3 å»ºé€ è€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ul>
<li>ç›¸åŒçš„æ–¹æ³•ï¼Œä¸åŒçš„æ‰§è¡Œé¡ºåºï¼Œäº§ç”Ÿä¸åŒçš„ç»“æœã€‚</li>
<li>å¤šä¸ªéƒ¨ä»¶æˆ–é›¶ä»¶ï¼Œéƒ½å¯ä»¥è£…é…åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯äº§ç”Ÿçš„ç»“æœåˆä¸ç›¸åŒã€‚</li>
<li>äº§å“ç±»éå¸¸å¤æ‚ï¼Œæˆ–è€…äº§å“ç±»ä¸­ä¸åŒçš„è°ƒç”¨é¡ºåºäº§ç”Ÿä¸åŒçš„ä½œç”¨ã€‚</li>
<li>åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ç‰¹åˆ«å¤æ‚ï¼Œå‚æ•°å¤šï¼Œè€Œä¸”å¾ˆå¤šå‚æ•°éƒ½å…·æœ‰é»˜è®¤å€¼ã€‚</li>
</ul>
<h1 id="9ï¼Œåˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”"><a href="#9ï¼Œåˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”" class="headerlink" title="9ï¼Œåˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”"></a>9ï¼Œåˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”</h1><h3 id="9-1-å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"><a href="#9-1-å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼" class="headerlink" title="9.1  å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"></a>9.1  å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼</h3><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ³¨é‡çš„æ˜¯<strong>æ•´ä½“å¯¹è±¡çš„åˆ›å»ºæ–¹å¼</strong>ï¼›è€Œå»ºé€ è€…æ¨¡å¼æ³¨é‡çš„æ˜¯<strong>éƒ¨ä»¶æ„å»ºçš„è¿‡ç¨‹</strong>ï¼Œæ„åœ¨é€šè¿‡ä¸€æ­¥ä¸€æ­¥åœ°ç²¾ç¡®æ„é€ åˆ›å»ºå‡ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚</p>
<p>æˆ‘ä»¬ä¸¾ä¸ªç®€å•ä¾‹å­æ¥è¯´æ˜ä¸¤è€…çš„å·®å¼‚ï¼Œå¦‚è¦åˆ¶é€ ä¸€ä¸ªè¶…äººï¼Œå¦‚æœä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œç›´æ¥äº§ç”Ÿå‡ºæ¥çš„å°±æ˜¯ä¸€ä¸ªåŠ›å¤§æ— ç©·ã€èƒ½å¤Ÿé£ç¿”ã€å†…è£¤å¤–ç©¿çš„è¶…äººï¼›è€Œå¦‚æœä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œåˆ™éœ€è¦ç»„è£…æ‰‹ã€å¤´ã€è„šã€èº¯å¹²ç­‰éƒ¨åˆ†ï¼Œç„¶åå†æŠŠå†…è£¤å¤–ç©¿ï¼Œäºæ˜¯ä¸€ä¸ªè¶…äººå°±è¯ç”Ÿäº†ã€‚</p>
<h3 id="9-2-æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"><a href="#9-2-æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼" class="headerlink" title="9.2 æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"></a>9.2 æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼å®ç°å¯¹äº§å“å®¶æ—çš„åˆ›å»ºï¼Œä¸€ä¸ªäº§å“å®¶æ—æ˜¯è¿™æ ·çš„ä¸€ç³»åˆ—äº§å“ï¼šå…·æœ‰ä¸åŒåˆ†ç±»ç»´åº¦çš„äº§å“ç»„åˆï¼Œé‡‡ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼åˆ™æ˜¯ä¸éœ€è¦å…³å¿ƒæ„å»ºè¿‡ç¨‹ï¼Œåªå…³å¿ƒä»€ä¹ˆäº§å“ç”±ä»€ä¹ˆå·¥å‚ç”Ÿäº§å³å¯ã€‚</p>
<p>å»ºé€ è€…æ¨¡å¼åˆ™æ˜¯è¦æ±‚æŒ‰ç…§æŒ‡å®šçš„è“å›¾å»ºé€ äº§å“ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡ç»„è£…é›¶é…ä»¶è€Œäº§ç”Ÿä¸€ä¸ªæ–°äº§å“ã€‚</p>
<p>å¦‚æœå°†æŠ½è±¡å·¥å‚æ¨¡å¼çœ‹æˆæ±½è½¦é…ä»¶ç”Ÿäº§å·¥å‚ï¼Œç”Ÿäº§ä¸€ä¸ªäº§å“æ—çš„äº§å“ï¼Œé‚£ä¹ˆå»ºé€ è€…æ¨¡å¼å°±æ˜¯ä¸€ä¸ªæ±½è½¦ç»„è£…å·¥å‚ï¼Œé€šè¿‡å¯¹éƒ¨ä»¶çš„ç»„è£…å¯ä»¥è¿”å›ä¸€è¾†å®Œæ•´çš„æ±½è½¦ã€‚</p>
<ul>
<li>å»ºé€ è€…æ¨¡å¼<strong>æ›´åŠ æ³¨é‡æ–¹æ³•çš„è°ƒç”¨é¡ºåº</strong>ï¼Œå·¥å‚æ¨¡å¼<strong>æ³¨é‡åˆ›å»ºå¯¹è±¡</strong>ã€‚</li>
<li>åˆ›å»ºå¯¹è±¡çš„åŠ›åº¦ä¸åŒï¼Œå»ºé€ è€…æ¨¡å¼åˆ›å»ºå¤æ‚çš„å¯¹è±¡ï¼Œç”±å„ç§å¤æ‚çš„éƒ¨ä»¶ç»„æˆï¼Œå·¥å‚æ¨¡å¼åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡éƒ½ä¸€æ ·</li>
<li>å…³æ³¨é‡ç‚¹ä¸ä¸€æ ·ï¼Œå·¥å‚æ¨¡å¼åªéœ€è¦æŠŠå¯¹è±¡åˆ›å»ºå‡ºæ¥å°±å¯ä»¥äº†ï¼Œè€Œå»ºé€ è€…æ¨¡å¼ä¸ä»…è¦åˆ›å»ºå‡ºå¯¹è±¡ï¼Œè¿˜è¦çŸ¥é“å¯¹è±¡ç”±å“ªäº›éƒ¨ä»¶ç»„æˆã€‚</li>
<li>å»ºé€ è€…æ¨¡å¼æ ¹æ®å»ºé€ è¿‡ç¨‹ä¸­çš„é¡ºåºä¸ä¸€æ ·ï¼Œæœ€ç»ˆå¯¹è±¡éƒ¨ä»¶ç»„æˆä¹Ÿä¸ä¸€æ ·ã€‚</li>
</ul>
<h1 id="10ï¼Œé€‚é…å™¨æ¨¡å¼"><a href="#10ï¼Œé€‚é…å™¨æ¨¡å¼" class="headerlink" title="10ï¼Œé€‚é…å™¨æ¨¡å¼"></a>10ï¼Œé€‚é…å™¨æ¨¡å¼</h1><h2 id="10-1-é€‚é…å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#10-1-é€‚é…å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="10.1 é€‚é…å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>10.1 é€‚é…å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰çš„å®šä¹‰å¦‚ä¸‹ï¼š<strong>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»èƒ½ä¸€èµ·å·¥ä½œã€‚</strong>é€‚é…å™¨æ¨¡å¼åˆ†ä¸ºç±»ç»“æ„å‹æ¨¡å¼å’Œå¯¹è±¡ç»“æ„å‹æ¨¡å¼ä¸¤ç§ï¼Œå‰è€…ç±»ä¹‹é—´çš„è€¦åˆåº¦æ¯”åè€…é«˜ã€‚</p>
<p><strong>è¯¥æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>å®¢æˆ·ç«¯é€šè¿‡é€‚é…å™¨å¯ä»¥é€æ˜åœ°è°ƒç”¨ç›®æ ‡æ¥å£ã€‚</li>
<li>å¤ç”¨äº†ç°å­˜çš„ç±»ï¼Œç¨‹åºå‘˜ä¸éœ€è¦ä¿®æ”¹åŸæœ‰ä»£ç è€Œé‡ç”¨ç°æœ‰çš„é€‚é…è€…ç±»ã€‚</li>
<li>å°†ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»è§£è€¦ï¼Œè§£å†³äº†ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»æ¥å£ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li>
<li>åœ¨å¾ˆå¤šä¸šåŠ¡åœºæ™¯ä¸­ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li>
</ul>
<p><strong>å…¶ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>é€‚é…å™¨ç¼–å†™è¿‡ç¨‹éœ€è¦ç»“åˆä¸šåŠ¡åœºæ™¯å…¨é¢è€ƒè™‘ï¼Œå¯èƒ½ä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</li>
<li>å¢åŠ ä»£ç é˜…è¯»éš¾åº¦ï¼Œé™ä½ä»£ç å¯è¯»æ€§ï¼Œè¿‡å¤šä½¿ç”¨é€‚é…å™¨ä¼šä½¿ç³»ç»Ÿä»£ç å˜å¾—å‡Œä¹±ã€‚</li>
</ul>
<h2 id="10-2-é€‚é…å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#10-2-é€‚é…å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="10.2 é€‚é…å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>10.2 é€‚é…å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="10-2-1-é€‚é…å™¨æ¨¡å¼çš„ç»“æ„"><a href="#10-2-1-é€‚é…å™¨æ¨¡å¼çš„ç»“æ„" class="headerlink" title="10.2.1 é€‚é…å™¨æ¨¡å¼çš„ç»“æ„"></a>10.2.1 é€‚é…å™¨æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>ç›®æ ‡ï¼ˆTargetï¼‰æ¥å£ï¼šå½“å‰ç³»ç»Ÿä¸šåŠ¡æ‰€æœŸå¾…çš„æ¥å£ï¼Œå®ƒå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–æ¥å£ã€‚</li>
<li>é€‚é…è€…ï¼ˆAdapteeï¼‰ç±»ï¼šå®ƒæ˜¯è¢«è®¿é—®å’Œé€‚é…çš„ç°å­˜ç»„ä»¶åº“ä¸­çš„ç»„ä»¶æ¥å£ã€‚</li>
<li>é€‚é…å™¨ï¼ˆAdapterï¼‰ç±»ï¼šå®ƒæ˜¯ä¸€ä¸ªè½¬æ¢å™¨ï¼Œé€šè¿‡ç»§æ‰¿æˆ–å¼•ç”¨é€‚é…è€…çš„å¯¹è±¡ï¼ŒæŠŠé€‚é…è€…æ¥å£è½¬æ¢æˆç›®æ ‡æ¥å£ï¼Œè®©å®¢æˆ·æŒ‰ç›®æ ‡æ¥å£çš„æ ¼å¼è®¿é—®é€‚é…è€…ã€‚</li>
</ol>
<h3 id="10-2-2-ä»£ç å®ç°"><a href="#10-2-2-ä»£ç å®ç°" class="headerlink" title="10.2.2 ä»£ç å®ç°"></a>10.2.2 ä»£ç å®ç°</h3><h4 id="10-2-2-1ç±»é€‚é…å™¨æ¨¡å¼"><a href="#10-2-2-1ç±»é€‚é…å™¨æ¨¡å¼" class="headerlink" title="10.2.2.1ç±»é€‚é…å™¨æ¨¡å¼"></a>10.2.2.1<strong>ç±»é€‚é…å™¨æ¨¡å¼</strong></h4><p><strong>Voltage5V ç›®æ ‡æ¥å£</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Voltage5V</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å®šä¹‰ç›´æµç”µ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Voltage5V</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªæ ‡å‡†å……ç”µå™¨æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Voltage220V</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Voltage220V</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åˆ›å»ºäº¤æµç”µ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Voltage220V</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output220V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;voltage è¾“å‡º220ä¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">220</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>VoltageAdapter</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> VoltageAdapter</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åˆ›å»ºå……ç”µå™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VoltageAdapter</span> <span class="keyword">extends</span> <span class="title">Voltage220V</span> <span class="keyword">implements</span> <span class="title">Voltage5V</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–äº¤æµç”µ220V</span></span><br><span class="line">        <span class="keyword">int</span> output220V = output220V();</span><br><span class="line">        <span class="comment">//è½¬ä¸º5V</span></span><br><span class="line">        <span class="keyword">int</span> output5V = output220V / <span class="number">44</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;VoltageAdapter è¾“å‡º5ä¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> output5V;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Phone</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Phone</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ‰‹æœºç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">charging</span><span class="params">(Voltage5V voltage5V)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (voltage5V.output5V() == <span class="number">5</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”µå‹5ä¼ï¼Œå¯ä»¥å……ç”µ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (voltage5V.output5V() &gt; <span class="number">5</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”µå‹è¿‡å¤§ï¼Œä¸å¯ä»¥å……ç”µ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å®¢æˆ·ç«¯ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==ç±»é€‚é…å™¨==&quot;</span>);</span><br><span class="line">        Phone phone = <span class="keyword">new</span> Phone();</span><br><span class="line">        phone.charging(<span class="keyword">new</span> VoltageAdapter());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-07-10.png"></p>
<p><strong>ç±»é€‚é…å™¨æ¨¡å¼æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚</strong></p>
<ul>
<li>Javaæ˜¯å•ç»§æ‰¿æœºåˆ¶ï¼Œæ‰€ä»¥ç±»é€‚é…å™¨éœ€è¦ç»§æ‰¿é€‚é…è€…ï¼ˆAdapteeï¼ŒæŒ‡Voltage220Vï¼‰ç±»ï¼Œè¿™ç‚¹ç®—æ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¿…é¡»è¦æ±‚ç›®æ ‡ï¼ˆTargetï¼ŒæŒ‡Voltage5Vï¼‰å¿…é¡»æ˜¯æ¥å£ï¼Œæœ‰ä¸€å®šå±€é™æ€§ï¼›</li>
<li>é€‚é…è€…Voltage220Vç±»çš„æ–¹æ³•åœ¨é€‚é…å™¨VoltageAdapterç±»ä¸­éƒ½ä¼šæš´éœ²å‡ºæ¥ï¼Œä¹Ÿå¢åŠ äº†ä½¿ç”¨çš„æˆæœ¬ã€‚ä½†æ˜¯ç”±äºå…¶ç»§æ‰¿äº†é€‚é…è€…Voltage220Vç±»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ ¹æ®éœ€æ±‚é‡å†™è¯¥ç±»çš„æ–¹æ³•ï¼Œä½¿å¾—é€‚é…å™¨VoltageAdapterç±»çš„çµæ´»æ€§å¢å¼ºäº†ã€‚</li>
</ul>
<h4 id="10-2-2-2-å¯¹è±¡é€‚é…å™¨æ¨¡å¼"><a href="#10-2-2-2-å¯¹è±¡é€‚é…å™¨æ¨¡å¼" class="headerlink" title="10.2.2.2 å¯¹è±¡é€‚é…å™¨æ¨¡å¼"></a>10.2.2.2 å¯¹è±¡é€‚é…å™¨æ¨¡å¼</h4><p><strong>Voltage5V</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Voltage5V</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å……ç”µ5V</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Voltage5V</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªæ ‡å‡†å……ç”µå™¨æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Voltage220V</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Voltage220V</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¾“å‡º220Vç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Voltage220V</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output220V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;voltage è¾“å‡º220ä¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">220</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>VoltageAdapter</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> VoltageAdapter</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é€‚é…å™¨ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VoltageAdapter</span> <span class="keyword">implements</span> <span class="title">Voltage5V</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Voltage220V voltage220V;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VoltageAdapter</span><span class="params">(Voltage220V voltage220V)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.voltage220V = voltage220V;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–äº¤æµç”µ220V</span></span><br><span class="line">        <span class="keyword">int</span> output220V = voltage220V.output220V();</span><br><span class="line">        <span class="comment">//è½¬ä¸º5V</span></span><br><span class="line">        <span class="keyword">int</span> output5V = output220V / <span class="number">44</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;VoltageAdapter è¾“å‡º5ä¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> output5V;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Phone</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Phone</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ‰‹æœºç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">charging</span><span class="params">(Voltage5V voltage5V)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (voltage5V.output5V() == <span class="number">5</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”µå‹5ä¼ï¼Œå¯ä»¥å……ç”µ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (voltage5V.output5V() &gt; <span class="number">5</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”µå‹è¿‡å¤§ï¼Œä¸å¯ä»¥å……ç”µ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å¯¹è±¡é€‚é…å™¨æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==å¯¹è±¡é€‚é…å™¨==&quot;</span>);</span><br><span class="line">        Phone phone = <span class="keyword">new</span> Phone();</span><br><span class="line">        phone.charging(<span class="keyword">new</span> VoltageAdapter(<span class="keyword">new</span> Voltage220V()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-07-31.png"></p>
<p><strong>å¯¹è±¡é€‚é…å™¨æ¨¡å¼æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚</strong></p>
<ul>
<li><p>å¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨å…¶å®ç®—æ˜¯åŒä¸€ç§æ€æƒ³ï¼Œåªä¸è¿‡å®ç°æ–¹å¼ä¸åŒã€‚ </p>
</li>
<li><p>æ ¹æ®åˆæˆå¤ç”¨åŸåˆ™ï¼Œä½¿ç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿ï¼Œ æ‰€ä»¥å®ƒè§£å†³äº†ç±»é€‚é…å™¨ä¸­VoltageAdapterå¿…é¡»ç»§æ‰¿Voltage220Vçš„å±€é™æ€§é—®é¢˜ï¼Œä¹Ÿä¸å†å¼ºåˆ¶è¦æ±‚Voltage5Vå¿…é¡»æ˜¯æ¥å£ã€‚ä½¿ç”¨æˆæœ¬æ›´ä½ï¼Œæ›´çµæ´»ã€‚å› æ­¤ï¼Œå¯¹è±¡é€‚é…å™¨æ¨¡å¼æ˜¯é€‚é…å™¨æ¨¡å¼å¸¸ç”¨çš„ä¸€ç§ã€‚</p>
</li>
</ul>
<h4 id="10-2-2-3-æ¥å£é€‚é…å™¨æ¨¡å¼"><a href="#10-2-2-3-æ¥å£é€‚é…å™¨æ¨¡å¼" class="headerlink" title="10.2.2.3 æ¥å£é€‚é…å™¨æ¨¡å¼"></a>10.2.2.3 æ¥å£é€‚é…å™¨æ¨¡å¼</h4><p><strong>Animation</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.interfaceadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Animation</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åŠ¨ç”»æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Animation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method3</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method4</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method5</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>AnimationAdapter</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.interfaceadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AnimationAdapter</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æ¥å£é€‚é…å™¨ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimationAdapter</span> <span class="keyword">implements</span> <span class="title">Animation</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å…¨éƒ¨éƒ½ç©ºå®ç°</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method3</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method4</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method5</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>JFrameAnimation</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.interfaceadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> JFrameAnimation</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é€‚é…å™¨å­ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JFrameAnimation</span> <span class="keyword">extends</span> <span class="title">AnimationAdapter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;method1()è¢«è°ƒç”¨äº†...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;method2()è¢«è°ƒç”¨äº†...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.interfaceadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å®¢æˆ·ç«¯ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrameAnimation animation = <span class="keyword">new</span> JFrameAnimation();</span><br><span class="line">        animation.method1();</span><br><span class="line">        animation.method2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-07-44.png"></p>
<h2 id="10-3-SpringMVCæºç è§£æ"><a href="#10-3-SpringMVCæºç è§£æ" class="headerlink" title="10.3 SpringMVCæºç è§£æ"></a>10.3 SpringMVCæºç è§£æ</h2><p><strong>Controller</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.springmvc;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Controller</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  springmvcçš„Controlleræºç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:53</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤šç§Controllerå®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doHttpHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;http...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSimplerHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;simple...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnnotationController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAnnotationHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;annotation...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>DispatchServlet</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.springmvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> DispatchServlet</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  springmvcçš„DispatchServletæºç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DispatchServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;HandlerAdapter&gt; handlerAdapters = <span class="keyword">new</span> ArrayList&lt;HandlerAdapter&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DispatchServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        handlerAdapters.add(<span class="keyword">new</span> AnnotationHandlerAdapter());</span><br><span class="line">        handlerAdapters.add(<span class="keyword">new</span> HttpHandlerAdapter());</span><br><span class="line">        handlerAdapters.add(<span class="keyword">new</span> SimpleHandlerAdapter());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doDispatch</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ­¤å¤„æ¨¡æ‹ŸSpringMVCä»requestå–handlerçš„å¯¹è±¡ï¼Œ</span></span><br><span class="line">        <span class="comment">// é€‚é…å™¨å¯ä»¥è·å–åˆ°å¸Œæœ›çš„Controller</span></span><br><span class="line">        HttpController controller = <span class="keyword">new</span> HttpController();</span><br><span class="line">        <span class="comment">// AnnotationController controller = new AnnotationController();</span></span><br><span class="line">        <span class="comment">//SimpleController controller = new SimpleController();</span></span><br><span class="line">        <span class="comment">// å¾—åˆ°å¯¹åº”é€‚é…å™¨</span></span><br><span class="line">        HandlerAdapter adapter = getHandler(controller);</span><br><span class="line">        <span class="comment">// é€šè¿‡é€‚é…å™¨æ‰§è¡Œå¯¹åº”çš„controllerå¯¹åº”æ–¹æ³•</span></span><br><span class="line">        adapter.handle(controller);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HandlerAdapter <span class="title">getHandler</span><span class="params">(Controller controller)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//éå†ï¼šæ ¹æ®å¾—åˆ°çš„controller(handler), è¿”å›å¯¹åº”é€‚é…å™¨</span></span><br><span class="line">        <span class="keyword">for</span> (HandlerAdapter adapter : <span class="keyword">this</span>.handlerAdapters) &#123;</span><br><span class="line">            <span class="keyword">if</span> (adapter.supports(controller)) &#123;</span><br><span class="line">                <span class="keyword">return</span> adapter;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> DispatchServlet().doDispatch(); <span class="comment">// http...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HandlerAdapter</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.adapter.springmvc;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HandlerAdapter</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  springmvcçš„HandlerAdapteræºç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/21 14:53</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///å®šä¹‰ä¸€ä¸ªAdapteræ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HandlerAdapter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šç§é€‚é…å™¨ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">        ((SimpleController) handler).doSimplerHandler();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (handler <span class="keyword">instanceof</span> SimpleController);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">        ((HttpController) handler).doHttpHandler();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (handler <span class="keyword">instanceof</span> HttpController);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnnotationHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">        ((AnnotationController) handler).doAnnotationHandler();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (handler <span class="keyword">instanceof</span> AnnotationController);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-08-41.png"></p>
<h1 id="11ï¼Œæ¡¥æ¥æ¨¡å¼"><a href="#11ï¼Œæ¡¥æ¥æ¨¡å¼" class="headerlink" title="11ï¼Œæ¡¥æ¥æ¨¡å¼"></a>11ï¼Œæ¡¥æ¥æ¨¡å¼</h1><h2 id="11-1-æ¡¥æ¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#11-1-æ¡¥æ¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="11.1 æ¡¥æ¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>11.1 æ¡¥æ¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>æ¡¥æ¥ï¼ˆBridgeï¼‰æ¨¡å¼çš„å®šä¹‰å¦‚ä¸‹ï¼š<strong>å°†æŠ½è±¡ä¸å®ç°åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚</strong>å®ƒæ˜¯ç”¨ç»„åˆå…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»æ¥å®ç°ï¼Œä»è€Œé™ä½äº†æŠ½è±¡å’Œå®ç°è¿™ä¸¤ä¸ªå¯å˜ç»´åº¦çš„è€¦åˆåº¦ã€‚</p>
<p>é€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œæˆ‘ä»¬èƒ½å¾ˆå¥½çš„æ„Ÿè§‰åˆ°æ¡¥æ¥æ¨¡å¼éµå¾ªäº†é‡Œæ°æ›¿æ¢åŸåˆ™å’Œä¾èµ–å€’ç½®åŸåˆ™ï¼Œæœ€ç»ˆå®ç°äº†å¼€é—­åŸåˆ™ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾ã€‚</p>
<p><strong>æ¡¥æ¥ï¼ˆBridgeï¼‰æ¨¡å¼çš„ä¼˜ç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>æŠ½è±¡ä¸å®ç°åˆ†ç¦»ï¼Œæ‰©å±•èƒ½åŠ›å¼º</li>
<li>ç¬¦åˆå¼€é—­åŸåˆ™</li>
<li>ç¬¦åˆåˆæˆå¤ç”¨åŸåˆ™</li>
<li>å…¶å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜</li>
</ul>
<p><strong>ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<p>ç”±äºèšåˆå…³ç³»å»ºç«‹åœ¨æŠ½è±¡å±‚ï¼Œè¦æ±‚å¼€å‘è€…é’ˆå¯¹æŠ½è±¡åŒ–è¿›è¡Œè®¾è®¡ä¸ç¼–ç¨‹ï¼Œèƒ½æ­£ç¡®åœ°è¯†åˆ«å‡ºç³»ç»Ÿä¸­ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œè¿™å¢åŠ äº†ç³»ç»Ÿçš„ç†è§£ä¸è®¾è®¡éš¾åº¦ã€‚</p>
<h2 id="11-2-æ¡¥æ¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#11-2-æ¡¥æ¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="11.2 æ¡¥æ¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>11.2 æ¡¥æ¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="11-2-1-æ¡¥æ¥æ¨¡å¼çš„ç»“æ„"><a href="#11-2-1-æ¡¥æ¥æ¨¡å¼çš„ç»“æ„" class="headerlink" title="11.2.1 æ¡¥æ¥æ¨¡å¼çš„ç»“æ„"></a>11.2.1 æ¡¥æ¥æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡åŒ–ï¼ˆAbstractionï¼‰è§’è‰²ï¼šå®šä¹‰æŠ½è±¡ç±»ï¼Œå¹¶åŒ…å«ä¸€ä¸ªå¯¹å®ç°åŒ–å¯¹è±¡çš„å¼•ç”¨ã€‚</li>
<li>æ‰©å±•æŠ½è±¡åŒ–ï¼ˆRefined Abstractionï¼‰è§’è‰²ï¼šæ˜¯æŠ½è±¡åŒ–è§’è‰²çš„å­ç±»ï¼Œå®ç°çˆ¶ç±»ä¸­çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå¹¶é€šè¿‡ç»„åˆå…³ç³»è°ƒç”¨å®ç°åŒ–è§’è‰²ä¸­çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li>
<li>å®ç°åŒ–ï¼ˆImplementorï¼‰è§’è‰²ï¼šå®šä¹‰å®ç°åŒ–è§’è‰²çš„æ¥å£ï¼Œä¾›æ‰©å±•æŠ½è±¡åŒ–è§’è‰²è°ƒç”¨ã€‚</li>
<li>å…·ä½“å®ç°åŒ–ï¼ˆConcrete Implementorï¼‰è§’è‰²ï¼šç»™å‡ºå®ç°åŒ–è§’è‰²æ¥å£çš„å…·ä½“å®ç°ã€‚</li>
</ol>
<h3 id="11-2-2-ä»£ç å®ç°"><a href="#11-2-2-ä»£ç å®ç°" class="headerlink" title="11.2.2 ä»£ç å®ç°"></a>11.2.2 ä»£ç å®ç°</h3><p><strong>Brand æŠ½è±¡åŒ–è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Brand</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å“ç‰Œç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/22 9:31</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Brand</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">call</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Vivo æ‹“å±•æŠ½è±¡åŒ–è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Vivo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ‰‹æœºå“ç‰Œ å®ç°å“ç‰Œæ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/22 9:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vivo</span> <span class="keyword">implements</span> <span class="title">Brand</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Vivoæ‰‹æœºå¼€æœº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Vivoæ‰‹æœºæ‰“ç”µè¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Vivoæ‰‹æœºå…³æœº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>XiaoMi æ‹“å±•æŠ½è±¡åŒ–è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> XiaoMi</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æ‰‹æœºå“ç‰Œ å®ç°å“ç‰Œæ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/22 9:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiaoMi</span> <span class="keyword">implements</span> <span class="title">Brand</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;XiaoMiæ‰‹æœºå¼€æœº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;XiaoMiæ‰‹æœºæ‰“ç”µè¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;XiaoMiæ‰‹æœºå…³æœº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Phone</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Phone</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æ‰‹æœºç±» æŠ½è±¡ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/22 9:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç»„åˆå“ç‰Œ</span></span><br><span class="line">    <span class="keyword">private</span> Brand brand;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ„é€ å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Phone</span><span class="params">(Brand brand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand.call();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>FoldedPhone</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FoldedPhone</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ˜å æ‰‹æœºç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/22 9:31</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FoldedPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ„é€ å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FoldedPhone</span><span class="params">(Brand brand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(brand);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">        System.out.println(<span class="string">&quot;æŠ˜å æ‰‹æœºæ ·å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.call();</span><br><span class="line">        System.out.println(<span class="string">&quot;æŠ˜å æ‰‹æœºæ ·å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;æŠ˜å æ‰‹æœºæ ·å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UpRightPhone</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> UpRightPhone</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç›´ç«‹æ‰‹æœºç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/22 9:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpRightPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ„é€ å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UpRightPhone</span><span class="params">(Brand brand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(brand);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç›´ç«‹æ‰‹æœºæ ·å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.call();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç›´ç«‹æ‰‹æœºæ ·å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç›´ç«‹æ‰‹æœºæ ·å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å®¢æˆ·ç«¯ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/22 9:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Phone phone1 = <span class="keyword">new</span> FoldedPhone(<span class="keyword">new</span> XiaoMi());</span><br><span class="line">        phone1.open();</span><br><span class="line">        phone1.call();</span><br><span class="line">        phone1.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;==============================&quot;</span>);</span><br><span class="line">        Phone phone2 = <span class="keyword">new</span> UpRightPhone(<span class="keyword">new</span> Vivo());</span><br><span class="line">        phone2.open();</span><br><span class="line">        phone2.call();</span><br><span class="line">        phone2.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-09-15.png"></p>
<h2 id="11-3-æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#11-3-æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="11.3 æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>11.3 æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><p>å½“ä¸€ä¸ªç±»å†…éƒ¨å…·å¤‡ä¸¤ç§æˆ–å¤šç§å˜åŒ–ç»´åº¦æ—¶ï¼Œä½¿ç”¨æ¡¥æ¥æ¨¡å¼å¯ä»¥è§£è€¦è¿™äº›å˜åŒ–çš„ç»´åº¦ï¼Œä½¿é«˜å±‚ä»£ç æ¶æ„ç¨³å®šã€‚</p>
<ol>
<li>å½“ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦è¿›è¡Œæ‰©å±•æ—¶ã€‚</li>
<li>å½“ä¸€ä¸ªç³»ç»Ÿä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ æ—¶ã€‚</li>
<li>å½“ä¸€ä¸ªç³»ç»Ÿéœ€è¦åœ¨æ„ä»¶çš„æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“åŒ–è§’è‰²ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§æ—¶ã€‚</li>
</ol>
<h1 id="12ï¼Œè£…é¥°å™¨æ¨¡å¼"><a href="#12ï¼Œè£…é¥°å™¨æ¨¡å¼" class="headerlink" title="12ï¼Œè£…é¥°å™¨æ¨¡å¼"></a>12ï¼Œè£…é¥°å™¨æ¨¡å¼</h1><h2 id="12-1-è£…é¥°å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#12-1-è£…é¥°å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="12.1 è£…é¥°å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>12.1 è£…é¥°å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>æŒ‡åœ¨ä¸æ”¹å˜ç°æœ‰å¯¹è±¡ç»“æ„çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åœ°ç»™è¯¥å¯¹è±¡å¢åŠ ä¸€äº›èŒè´£ï¼ˆå³å¢åŠ å…¶é¢å¤–åŠŸèƒ½ï¼‰çš„æ¨¡å¼</strong>ï¼Œå®ƒå±äºå¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚</p>
<p><strong>è£…é¥°å™¨æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹æœ‰ï¼š</strong></p>
<ul>
<li>è£…é¥°å™¨æ˜¯ç»§æ‰¿çš„æœ‰åŠ›è¡¥å……ï¼Œæ¯”ç»§æ‰¿çµæ´»ï¼Œåœ¨ä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€çš„ç»™ä¸€ä¸ªå¯¹è±¡æ‰©å±•åŠŸèƒ½ï¼Œå³æ’å³ç”¨</li>
<li>é€šè¿‡ä½¿ç”¨ä¸ç”¨è£…é¥°ç±»åŠè¿™äº›è£…é¥°ç±»çš„æ’åˆ—ç»„åˆï¼Œå¯ä»¥å®ç°ä¸åŒæ•ˆæœ</li>
<li>è£…é¥°å™¨æ¨¡å¼å®Œå…¨éµå®ˆå¼€é—­åŸåˆ™</li>
</ul>
<p><strong>å…¶ä¸»è¦ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>è£…é¥°å™¨æ¨¡å¼ä¼šå¢åŠ è®¸å¤šå­ç±»ï¼Œè¿‡åº¦ä½¿ç”¨ä¼šå¢åŠ ç¨‹åºå¾—å¤æ‚æ€§ã€‚</li>
</ul>
<h2 id="12-2-è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#12-2-è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="12.2 è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>12.2 è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ‰©å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ä¼šä½¿ç”¨ç»§æ‰¿æ–¹å¼æ¥å®ç°ã€‚ä½†ç»§æ‰¿å…·æœ‰é™æ€ç‰¹å¾ï¼Œè€¦åˆåº¦é«˜ï¼Œå¹¶ä¸”éšç€æ‰©å±•åŠŸèƒ½çš„å¢å¤šï¼Œå­ç±»ä¼šå¾ˆè†¨èƒ€ã€‚å¦‚æœä½¿ç”¨ç»„åˆå…³ç³»æ¥åˆ›å»ºä¸€ä¸ªåŒ…è£…å¯¹è±¡ï¼ˆå³è£…é¥°å¯¹è±¡ï¼‰æ¥åŒ…è£¹çœŸå®å¯¹è±¡ï¼Œå¹¶åœ¨ä¿æŒçœŸå®å¯¹è±¡çš„ç±»ç»“æ„ä¸å˜çš„å‰æä¸‹ï¼Œä¸ºå…¶æä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯è£…é¥°å™¨æ¨¡å¼çš„ç›®æ ‡</p>
<h3 id="12-2-1-è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„"><a href="#12-2-1-è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„" class="headerlink" title="12.2.1 è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„"></a>12.2.1 è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡æ„ä»¶ï¼ˆComponentï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªæŠ½è±¡æ¥å£ä»¥è§„èŒƒå‡†å¤‡æ¥æ”¶é™„åŠ è´£ä»»çš„å¯¹è±¡ã€‚</li>
<li>å…·ä½“æ„ä»¶ï¼ˆConcreteComponentï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡æ„ä»¶ï¼Œé€šè¿‡è£…é¥°è§’è‰²ä¸ºå…¶æ·»åŠ ä¸€äº›èŒè´£ã€‚</li>
<li>æŠ½è±¡è£…é¥°ï¼ˆDecoratorï¼‰è§’è‰²ï¼šç»§æ‰¿æŠ½è±¡æ„ä»¶ï¼Œå¹¶åŒ…å«å…·ä½“æ„ä»¶çš„å®ä¾‹ï¼Œå¯ä»¥é€šè¿‡å…¶å­ç±»æ‰©å±•å…·ä½“æ„ä»¶çš„åŠŸèƒ½ã€‚</li>
<li>å…·ä½“è£…é¥°ï¼ˆConcreteDecoratorï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è£…é¥°çš„ç›¸å…³æ–¹æ³•ï¼Œå¹¶ç»™å…·ä½“æ„ä»¶å¯¹è±¡æ·»åŠ é™„åŠ çš„è´£ä»»ã€‚</li>
</ol>
<h3 id="12-2-2-ä»£ç å®ç°"><a href="#12-2-2-ä»£ç å®ç°" class="headerlink" title="12.2.2 ä»£ç å®ç°"></a>12.2.2 ä»£ç å®ç°</h3><p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_20-52-56.png"></p>
<p><strong>FastFood æŠ½è±¡æ„ä»¶è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FastFood</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å¿«é¤ç±» æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/23 21:54</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">FastFood</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    <span class="keyword">private</span> String desc; <span class="comment">//æè¿°</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FastFood</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FastFood</span><span class="params">(<span class="keyword">float</span> price, String desc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDesc</span><span class="params">(String desc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŠ½è±¡æ–¹æ³•  è·å–ä»·æ ¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>FiredRice å…·ä½“æ„å»ºè§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FiredRice</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  ç‚’é¥­ç±»  ç»§æ‰¿å¿«é¤ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/23 21:54</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FiredRice</span> <span class="keyword">extends</span> <span class="title">FastFood</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FiredRice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">10</span>, <span class="string">&quot;ç‚’é¥­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>FiredNoodles å…·ä½“æ„å»ºè§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FiredNoodles</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  ç‚’é¢ç±» ç»§æ‰¿ å¿«é¤ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/23 21:54</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FiredNoodles</span> <span class="keyword">extends</span> <span class="title">FastFood</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FiredNoodles</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">15</span>, <span class="string">&quot;ç‚’é¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Garnish æŠ½è±¡è£…é¥°è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Garnish</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æŠ½è±¡é…æ–™ç±» ç»§æ‰¿å¿«é¤ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/23 21:58</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Garnish</span> <span class="keyword">extends</span> <span class="title">FastFood</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> FastFood fastFood;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FastFood <span class="title">getFastFood</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fastFood;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFastFood</span><span class="params">(FastFood fastFood)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fastFood = fastFood;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Garnish</span><span class="params">(FastFood fastFood,<span class="keyword">float</span> price,String desc)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(price,desc);</span><br><span class="line">        <span class="keyword">this</span>.fastFood = fastFood;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Egg å…·ä½“è£…é¥°è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Egg</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  é¸¡è›‹é…æ–™ç±» ç»§æ‰¿é…æ–™ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/23 21:55</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Egg</span> <span class="keyword">extends</span> <span class="title">Garnish</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Egg</span><span class="params">(FastFood fastFood)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//é¸¡è›‹1å…ƒ</span></span><br><span class="line">        <span class="keyword">super</span>(fastFood, <span class="number">1</span>, <span class="string">&quot;é¸¡è›‹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice() + getFastFood().getPrice();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getDesc() + getFastFood().getDesc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Bacon å…·ä½“è£…é¥°è§’è‰²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Bacon</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  åŸ¹æ ¹ç±» ç»§æ‰¿é…æ–™ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/23 22:03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bacon</span> <span class="keyword">extends</span> <span class="title">Garnish</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bacon</span><span class="params">(FastFood fastFood)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åŸ¹æ ¹2å…ƒ</span></span><br><span class="line">        <span class="keyword">super</span>(fastFood, <span class="number">2</span>, <span class="string">&quot;åŸ¹æ ¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice() + getFastFood().getPrice();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getDesc() + getFastFood().getDesc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  è£…é¥°å™¨æ¨¡å¼æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/23 21:53</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½ç‚’é¥­</span></span><br><span class="line">        FastFood rice = <span class="keyword">new</span> FiredRice();</span><br><span class="line">        <span class="comment">//ä»·æ ¼</span></span><br><span class="line">        System.out.println(rice.getDesc() + <span class="string">&quot;--&gt;&quot;</span> + rice.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=============================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½åŠ é¸¡è›‹çš„ç‚’é¥­</span></span><br><span class="line">        FastFood eggRice = <span class="keyword">new</span> FiredRice();</span><br><span class="line">        <span class="comment">//åŠ é¸¡è›‹</span></span><br><span class="line">        eggRice = <span class="keyword">new</span> Egg(eggRice);</span><br><span class="line">        System.out.println(eggRice.getDesc() + <span class="string">&quot;--&gt;&quot;</span> + eggRice.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=============================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½åŠ åŸ¹æ ¹çš„ç‚’é¢</span></span><br><span class="line">        FastFood baconNoodles = <span class="keyword">new</span> FiredNoodles();</span><br><span class="line">        <span class="comment">//åŠ åŸ¹æ ¹</span></span><br><span class="line">        baconNoodles = <span class="keyword">new</span> Bacon(baconNoodles);</span><br><span class="line">        System.out.println(baconNoodles.getDesc() + <span class="string">&quot;--&gt;&quot;</span> + baconNoodles.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-09-51.png"></p>
<h2 id="12-3-è£…é¥°å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#12-3-è£…é¥°å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="12.3 è£…é¥°å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>12.3 è£…é¥°å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ul>
<li><p>å½“ä¸èƒ½é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼å¯¹ç³»ç»Ÿè¿›è¡Œæ‰©å……æˆ–è€…é‡‡ç”¨ç»§æ‰¿ä¸åˆ©äºç³»ç»Ÿæ‰©å±•å’Œç»´æŠ¤æ—¶ã€‚</p>
<p>ä¸èƒ½é‡‡ç”¨ç»§æ‰¿çš„æƒ…å†µä¸»è¦æœ‰ä¸¤ç±»ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç±»æ˜¯ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡ç‹¬ç«‹çš„æ‰©å±•ï¼Œä¸ºæ”¯æŒæ¯ä¸€ç§ç»„åˆå°†äº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œä½¿å¾—å­ç±»æ•°ç›®å‘ˆçˆ†ç‚¸æ€§å¢é•¿ï¼›</li>
<li>ç¬¬äºŒç±»æ˜¯å› ä¸ºç±»å®šä¹‰ä¸èƒ½ç»§æ‰¿ï¼ˆå¦‚finalç±»ï¼‰</li>
</ul>
</li>
<li><p>åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä»¥åŠ¨æ€ã€é€æ˜çš„æ–¹å¼ç»™å•ä¸ªå¯¹è±¡æ·»åŠ èŒè´£ã€‚</p>
</li>
<li><p>å½“å¯¹è±¡çš„åŠŸèƒ½è¦æ±‚å¯ä»¥åŠ¨æ€åœ°æ·»åŠ ï¼Œä¹Ÿå¯ä»¥å†åŠ¨æ€åœ°æ’¤é”€æ—¶ã€‚</p>
</li>
</ul>
<h2 id="12-4-JDKæºç è§£æ"><a href="#12-4-JDKæºç è§£æ" class="headerlink" title="12.4 JDKæºç è§£æ"></a>12.4 JDKæºç è§£æ</h2><p>IOæµä¸­çš„åŒ…è£…ç±»ä½¿ç”¨åˆ°äº†è£…é¥°è€…æ¨¡å¼ã€‚BufferedInputStreamï¼ŒBufferedOutputStreamï¼ŒBufferedReaderï¼ŒBufferedWriterã€‚</p>
<p>æˆ‘ä»¬ä»¥BufferedWriterä¸¾ä¾‹æ¥è¯´æ˜ï¼Œå…ˆçœ‹çœ‹å¦‚ä½•ä½¿ç”¨BufferedWriter</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºBufferedWriterå¯¹è±¡</span></span><br><span class="line">        <span class="comment">//åˆ›å»ºFileWriterå¯¹è±¡</span></span><br><span class="line">        FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">&quot;C:\\Users\\dell\\Desktop\\a.txt&quot;</span>);</span><br><span class="line">        BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(fw);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å†™æ•°æ®</span></span><br><span class="line">        bw.write(<span class="string">&quot;hello Buffered&quot;</span>);</span><br><span class="line"></span><br><span class="line">        bw.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æ„</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_20-59-18.png"></p>
<p><strong>BufferedWriterä½¿ç”¨è£…é¥°è€…æ¨¡å¼å¯¹Writerå­å®ç°ç±»è¿›è¡Œäº†å¢å¼ºï¼Œæ·»åŠ äº†ç¼“å†²åŒºï¼Œæé«˜äº†å†™æ•°æ®çš„æ•ˆç‡ã€‚</strong></p>
<p>é™æ€ä»£ç†å’Œè£…é¥°è€…æ¨¡å¼çš„åŒºåˆ«ï¼š</p>
<ul>
<li>ç›¸åŒç‚¹ï¼š<ul>
<li>éƒ½è¦å®ç°ä¸ç›®æ ‡ç±»ç›¸åŒçš„ä¸šåŠ¡æ¥å£</li>
<li>åœ¨ä¸¤ä¸ªç±»ä¸­éƒ½è¦å£°æ˜ç›®æ ‡å¯¹è±¡</li>
<li>éƒ½å¯ä»¥åœ¨ä¸ä¿®æ”¹ç›®æ ‡ç±»çš„å‰æä¸‹å¢å¼ºç›®æ ‡æ–¹æ³•</li>
</ul>
</li>
<li>ä¸åŒç‚¹ï¼š<ul>
<li>ç›®çš„ä¸åŒ è£…é¥°è€…æ˜¯ä¸ºäº†å¢å¼ºç›®æ ‡å¯¹è±¡ é™æ€ä»£ç†æ˜¯ä¸ºäº†ä¿æŠ¤å’Œéšè—ç›®æ ‡å¯¹è±¡</li>
<li>è·å–ç›®æ ‡å¯¹è±¡æ„å»ºçš„åœ°æ–¹ä¸åŒ è£…é¥°è€…æ˜¯ç”±å¤–ç•Œä¼ é€’è¿›æ¥ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•ä¼ é€’ é™æ€ä»£ç†æ˜¯åœ¨ä»£ç†ç±»å†…éƒ¨åˆ›å»ºï¼Œä»¥æ­¤æ¥éšè—ç›®æ ‡å¯¹è±¡</li>
</ul>
</li>
</ul>
<h1 id="13ï¼Œå¤–è§‚æ¨¡å¼"><a href="#13ï¼Œå¤–è§‚æ¨¡å¼" class="headerlink" title="13ï¼Œå¤–è§‚æ¨¡å¼"></a>13ï¼Œå¤–è§‚æ¨¡å¼</h1><h2 id="13-1-å¤–è§‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#13-1-å¤–è§‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="13.1 å¤–è§‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>13.1 å¤–è§‚æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>å¤–è§‚ï¼ˆFacadeï¼‰æ¨¡å¼åˆå«ä½œé—¨é¢æ¨¡å¼ï¼Œ<strong>æ˜¯ä¸€ç§é€šè¿‡ä¸ºå¤šä¸ªå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ä¸ªä¸€è‡´çš„æ¥å£ï¼Œè€Œä½¿è¿™äº›å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“è¢«è®¿é—®çš„æ¨¡å¼ã€‚</strong>è¯¥æ¨¡å¼å¯¹å¤–æœ‰ä¸€ä¸ªç»Ÿä¸€æ¥å£ï¼Œå¤–éƒ¨åº”ç”¨ç¨‹åºä¸ç”¨å…³å¿ƒå†…éƒ¨å­ç³»ç»Ÿçš„å…·ä½“ç»†èŠ‚ï¼Œè¿™æ ·ä¼šå¤§å¤§é™ä½åº”ç”¨ç¨‹åºçš„å¤æ‚åº¦ï¼Œæé«˜äº†ç¨‹åºçš„å¯ç»´æŠ¤æ€§ã€‚</p>
<p>å¤–è§‚ï¼ˆFacadeï¼‰æ¨¡å¼æ˜¯â€œè¿ªç±³ç‰¹æ³•åˆ™â€çš„å…¸å‹åº”ç”¨ï¼Œ<strong>å®ƒæœ‰ä»¥ä¸‹ä¸»è¦ä¼˜ç‚¹ã€‚</strong></p>
<ol>
<li>é™ä½äº†å­ç³»ç»Ÿä¸å®¢æˆ·ç«¯ä¹‹é—´çš„è€¦åˆåº¦ï¼Œä½¿å¾—å­ç³»ç»Ÿçš„å˜åŒ–ä¸ä¼šå½±å“è°ƒç”¨å®ƒçš„å®¢æˆ·ç±»ã€‚</li>
<li>å¯¹å®¢æˆ·å±è”½äº†å­ç³»ç»Ÿç»„ä»¶ï¼Œå‡å°‘äº†å®¢æˆ·å¤„ç†çš„å¯¹è±¡æ•°ç›®ï¼Œå¹¶ä½¿å¾—å­ç³»ç»Ÿä½¿ç”¨èµ·æ¥æ›´åŠ å®¹æ˜“ã€‚</li>
<li>é™ä½äº†å¤§å‹è½¯ä»¶ç³»ç»Ÿä¸­çš„ç¼–è¯‘ä¾èµ–æ€§ï¼Œç®€åŒ–äº†ç³»ç»Ÿåœ¨ä¸åŒå¹³å°ä¹‹é—´çš„ç§»æ¤è¿‡ç¨‹ï¼Œå› ä¸ºç¼–è¯‘ä¸€ä¸ªå­ç³»ç»Ÿä¸ä¼šå½±å“å…¶ä»–çš„å­ç³»ç»Ÿï¼Œä¹Ÿä¸ä¼šå½±å“å¤–è§‚å¯¹è±¡ã€‚</li>
</ol>
<p><strong>å¤–è§‚ï¼ˆFacadeï¼‰æ¨¡å¼çš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>ä¸èƒ½å¾ˆå¥½åœ°é™åˆ¶å®¢æˆ·ä½¿ç”¨å­ç³»ç»Ÿç±»ï¼Œå¾ˆå®¹æ˜“å¸¦æ¥æœªçŸ¥é£é™©ã€‚</li>
<li>å¢åŠ æ–°çš„å­ç³»ç»Ÿå¯èƒ½éœ€è¦ä¿®æ”¹å¤–è§‚ç±»æˆ–å®¢æˆ·ç«¯çš„æºä»£ç ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</li>
</ol>
<h2 id="13-2-å¤–è§‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#13-2-å¤–è§‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="13.2 å¤–è§‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>13.2 å¤–è§‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="13-2-1-å¤–è§‚æ¨¡å¼çš„ç»“æ„"><a href="#13-2-1-å¤–è§‚æ¨¡å¼çš„ç»“æ„" class="headerlink" title="13.2.1 å¤–è§‚æ¨¡å¼çš„ç»“æ„"></a>13.2.1 å¤–è§‚æ¨¡å¼çš„ç»“æ„</h3><p>å¤–è§‚ï¼ˆFacadeï¼‰æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ã€‚</p>
<ol>
<li>å¤–è§‚ï¼ˆFacadeï¼‰è§’è‰²ï¼šä¸ºå¤šä¸ªå­ç³»ç»Ÿå¯¹å¤–æä¾›ä¸€ä¸ªå…±åŒçš„æ¥å£ã€‚</li>
<li>å­ç³»ç»Ÿï¼ˆSub Systemï¼‰è§’è‰²ï¼šå®ç°ç³»ç»Ÿçš„éƒ¨åˆ†åŠŸèƒ½ï¼Œå®¢æˆ·å¯ä»¥é€šè¿‡å¤–è§‚è§’è‰²è®¿é—®å®ƒã€‚</li>
<li>å®¢æˆ·ï¼ˆClientï¼‰è§’è‰²ï¼šé€šè¿‡ä¸€ä¸ªå¤–è§‚è§’è‰²è®¿é—®å„ä¸ªå­ç³»ç»Ÿçš„åŠŸèƒ½ã€‚</li>
</ol>
<h3 id="13-2-2-ä»£ç å®ç°"><a href="#13-2-2-ä»£ç å®ç°" class="headerlink" title="13.2.2 ä»£ç å®ç°"></a>13.2.2 ä»£ç å®ç°</h3><p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_21-03-54.png"></p>
<p><strong>AirCondition</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AirCondition</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç©ºè°ƒç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 19:23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AirCondition</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç©ºè°ƒæ‰“å¼€...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç©ºè°ƒå…³é—­...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Light</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Light</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”µç¯ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 19:23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Light</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µç¯æ‰“å¼€...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µç¯å…³é—­...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>TV</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> TV</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”µè§†ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 19:23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TV</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µè§†æ‰“å¼€...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µè§†å…³é—­...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SmartAppliancesFacade</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SmartAppliancesFacade</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ™ºèƒ½éŸ³ç®±ç±»  å¤–è§‚ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 19:24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SmartAppliancesFacade</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Light light;</span><br><span class="line">    <span class="keyword">private</span> TV tv;</span><br><span class="line">    <span class="keyword">private</span> AirCondition airCondition;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SmartAppliancesFacade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light = <span class="keyword">new</span> Light();</span><br><span class="line">        tv = <span class="keyword">new</span> TV();</span><br><span class="line">        airCondition = <span class="keyword">new</span> AirCondition();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ‰“å¼€æ–¹æ³• å¤–ç•Œè®¿é—®ä¸äº†</span></span><br><span class="line">    <span class="comment">//ä¸€é”®æ‰“å¼€</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light.on();</span><br><span class="line">        tv.on();</span><br><span class="line">        airCondition.on();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰å…³é—­æ–¹æ³• å¤–ç•Œè®¿é—®ä¸äº†</span></span><br><span class="line">    <span class="comment">//ä¸€é”®å…³é—­</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light.off();</span><br><span class="line">        tv.off();</span><br><span class="line">        airCondition.off();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (message.contains(<span class="string">&quot;æ‰“å¼€&quot;</span>)) &#123;</span><br><span class="line">            on();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message.contains(<span class="string">&quot;å…³é—­&quot;</span>)) &#123;</span><br><span class="line">            off();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ è¯´çš„æŒ‡ä»¤æˆ‘å¬ä¸æ‡‚ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å¤–è§‚æ¨¡å¼æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 19:24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SmartAppliancesFacade smartAppliancesFacade = <span class="keyword">new</span> SmartAppliancesFacade();</span><br><span class="line">        smartAppliancesFacade.say(<span class="string">&quot;æ‰“å¼€å®¶ç”µ&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">        smartAppliancesFacade.say(<span class="string">&quot;å…³é—­å®¶ç”µ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-10-37.png"></p>
<h2 id="13-3-å¤–è§‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#13-3-å¤–è§‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="13.3 å¤–è§‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>13.3 å¤–è§‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ul>
<li>å¯¹åˆ†å±‚ç»“æ„ç³»ç»Ÿæ„å»ºæ—¶ï¼Œä½¿ç”¨å¤–è§‚æ¨¡å¼å®šä¹‰å­ç³»ç»Ÿä¸­æ¯å±‚çš„å…¥å£ç‚¹å¯ä»¥ç®€åŒ–å­ç³»ç»Ÿä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>å½“ä¸€ä¸ªå¤æ‚ç³»ç»Ÿçš„å­ç³»ç»Ÿå¾ˆå¤šæ—¶ï¼Œå¤–è§‚æ¨¡å¼å¯ä»¥ä¸ºç³»ç»Ÿè®¾è®¡ä¸€ä¸ªç®€å•çš„æ¥å£ä¾›å¤–ç•Œè®¿é—®ã€‚</li>
<li>å½“å®¢æˆ·ç«¯ä¸å¤šä¸ªå­ç³»ç»Ÿä¹‹é—´å­˜åœ¨å¾ˆå¤§çš„è”ç³»æ—¶ï¼Œå¼•å…¥å¤–è§‚æ¨¡å¼å¯å°†å®ƒä»¬åˆ†ç¦»ï¼Œä»è€Œæé«˜å­ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å’Œå¯ç§»æ¤æ€§ã€‚</li>
</ul>
<h2 id="13-4-æºç è§£æ"><a href="#13-4-æºç è§£æ" class="headerlink" title="13.4 æºç è§£æ"></a>13.4 æºç è§£æ</h2><p>ä½¿ç”¨tomcatä½œä¸ºwebå®¹å™¨æ—¶ï¼Œæ¥æ”¶æµè§ˆå™¨å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œtomcatä¼šå°†è¯·æ±‚ä¿¡æ¯å°è£…æˆServletRequestå¯¹è±¡ï¼Œå¦‚ä¸‹å›¾â‘ å¤„å¯¹è±¡ã€‚ä½†æ˜¯å¤§å®¶æƒ³æƒ³ServletRequestæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªå­æ¥å£HttpServletRequestï¼Œè€Œæˆ‘ä»¬çŸ¥é“è¯¥requestå¯¹è±¡è‚¯å®šæ˜¯ä¸€ä¸ªHttpServletRequestå¯¹è±¡çš„å­å®ç°ç±»å¯¹è±¡ï¼Œåˆ°åº•æ˜¯å“ªä¸ªç±»çš„å¯¹è±¡å‘¢ï¼Ÿå¯ä»¥é€šè¿‡è¾“å‡ºrequestå¯¹è±¡ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°æ˜¯ä¸€ä¸ªåä¸ºRequestFacadeçš„ç±»çš„å¯¹è±¡ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_21-09-43.png"></p>
<p>RequestFacadeç±»å°±ä½¿ç”¨äº†å¤–è§‚æ¨¡å¼</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_21-10-14.png"></p>
<p><strong>ä¸ºä»€ä¹ˆåœ¨æ­¤å¤„ä½¿ç”¨å¤–è§‚æ¨¡å¼å‘¢ï¼Ÿ</strong></p>
<p>å®šä¹‰ RequestFacade ç±»ï¼Œåˆ†åˆ«å®ç° ServletRequest ï¼ŒåŒæ—¶å®šä¹‰ç§æœ‰æˆå‘˜å˜é‡ Request ï¼Œå¹¶ä¸”æ–¹æ³•çš„å®ç°è°ƒç”¨ Request çš„å®ç°ã€‚ç„¶åï¼Œå°† RequestFacadeä¸Šè½¬ä¸º ServletRequest ä¼ ç»™ servlet çš„ service æ–¹æ³•ï¼Œè¿™æ ·å³ä½¿åœ¨ servlet ä¸­è¢«ä¸‹è½¬ä¸º RequestFacade ï¼Œä¹Ÿä¸èƒ½è®¿é—®ç§æœ‰æˆå‘˜å˜é‡å¯¹è±¡ä¸­çš„æ–¹æ³•ã€‚æ—¢ç”¨äº† Request ï¼Œåˆèƒ½é˜²æ­¢å…¶ä¸­æ–¹æ³•è¢«ä¸åˆç†çš„è®¿é—®ã€‚</p>
<h1 id="14ï¼Œäº«å…ƒæ¨¡å¼"><a href="#14ï¼Œäº«å…ƒæ¨¡å¼" class="headerlink" title="14ï¼Œäº«å…ƒæ¨¡å¼"></a>14ï¼Œäº«å…ƒæ¨¡å¼</h1><h2 id="14-1-äº«å…ƒæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#14-1-äº«å…ƒæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="14.1 äº«å…ƒæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>14.1 äº«å…ƒæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>äº«å…ƒï¼ˆFlyweightï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>è¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨ã€‚</strong>å®ƒé€šè¿‡å…±äº«å·²ç»å­˜åœ¨çš„å¯¹è±¡æ¥å¤§å¹…åº¦å‡å°‘éœ€è¦åˆ›å»ºçš„å¯¹è±¡æ•°é‡ã€é¿å…å¤§é‡ç›¸ä¼¼ç±»çš„å¼€é”€ï¼Œä»è€Œæé«˜ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨ç‡ã€‚</p>
<p>äº«å…ƒæ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ï¼šç›¸åŒå¯¹è±¡åªè¦ä¿å­˜ä¸€ä»½ï¼Œè¿™é™ä½äº†ç³»ç»Ÿä¸­å¯¹è±¡çš„æ•°é‡ï¼Œä»è€Œé™ä½äº†ç³»ç»Ÿä¸­ç»†ç²’åº¦å¯¹è±¡ç»™å†…å­˜å¸¦æ¥çš„å‹åŠ›ã€‚</p>
<p>å…¶ä¸»è¦ç¼ºç‚¹æ˜¯ï¼š</p>
<ol>
<li>ä¸ºäº†ä½¿å¯¹è±¡å¯ä»¥å…±äº«ï¼Œéœ€è¦å°†ä¸€äº›ä¸èƒ½å…±äº«çš„çŠ¶æ€å¤–éƒ¨åŒ–ï¼Œè¿™å°†å¢åŠ ç¨‹åºçš„å¤æ‚æ€§ã€‚</li>
<li>è¯»å–äº«å…ƒæ¨¡å¼çš„å¤–éƒ¨çŠ¶æ€ä¼šä½¿å¾—è¿è¡Œæ—¶é—´ç¨å¾®å˜é•¿ã€‚</li>
</ol>
<h2 id="14-2-äº«å…ƒæ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#14-2-äº«å…ƒæ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="14.2 äº«å…ƒæ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>14.2 äº«å…ƒæ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="14-2-1-äº«å…ƒæ¨¡å¼çš„ç»“æ„"><a href="#14-2-1-äº«å…ƒæ¨¡å¼çš„ç»“æ„" class="headerlink" title="14.2.1 äº«å…ƒæ¨¡å¼çš„ç»“æ„"></a>14.2.1 äº«å…ƒæ¨¡å¼çš„ç»“æ„</h3><p>äº«å…ƒï¼ˆFlyweight ï¼‰æ¨¡å¼ä¸­å­˜åœ¨ä»¥ä¸‹ä¸¤ç§çŠ¶æ€ï¼š</p>
<ol>
<li>å†…éƒ¨çŠ¶æ€ï¼Œå³ä¸ä¼šéšç€ç¯å¢ƒçš„æ”¹å˜è€Œæ”¹å˜çš„å¯å…±äº«éƒ¨åˆ†ã€‚</li>
<li>å¤–éƒ¨çŠ¶æ€ï¼ŒæŒ‡éšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çš„ä¸å¯ä»¥å…±äº«çš„éƒ¨åˆ†ã€‚äº«å…ƒæ¨¡å¼çš„å®ç°è¦é¢†å°±æ˜¯åŒºåˆ†åº”ç”¨ä¸­çš„è¿™ä¸¤ç§çŠ¶æ€ï¼Œå¹¶å°†å¤–éƒ¨çŠ¶æ€å¤–éƒ¨åŒ–ã€‚</li>
</ol>
<p>äº«å…ƒæ¨¡å¼çš„ä¸»è¦æœ‰ä»¥ä¸‹è§’è‰²ï¼š</p>
<ul>
<li>æŠ½è±¡äº«å…ƒè§’è‰²ï¼ˆFlyweightï¼‰ï¼šé€šå¸¸æ˜¯ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œåœ¨æŠ½è±¡äº«å…ƒç±»ä¸­å£°æ˜äº†å…·ä½“äº«å…ƒç±»å…¬å…±çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥å‘å¤–ç•Œæä¾›äº«å…ƒå¯¹è±¡çš„å†…éƒ¨æ•°æ®ï¼ˆå†…éƒ¨çŠ¶æ€ï¼‰ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡è¿™äº›æ–¹æ³•æ¥è®¾ç½®å¤–éƒ¨æ•°æ®ï¼ˆå¤–éƒ¨çŠ¶æ€ï¼‰ã€‚</li>
<li>å…·ä½“äº«å…ƒï¼ˆConcrete Flyweightï¼‰è§’è‰² ï¼šå®ƒå®ç°äº†æŠ½è±¡äº«å…ƒç±»ï¼Œç§°ä¸ºäº«å…ƒå¯¹è±¡ï¼›åœ¨å…·ä½“äº«å…ƒç±»ä¸­ä¸ºå†…éƒ¨çŠ¶æ€æä¾›äº†å­˜å‚¨ç©ºé—´ã€‚é€šå¸¸æˆ‘ä»¬å¯ä»¥ç»“åˆå•ä¾‹æ¨¡å¼æ¥è®¾è®¡å…·ä½“äº«å…ƒç±»ï¼Œä¸ºæ¯ä¸€ä¸ªå…·ä½“äº«å…ƒç±»æä¾›å”¯ä¸€çš„äº«å…ƒå¯¹è±¡ã€‚</li>
<li>éäº«å…ƒï¼ˆUnsharable Flyweight)è§’è‰² ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„æŠ½è±¡äº«å…ƒç±»çš„å­ç±»éƒ½éœ€è¦è¢«å…±äº«ï¼Œä¸èƒ½è¢«å…±äº«çš„å­ç±»å¯è®¾è®¡ä¸ºéå…±äº«å…·ä½“äº«å…ƒç±»ï¼›å½“éœ€è¦ä¸€ä¸ªéå…±äº«å…·ä½“äº«å…ƒç±»çš„å¯¹è±¡æ—¶å¯ä»¥ç›´æ¥é€šè¿‡å®ä¾‹åŒ–åˆ›å»ºã€‚</li>
<li>äº«å…ƒå·¥å‚ï¼ˆFlyweight Factoryï¼‰è§’è‰² ï¼šè´Ÿè´£åˆ›å»ºå’Œç®¡ç†äº«å…ƒè§’è‰²ã€‚å½“å®¢æˆ·å¯¹è±¡è¯·æ±‚ä¸€ä¸ªäº«å…ƒå¯¹è±¡æ—¶ï¼Œäº«å…ƒå·¥å‚æ£€æŸ»ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨ç¬¦åˆè¦æ±‚çš„äº«å…ƒå¯¹è±¡ï¼Œå¦‚æœå­˜åœ¨åˆ™æä¾›ç»™å®¢æˆ·ï¼›å¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº«å…ƒå¯¹è±¡ã€‚</li>
</ul>
<h3 id="14-2-1ä»£ç å®ç°"><a href="#14-2-1ä»£ç å®ç°" class="headerlink" title="14.2.1ä»£ç å®ç°"></a>14.2.1ä»£ç å®ç°</h3><p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_21-14-51.png"></p>
<p><strong>IBox å®šä¹‰ä¸åŒçš„å½¢çŠ¶</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> IBox</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Iå›¾å½¢ç±»(å…·ä½“äº«å…ƒè§’è‰²)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/25 15:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IBox</span> <span class="keyword">extends</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getShape</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>LBox å®šä¹‰ä¸åŒçš„å½¢çŠ¶</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> IBox</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Lå›¾å½¢ç±»(å…·ä½“äº«å…ƒè§’è‰²)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/25 15:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LBox</span> <span class="keyword">extends</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getShape</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;L&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OBox å®šä¹‰ä¸åŒçš„å½¢çŠ¶</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> IBox</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Oå›¾å½¢ç±»(å…·ä½“äº«å…ƒè§’è‰²)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/25 15:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OBox</span> <span class="keyword">extends</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getShape</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;O&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>BoxFactory æä¾›äº†ä¸€ä¸ªå·¥å‚ç±»ï¼ˆBoxFactoryï¼‰ï¼Œç”¨æ¥ç®¡ç†äº«å…ƒå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯AbstractBoxå­ç±»å¯¹è±¡ï¼‰ï¼Œè¯¥å·¥å‚ç±»å¯¹è±¡åªéœ€è¦ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚å¹¶ç»™å·¥å‚ç±»æä¾›ä¸€ä¸ªè·å–å½¢çŠ¶çš„æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> BoxFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å·¥å‚ç±» å°†ç±»è®¾è®¡ä¸ºå•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/25 15:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoxFactory</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String, AbstractBox&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">BoxFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        map = <span class="keyword">new</span> HashMap&lt;String, AbstractBox&gt;();</span><br><span class="line">        IBox iBox = <span class="keyword">new</span> IBox();</span><br><span class="line">        LBox lBox = <span class="keyword">new</span> LBox();</span><br><span class="line">        OBox oBox = <span class="keyword">new</span> OBox();</span><br><span class="line">        map.put(<span class="string">&quot;I&quot;</span>, iBox);</span><br><span class="line">        map.put(<span class="string">&quot;L&quot;</span>, lBox);</span><br><span class="line">        map.put(<span class="string">&quot;O&quot;</span>, oBox);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜ä¸€ä¸ªæ–¹æ³•è·å–å·¥å‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BoxFactory <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> BoxFactory INSTANCE = <span class="keyword">new</span> BoxFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®å›¾å½¢åç§°è·å–å›¾å½¢å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AbstractBox <span class="title">getShape</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> map.get(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>AbstractBox å¯¹è¿™äº›å½¢çŠ¶å‘ä¸ŠæŠ½å–å‡ºAbstractBoxï¼Œç”¨æ¥å®šä¹‰å…±æ€§çš„å±æ€§å’Œè¡Œä¸º</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AbstractBox</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡äº«å…ƒè§’è‰² æŠ½è±¡ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/25 15:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·å–å›¾å½¢çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">getShape</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ˜¾ç¤ºå›¾å½¢åŠé¢œè‰²</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(String color)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹å—å½¢çŠ¶ï¼š&quot;</span> + <span class="keyword">this</span>.getShape() + <span class="string">&quot;é¢œè‰²ï¼š&quot;</span> + color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-11-07.png"></p>
<h2 id="14-3-äº«å…ƒæ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#14-3-äº«å…ƒæ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="14.3 äº«å…ƒæ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>14.3 äº«å…ƒæ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><p>å½“ç³»ç»Ÿä¸­å¤šå¤„éœ€è¦åŒä¸€ç»„ä¿¡æ¯æ—¶ï¼Œå¯ä»¥æŠŠè¿™äº›ä¿¡æ¯å°è£…åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œç„¶åå¯¹è¯¥å¯¹è±¡è¿›è¡Œç¼“å­˜ï¼Œè¿™æ ·ï¼Œä¸€ä¸ªå¯¹è±¡å°±å¯ä»¥æä¾›ç»™å¤šå‡ºéœ€è¦ä½¿ç”¨çš„åœ°æ–¹ï¼Œé¿å…å¤§é‡åŒä¸€å¯¹è±¡çš„å¤šæ¬¡åˆ›å»ºï¼Œé™ä½å¤§é‡å†…å­˜ç©ºé—´çš„æ¶ˆè€—ã€‚</p>
<p>äº«å…ƒæ¨¡å¼å…¶å®æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸€ä¸ªæ”¹è¿›æœºåˆ¶ï¼Œäº«å…ƒæ¨¡å¼åŒæ ·è¦æ±‚åˆ›å»ºä¸€ä¸ªæˆ–ä¸€ç»„å¯¹è±¡ï¼Œå¹¶ä¸”å°±æ˜¯é€šè¿‡å·¥å‚æ–¹æ³•æ¨¡å¼ç”Ÿæˆå¯¹è±¡çš„ï¼Œåªä¸è¿‡äº«å…ƒæ¨¡å¼ä¸ºå·¥å‚æ–¹æ³•æ¨¡å¼å¢åŠ äº†ç¼“å­˜è¿™ä¸€åŠŸèƒ½ã€‚</p>
<p>å‰é¢åˆ†æäº†äº«å…ƒæ¨¡å¼çš„ç»“æ„ä¸ç‰¹ç‚¹ï¼Œä¸‹é¢åˆ†æå®ƒé€‚ç”¨çš„åº”ç”¨åœºæ™¯ã€‚<strong>äº«å…ƒæ¨¡å¼æ˜¯é€šè¿‡å‡å°‘å†…å­˜ä¸­å¯¹è±¡çš„æ•°é‡æ¥èŠ‚çœå†…å­˜ç©ºé—´çš„</strong>ï¼Œæ‰€ä»¥ä»¥ä¸‹å‡ ç§æƒ…å½¢é€‚åˆé‡‡ç”¨äº«å…ƒæ¨¡å¼ã€‚</p>
<ol>
<li>ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡ç›¸åŒæˆ–ç›¸ä¼¼çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡è€—è´¹å¤§é‡çš„å†…å­˜èµ„æºã€‚</li>
<li>å¤§éƒ¨åˆ†çš„å¯¹è±¡å¯ä»¥æŒ‰ç…§å†…éƒ¨çŠ¶æ€è¿›è¡Œåˆ†ç»„ï¼Œä¸”å¯å°†ä¸åŒéƒ¨åˆ†å¤–éƒ¨åŒ–ï¼Œè¿™æ ·æ¯ä¸€ä¸ªç»„åªéœ€ä¿å­˜ä¸€ä¸ªå†…éƒ¨çŠ¶æ€ã€‚</li>
<li>ç”±äºäº«å…ƒæ¨¡å¼éœ€è¦é¢å¤–ç»´æŠ¤ä¸€ä¸ªä¿å­˜äº«å…ƒçš„æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥åº”å½“åœ¨æœ‰è¶³å¤Ÿå¤šçš„äº«å…ƒå®ä¾‹æ—¶æ‰å€¼å¾—ä½¿ç”¨äº«å…ƒæ¨¡å¼</li>
</ol>
<h2 id="14-4-JDKæºç è§£æ"><a href="#14-4-JDKæºç è§£æ" class="headerlink" title="14.4 JDKæºç è§£æ"></a>14.4 JDKæºç è§£æ</h2><p>Integerç±»ä½¿ç”¨äº†äº«å…ƒæ¨¡å¼ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Integer i1 = <span class="number">127</span>;</span><br><span class="line">        Integer i2 = <span class="number">127</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;i1å’Œi2å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (i1 == i2));</span><br><span class="line"></span><br><span class="line">        Integer i3 = <span class="number">128</span>;</span><br><span class="line">        Integer i4 = <span class="number">128</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;i3å’Œi4å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (i3 == i4));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç»“æœæ˜¯ true  false </p>
</blockquote>
<p>ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªè¾“å‡ºè¯­å¥è¾“å‡ºçš„æ˜¯trueï¼Œç¬¬äºŒä¸ªè¾“å‡ºè¯­å¥è¾“å‡ºçš„æ˜¯falseï¼Ÿé€šè¿‡åç¼–è¯‘è½¯ä»¶è¿›è¡Œåç¼–è¯‘ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Integer i1 = Integer.valueOf((<span class="keyword">int</span>)<span class="number">127</span>);</span><br><span class="line">        Integer i2 Integer.valueOf((<span class="keyword">int</span>)<span class="number">127</span>);</span><br><span class="line">        System.out.println((String)<span class="keyword">new</span> StringBuilder().append((String)<span class="string">&quot;i1\u548ci2\u5bf9\u8c61\u662f\u5426\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff1f&quot;</span>).append((<span class="keyword">boolean</span>)(i1 == i2)).toString());</span><br><span class="line">        Integer i3 = Integer.valueOf((<span class="keyword">int</span>)<span class="number">128</span>);</span><br><span class="line">        Integer i4 = Integer.valueOf((<span class="keyword">int</span>)<span class="number">128</span>);</span><br><span class="line">        System.out.println((String)<span class="keyword">new</span> StringBuilder().append((String)<span class="string">&quot;i3\u548ci4\u5bf9\u8c61\u662f\u5426\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff1f&quot;</span>).append((<span class="keyword">boolean</span>)(i3 == i4)).toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œç›´æ¥ç»™Integerç±»å‹çš„å˜é‡èµ‹å€¼åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®çš„æ“ä½œåº•å±‚ä½¿ç”¨çš„æ˜¯ <code>valueOf()</code> ï¼Œæ‰€ä»¥åªéœ€è¦çœ‹è¯¥æ–¹æ³•å³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Integer</span> <span class="keyword">extends</span> <span class="title">Number</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class="line">            <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerCache</span> </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> low = -<span class="number">128</span>;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> high;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> Integer cache[];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> h = <span class="number">127</span>;</span><br><span class="line">            String integerCacheHighPropValue =</span><br><span class="line">                sun.misc.VM.getSavedProperty(<span class="string">&quot;java.lang.Integer.IntegerCache.high&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (integerCacheHighPropValue != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class="line">                    i = Math.max(i, <span class="number">127</span>);</span><br><span class="line">                    <span class="comment">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class="line">                    h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="number">1</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span>( NumberFormatException nfe) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            high = h;</span><br><span class="line">            cache = <span class="keyword">new</span> Integer[(high - low) + <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> j = low;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; cache.length; k++)</span><br><span class="line">                cache[k] = <span class="keyword">new</span> Integer(j++);</span><br><span class="line">            <span class="comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class="line">            <span class="keyword">assert</span> IntegerCache.high &gt;= <span class="number">127</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">IntegerCache</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° <code>Integer</code> é»˜è®¤å…ˆåˆ›å»ºå¹¶ç¼“å­˜ <code>-128 ~ 127</code> ä¹‹é—´æ•°çš„ <code>Integer</code> å¯¹è±¡ï¼Œå½“è°ƒç”¨ <code>valueOf</code> æ—¶å¦‚æœå‚æ•°åœ¨ <code>-128 ~ 127</code> ä¹‹é—´åˆ™è®¡ç®—ä¸‹æ ‡å¹¶ä»ç¼“å­˜ä¸­è¿”å›ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Integer</code> å¯¹è±¡ã€‚</p>
<h1 id="15ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#15ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="15ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>15ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼</h1><h2 id="15-1-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#15-1-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="15.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>15.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰æ¨¡å¼çš„å®šä¹‰å¦‚ä¸‹ï¼š<strong>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶ï¼Œè€Œå°†ç®—æ³•çš„ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜è¯¥ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</strong>å®ƒæ˜¯ä¸€ç§ç±»è¡Œä¸ºå‹æ¨¡å¼ã€‚</p>
<p><strong>è¯¥æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>å®ƒå°è£…äº†ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ã€‚å®ƒæŠŠè®¤ä¸ºæ˜¯ä¸å˜éƒ¨åˆ†çš„ç®—æ³•å°è£…åˆ°çˆ¶ç±»ä¸­å®ç°ï¼Œè€ŒæŠŠå¯å˜éƒ¨åˆ†ç®—æ³•ç”±å­ç±»ç»§æ‰¿å®ç°ï¼Œä¾¿äºå­ç±»ç»§ç»­æ‰©å±•ã€‚</li>
<li>å®ƒåœ¨çˆ¶ç±»ä¸­æå–äº†å…¬å…±çš„éƒ¨åˆ†ä»£ç ï¼Œä¾¿äºä»£ç å¤ç”¨ã€‚</li>
<li>éƒ¨åˆ†æ–¹æ³•æ˜¯ç”±å­ç±»å®ç°çš„ï¼Œå› æ­¤å­ç±»å¯ä»¥é€šè¿‡æ‰©å±•æ–¹å¼å¢åŠ ç›¸åº”çš„åŠŸèƒ½ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li>
</ol>
<p><strong>è¯¥æ¨¡å¼çš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>å¯¹æ¯ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦å®šä¹‰ä¸€ä¸ªå­ç±»ï¼Œè¿™ä¼šå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œç³»ç»Ÿæ›´åŠ åºå¤§ï¼Œè®¾è®¡ä¹Ÿæ›´åŠ æŠ½è±¡ï¼Œé—´æ¥åœ°å¢åŠ äº†ç³»ç»Ÿå®ç°çš„å¤æ‚åº¦ã€‚</li>
<li>çˆ¶ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ç”±å­ç±»å®ç°ï¼Œå­ç±»æ‰§è¡Œçš„ç»“æœä¼šå½±å“çˆ¶ç±»çš„ç»“æœï¼Œè¿™å¯¼è‡´ä¸€ç§åå‘çš„æ§åˆ¶ç»“æ„ï¼Œå®ƒæé«˜äº†ä»£ç é˜…è¯»çš„éš¾åº¦ã€‚</li>
<li>ç”±äºç»§æ‰¿å…³ç³»è‡ªèº«çš„ç¼ºç‚¹ï¼Œå¦‚æœçˆ¶ç±»æ·»åŠ æ–°çš„æŠ½è±¡æ–¹æ³•ï¼Œåˆ™æ‰€æœ‰å­ç±»éƒ½è¦æ”¹ä¸€éã€‚</li>
</ol>
<h2 id="15-2-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#15-2-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="15.2 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>15.2 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="15-2-1-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„"><a href="#15-2-1-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„" class="headerlink" title="15.2.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„"></a>15.2.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„</h3><p>æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š</p>
<ul>
<li><p>æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰ï¼šè´Ÿè´£ç»™å‡ºä¸€ä¸ªç®—æ³•çš„è½®å»“å’Œéª¨æ¶ã€‚å®ƒç”±ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•å’Œè‹¥å¹²ä¸ªåŸºæœ¬æ–¹æ³•æ„æˆã€‚</p>
<ul>
<li><p>æ¨¡æ¿æ–¹æ³•ï¼šå®šä¹‰äº†ç®—æ³•çš„éª¨æ¶ï¼ŒæŒ‰æŸç§é¡ºåºè°ƒç”¨å…¶åŒ…å«çš„åŸºæœ¬æ–¹æ³•ã€‚</p>
</li>
<li><p>åŸºæœ¬æ–¹æ³•ï¼šæ˜¯å®ç°ç®—æ³•å„ä¸ªæ­¥éª¤çš„æ–¹æ³•ï¼Œæ˜¯æ¨¡æ¿æ–¹æ³•çš„ç»„æˆéƒ¨åˆ†ã€‚åŸºæœ¬æ–¹æ³•åˆå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š</p>
<ul>
<li><p>æŠ½è±¡æ–¹æ³•(Abstract Method) ï¼šä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜ã€ç”±å…¶å…·ä½“å­ç±»å®ç°ã€‚</p>
</li>
<li><p>å…·ä½“æ–¹æ³•(Concrete Method) ï¼šä¸€ä¸ªå…·ä½“æ–¹æ³•ç”±ä¸€ä¸ªæŠ½è±¡ç±»æˆ–å…·ä½“ç±»å£°æ˜å¹¶å®ç°ï¼Œå…¶å­ç±»å¯ä»¥è¿›è¡Œè¦†ç›–ä¹Ÿå¯ä»¥ç›´æ¥ç»§æ‰¿ã€‚</p>
</li>
<li><p>é’©å­æ–¹æ³•(Hook Method) ï¼šåœ¨æŠ½è±¡ç±»ä¸­å·²ç»å®ç°ï¼ŒåŒ…æ‹¬ç”¨äºåˆ¤æ–­çš„é€»è¾‘æ–¹æ³•å’Œéœ€è¦å­ç±»é‡å†™çš„ç©ºæ–¹æ³•ä¸¤ç§ã€‚</p>
<p>ä¸€èˆ¬é’©å­æ–¹æ³•æ˜¯ç”¨äºåˆ¤æ–­çš„é€»è¾‘æ–¹æ³•ï¼Œè¿™ç±»æ–¹æ³•åä¸€èˆ¬ä¸ºisXxxï¼Œè¿”å›å€¼ç±»å‹ä¸ºbooleanç±»å‹ã€‚</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>å…·ä½“å­ç±»ï¼ˆConcrete Classï¼‰ï¼šå®ç°æŠ½è±¡ç±»ä¸­æ‰€å®šä¹‰çš„æŠ½è±¡æ–¹æ³•å’Œé’©å­æ–¹æ³•ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_21-25-01.png"></p>
<h3 id="15-2-2-ä»£ç å®ç°"><a href="#15-2-2-ä»£ç å®ç°" class="headerlink" title="15.2.2 ä»£ç å®ç°"></a>15.2.2 ä»£ç å®ç°</h3><p><strong>AbstractClass</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AbstractClass</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//èµ·åºŠ</span></span><br><span class="line">        <span class="keyword">this</span>.wake();</span><br><span class="line">        <span class="comment">//åˆ·ç‰™</span></span><br><span class="line">        <span class="keyword">this</span>.brush();</span><br><span class="line">        <span class="comment">//åƒæ—©é¥­</span></span><br><span class="line">        <span class="keyword">this</span>.breakfast();</span><br><span class="line">        <span class="comment">//äº¤é€šå·¥å…·</span></span><br><span class="line">        <span class="keyword">this</span>.transport();</span><br><span class="line">        <span class="comment">//ç¡è§‰</span></span><br><span class="line">        <span class="keyword">this</span>.sleep();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­¥éª¤ä¸€æ · ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">wake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;èµ·åºŠ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­¥éª¤ä¸€æ · ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">brush</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ·ç‰™...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤ä¸ä¸€æ · (ä¸€ä¸ªæ˜¯åƒé¢åŒ… ä¸€ä¸ªæ˜¯å–ç‰›å¥¶)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">breakfast</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤ä¸ä¸€æ · (ä¸€ä¸ªæ˜¯å¼€è½¦ ä¸€ä¸ªæ˜¯ååœ°é“)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">transport</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤ä¸€æ · ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¡è§‰...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ConcreteClass_BreakFast</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ConcreteClass_BreakFast</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“ç±» æ—©é¥­ç±» ç»§æ‰¿</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass_BreakFast</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">breakfast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åƒé¢åŒ…...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åå…¬äº¤...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ConcreteClass_Transport</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ConcreteClass_Transport</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº¤é€šå·¥å…·ç±» ç»§æ‰¿</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass_Transport</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">breakfast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å–ç‰›å¥¶...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¹˜åœ°é“...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¨¡æ¿æ–¹æ³•æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:16</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åƒé¢åŒ… åå…¬äº¤</span></span><br><span class="line">        System.out.println(<span class="string">&quot;å‘¨ä¸€&quot;</span>);</span><br><span class="line">        AbstractClass breakFast = <span class="keyword">new</span> ConcreteClass_BreakFast();</span><br><span class="line">        breakFast.work();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;========================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘¨äº”&quot;</span>);</span><br><span class="line">        AbstractClass transport = <span class="keyword">new</span> ConcreteClass_Transport();</span><br><span class="line">        transport.work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-11-39.png"></p>
<p><strong>é’©å­æ–¹æ³•</strong></p>
<p><strong>AbstractClass</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template.hook_method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AbstractClass</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//èµ·åºŠ</span></span><br><span class="line">        <span class="keyword">this</span>.wake();</span><br><span class="line">        <span class="comment">//åˆ·ç‰™</span></span><br><span class="line">        <span class="keyword">this</span>.brush();</span><br><span class="line">        <span class="comment">//åƒæ—©é¥­</span></span><br><span class="line">        <span class="keyword">this</span>.breakfast();</span><br><span class="line">        <span class="comment">//äº¤é€šå·¥å…·</span></span><br><span class="line">        <span class="keyword">if</span> (isSunday()) &#123;</span><br><span class="line">            <span class="keyword">this</span>.transport();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç¡è§‰</span></span><br><span class="line">        <span class="keyword">this</span>.sleep();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­¥éª¤ä¸€æ · ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">wake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;èµ·åºŠ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­¥éª¤ä¸€æ · ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">brush</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ·ç‰™...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤ä¸ä¸€æ · (ä¸€ä¸ªæ˜¯åƒé¢åŒ… ä¸€ä¸ªæ˜¯å–ç‰›å¥¶)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">breakfast</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤ä¸ä¸€æ · (ä¸€ä¸ªæ˜¯å¼€è½¦ ä¸€ä¸ªæ˜¯ååœ°é“)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">transport</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤ä¸€æ · ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¡è§‰...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é’©å­æ–¹æ³• æ˜¯å¦ä¸ºå‘¨æœ« å‘¨æœ«ä¸ç”¨äº¤é€šå·¥å…·</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isSunday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ConcreteClass_BreakFast</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template.hook_method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ConcreteClass_BreakFast</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“ç±» æ—©é¥­ç±» ç»§æ‰¿</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass_BreakFast</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">breakfast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åƒé¢åŒ…...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åå…¬äº¤...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ConcreteClass_Transport</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template.hook_method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ConcreteClass_Transport</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> äº¤é€šå·¥å…·ç±» ç»§æ‰¿</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass_Transport</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">breakfast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å–ç‰›å¥¶...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¹˜åœ°é“...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ConcreteClass_Sunday</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template.hook_method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ConcreteClass_Sunday</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å‘¨æœ« ä¸ç”¨ä¸Šç­ ç©ºå®ç°äº¤é€šæ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass_Sunday</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">breakfast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åƒé¢åŒ…æˆ–è€…å–ç‰›å¥¶...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ç©ºå®ç°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isSunday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»Šå¤©å‘¨æœ«ï¼Œä¼‘æ¯...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.template.hook_method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¨¡æ¿æ–¹æ³• æµ‹è¯•é’©å­æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 20:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AbstractClass sunday = <span class="keyword">new</span> ConcreteClass_Sunday();</span><br><span class="line">        sunday.work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="15-3-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#15-3-æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="15.3 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>15.3 æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ol>
<li>ç®—æ³•çš„æ•´ä½“æ­¥éª¤å¾ˆå›ºå®šï¼Œä½†å…¶ä¸­ä¸ªåˆ«éƒ¨åˆ†æ˜“å˜æ—¶ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†å®¹æ˜“å˜çš„éƒ¨åˆ†æŠ½è±¡å‡ºæ¥ï¼Œä¾›å­ç±»å®ç°ã€‚</li>
<li>å½“å¤šä¸ªå­ç±»å­˜åœ¨å…¬å…±çš„è¡Œä¸ºæ—¶ï¼Œå¯ä»¥å°†å…¶æå–å‡ºæ¥å¹¶é›†ä¸­åˆ°ä¸€ä¸ªå…¬å…±çˆ¶ç±»ä¸­ä»¥é¿å…ä»£ç é‡å¤ã€‚é¦–å…ˆï¼Œè¦è¯†åˆ«ç°æœ‰ä»£ç ä¸­çš„ä¸åŒä¹‹å¤„ï¼Œå¹¶ä¸”å°†ä¸åŒä¹‹å¤„åˆ†ç¦»ä¸ºæ–°çš„æ“ä½œã€‚æœ€åï¼Œç”¨ä¸€ä¸ªè°ƒç”¨è¿™äº›æ–°çš„æ“ä½œçš„æ¨¡æ¿æ–¹æ³•æ¥æ›¿æ¢è¿™äº›ä¸åŒçš„ä»£ç ã€‚</li>
<li>å½“éœ€è¦æ§åˆ¶å­ç±»çš„æ‰©å±•æ—¶ï¼Œæ¨¡æ¿æ–¹æ³•åªåœ¨ç‰¹å®šç‚¹è°ƒç”¨é’©å­æ“ä½œï¼Œè¿™æ ·å°±åªå…è®¸åœ¨è¿™äº›ç‚¹è¿›è¡Œæ‰©å±•ã€‚</li>
</ol>
<h2 id="15-4-JDKæºç è§£æ"><a href="#15-4-JDKæºç è§£æ" class="headerlink" title="15.4 JDKæºç è§£æ"></a>15.4 JDKæºç è§£æ</h2><p>InputStreamç±»å°±ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚åœ¨InputStreamç±»ä¸­å®šä¹‰äº†å¤šä¸ª <code>read()</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">InputStream</span> <span class="keyword">implements</span> <span class="title">Closeable</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŠ½è±¡æ–¹æ³•ï¼Œè¦æ±‚å­ç±»å¿…é¡»é‡å†™</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">byte</span> b[])</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> read(b, <span class="number">0</span>, b.length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">byte</span> b[], <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (off &lt; <span class="number">0</span> || len &lt; <span class="number">0</span> || len &gt; b.length - off) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> c = read(); <span class="comment">//è°ƒç”¨äº†æ— å‚çš„readæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯æ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> (c == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        b[off] = (<span class="keyword">byte</span>)c;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (; i &lt; len ; i++) &#123;</span><br><span class="line">                c = read();</span><br><span class="line">                <span class="keyword">if</span> (c == -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                b[off + i] = (<span class="keyword">byte</span>)c;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ee) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæ— å‚çš„ <code>read()</code> æ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œè¦æ±‚å­ç±»å¿…é¡»å®ç°ã€‚è€Œ <code>read(byte b[])</code> æ–¹æ³•è°ƒç”¨äº† <code>read(byte b[], int off, int len)</code> æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨æ­¤å¤„é‡ç‚¹çœ‹çš„æ–¹æ³•æ˜¯å¸¦ä¸‰ä¸ªå‚æ•°çš„æ–¹æ³•ã€‚ </p>
<p>åœ¨è¯¥æ–¹æ³•ä¸­ç¬¬18è¡Œã€27è¡Œï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†æ— å‚çš„æŠ½è±¡çš„ <code>read()</code> æ–¹æ³•ã€‚</p>
<p><strong>æ€»ç»“å¦‚ä¸‹ï¼š åœ¨InputStreamçˆ¶ç±»ä¸­å·²ç»å®šä¹‰å¥½äº†è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°ç»„æ•°æ®çš„æ–¹æ³•æ˜¯æ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ°æ•°ç»„çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä½ç½®ï¼Œè¯»å–lenä¸ªå­—èŠ‚æ•°æ®ã€‚å…·ä½“å¦‚ä½•è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°æ®å‘¢ï¼Ÿç”±å­ç±»å®ç°</strong>ã€‚</p>
<h1 id="16ï¼Œç»„åˆæ¨¡å¼"><a href="#16ï¼Œç»„åˆæ¨¡å¼" class="headerlink" title="16ï¼Œç»„åˆæ¨¡å¼"></a>16ï¼Œç»„åˆæ¨¡å¼</h1><h2 id="16-1-ç»„åˆæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#16-1-ç»„åˆæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="16.1 ç»„åˆæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>16.1 ç»„åˆæ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>ç»„åˆï¼ˆComposite Patternï¼‰æ¨¡å¼çš„å®šä¹‰ï¼šæœ‰æ—¶åˆå«ä½œæ•´ä½“-éƒ¨åˆ†ï¼ˆPart-Wholeï¼‰æ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ç§å°†å¯¹è±¡ç»„åˆæˆæ ‘çŠ¶çš„å±‚æ¬¡ç»“æ„çš„æ¨¡å¼ï¼Œç”¨æ¥è¡¨ç¤ºâ€œæ•´ä½“-éƒ¨åˆ†â€çš„å…³ç³»ï¼Œä½¿ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡å…·æœ‰ä¸€è‡´çš„è®¿é—®æ€§ï¼Œå±äºç»“æ„å‹è®¾è®¡æ¨¡å¼ã€‚</p>
<p>ç»„åˆæ¨¡å¼ä¸€èˆ¬ç”¨æ¥æè¿°æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ï¼Œå®ƒå°†å¯¹è±¡ç»„ç»‡åˆ°æ ‘å½¢ç»“æ„ä¸­ï¼Œé¡¶å±‚çš„èŠ‚ç‚¹è¢«ç§°ä¸ºæ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹ä¸‹é¢å¯ä»¥åŒ…å«æ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹ï¼Œæ ‘æèŠ‚ç‚¹ä¸‹é¢åˆå¯ä»¥åŒ…å«æ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹ï¼Œæ ‘å½¢ç»“æ„å›¾å¦‚ä¸‹</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_22-22-40.png"></p>
<p>ç”±ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå…¶å®æ ¹èŠ‚ç‚¹å’Œæ ‘æèŠ‚ç‚¹æœ¬è´¨ä¸Šå±äºåŒä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯ä»¥ä½œä¸ºå®¹å™¨ä½¿ç”¨ï¼›è€Œå¶å­èŠ‚ç‚¹ä¸æ ‘æèŠ‚ç‚¹åœ¨è¯­ä¹‰ä¸Šä¸å±äºç”¨ä¸€ç§ç±»å‹ã€‚ä½†æ˜¯åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œä¼šæŠŠæ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹çœ‹ä½œå±äºåŒä¸€ç§æ•°æ®ç±»å‹ï¼ˆç”¨ç»Ÿä¸€æ¥å£å®šä¹‰ï¼‰ï¼Œè®©å®ƒä»¬å…·å¤‡ä¸€è‡´è¡Œä¸ºã€‚</p>
<p>è¿™æ ·ï¼Œåœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œæ•´ä¸ªæ ‘å½¢ç»“æ„ä¸­çš„å¯¹è±¡éƒ½å±äºåŒä¸€ç§ç±»å‹ï¼Œå¸¦æ¥çš„å¥½å¤„å°±æ˜¯ç”¨æˆ·ä¸éœ€è¦è¾¨åˆ«æ˜¯æ ‘æèŠ‚ç‚¹è¿˜æ˜¯å¶å­èŠ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œæ“ä½œï¼Œç»™ç”¨æˆ·çš„ä½¿ç”¨å¸¦æ¥æå¤§çš„ä¾¿åˆ©ã€‚</p>
<p>ç»„åˆæ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹æœ‰ï¼š</p>
<ol>
<li>ç»„åˆæ¨¡å¼ä½¿å¾—å®¢æˆ·ç«¯ä»£ç å¯ä»¥ä¸€è‡´åœ°å¤„ç†å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ï¼Œæ— é¡»å…³å¿ƒè‡ªå·±å¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡ï¼Œè¿˜æ˜¯ç»„åˆå¯¹è±¡ï¼Œè¿™ç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ï¼›</li>
<li>æ›´å®¹æ˜“åœ¨ç»„åˆä½“å†…åŠ å…¥æ–°çš„å¯¹è±¡ï¼Œå®¢æˆ·ç«¯ä¸ä¼šå› ä¸ºåŠ å…¥äº†æ–°çš„å¯¹è±¡è€Œæ›´æ”¹æºä»£ç ï¼Œæ»¡è¶³â€œå¼€é—­åŸåˆ™â€ï¼›</li>
</ol>
<p>å…¶ä¸»è¦ç¼ºç‚¹æ˜¯ï¼š</p>
<ol>
<li>è®¾è®¡è¾ƒå¤æ‚ï¼Œå®¢æˆ·ç«¯éœ€è¦èŠ±æ›´å¤šæ—¶é—´ç†æ¸…ç±»ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ï¼›</li>
<li>ä¸å®¹æ˜“é™åˆ¶å®¹å™¨ä¸­çš„æ„ä»¶ï¼›</li>
<li>ä¸å®¹æ˜“ç”¨ç»§æ‰¿çš„æ–¹æ³•æ¥å¢åŠ æ„ä»¶çš„æ–°åŠŸèƒ½ï¼›</li>
</ol>
<h2 id="16-2-ç»„åˆæ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#16-2-ç»„åˆæ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="16.2 ç»„åˆæ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>16.2 ç»„åˆæ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="16-2-1-ç»„åˆæ¨¡å¼çš„ç»“æ„"><a href="#16-2-1-ç»„åˆæ¨¡å¼çš„ç»“æ„" class="headerlink" title="16.2.1 ç»„åˆæ¨¡å¼çš„ç»“æ„"></a>16.2.1 ç»„åˆæ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡æ„ä»¶ï¼ˆComponentï¼‰è§’è‰²ï¼šå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¸ºæ ‘å¶æ„ä»¶å’Œæ ‘ææ„ä»¶å£°æ˜å…¬å…±æ¥å£ï¼Œå¹¶å®ç°å®ƒä»¬çš„é»˜è®¤è¡Œä¸ºã€‚åœ¨é€æ˜å¼çš„ç»„åˆæ¨¡å¼ä¸­æŠ½è±¡æ„ä»¶è¿˜å£°æ˜è®¿é—®å’Œç®¡ç†å­ç±»çš„æ¥å£ï¼›åœ¨å®‰å…¨å¼çš„ç»„åˆæ¨¡å¼ä¸­ä¸å£°æ˜è®¿é—®å’Œç®¡ç†å­ç±»çš„æ¥å£ï¼Œç®¡ç†å·¥ä½œç”±æ ‘ææ„ä»¶å®Œæˆã€‚ï¼ˆæ€»çš„æŠ½è±¡ç±»æˆ–æ¥å£ï¼Œå®šä¹‰ä¸€äº›é€šç”¨çš„æ–¹æ³•ï¼Œæ¯”å¦‚æ–°å¢ã€åˆ é™¤ï¼‰</li>
<li>æ ‘å¶æ„ä»¶ï¼ˆLeafï¼‰è§’è‰²ï¼šæ˜¯ç»„åˆä¸­çš„å¶èŠ‚ç‚¹å¯¹è±¡ï¼Œå®ƒæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œç”¨äºç»§æ‰¿æˆ–å®ç°æŠ½è±¡æ„ä»¶ã€‚</li>
<li>æ ‘ææ„ä»¶ï¼ˆCompositeï¼‰è§’è‰² / ä¸­é—´æ„ä»¶ï¼šæ˜¯ç»„åˆä¸­çš„åˆ†æ”¯èŠ‚ç‚¹å¯¹è±¡ï¼Œå®ƒæœ‰å­èŠ‚ç‚¹ï¼Œç”¨äºç»§æ‰¿å’Œå®ç°æŠ½è±¡æ„ä»¶ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å­˜å‚¨å’Œç®¡ç†å­éƒ¨ä»¶ï¼Œé€šå¸¸åŒ…å« Add()ã€Remove()ã€GetChild() ç­‰æ–¹æ³•ã€‚</li>
</ol>
<h3 id="16-2-2-ä»£ç å®ç°"><a href="#16-2-2-ä»£ç å®ç°" class="headerlink" title="16.2.2 ä»£ç å®ç°"></a>16.2.2 ä»£ç å®ç°</h3><p>å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬åœ¨è®¿é—®åˆ«çš„ä¸€äº›ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œç»å¸¸å¯ä»¥çœ‹åˆ°ç±»ä¼¼çš„èœå•ã€‚ä¸€ä¸ªèœå•å¯ä»¥åŒ…å«èœå•é¡¹ï¼ˆèœå•é¡¹æ˜¯æŒ‡ä¸å†åŒ…å«å…¶ä»–å†…å®¹çš„èœå•æ¡ç›®ï¼‰ï¼Œä¹Ÿå¯ä»¥åŒ…å«å¸¦æœ‰å…¶ä»–èœå•é¡¹çš„èœå•ï¼Œå› æ­¤ä½¿ç”¨ç»„åˆæ¨¡å¼æè¿°èœå•å°±å¾ˆæ°å½“ï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯é’ˆå¯¹ä¸€ä¸ªèœå•ï¼Œæ‰“å°å‡ºå…¶åŒ…å«çš„æ‰€æœ‰èœå•ä»¥åŠèœå•é¡¹çš„åç§°ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_22-23-54.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_22-24-18.png"></p>
<p><strong>MenuComponent MenuComponentå®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œå› ä¸ºæœ‰ä¸€äº›å…±æœ‰çš„å±æ€§å’Œè¡Œä¸ºè¦åœ¨è¯¥ç±»ä¸­å®ç°ï¼ŒMenuå’ŒMenuItemç±»å°±å¯ä»¥åªè¦†ç›–è‡ªå·±æ„Ÿå…´è¶£çš„æ–¹æ³•ï¼Œè€Œä¸ç”¨æ­ç†ä¸éœ€è¦æˆ–è€…ä¸æ„Ÿå…´è¶£çš„æ–¹æ³•ï¼Œä¸¾ä¾‹æ¥è¯´ï¼ŒMenuç±»å¯ä»¥åŒ…å«å­èœå•ï¼Œå› æ­¤éœ€è¦è¦†ç›–add()ã€remove()ã€getChild()æ–¹æ³•ï¼Œä½†æ˜¯MenuItemå°±ä¸åº”è¯¥æœ‰è¿™äº›æ–¹æ³•ã€‚è¿™é‡Œç»™å‡ºçš„é»˜è®¤å®ç°æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ”¹å†™é»˜è®¤å®ç°ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.combination;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MenuComponent</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> èœå•ç»„ä»¶ ä¸ç®¡èœå•è¿˜æ˜¯èœå•é¡¹ï¼Œéƒ½åº”è¯¥ç»§æ‰¿è¯¥ç±»  æŠ½è±¡ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 17:02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> level;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ èœå•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§»é™¤èœå•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–æŒ‡å®šçš„å­èœå•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MenuComponent <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–èœå•åç§°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Menuç±»å·²ç»å®ç°äº†é™¤äº†getNameæ–¹æ³•çš„å…¶ä»–æ‰€æœ‰æ–¹æ³•ï¼Œå› ä¸ºMenuç±»å…·æœ‰æ·»åŠ èœå•ï¼Œç§»é™¤èœå•å’Œè·å–å­èœå•çš„åŠŸèƒ½</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.combination;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Menu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> èœå•ç±» ç»§æ‰¿èœå•ç»„ä»¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 17:05</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Menu</span> <span class="keyword">extends</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;MenuComponent&gt; menuComponentList;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Menu</span><span class="params">(String name, <span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.level = level;</span><br><span class="line">        menuComponentList = <span class="keyword">new</span> ArrayList&lt;MenuComponent&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        menuComponentList.add(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        menuComponentList.remove(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MenuComponent <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> menuComponentList.get(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;--&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        <span class="keyword">for</span> (MenuComponent menuComponent : menuComponentList) &#123;</span><br><span class="line">            menuComponent.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MenuItemæ˜¯èœå•é¡¹ï¼Œä¸èƒ½å†æœ‰å­èœå•ï¼Œæ‰€ä»¥æ·»åŠ èœå•ï¼Œç§»é™¤èœå•å’Œè·å–å­èœå•çš„åŠŸèƒ½å¹¶ä¸èƒ½å®ç°ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.combination;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MenuItem</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> èœå•é€‰é¡¹ ç»§æ‰¿èœå•ç»„ä»¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/24 17:10</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MenuItem</span> <span class="keyword">extends</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MenuItem</span><span class="params">(String name, <span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.level = level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;--&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-16-43.png"></p>
<p>åœ¨ä½¿ç”¨ç»„åˆæ¨¡å¼æ—¶ï¼Œæ ¹æ®æŠ½è±¡æ„ä»¶ç±»çš„å®šä¹‰å½¢å¼ï¼Œæˆ‘ä»¬å¯å°†ç»„åˆæ¨¡å¼åˆ†ä¸ºé€æ˜ç»„åˆæ¨¡å¼å’Œå®‰å…¨ç»„åˆæ¨¡å¼ä¸¤ç§å½¢å¼ã€‚</p>
<ul>
<li><p>é€æ˜ç»„åˆæ¨¡å¼</p>
<p>é€æ˜ç»„åˆæ¨¡å¼ä¸­ï¼ŒæŠ½è±¡æ ¹èŠ‚ç‚¹è§’è‰²ä¸­å£°æ˜äº†æ‰€æœ‰ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚åœ¨ç¤ºä¾‹ä¸­ <code>MenuComponent</code> å£°æ˜äº† <code>add</code>ã€<code>remove</code> ã€<code>getChild</code> æ–¹æ³•ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ç¡®ä¿æ‰€æœ‰çš„æ„ä»¶ç±»éƒ½æœ‰ç›¸åŒçš„æ¥å£ã€‚é€æ˜ç»„åˆæ¨¡å¼ä¹Ÿæ˜¯ç»„åˆæ¨¡å¼çš„æ ‡å‡†å½¢å¼ã€‚</p>
<p>é€æ˜ç»„åˆæ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿå®‰å…¨ï¼Œå› ä¸ºå¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡åœ¨æœ¬è´¨ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ï¼Œå¶å­å¯¹è±¡ä¸å¯èƒ½æœ‰ä¸‹ä¸€ä¸ªå±‚æ¬¡çš„å¯¹è±¡ï¼Œå³ä¸å¯èƒ½åŒ…å«æˆå‘˜å¯¹è±¡ï¼Œå› æ­¤ä¸ºå…¶æä¾› add()ã€remove() ç­‰æ–¹æ³•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿™åœ¨ç¼–è¯‘é˜¶æ®µä¸ä¼šå‡ºé”™ï¼Œä½†åœ¨è¿è¡Œé˜¶æ®µå¦‚æœè°ƒç”¨è¿™äº›æ–¹æ³•å¯èƒ½ä¼šå‡ºé”™ï¼ˆå¦‚æœæ²¡æœ‰æä¾›ç›¸åº”çš„é”™è¯¯å¤„ç†ä»£ç ï¼‰</p>
</li>
<li><p>å®‰å…¨ç»„åˆæ¨¡å¼</p>
<p>åœ¨å®‰å…¨ç»„åˆæ¨¡å¼ä¸­ï¼Œåœ¨æŠ½è±¡æ„ä»¶è§’è‰²ä¸­æ²¡æœ‰å£°æ˜ä»»ä½•ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨æ ‘æèŠ‚ç‚¹ <code>Menu</code> ç±»ä¸­å£°æ˜å¹¶å®ç°è¿™äº›æ–¹æ³•ã€‚å®‰å…¨ç»„åˆæ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿé€æ˜ï¼Œå› ä¸ºå¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶å…·æœ‰ä¸åŒçš„æ–¹æ³•ï¼Œä¸”å®¹å™¨æ„ä»¶ä¸­é‚£äº›ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•æ²¡æœ‰åœ¨æŠ½è±¡æ„ä»¶ç±»ä¸­å®šä¹‰ï¼Œå› æ­¤å®¢æˆ·ç«¯ä¸èƒ½å®Œå…¨é’ˆå¯¹æŠ½è±¡ç¼–ç¨‹ï¼Œå¿…é¡»æœ‰åŒºåˆ«åœ°å¯¹å¾…å¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶ã€‚</p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_22-27-51.png"></p>
<h2 id="16-3-ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#16-3-ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="16.3 ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>16.3 ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ol>
<li>åœ¨éœ€è¦è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡æ•´ä½“ä¸éƒ¨åˆ†çš„å±‚æ¬¡ç»“æ„çš„åœºåˆã€‚</li>
<li>è¦æ±‚å¯¹ç”¨æˆ·éšè—ç»„åˆå¯¹è±¡ä¸å•ä¸ªå¯¹è±¡çš„ä¸åŒï¼Œç”¨æˆ·å¯ä»¥ç”¨ç»Ÿä¸€çš„æ¥å£ä½¿ç”¨ç»„åˆç»“æ„ä¸­çš„æ‰€æœ‰å¯¹è±¡çš„åœºåˆã€‚</li>
</ol>
<h1 id="17ï¼Œä»£ç†æ¨¡å¼"><a href="#17ï¼Œä»£ç†æ¨¡å¼" class="headerlink" title="17ï¼Œä»£ç†æ¨¡å¼"></a>17ï¼Œä»£ç†æ¨¡å¼</h1><h2 id="17-1-ä»£ç†æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#17-1-ä»£ç†æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="17.1 ä»£ç†æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>17.1 ä»£ç†æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>ä»£ç†æ¨¡å¼çš„å®šä¹‰ï¼š<strong>ç”±äºæŸäº›åŸå› éœ€è¦ç»™æŸå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ä»¥æ§åˆ¶å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ã€‚</strong>è¿™æ—¶ï¼Œè®¿é—®å¯¹è±¡ä¸é€‚åˆæˆ–è€…ä¸èƒ½ç›´æ¥å¼•ç”¨ç›®æ ‡å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡ä½œä¸ºè®¿é—®å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´çš„ä¸­ä»‹ã€‚</p>
<p><strong>ä»£ç†æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹æœ‰ï¼š</strong></p>
<ul>
<li>ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨å’Œä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨ï¼›</li>
<li>ä»£ç†å¯¹è±¡å¯ä»¥æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼›</li>
<li>ä»£ç†æ¨¡å¼èƒ½å°†å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡åˆ†ç¦»ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ï¼Œå¢åŠ äº†ç¨‹åºçš„å¯æ‰©å±•æ€§</li>
</ul>
<p><strong>å…¶ä¸»è¦ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>ä»£ç†æ¨¡å¼ä¼šé€ æˆç³»ç»Ÿè®¾è®¡ä¸­ç±»çš„æ•°é‡å¢åŠ </li>
<li>åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´å¢åŠ ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä¼šé€ æˆè¯·æ±‚å¤„ç†é€Ÿåº¦å˜æ…¢ï¼›</li>
<li>å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼›</li>
</ul>
<h2 id="17-2-ä»£ç†æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#17-2-ä»£ç†æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="17.2 ä»£ç†æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>17.2 ä»£ç†æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="17-2-1-ä»£ç†æ¨¡å¼çš„ç»“æ„"><a href="#17-2-1-ä»£ç†æ¨¡å¼çš„ç»“æ„" class="headerlink" title="17.2.1 ä»£ç†æ¨¡å¼çš„ç»“æ„"></a>17.2.1 ä»£ç†æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡ä¸»é¢˜ï¼ˆSubjectï¼‰ç±»ï¼šé€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»å£°æ˜çœŸå®ä¸»é¢˜å’Œä»£ç†å¯¹è±¡å®ç°çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li>
<li>çœŸå®ä¸»é¢˜ï¼ˆReal Subjectï¼‰ç±»ï¼šå®ç°äº†æŠ½è±¡ä¸»é¢˜ä¸­çš„å…·ä½“ä¸šåŠ¡ï¼Œæ˜¯ä»£ç†å¯¹è±¡æ‰€ä»£è¡¨çš„çœŸå®å¯¹è±¡ï¼Œæ˜¯æœ€ç»ˆè¦å¼•ç”¨çš„å¯¹è±¡ã€‚</li>
<li>ä»£ç†ï¼ˆProxyï¼‰ç±»ï¼šæä¾›äº†ä¸çœŸå®ä¸»é¢˜ç›¸åŒçš„æ¥å£ï¼Œå…¶å†…éƒ¨å«æœ‰å¯¹çœŸå®ä¸»é¢˜çš„å¼•ç”¨ï¼Œå®ƒå¯ä»¥è®¿é—®ã€æ§åˆ¶æˆ–æ‰©å±•çœŸå®ä¸»é¢˜çš„åŠŸèƒ½ã€‚</li>
</ol>
<p>æ ¹æ®ä»£ç†çš„åˆ›å»ºæ—¶æœŸï¼Œä»£ç†æ¨¡å¼åˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ã€‚</p>
<ul>
<li>é™æ€ï¼šç”±ç¨‹åºå‘˜åˆ›å»ºä»£ç†ç±»æˆ–ç‰¹å®šå·¥å…·è‡ªåŠ¨ç”Ÿæˆæºä»£ç å†å¯¹å…¶ç¼–è¯‘ï¼Œåœ¨ç¨‹åºè¿è¡Œå‰ä»£ç†ç±»çš„ .class æ–‡ä»¶å°±å·²ç»å­˜åœ¨äº†ã€‚</li>
<li>åŠ¨æ€ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œè¿ç”¨åå°„æœºåˆ¶åŠ¨æ€åˆ›å»ºè€Œæˆ</li>
</ul>
<h3 id="17-2-2-ä»£ç å®ç°"><a href="#17-2-2-ä»£ç å®ç°" class="headerlink" title="17.2.2 ä»£ç å®ç°"></a>17.2.2 ä»£ç å®ç°</h3><p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_22-35-52.png"></p>
<h4 id="17-2-2-1é™æ€ä»£ç†"><a href="#17-2-2-1é™æ€ä»£ç†" class="headerlink" title="17.2.2.1é™æ€ä»£ç†"></a>17.2.2.1<strong>é™æ€ä»£ç†</strong></h4><p><strong>SellTickets</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.static_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SellTickets</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å–ç¥¨æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Transition</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.static_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Transition</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç«è½¦ç«™ï¼Œå…·æœ‰å–ç¥¨åŠŸèƒ½ï¼Œå®ç°æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Transition</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ProxyPoint</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.static_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ProxyPoint</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä»£å”®ç‚¹ å®ç°æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyPoint</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Transition transition = <span class="keyword">new</span> Transition();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»£å”®ç‚¹æ”¶å–æœåŠ¡è´¹&quot;</span>);</span><br><span class="line">        transition.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.static_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é™æ€ä»£ç†å®¢æˆ·ç«¯æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ProxyPoint proxyPoint = <span class="keyword">new</span> ProxyPoint();</span><br><span class="line">        proxyPoint.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-18-39.png"></p>
<p>ä»ä¸Šé¢ä»£ç ä¸­å¯ä»¥çœ‹å‡ºæµ‹è¯•ç±»ç›´æ¥è®¿é—®çš„æ˜¯ProxyPointç±»å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ProxyPointä½œä¸ºè®¿é—®å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡çš„ä¸­ä»‹ã€‚åŒæ—¶ä¹Ÿå¯¹sellæ–¹æ³•è¿›è¡Œäº†å¢å¼º</p>
<h4 id="17-2-2-2-JDKåŠ¨æ€ä»£ç†"><a href="#17-2-2-2-JDKåŠ¨æ€ä»£ç†" class="headerlink" title="17.2.2.2 JDKåŠ¨æ€ä»£ç†"></a>17.2.2.2 <strong>JDKåŠ¨æ€ä»£ç†</strong></h4><p>ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°ä¸Šé¢æ¡ˆä¾‹ï¼Œå…ˆè¯´è¯´JDKæä¾›çš„åŠ¨æ€ä»£ç†ã€‚Javaä¸­æä¾›äº†ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»Proxyï¼ŒProxyå¹¶ä¸æ˜¯æˆ‘ä»¬ä¸Šè¿°æ‰€è¯´çš„ä»£ç†å¯¹è±¡çš„ç±»ï¼Œè€Œæ˜¯æä¾›äº†ä¸€ä¸ªåˆ›å»ºä»£ç†å¯¹è±¡çš„é™æ€æ–¹æ³•ï¼ˆnewProxyInstanceæ–¹æ³•ï¼‰æ¥è·å–ä»£ç†å¯¹è±¡ã€‚</p>
<p><strong>SellTickets</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.jdk_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SellTickets</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å–ç¥¨æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Transition</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.jdk_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Transition</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç«è½¦ç«™ï¼Œå…·æœ‰å–ç¥¨åŠŸèƒ½ï¼Œå®ç°æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Transition</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ProxyFactory</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.jdk_proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ProxyFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä»£ç†å·¥å‚ ç”¨æ¥åˆ›å»ºä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:11</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Transition transition = <span class="keyword">new</span> Transition();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SellTickets <span class="title">getProxyObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨Proxyè·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="comment">/* newProxyInstance</span></span><br><span class="line"><span class="comment">        ClassLoader loader, ç±»åŠ è½½å™¨</span></span><br><span class="line"><span class="comment">        Class&lt;?&gt;[] interfaces, æ¥å£</span></span><br><span class="line"><span class="comment">        InvocationHandler h æ–¹æ³•</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        invoke æ–¹æ³•å‚æ•°è¯´æ˜</span></span><br><span class="line"><span class="comment">        proxy ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">        method å¯¹åº”äºåœ¨ä»£ç†å¯¹è±¡è°ƒç”¨çš„æ¥å£æ–¹æ³•çš„Methodå®ä¾‹</span></span><br><span class="line"><span class="comment">        args ä»£ç†å¯¹è±¡è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ä¼ é€’çš„å®é™…å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        SellTickets sellTickets = (SellTickets) Proxy.newProxyInstance(transition.getClass().getClassLoader(),</span><br><span class="line">                transition.getClass().getInterfaces()</span><br><span class="line">                , <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;ä»£å”®ç‚¹æ”¶å–æœåŠ¡è´¹(JDKåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">                        <span class="comment">//æ‰§è¡ŒçœŸå®å¯¹è±¡</span></span><br><span class="line">                        Object result = method.invoke(transition, args);</span><br><span class="line">                        <span class="keyword">return</span> result;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">return</span> sellTickets;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.jdk_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> JDKåŠ¨æ€ä»£ç† æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        ProxyFactory factory = <span class="keyword">new</span> ProxyFactory();</span><br><span class="line"></span><br><span class="line">        SellTickets proxyObject = factory.getProxyObject();</span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-20-12.png"></p>
<p><font color="red">ä½¿ç”¨äº†åŠ¨æ€ä»£ç†ï¼Œæˆ‘ä»¬æ€è€ƒä¸‹é¢é—®é¢˜ï¼š</font></p>
<ul>
<li><p>ProxyFactoryæ˜¯ä»£ç†ç±»å—ï¼Ÿ</p>
<p>ProxyFactoryä¸æ˜¯ä»£ç†æ¨¡å¼ä¸­æ‰€è¯´çš„ä»£ç†ç±»ï¼Œè€Œä»£ç†ç±»æ˜¯ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€çš„åœ¨å†…å­˜ä¸­ç”Ÿæˆçš„ç±»ã€‚é€šè¿‡é˜¿é‡Œå·´å·´å¼€æºçš„ Java è¯Šæ–­å·¥å…·ï¼ˆArthasã€é˜¿å°”è¨æ–¯ã€‘ï¼‰æŸ¥çœ‹ä»£ç†ç±»çš„ç»“æ„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sun.proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itheima.proxy.dynamic.jdk.SellTickets;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.UndeclaredThrowableException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> $<span class="title">Proxy0</span> <span class="keyword">extends</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m3;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m0;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy0(InvocationHandler invocationHandler) &#123;</span><br><span class="line">        <span class="keyword">super</span>(invocationHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            m1 = Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>).getMethod(<span class="string">&quot;equals&quot;</span>, Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>));</span><br><span class="line">            m2 = Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>).getMethod(<span class="string">&quot;toString&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">            m3 = Class.forName(<span class="string">&quot;com.itheima.proxy.dynamic.jdk.SellTickets&quot;</span>).getMethod(<span class="string">&quot;sell&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">            m0 = Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>).getMethod(<span class="string">&quot;hashCode&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (NoSuchMethodException noSuchMethodException) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchMethodError(noSuchMethodException.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (ClassNotFoundException classNotFoundException) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoClassDefFoundError(classNotFoundException.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Boolean)<span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m1, <span class="keyword">new</span> Object[]&#123;object&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (String)<span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m2, <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Integer)<span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m0, <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m3, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»ä¸Šé¢çš„ç±»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å‡ ä¸ªä¿¡æ¯ï¼š</p>
<ul>
<li>ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰å®ç°äº†SellTicketsã€‚è¿™ä¹Ÿå°±å°è¯äº†æˆ‘ä»¬ä¹‹å‰è¯´çš„çœŸå®ç±»å’Œä»£ç†ç±»å®ç°åŒæ ·çš„æ¥å£ã€‚</li>
<li>ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰å°†æˆ‘ä»¬æä¾›äº†çš„åŒ¿åå†…éƒ¨ç±»å¯¹è±¡ä¼ é€’ç»™äº†çˆ¶ç±»ã€‚</li>
</ul>
</li>
<li><p>åŠ¨æ€ä»£ç†çš„æ‰§è¡Œæµç¨‹æ˜¯ä»€ä¹ˆæ ·ï¼Ÿ</p>
<p>ä¸‹é¢æ˜¯æ‘˜å–çš„é‡ç‚¹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> $<span class="title">Proxy0</span> <span class="keyword">extends</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m3;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy0(InvocationHandler invocationHandler) &#123;</span><br><span class="line">        <span class="keyword">super</span>(invocationHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        m3 = Class.forName(<span class="string">&quot;com.itheima.proxy.dynamic.jdk.SellTickets&quot;</span>).getMethod(<span class="string">&quot;sell&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m3, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Javaæä¾›çš„åŠ¨æ€ä»£ç†ç›¸å…³ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> InvocationHandler h;</span><br><span class="line">	 </span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="title">Proxy</span><span class="params">(InvocationHandler h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.h = h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»£ç†å·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TrainStation station = <span class="keyword">new</span> TrainStation();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SellTickets <span class="title">getProxyObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SellTickets sellTickets = (SellTickets) Proxy.newProxyInstance(station.getClass().getClassLoader(),</span><br><span class="line">                station.getClass().getInterfaces(),</span><br><span class="line">                <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">                    </span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">                        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨(JDKåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">                        Object result = method.invoke(station, args);</span><br><span class="line">                        <span class="keyword">return</span> result;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">return</span> sellTickets;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•è®¿é—®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        ProxyFactory factory = <span class="keyword">new</span> ProxyFactory();</span><br><span class="line">        SellTickets proxyObject = factory.getProxyObject();</span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>åœ¨æµ‹è¯•ç±»ä¸­é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨sell()æ–¹æ³•</li>
<li>æ ¹æ®å¤šæ€çš„ç‰¹æ€§ï¼Œæ‰§è¡Œçš„æ˜¯ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„sell()æ–¹æ³•</li>
<li>ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„sell()æ–¹æ³•ä¸­åˆè°ƒç”¨äº†InvocationHandleræ¥å£çš„å­å®ç°ç±»å¯¹è±¡çš„invokeæ–¹æ³•</li>
<li>invokeæ–¹æ³•é€šè¿‡åå°„æ‰§è¡Œäº†çœŸå®å¯¹è±¡æ‰€å±ç±»(TrainStation)ä¸­çš„sell()æ–¹æ³•</li>
</ol>
<h4 id="17-2-2-3-CGLBä»£ç†"><a href="#17-2-2-3-CGLBä»£ç†" class="headerlink" title="17.2.2.3 CGLBä»£ç†"></a>17.2.2.3 <strong>CGLBä»£ç†</strong></h4><p><strong>TrainStation</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.cglib_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> TrainStation</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç«è½¦ç«™ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:31</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainStation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ProxyFactory</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.cglib_proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.Enhancer;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ProxyFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä»£ç†å·¥å‚ å®ç°MethodInterceptor</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TrainStation target = <span class="keyword">new</span> TrainStation();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TrainStation <span class="title">getProxyObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºEnhancerå¯¹è±¡  ç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†</span></span><br><span class="line">        Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">        <span class="comment">//è®¾ç½®çˆ¶ç±»çš„å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">        enhancer.setSuperclass(target.getClass());</span><br><span class="line">        <span class="comment">//è®¾ç½®å›è°ƒå‡½æ•°</span></span><br><span class="line">        enhancer.setCallback(<span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºä»£ç†å¯¹è±¡</span></span><br><span class="line">        TrainStation obj = (TrainStation) enhancer.create();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object o, Method method, Object[] args, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»£æ”¶ç‚¹æ”¶å–ä¸€äº›ä»£ç†è´¹ç”¨(CGLIBåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">        Object result = methodProxy.invokeSuper(o, args);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.proxy.cglib_proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> CGLIBåŠ¨æ€ä»£ç†æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/26 8:42</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä»£ç†å·¥å‚å¯¹è±¡</span></span><br><span class="line">        ProxyFactory factory = <span class="keyword">new</span> ProxyFactory();</span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        TrainStation proxyObject = factory.getProxyObject();</span><br><span class="line"></span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-20-23.png"></p>
<h3 id="17-2-3-ä¸‰ç§ä»£ç†çš„å¯¹æ¯”"><a href="#17-2-3-ä¸‰ç§ä»£ç†çš„å¯¹æ¯”" class="headerlink" title="17.2.3 ä¸‰ç§ä»£ç†çš„å¯¹æ¯”"></a>17.2.3 ä¸‰ç§ä»£ç†çš„å¯¹æ¯”</h3><ul>
<li><p>jdkä»£ç†å’ŒCGLIBä»£ç†</p>
<p>ä½¿ç”¨CGLibå®ç°åŠ¨æ€ä»£ç†ï¼ŒCGLibåº•å±‚é‡‡ç”¨ASMå­—èŠ‚ç ç”Ÿæˆæ¡†æ¶ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯ç”Ÿæˆä»£ç†ç±»ï¼Œåœ¨JDK1.6ä¹‹å‰æ¯”ä½¿ç”¨Javaåå°„æ•ˆç‡è¦é«˜ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCGLibä¸èƒ½å¯¹å£°æ˜ä¸ºfinalçš„ç±»æˆ–è€…æ–¹æ³•è¿›è¡Œä»£ç†ï¼Œå› ä¸ºCGLibåŸç†æ˜¯åŠ¨æ€ç”Ÿæˆè¢«ä»£ç†ç±»çš„å­ç±»ã€‚</p>
<p>åœ¨JDK1.6ã€JDK1.7ã€JDK1.8é€æ­¥å¯¹JDKåŠ¨æ€ä»£ç†ä¼˜åŒ–ä¹‹åï¼Œåœ¨è°ƒç”¨æ¬¡æ•°è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒJDKä»£ç†æ•ˆç‡é«˜äºCGLibä»£ç†æ•ˆç‡ï¼Œåªæœ‰å½“è¿›è¡Œå¤§é‡è°ƒç”¨çš„æ—¶å€™ï¼ŒJDK1.6å’ŒJDK1.7æ¯”CGLibä»£ç†æ•ˆç‡ä½ä¸€ç‚¹ï¼Œä½†æ˜¯åˆ°JDK1.8çš„æ—¶å€™ï¼ŒJDKä»£ç†æ•ˆç‡é«˜äºCGLibä»£ç†ã€‚æ‰€ä»¥å¦‚æœæœ‰æ¥å£ä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼Œå¦‚æœæ²¡æœ‰æ¥å£ä½¿ç”¨CGLIBä»£ç†ã€‚</p>
</li>
<li><p>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†</p>
<p>åŠ¨æ€ä»£ç†ä¸é™æ€ä»£ç†ç›¸æ¯”è¾ƒï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯æ¥å£ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•éƒ½è¢«è½¬ç§»åˆ°è°ƒç”¨å¤„ç†å™¨ä¸€ä¸ªé›†ä¸­çš„æ–¹æ³•ä¸­å¤„ç†ï¼ˆInvocationHandler.invokeï¼‰ã€‚è¿™æ ·ï¼Œåœ¨æ¥å£æ–¹æ³•æ•°é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œçµæ´»å¤„ç†ï¼Œè€Œä¸éœ€è¦åƒé™æ€ä»£ç†é‚£æ ·æ¯ä¸€ä¸ªæ–¹æ³•è¿›è¡Œä¸­è½¬ã€‚</p>
<p>å¦‚æœæ¥å£å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé™æ€ä»£ç†æ¨¡å¼é™¤äº†æ‰€æœ‰å®ç°ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•å¤–ï¼Œæ‰€æœ‰ä»£ç†ç±»ä¹Ÿéœ€è¦å®ç°æ­¤æ–¹æ³•ã€‚å¢åŠ äº†ä»£ç ç»´æŠ¤çš„å¤æ‚åº¦ã€‚è€ŒåŠ¨æ€ä»£ç†ä¸ä¼šå‡ºç°è¯¥é—®é¢˜</p>
</li>
</ul>
<h2 id="17-3-ä»£ç†æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#17-3-ä»£ç†æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="17.3 ä»£ç†æ¨¡å¼åº”ç”¨åœºæ™¯"></a>17.3 ä»£ç†æ¨¡å¼åº”ç”¨åœºæ™¯</h2><ul>
<li><p>è¿œç¨‹ï¼ˆRemoteï¼‰ä»£ç†</p>
<p>æœ¬åœ°æœåŠ¡é€šè¿‡ç½‘ç»œè¯·æ±‚è¿œç¨‹æœåŠ¡ã€‚ä¸ºäº†å®ç°æœ¬åœ°åˆ°è¿œç¨‹çš„é€šä¿¡ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ç½‘ç»œé€šä¿¡ï¼Œå¤„ç†å…¶ä¸­å¯èƒ½çš„å¼‚å¸¸ã€‚ä¸ºè‰¯å¥½çš„ä»£ç è®¾è®¡å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬å°†ç½‘ç»œé€šä¿¡éƒ¨åˆ†éšè—èµ·æ¥ï¼Œåªæš´éœ²ç»™æœ¬åœ°æœåŠ¡ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡è¯¥æ¥å£å³å¯è®¿é—®è¿œç¨‹æœåŠ¡æä¾›çš„åŠŸèƒ½ï¼Œè€Œä¸å¿…è¿‡å¤šå…³å¿ƒé€šä¿¡éƒ¨åˆ†çš„ç»†èŠ‚ã€‚</p>
</li>
<li><p>é˜²ç«å¢™ï¼ˆFirewallï¼‰ä»£ç†</p>
<p>å½“ä½ å°†æµè§ˆå™¨é…ç½®æˆä½¿ç”¨ä»£ç†åŠŸèƒ½æ—¶ï¼Œé˜²ç«å¢™å°±å°†ä½ çš„æµè§ˆå™¨çš„è¯·æ±‚è½¬ç»™äº’è”ç½‘ï¼›å½“äº’è”ç½‘è¿”å›å“åº”æ—¶ï¼Œä»£ç†æœåŠ¡å™¨å†æŠŠå®ƒè½¬ç»™ä½ çš„æµè§ˆå™¨ã€‚</p>
</li>
<li><p>ä¿æŠ¤ï¼ˆProtect or Accessï¼‰ä»£ç†</p>
<p>æ§åˆ¶å¯¹ä¸€ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ç»™ä¸åŒçš„ç”¨æˆ·æä¾›ä¸åŒçº§åˆ«çš„ä½¿ç”¨æƒé™ã€‚</p>
</li>
</ul>
<h1 id="18ï¼Œå‘½ä»¤æ¨¡å¼"><a href="#18ï¼Œå‘½ä»¤æ¨¡å¼" class="headerlink" title="18ï¼Œå‘½ä»¤æ¨¡å¼"></a>18ï¼Œå‘½ä»¤æ¨¡å¼</h1><h2 id="18-1-å‘½ä»¤æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#18-1-å‘½ä»¤æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="18.1 å‘½ä»¤æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>18.1 å‘½ä»¤æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>å‘½ä»¤ï¼ˆCommandï¼‰æ¨¡å¼çš„å®šä¹‰å¦‚ä¸‹ï¼š<strong>å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å‘å‡ºè¯·æ±‚çš„è´£ä»»å’Œæ‰§è¡Œè¯·æ±‚çš„è´£ä»»åˆ†å‰²å¼€ã€‚</strong>è¿™æ ·ä¸¤è€…ä¹‹é—´é€šè¿‡å‘½ä»¤å¯¹è±¡è¿›è¡Œæ²Ÿé€šï¼Œè¿™æ ·æ–¹ä¾¿å°†å‘½ä»¤å¯¹è±¡è¿›è¡Œå‚¨å­˜ã€ä¼ é€’ã€è°ƒç”¨ã€å¢åŠ ä¸ç®¡ç†ã€‚</p>
<p><strong>å‘½ä»¤æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>é€šè¿‡å¼•å…¥ä¸­é—´ä»¶ï¼ˆæŠ½è±¡æ¥å£ï¼‰é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚</li>
<li>æ‰©å±•æ€§è‰¯å¥½ï¼Œå¢åŠ æˆ–åˆ é™¤å‘½ä»¤éå¸¸æ–¹ä¾¿ã€‚é‡‡ç”¨å‘½ä»¤æ¨¡å¼å¢åŠ ä¸åˆ é™¤å‘½ä»¤ä¸ä¼šå½±å“å…¶ä»–ç±»ï¼Œä¸”æ»¡è¶³â€œå¼€é—­åŸåˆ™â€ã€‚</li>
<li>å¯ä»¥å®ç°å®å‘½ä»¤ã€‚å‘½ä»¤æ¨¡å¼å¯ä»¥ä¸<strong>ç»„åˆæ¨¡å¼</strong>ç»“åˆï¼Œå°†å¤šä¸ªå‘½ä»¤è£…é…æˆä¸€ä¸ªç»„åˆå‘½ä»¤ï¼Œå³å®å‘½ä»¤ã€‚</li>
<li>æ–¹ä¾¿å®ç° Undo å’Œ Redo æ“ä½œã€‚å‘½ä»¤æ¨¡å¼å¯ä»¥ä¸åé¢ä»‹ç»çš„å¤‡å¿˜å½•æ¨¡å¼ç»“åˆï¼Œå®ç°å‘½ä»¤çš„æ’¤é”€ä¸æ¢å¤ã€‚</li>
<li>å¯ä»¥åœ¨ç°æœ‰å‘½ä»¤çš„åŸºç¡€ä¸Šï¼Œå¢åŠ é¢å¤–åŠŸèƒ½ã€‚æ¯”å¦‚æ—¥å¿—è®°å½•ï¼Œç»“åˆè£…é¥°å™¨æ¨¡å¼ä¼šæ›´åŠ çµæ´»ã€‚</li>
</ol>
<p>å…¶ç¼ºç‚¹æ˜¯ï¼š</p>
<ol>
<li>å¯èƒ½äº§ç”Ÿå¤§é‡å…·ä½“çš„å‘½ä»¤ç±»ã€‚å› ä¸ºæ¯ä¸€ä¸ªå…·ä½“æ“ä½œéƒ½éœ€è¦è®¾è®¡ä¸€ä¸ªå…·ä½“å‘½ä»¤ç±»ï¼Œè¿™ä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</li>
<li>å‘½ä»¤æ¨¡å¼çš„ç»“æœå…¶å®å°±æ˜¯æ¥æ”¶æ–¹çš„æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¸ºäº†ä»¥å‘½ä»¤çš„å½¢å¼è¿›è¡Œæ¶æ„ã€è§£è€¦è¯·æ±‚ä¸å®ç°ï¼Œå¼•å…¥äº†é¢å¤–ç±»å‹ç»“æ„ï¼ˆå¼•å…¥äº†è¯·æ±‚æ–¹ä¸æŠ½è±¡å‘½ä»¤æ¥å£ï¼‰ï¼Œå¢åŠ äº†ç†è§£ä¸Šçš„å›°éš¾ã€‚ä¸è¿‡è¿™ä¹Ÿæ˜¯è®¾è®¡æ¨¡å¼çš„é€šç—…ï¼ŒæŠ½è±¡å¿…ç„¶ä¼šé¢å¤–å¢åŠ ç±»çš„æ•°é‡ï¼Œä»£ç æŠ½ç¦»è‚¯å®šæ¯”ä»£ç èšåˆæ›´åŠ éš¾ç†è§£ã€‚</li>
</ol>
<h2 id="18-2-å‘½ä»¤æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#18-2-å‘½ä»¤æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="18.2 å‘½ä»¤æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>18.2 å‘½ä»¤æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="18-2-1-å‘½ä»¤æ¨¡å¼çš„ç»“æ„"><a href="#18-2-1-å‘½ä»¤æ¨¡å¼çš„ç»“æ„" class="headerlink" title="18.2.1 å‘½ä»¤æ¨¡å¼çš„ç»“æ„"></a>18.2.1 å‘½ä»¤æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡å‘½ä»¤ç±»ï¼ˆCommandï¼‰è§’è‰²ï¼šå£°æ˜æ‰§è¡Œå‘½ä»¤çš„æ¥å£ï¼Œæ‹¥æœ‰æ‰§è¡Œå‘½ä»¤çš„æŠ½è±¡æ–¹æ³• execute()ã€‚</li>
<li>å…·ä½“å‘½ä»¤ç±»ï¼ˆConcrete Commandï¼‰è§’è‰²ï¼šæ˜¯æŠ½è±¡å‘½ä»¤ç±»çš„å…·ä½“å®ç°ç±»ï¼Œå®ƒæ‹¥æœ‰æ¥æ”¶è€…å¯¹è±¡ï¼Œå¹¶é€šè¿‡è°ƒç”¨æ¥æ”¶è€…çš„åŠŸèƒ½æ¥å®Œæˆå‘½ä»¤è¦æ‰§è¡Œçš„æ“ä½œã€‚</li>
<li>å®ç°è€…/æ¥æ”¶è€…ï¼ˆReceiverï¼‰è§’è‰²ï¼šæ‰§è¡Œå‘½ä»¤åŠŸèƒ½çš„ç›¸å…³æ“ä½œï¼Œæ˜¯å…·ä½“å‘½ä»¤å¯¹è±¡ä¸šåŠ¡çš„çœŸæ­£å®ç°è€…ã€‚</li>
<li>è°ƒç”¨è€…/è¯·æ±‚è€…ï¼ˆInvokerï¼‰è§’è‰²ï¼šæ˜¯è¯·æ±‚çš„å‘é€è€…ï¼Œå®ƒé€šå¸¸æ‹¥æœ‰å¾ˆå¤šçš„å‘½ä»¤å¯¹è±¡ï¼Œå¹¶é€šè¿‡è®¿é—®å‘½ä»¤å¯¹è±¡æ¥æ‰§è¡Œç›¸å…³è¯·æ±‚ï¼Œå®ƒä¸ç›´æ¥è®¿é—®æ¥æ”¶è€…ã€‚</li>
</ol>
<h3 id="18-2-2-ä»£ç å®ç°"><a href="#18-2-2-ä»£ç å®ç°" class="headerlink" title="18.2.2 ä»£ç å®ç°"></a>18.2.2 ä»£ç å®ç°</h3><p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_22-49-15.png"></p>
<p><strong>Command</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Command</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡å‘½ä»¤ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 10:25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>; <span class="comment">// åªéœ€è¦å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OrderCommand</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> OrderCommand</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  å…·ä½“å‘½ä»¤ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 10:25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderCommand</span> <span class="keyword">implements</span> <span class="title">Command</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒæœ‰æ¥å—è€…å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> SeniorChef receiver;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Order order;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrderCommand</span><span class="params">(SeniorChef receiver, Order order)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">        <span class="keyword">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(order.getDiningTable()+<span class="string">&quot;æ¡Œçš„è®¢å•ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String key : order.getFoodDic().keySet()) &#123;</span><br><span class="line">            receiver.makefood(order.getFoodDic().get(key),key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>); <span class="comment">//æ¨¡æ‹Ÿåšé¥­ ç¡çœ 1ç§’</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(order.getDiningTable()+<span class="string">&quot;æ¡Œçš„é¥­å¼„å¥½äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Order</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.command;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Order</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è®¢å•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 10:34</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é¤æ¡Œå·ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> diningTable;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”¨æ¥å­˜å‚¨é¤åå¹¶è®°å½•</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Integer&gt; foodDic = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDiningTable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> diningTable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDiningTable</span><span class="params">(<span class="keyword">int</span> diningTable)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.diningTable = diningTable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Integer&gt; <span class="title">getFoodDic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> foodDic;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFoodDic</span><span class="params">(String name, <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        foodDic.put(name, num);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SeniorChef</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SeniorChef</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å¨å¸ˆç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 10:27</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SeniorChef</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¤§å¨å¸ˆç±» æ˜¯å‘½ä»¤çš„Receiver</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makefood</span><span class="params">(<span class="keyword">int</span> num, String foodName)</span> </span>&#123;</span><br><span class="line">        System.out.println(num + <span class="string">&quot;ä»½&quot;</span> + foodName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Waitor</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.command;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Waitor</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æœåŠ¡å‘˜ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 10:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Waitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯ä»¥æŒæœ‰å¾ˆå¤šå‘½ä»¤å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Command&gt; commands;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Waitor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        commands = <span class="keyword">new</span> ArrayList&lt;Command&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommands</span><span class="params">(Command cmd)</span> </span>&#123;</span><br><span class="line">        commands.add(cmd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘å‡ºå‘½ä»¤ è®¢å•æ¥äº† å¤§å¨å¸ˆå¼€å§‹æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¥æ´»äº†...&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; commands.size(); i++) &#123;</span><br><span class="line">            Command cmd = commands.get(i);</span><br><span class="line">            <span class="keyword">if</span> (cmd != <span class="keyword">null</span>) &#123;</span><br><span class="line">                cmd.execute();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å‘½ä»¤æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 10:44</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºorder</span></span><br><span class="line">        Order order1 = <span class="keyword">new</span> Order();</span><br><span class="line">        order1.setDiningTable(<span class="number">1</span>);</span><br><span class="line">        order1.getFoodDic().put(<span class="string">&quot;è¥¿çº¢æŸ¿ç‚’é¸¡è›‹&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        order1.getFoodDic().put(<span class="string">&quot;ç½è£…å¯ä¹&quot;</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        Order order2 = <span class="keyword">new</span> Order();</span><br><span class="line">        order2.setDiningTable(<span class="number">2</span>);</span><br><span class="line">        order2.getFoodDic().put(<span class="string">&quot;é…¸æºœåœŸè±†ä¸&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        order2.getFoodDic().put(<span class="string">&quot;ç‹è€å‰&quot;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºæ¥å—è€…</span></span><br><span class="line">        SeniorChef receiver = <span class="keyword">new</span> SeniorChef();</span><br><span class="line">        <span class="comment">//å°†è®¢å•å’Œæ¥å—è€…å°è£…æˆå‘½ä»¤å¯¹è±¡</span></span><br><span class="line">        OrderCommand cmd1 = <span class="keyword">new</span> OrderCommand(receiver, order1);</span><br><span class="line">        OrderCommand cmd2 = <span class="keyword">new</span> OrderCommand(receiver, order2);</span><br><span class="line">        <span class="comment">//åˆ›å»ºè°ƒç”¨è€… waitor</span></span><br><span class="line">        Waitor invoke = <span class="keyword">new</span> Waitor();</span><br><span class="line">        invoke.setCommands(cmd1);</span><br><span class="line">        invoke.setCommands(cmd2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†è®¢å•ç»™æŸœå° å‘¼å«å¨å¸ˆ</span></span><br><span class="line">        invoke.orderUp();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-20-52.png"></p>
<h2 id="18-3-å‘½ä»¤æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#18-3-å‘½ä»¤æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="18.3 å‘½ä»¤æ¨¡å¼åº”ç”¨åœºæ™¯"></a>18.3 å‘½ä»¤æ¨¡å¼åº”ç”¨åœºæ™¯</h2><ul>
<li>ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥æ”¶è€…ä¸ç›´æ¥äº¤äº’ã€‚</li>
<li>ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿå’Œæ‰§è¡Œè¯·æ±‚ã€‚</li>
<li>ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€(Undo)æ“ä½œå’Œæ¢å¤(Redo)æ“ä½œã€‚</li>
</ul>
<h2 id="18-4-JDKæºç è§£æ"><a href="#18-4-JDKæºç è§£æ" class="headerlink" title="18.4 JDKæºç è§£æ"></a>18.4 JDKæºç è§£æ</h2><p>Runableæ˜¯ä¸€ä¸ªå…¸å‹å‘½ä»¤æ¨¡å¼ï¼ŒRunnableæ‹…å½“å‘½ä»¤çš„è§’è‰²ï¼ŒThreadå……å½“çš„æ˜¯è°ƒç”¨è€…ï¼Œstartæ–¹æ³•å°±æ˜¯å…¶æ‰§è¡Œæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å‘½ä»¤æ¥å£(æŠ½è±¡å‘½ä»¤è§’è‰²)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Runnable target;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (threadStatus != <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalThreadStateException();</span><br><span class="line"></span><br><span class="line">        group.add(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> started = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            start0();</span><br><span class="line">            started = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!started) &#123;</span><br><span class="line">                    group.threadStartFailed(<span class="keyword">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable ignore) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">start0</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼šè°ƒç”¨ä¸€ä¸ªnativeæ–¹æ³•start0(),è°ƒç”¨ç³»ç»Ÿæ–¹æ³•ï¼Œå¼€å¯ä¸€ä¸ªçº¿ç¨‹ã€‚è€Œæ¥æ”¶è€…æ˜¯å¯¹ç¨‹åºå‘˜å¼€æ”¾çš„ï¼Œå¯ä»¥è‡ªå·±å®šä¹‰æ¥æ”¶è€…ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdk Runnable å‘½ä»¤æ¨¡å¼</span></span><br><span class="line"><span class="comment"> *		TurnOffThread ï¼š å±äºå…·ä½“</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TurnOffThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">     <span class="keyword">private</span> Receiver receiver;</span><br><span class="line">    </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">TurnOffThread</span><span class="params">(Receiver receiver)</span> </span>&#123;</span><br><span class="line">     	<span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     	receiver.turnOFF();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         Receiver receiver = <span class="keyword">new</span> Receiver();</span><br><span class="line">         TurnOffThread turnOffThread = <span class="keyword">new</span> TurnOffThread(receiver);</span><br><span class="line">         Thread thread = <span class="keyword">new</span> Thread(turnOffThread);</span><br><span class="line">         thread.start();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="19ï¼Œè®¿é—®è€…æ¨¡å¼"><a href="#19ï¼Œè®¿é—®è€…æ¨¡å¼" class="headerlink" title="19ï¼Œè®¿é—®è€…æ¨¡å¼"></a>19ï¼Œè®¿é—®è€…æ¨¡å¼</h1><h2 id="19-1-è®¿é—®è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#19-1-è®¿é—®è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="19.1 è®¿é—®è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>19.1 è®¿é—®è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>å°†ä½œç”¨äºæŸç§æ•°æ®ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œåˆ†ç¦»å‡ºæ¥å°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œä½¿å…¶åœ¨ä¸æ”¹å˜æ•°æ®ç»“æ„çš„å‰æä¸‹å¯ä»¥æ·»åŠ ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°çš„æ“ä½œï¼Œä¸ºæ•°æ®ç»“æ„ä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›å¤šç§è®¿é—®æ–¹å¼ã€‚</strong>å®ƒå°†å¯¹æ•°æ®çš„æ“ä½œä¸æ•°æ®ç»“æ„è¿›è¡Œåˆ†ç¦»ï¼Œæ˜¯è¡Œä¸ºç±»æ¨¡å¼ä¸­æœ€å¤æ‚çš„ä¸€ç§æ¨¡å¼ã€‚</p>
<p><strong>è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>æ‰©å±•æ€§å¥½ã€‚èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹å¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œä¸ºå¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚</li>
<li>å¤ç”¨æ€§å¥½ã€‚å¯ä»¥é€šè¿‡è®¿é—®è€…æ¥å®šä¹‰æ•´ä¸ªå¯¹è±¡ç»“æ„é€šç”¨çš„åŠŸèƒ½ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¤ç”¨ç¨‹åº¦ã€‚</li>
<li>çµæ´»æ€§å¥½ã€‚è®¿é—®è€…æ¨¡å¼å°†æ•°æ®ç»“æ„ä¸ä½œç”¨äºç»“æ„ä¸Šçš„æ“ä½œè§£è€¦ï¼Œä½¿å¾—æ“ä½œé›†åˆå¯ç›¸å¯¹è‡ªç”±åœ°æ¼”åŒ–è€Œä¸å½±å“ç³»ç»Ÿçš„æ•°æ®ç»“æ„ã€‚</li>
<li>ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚è®¿é—®è€…æ¨¡å¼æŠŠç›¸å…³çš„è¡Œä¸ºå°è£…åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ªè®¿é—®è€…ï¼Œä½¿æ¯ä¸€ä¸ªè®¿é—®è€…çš„åŠŸèƒ½éƒ½æ¯”è¾ƒå•ä¸€ã€‚</li>
</ol>
<p><strong>è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼çš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>å¢åŠ æ–°çš„å…ƒç´ ç±»å¾ˆå›°éš¾ã€‚åœ¨è®¿é—®è€…æ¨¡å¼ä¸­ï¼Œæ¯å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ ç±»ï¼Œéƒ½è¦åœ¨æ¯ä¸€ä¸ªå…·ä½“è®¿é—®è€…ç±»ä¸­å¢åŠ ç›¸åº”çš„å…·ä½“æ“ä½œï¼Œè¿™è¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</li>
<li>ç ´åå°è£…ã€‚è®¿é—®è€…æ¨¡å¼ä¸­å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œè¿™ç ´åäº†å¯¹è±¡çš„å°è£…æ€§ã€‚</li>
<li>è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ã€‚è®¿é—®è€…æ¨¡å¼ä¾èµ–äº†å…·ä½“ç±»ï¼Œè€Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ç±»ã€‚</li>
</ol>
<h2 id="19-2-è®¿é—®è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#19-2-è®¿é—®è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="19.2 è®¿é—®è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>19.2 è®¿é—®è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="19-2-1-è®¿é—®è€…æ¨¡å¼çš„ç»“æ„"><a href="#19-2-1-è®¿é—®è€…æ¨¡å¼çš„ç»“æ„" class="headerlink" title="19.2.1 è®¿é—®è€…æ¨¡å¼çš„ç»“æ„"></a>19.2.1 è®¿é—®è€…æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡è®¿é—®è€…ï¼ˆVisitorï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªè®¿é—®å…·ä½“å…ƒç´ çš„æ¥å£ï¼Œä¸ºæ¯ä¸ªå…·ä½“å…ƒç´ ç±»å¯¹åº”ä¸€ä¸ªè®¿é—®æ“ä½œ visit() ï¼Œè¯¥æ“ä½œä¸­çš„å‚æ•°ç±»å‹æ ‡è¯†äº†è¢«è®¿é—®çš„å…·ä½“å…ƒç´ ã€‚</li>
<li>å…·ä½“è®¿é—®è€…ï¼ˆConcreteVisitorï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è®¿é—®è€…è§’è‰²ä¸­å£°æ˜çš„å„ä¸ªè®¿é—®æ“ä½œï¼Œç¡®å®šè®¿é—®è€…è®¿é—®ä¸€ä¸ªå…ƒç´ æ—¶è¯¥åšä»€ä¹ˆã€‚</li>
<li>æŠ½è±¡å…ƒç´ ï¼ˆElementï¼‰è§’è‰²ï¼šå£°æ˜ä¸€ä¸ªåŒ…å«æ¥å—æ“ä½œ accept() çš„æ¥å£ï¼Œè¢«æ¥å—çš„è®¿é—®è€…å¯¹è±¡ä½œä¸º accept() æ–¹æ³•çš„å‚æ•°ã€‚</li>
<li>å…·ä½“å…ƒç´ ï¼ˆConcreteElementï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡å…ƒç´ è§’è‰²æä¾›çš„ accept() æ“ä½œï¼Œå…¶æ–¹æ³•ä½“é€šå¸¸éƒ½æ˜¯ visitor.visit(this) ï¼Œå¦å¤–å…·ä½“å…ƒç´ ä¸­å¯èƒ½è¿˜åŒ…å«æœ¬èº«ä¸šåŠ¡é€»è¾‘çš„ç›¸å…³æ“ä½œã€‚</li>
<li>å¯¹è±¡ç»“æ„ï¼ˆObject Structureï¼‰è§’è‰²ï¼šæ˜¯ä¸€ä¸ªåŒ…å«å…ƒç´ è§’è‰²çš„å®¹å™¨ï¼Œæä¾›è®©è®¿é—®è€…å¯¹è±¡éå†å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ çš„æ–¹æ³•ï¼Œé€šå¸¸ç”± Listã€Setã€Map ç­‰èšåˆç±»å®ç°ã€‚</li>
</ol>
<h3 id="19-2-2-ä»£ç å®ç°"><a href="#19-2-2-ä»£ç å®ç°" class="headerlink" title="19.2.2 ä»£ç å®ç°"></a>19.2.2 ä»£ç å®ç°</h3><p>ç°åœ¨å…»å® ç‰©çš„äººç‰¹åˆ«å¤šï¼Œæˆ‘ä»¬å°±ä»¥è¿™ä¸ªä¸ºä¾‹ï¼Œå½“ç„¶å® ç‰©è¿˜åˆ†ä¸ºç‹—ï¼ŒçŒ«ç­‰ï¼Œè¦ç»™å® ç‰©å–‚é£Ÿçš„è¯ï¼Œä¸»äººå¯ä»¥å–‚ï¼Œå…¶ä»–äººä¹Ÿå¯ä»¥å–‚é£Ÿã€‚</p>
<ul>
<li>è®¿é—®è€…è§’è‰²ï¼šç»™å® ç‰©å–‚é£Ÿçš„äºº</li>
<li>å…·ä½“è®¿é—®è€…è§’è‰²ï¼šä¸»äººã€å…¶ä»–äºº</li>
<li>æŠ½è±¡å…ƒç´ è§’è‰²ï¼šåŠ¨ç‰©æŠ½è±¡ç±»</li>
<li>å…·ä½“å…ƒç´ è§’è‰²ï¼šå® ç‰©ç‹—ã€å® ç‰©çŒ«</li>
<li>ç»“æ„å¯¹è±¡è§’è‰²ï¼šä¸»äººå®¶</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_23-00-33.png"></p>
<p><strong>Person</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Person</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡è®¿é—®è€…æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å–‚å® ç‰©ç‹—</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">feed</span><span class="params">(Dog dog)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å–‚å® ç‰©çŒ«</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">feed</span><span class="params">(Cat cat)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Owner</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Owner</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“è®¿é—®è€…è§’è‰² ä¸»äººç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Owner</span> <span class="keyword">implements</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»äººå–‚é£Ÿå® ç‰©ç‹—...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»äººå–‚é£Ÿå® ç‰©çŒ«...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Someone</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Someone</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“è®¿é—®è€…è§’è‰² å…¶ä»–äººç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Someone</span> <span class="keyword">implements</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…¶ä»–äººå–‚é£Ÿå® ç‰©ç‹—...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…¶ä»–äººå–‚é£Ÿå® ç‰©çŒ«...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Animal</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Animal</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰æŠ½è±¡èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(Person person)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Dog</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Dog</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“èŠ‚ç‚¹ å®ç°Animalæ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">implements</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        person.feed(<span class="keyword">this</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;çœŸé¦™~ï¼Œæ±ªæ±ªæ±ªï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Cat</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Cat</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">implements</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        person.feed(<span class="keyword">this</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;çœŸé¦™~ï¼Œå–µå–µå–µï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Home</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Home</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰å¯¹è±¡ç»“æ„  ä¸»äººçš„å®¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Home</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Animal&gt; nodeList = <span class="keyword">new</span> ArrayList&lt;Animal&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Animal animal)</span> </span>&#123;</span><br><span class="line">        nodeList.add(animal);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">aciton</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Animal node : nodeList) &#123;</span><br><span class="line">            node.accept(person);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è®¿é—®è€…æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/27 16:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Home home = <span class="keyword">new</span> Home();</span><br><span class="line">        home.add(<span class="keyword">new</span> Dog());</span><br><span class="line">        home.add(<span class="keyword">new</span> Cat());</span><br><span class="line"></span><br><span class="line">        Owner owner = <span class="keyword">new</span> Owner();</span><br><span class="line">        home.aciton(owner);</span><br><span class="line">        System.out.println(<span class="string">&quot;===========================&quot;</span>);</span><br><span class="line">        Someone someone = <span class="keyword">new</span> Someone();</span><br><span class="line">        home.aciton(someone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-23-25.png"></p>
<h2 id="19-3-æ‰©å±•"><a href="#19-3-æ‰©å±•" class="headerlink" title="19.3 æ‰©å±•"></a>19.3 æ‰©å±•</h2><p>è®¿é—®è€…æ¨¡å¼ç”¨åˆ°äº†ä¸€ç§åŒåˆ†æ´¾çš„æŠ€æœ¯ã€‚</p>
<p><strong>1ï¼Œåˆ†æ´¾ï¼š</strong></p>
<p>å˜é‡è¢«å£°æ˜æ—¶çš„ç±»å‹å«åšå˜é‡çš„é™æ€ç±»å‹ï¼Œæœ‰äº›äººåˆæŠŠé™æ€ç±»å‹å«åšæ˜æ˜¾ç±»å‹ï¼›è€Œå˜é‡æ‰€å¼•ç”¨çš„å¯¹è±¡çš„çœŸå®ç±»å‹åˆå«åšå˜é‡çš„å®é™…ç±»å‹ã€‚æ¯”å¦‚ <code>Map map = new HashMap()</code> ï¼Œmapå˜é‡çš„é™æ€ç±»å‹æ˜¯ <code>Map</code> ï¼Œå®é™…ç±»å‹æ˜¯ <code>HashMap</code> ã€‚æ ¹æ®å¯¹è±¡çš„ç±»å‹è€Œå¯¹æ–¹æ³•è¿›è¡Œçš„é€‰æ‹©ï¼Œå°±æ˜¯åˆ†æ´¾(Dispatch)ï¼Œåˆ†æ´¾(Dispatch)åˆåˆ†ä¸ºä¸¤ç§ï¼Œå³é™æ€åˆ†æ´¾å’ŒåŠ¨æ€åˆ†æ´¾ã€‚</p>
<p><strong>é™æ€åˆ†æ´¾(Static Dispatch)</strong> å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶æœŸï¼Œåˆ†æ´¾æ ¹æ®é™æ€ç±»å‹ä¿¡æ¯å‘ç”Ÿã€‚é™æ€åˆ†æ´¾å¯¹äºæˆ‘ä»¬æ¥è¯´å¹¶ä¸é™Œç”Ÿï¼Œæ–¹æ³•é‡è½½å°±æ˜¯é™æ€åˆ†æ´¾ã€‚</p>
<p><strong>åŠ¨æ€åˆ†æ´¾(Dynamic Dispatch)</strong> å‘ç”Ÿåœ¨è¿è¡Œæ—¶æœŸï¼ŒåŠ¨æ€åˆ†æ´¾åŠ¨æ€åœ°ç½®æ¢æ‰æŸä¸ªæ–¹æ³•ã€‚Javaé€šè¿‡æ–¹æ³•çš„é‡å†™æ”¯æŒåŠ¨æ€åˆ†æ´¾ã€‚</p>
<p><strong>2ï¼ŒåŠ¨æ€åˆ†æ´¾ï¼š</strong></p>
<p>é€šè¿‡æ–¹æ³•çš„é‡å†™æ”¯æŒåŠ¨æ€åˆ†æ´¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯ç‹—...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯çŒ«...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">   	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Animal a = <span class="keyword">new</span> Dog();</span><br><span class="line">        a.execute();</span><br><span class="line">        </span><br><span class="line">        Animal a1 = <span class="keyword">new</span> Cat();</span><br><span class="line">        a1.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-27-14.png"></p>
<p>ä¸Šé¢ä»£ç çš„ç»“æœå¤§å®¶åº”è¯¥ç›´æ¥å¯ä»¥è¯´å‡ºæ¥ï¼Œè¿™ä¸å°±æ˜¯å¤šæ€å—ï¼è¿è¡Œæ‰§è¡Œçš„æ˜¯å­ç±»ä¸­çš„æ–¹æ³•ã€‚</p>
<p>Javaç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æœŸå¹¶ä¸æ€»æ˜¯çŸ¥é“å“ªäº›ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸ºç¼–è¯‘å™¨ä»…ä»…çŸ¥é“å¯¹è±¡çš„é™æ€ç±»å‹ï¼Œè€Œä¸çŸ¥é“å¯¹è±¡çš„çœŸå®ç±»å‹ï¼›è€Œæ–¹æ³•çš„è°ƒç”¨åˆ™æ˜¯æ ¹æ®å¯¹è±¡çš„çœŸå®ç±»å‹ï¼Œè€Œä¸æ˜¯é™æ€ç±»å‹ã€‚</p>
<p><strong>3ï¼Œé™æ€åˆ†æ´¾ï¼š</strong></p>
<p>é€šè¿‡æ–¹æ³•é‡è½½æ”¯æŒé™æ€åˆ†æ´¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Execute</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Animal a)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Dog d)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯ç‹—...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Cat c)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯çŒ«...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Animal a = <span class="keyword">new</span> Animal();</span><br><span class="line">        Animal a1 = <span class="keyword">new</span> Dog();</span><br><span class="line">        Animal a2 = <span class="keyword">new</span> Cat();</span><br><span class="line"></span><br><span class="line">        Execute exe = <span class="keyword">new</span> Execute();</span><br><span class="line">        exe.execute(a);</span><br><span class="line">        exe.execute(a1);</span><br><span class="line">        exe.execute(a2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-29-35.png"></p>
<p>è¿™ä¸ªç»“æœå¯èƒ½å‡ºä¹ä¸€äº›äººçš„æ„æ–™äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><strong>é‡è½½æ–¹æ³•çš„åˆ†æ´¾æ˜¯æ ¹æ®é™æ€ç±»å‹è¿›è¡Œçš„ï¼Œè¿™ä¸ªåˆ†æ´¾è¿‡ç¨‹åœ¨ç¼–è¯‘æ—¶æœŸå°±å®Œæˆäº†ã€‚</strong></p>
<p><strong>4ï¼ŒåŒåˆ†æ´¾ï¼š</strong></p>
<p>æ‰€è°“åŒåˆ†æ´¾æŠ€æœ¯å°±æ˜¯åœ¨é€‰æ‹©ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¸ä»…ä»…è¦æ ¹æ®æ¶ˆæ¯æ¥æ”¶è€…ï¼ˆreceiverï¼‰çš„è¿è¡Œæ—¶åŒºåˆ«ï¼Œè¿˜è¦æ ¹æ®å‚æ•°çš„è¿è¡Œæ—¶åŒºåˆ«ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Execute exe)</span> </span>&#123;</span><br><span class="line">        exe.execute(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Execute exe)</span> </span>&#123;</span><br><span class="line">        exe.execute(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Execute exe)</span> </span>&#123;</span><br><span class="line">        exe.execute(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Execute</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Animal a)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Dog d)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯ç‹—...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Cat c)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯çŒ«...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Animal a = <span class="keyword">new</span> Animal();</span><br><span class="line">        Animal d = <span class="keyword">new</span> Dog();</span><br><span class="line">        Animal c = <span class="keyword">new</span> Cat();</span><br><span class="line"></span><br><span class="line">        Execute exe = <span class="keyword">new</span> Execute();</span><br><span class="line">        a.accept(exe);</span><br><span class="line">        d.accept(exe);</span><br><span class="line">        c.accept(exe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œå®¢æˆ·ç«¯å°†Executeå¯¹è±¡åšä¸ºå‚æ•°ä¼ é€’ç»™Animalç±»å‹çš„å˜é‡è°ƒç”¨çš„æ–¹æ³•ï¼Œè¿™é‡Œå®Œæˆç¬¬ä¸€æ¬¡åˆ†æ´¾ï¼Œè¿™é‡Œæ˜¯æ–¹æ³•é‡å†™ï¼Œæ‰€ä»¥æ˜¯åŠ¨æ€åˆ†æ´¾ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œå®é™…ç±»å‹ä¸­çš„æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿ<code>å°†è‡ªå·±thisä½œä¸ºå‚æ•°ä¼ é€’è¿›å»ï¼Œè¿™é‡Œå°±å®Œæˆäº†ç¬¬äºŒæ¬¡åˆ†æ´¾</code>ï¼Œè¿™é‡Œçš„Executeç±»ä¸­æœ‰å¤šä¸ªé‡è½½çš„æ–¹æ³•ï¼Œè€Œä¼ é€’è¿›è¡Œçš„æ˜¯thisï¼Œå°±æ˜¯å…·ä½“çš„å®é™…ç±»å‹çš„å¯¹è±¡ã€‚</p>
<p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»æ˜ç™½åŒåˆ†æ´¾æ˜¯æ€ä¹ˆå›äº‹äº†ï¼Œä½†æ˜¯å®ƒæœ‰ä»€ä¹ˆæ•ˆæœå‘¢ï¼Ÿå°±æ˜¯å¯ä»¥å®ç°æ–¹æ³•çš„åŠ¨æ€ç»‘å®šï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸Šé¢çš„ç¨‹åºè¿›è¡Œä¿®æ”¹ã€‚</p>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-29-35.png"></p>
<p><strong>åŒåˆ†æ´¾å®ç°åŠ¨æ€ç»‘å®šçš„æœ¬è´¨ï¼Œå°±æ˜¯åœ¨é‡è½½æ–¹æ³•å§”æ´¾çš„å‰é¢åŠ ä¸Šäº†ç»§æ‰¿ä½“ç³»ä¸­è¦†ç›–çš„ç¯èŠ‚ï¼Œç”±äºè¦†ç›–æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥é‡è½½å°±æ˜¯åŠ¨æ€çš„äº†ã€‚</strong></p>
<h1 id="20ï¼Œè¿­ä»£å™¨æ¨¡å¼"><a href="#20ï¼Œè¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="20ï¼Œè¿­ä»£å™¨æ¨¡å¼"></a>20ï¼Œè¿­ä»£å™¨æ¨¡å¼</h1><h2 id="20-1-è¿­ä»£å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#20-1-è¿­ä»£å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="20.1 è¿­ä»£å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>20.1 è¿­ä»£å™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>è¿­ä»£å™¨ï¼ˆIteratorï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>æä¾›ä¸€ä¸ªå¯¹è±¡æ¥é¡ºåºè®¿é—®èšåˆå¯¹è±¡ä¸­çš„ä¸€ç³»åˆ—æ•°æ®ï¼Œè€Œä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</strong>è¿­ä»£å™¨æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œ<strong>å…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹</strong>ã€‚</p>
<ol>
<li>è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— é¡»æš´éœ²å®ƒçš„å†…éƒ¨è¡¨ç¤ºã€‚</li>
<li>éå†ä»»åŠ¡äº¤ç”±è¿­ä»£å™¨å®Œæˆï¼Œè¿™ç®€åŒ–äº†èšåˆç±»ã€‚</li>
<li>å®ƒæ”¯æŒä»¥ä¸åŒæ–¹å¼éå†ä¸€ä¸ªèšåˆï¼Œç”šè‡³å¯ä»¥è‡ªå®šä¹‰è¿­ä»£å™¨çš„å­ç±»ä»¥æ”¯æŒæ–°çš„éå†ã€‚</li>
<li>å¢åŠ æ–°çš„èšåˆç±»å’Œè¿­ä»£å™¨ç±»éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ä»£ç ã€‚</li>
<li>å°è£…æ€§è‰¯å¥½ï¼Œä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ã€‚</li>
</ol>
<p><strong>å…¶ä¸»è¦ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>å¢åŠ äº†ç±»çš„ä¸ªæ•°ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</li>
</ul>
<h2 id="20-2-è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#20-2-è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="20.2 è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>20.2 è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="20-2-1-è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„"><a href="#20-2-1-è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„" class="headerlink" title="20.2.1 è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„"></a>20.2.1 è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡èšåˆï¼ˆAggregateï¼‰è§’è‰²ï¼šå®šä¹‰å­˜å‚¨ã€æ·»åŠ ã€åˆ é™¤èšåˆå¯¹è±¡ä»¥åŠåˆ›å»ºè¿­ä»£å™¨å¯¹è±¡çš„æ¥å£ã€‚</li>
<li>å…·ä½“èšåˆï¼ˆConcreteAggregateï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡èšåˆç±»ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“è¿­ä»£å™¨çš„å®ä¾‹ã€‚</li>
<li>æŠ½è±¡è¿­ä»£å™¨ï¼ˆIteratorï¼‰è§’è‰²ï¼šå®šä¹‰è®¿é—®å’Œéå†èšåˆå…ƒç´ çš„æ¥å£ï¼Œé€šå¸¸åŒ…å« hasNext()ã€first()ã€next() ç­‰æ–¹æ³•ã€‚</li>
<li>å…·ä½“è¿­ä»£å™¨ï¼ˆConcretelteratorï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è¿­ä»£å™¨æ¥å£ä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ï¼Œå®Œæˆå¯¹èšåˆå¯¹è±¡çš„éå†ï¼Œè®°å½•éå†çš„å½“å‰ä½ç½®ã€‚</li>
</ol>
<h3 id="20-2-2-ä»£ç å®ç°"><a href="#20-2-2-ä»£ç å®ç°" class="headerlink" title="20.2.2 ä»£ç å®ç°"></a>20.2.2 ä»£ç å®ç°</h3><p>å®šä¹‰ä¸€ä¸ªå¯ä»¥å­˜å‚¨å­¦ç”Ÿå¯¹è±¡çš„å®¹å™¨å¯¹è±¡ï¼Œå°†éå†è¯¥å®¹å™¨çš„åŠŸèƒ½äº¤ç”±è¿­ä»£å™¨å®ç°</p>
<p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_23-08-48.png"></p>
<p><strong>Student</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Student</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å­¦ç”Ÿç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 12:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String number;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNumber</span><span class="params">(String number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name, String number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, number=&#x27;&quot;</span> + number + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StudentIterator</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StudentIterator</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¿­ä»£å™¨æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 12:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentIterator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Student <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StudentIteratorImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StudentIteratorImpl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“çš„è¿­ä»£å™¨ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 12:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentIteratorImpl</span> <span class="keyword">implements</span> <span class="title">StudentIterator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; list;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> position = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StudentIteratorImpl</span><span class="params">(List&lt;Student&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> position &lt; list.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Student currentStudent = list.get(position);</span><br><span class="line">        position++;</span><br><span class="line">        <span class="keyword">return</span> currentStudent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StudentAggregate</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StudentAggregate</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡å®¹å™¨ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 12:44</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentAggregate</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ·»åŠ å­¦ç”Ÿçš„åŠŸèƒ½</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤å­¦ç”Ÿçš„åŠŸèƒ½</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–è¿­ä»£å™¨åŠŸèƒ½çš„å¯¹è±¡</span></span><br><span class="line">    <span class="function">StudentIterator <span class="title">getStudentIterator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StudentAggregateImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StudentAggregateImpl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“çš„å®¹å™¨ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 12:44</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentAggregateImpl</span> <span class="keyword">implements</span> <span class="title">StudentAggregate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; list = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addStudent</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list.add(student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeStudent</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list.remove(student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> StudentIterator <span class="title">getStudentIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StudentIteratorImpl(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¿­ä»£å™¨æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 12:54</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StudentAggregateImpl aggregate = <span class="keyword">new</span> StudentAggregateImpl();</span><br><span class="line">        <span class="comment">//æ·»åŠ å…ƒç´ </span></span><br><span class="line">        aggregate.addStudent(<span class="keyword">new</span> Student(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;001&quot;</span>));</span><br><span class="line">        aggregate.addStudent(<span class="keyword">new</span> Student(<span class="string">&quot;æå››&quot;</span>, <span class="string">&quot;002&quot;</span>));</span><br><span class="line">        aggregate.addStudent(<span class="keyword">new</span> Student(<span class="string">&quot;ç‹äº”&quot;</span>, <span class="string">&quot;003&quot;</span>));</span><br><span class="line">        aggregate.addStudent(<span class="keyword">new</span> Student(<span class="string">&quot;èµµå…­&quot;</span>, <span class="string">&quot;004&quot;</span>));</span><br><span class="line">        aggregate.addStudent(<span class="keyword">new</span> Student(<span class="string">&quot;ç”°ä¸ƒ&quot;</span>, <span class="string">&quot;005&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//éå†èšåˆå¯¹è±¡</span></span><br><span class="line">        StudentIterator iterator = aggregate.getStudentIterator();</span><br><span class="line">        <span class="comment">//éå†</span></span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Student student = iterator.next();</span><br><span class="line">            System.out.println(student);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-29-54.png"></p>
<h2 id="20-3-è¿­ä»£å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#20-3-è¿­ä»£å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="20.3 è¿­ä»£å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>20.3 è¿­ä»£å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ul>
<li>å½“éœ€è¦ä¸ºèšåˆå¯¹è±¡æä¾›å¤šç§éå†æ–¹å¼æ—¶ã€‚</li>
<li>å½“éœ€è¦ä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ—¶ã€‚</li>
<li>å½“è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— é¡»æš´éœ²å…¶å†…éƒ¨ç»†èŠ‚çš„è¡¨ç¤ºæ—¶ã€‚</li>
</ul>
<h2 id="20-4-JDKæºç è§£æ"><a href="#20-4-JDKæºç è§£æ" class="headerlink" title="20.4 JDKæºç è§£æ"></a>20.4 JDKæºç è§£æ</h2><p>è¿­ä»£å™¨æ¨¡å¼åœ¨JAVAçš„å¾ˆå¤šé›†åˆç±»ä¸­è¢«å¹¿æ³›åº”ç”¨ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹JAVAæºç ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">Iterator&lt;String&gt; iterator = list.iterator(); <span class="comment">//list.iterator()æ–¹æ³•è¿”å›çš„è‚¯å®šæ˜¯Iteratoræ¥å£çš„å­å®ç°ç±»å¯¹è±¡</span></span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">    System.out.println(iterator.next());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹å®Œè¿™æ®µä»£ç æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä¸æˆ‘ä»¬ä¸Šé¢ä»£ç åŸºæœ¬ç±»ä¼¼ã€‚å•åˆ—é›†åˆéƒ½ä½¿ç”¨åˆ°äº†è¿­ä»£å™¨ï¼Œæˆ‘ä»¬ä»¥ArrayListä¸¾ä¾‹æ¥è¯´æ˜</p>
<ul>
<li>Listï¼šæŠ½è±¡èšåˆç±»</li>
<li>ArrayListï¼šå…·ä½“çš„èšåˆç±»</li>
<li>Iteratorï¼šæŠ½è±¡è¿­ä»£å™¨</li>
<li>list.iterator()ï¼šè¿”å›çš„æ˜¯å®ç°äº† <code>Iterator</code> æ¥å£çš„å…·ä½“è¿­ä»£å™¨å¯¹è±¡</li>
</ul>
<p>å…·ä½“çš„æ¥çœ‹çœ‹ ArrayListçš„ä»£ç å®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Itr();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cursor;       <span class="comment">// ä¸‹ä¸€ä¸ªè¦è¿”å›å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">int</span> lastRet = -<span class="number">1</span>; <span class="comment">// ä¸Šä¸€ä¸ªè¿”å›å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line"></span><br><span class="line">        Itr() &#123;&#125;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å…ƒç´ </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != size;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            checkForComodification();</span><br><span class="line">            <span class="keyword">int</span> i = cursor;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= size)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">            Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= elementData.length)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">            cursor = i + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> (E) elementData[lastRet = i];</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™éƒ¨åˆ†ä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œå¤§è‡´å°±æ˜¯åœ¨ <code>iterator</code> æ–¹æ³•ä¸­è¿”å›äº†ä¸€ä¸ªå®ä¾‹åŒ–çš„ <code>Iterator</code> å¯¹è±¡ã€‚Itræ˜¯ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ƒå®ç°äº† <code>Iterator</code> æ¥å£å¹¶é‡å†™äº†å…¶ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š </p>
<pre><code>å½“æˆ‘ä»¬åœ¨ä½¿ç”¨JAVAå¼€å‘çš„æ—¶å€™ï¼Œæƒ³ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼çš„è¯ï¼Œåªè¦è®©æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å®¹å™¨ç±»å®ç°`java.util.Iterable`å¹¶å®ç°å…¶ä¸­çš„iterator()æ–¹æ³•ä½¿å…¶è¿”å›ä¸€ä¸ª `java.util.Iterator` çš„å®ç°ç±»å°±å¯ä»¥äº†ã€‚
</code></pre>
</blockquote>
<h1 id="21ï¼Œè§‚å¯Ÿè€…æ¨¡å¼"><a href="#21ï¼Œè§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="21ï¼Œè§‚å¯Ÿè€…æ¨¡å¼"></a>21ï¼Œè§‚å¯Ÿè€…æ¨¡å¼</h1><h2 id="21-1-è§‚å¯Ÿè€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#21-1-è§‚å¯Ÿè€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="21.1 è§‚å¯Ÿè€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>21.1 è§‚å¯Ÿè€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>è§‚å¯Ÿè€…ï¼ˆObserverï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>æŒ‡å¤šä¸ªå¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚</strong>è¿™ç§æ¨¡å¼æœ‰æ—¶åˆç§°ä½œå‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€æ¨¡å‹-è§†å›¾æ¨¡å¼ï¼Œå®ƒæ˜¯å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚</p>
<p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œ<strong>å…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹</strong>ã€‚</p>
<ol>
<li>é™ä½äº†ç›®æ ‡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œä¸¤è€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆå…³ç³»ã€‚ç¬¦åˆä¾èµ–å€’ç½®åŸåˆ™ã€‚</li>
<li>ç›®æ ‡ä¸è§‚å¯Ÿè€…ä¹‹é—´å»ºç«‹äº†ä¸€å¥—è§¦å‘æœºåˆ¶ã€‚</li>
</ol>
<p><strong>å®ƒçš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>ç›®æ ‡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„ä¾èµ–å…³ç³»å¹¶æ²¡æœ‰å®Œå…¨è§£é™¤ï¼Œè€Œä¸”æœ‰å¯èƒ½å‡ºç°å¾ªç¯å¼•ç”¨ã€‚</li>
<li>å½“è§‚å¯Ÿè€…å¯¹è±¡å¾ˆå¤šæ—¶ï¼Œé€šçŸ¥çš„å‘å¸ƒä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ï¼Œå½±å“ç¨‹åºçš„æ•ˆç‡ã€‚</li>
</ol>
<h2 id="21-2-è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#21-2-è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="21.2 è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>21.2 è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><p>å®ç°è§‚å¯Ÿè€…æ¨¡å¼æ—¶è¦æ³¨æ„å…·ä½“ç›®æ ‡å¯¹è±¡å’Œå…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ä¹‹é—´ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œå¦åˆ™å°†ä½¿ä¸¤è€…ä¹‹é—´ç´§å¯†è€¦åˆèµ·æ¥ï¼Œè¿™è¿åäº†é¢å‘å¯¹è±¡çš„è®¾è®¡åŸåˆ™</p>
<h3 id="21-2-1-è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„"><a href="#21-2-1-è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„" class="headerlink" title="21.2.1 è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„"></a>21.2.1 è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡ä¸»é¢˜ï¼ˆSubjectï¼‰è§’è‰²ï¼šä¹Ÿå«æŠ½è±¡ç›®æ ‡ç±»ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç”¨äºä¿å­˜è§‚å¯Ÿè€…å¯¹è±¡çš„èšé›†ç±»å’Œå¢åŠ ã€åˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡çš„æ–¹æ³•ï¼Œä»¥åŠé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…çš„æŠ½è±¡æ–¹æ³•ã€‚</li>
<li>å…·ä½“ä¸»é¢˜ï¼ˆConcrete Subjectï¼‰è§’è‰²ï¼šä¹Ÿå«å…·ä½“ç›®æ ‡ç±»ï¼Œå®ƒå®ç°æŠ½è±¡ç›®æ ‡ä¸­çš„é€šçŸ¥æ–¹æ³•ï¼Œå½“å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œé€šçŸ¥æ‰€æœ‰æ³¨å†Œè¿‡çš„è§‚å¯Ÿè€…å¯¹è±¡ã€‚</li>
<li>æŠ½è±¡è§‚å¯Ÿè€…ï¼ˆObserverï¼‰è§’è‰²ï¼šå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªæ›´æ–°è‡ªå·±çš„æŠ½è±¡æ–¹æ³•ï¼Œå½“æ¥åˆ°å…·ä½“ä¸»é¢˜çš„æ›´æ”¹é€šçŸ¥æ—¶è¢«è°ƒç”¨ã€‚</li>
<li>å…·ä½“è§‚å¯Ÿè€…ï¼ˆConcrete Observerï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è§‚å¯Ÿè€…ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨å¾—åˆ°ç›®æ ‡çš„æ›´æ”¹é€šçŸ¥æ—¶æ›´æ–°è‡ªèº«çš„çŠ¶æ€ã€‚</li>
</ol>
<h3 id="21-2-1-ä»£ç å®ç°"><a href="#21-2-1-ä»£ç å®ç°" class="headerlink" title="21.2.1 ä»£ç å®ç°"></a>21.2.1 ä»£ç å®ç°</h3><p>åœ¨ä½¿ç”¨å¾®ä¿¡å…¬ä¼—å·æ—¶ï¼Œå¤§å®¶éƒ½ä¼šæœ‰è¿™æ ·çš„ä½“éªŒï¼Œå½“ä½ å…³æ³¨çš„å…¬ä¼—å·ä¸­æœ‰æ–°å†…å®¹æ›´æ–°çš„è¯ï¼Œå®ƒå°±ä¼šæ¨é€ç»™å…³æ³¨å…¬ä¼—å·çš„å¾®ä¿¡ç”¨æˆ·ç«¯ã€‚æˆ‘ä»¬ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥æ¨¡æ‹Ÿè¿™æ ·çš„åœºæ™¯ï¼Œå¾®ä¿¡ç”¨æˆ·å°±æ˜¯è§‚å¯Ÿè€…ï¼Œå¾®ä¿¡å…¬ä¼—å·æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œæœ‰å¤šä¸ªçš„å¾®ä¿¡ç”¨æˆ·å…³æ³¨äº†ç¨‹åºçŒ¿è¿™ä¸ªå…¬ä¼—å·</p>
<p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_23-16-00.png"></p>
<p><strong>Observer</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Observer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ›´æ–°çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(String messages)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>WexinUser</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> WexinUser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“è§‚å¯Ÿè€…ç±» å®ç°æ›´æ–°çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WexinUser</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WexinUser</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WexinUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(String messages)</span> </span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;--&gt;&quot;</span> + messages);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Subject</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Subject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡ä¸»é¢˜ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¢åŠ è®¢é˜…è€…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤è®¢é˜…è€…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šçŸ¥è®¢é˜…è€…æ›´æ–°æ¶ˆæ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String messages)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SubscriptionSubject</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SubscriptionSubject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“ä¸»é¢˜(å…·ä½“è¢«è§‚å¯Ÿè€…)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubscriptionSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å­˜å‚¨è®¢é˜…å…¬ä¼—å·çš„å¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; weixinUserList = <span class="keyword">new</span> ArrayList&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        weixinUserList.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        weixinUserList.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String messages)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer observer : weixinUserList) &#123;</span><br><span class="line">            observer.update(messages);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è§‚å¯Ÿè€…æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:16</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SubscriptionSubject subject = <span class="keyword">new</span> SubscriptionSubject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">        WexinUser user1 = <span class="keyword">new</span> WexinUser(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        WexinUser user2 = <span class="keyword">new</span> WexinUser(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line">        WexinUser user3 = <span class="keyword">new</span> WexinUser(<span class="string">&quot;ç‹äº”&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¢é˜…å…¬ä¼—å·</span></span><br><span class="line">        subject.attach(user1);</span><br><span class="line">        subject.attach(user2);</span><br><span class="line">        subject.attach(user3);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡è®¢é˜…ç”¨æˆ·</span></span><br><span class="line">        subject.notify(<span class="string">&quot;æ‚¨å…³æ³¨çš„å…¬ä¼—å·æ›´æ–°å•¦~~~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-30-09.png"></p>
<h2 id="20-3-è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#20-3-è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="20.3 è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯"></a>20.3 è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯</h2><ol>
<li>å¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šå…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ä¼šå½±å“å…¶ä»–å¯¹è±¡ã€‚</li>
<li>å½“ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€æ–¹é¢æ—¶ï¼Œå¯å°†è¿™äºŒè€…å°è£…åœ¨ç‹¬ç«‹çš„å¯¹è±¡ä¸­ä»¥ä½¿å®ƒä»¬å¯ä»¥å„è‡ªç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨ã€‚</li>
<li>å®ç°ç±»ä¼¼å¹¿æ’­æœºåˆ¶çš„åŠŸèƒ½ï¼Œä¸éœ€è¦çŸ¥é“å…·ä½“æ”¶å¬è€…ï¼Œåªéœ€åˆ†å‘å¹¿æ’­ï¼Œç³»ç»Ÿä¸­æ„Ÿå…´è¶£çš„å¯¹è±¡ä¼šè‡ªåŠ¨æ¥æ”¶è¯¥å¹¿æ’­ã€‚</li>
<li>å¤šå±‚çº§åµŒå¥—ä½¿ç”¨ï¼Œå½¢æˆä¸€ç§é“¾å¼è§¦å‘æœºåˆ¶ï¼Œä½¿å¾—äº‹ä»¶å…·å¤‡è·¨åŸŸï¼ˆè·¨è¶Šä¸¤ç§è§‚å¯Ÿè€…ç±»å‹ï¼‰é€šçŸ¥ã€‚</li>
</ol>
<h2 id="20-4-JDKæºç è§£æ-1"><a href="#20-4-JDKæºç è§£æ-1" class="headerlink" title="20.4 JDKæºç è§£æ"></a>20.4 JDKæºç è§£æ</h2><p>åœ¨ Java ä¸­ï¼Œé€šè¿‡ java.util.Observable ç±»å’Œ java.util.Observer æ¥å£å®šä¹‰äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œåªè¦å®ç°å®ƒä»¬çš„å­ç±»å°±å¯ä»¥ç¼–å†™è§‚å¯Ÿè€…æ¨¡å¼å®ä¾‹ã€‚</p>
<p><strong>1ï¼ŒObservableç±»</strong></p>
<p>Observable ç±»æ˜¯æŠ½è±¡ç›®æ ‡ç±»ï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰ï¼Œå®ƒæœ‰ä¸€ä¸ª Vector é›†åˆæˆå‘˜å˜é‡ï¼Œç”¨äºä¿å­˜æ‰€æœ‰è¦é€šçŸ¥çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä¸‹é¢æ¥ä»‹ç»å®ƒæœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ã€‚</p>
<ul>
<li><p>void addObserver(Observer o) æ–¹æ³•ï¼šç”¨äºå°†æ–°çš„è§‚å¯Ÿè€…å¯¹è±¡æ·»åŠ åˆ°é›†åˆä¸­ã€‚</p>
</li>
<li><p>void notifyObservers(Object arg) æ–¹æ³•ï¼šè°ƒç”¨é›†åˆä¸­çš„æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡çš„ updateæ–¹æ³•ï¼Œé€šçŸ¥å®ƒä»¬æ•°æ®å‘ç”Ÿæ”¹å˜ã€‚é€šå¸¸è¶Šæ™šåŠ å…¥é›†åˆçš„è§‚å¯Ÿè€…è¶Šå…ˆå¾—åˆ°é€šçŸ¥ã€‚</p>
</li>
<li><p>void setChange() æ–¹æ³•ï¼šç”¨æ¥è®¾ç½®ä¸€ä¸ª boolean ç±»å‹çš„å†…éƒ¨æ ‡å¿—ï¼Œæ³¨æ˜ç›®æ ‡å¯¹è±¡å‘ç”Ÿäº†å˜åŒ–ã€‚å½“å®ƒä¸ºtrueæ—¶ï¼ŒnotifyObservers() æ‰ä¼šé€šçŸ¥è§‚å¯Ÿè€…ã€‚</p>
</li>
</ul>
<p><strong>2ï¼ŒObserver æ¥å£</strong></p>
<p>Observer æ¥å£æ˜¯æŠ½è±¡è§‚å¯Ÿè€…ï¼Œå®ƒç›‘è§†ç›®æ ‡å¯¹è±¡çš„å˜åŒ–ï¼Œå½“ç›®æ ‡å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§‚å¯Ÿè€…å¾—åˆ°é€šçŸ¥ï¼Œå¹¶è°ƒç”¨ update æ–¹æ³•ï¼Œè¿›è¡Œç›¸åº”çš„å·¥ä½œã€‚</p>
<p>ã€ä¾‹ã€‘è­¦å¯ŸæŠ“å°å·</p>
<p>è­¦å¯ŸæŠ“å°å·ä¹Ÿå¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥å®ç°ï¼Œè­¦å¯Ÿæ˜¯è§‚å¯Ÿè€…ï¼Œå°å·æ˜¯è¢«è§‚å¯Ÿè€…ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<p>å°å·æ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œæ‰€ä»¥éœ€è¦ç»§æ‰¿Observableç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer.observable_example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Observable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Thief</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å°å·ç±» ç»§æ‰¿Observableæ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thief</span> <span class="keyword">extends</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Thief</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Thief</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">steal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å°å·ï¼šæˆ‘å·ä¸œè¥¿ï¼Œæœ‰æ²¡æœ‰äººæ¥æŠ“æˆ‘ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">super</span>.setChanged();<span class="comment">//é»˜è®¤ä¸ºtrue</span></span><br><span class="line">        <span class="keyword">super</span>.notifyObservers();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è­¦å¯Ÿæ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œæ‰€ä»¥éœ€è¦è®©å…¶å®ç°Observeræ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer.observable_example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Observable;</span><br><span class="line"><span class="keyword">import</span> java.util.Observer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Policemen</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è­¦å¯Ÿç±» å®ç°Observeç±»  å®ç°updateæ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Policemen</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Policemen</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Policemen</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Observable o, Object arg)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è­¦å¯Ÿï¼š&quot;</span> + ((Thief) o).getName() + <span class="string">&quot;ä½ è¢«æˆ‘æŠ“åˆ°äº†å“ˆå“ˆå“ˆå“ˆï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.observer.observable_example;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 14:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å°å·å¯¹è±¡</span></span><br><span class="line">        Thief thief = <span class="keyword">new</span> Thief(<span class="string">&quot;æ³•å¤–ç‹‚å¾’å¼ ä¸‰&quot;</span>);</span><br><span class="line">        <span class="comment">//è­¦å¯Ÿå¯¹è±¡</span></span><br><span class="line">        Policemen policemen = <span class="keyword">new</span> Policemen(<span class="string">&quot;å°åº„è­¦å¯Ÿ&quot;</span>);</span><br><span class="line">        <span class="comment">//è­¦å¯Ÿç›¯ç€å°å·</span></span><br><span class="line">        thief.addObserver(policemen);</span><br><span class="line">        <span class="comment">//å°å·è¡Œçªƒ</span></span><br><span class="line">        thief.steal();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-30-19.png"></p>
<h1 id="22ï¼Œä¸­ä»‹è€…æ¨¡å¼"><a href="#22ï¼Œä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="22ï¼Œä¸­ä»‹è€…æ¨¡å¼"></a>22ï¼Œä¸­ä»‹è€…æ¨¡å¼</h1><p>ä¸€èˆ¬æ¥è¯´ï¼ŒåŒäº‹ç±»ä¹‹é—´çš„å…³ç³»æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå¤šä¸ªåŒäº‹ç±»ä¹‹é—´äº’ç›¸å…³è”æ—¶ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»ä¼šå‘ˆç°ä¸ºå¤æ‚çš„ç½‘çŠ¶ç»“æ„ï¼Œè¿™æ˜¯ä¸€ç§è¿‡åº¦è€¦åˆçš„æ¶æ„ï¼Œå³ä¸åˆ©äºç±»çš„å¤ç”¨ï¼Œä¹Ÿä¸ç¨³å®šã€‚ä¾‹å¦‚åœ¨ä¸‹å·¦å›¾ä¸­ï¼Œæœ‰å…­ä¸ªåŒäº‹ç±»å¯¹è±¡ï¼Œå‡å¦‚å¯¹è±¡1å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰4ä¸ªå¯¹è±¡å—åˆ°å½±å“ã€‚å¦‚æœå¯¹è±¡2å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰5ä¸ªå¯¹è±¡å—åˆ°å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒäº‹ç±»ä¹‹é—´ç›´æ¥å…³è”çš„è®¾è®¡æ˜¯ä¸å¥½çš„ã€‚</p>
<p>å¦‚æœå¼•å…¥ä¸­ä»‹è€…æ¨¡å¼ï¼Œé‚£ä¹ˆåŒäº‹ç±»ä¹‹é—´çš„å…³ç³»å°†å˜ä¸ºæ˜Ÿå‹ç»“æ„ï¼Œä»ä¸‹å³å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»»ä½•ä¸€ä¸ªç±»çš„å˜åŠ¨ï¼Œåªä¼šå½±å“çš„ç±»æœ¬èº«ï¼Œä»¥åŠä¸­ä»‹è€…ï¼Œè¿™æ ·å°±å‡å°äº†ç³»ç»Ÿçš„è€¦åˆã€‚ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼Œå¿…å®šä¸ä¼šæŠŠæ‰€æœ‰çš„å¯¹è±¡å…³ç³»å¤„ç†é€»è¾‘å°è£…åœ¨æœ¬ç±»ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„ç±»æ¥ç®¡ç†é‚£äº›ä¸å±äºè‡ªå·±çš„è¡Œä¸ºã€‚</p>
<h2 id="22-1-ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#22-1-ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="22.1 ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>22.1 ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>ä¸­ä»‹è€…ï¼ˆMediatorï¼‰æ¨¡å¼çš„å®šä¹‰ï¼šå®šä¹‰ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œä½¿åŸæœ‰å¯¹è±¡ä¹‹é—´çš„è€¦åˆæ¾æ•£ï¼Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼åˆå«è°ƒåœæ¨¡å¼ï¼Œå®ƒæ˜¯è¿ªç±³ç‰¹æ³•åˆ™çš„å…¸å‹åº”ç”¨ã€‚</p>
<p>ä¸­ä»‹è€…æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</p>
<ol>
<li>ç±»ä¹‹é—´å„å¸å…¶èŒï¼Œç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™ã€‚</li>
<li>é™ä½äº†å¯¹è±¡ä¹‹é—´çš„è€¦åˆæ€§ï¼Œä½¿å¾—å¯¹è±¡æ˜“äºç‹¬ç«‹åœ°è¢«å¤ç”¨ã€‚</li>
<li>å°†å¯¹è±¡é—´çš„ä¸€å¯¹å¤šå…³è”è½¬å˜ä¸ºä¸€å¯¹ä¸€çš„å…³è”ï¼Œæé«˜ç³»ç»Ÿçš„çµæ´»æ€§ï¼Œä½¿å¾—ç³»ç»Ÿæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚</li>
</ol>
<p>å…¶ä¸»è¦ç¼ºç‚¹æ˜¯ï¼šä¸­ä»‹è€…æ¨¡å¼å°†åŸæœ¬å¤šä¸ªå¯¹è±¡ç›´æ¥çš„ç›¸äº’ä¾èµ–å˜æˆäº†ä¸­ä»‹è€…å’Œå¤šä¸ªåŒäº‹ç±»çš„ä¾èµ–å…³ç³»ã€‚å½“åŒäº‹ç±»è¶Šå¤šæ—¶ï¼Œä¸­ä»‹è€…å°±ä¼šè¶Šè‡ƒè‚¿ï¼Œå˜å¾—å¤æ‚ä¸”éš¾ä»¥ç»´æŠ¤ã€‚</p>
<h2 id="22-2-ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#22-2-ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="22.2 ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>22.2 ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="22-2-1-ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„"><a href="#22-2-1-ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„" class="headerlink" title="22.2.1 ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„"></a>22.2.1 ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„</h3><ul>
<li>æŠ½è±¡ä¸­ä»‹è€…ï¼ˆMediatorï¼‰è§’è‰²ï¼šå®ƒæ˜¯ä¸­ä»‹è€…çš„æ¥å£ï¼Œæä¾›äº†åŒäº‹å¯¹è±¡æ³¨å†Œä¸è½¬å‘åŒäº‹å¯¹è±¡ä¿¡æ¯çš„æŠ½è±¡æ–¹æ³•ã€‚</li>
<li>å…·ä½“ä¸­ä»‹è€…ï¼ˆConcreteMediatorï¼‰è§’è‰²ï¼šå®ç°ä¸­ä»‹è€…æ¥å£ï¼Œå®šä¹‰ä¸€ä¸ª List æ¥ç®¡ç†åŒäº‹å¯¹è±¡ï¼Œåè°ƒå„ä¸ªåŒäº‹è§’è‰²ä¹‹é—´çš„äº¤äº’å…³ç³»ï¼Œå› æ­¤å®ƒä¾èµ–äºåŒäº‹è§’è‰²ã€‚</li>
<li>æŠ½è±¡åŒäº‹ç±»ï¼ˆColleagueï¼‰è§’è‰²ï¼šå®šä¹‰åŒäº‹ç±»çš„æ¥å£ï¼Œä¿å­˜ä¸­ä»‹è€…å¯¹è±¡ï¼Œæä¾›åŒäº‹å¯¹è±¡äº¤äº’çš„æŠ½è±¡æ–¹æ³•ï¼Œå®ç°æ‰€æœ‰ç›¸äº’å½±å“çš„åŒäº‹ç±»çš„å…¬å…±åŠŸèƒ½ã€‚</li>
<li>å…·ä½“åŒäº‹ç±»ï¼ˆConcrete Colleagueï¼‰è§’è‰²ï¼šæ˜¯æŠ½è±¡åŒäº‹ç±»çš„å®ç°è€…ï¼Œå½“éœ€è¦ä¸å…¶ä»–åŒäº‹å¯¹è±¡äº¤äº’æ—¶ï¼Œç”±ä¸­ä»‹è€…å¯¹è±¡è´Ÿè´£åç»­çš„äº¤äº’ã€‚</li>
</ul>
<h3 id="22-2-2-ä»£ç å®ç°"><a href="#22-2-2-ä»£ç å®ç°" class="headerlink" title="22.2.2 ä»£ç å®ç°"></a>22.2.2 ä»£ç å®ç°</h3><p>ç°åœ¨ç§Ÿæˆ¿åŸºæœ¬éƒ½æ˜¯é€šè¿‡æˆ¿å±‹ä¸­ä»‹ï¼Œæˆ¿ä¸»å°†æˆ¿å±‹æ‰˜ç®¡ç»™æˆ¿å±‹ä¸­ä»‹ï¼Œè€Œç§Ÿæˆ¿è€…ä»æˆ¿å±‹ä¸­ä»‹è·å–æˆ¿å±‹ä¿¡æ¯ã€‚æˆ¿å±‹ä¸­ä»‹å……å½“ç§Ÿæˆ¿è€…ä¸æˆ¿å±‹æ‰€æœ‰è€…ä¹‹é—´çš„ä¸­ä»‹è€…</p>
<p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_23-24-04.png"></p>
<p><strong>Mediator</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.mediator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Mediator</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡ä¸­ä»‹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 20:45</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å£°æ˜ä¸€ä¸ªè”ç»œæ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message, Person person)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Person</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.mediator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Person</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡åŒäº‹ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 20:45</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> Mediator mediator;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HouseOwner</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.mediator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HouseOwner</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“åŒäº‹ç±» æˆ¿å±‹æ‹¥æœ‰è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 20:45</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseOwner</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HouseOwner</span><span class="params">(String name, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ä¸­ä»‹è€…è”ç³»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        mediator.constact(message,<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMessage</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸»&quot;</span>+name+<span class="string">&quot;è·å–çš„ä¿¡æ¯:&quot;</span>+message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Tenant</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.mediator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Tenant</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…·ä½“åŒäº‹ç±» æ‰¿ç§Ÿäºº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 20:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tenant</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tenant</span><span class="params">(String name, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ä¸­ä»‹è€…è”ç³»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        mediator.constact(message,<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">//è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMessage</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç§Ÿæˆ¿è€…&quot;</span>+name+<span class="string">&quot;è·å–çš„ä¿¡æ¯:&quot;</span>+message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MediatorStructure</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.mediator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MediatorStructure</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä¸­ä»‹æœºæ„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 20:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MediatorStructure</span> <span class="keyword">extends</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸­ä»‹ç»“æ„å¿…é¡»çŸ¥é“æ‰€æœ‰æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> HouseOwner houseOwner;</span><br><span class="line">    <span class="keyword">private</span> Tenant tenant;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HouseOwner <span class="title">getHouseOwner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> houseOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHouseOwner</span><span class="params">(HouseOwner houseOwner)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.houseOwner = houseOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Tenant <span class="title">getTenant</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> tenant;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTenant</span><span class="params">(Tenant tenant)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.tenant = tenant;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message, Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (person == houseOwner) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœæ˜¯æˆ¿ä¸»ï¼Œåˆ™ç§Ÿæˆ¿è€…è·å¾—ä¿¡æ¯</span></span><br><span class="line">            tenant.getMessage(message);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//åä¹‹æ˜¯æˆ¿ä¸»è·å¾—ä¿¡æ¯</span></span><br><span class="line">            houseOwner.getMessage(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.mediator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä¸­ä»‹è€…æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/28 20:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æˆ¿ä¸» ç§Ÿæˆ¿è€… ä¸­ä»‹æœºæ„</span></span><br><span class="line">        MediatorStructure mediator = <span class="keyword">new</span> MediatorStructure();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…åªéœ€è¦çŸ¥é“ä¸­ä»‹æœºæ„å³å¯</span></span><br><span class="line">        HouseOwner houseOwner = <span class="keyword">new</span> HouseOwner(<span class="string">&quot;å¼ ä¸‰&quot;</span>, mediator);</span><br><span class="line">        Tenant tenant = <span class="keyword">new</span> Tenant(<span class="string">&quot;æå››&quot;</span>, mediator);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸­ä»‹æœºæ„éœ€è¦çŸ¥é“æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…</span></span><br><span class="line">        mediator.setHouseOwner(houseOwner);</span><br><span class="line">        mediator.setTenant(tenant);</span><br><span class="line"></span><br><span class="line">        tenant.constact(<span class="string">&quot;éœ€è¦ç§Ÿä¸€é—´æˆ¿å­&quot;</span>);</span><br><span class="line">        houseOwner.constact(<span class="string">&quot;æˆ‘æœ‰ä¸€é—´æˆ¿å­ï¼Œä½ è¦ç§Ÿå—ï¼Ÿï¼Ÿï¼Ÿ&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-30-43.png"></p>
<h2 id="22-3-ä¸­ä»‹è€…æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#22-3-ä¸­ä»‹è€…æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="22.3 ä¸­ä»‹è€…æ¨¡å¼åº”ç”¨åœºæ™¯"></a>22.3 ä¸­ä»‹è€…æ¨¡å¼åº”ç”¨åœºæ™¯</h2><ul>
<li>å½“å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤æ‚çš„ç½‘çŠ¶ç»“æ„å…³ç³»è€Œå¯¼è‡´ä¾èµ–å…³ç³»æ··ä¹±ä¸”éš¾ä»¥å¤ç”¨æ—¶ã€‚</li>
<li>å½“æƒ³åˆ›å»ºä¸€ä¸ªè¿è¡Œäºå¤šä¸ªç±»ä¹‹é—´çš„å¯¹è±¡ï¼Œåˆä¸æƒ³ç”Ÿæˆæ–°çš„å­ç±»æ—¶ã€‚</li>
</ul>
<h2 id="22-4-ä¸­ä»‹è€…æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"><a href="#22-4-ä¸­ä»‹è€…æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚" class="headerlink" title="22.4 ä¸­ä»‹è€…æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"></a>22.4 ä¸­ä»‹è€…æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚</h2><ul>
<li>å¤šä¸ªç±»ç›¸äº’è€¦åˆï¼Œä¼šå½¢æˆç½‘çŠ¶ç»“æ„ï¼Œä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å°†ç½‘çŠ¶ç»“æ„åˆ†ç¦»ä¸ºæ˜Ÿå‹ç»“æ„ï¼Œè¿›è¡Œè§£è€¦</li>
<li>å‡å°‘ç±»é—´ä¾èµ–ï¼Œé™ä½äº†è€¦åˆï¼Œç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™</li>
<li>ä¸­ä»‹è€…æ‰¿æ‹…è¾ƒå¤šè´£ä»»ï¼Œå‡ºé—®é¢˜ï¼Œç³»ç»Ÿä¼šå—åˆ°å½±å“</li>
<li>è®¾è®¡ä¸å½“ï¼Œå®é™…ä½¿ç”¨ï¼Œç‰¹åˆ«æ³¨æ„</li>
</ul>
<h1 id="23ï¼Œå¤‡å¿˜å½•æ¨¡å¼"><a href="#23ï¼Œå¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="23ï¼Œå¤‡å¿˜å½•æ¨¡å¼"></a>23ï¼Œå¤‡å¿˜å½•æ¨¡å¼</h1><h2 id="23-1-ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#23-1-ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="23.1 ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>23.1 ä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>å¤‡å¿˜å½•ï¼ˆMementoï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œä»¥ä¾¿ä»¥åå½“éœ€è¦æ—¶èƒ½å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚</strong>è¯¥æ¨¡å¼åˆå«å¿«ç…§æ¨¡å¼ã€‚</p>
<p>å¤‡å¿˜å½•æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œ<strong>å…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ul>
<li>æä¾›äº†ä¸€ç§å¯ä»¥æ¢å¤çŠ¶æ€çš„æœºåˆ¶ã€‚å½“ç”¨æˆ·éœ€è¦æ—¶èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿åœ°å°†æ•°æ®æ¢å¤åˆ°æŸä¸ªå†å²çš„çŠ¶æ€ã€‚</li>
<li>å®ç°äº†å†…éƒ¨çŠ¶æ€çš„å°è£…ã€‚é™¤äº†åˆ›å»ºå®ƒçš„å‘èµ·äººä¹‹å¤–ï¼Œå…¶ä»–å¯¹è±¡éƒ½ä¸èƒ½å¤Ÿè®¿é—®è¿™äº›çŠ¶æ€ä¿¡æ¯ã€‚</li>
<li>ç®€åŒ–äº†å‘èµ·äººç±»ã€‚å‘èµ·äººä¸éœ€è¦ç®¡ç†å’Œä¿å­˜å…¶å†…éƒ¨çŠ¶æ€çš„å„ä¸ªå¤‡ä»½ï¼Œæ‰€æœ‰çŠ¶æ€ä¿¡æ¯éƒ½ä¿å­˜åœ¨å¤‡å¿˜å½•ä¸­ï¼Œå¹¶ç”±ç®¡ç†è€…è¿›è¡Œç®¡ç†ï¼Œè¿™ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</li>
</ul>
<p><strong>å…¶ä¸»è¦ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>èµ„æºæ¶ˆè€—å¤§ã€‚å¦‚æœè¦ä¿å­˜çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯è¿‡å¤šæˆ–è€…ç‰¹åˆ«é¢‘ç¹ï¼Œå°†ä¼šå ç”¨æ¯”è¾ƒå¤§çš„å†…å­˜èµ„æºã€‚</li>
</ul>
<h2 id="23-2-å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#23-2-å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="23.2 å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>23.2 å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="23-2-1-å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„"><a href="#23-2-1-å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„" class="headerlink" title="23.2.1 å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„"></a>23.2.1 å¤‡å¿˜å½•æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>å‘èµ·äººï¼ˆOriginatorï¼‰è§’è‰²ï¼šè®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯ï¼Œæä¾›åˆ›å»ºå¤‡å¿˜å½•å’Œæ¢å¤å¤‡å¿˜å½•æ•°æ®çš„åŠŸèƒ½ï¼Œå®ç°å…¶ä»–ä¸šåŠ¡åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®¿é—®å¤‡å¿˜å½•é‡Œçš„æ‰€æœ‰ä¿¡æ¯ã€‚</li>
<li>å¤‡å¿˜å½•ï¼ˆMementoï¼‰è§’è‰²ï¼šè´Ÿè´£å­˜å‚¨å‘èµ·äººçš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æä¾›è¿™äº›å†…éƒ¨çŠ¶æ€ç»™å‘èµ·äººã€‚</li>
<li>ç®¡ç†è€…ï¼ˆCaretakerï¼‰è§’è‰²ï¼šå¯¹å¤‡å¿˜å½•è¿›è¡Œç®¡ç†ï¼Œæä¾›ä¿å­˜ä¸è·å–å¤‡å¿˜å½•çš„åŠŸèƒ½ï¼Œä½†å…¶ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œè®¿é—®ä¸ä¿®æ”¹ã€‚</li>
<li>å¤‡å¿˜å½•æœ‰ä¸¤ä¸ªç­‰æ•ˆçš„æ¥å£ï¼š<ul>
<li><strong>çª„æ¥å£</strong>ï¼šç®¡ç†è€…(Caretaker)å¯¹è±¡ï¼ˆå’Œå…¶ä»–å‘èµ·äººå¯¹è±¡ä¹‹å¤–çš„ä»»ä½•å¯¹è±¡ï¼‰çœ‹åˆ°çš„æ˜¯å¤‡å¿˜å½•çš„çª„æ¥å£(narror Interface)ï¼Œè¿™ä¸ªçª„æ¥å£åªå…è®¸ä»–æŠŠå¤‡å¿˜å½•å¯¹è±¡ä¼ ç»™å…¶ä»–çš„å¯¹è±¡ã€‚</li>
<li><strong>å®½æ¥å£</strong>ï¼šä¸ç®¡ç†è€…çœ‹åˆ°çš„çª„æ¥å£ç›¸åï¼Œå‘èµ·äººå¯¹è±¡å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå®½æ¥å£(wide Interface)ï¼Œè¿™ä¸ªå®½æ¥å£å…è®¸å®ƒè¯»å–æ‰€æœ‰çš„æ•°æ®ï¼Œä»¥ä¾¿æ ¹æ®è¿™äº›æ•°æ®æ¢å¤è¿™ä¸ªå‘èµ·äººå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚</li>
</ul>
</li>
</ol>
<h3 id="23-2-2-ä»£ç å®ç°"><a href="#23-2-2-ä»£ç å®ç°" class="headerlink" title="23.2.2 ä»£ç å®ç°"></a>23.2.2 ä»£ç å®ç°</h3><p>æ¸¸æˆä¸­çš„æŸä¸ªåœºæ™¯ï¼Œä¸€æ¸¸æˆè§’è‰²æœ‰ç”Ÿå‘½åŠ›ã€æ”»å‡»åŠ›ã€é˜²å¾¡åŠ›ç­‰æ•°æ®ï¼Œåœ¨æ‰“Bosså‰å’Œåä¸€å®šä¼šä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å…è®¸ç©å®¶å¦‚æœæ„Ÿè§‰ä¸Bosså†³æ–—çš„æ•ˆæœä¸ç†æƒ³å¯ä»¥è®©æ¸¸æˆæ¢å¤åˆ°å†³æ–—ä¹‹å‰çš„çŠ¶æ€ã€‚</p>
<p>è¦å®ç°ä¸Šè¿°æ¡ˆä¾‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li>
<li>â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li>
</ul>
<h4 id="23-2-2-1â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼"><a href="#23-2-2-1â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="23.2.2.1â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼"></a>23.2.2.1<strong>â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼</strong></h4><p>å¤‡å¿˜å½•è§’è‰²å¯¹ä»»ä½•å¯¹è±¡éƒ½æä¾›ä¸€ä¸ªæ¥å£ï¼Œå³å®½æ¥å£ï¼Œå¤‡å¿˜å½•è§’è‰²çš„å†…éƒ¨æ‰€å­˜å‚¨çš„çŠ¶æ€å°±å¯¹æ‰€æœ‰å¯¹è±¡å…¬å¼€</p>
<p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_23-34-20.png"></p>
<p><strong>GameRole</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.white_box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> GameRole</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¸¸æˆè§’è‰²ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GameRole</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> vit;<span class="comment">//ç”Ÿå‘½åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> atk;<span class="comment">//æ”»å‡»åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> def;<span class="comment">//é˜²å¾¡åŠ›</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ˜æ–—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RoleStateMemento <span class="title">saveState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RoleStateMemento(vit, atk, def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¢å¤è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recoverState</span><span class="params">(RoleStateMemento roleStateMemento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = roleStateMemento.getVit();</span><br><span class="line">        <span class="keyword">this</span>.atk = roleStateMemento.getAtk();</span><br><span class="line">        <span class="keyword">this</span>.def = roleStateMemento.getDef();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å±•ç¤ºçŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stateDisplay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²ç”Ÿå‘½åŠ›&quot;</span> + vit);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²æ”»å‡»åŠ›&quot;</span> + atk);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²é˜²å¾¡åŠ›&quot;</span> + def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>RoleStateMemento</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.white_box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> RoleStateMemento</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¸¸æˆçŠ¶æ€å­˜å‚¨ç±» å¤‡å¿˜å½•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateMemento</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> vit;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> atk;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> def;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RoleStateMemento</span><span class="params">(<span class="keyword">int</span> vit, <span class="keyword">int</span> atk, <span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>RoleStateCaretaker</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.white_box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> RoleStateCaretaker</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è§’è‰²çŠ¶æ€ç®¡ç†ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateCaretaker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> RoleStateMemento roleStateMemento;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RoleStateMemento <span class="title">getRoleStateMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roleStateMemento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoleStateMemento</span><span class="params">(RoleStateMemento roleStateMemento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roleStateMemento = roleStateMemento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.white_box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å¤‡å¿˜å½•æ¨¡å¼ ç™½ç®± æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--------------å¤§æˆ˜Bosså‰------------------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bosså‰</span></span><br><span class="line">        GameRole gameRole = <span class="keyword">new</span> GameRole();</span><br><span class="line">        gameRole.initState();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜è¿›åº¦</span></span><br><span class="line">        RoleStateCaretaker roleStateCaretaker = <span class="keyword">new</span> RoleStateCaretaker();</span><br><span class="line">        roleStateCaretaker.setRoleStateMemento(gameRole.saveState());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------å¤§æˆ˜Bosså------------------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Boss æŸè€—ä¸¥é‡</span></span><br><span class="line">        gameRole.fight();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------æ»¡è¡€å¤æ´»------------------------&quot;</span>);</span><br><span class="line">        gameRole.recoverState(roleStateCaretaker.getRoleStateMemento());</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-32-42.png"></p>
<h4 id="23-2-2-2é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼"><a href="#23-2-2-2é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="23.2.2.2é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼"></a>23.2.2.2<strong>é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼</strong></h4><p>å¤‡å¿˜å½•è§’è‰²å¯¹å‘èµ·äººå¯¹è±¡æä¾›ä¸€ä¸ªå®½æ¥å£ï¼Œè€Œä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªçª„æ¥å£ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œå®ç°åŒé‡æ¥å£çš„åŠæ³•å°±æ˜¯å°†<strong>å¤‡å¿˜å½•ç±»</strong>è®¾è®¡æˆ<strong>å‘èµ·äººç±»</strong>çš„å†…éƒ¨æˆå‘˜ç±»ã€‚</p>
<p>å°† <code>RoleStateMemento</code> è®¾ä¸º <code>GameRole</code> çš„å†…éƒ¨ç±»ï¼Œä»è€Œå°† <code>RoleStateMemento</code> å¯¹è±¡å°è£…åœ¨ <code>GameRole</code> é‡Œé¢ï¼›åœ¨å¤–é¢æä¾›ä¸€ä¸ªæ ‡è¯†æ¥å£ <code>Memento</code> ç»™ <code>RoleStateCaretaker</code> åŠå…¶ä»–å¯¹è±¡ä½¿ç”¨ã€‚è¿™æ · <code>GameRole</code> ç±»çœ‹åˆ°çš„æ˜¯ <code>RoleStateMemento</code> æ‰€æœ‰çš„æ¥å£ï¼Œè€Œ<code>RoleStateCaretaker</code> åŠå…¶ä»–å¯¹è±¡çœ‹åˆ°çš„ä»…ä»…æ˜¯æ ‡è¯†æ¥å£ <code>Memento</code> æ‰€æš´éœ²å‡ºæ¥çš„æ¥å£ï¼Œä»è€Œç»´æŠ¤äº†å°è£…å‹ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-30_23-39-26.png"></p>
<p><strong>GameRole</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.black_box;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.memento.white_box.RoleStateMemento;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> GameRole</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¸¸æˆè§’è‰²ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:14</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GameRole</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> vit;<span class="comment">//ç”Ÿå‘½åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> atk;<span class="comment">//æ”»å‡»åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> def;<span class="comment">//é˜²å¾¡åŠ›</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ˜æ–—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">saveState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RoleStateMemento(vit, atk, def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¢å¤è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recoverState</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        RoleStateMemento roleStateMemento = (RoleStateMemento) memento;</span><br><span class="line">        <span class="keyword">this</span>.vit = roleStateMemento.getVit();</span><br><span class="line">        <span class="keyword">this</span>.atk = roleStateMemento.getAtk();</span><br><span class="line">        <span class="keyword">this</span>.def = roleStateMemento.getDef();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å±•ç¤ºçŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stateDisplay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²ç”Ÿå‘½åŠ›&quot;</span> + vit);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²æ”»å‡»åŠ›&quot;</span> + atk);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²é˜²å¾¡åŠ›&quot;</span> + def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨å†…éƒ¨å®šä¹‰å¤‡å¿˜å½•å†…éƒ¨ç±» RoleStateMementoï¼ˆè¯¥å†…éƒ¨ç±»è®¾ç½®ä¸ºç§æœ‰çš„ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateMemento</span> <span class="keyword">implements</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> vit;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> atk;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> def;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">RoleStateMemento</span><span class="params">(<span class="keyword">int</span> vit, <span class="keyword">int</span> atk, <span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.vit = vit;</span><br><span class="line">            <span class="keyword">this</span>.atk = atk;</span><br><span class="line">            <span class="keyword">this</span>.def = def;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> vit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.vit = vit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> atk;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.atk = atk;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> def;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.def = def;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Memento</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.black_box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Memento</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> çª„æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>RoleStateCaretaker</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.black_box;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> RoleStateCaretaker</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è§’è‰²çŠ¶æ€ç®¡ç†ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateCaretaker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Memento memento;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">getMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemento</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memento = memento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.memento.black_box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å¤‡å¿˜å½•æ¨¡å¼ é»‘ç®± æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/29 10:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--------------å¤§æˆ˜Bosså‰------------------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bosså‰</span></span><br><span class="line">        GameRole gameRole = <span class="keyword">new</span> GameRole();</span><br><span class="line">        gameRole.initState();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜è¿›åº¦</span></span><br><span class="line">        RoleStateCaretaker roleStateCaretaker = <span class="keyword">new</span> RoleStateCaretaker();</span><br><span class="line">        roleStateCaretaker.setMemento(gameRole.saveState());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------å¤§æˆ˜Bosså------------------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Boss æŸè€—ä¸¥é‡</span></span><br><span class="line">        gameRole.fight();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------æ»¡è¡€å¤æ´»------------------------&quot;</span>);</span><br><span class="line">        gameRole.recoverState(roleStateCaretaker.getMemento());</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_08-32-54.png"></p>
<h2 id="23-3-å¤‡å¿˜å½•æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#23-3-å¤‡å¿˜å½•æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="23.3 å¤‡å¿˜å½•æ¨¡å¼åº”ç”¨åœºæ™¯"></a>23.3 å¤‡å¿˜å½•æ¨¡å¼åº”ç”¨åœºæ™¯</h2><ul>
<li>éœ€è¦ä¿å­˜ä¸æ¢å¤æ•°æ®çš„åœºæ™¯ï¼Œå¦‚ç©æ¸¸æˆæ—¶çš„ä¸­é—´ç»“æœçš„å­˜æ¡£åŠŸèƒ½ã€‚</li>
<li>éœ€è¦æä¾›ä¸€ä¸ªå¯å›æ»šæ“ä½œçš„åœºæ™¯ï¼Œå¦‚ Wordã€è®°äº‹æœ¬ã€Photoshopï¼Œideaç­‰è½¯ä»¶åœ¨ç¼–è¾‘æ—¶æŒ‰ Ctrl+Z ç»„åˆé”®ï¼Œè¿˜æœ‰æ•°æ®åº“ä¸­äº‹åŠ¡æ“ä½œã€‚</li>
</ul>
<h2 id="23-4-å¤‡å¿˜å½•æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"><a href="#23-4-å¤‡å¿˜å½•æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚" class="headerlink" title="23.4 å¤‡å¿˜å½•æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"></a>23.4 å¤‡å¿˜å½•æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚</h2><ul>
<li>ç»™ç”¨æˆ·æä¾›ä¸€ç§å¯ä»¥æ¢å¤çš„æœºåˆ¶ï¼Œå¯ä»¥ä½¿ç”¨æˆ·èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿å›åˆ°æŸä¸ªå†å²çš„çŠ¶æ€</li>
<li>å®ç°äº†ä¿¡æ¯çš„å°è£…ï¼Œä½¿ç”¨æˆ·ä¸éœ€è¦å…³å¿ƒä¿å­˜ç»†èŠ‚</li>
<li>ç±»æˆå‘˜å˜é‡è¿‡å¤šï¼Œå ç”¨æ¯”è¾ƒå¤§çš„èµ„æºï¼Œæ¯ä¸€æ¬¡ä¿å­˜éƒ½ä¼šæ¶ˆè€—ä¸€å®šå†…å­˜</li>
</ul>
<h1 id="24ï¼Œè§£é‡Šå™¨æ¨¡å¼"><a href="#24ï¼Œè§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="24ï¼Œè§£é‡Šå™¨æ¨¡å¼"></a>24ï¼Œè§£é‡Šå™¨æ¨¡å¼</h1><p>è®¾è®¡ä¸€ä¸ªè½¯ä»¶ç”¨æ¥è¿›è¡ŒåŠ å‡è®¡ç®—ã€‚æˆ‘ä»¬ç¬¬ä¸€æƒ³æ³•å°±æ˜¯ä½¿ç”¨å·¥å…·ç±»ï¼Œæä¾›å¯¹åº”çš„åŠ æ³•å’Œå‡æ³•çš„å·¥å…·æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç”¨äºä¸¤ä¸ªæ•´æ•°ç›¸åŠ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”¨äºä¸¤ä¸ªæ•´æ•°ç›¸åŠ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”¨äºnä¸ªæ•´æ•°ç›¸åŠ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Integer ... arr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Integer i : arr) &#123;</span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„å½¢å¼æ¯”è¾ƒå•ä¸€ã€æœ‰é™ï¼Œå¦‚æœå½¢å¼å˜åŒ–éå¸¸å¤šï¼Œè¿™å°±ä¸ç¬¦åˆè¦æ±‚ï¼Œå› ä¸ºåŠ æ³•å’Œå‡æ³•è¿ç®—ï¼Œä¸¤ä¸ªè¿ç®—ç¬¦ä¸æ•°å€¼å¯ä»¥æœ‰æ— é™ç§ç»„åˆæ–¹å¼ã€‚æ¯”å¦‚ 1+2+3+4+5ã€1+2+3-4ç­‰ç­‰ã€‚   </p>
<p>æ˜¾ç„¶ï¼Œç°åœ¨éœ€è¦ä¸€ç§ç¿»è¯‘è¯†åˆ«æœºå™¨ï¼Œèƒ½å¤Ÿè§£æç”±æ•°å­—ä»¥åŠ + - ç¬¦å·æ„æˆçš„åˆæ³•çš„è¿ç®—åºåˆ—ã€‚å¦‚æœæŠŠè¿ç®—ç¬¦å’Œæ•°å­—éƒ½çœ‹ä½œèŠ‚ç‚¹çš„è¯ï¼Œèƒ½å¤Ÿé€ä¸ªèŠ‚ç‚¹çš„è¿›è¡Œè¯»å–è§£æè¿ç®—ï¼Œè¿™å°±æ˜¯è§£é‡Šå™¨æ¨¡å¼çš„æ€ç»´ã€‚</p>
<h2 id="24-1-è§£é‡Šå™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#24-1-è§£é‡Šå™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="24.1 è§£é‡Šå™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>24.1 è§£é‡Šå™¨æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>è§£é‡Šå™¨ï¼ˆInterpreterï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>ç»™åˆ†æå¯¹è±¡å®šä¹‰ä¸€ä¸ªè¯­è¨€ï¼Œå¹¶å®šä¹‰è¯¥è¯­è¨€çš„æ–‡æ³•è¡¨ç¤ºï¼Œå†è®¾è®¡ä¸€ä¸ªè§£æå™¨æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚</strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨ç¼–è¯‘è¯­è¨€çš„æ–¹å¼æ¥åˆ†æåº”ç”¨ä¸­çš„å®ä¾‹ã€‚è¿™ç§æ¨¡å¼å®ç°äº†æ–‡æ³•è¡¨è¾¾å¼å¤„ç†çš„æ¥å£ï¼Œè¯¥æ¥å£è§£é‡Šä¸€ä¸ªç‰¹å®šçš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>è¿™é‡Œæåˆ°çš„æ–‡æ³•å’Œå¥å­çš„æ¦‚å¿µåŒç¼–è¯‘åŸç†ä¸­çš„æè¿°ç›¸åŒï¼Œâ€œæ–‡æ³•â€æŒ‡è¯­è¨€çš„è¯­æ³•è§„åˆ™ï¼Œè€Œâ€œå¥å­â€æ˜¯è¯­è¨€é›†ä¸­çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œæ±‰è¯­ä¸­çš„å¥å­æœ‰å¾ˆå¤šï¼Œâ€œæˆ‘æ˜¯ä¸­å›½äººâ€æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå¥å­ï¼Œå¯ä»¥ç”¨ä¸€æ£µè¯­æ³•æ ‘æ¥ç›´è§‚åœ°æè¿°è¯­è¨€ä¸­çš„å¥å­ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_12-22-17.png"></p>
<p><strong>è§£é‡Šå™¨æ¨¡å¼æ˜¯ä¸€ç§ç±»è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>æ‰©å±•æ€§å¥½ã€‚ç”±äºåœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ä½¿ç”¨ç±»æ¥è¡¨ç¤ºè¯­è¨€çš„æ–‡æ³•è§„åˆ™ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç»§æ‰¿ç­‰æœºåˆ¶æ¥æ”¹å˜æˆ–æ‰©å±•æ–‡æ³•ã€‚</li>
<li>å®¹æ˜“å®ç°ã€‚åœ¨è¯­æ³•æ ‘ä¸­çš„æ¯ä¸ªè¡¨è¾¾å¼èŠ‚ç‚¹ç±»éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œæ‰€ä»¥å®ç°å…¶æ–‡æ³•è¾ƒä¸ºå®¹æ˜“ã€‚</li>
</ol>
<p><strong>è§£é‡Šå™¨æ¨¡å¼çš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>æ‰§è¡Œæ•ˆç‡è¾ƒä½ã€‚è§£é‡Šå™¨æ¨¡å¼ä¸­é€šå¸¸ä½¿ç”¨å¤§é‡çš„å¾ªç¯å’Œé€’å½’è°ƒç”¨ï¼Œå½“è¦è§£é‡Šçš„å¥å­è¾ƒå¤æ‚æ—¶ï¼Œå…¶è¿è¡Œé€Ÿåº¦å¾ˆæ…¢ï¼Œä¸”ä»£ç çš„è°ƒè¯•è¿‡ç¨‹ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚</li>
<li>ä¼šå¼•èµ·ç±»è†¨èƒ€ã€‚è§£é‡Šå™¨æ¨¡å¼ä¸­çš„æ¯æ¡è§„åˆ™è‡³å°‘éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œå½“åŒ…å«çš„æ–‡æ³•è§„åˆ™å¾ˆå¤šæ—¶ï¼Œç±»çš„ä¸ªæ•°å°†æ€¥å‰§å¢åŠ ï¼Œå¯¼è‡´ç³»ç»Ÿéš¾ä»¥ç®¡ç†ä¸ç»´æŠ¤ã€‚</li>
<li>å¯åº”ç”¨çš„åœºæ™¯æ¯”è¾ƒå°‘ã€‚åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œéœ€è¦å®šä¹‰è¯­è¨€æ–‡æ³•çš„åº”ç”¨å®ä¾‹éå¸¸å°‘ï¼Œæ‰€ä»¥è¿™ç§æ¨¡å¼å¾ˆå°‘è¢«ä½¿ç”¨åˆ°ã€‚</li>
</ol>
<h2 id="24-2-è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#24-2-è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="24.2 è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>24.2 è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="24-2-1-è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„"><a href="#24-2-1-è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„" class="headerlink" title="24.2.1 è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„"></a>24.2.1 è§£é‡Šå™¨æ¨¡å¼çš„ç»“æ„</h3><ul>
<li>æŠ½è±¡è¡¨è¾¾å¼ï¼ˆAbstract Expressionï¼‰è§’è‰²ï¼šå®šä¹‰è§£é‡Šå™¨çš„æ¥å£ï¼Œçº¦å®šè§£é‡Šå™¨çš„è§£é‡Šæ“ä½œï¼Œä¸»è¦åŒ…å«è§£é‡Šæ–¹æ³• interpret()ã€‚</li>
<li>ç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼ˆTerminal Expressionï¼‰è§’è‰²ï¼šæ˜¯æŠ½è±¡è¡¨è¾¾å¼çš„å­ç±»ï¼Œç”¨æ¥å®ç°æ–‡æ³•ä¸­ä¸ç»ˆç»“ç¬¦ç›¸å…³çš„æ“ä½œï¼Œæ–‡æ³•ä¸­çš„æ¯ä¸€ä¸ªç»ˆç»“ç¬¦éƒ½æœ‰ä¸€ä¸ªå…·ä½“ç»ˆç»“è¡¨è¾¾å¼ä¸ä¹‹ç›¸å¯¹åº”ã€‚</li>
<li>éç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼ˆNonterminal Expressionï¼‰è§’è‰²ï¼šä¹Ÿæ˜¯æŠ½è±¡è¡¨è¾¾å¼çš„å­ç±»ï¼Œç”¨æ¥å®ç°æ–‡æ³•ä¸­ä¸éç»ˆç»“ç¬¦ç›¸å…³çš„æ“ä½œï¼Œæ–‡æ³•ä¸­çš„æ¯æ¡è§„åˆ™éƒ½å¯¹åº”äºä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚</li>
<li>ç¯å¢ƒï¼ˆContextï¼‰è§’è‰²ï¼šé€šå¸¸åŒ…å«å„ä¸ªè§£é‡Šå™¨éœ€è¦çš„æ•°æ®æˆ–æ˜¯å…¬å…±çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ç”¨æ¥ä¼ é€’è¢«æ‰€æœ‰è§£é‡Šå™¨å…±äº«çš„æ•°æ®ï¼Œåé¢çš„è§£é‡Šå™¨å¯ä»¥ä»è¿™é‡Œè·å–è¿™äº›å€¼ã€‚</li>
<li>å®¢æˆ·ç«¯ï¼ˆClientï¼‰ï¼šä¸»è¦ä»»åŠ¡æ˜¯å°†éœ€è¦åˆ†æçš„å¥å­æˆ–è¡¨è¾¾å¼è½¬æ¢æˆä½¿ç”¨è§£é‡Šå™¨å¯¹è±¡æè¿°çš„æŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åè°ƒç”¨è§£é‡Šå™¨çš„è§£é‡Šæ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒè§’è‰²é—´æ¥è®¿é—®è§£é‡Šå™¨çš„è§£é‡Šæ–¹æ³•ã€‚</li>
</ul>
<h3 id="24-2-2-ä»£ç å®ç°"><a href="#24-2-2-ä»£ç å®ç°" class="headerlink" title="24.2.2 ä»£ç å®ç°"></a>24.2.2 ä»£ç å®ç°</h3><p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_12-22-58.png"></p>
<p><strong>AbstractExpression</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.interpreter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AbstractExpression</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡è§’è‰²</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 9:45</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Value</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.interpreter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Value</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰²</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 9:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Value</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Value</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(value).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Plus</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.interpreter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Plus</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> éç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰² åŠ æ³•è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 9:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Plus</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> AbstractExpression left;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Plus</span><span class="params">(AbstractExpression left, AbstractExpression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpret(context) + right.interpret(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(&quot;</span> + left.toString() + <span class="string">&quot; + &quot;</span> + right.toString() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Minus</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.interpreter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Minus</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> éç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰² å‡æ³•è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 9:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Minus</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression left;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Minus</span><span class="params">(AbstractExpression left, AbstractExpression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpret(context) - right.interpret(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(&quot;</span> + left.toString() + <span class="string">&quot; - &quot;</span> + right.toString() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Variable</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.interpreter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Variable</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰² å˜é‡è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 9:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Variable</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Variable</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> context.getValue(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Context</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.interpreter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Context</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç¯å¢ƒç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 9:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;Variable, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;Variable, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">assign</span><span class="params">(Variable <span class="keyword">var</span>, Integer value)</span> </span>&#123;</span><br><span class="line">        map.put(<span class="keyword">var</span>, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">(Variable <span class="keyword">var</span>)</span> </span>&#123;</span><br><span class="line">        Integer value = map.get(<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.interpreter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è§£é‡Šæƒæ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 9:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Context context = <span class="keyword">new</span> Context();</span><br><span class="line"></span><br><span class="line">        Variable a = <span class="keyword">new</span> Variable(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        Variable b = <span class="keyword">new</span> Variable(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">        Variable c = <span class="keyword">new</span> Variable(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">        Variable d = <span class="keyword">new</span> Variable(<span class="string">&quot;d&quot;</span>);</span><br><span class="line">        Variable e = <span class="keyword">new</span> Variable(<span class="string">&quot;e&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.assign(a, <span class="number">2</span>);</span><br><span class="line">        context.assign(b, <span class="number">3</span>);</span><br><span class="line">        context.assign(c, <span class="number">4</span>);</span><br><span class="line">        context.assign(d, <span class="number">5</span>);</span><br><span class="line">        context.assign(e, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        AbstractExpression expression = <span class="keyword">new</span> Minus(<span class="keyword">new</span> Plus(<span class="keyword">new</span> Plus(<span class="keyword">new</span> Plus(a, b), c), d), e);</span><br><span class="line"></span><br><span class="line">        System.out.println(expression + <span class="string">&quot;=&quot;</span> + expression.interpret(context));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_09-59-41.png"></p>
<h2 id="24-3-è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯"><a href="#24-3-è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯" class="headerlink" title="24.3 è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯"></a>24.3 è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯</h2><ul>
<li>å½“è¯­è¨€çš„æ–‡æ³•è¾ƒä¸ºç®€å•ï¼Œä¸”æ‰§è¡Œæ•ˆç‡ä¸æ˜¯å…³é”®é—®é¢˜æ—¶ã€‚</li>
<li>å½“é—®é¢˜é‡å¤å‡ºç°ï¼Œä¸”å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„è¯­è¨€æ¥è¿›è¡Œè¡¨è¾¾æ—¶ã€‚</li>
<li>å½“ä¸€ä¸ªè¯­è¨€éœ€è¦è§£é‡Šæ‰§è¡Œï¼Œå¹¶ä¸”è¯­è¨€ä¸­çš„å¥å­å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘çš„æ—¶å€™ã€‚</li>
</ul>
<h1 id="25ï¼ŒçŠ¶æ€æ¨¡å¼"><a href="#25ï¼ŒçŠ¶æ€æ¨¡å¼" class="headerlink" title="25ï¼ŒçŠ¶æ€æ¨¡å¼"></a>25ï¼ŒçŠ¶æ€æ¨¡å¼</h1><h2 id="25-1-çŠ¶æ€æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#25-1-çŠ¶æ€æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="25.1 çŠ¶æ€æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>25.1 çŠ¶æ€æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>çŠ¶æ€ï¼ˆStateï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>å¯¹æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼ŒæŠŠå¤æ‚çš„â€œåˆ¤æ–­é€»è¾‘â€æå–åˆ°ä¸åŒçš„çŠ¶æ€å¯¹è±¡ä¸­ï¼Œå…è®¸çŠ¶æ€å¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºã€‚</strong></p>
<p><strong>çŠ¶æ€æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>ç»“æ„æ¸…æ™°ï¼ŒçŠ¶æ€æ¨¡å¼å°†ä¸ç‰¹å®šçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºå±€éƒ¨åŒ–åˆ°ä¸€ä¸ªçŠ¶æ€ä¸­ï¼Œå¹¶ä¸”å°†ä¸åŒçŠ¶æ€çš„è¡Œä¸ºåˆ†å‰²å¼€æ¥ï¼Œæ»¡è¶³â€œå•ä¸€èŒè´£åŸåˆ™â€ã€‚</li>
<li>å°†çŠ¶æ€è½¬æ¢æ˜¾ç¤ºåŒ–ï¼Œå‡å°‘å¯¹è±¡é—´çš„ç›¸äº’ä¾èµ–ã€‚å°†ä¸åŒçš„çŠ¶æ€å¼•å…¥ç‹¬ç«‹çš„å¯¹è±¡ä¸­ä¼šä½¿å¾—çŠ¶æ€è½¬æ¢å˜å¾—æ›´åŠ æ˜ç¡®ï¼Œä¸”å‡å°‘å¯¹è±¡é—´çš„ç›¸äº’ä¾èµ–ã€‚</li>
<li>çŠ¶æ€ç±»èŒè´£æ˜ç¡®ï¼Œæœ‰åˆ©äºç¨‹åºçš„æ‰©å±•ã€‚é€šè¿‡å®šä¹‰æ–°çš„å­ç±»å¾ˆå®¹æ˜“åœ°å¢åŠ æ–°çš„çŠ¶æ€å’Œè½¬æ¢ã€‚</li>
</ol>
<p><strong>çŠ¶æ€æ¨¡å¼çš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿçš„ç±»ä¸å¯¹è±¡çš„ä¸ªæ•°ã€‚</li>
<li>çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´ç¨‹åºç»“æ„å’Œä»£ç çš„æ··ä¹±ã€‚</li>
<li>çŠ¶æ€æ¨¡å¼å¯¹å¼€é—­åŸåˆ™çš„æ”¯æŒå¹¶ä¸å¤ªå¥½ï¼Œå¯¹äºå¯ä»¥åˆ‡æ¢çŠ¶æ€çš„çŠ¶æ€æ¨¡å¼ï¼Œå¢åŠ æ–°çš„çŠ¶æ€ç±»éœ€è¦ä¿®æ”¹é‚£äº›è´Ÿè´£çŠ¶æ€è½¬æ¢çš„æºç ï¼Œå¦åˆ™æ— æ³•åˆ‡æ¢åˆ°æ–°å¢çŠ¶æ€ï¼Œè€Œä¸”ä¿®æ”¹æŸä¸ªçŠ¶æ€ç±»çš„è¡Œä¸ºä¹Ÿéœ€è¦ä¿®æ”¹å¯¹åº”ç±»çš„æºç ã€‚</li>
</ol>
<h2 id="25-2-çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#25-2-çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="25.2 çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>25.2 çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><p>ã€ä¾‹ã€‘é€šè¿‡æŒ‰é’®æ¥æ§åˆ¶ä¸€ä¸ªç”µæ¢¯çš„çŠ¶æ€ï¼Œä¸€ä¸ªç”µæ¢¯æœ‰å¼€é—¨çŠ¶æ€ï¼Œå…³é—¨çŠ¶æ€ï¼Œåœæ­¢çŠ¶æ€ï¼Œè¿è¡ŒçŠ¶æ€ã€‚æ¯ä¸€ç§çŠ¶æ€æ”¹å˜ï¼Œéƒ½æœ‰å¯èƒ½è¦æ ¹æ®å…¶ä»–çŠ¶æ€æ¥æ›´æ–°å¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”µæ¢¯é—¨ç°åœ¨å¤„äºè¿è¡Œæ—¶çŠ¶æ€ï¼Œå°±ä¸èƒ½è¿›è¡Œå¼€é—¨æ“ä½œï¼Œè€Œå¦‚æœç”µæ¢¯é—¨æ˜¯åœæ­¢çŠ¶æ€ï¼Œå°±å¯ä»¥æ‰§è¡Œå¼€é—¨æ“ä½œ</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_12-31-24.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ILift</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç”µæ¢¯çš„4ä¸ªçŠ¶æ€</span></span><br><span class="line">    <span class="comment">//å¼€é—¨çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> OPENING_STATE = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//å…³é—¨çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> CLOSING_STATE = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">//è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> RUNNING_STATE = <span class="number">3</span>;</span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> STOPPING_STATE = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®ç”µæ¢¯çš„çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯çš„åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Lift</span> <span class="keyword">implements</span> <span class="title">ILift</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> state;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œå…³é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å…³é—¨äº†ã€‚ã€‚ã€‚&quot;</span>);<span class="comment">//åªæœ‰å¼€é—¨çŠ¶æ€å¯ä»¥å…³é—­ç”µæ¢¯é—¨ï¼Œå¯ä»¥å¯¹åº”ç”µæ¢¯çŠ¶æ€è¡¨æ¥çœ‹</span></span><br><span class="line">                <span class="keyword">this</span>.setState(CLOSING_STATE);<span class="comment">//å…³é—¨ä¹‹åç”µæ¢¯å°±æ˜¯å…³é—­çŠ¶æ€äº†</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //å·²ç»æ˜¯å…³é—¨çŠ¶æ€ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //è¿è¡Œæ—¶ç”µæ¢¯é—¨æ˜¯å…³ç€çš„ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //åœæ­¢æ—¶ç”µæ¢¯ä¹Ÿæ˜¯å…³ç€çš„ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œå¼€é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:<span class="comment">//é—¨å·²ç»å¼€äº†ï¼Œä¸èƒ½å†å¼€é—¨äº†</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//å…³é—¨çŠ¶æ€ï¼Œé—¨æ‰“å¼€:</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨æ‰“å¼€äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(OPENING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing è¿è¡Œæ—¶ç”µæ¢¯ä¸èƒ½å¼€é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å¼€äº†ã€‚ã€‚ã€‚&quot;</span>);<span class="comment">//ç”µæ¢¯åœäº†ï¼Œå¯ä»¥å¼€é—¨äº†</span></span><br><span class="line">                <span class="keyword">this</span>.setState(OPENING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œè¿è¡ŒåŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:<span class="comment">//ç”µæ¢¯ä¸èƒ½å¼€ç€é—¨å°±èµ°</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//é—¨å…³äº†ï¼Œå¯ä»¥è¿è¡Œäº†</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å¼€å§‹è¿è¡Œäº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(RUNNING_STATE);<span class="comment">//ç°åœ¨æ˜¯è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing å·²ç»æ˜¯è¿è¡ŒçŠ¶æ€äº†</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å¼€å§‹è¿è¡Œäº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(RUNNING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œåœæ­¢åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE: <span class="comment">//å¼€é—¨çš„ç”µæ¢¯å·²ç»æ˜¯æ˜¯åœæ­¢çš„äº†(æ­£å¸¸æƒ…å†µä¸‹)</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//å…³é—¨æ—¶æ‰å¯ä»¥åœæ­¢</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(STOPPING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:<span class="comment">//è¿è¡Œæ—¶å½“ç„¶å¯ä»¥åœæ­¢äº†</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(STOPPING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Lift lift = <span class="keyword">new</span> Lift();</span><br><span class="line">        lift.setState(ILift.STOPPING_STATE);<span class="comment">//ç”µæ¢¯æ˜¯åœæ­¢çš„</span></span><br><span class="line">        lift.open();<span class="comment">//å¼€é—¨</span></span><br><span class="line">        lift.close();<span class="comment">//å…³é—¨</span></span><br><span class="line">        lift.run();<span class="comment">//è¿è¡Œ</span></span><br><span class="line">        lift.stop();<span class="comment">//åœæ­¢</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_10-46-54.png"></p>
<p><strong>é—®é¢˜åˆ†æ</strong></p>
<ul>
<li>ä½¿ç”¨äº†å¤§é‡çš„switchâ€¦caseè¿™æ ·çš„åˆ¤æ–­ï¼ˆifâ€¦elseä¹Ÿæ˜¯ä¸€æ ·)ï¼Œä½¿ç¨‹åºçš„å¯é˜…è¯»æ€§å˜å·®ã€‚</li>
<li>æ‰©å±•æ€§å¾ˆå·®ã€‚å¦‚æœæ–°åŠ äº†æ–­ç”µçš„çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸Šé¢åˆ¤æ–­é€»è¾‘</li>
</ul>
<h3 id="25-2-1-çŠ¶æ€æ¨¡å¼çš„ç»“æ„"><a href="#25-2-1-çŠ¶æ€æ¨¡å¼çš„ç»“æ„" class="headerlink" title="25.2.1 çŠ¶æ€æ¨¡å¼çš„ç»“æ„"></a>25.2.1 çŠ¶æ€æ¨¡å¼çš„ç»“æ„</h3><ul>
<li>ç¯å¢ƒï¼ˆContextï¼‰è§’è‰²ï¼šä¹Ÿç§°ä¸ºä¸Šä¸‹æ–‡ï¼Œå®ƒå®šä¹‰äº†å®¢æˆ·ç¨‹åºéœ€è¦çš„æ¥å£ï¼Œç»´æŠ¤ä¸€ä¸ªå½“å‰çŠ¶æ€ï¼Œå¹¶å°†ä¸çŠ¶æ€ç›¸å…³çš„æ“ä½œå§”æ‰˜ç»™å½“å‰çŠ¶æ€å¯¹è±¡æ¥å¤„ç†ã€‚</li>
<li>æŠ½è±¡çŠ¶æ€ï¼ˆStateï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç”¨ä»¥å°è£…ç¯å¢ƒå¯¹è±¡ä¸­çš„ç‰¹å®šçŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºã€‚</li>
<li>å…·ä½“çŠ¶æ€ï¼ˆConcrete Stateï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡çŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºã€‚</li>
</ul>
<h3 id="25-2-2-ä»£ç å®ç°"><a href="#25-2-2-ä»£ç å®ç°" class="headerlink" title="25.2.2 ä»£ç å®ç°"></a>25.2.2 ä»£ç å®ç°</h3><p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_12-33-29.png"></p>
<p><strong>LiftState</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.state.after;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> LiftState</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æŠ½è±¡çŠ¶æ€ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 10:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªç¯å¢ƒè§’è‰²ï¼Œä¹Ÿå°±æ˜¯å°è£…çŠ¶æ€çš„å˜åŒ–å¼•èµ·çš„åŠŸèƒ½å˜åŒ–</span></span><br><span class="line">    <span class="keyword">protected</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContext</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯å¼€é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯å…³é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯è¿è¡ŒåŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯åœæ­¢åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Context</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.state.after;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Context</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰æ‰€æœ‰ç”µæ¢¯é—¨çŠ¶æ€</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 10:53</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰å‡ºæ‰€æœ‰çš„ç”µæ¢¯çŠ¶æ€</span></span><br><span class="line">    <span class="comment">//å¼€é—¨çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯åªèƒ½å…³é—­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> OpeningState OPENNING_STATE = <span class="keyword">new</span> OpeningState();</span><br><span class="line">    <span class="comment">//å…³é—­çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯å¯ä»¥è¿è¡Œã€åœæ­¢å’Œå¼€é—¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> ClosingState CLOSEING_STATE = <span class="keyword">new</span> ClosingState();</span><br><span class="line">    <span class="comment">//è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯åªèƒ½åœæ­¢</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> RunningState RUNNING_STATE = <span class="keyword">new</span> RunningState();</span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯å¯ä»¥å¼€é—¨ã€è¿è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> StoppingState STOPPING_STATE = <span class="keyword">new</span> StoppingState();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªå½“å‰ç”µæ¢¯çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">private</span> LiftState liftState;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LiftState <span class="title">getLiftState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.liftState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLiftState</span><span class="params">(LiftState liftState)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å½“å‰ç¯å¢ƒæ”¹å˜</span></span><br><span class="line">        <span class="keyword">this</span>.liftState = liftState;</span><br><span class="line">        <span class="comment">//æŠŠå½“å‰çš„ç¯å¢ƒé€šçŸ¥åˆ°å„ä¸ªå®ç°ç±»ä¸­</span></span><br><span class="line">        <span class="keyword">this</span>.liftState.setContext(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OpeningState</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.state.after;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> OpeningState</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å¼€å¯çŠ¶æ€</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 10:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OpeningState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¼€å¯å½“ç„¶å¯ä»¥å…³é—­äº†ï¼Œæˆ‘å°±æƒ³æµ‹è¯•ä¸€ä¸‹ç”µæ¢¯é—¨å¼€å…³åŠŸèƒ½</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å¼€å¯...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.CLOSEING_STATE);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨ä¸èƒ½å¼€ç€å°±è·‘ï¼Œè¿™é‡Œä»€ä¹ˆä¹Ÿä¸åš</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¼€é—¨çŠ¶æ€å·²ç»æ˜¯åœæ­¢çš„äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ClosingState</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.state.after;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ClosingState</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å…³é—­çŠ¶æ€</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 10:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClosingState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³é—­ï¼Œè¿™æ˜¯å…³é—­çŠ¶æ€è¦å®ç°çš„åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å…³é—­...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³äº†å†æ‰“å¼€ï¼Œé€—ä½ ç©å‘¢ï¼Œé‚£è¿™ä¸ªå…è®¸å‘€</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.OPENNING_STATE);</span><br><span class="line">        <span class="keyword">super</span>.context.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³äº†å°±è·‘ï¼Œè¿™æ˜¯å†æ­£å¸¸ä¸è¿‡äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.RUNNING_STATE);</span><br><span class="line">        <span class="keyword">super</span>.context.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³ç€ï¼Œæˆ‘å°±ä¸æŒ‰æ¥¼å±‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.STOPPING_STATE);</span><br><span class="line">        <span class="keyword">super</span>.context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>RunningState</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.state.after;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> RunningState</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¿è¡ŒçŠ¶æ€</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 10:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunningState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä»€ä¹ˆä¹Ÿä¸åš</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä»€ä¹ˆä¹Ÿä¸åš</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯æ­£åœ¨è¿è¡Œ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åœæ­¢</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.OPENNING_STATE);</span><br><span class="line">        <span class="keyword">super</span>.context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StoppingState</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.state.after;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StoppingState</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åœæ­¢çŠ¶æ€</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 10:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StoppingState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.OPENNING_STATE);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ç»™CloseStateæ¥æ‰§è¡Œ ä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡ŒåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.CLOSEING_STATE);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ç»™CloseStateæ¥æ‰§è¡Œ ä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡ŒåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.RUNNING_STATE);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ç»™CloseStateæ¥æ‰§è¡Œ ä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡ŒåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.state.after;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> çŠ¶æ€æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 10:53</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¼€é—¨çŠ¶æ€</span></span><br><span class="line">        System.out.println(<span class="string">&quot;å¼€é—¨çŠ¶æ€--&gt;&quot;</span>);</span><br><span class="line">        Context context1 = <span class="keyword">new</span> Context();</span><br><span class="line">        context1.setLiftState(<span class="keyword">new</span> OpeningState());</span><br><span class="line">        context1.open();</span><br><span class="line">        context1.close();</span><br><span class="line">        context1.run();</span><br><span class="line">        context1.stop();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=========================&quot;</span>);</span><br><span class="line">        <span class="comment">//å…³é—¨çŠ¶æ€</span></span><br><span class="line">        System.out.println(<span class="string">&quot;å…³é—¨çŠ¶æ€--&gt;&quot;</span>);</span><br><span class="line">        Context context2 = <span class="keyword">new</span> Context();</span><br><span class="line">        context2.setLiftState(<span class="keyword">new</span> ClosingState());</span><br><span class="line">        context2.open();</span><br><span class="line">        context2.close();</span><br><span class="line">        context2.run();</span><br><span class="line">        context2.stop();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=========================&quot;</span>);</span><br><span class="line">        <span class="comment">//è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">        System.out.println(<span class="string">&quot;è¿è¡ŒçŠ¶æ€--&gt;&quot;</span>);</span><br><span class="line">        Context context3 = <span class="keyword">new</span> Context();</span><br><span class="line">        context3.setLiftState(<span class="keyword">new</span> RunningState());</span><br><span class="line">        context3.open();</span><br><span class="line">        context3.close();</span><br><span class="line">        context3.run();</span><br><span class="line">        context3.stop();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=========================&quot;</span>);</span><br><span class="line">        <span class="comment">//åœæ­¢çŠ¶æ€</span></span><br><span class="line">        System.out.println(<span class="string">&quot;åœæ­¢çŠ¶æ€--&gt;&quot;</span>);</span><br><span class="line">        Context context4 = <span class="keyword">new</span> Context();</span><br><span class="line">        context4.setLiftState(<span class="keyword">new</span> StoppingState());</span><br><span class="line">        context4.open();</span><br><span class="line">        context4.close();</span><br><span class="line">        context4.run();</span><br><span class="line">        context4.stop();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_12-17-58.png"></p>
<h2 id="25-3-çŠ¶æ€æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#25-3-çŠ¶æ€æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="25.3 çŠ¶æ€æ¨¡å¼åº”ç”¨åœºæ™¯"></a>25.3 çŠ¶æ€æ¨¡å¼åº”ç”¨åœºæ™¯</h2><ul>
<li>å½“ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºå–å†³äºå®ƒçš„çŠ¶æ€ï¼Œå¹¶ä¸”å®ƒå¿…é¡»åœ¨è¿è¡Œæ—¶æ ¹æ®çŠ¶æ€æ”¹å˜å®ƒçš„è¡Œä¸ºæ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨çŠ¶æ€æ¨¡å¼ã€‚</li>
<li>ä¸€ä¸ªæ“ä½œä¸­å«æœ‰åºå¤§çš„åˆ†æ”¯ç»“æ„ï¼Œå¹¶ä¸”è¿™äº›åˆ†æ”¯å†³å®šäºå¯¹è±¡çš„çŠ¶æ€æ—¶ã€‚</li>
</ul>
<h1 id="26ï¼Œç­–ç•¥æ¨¡å¼"><a href="#26ï¼Œç­–ç•¥æ¨¡å¼" class="headerlink" title="26ï¼Œç­–ç•¥æ¨¡å¼"></a>26ï¼Œç­–ç•¥æ¨¡å¼</h1><h2 id="26-1-ç­–ç•¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#26-1-ç­–ç•¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="26.1 ç­–ç•¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>26.1 ç­–ç•¥æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>ç­–ç•¥ï¼ˆStrategyï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>è¯¥æ¨¡å¼å®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œä¸”ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚</strong>ç­–ç•¥æ¨¡å¼å±äºå¯¹è±¡è¡Œä¸ºæ¨¡å¼ï¼Œå®ƒé€šè¿‡å¯¹ç®—æ³•è¿›è¡Œå°è£…ï¼ŒæŠŠä½¿ç”¨ç®—æ³•çš„è´£ä»»å’Œç®—æ³•çš„å®ç°åˆ†å‰²å¼€æ¥ï¼Œå¹¶å§”æ´¾ç»™ä¸åŒçš„å¯¹è±¡å¯¹è¿™äº›ç®—æ³•è¿›è¡Œç®¡ç†ã€‚</p>
<p><strong>ç­–ç•¥æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>å¤šé‡æ¡ä»¶è¯­å¥ä¸æ˜“ç»´æŠ¤ï¼Œè€Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶è¯­å¥ï¼Œå¦‚ ifâ€¦else è¯­å¥ã€switchâ€¦case è¯­å¥ã€‚</li>
<li>ç­–ç•¥æ¨¡å¼æä¾›äº†ä¸€ç³»åˆ—çš„å¯ä¾›é‡ç”¨çš„ç®—æ³•æ—ï¼Œæ°å½“ä½¿ç”¨ç»§æ‰¿å¯ä»¥æŠŠç®—æ³•æ—çš„å…¬å…±ä»£ç è½¬ç§»åˆ°çˆ¶ç±»é‡Œé¢ï¼Œä»è€Œé¿å…é‡å¤çš„ä»£ç ã€‚</li>
<li>ç­–ç•¥æ¨¡å¼å¯ä»¥æä¾›ç›¸åŒè¡Œä¸ºçš„ä¸åŒå®ç°ï¼Œå®¢æˆ·å¯ä»¥æ ¹æ®ä¸åŒæ—¶é—´æˆ–ç©ºé—´è¦æ±‚é€‰æ‹©ä¸åŒçš„ã€‚</li>
<li>ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹å¼€é—­åŸåˆ™çš„å®Œç¾æ”¯æŒï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹åŸä»£ç çš„æƒ…å†µä¸‹ï¼Œçµæ´»å¢åŠ æ–°ç®—æ³•ã€‚</li>
<li>ç­–ç•¥æ¨¡å¼æŠŠç®—æ³•çš„ä½¿ç”¨æ”¾åˆ°ç¯å¢ƒç±»ä¸­ï¼Œè€Œç®—æ³•çš„å®ç°ç§»åˆ°å…·ä½“ç­–ç•¥ç±»ä¸­ï¼Œå®ç°äº†äºŒè€…çš„åˆ†ç¦»ã€‚</li>
</ol>
<p><strong>å…¶ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>å®¢æˆ·ç«¯å¿…é¡»ç†è§£æ‰€æœ‰ç­–ç•¥ç®—æ³•çš„åŒºåˆ«ï¼Œä»¥ä¾¿é€‚æ—¶é€‰æ‹©æ°å½“çš„ç®—æ³•ç±»ã€‚</li>
<li>ç­–ç•¥æ¨¡å¼é€ æˆå¾ˆå¤šçš„ç­–ç•¥ç±»ï¼Œå¢åŠ ç»´æŠ¤éš¾åº¦ã€‚</li>
</ol>
<h2 id="26-2-ç­–ç•¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#26-2-ç­–ç•¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="26.2 ç­–ç•¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>26.2 ç­–ç•¥æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="26-2-1-ç­–ç•¥æ¨¡å¼çš„ç»“æ„"><a href="#26-2-1-ç­–ç•¥æ¨¡å¼çš„ç»“æ„" class="headerlink" title="26.2 .1 ç­–ç•¥æ¨¡å¼çš„ç»“æ„"></a>26.2 .1 ç­–ç•¥æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡ç­–ç•¥ï¼ˆStrategyï¼‰ç±»ï¼šå®šä¹‰äº†ä¸€ä¸ªå…¬å…±æ¥å£ï¼Œå„ç§ä¸åŒçš„ç®—æ³•ä»¥ä¸åŒçš„æ–¹å¼å®ç°è¿™ä¸ªæ¥å£ï¼Œç¯å¢ƒè§’è‰²ä½¿ç”¨è¿™ä¸ªæ¥å£è°ƒç”¨ä¸åŒçš„ç®—æ³•ï¼Œä¸€èˆ¬ä½¿ç”¨æ¥å£æˆ–æŠ½è±¡ç±»å®ç°ã€‚</li>
<li>å…·ä½“ç­–ç•¥ï¼ˆConcrete Strategyï¼‰ç±»ï¼šå®ç°äº†æŠ½è±¡ç­–ç•¥å®šä¹‰çš„æ¥å£ï¼Œæä¾›å…·ä½“çš„ç®—æ³•å®ç°ã€‚</li>
<li>ç¯å¢ƒï¼ˆContextï¼‰ç±»ï¼šæŒæœ‰ä¸€ä¸ªç­–ç•¥ç±»çš„å¼•ç”¨ï¼Œæœ€ç»ˆç»™å®¢æˆ·ç«¯è°ƒç”¨ã€‚</li>
</ol>
<h3 id="26-2-2-ä»£ç å®ç°"><a href="#26-2-2-ä»£ç å®ç°" class="headerlink" title="26.2.2 ä»£ç å®ç°"></a>26.2.2 ä»£ç å®ç°</h3><p>é’ˆå¯¹ä¸åŒèŠ‚æ—¥ä¸åŒçš„ä¿ƒé”€æ´»åŠ¨</p>
<p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_17-39-00.png"></p>
<p><strong>Strategy</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Strategy</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰å…±åŒæ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 15:29</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StrategyA</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StrategyA</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰å…·ä½“ç­–ç•¥è§’è‰² æ¯ä¸ªèŠ‚æ—¥çš„å…·ä½“ä¿ƒé”€æ´»åŠ¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 15:29</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyA</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Aä¿ƒé”€ ä¹°ä¸€é€ä¸€&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StrategyB</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StrategyB</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰å…·ä½“ç­–ç•¥è§’è‰² æ¯ä¸ªèŠ‚æ—¥çš„å…·ä½“ä¿ƒé”€æ´»åŠ¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 15:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyB</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bä¿ƒé”€ æ»¡100å‡20&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>StrategyC</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StrategyC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰å…·ä½“ç­–ç•¥è§’è‰² æ¯ä¸ªèŠ‚æ—¥çš„å…·ä½“ä¿ƒé”€æ´»åŠ¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 15:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyC</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Cä¿ƒé”€ æ»¡500å…ƒå¯å…‘æ¢å°ç¤¼å“&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SalesMan</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SalesMan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®šä¹‰ç¯å¢ƒè§’è‰² ç”¨äºè¿æ¥ä¸Šä¸‹æ–‡ æŠŠä¿ƒé”€æ´»åŠ¨æ¨é”€ç»™é¡¾å®¢</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 15:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SalesMan</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒæœ‰æŠ½è±¡ç­–ç•¥è§’è‰²çš„å¼•ç”¨</span></span><br><span class="line">    <span class="keyword">private</span> Strategy strategy;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SalesMan</span><span class="params">(Strategy strategy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Strategy <span class="title">getStrategy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStrategy</span><span class="params">(Strategy strategy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å±•ç¤ºä¿ƒé”€æ´»åŠ¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">salesManShow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        strategy.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç­–ç•¥æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 15:34</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SalesMan salesMan = <span class="keyword">new</span> SalesMan(<span class="keyword">new</span> StrategyA());</span><br><span class="line">        <span class="comment">//å„¿ç«¥èŠ‚</span></span><br><span class="line">        salesMan.salesManShow();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=======================&quot;</span>);</span><br><span class="line">        <span class="comment">//åŠ³åŠ¨èŠ‚</span></span><br><span class="line">        salesMan.setStrategy(<span class="keyword">new</span> StrategyB());</span><br><span class="line">        salesMan.salesManShow();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=======================&quot;</span>);</span><br><span class="line">        <span class="comment">//ç«¯åˆèŠ‚</span></span><br><span class="line">        salesMan.setStrategy(<span class="keyword">new</span> StrategyC());</span><br><span class="line">        salesMan.salesManShow();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_15-37-23.png"></p>
<h2 id="26-3-ç­–ç•¥æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#26-3-ç­–ç•¥æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="26.3 ç­–ç•¥æ¨¡å¼åº”ç”¨åœºæ™¯"></a>26.3 ç­–ç•¥æ¨¡å¼åº”ç”¨åœºæ™¯</h2><ul>
<li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§æ—¶ï¼Œå¯å°†æ¯ä¸ªç®—æ³•å°è£…åˆ°ç­–ç•¥ç±»ä¸­ã€‚</li>
<li>ä¸€ä¸ªç±»å®šä¹‰äº†å¤šç§è¡Œä¸ºï¼Œå¹¶ä¸”è¿™äº›è¡Œä¸ºåœ¨è¿™ä¸ªç±»çš„æ“ä½œä¸­ä»¥å¤šä¸ªæ¡ä»¶è¯­å¥çš„å½¢å¼å‡ºç°ï¼Œå¯å°†æ¯ä¸ªæ¡ä»¶åˆ†æ”¯ç§»å…¥å®ƒä»¬å„è‡ªçš„ç­–ç•¥ç±»ä¸­ä»¥ä»£æ›¿è¿™äº›æ¡ä»¶è¯­å¥ã€‚</li>
<li>ç³»ç»Ÿä¸­å„ç®—æ³•å½¼æ­¤å®Œå…¨ç‹¬ç«‹ï¼Œä¸”è¦æ±‚å¯¹å®¢æˆ·éšè—å…·ä½“ç®—æ³•çš„å®ç°ç»†èŠ‚æ—¶ã€‚</li>
<li>ç³»ç»Ÿè¦æ±‚ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ä¸åº”è¯¥çŸ¥é“å…¶æ“ä½œçš„æ•°æ®æ—¶ï¼Œå¯ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥éšè—ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„ã€‚</li>
<li>å¤šä¸ªç±»åªåŒºåˆ«åœ¨è¡¨ç°è¡Œä¸ºä¸åŒï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©å…·ä½“è¦æ‰§è¡Œçš„è¡Œä¸ºã€‚</li>
</ul>
<h2 id="26-4-JDKæºç è§£æ"><a href="#26-4-JDKæºç è§£æ" class="headerlink" title="26.4 JDKæºç è§£æ"></a>26.4 JDKæºç è§£æ</h2><p><code>Comparator</code> ä¸­çš„ç­–ç•¥æ¨¡å¼ã€‚åœ¨Arraysç±»ä¸­æœ‰ä¸€ä¸ª <code>sort()</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Arrays</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] a, Comparator&lt;? <span class="keyword">super</span> T&gt; c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">            sort(a);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (LegacyMergeSort.userRequested)</span><br><span class="line">                legacyMergeSort(a, c);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                TimSort.sort(a, <span class="number">0</span>, a.length, c, <span class="keyword">null</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Arrayså°±æ˜¯ä¸€ä¸ªç¯å¢ƒè§’è‰²ç±»ï¼Œè¿™ä¸ªsortæ–¹æ³•å¯ä»¥ä¼ ä¸€ä¸ªæ–°ç­–ç•¥è®©Arraysæ ¹æ®è¿™ä¸ªç­–ç•¥æ¥è¿›è¡Œæ’åºã€‚å°±æ¯”å¦‚ä¸‹é¢çš„æµ‹è¯•ç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Integer[] data = &#123;<span class="number">12</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>&#125;;</span><br><span class="line">        <span class="comment">// å®ç°é™åºæ’åº</span></span><br><span class="line">        Arrays.sort(data, <span class="keyword">new</span> Comparator&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer o1, Integer o2)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> o2 - o1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(Arrays.toString(data)); <span class="comment">//[12, 5, 4, 3, 2, 2, 1]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬åœ¨è°ƒç”¨Arraysçš„sortæ–¹æ³•æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„æ˜¯Comparatoræ¥å£çš„å­å®ç°ç±»å¯¹è±¡ã€‚æ‰€ä»¥Comparatorå……å½“çš„æ˜¯æŠ½è±¡ç­–ç•¥è§’è‰²ï¼Œè€Œå…·ä½“çš„å­å®ç°ç±»å……å½“çš„æ˜¯å…·ä½“ç­–ç•¥è§’è‰²ã€‚ç¯å¢ƒè§’è‰²ç±»ï¼ˆArraysï¼‰åº”è¯¥æŒæœ‰æŠ½è±¡ç­–ç•¥çš„å¼•ç”¨æ¥è°ƒç”¨ã€‚é‚£ä¹ˆï¼ŒArraysç±»çš„sortæ–¹æ³•åˆ°åº•æœ‰æ²¡æœ‰ä½¿ç”¨Comparatorå­å®ç°ç±»ä¸­çš„ <code>compare()</code> æ–¹æ³•å—ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­æŸ¥çœ‹TimSortç±»çš„ <code>sort()</code> æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TimSort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi, Comparator&lt;? <span class="keyword">super</span> T&gt; c,</span></span></span><br><span class="line"><span class="function"><span class="params">                         T[] work, <span class="keyword">int</span> workBase, <span class="keyword">int</span> workLen)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> c != <span class="keyword">null</span> &amp;&amp; a != <span class="keyword">null</span> &amp;&amp; lo &gt;= <span class="number">0</span> &amp;&amp; lo &lt;= hi &amp;&amp; hi &lt;= a.length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> nRemaining  = hi - lo;</span><br><span class="line">        <span class="keyword">if</span> (nRemaining &lt; <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span>;  <span class="comment">// Arrays of size 0 and 1 are always sorted</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// If array is small, do a &quot;mini-TimSort&quot; with no merges</span></span><br><span class="line">        <span class="keyword">if</span> (nRemaining &lt; MIN_MERGE) &#123;</span><br><span class="line">            <span class="keyword">int</span> initRunLen = countRunAndMakeAscending(a, lo, hi, c);</span><br><span class="line">            binarySort(a, lo, hi, lo + initRunLen, c);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;   </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">int</span> <span class="title">countRunAndMakeAscending</span><span class="params">(T[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi,Comparator&lt;? <span class="keyword">super</span> T&gt; c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> lo &lt; hi;</span><br><span class="line">        <span class="keyword">int</span> runHi = lo + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (runHi == hi)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Find end of run, and reverse range if descending</span></span><br><span class="line">        <span class="keyword">if</span> (c.compare(a[runHi++], a[lo]) &lt; <span class="number">0</span>) &#123; <span class="comment">// Descending</span></span><br><span class="line">            <span class="keyword">while</span> (runHi &lt; hi &amp;&amp; c.compare(a[runHi], a[runHi - <span class="number">1</span>]) &lt; <span class="number">0</span>)</span><br><span class="line">                runHi++;</span><br><span class="line">            reverseRange(a, lo, runHi);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;                              <span class="comment">// Ascending</span></span><br><span class="line">            <span class="keyword">while</span> (runHi &lt; hi &amp;&amp; c.compare(a[runHi], a[runHi - <span class="number">1</span>]) &gt;= <span class="number">0</span>)</span><br><span class="line">                runHi++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> runHi - lo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç ä¸­æœ€ç»ˆä¼šè·‘åˆ° <code>countRunAndMakeAscending()</code> è¿™ä¸ªæ–¹æ³•ä¸­ã€‚æˆ‘ä»¬å¯ä»¥çœ‹è§ï¼Œåªç”¨äº†compareæ–¹æ³•ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨Arrays.sortæ–¹æ³•åªä¼ å…·ä½“compareé‡å†™æ–¹æ³•çš„ç±»å¯¹è±¡å°±è¡Œï¼Œè¿™ä¹Ÿæ˜¯Comparatoræ¥å£ä¸­å¿…é¡»è¦å­ç±»å®ç°çš„ä¸€ä¸ªæ–¹æ³•ã€‚</p>
<h1 id="27ï¼Œè´£ä»»é“¾æ¨¡å¼"><a href="#27ï¼Œè´£ä»»é“¾æ¨¡å¼" class="headerlink" title="27ï¼Œè´£ä»»é“¾æ¨¡å¼"></a>27ï¼Œè´£ä»»é“¾æ¨¡å¼</h1><h2 id="27-1-è´£ä»»é“¾æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"><a href="#27-1-è´£ä»»é“¾æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹" class="headerlink" title="27.1 è´£ä»»é“¾æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹"></a>27.1 è´£ä»»é“¾æ¨¡å¼çš„å®šä¹‰å’Œç‰¹ç‚¹</h2><p>è´£ä»»é“¾ï¼ˆChain of Responsibilityï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>ä¸ºäº†é¿å…è¯·æ±‚å‘é€è€…ä¸å¤šä¸ªè¯·æ±‚å¤„ç†è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œäºæ˜¯å°†æ‰€æœ‰è¯·æ±‚çš„å¤„ç†è€…é€šè¿‡å‰ä¸€å¯¹è±¡è®°ä½å…¶ä¸‹ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è€Œè¿æˆä¸€æ¡é“¾ï¼›å½“æœ‰è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œå¯å°†è¯·æ±‚æ²¿ç€è¿™æ¡é“¾ä¼ é€’ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</strong></p>
<p>æ³¨æ„ï¼šè´£ä»»é“¾æ¨¡å¼ä¹Ÿå«èŒè´£é“¾æ¨¡å¼ã€‚</p>
<p>åœ¨è´£ä»»é“¾æ¨¡å¼ä¸­ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°è´£ä»»é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ï¼Œè¯·æ±‚ä¼šè‡ªåŠ¨è¿›è¡Œä¼ é€’ã€‚æ‰€ä»¥è´£ä»»é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚</p>
<p><strong>è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>é™ä½äº†å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦ã€‚è¯¥æ¨¡å¼ä½¿å¾—ä¸€ä¸ªå¯¹è±¡æ— é¡»çŸ¥é“åˆ°åº•æ˜¯å“ªä¸€ä¸ªå¯¹è±¡å¤„ç†å…¶è¯·æ±‚ä»¥åŠé“¾çš„ç»“æ„ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…ä¹Ÿæ— é¡»æ‹¥æœ‰å¯¹æ–¹çš„æ˜ç¡®ä¿¡æ¯ã€‚</li>
<li>å¢å¼ºäº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€‚å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™ã€‚</li>
<li>å¢å¼ºäº†ç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚å½“å·¥ä½œæµç¨‹å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥åŠ¨æ€åœ°æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œä¹Ÿå¯åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</li>
<li>è´£ä»»é“¾ç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„è¿æ¥ã€‚æ¯ä¸ªå¯¹è±¡åªéœ€ä¿æŒä¸€ä¸ªæŒ‡å‘å…¶åç»§è€…çš„å¼•ç”¨ï¼Œä¸éœ€ä¿æŒå…¶ä»–æ‰€æœ‰å¤„ç†è€…çš„å¼•ç”¨ï¼Œè¿™é¿å…äº†ä½¿ç”¨ä¼—å¤šçš„ if æˆ–è€… ifÂ·Â·Â·else è¯­å¥ã€‚</li>
<li>è´£ä»»åˆ†æ‹…ã€‚æ¯ä¸ªç±»åªéœ€è¦å¤„ç†è‡ªå·±è¯¥å¤„ç†çš„å·¥ä½œï¼Œä¸è¯¥å¤„ç†çš„ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¯¹è±¡å®Œæˆï¼Œæ˜ç¡®å„ç±»çš„è´£ä»»èŒƒå›´ï¼Œç¬¦åˆç±»çš„å•ä¸€èŒè´£åŸåˆ™ã€‚</li>
</ol>
<p><strong>å…¶ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ã€‚</strong></p>
<ol>
<li>ä¸èƒ½ä¿è¯æ¯ä¸ªè¯·æ±‚ä¸€å®šè¢«å¤„ç†ã€‚ç”±äºä¸€ä¸ªè¯·æ±‚æ²¡æœ‰æ˜ç¡®çš„æ¥æ”¶è€…ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯å®ƒä¸€å®šä¼šè¢«å¤„ç†ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¸€ç›´ä¼ åˆ°é“¾çš„æœ«ç«¯éƒ½å¾—ä¸åˆ°å¤„ç†ã€‚</li>
<li>å¯¹æ¯”è¾ƒé•¿çš„èŒè´£é“¾ï¼Œè¯·æ±‚çš„å¤„ç†å¯èƒ½æ¶‰åŠå¤šä¸ªå¤„ç†å¯¹è±¡ï¼Œç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ã€‚</li>
<li>èŒè´£é“¾å»ºç«‹çš„åˆç†æ€§è¦é å®¢æˆ·ç«¯æ¥ä¿è¯ï¼Œå¢åŠ äº†å®¢æˆ·ç«¯çš„å¤æ‚æ€§ï¼Œå¯èƒ½ä¼šç”±äºèŒè´£é“¾çš„é”™è¯¯è®¾ç½®è€Œå¯¼è‡´ç³»ç»Ÿå‡ºé”™ï¼Œå¦‚å¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚</li>
</ol>
<h2 id="27-2-è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„ä¸å®ç°"><a href="#27-2-è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„ä¸å®ç°" class="headerlink" title="27.2 è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„ä¸å®ç°"></a>27.2 è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„ä¸å®ç°</h2><h3 id="27-2-1-è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„"><a href="#27-2-1-è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„" class="headerlink" title="27.2.1 è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„"></a>27.2.1 è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„</h3><ol>
<li>æŠ½è±¡å¤„ç†è€…ï¼ˆHandlerï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼ŒåŒ…å«æŠ½è±¡å¤„ç†æ–¹æ³•å’Œä¸€ä¸ªåç»§è¿æ¥ã€‚</li>
<li>å…·ä½“å¤„ç†è€…ï¼ˆConcrete Handlerï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡å¤„ç†è€…çš„å¤„ç†æ–¹æ³•ï¼Œåˆ¤æ–­èƒ½å¦å¤„ç†æœ¬æ¬¡è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥å¤„ç†è¯·æ±‚åˆ™å¤„ç†ï¼Œå¦åˆ™å°†è¯¥è¯·æ±‚è½¬ç»™å®ƒçš„åç»§è€…ã€‚</li>
<li>å®¢æˆ·ç±»ï¼ˆClientï¼‰è§’è‰²ï¼šåˆ›å»ºå¤„ç†é“¾ï¼Œå¹¶å‘é“¾å¤´çš„å…·ä½“å¤„ç†è€…å¯¹è±¡æäº¤è¯·æ±‚ï¼Œå®ƒä¸å…³å¿ƒå¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ã€‚</li>
</ol>
<h3 id="27-2-1-ä»£ç å®ç°"><a href="#27-2-1-ä»£ç å®ç°" class="headerlink" title="27.2.1 ä»£ç å®ç°"></a>27.2.1 ä»£ç å®ç°</h3><p>å¼€å‘ä¸€ä¸ªè¯·å‡æµç¨‹æ§åˆ¶ç³»ç»Ÿã€‚è¯·å‡ä¸€å¤©ä»¥ä¸‹çš„å‡åªéœ€è¦å°ç»„é•¿åŒæ„å³å¯ï¼›è¯·å‡1å¤©åˆ°3å¤©çš„å‡è¿˜éœ€è¦éƒ¨é—¨ç»ç†åŒæ„ï¼›è¯·æ±‚3å¤©åˆ°7å¤©è¿˜éœ€è¦æ€»ç»ç†åŒæ„æ‰è¡Œ</p>
<p><strong>å…³ç³»ç±»å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_17-45-53.png"></p>
<p><strong>LeaveRequest</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.responsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> LeaveRequest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¯·å‡æ¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 16:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LeaveRequest</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å§“å</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">// è¯·å‡å¤©æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> num;</span><br><span class="line">    <span class="comment">// è¯·å‡å†…å®¹</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LeaveRequest</span><span class="params">(String name, <span class="keyword">int</span> num, String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.num = num;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Handler</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.responsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Handler</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 16:23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> NUM_ONE = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> NUM_THREE = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> NUM_SEVEN = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¯¥é¢†å¯¼å¤„ç†çš„è¯·å‡å¤©æ•°åŒºé—´</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> numStart;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> numEnd;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//é¢†å¯¼ä¸Šè¿˜æœ‰é¢†å¯¼</span></span><br><span class="line">    <span class="keyword">private</span> Handler nextHandler;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®è¯·å‡å¤©æ•°èŒƒå›´</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(<span class="keyword">int</span> numStart)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.numStart = numStart;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®è¯·å‡å¤©æ•°èŒƒå›´</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(<span class="keyword">int</span> numStart, <span class="keyword">int</span> numEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.numStart = numStart;</span><br><span class="line">        <span class="keyword">this</span>.numEnd = numEnd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®ä¸Šçº§é¢†å¯¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextHandler</span><span class="params">(Handler nextHandler)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.nextHandler = nextHandler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æäº¤è¯·å‡æ¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">submit</span><span class="params">(LeaveRequest leaveRequest)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.numStart == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è¯·å‡å¤©æ•°è¾¾åˆ°é¢†å¯¼å¤„ç†è¦æ±‚</span></span><br><span class="line">        <span class="keyword">if</span> (leaveRequest.getNum() &gt;= <span class="keyword">this</span>.numStart) &#123;</span><br><span class="line">            <span class="keyword">this</span>.handleLeave(leaveRequest);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœè¿˜æœ‰ä¸Šçº§ å¹¶ä¸”è¯·å‡å¤©æ•°è¶…è¿‡å½“å‰é¢†å¯¼çš„å¤„ç†èŒƒå›´</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.nextHandler != <span class="keyword">null</span> &amp;&amp; leaveRequest.getNum() &gt; numEnd) &#123;</span><br><span class="line">                <span class="comment">//ç»§ç»­æäº¤</span></span><br><span class="line">                <span class="keyword">this</span>.nextHandler.submit(leaveRequest);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æµç¨‹ç»“æŸï¼ï¼ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å„çº§é¢†å¯¼å¤„ç†è¯·å‡æ¡æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>GroupLeader</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.responsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> GroupLeader</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å°ç»„é•¿ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 16:33</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GroupLeader</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1-3å¤©çš„å‡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GroupLeader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(Handler.NUM_ONE, Handler.NUM_THREE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span> </span>&#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©ï¼Œ&quot;</span> + leave.getContent() + <span class="string">&quot;!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å°ç»„é•¿å®¡æ‰¹é€šè¿‡ï¼šåŒæ„ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Manager</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.responsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Manager</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> éƒ¨é—¨ç»ç†ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 16:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="comment">//3-7å¤©çš„å‡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(Handler.NUM_THREE, Handler.NUM_SEVEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span> </span>&#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©ï¼Œ&quot;</span> + leave.getContent() + <span class="string">&quot;!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;éƒ¨é—¨ç»ç†å®¡æ‰¹é€šè¿‡ï¼šåŒæ„ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>GeneralManager</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.responsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> GeneralManager</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ€»ç»ç†ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 16:38</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneralManager</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>&#123;</span><br><span class="line">    <span class="comment">//7å¤©ä»¥ä¸Šçš„å‡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GeneralManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(Handler.NUM_THREE, Handler.NUM_SEVEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span> </span>&#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©ï¼Œ&quot;</span> + leave.getContent() + <span class="string">&quot;!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ€»ç»ç†å®¡æ‰¹é€šè¿‡ï¼šåŒæ„ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.responsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è´£ä»»é“¾æ¨¡å¼ æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/3/31 16:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è¯·å‡æ¡</span></span><br><span class="line">        LeaveRequest leave = <span class="keyword">new</span> LeaveRequest(<span class="string">&quot;å°åº„&quot;</span>, <span class="number">3</span>, <span class="string">&quot;å‡ºå»æ—…æ¸¸&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å„ä½é¢†å¯¼</span></span><br><span class="line">        Manager manager = <span class="keyword">new</span> Manager();</span><br><span class="line">        GroupLeader groupLeader = <span class="keyword">new</span> GroupLeader();</span><br><span class="line">        GeneralManager generalManager = <span class="keyword">new</span> GeneralManager();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        å°ç»„é•¿ä¸Šå¸æ˜¯ç»ç† ç»ç†ä¸Šå¸æ˜¯æ€»ç»ç†</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        groupLeader.setNextHandler(manager);</span><br><span class="line">        manager.setNextHandler(generalManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤</span></span><br><span class="line">        groupLeader.submit(leave);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FSnipaste_2021-03-31_16-50-58.png"></p>
<h2 id="27-3-è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#27-3-è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="27.3 è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>27.3 è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><ol>
<li>å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œä½†å…·ä½“ç”±å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚åœ¨è¿è¡Œæ—¶è‡ªåŠ¨ç¡®å®šã€‚</li>
<li>å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚ï¼Œæˆ–æ·»åŠ æ–°çš„å¤„ç†è€…ã€‚</li>
<li>éœ€è¦åœ¨ä¸æ˜ç¡®æŒ‡å®šè¯·æ±‚å¤„ç†è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¤„ç†è€…ä¸­çš„ä¸€ä¸ªæäº¤è¯·æ±‚ã€‚</li>
</ol>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>HashMapé›†åˆ</title>
    <url>/2021/04/09/HashMap%E9%9B%86%E5%90%88%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="HashMapé›†åˆ-å…¥é—¨"><a href="#HashMapé›†åˆ-å…¥é—¨" class="headerlink" title="HashMapé›†åˆ(å…¥é—¨)"></a>HashMapé›†åˆ(å…¥é—¨)</h1><p><strong>å­¦ä¹ åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1nJ411J7AA">https://www.bilibili.com/video/BV1nJ411J7AA</a></strong><br><strong>ä¸ªäººåšå®¢åœ°å€ï¼š<a href="https://itkxz.cn/">https://itkxz.cn</a></strong></p>
<h2 id="1-ä»€ä¹ˆæ˜¯HashMap"><a href="#1-ä»€ä¹ˆæ˜¯HashMap" class="headerlink" title="1.ä»€ä¹ˆæ˜¯HashMap"></a>1.ä»€ä¹ˆæ˜¯HashMap</h2><ul>
<li><p>HashMap ä¸ HashSet ä¸€æ ·ï¼Œä¸ä¿è¯å­˜å‚¨çš„é¡ºåºï¼Œå› ä¸ºåº•å±‚æ˜¯ä»¥ hash è¡¨çš„æ–¹å¼å­˜å‚¨çš„ï¼›</p>
</li>
<li><p>HashMap åº•å±‚å­˜å‚¨ç»“æ„ä¸º æ•°ç»„ + é“¾è¡¨+çº¢é»‘æ ‘ ï¼ˆJava 8ï¼‰ï¼›</p>
</li>
<li><p>HashMap å­˜å‚¨çš„ key-value æ•°æ®ç±»å‹ä¸º HashMap$Node ç±»å‹ï¼Œè¯¥ç±»å‹å®ç°äº† Map$Entry æ¥å£ï¼›</p>
</li>
<li><p>HashMap æ²¡æœ‰å®ç°åŒæ­¥ï¼Œå› æ­¤æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼›</p>
</li>
</ul>
<h2 id="2-HashMapä¸­å¸¸ç”¨çš„å˜é‡-å¸¸é‡"><a href="#2-HashMapä¸­å¸¸ç”¨çš„å˜é‡-å¸¸é‡" class="headerlink" title="2. HashMapä¸­å¸¸ç”¨çš„å˜é‡/å¸¸é‡"></a>2. HashMapä¸­å¸¸ç”¨çš„å˜é‡/å¸¸é‡</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">4</span>; <span class="comment">// é»˜è®¤çš„ table æ•°ç»„å®¹é‡ aka 16</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75f</span>;  <span class="comment">// é»˜è®¤åŠ è½½å› å­ä¸º 0.75</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAXIMUM_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">30</span>; <span class="comment">// é›†åˆæœ€å¤§å®¹é‡çš„ä¸Šé™æ˜¯ï¼š2çš„30æ¬¡å¹‚</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TREEIFY_THRESHOLD = <span class="number">8</span>; <span class="comment">// é“¾è¡¨æ ‘åŒ–ä¸´ç•Œå€¼</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> UNTREEIFY_THRESHOLD = <span class="number">6</span>; <span class="comment">// æ ‘è½¬æˆé“¾è¡¨çš„ä¸´ç•Œå€¼</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MIN_TREEIFY_CAPACITY = <span class="number">64</span>; <span class="comment">// æ ‘åŒ–æ—¶æ•°ç»„çš„æœ€å°é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;  <span class="comment">// å­˜æ”¾å…ƒç´ çš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;  <span class="comment">// å­˜æ”¾å…ƒç´ çš„ç¼“å­˜</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> size;  <span class="comment">// HashMap ä¸­å®é™…å…ƒç´ ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> modCount;  <span class="comment">// HashMap ä¿®æ”¹æ¬¡æ•°ï¼Œæ¯ä¸ªæ‰©å®¹å’Œæ›´æ”¹mapç»“æ„çš„è®¡æ•°å™¨</span></span><br><span class="line"><span class="keyword">int</span> threshold;  <span class="comment">// table æ‰©å®¹ä¸´ç•Œå€¼ æ•°ç»„é•¿åº¦ * åŠ è½½å› å­</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span> loadFactor;  <span class="comment">// table åŠ è½½å› å­</span></span><br></pre></td></tr></table></figure>



<h2 id="3-åˆå§‹åŒ–åŠæ‰©å®¹æœºåˆ¶"><a href="#3-åˆå§‹åŒ–åŠæ‰©å®¹æœºåˆ¶" class="headerlink" title="3.åˆå§‹åŒ–åŠæ‰©å®¹æœºåˆ¶"></a>3.åˆå§‹åŒ–åŠæ‰©å®¹æœºåˆ¶</h2><ul>
<li>HashMap æ˜¯ç”¨ä¸€ä¸ª Node ç±»å‹çš„æ•°ç»„ table æ¥å­˜å‚¨å…ƒç´ çš„ï¼Œæ¯ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ä¸º Nodeï¼›</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»º HashMap å¯¹è±¡æ—¶ï¼Œæ•°ç»„ table é»˜è®¤ä¸º nullï¼ŒåŠ è½½å› å­ loadfactor é»˜è®¤ä¸º 0.75ï¼›</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ æ—¶ï¼Œåˆ¤æ–­ table ä¸ºç©ºæ•°ç»„ï¼Œé»˜è®¤å°† table æ‰©å®¹åˆ° 16ï¼Œé˜ˆå€¼ threshold ä¸ºæ•°ç»„é•¿åº¦ä¸åŠ è½½å› å­çš„ç§¯ 12ï¼ˆresize() æ–¹æ³•ï¼‰ï¼›</p>
</li>
<li><p>å½“æ·»åŠ å…ƒç´  key-value æ—¶ï¼Œé€šè¿‡ key çš„ hash å€¼è®¡ç®—è¯¥å…ƒç´ åœ¨ table ä¸­çš„ç´¢å¼•ä½ç½®ï¼Œåˆ¤æ–­è¯¥ç´¢å¼•ä½ç½®æ˜¯å¦å­˜åœ¨ Node ç»“ç‚¹ï¼Œæ²¡æœ‰åˆ™ç›´æ¥æ·»åŠ ï¼›</p>
</li>
<li><p>å¦‚æœç´¢å¼•ä½ç½®æœ‰ç»“ç‚¹ï¼Œåˆ™åˆ¤æ–­è¦æ·»åŠ çš„å…ƒç´ çš„ key ä¸è¯¥èŠ‚ç‚¹çš„ key æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒï¼Œåˆ™å°† value æ›¿æ¢åˆ°å½“å‰ç»“ç‚¹ï¼Œå¦‚æœä¸ç›¸åŒï¼Œåˆ™åˆ¤æ–­å½“å‰ç»“ç‚¹æ˜¯å¦æ˜¯æ ‘ç»“æ„ï¼Œæ˜¯æ ‘ç»“æ„åˆ™æ‰§è¡Œæ·»åŠ æ ‘ç»“ç‚¹æ“ä½œï¼›</p>
</li>
<li><p>å¦‚æœä¸æ˜¯ï¼Œåˆ¤æ–­ä¸ºé“¾è¡¨ç»“æ„ï¼Œä¸”è¦æ·»åŠ çš„å…ƒç´ å’Œé“¾è¡¨ç¬¬ä¸€ä¸ªç»“ç‚¹ä¸åŒï¼Œéå†é“¾è¡¨åˆ¤æ–­ key æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™å‘é“¾è¡¨æ’å…¥å…ƒç´ ï¼Œå¹¶åˆ¤æ–­å½“å‰é“¾è¡¨æ˜¯å¦æ»¡è¶³æ ‘åŒ–æ¡ä»¶ï¼ˆé“¾è¡¨é•¿åº¦å¤§äºç­‰äº8ï¼‰ï¼Œå¦‚æœå­˜åœ¨æ‰§è¡Œæ›¿æ¢æ“ä½œï¼›</p>
</li>
<li><p>å½“ table é•¿åº¦è¾¾åˆ°é˜ˆå€¼ threshold æ—¶ï¼Œåˆ™æ‰§è¡Œ resize() æ–¹æ³•ç»™ table è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹å¤§å°ä¸ºåŸæ¥çš„ 2 å€ï¼ŒåŒæ—¶é˜ˆå€¼æ›´æ–°ä¸ºå½“å‰æ•°ç»„é•¿åº¦ä¹˜ä»¥åŠ è½½å› å­ï¼›</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// putVal() æ·»åŠ å…ƒç´ æˆåŠŸ,tableé•¿åº¦åŠ 1, åˆ¤æ–­æ˜¯å¦æ‰©å®¹</span></span><br><span class="line"><span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">    resize();</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å½“ table æŸä¸ªèŠ‚ç‚¹çš„é“¾è¡¨é•¿åº¦è¶…è¿‡ TREEIFY_THRESHOLDï¼ˆé»˜è®¤ 8ï¼‰åï¼Œåˆ¤æ–­ table çš„å®¹é‡æ˜¯å¦è¾¾åˆ° MIN_TREEIFY_CAPACITYï¼ˆé»˜è®¤ 64ï¼‰ï¼Œè¾¾åˆ°åˆ™å¯¹å½“å‰ç»“ç‚¹çš„é“¾è¡¨è¿›è¡Œæ ‘åŒ–ï¼›å¦åˆ™å¯¹ table æ‰©å®¹ï¼›</p>
</li>
<li><p>å½“æ ‘çš„å…ƒç´ å‡å°‘åˆ° UNTREEIFY_THRESHOLD = 6 æ—¶ï¼Œä¼šè¿›è¡Œå‰ªææ“ä½œï¼ˆè½¬å›é“¾è¡¨ï¼‰</p>
</li>
</ul>
<h2 id="3-é˜¿é‡Œå·´å·´ç¼–ç è§„çº¦-åˆå§‹åŒ–æŒ‡å®šå®¹é‡"><a href="#3-é˜¿é‡Œå·´å·´ç¼–ç è§„çº¦-åˆå§‹åŒ–æŒ‡å®šå®¹é‡" class="headerlink" title="3. é˜¿é‡Œå·´å·´ç¼–ç è§„çº¦-åˆå§‹åŒ–æŒ‡å®šå®¹é‡"></a>3. é˜¿é‡Œå·´å·´ç¼–ç è§„çº¦-åˆå§‹åŒ–æŒ‡å®šå®¹é‡</h2><p>ã€æ¨èã€‘é›†åˆåˆå§‹åŒ–æ—¶ï¼ŒæŒ‡å®šé›†åˆåˆå§‹å€¼å¤§å°ã€‚</p>
<p>è¯´æ˜ï¼šHashMap ä½¿ç”¨ HashMap(int initialCapacity) åˆå§‹åŒ–ã€‚</p>
<p>æ­£ä¾‹ï¼šinitialCapacity = (éœ€è¦å­˜å‚¨çš„å…ƒç´ ä¸ªæ•° / è´Ÿè½½å› å­) + 1ã€‚</p>
<p>æ³¨æ„è´Ÿè½½å› å­ï¼ˆå³ loader factorï¼‰é»˜è®¤ ä¸º 0.75ï¼Œå¦‚æœæš‚æ—¶æ— æ³•ç¡®å®šåˆå§‹å€¼å¤§å°ï¼Œè¯·è®¾ç½®ä¸º 16ï¼ˆå³é»˜è®¤å€¼ï¼‰ã€‚</p>
<p>åä¾‹ï¼šHashMap éœ€è¦æ”¾ç½® 1024 ä¸ªå…ƒç´ ï¼Œç”±äºæ²¡æœ‰è®¾ç½®å®¹é‡åˆå§‹å¤§å°ï¼Œéšç€å…ƒç´ ä¸æ–­å¢åŠ ï¼Œå®¹é‡ 7 æ¬¡è¢« è¿«æ‰©å¤§ï¼Œresize éœ€è¦é‡å»º hash è¡¨ï¼Œä¸¥é‡å½±å“æ€§èƒ½</p>
<h2 id="4-ä¸»è¦æºç åŠå¸¸ç”¨æ–¹æ³•åˆ†æ"><a href="#4-ä¸»è¦æºç åŠå¸¸ç”¨æ–¹æ³•åˆ†æ" class="headerlink" title="4. ä¸»è¦æºç åŠå¸¸ç”¨æ–¹æ³•åˆ†æ"></a>4. ä¸»è¦æºç åŠå¸¸ç”¨æ–¹æ³•åˆ†æ</h2><h3 id="4-1-HashMapæ„é€ å™¨"><a href="#4-1-HashMapæ„é€ å™¨" class="headerlink" title="4.1 HashMapæ„é€ å™¨"></a>4.1 HashMapæ„é€ å™¨</h3><p> 1.æ— å‚æ„é€ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>æŒ‡å®šåˆå§‹å®¹é‡å’ŒåŠ è½½å› å­çš„æ„é€ å™¨</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>) <span class="comment">// å¼‚å¸¸:åˆå§‹å®¹é‡å°äº0 </span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal initial capacity: &quot;</span> + initialCapacity);</span><br><span class="line">    <span class="comment">// æŒ‡å®šå®¹é‡å¤§äºæ•°ç»„æœ€å¤§å®¹é‡,åˆå§‹åŒ–ä¸ºæœ€å¤§å®¹é‡</span></span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor)) <span class="comment">// å¼‚å¸¸:åŠ è½½å› å­å°äº0 or NaN Not a Number</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal load factor: &quot;</span> + loadFactor);</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = loadFactor;  <span class="comment">// æŒ‡å®šåŠ è½½å› å­å¤§å°</span></span><br><span class="line">    <span class="comment">// è®¡ç®— table çš„å¤§å°,ç¡®ä¿ä¸º2çš„næ¬¡å¹‚,</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œèµ‹å€¼ç»™ä¸´ç•Œå€¼,åœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ä¼šåˆå§‹åŒ–ä¸ºtableå¤§å°</span></span><br><span class="line">    <span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-putVal-æ·»åŠ å…ƒç´ çš„æ–¹æ³•"><a href="#4-2-putVal-æ·»åŠ å…ƒç´ çš„æ–¹æ³•" class="headerlink" title="4.2 putVal()-æ·»åŠ å…ƒç´ çš„æ–¹æ³•"></a>4.2 putVal()-æ·»åŠ å…ƒç´ çš„æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements Map.put and related methods.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> evict if false, the table is in creation mode.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> previous value, or null if none</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent, <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;  <span class="comment">// å®šä¹‰è¾…åŠ©å˜é‡</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 0. è¿™é‡Œæ˜¯åˆ¤æ–­tableæ˜¯å¦åˆå§‹åŒ–ï¼Œtable = null or table.length = 0 åˆå§‹åŒ–table</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>) <span class="comment">// table:å­˜æ”¾å…ƒç´ çš„Node[]æ•°ç»„</span></span><br><span class="line">        n = (tab = resize()).length;  <span class="comment">// resize():æ‰©å®¹-æ•°ç»„ä¸ºç©ºç»™tableåˆå§‹åŒ–16ä¸ªç©ºé—´</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ ¹æ®keyçš„hashå€¼è®¡ç®—ç´¢å¼•å€¼,å°†tableä¸­è¯¥ç´¢å¼•ä½ç½®çš„ç»“ç‚¹èµ‹å€¼ç»™p,å¹¶åˆ¤æ–­pæ˜¯å¦ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">//è‹¥pä¸ºnull(å½“å‰ä½ç½®æ²¡æœ‰å…ƒç´ )åˆ™åˆ›å»ºæ–°çš„ç»“ç‚¹Nodeä¿å­˜å½“å‰è¦æ·»åŠ çš„æ•°æ®,å­˜å‚¨åˆ°å½“å‰ç´¢å¼•ä½ç½®</span></span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œè¯´æ˜tableå½“å‰ç´¢å¼•ä½ç½®çš„ç»“ç‚¹å·²ç»å­˜åœ¨æ•°æ®ï¼Œä¸‹é¢åˆ†æƒ…å†µåˆ¤æ–­æ·»åŠ å…ƒç´ </span></span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="comment">// 1. åˆ¤æ–­è¦æ·»åŠ çš„å…ƒç´ (key)ä¸tableä¸­å½“å‰ç´¢å¼•ä½ç½®çš„Nodeç»“ç‚¹æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">		<span class="comment">// condition: â‘  hash å€¼ç›¸ç­‰ &amp;&amp; (â‘¡ å¼•ç”¨ç›¸åŒ || â‘¢ equalsåˆ¤æ–­ç›¸ç­‰)</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p; <span class="comment">// å…ƒç´ é‡å¤</span></span><br><span class="line">        <span class="comment">// 2. åˆ¤æ–­å½“å‰ç´¢å¼•ä½ç½®å…ƒç´ ç»“ç‚¹æ˜¯å¦æ˜¯çº¢é»‘æ ‘ç±»å‹</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="comment">// 3. è¯´æ˜å½“å‰ç´¢å¼•ä½ç½®ç»“ç‚¹ä¸ºé“¾è¡¨,ä¸”ç¬¬ä¸€ä¸ªç»“ç‚¹ä¸è¦æ·»åŠ çš„å…ƒç´ keyä¸åŒ,å°±éå†é“¾è¡¨åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœkeyå’Œé“¾è¡¨ä¸­æ‰€æœ‰èŠ‚ç‚¹å…ƒç´ éƒ½ä¸ç›¸åŒï¼Œåˆ™æ·»åŠ åˆ°é“¾è¡¨æœ€å</span></span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="comment">// æ·»åŠ å…ƒç´ ååˆ¤æ–­å½“å‰é“¾è¡¨æ˜¯å¦å·²ç»æœ‰äº†8ä¸ªèŠ‚ç‚¹ï¼Œå¤Ÿ8ä¸ªåˆ™å°†å½“å‰é“¾è¡¨è½¬æˆçº¢é»‘æ ‘</span></span><br><span class="line">                    <span class="comment">// è¿™é‡Œè°ƒç”¨treeifyBin()æ–¹æ³•ä¼šåˆ¤æ–­tableå¤§å°æ˜¯å¦è¶³å¤Ÿ64ä¸ªï¼Œåˆ°è¾¾64ä¸ªæ‰ä¼šæ ‘åŒ–</span></span><br><span class="line">                    <span class="comment">// ä¸æ»¡ 64 ä¸ªç©ºé—´ï¼Œä¼šå…ˆç»™ table æ‰©å®¹</span></span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>; <span class="comment">// é€€å‡º for å¾ªç¯</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å¦‚æœè¦æ·»åŠ çš„å…ƒç´ keyåœ¨é“¾è¡¨ä¸­å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥é€€å‡ºå¾ªç¯</span></span><br><span class="line">				<span class="comment">// condition: â‘  hash å€¼ç›¸ç­‰ &amp;&amp; (â‘¡ å¼•ç”¨ç›¸åŒ || â‘¢ equalsåˆ¤æ–­ç›¸ç­‰)</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                p = e; <span class="comment">// å½“å‰èŠ‚ç‚¹åç§»</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¦æ·»åŠ çš„å…ƒç´  key å·²å­˜åœ¨ï¼Œåˆ™å°†é‡å¤çš„å…ƒç´ è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="comment">// å°†è¦æ·»åŠ çš„ value æ›¿æ¢æ‰æ—§å€¼</span></span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount; <span class="comment">// ä¿®æ”¹æ¬¡æ•°</span></span><br><span class="line">    <span class="comment">// æ·»åŠ å…ƒç´ æˆåŠŸ,tableé•¿åº¦åŠ 1, åˆ¤æ–­æ˜¯å¦æ‰©å®¹ æ•°ç»„é•¿åº¦æ˜¯å¦å¤§äºé˜ˆå€¼</span></span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict); <span class="comment">// HashMap æ²¡æœ‰å®ç°è¯¥æ–¹æ³•, ä¾›å­ç±»å®ç°æ‰©å……åŠŸèƒ½</span></span><br><span class="line">    <span class="comment">// return null è¡¨ç¤ºè¦æ·»åŠ çš„å…ƒç´ åœ¨tableä¸­ä¸å­˜åœ¨, æ·»åŠ æˆåŠŸ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-resize-é›†åˆæ‰©å®¹"><a href="#4-3-resize-é›†åˆæ‰©å®¹" class="headerlink" title="4.3 resize()-é›†åˆæ‰©å®¹"></a>4.3 resize()-é›†åˆæ‰©å®¹</h3><p>ç»™ table åˆå§‹åŒ–æˆ–è€…å°†æ•°ç»„å¤§å°ç¿»å€ï¼Œå¦‚æœ table ä¸ºnullï¼Œåˆ™æ ¹æ®é»˜è®¤å€¼æŒ‡å®šåˆå§‹å®¹é‡å’Œè¾¹ç•Œå€¼ï¼›å¦åˆ™ï¼Œå› ä¸ºæˆ‘ä»¬çš„ table æ•°ç»„å®¹é‡æ˜¯ 2 çš„ n æ¬¡å¹‚ï¼Œæ‰€ä»¥æ¯ä¸ª bin ä¸­çš„å…ƒç´ ä¸€å®šä¿æŒç›¸åŒçš„ç´¢å¼•ï¼Œæˆ–è€…åœ¨æ–° table ä¸­ç§»åŠ¨ 2 çš„ n æ¬¡å¹‚çš„åç§»é‡ï¼ˆå…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„ç´¢å¼•ä½ç½®ä¸º åŸæ¥çš„ç´¢å¼• æˆ–è€…æ˜¯ åŸæ¥çš„ç´¢å¼• + åŸå®¹é‡å¤§å°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Initializes or doubles table size.  If null, allocates in</span></span><br><span class="line"><span class="comment"> * accord with initial capacity target held in field threshold.</span></span><br><span class="line"><span class="comment"> * Otherwise, because we are using power-of-two expansion, the</span></span><br><span class="line"><span class="comment"> * elements from each bin must either stay at same index, or move</span></span><br><span class="line"><span class="comment"> * with a power of two offset in the new table.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the table</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table; <span class="comment">// ä¿å­˜ä¹‹å‰æ•°ç»„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length; <span class="comment">// ä¿å­˜æ—§å®¹é‡</span></span><br><span class="line">    <span class="keyword">int</span> oldThr = threshold; <span class="comment">// ä¿å­˜æ—§ä¸´ç•Œå€¼</span></span><br><span class="line">    <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123; <span class="comment">// å°†æ–°å®¹é‡å’Œæ–°è¾¹ç•Œå€¼æ‰©å¤§ä¸ºåŸæ¥2å€(&lt;&lt;1 == *2)</span></span><br><span class="line">        <span class="comment">// æ—§å®¹é‡å·²ç»åˆ°è¾¾æœ€å¤§å®¹é‡å°±æ‰©å¤§ä¸´ç•Œå€¼</span></span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123; </span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†å®¹é‡å’Œä¸´ç•Œå€¼æ‰©å¤§2å€</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp; </span><br><span class="line">                 		   oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å°†æ—§ä¸´ç•Œå€¼èµ‹å€¼ç»™æ–°å®¹é‡ï¼Œè¿™é‡Œçš„åœºæ™¯ä¸ºåˆå§‹åŒ–æ—¶ä½¿ç”¨äº†å¸¦å‚æ•°çš„æ„é€ å™¨-tableSizeFor()</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="comment">// æ•°ç»„åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿™é‡Œä¹Ÿæ˜¯åˆå§‹åŒ–æŒ‡å®šå®¹é‡å¤§å°çš„åœºæ™¯ï¼Œä¸´ç•Œå€¼èµ‹å€¼ç»™å®¹é‡ï¼Œè¿™é‡Œç»™ä¸´ç•Œå€¼é‡æ–°è®¡ç®—å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;  <span class="comment">// table è¾¹ç•Œå€¼æ›´æ–°ä¸ºæ–°çš„è¾¹ç•Œå€¼</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºæ–° table å®¹é‡ä¸ºé»˜è®¤åˆå§‹å®¹é‡æˆ–ä¹‹å‰å®¹é‡çš„2å€</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line">    <span class="comment">// åŸæ•°ç»„ä¸ä¸ºnullï¼Œè¯´æ˜æ˜¯æ‰©å®¹-éå†ä¹‹å‰çš„table èµ‹å€¼ç»™æ–°æ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123; <span class="comment">// å½“å‰ç´¢å¼•å­˜åœ¨å…ƒç´  e</span></span><br><span class="line">                oldTab[j] = <span class="keyword">null</span>; <span class="comment">// æ–¹ä¾¿å›æ”¶ç©ºé—´</span></span><br><span class="line">                <span class="comment">// 1. å½“å‰ç´¢å¼•ä½ç½®åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰ä¸‹ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="keyword">null</span>) </span><br><span class="line">                    <span class="comment">// é‡æ–°è®¡ç®—å½“å‰å…ƒç´ åœ¨æ–°tableä¸­çš„ç´¢å¼•ï¼Œå°†å½“å‰ç´¢å¼•ç»“ç‚¹æ”¾åˆ°æ–°table</span></span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e; </span><br><span class="line">                <span class="comment">// 2. å½“å‰ç´¢å¼•ä½ç½®æœ‰ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œä¸”æ˜¯çº¢é»‘æ ‘,æŒ‡å®šæ ‘çš„æ“ä½œ</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode) </span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="comment">// 3. å½“å‰ç´¢å¼•ä½ç½®æœ‰ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œè¿™é‡Œæ˜¯é“¾è¡¨ç±»å‹</span></span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="comment">// ä¾æ¬¡éå†é“¾è¡¨ç»“ç‚¹ï¼Œç¡®å®šæ–°æ•°ç»„ç´¢å¼•ä½ç½®</span></span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next; <span class="comment">// å–å‡ºä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">                        <span class="comment">// åˆ¤æ–­å½“å‰å…ƒç´ åœ¨æ–°æ•°ç»„çš„ç´¢å¼•æ˜¯å¦æ”¹å˜</span></span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123; <span class="comment">// ä¸æ”¹å˜è¿˜æ˜¯åŸæ¥çš„ç´¢å¼•ä½ç½®</span></span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;  <span class="comment">// æ”¹å˜ï¼Œæ–°ç´¢å¼• = æ—§ç´¢å¼• + æ—§å®¹é‡</span></span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123; <span class="comment">// å­˜æ”¾åˆ°ä¹‹å‰ç´¢å¼•ä½ç½®</span></span><br><span class="line">                        loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123; <span class="comment">// å­˜æ”¾åˆ°(ä¹‹å‰ç´¢å¼•+æ—§å®¹é‡)çš„ä½ç½®</span></span><br><span class="line">                        hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-treeifyBin-æ ‘åŒ–"><a href="#4-4-treeifyBin-æ ‘åŒ–" class="headerlink" title="4.4 treeifyBin() - æ ‘åŒ–"></a>4.4 treeifyBin() - æ ‘åŒ–</h3><p>æ ‘åŒ–-å°†æ•°ç»„ä¸­çš„é“¾è¡¨è½¬æˆçº¢é»‘æ ‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Replaces all linked nodes in bin at index for given hash unless</span></span><br><span class="line"><span class="comment"> * table is too small, in which case resizes instead.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">treeifyBin</span><span class="params">(Node&lt;K,V&gt;[] tab, <span class="keyword">int</span> hash)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, index; Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="comment">// æ ‘åŒ–åˆ¤æ–­ï¼Œtable æ•°ç»„çš„é•¿åº¦æ˜¯å¦å¤§äºç­‰äº 64ï¼Œæœªè¾¾åˆ°åˆ™è¿›è¡Œæ•°ç»„æ‰©å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (tab == <span class="keyword">null</span> || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)</span><br><span class="line">        resize();</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å½“å‰ç´¢å¼•ä½ç½®ç»“ç‚¹ä¸ä¸ºnull</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ((e = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        TreeNode&lt;K,V&gt; hd = <span class="keyword">null</span>, tl = <span class="keyword">null</span>; <span class="comment">// å¤´å°¾èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">             <span class="comment">// å°†é“¾è¡¨ç»“ç‚¹è½¬æ¢ä¸ºæ ‘ç»“ç‚¹ç±»å‹ TreeNode</span></span><br><span class="line">            TreeNode&lt;K,V&gt; p = replacementTreeNode(e, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">if</span> (tl == <span class="keyword">null</span>)</span><br><span class="line">                hd = p; <span class="comment">// ç»™å¤´èŠ‚ç‚¹èµ‹å€¼ä¸ºå½“å‰ç´¢å¼•ç»“ç‚¹</span></span><br><span class="line">            <span class="keyword">else</span> &#123;  <span class="comment">// å°†æ ‘ç»“ç‚¹è¿æ¥èµ·æ¥</span></span><br><span class="line">                p.prev = tl;</span><br><span class="line">                tl.next = p;</span><br><span class="line">            &#125;</span><br><span class="line">            tl = p;  <span class="comment">// ç»™å°¾ç»“ç‚¹èµ‹å€¼</span></span><br><span class="line">        &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>); <span class="comment">// é“¾è¡¨ç»“ç‚¹åç§»</span></span><br><span class="line">        <span class="comment">// å°†æ ‘çš„å¤´èŠ‚ç‚¹æ”¾åœ¨æ•°ç»„çš„å½“å‰ç´¢å¼•ä½ç½®ï¼Œç„¶åè½¬æ¢æˆçº¢é»‘æ ‘</span></span><br><span class="line">        <span class="keyword">if</span> ((tab[index] = hd) != <span class="keyword">null</span>)</span><br><span class="line">            hd.treeify(tab);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// For treeifyBin</span></span><br><span class="line"><span class="function">TreeNode&lt;K,V&gt; <span class="title">replacementTreeNode</span><span class="params">(Node&lt;K,V&gt; p, Node&lt;K,V&gt; next)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TreeNode&lt;&gt;(p.hash, p.key, p.value, next);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-5-remove-åˆ é™¤é›†åˆä¸­çš„å…ƒç´ "><a href="#4-5-remove-åˆ é™¤é›†åˆä¸­çš„å…ƒç´ " class="headerlink" title="4.5 remove()-åˆ é™¤é›†åˆä¸­çš„å…ƒç´ "></a>4.5 remove()-åˆ é™¤é›†åˆä¸­çš„å…ƒç´ </h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">remove</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = removeNode(hash(key), key, <span class="keyword">null</span>, <span class="keyword">false</span>, <span class="keyword">true</span>)) == <span class="keyword">null</span> ?</span><br><span class="line">        <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">removeNode</span><span class="params">(<span class="keyword">int</span> hash, Object key, Object value,</span></span></span><br><span class="line"><span class="function"><span class="params">                           <span class="keyword">boolean</span> matchValue, <span class="keyword">boolean</span> movable)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, index; <span class="comment">// è¾…åŠ©å˜é‡</span></span><br><span class="line">    <span class="comment">// table ä¸ä¸ºç©ºï¼Œä¸”æŒ‡å®škeyçš„hashè®¡ç®—çš„ç´¢å¼•ä½ç½®æœ‰å…ƒç´ </span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (p = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        Node&lt;K,V&gt; node = <span class="keyword">null</span>, e; K k; V v; <span class="comment">// è¾…åŠ©å˜é‡</span></span><br><span class="line">        <span class="comment">// 1 åˆ¤æ–­è¦åˆ é™¤çš„å…ƒç´ æ˜¯å¦æ˜¯æŒ‡å®šç´¢å¼•é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp; </span><br><span class="line">            ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            node = p;</span><br><span class="line">        <span class="comment">// 2 ä¸æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆ¤æ–­é“¾è¡¨æ˜¯å¦è¿˜æœ‰å…¶ä»–å…ƒç´ </span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((e = p.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 2.1 æœ‰å…¶ä»–å…ƒç´ ä¸”ä¸ºæ ‘ç»“ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">else</span> &#123; <span class="comment">// 2.2 æœ‰å…¶ä»–å…ƒç´ ï¼Œä¸ºé“¾è¡¨ç»“æ„</span></span><br><span class="line">                <span class="keyword">do</span> &#123; <span class="comment">// éå†é“¾è¡¨ï¼Œä¾æ¬¡åˆ¤æ–­è¦åˆ é™¤çš„å…ƒç´ çš„ä½ç½®</span></span><br><span class="line">                    <span class="comment">// æ ¹æ®hashã€keyçš„å€¼æ‰¾åˆ°è¦åˆ é™¤çš„å…ƒç´ </span></span><br><span class="line">                    <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                        ((k = e.key) == key ||</span><br><span class="line">                         (key != <span class="keyword">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">                        node = e;</span><br><span class="line">                        <span class="keyword">break</span>; <span class="comment">// æ‰¾åˆ°ï¼Œé€€å‡º</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    p = e; <span class="comment">// p æ˜¯è¦åˆ é™¤èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">                &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°å…ƒç´ ï¼Œæ‰§è¡Œåˆ é™¤æ“ä½œ</span></span><br><span class="line">        <span class="keyword">if</span> (node != <span class="keyword">null</span> &amp;&amp; (!matchValue || (v = node.value) == value ||</span><br><span class="line">                             (value != <span class="keyword">null</span> &amp;&amp; value.equals(v)))) &#123;</span><br><span class="line">            <span class="keyword">if</span> (node <span class="keyword">instanceof</span> TreeNode) <span class="comment">// æ ‘ç»“ç‚¹åˆ é™¤</span></span><br><span class="line">                ((TreeNode&lt;K,V&gt;)node).removeTreeNode(<span class="keyword">this</span>, tab, movable);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (node == p) <span class="comment">// é“¾è¡¨åªæœ‰ä¸€ä¸ªå…ƒç´ åˆ é™¤</span></span><br><span class="line">                tab[index] = node.next;</span><br><span class="line">            <span class="keyword">else</span> <span class="comment">// é“¾è¡¨ä¸­æœ‰å¤šä¸ªå…ƒç´ åˆ é™¤</span></span><br><span class="line">                p.next = node.next;</span><br><span class="line">            ++modCount; <span class="comment">// è®¡æ•°å™¨+1</span></span><br><span class="line">            --size;   <span class="comment">// é•¿åº¦ -1</span></span><br><span class="line">            afterNodeRemoval(node);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-7-get-æ ¹æ®keyè·å–"><a href="#4-7-get-æ ¹æ®keyè·å–" class="headerlink" title="4.7 get()-æ ¹æ®keyè·å–"></a>4.7 get()-æ ¹æ®keyè·å–</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="keyword">int</span> n; K k;</span><br><span class="line">    <span class="comment">// æ•°ç»„ä¸ä¸ºç©ºï¼Œä¸”æ ¹æ®hashè®¡ç®—çš„ç´¢å¼•ä½ç½®æœ‰ç»“ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢çš„keyä¸è¯¥ç´¢å¼•ä½ç½®çš„å…ƒç´ ç›¸åŒ</span></span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="comment">// ä¸æ˜¯æ•°ç»„å½“å‰ç´¢å¼•ä½ç½®çš„å…ƒç´ ï¼Œä¸”æœ‰ä¸‹ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode) <span class="comment">// æ ‘ç»“ç‚¹</span></span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">do</span> &#123; <span class="comment">// éå†é“¾è¡¨ æ‰¾åˆ°å¯¹åº”çš„key</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/%E5%93%88%E5%B8%8C%E8%A1%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B2.png"></p>
<h1 id="HashMapé›†åˆ-é«˜çº§"><a href="#HashMapé›†åˆ-é«˜çº§" class="headerlink" title="HashMapé›†åˆ(é«˜çº§)"></a>HashMapé›†åˆ(é«˜çº§)</h1><h2 id="1-HashMapé›†åˆç®€ä»‹"><a href="#1-HashMapé›†åˆç®€ä»‹" class="headerlink" title="1.HashMapé›†åˆç®€ä»‹"></a>1.HashMapé›†åˆç®€ä»‹</h2><p>â€‹    HashMapåŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£å®ç°ï¼Œæ˜¯ä»¥key-valueå­˜å‚¨å½¢å¼å­˜åœ¨ï¼Œå³ä¸»è¦ç”¨æ¥å­˜æ”¾é”®å€¼å¯¹ã€‚HashMap çš„å®ç°ä¸æ˜¯åŒæ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒçš„keyã€valueéƒ½å¯ä»¥ä¸ºnullã€‚æ­¤å¤–ï¼ŒHashMapä¸­çš„æ˜ å°„ä¸æ˜¯æœ‰åºçš„ã€‚</p>
<p>â€‹    JDK1.8 ä¹‹å‰ HashMap ç”± æ•°ç»„+é“¾è¡¨ ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çª**(ä¸¤ä¸ªå¯¹è±¡è°ƒç”¨çš„hashCodeæ–¹æ³•è®¡ç®—çš„å“ˆå¸Œç å€¼ä¸€è‡´å¯¼è‡´è®¡ç®—çš„æ•°ç»„ç´¢å¼•å€¼ç›¸åŒ)<strong>è€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰.JDK1.8 ä»¥ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œ</strong>å½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆæˆ–è€…çº¢é»‘æ ‘çš„è¾¹ç•Œå€¼ï¼Œé»˜è®¤ä¸º 8ï¼‰å¹¶ä¸”å½“å‰æ•°ç»„çš„é•¿åº¦å¤§äº64æ—¶ï¼Œæ­¤æ—¶æ­¤ç´¢å¼•ä½ç½®ä¸Šçš„æ‰€æœ‰æ•°æ®æ”¹ä¸ºä½¿ç”¨çº¢é»‘æ ‘å­˜å‚¨ã€‚**</p>
<p>è¡¥å……ï¼šå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå³ä½¿é˜ˆå€¼å¤§äº8ï¼Œä½†æ˜¯æ•°ç»„é•¿åº¦å°äº64ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šå°†é“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘ã€‚è€Œæ˜¯é€‰æ‹©è¿›è¡Œæ•°ç»„æ‰©å®¹ã€‚</p>
<p>è¿™æ ·åšçš„ç›®çš„æ˜¯å› ä¸ºæ•°ç»„æ¯”è¾ƒå°ï¼Œå°½é‡é¿å¼€çº¢é»‘æ ‘ç»“æ„ï¼Œè¿™ç§æƒ…å†µä¸‹å˜ä¸ºçº¢é»‘æ ‘ç»“æ„ï¼Œåè€Œä¼šé™ä½æ•ˆç‡ï¼Œå› ä¸ºçº¢é»‘æ ‘éœ€è¦è¿›è¡Œå·¦æ—‹ï¼Œå³æ—‹ï¼Œå˜è‰²è¿™äº›æ“ä½œæ¥ä¿æŒå¹³è¡¡ ã€‚åŒæ—¶æ•°ç»„é•¿åº¦å°äº64æ—¶ï¼Œæœç´¢æ—¶é—´ç›¸å¯¹è¦å¿«äº›ã€‚æ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ä¸ºäº†æé«˜æ€§èƒ½å’Œå‡å°‘æœç´¢æ—¶é—´ï¼Œåº•å±‚åœ¨é˜ˆå€¼å¤§äº8å¹¶ä¸”æ•°ç»„é•¿åº¦å¤§äº64æ—¶ï¼Œé“¾è¡¨æ‰è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚å…·ä½“å¯ä»¥å‚è€ƒ <code>treeifyBin</code>æ–¹æ³•ã€‚</p>
<p>å½“ç„¶è™½ç„¶å¢äº†çº¢é»‘æ ‘ä½œä¸ºåº•å±‚æ•°æ®ç»“æ„ï¼Œç»“æ„å˜å¾—å¤æ‚äº†ï¼Œä½†æ˜¯é˜ˆå€¼å¤§äº8å¹¶ä¸”æ•°ç»„é•¿åº¦å¤§äº64æ—¶ï¼Œé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘æ—¶ï¼Œæ•ˆç‡ä¹Ÿå˜çš„æ›´é«˜æ•ˆã€‚ </p>
<p>å°ç»“ï¼š</p>
<p>ç‰¹ç‚¹ï¼š</p>
<p>1.å­˜å–æ— åºçš„</p>
<p>2.é”®å’Œå€¼ä½ç½®éƒ½å¯ä»¥æ˜¯nullï¼Œä½†æ˜¯é”®ä½ç½®åªèƒ½æ˜¯ä¸€ä¸ªnull</p>
<p>3.é”®ä½ç½®æ˜¯å”¯ä¸€çš„ï¼Œåº•å±‚çš„æ•°æ®ç»“æ„æ§åˆ¶é”®çš„</p>
<p>4.jdk1.8å‰æ•°æ®ç»“æ„æ˜¯ï¼šé“¾è¡¨ + æ•°ç»„  jdk1.8ä¹‹åæ˜¯ ï¼š é“¾è¡¨ + æ•°ç»„  + çº¢é»‘æ ‘</p>
<p>5.é˜ˆå€¼(è¾¹ç•Œå€¼) &gt; 8 å¹¶ä¸”æ•°ç»„é•¿åº¦å¤§äº64ï¼Œæ‰å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œå˜ä¸ºçº¢é»‘æ ‘çš„ç›®çš„æ˜¯ä¸ºäº†é«˜æ•ˆçš„æŸ¥è¯¢ã€‚</p>
<h2 id="2-HashMapé›†åˆåº•å±‚çš„æ•°æ®ç»“æ„"><a href="#2-HashMapé›†åˆåº•å±‚çš„æ•°æ®ç»“æ„" class="headerlink" title="2.HashMapé›†åˆåº•å±‚çš„æ•°æ®ç»“æ„"></a>2.HashMapé›†åˆåº•å±‚çš„æ•°æ®ç»“æ„</h2><h3 id="2-1æ•°æ®ç»“æ„æ¦‚å¿µ"><a href="#2-1æ•°æ®ç»“æ„æ¦‚å¿µ" class="headerlink" title="2.1æ•°æ®ç»“æ„æ¦‚å¿µ"></a>2.1æ•°æ®ç»“æ„æ¦‚å¿µ</h3><pre><code> [æ•°æ®](https://baike.baidu.com/item/æ•°æ®/5947370)ç»“æ„æ˜¯[è®¡ç®—æœº](https://baike.baidu.com/item/è®¡ç®—æœº/140338)å­˜å‚¨ã€ç»„ç»‡[æ•°æ®](https://baike.baidu.com/item/æ•°æ®)çš„æ–¹å¼ã€‚æ•°æ®ç»“æ„æ˜¯æŒ‡ç›¸äº’ä¹‹é—´å­˜åœ¨ä¸€ç§æˆ–å¤šç§ç‰¹å®šå…³ç³»çš„[æ•°æ®å…ƒç´ ](https://baike.baidu.com/item/æ•°æ®å…ƒç´ /715313)çš„é›†åˆã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç²¾å¿ƒé€‰æ‹©çš„æ•°æ®ç»“æ„å¯ä»¥å¸¦æ¥æ›´é«˜çš„è¿è¡Œæˆ–è€…å­˜å‚¨[æ•ˆç‡](https://baike.baidu.com/item/æ•ˆç‡/868847)ã€‚æ•°æ®ç»“æ„å¾€å¾€åŒé«˜æ•ˆçš„æ£€ç´¢[ç®—æ³•](https://baike.baidu.com/item/ç®—æ³•/209025)å’Œ[ç´¢å¼•](https://baike.baidu.com/item/ç´¢å¼•/5716853)æŠ€æœ¯æœ‰å…³ã€‚ 
</code></pre>
<p>æ•°æ®ç»“æ„ï¼šå°±æ˜¯å­˜å‚¨æ•°æ®çš„ä¸€ç§æ–¹å¼ã€‚ArrayList LinkedList</p>
<p>åœ¨JDK1.8 ä¹‹å‰ HashMap ç”± <strong>æ•°ç»„+é“¾è¡¨</strong> æ•°æ®ç»“æ„ç»„æˆçš„ã€‚</p>
<p>åœ¨JDK1.8 ä¹‹å HashMap ç”± <strong>æ•°ç»„+é“¾è¡¨ +çº¢é»‘æ ‘</strong>æ•°æ®ç»“æ„ç»„æˆçš„ã€‚</p>
<h3 id="2-2HashMapåº•å±‚çš„æ•°æ®ç»“æ„å­˜å‚¨æ•°æ®çš„è¿‡ç¨‹"><a href="#2-2HashMapåº•å±‚çš„æ•°æ®ç»“æ„å­˜å‚¨æ•°æ®çš„è¿‡ç¨‹" class="headerlink" title="2.2HashMapåº•å±‚çš„æ•°æ®ç»“æ„å­˜å‚¨æ•°æ®çš„è¿‡ç¨‹"></a>2.2HashMapåº•å±‚çš„æ•°æ®ç»“æ„å­˜å‚¨æ•°æ®çš„è¿‡ç¨‹</h3><p>å­˜å‚¨è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>ä½¿ç”¨çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HashMap&lt;String, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;åˆ˜å¾·å&quot;</span>, <span class="number">53</span>);</span><br><span class="line">        map.put(<span class="string">&quot;æŸ³å²©&quot;</span>, <span class="number">35</span>);</span><br><span class="line">        map.put(<span class="string">&quot;å¼ å­¦å‹&quot;</span>, <span class="number">55</span>);</span><br><span class="line">        map.put(<span class="string">&quot;éƒ­å¯ŒåŸ&quot;</span>, <span class="number">52</span>);</span><br><span class="line">        map.put(<span class="string">&quot;é»æ˜&quot;</span>, <span class="number">51</span>);</span><br><span class="line">        map.put(<span class="string">&quot;æ—é’éœ&quot;</span>, <span class="number">55</span>);</span><br><span class="line">        map.put(<span class="string">&quot;åˆ˜å¾·å&quot;</span>, <span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//%E5%93%88%E5%B8%8C%E8%A1%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B.png"></p>
<p>è¯´æ˜ï¼š</p>
<p>1.é¢è¯•é¢˜ï¼šHashMapä¸­hashå‡½æ•°æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿè¿˜æœ‰å“ªäº›hashå‡½æ•°çš„å®ç°æ–¹å¼ï¼Ÿ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">å¯¹äºkeyçš„hashCodeåš<span class="built_in">hash</span>æ“ä½œï¼Œæ— ç¬¦å·å³ç§»16ä½ç„¶ååšå¼‚æˆ–è¿ç®—ã€‚</span><br><span class="line">è¿˜æœ‰å¹³æ–¹å–ä¸­æ³•ï¼Œä¼ªéšæœºæ•°æ³•å’Œå–ä½™æ•°æ³•ã€‚è¿™ä¸‰ç§æ•ˆç‡éƒ½æ¯”è¾ƒä½ã€‚è€Œæ— ç¬¦å·å³ç§»16ä½å¼‚æˆ–è¿ç®—æ•ˆç‡æ˜¯æœ€é«˜çš„ã€‚è‡³äºåº•å±‚æ˜¯å¦‚ä½•è®¡ç®—çš„æˆ‘ä»¬ä¸‹é¢çœ‹æºç æ—¶ç»™å¤§å®¶è®²è§£ã€‚</span><br></pre></td></tr></table></figure>

<p>2.é¢è¯•é¢˜ï¼šå½“ä¸¤ä¸ªå¯¹è±¡çš„hashCodeç›¸ç­‰æ—¶ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line">ä¼šäº§ç”Ÿå“ˆå¸Œç¢°æ’ï¼Œè‹¥<span class="built_in">key</span>å€¼å†…å®¹ç›¸åŒåˆ™æ›¿æ¢æ—§çš„value.ä¸ç„¶è¿æ¥åˆ°é“¾è¡¨åé¢ï¼Œé“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼<span class="number">8</span>å°±è½¬æ¢ä¸ºçº¢é»‘æ ‘å­˜å‚¨ã€‚</span><br></pre></td></tr></table></figure>

<p>3.é¢è¯•é¢˜ï¼šä½•æ—¶å‘ç”Ÿå“ˆå¸Œç¢°æ’å’Œä»€ä¹ˆæ˜¯å“ˆå¸Œç¢°æ’,å¦‚ä½•è§£å†³å“ˆå¸Œç¢°æ’ï¼Ÿ</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line">åªè¦ä¸¤ä¸ªå…ƒç´ çš„<span class="built_in">key</span>è®¡ç®—çš„å“ˆå¸Œç å€¼ç›¸åŒå°±ä¼šå‘ç”Ÿå“ˆå¸Œç¢°æ’ã€‚jdk8å‰ä½¿ç”¨é“¾è¡¨è§£å†³å“ˆå¸Œç¢°æ’ã€‚jdk8ä¹‹åä½¿ç”¨é“¾è¡¨+çº¢é»‘æ ‘è§£å†³å“ˆå¸Œç¢°æ’ã€‚</span><br></pre></td></tr></table></figure>

<p>4.é¢è¯•é¢˜ï¼šå¦‚æœä¸¤ä¸ªé”®çš„hashcodeç›¸åŒï¼Œå¦‚ä½•å­˜å‚¨é”®å€¼å¯¹ï¼Ÿ</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">hashcodeç›¸åŒï¼Œé€šè¿‡<span class="keyword">equals</span>æ¯”è¾ƒå†…å®¹æ˜¯å¦ç›¸åŒã€‚</span><br><span class="line">ç›¸åŒï¼šåˆ™æ–°çš„valueè¦†ç›–ä¹‹å‰çš„value</span><br><span class="line">ä¸ç›¸åŒï¼šåˆ™å°†æ–°çš„é”®å€¼å¯¹æ·»åŠ åˆ°å“ˆå¸Œè¡¨ä¸­</span><br></pre></td></tr></table></figure>

<p>5.åœ¨ä¸æ–­çš„æ·»åŠ æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæ¶‰åŠåˆ°æ‰©å®¹é—®é¢˜ï¼Œå½“è¶…å‡ºä¸´ç•Œå€¼(ä¸”è¦å­˜æ”¾çš„ä½ç½®éç©º)æ—¶ï¼Œæ‰©å®¹ã€‚é»˜è®¤çš„æ‰©å®¹æ–¹å¼ï¼šæ‰©å®¹ä¸ºåŸæ¥å®¹é‡çš„2å€ï¼Œå¹¶å°†åŸæœ‰çš„æ•°æ®å¤åˆ¶è¿‡æ¥ã€‚</p>
<p>6.é€šè¿‡ä¸Šè¿°æè¿°ï¼Œå½“ä½äºä¸€ä¸ªé“¾è¡¨ä¸­çš„å…ƒç´ è¾ƒå¤šï¼Œå³hashå€¼ç›¸ç­‰ä½†æ˜¯å†…å®¹ä¸ç›¸ç­‰çš„å…ƒç´ è¾ƒå¤šæ—¶ï¼Œé€šè¿‡keyå€¼ä¾æ¬¡æŸ¥æ‰¾çš„æ•ˆç‡è¾ƒä½ã€‚è€Œ<strong>JDK1.8</strong>ä¸­ï¼Œå“ˆå¸Œè¡¨å­˜å‚¨é‡‡ç”¨æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘å®ç°ï¼Œå½“é“¾è¡¨é•¿åº¦(é˜€å€¼)è¶…è¿‡ 8 æ—¶ä¸”å½“å‰æ•°ç»„çš„é•¿åº¦ &gt; 64æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œè¿™æ ·å¤§å¤§å‡å°‘äº†æŸ¥æ‰¾æ—¶é—´ã€‚jdk8åœ¨å“ˆå¸Œè¡¨ä¸­å¼•å…¥çº¢é»‘æ ‘çš„åŸå› åªæ˜¯ä¸ºäº†æŸ¥æ‰¾æ•ˆç‡æ›´é«˜ã€‚</p>
<p>ç®€å•çš„æ¥è¯´ï¼Œå“ˆå¸Œè¡¨æ˜¯ç”±æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼ˆJDK1.8å¢åŠ äº†çº¢é»‘æ ‘éƒ¨åˆ†ï¼‰å®ç°çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//%E5%93%88%E5%B8%8C%E8%A1%A8.png"></p>
<p> <strong>ä½†æ˜¯è¿™æ ·çš„è¯é—®é¢˜æ¥äº†ï¼Œä¼ ç»ŸhashMapçš„ç¼ºç‚¹ï¼Œ1.8ä¸ºä»€ä¹ˆå¼•å…¥çº¢é»‘æ ‘ï¼Ÿè¿™æ ·ç»“æ„çš„è¯ä¸æ˜¯æ›´éº»çƒ¦äº†å—ï¼Œä¸ºä½•é˜ˆå€¼å¤§äº8æ¢æˆçº¢é»‘æ ‘ï¼Ÿ</strong></p>
<p> JDK 1.8 ä»¥å‰ HashMap çš„å®ç°æ˜¯ æ•°ç»„+é“¾è¡¨ï¼Œå³ä½¿å“ˆå¸Œå‡½æ•°å–å¾—å†å¥½ï¼Œä¹Ÿå¾ˆéš¾è¾¾åˆ°å…ƒç´ ç™¾åˆ†ç™¾å‡åŒ€åˆ†å¸ƒã€‚å½“ HashMap ä¸­æœ‰å¤§é‡çš„å…ƒç´ éƒ½å­˜æ”¾åˆ°åŒä¸€ä¸ªæ¡¶ä¸­æ—¶ï¼Œè¿™ä¸ªæ¡¶ä¸‹æœ‰ä¸€æ¡é•¿é•¿çš„é“¾è¡¨ï¼Œè¿™ä¸ªæ—¶å€™ HashMap å°±ç›¸å½“äºä¸€ä¸ªå•é“¾è¡¨ï¼Œå‡å¦‚å•é“¾è¡¨æœ‰ n ä¸ªå…ƒç´ ï¼Œéå†çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(n)ï¼Œå®Œå…¨å¤±å»äº†å®ƒçš„ä¼˜åŠ¿ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒJDK 1.8 ä¸­å¼•å…¥äº† çº¢é»‘æ ‘ï¼ˆæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä¸º O(logn)ï¼‰æ¥ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ã€‚ å½“é“¾è¡¨é•¿åº¦å¾ˆå°çš„æ—¶å€™ï¼Œå³ä½¿éå†ï¼Œé€Ÿåº¦ä¹Ÿéå¸¸å¿«ï¼Œä½†æ˜¯å½“é“¾è¡¨é•¿åº¦ä¸æ–­å˜é•¿ï¼Œè‚¯å®šä¼šå¯¹æŸ¥è¯¢æ€§èƒ½æœ‰ä¸€å®šçš„å½±å“ï¼Œæ‰€ä»¥æ‰éœ€è¦è½¬æˆæ ‘ã€‚</p>
<p>è‡³äºä¸ºä»€ä¹ˆé˜ˆå€¼æ˜¯8ï¼Œæˆ‘æƒ³ï¼Œå»æºç ä¸­æ‰¾å¯»ç­”æ¡ˆåº”è¯¥æ˜¯æœ€å¯é çš„é€”å¾„ã€‚ ä¸‹é¢æˆ‘ä»¬åœ¨åˆ†ææºç çš„æ—¶å€™ä¼šä»‹ç»ã€‚</p>
<p><strong>7.æ€»ç»“ï¼š</strong></p>
<p>ä¸Šè¿°æˆ‘ä»¬å¤§æ¦‚é˜è¿°äº†HashMapåº•å±‚å­˜å‚¨æ•°æ®çš„æ–¹å¼ã€‚ä¸ºäº†æ–¹ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£ï¼Œæˆ‘ä»¬ç»“åˆä¸€ä¸ªå­˜å‚¨æµç¨‹å›¾æ¥è¿›ä¸€æ­¥è¯´æ˜ä¸€ä¸‹ï¼š(jdk8å­˜å‚¨è¿‡ç¨‹)</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//1.png"></p>
<p>è¯´æ˜ï¼š</p>
<p>1.sizeè¡¨ç¤º HashMapä¸­K-Vçš„å®æ—¶æ•°é‡ ï¼Œ æ³¨æ„è¿™ä¸ªä¸ç­‰äºæ•°ç»„çš„é•¿åº¦ ã€‚ </p>
<p>2.threshold( ä¸´ç•Œå€¼)  =capacity(å®¹é‡) * loadFactor( åŠ è½½å› å­ )ã€‚è¿™ä¸ªå€¼æ˜¯å½“å‰å·²å ç”¨æ•°ç»„é•¿åº¦çš„æœ€å¤§å€¼ã€‚sizeè¶…è¿‡è¿™ä¸ªä¸´ç•Œå€¼å°±é‡æ–°resize(æ‰©å®¹)ï¼Œæ‰©å®¹åçš„ HashMap å®¹é‡æ˜¯ä¹‹å‰å®¹é‡çš„ä¸¤å€ ã€‚</p>
<h2 id="3-HashMapç»§æ‰¿å…³ç³»"><a href="#3-HashMapç»§æ‰¿å…³ç³»" class="headerlink" title="3.HashMapç»§æ‰¿å…³ç³»"></a>3.HashMapç»§æ‰¿å…³ç³»</h2><p>HashMapç»§æ‰¿å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//1.bmp"></p>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>Cloneable ç©ºæ¥å£ï¼Œè¡¨ç¤ºå¯ä»¥å…‹éš†ã€‚ åˆ›å»ºå¹¶è¿”å›HashMapå¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚</li>
<li>Serializable åºåˆ—åŒ–æ¥å£ã€‚å±äºæ ‡è®°æ€§æ¥å£ã€‚HashMapå¯¹è±¡å¯ä»¥è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</li>
<li>AbstractMap çˆ¶ç±»æä¾›äº†Mapå®ç°æ¥å£ã€‚ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å®ç°æ­¤æ¥å£æ‰€éœ€çš„å·¥ä½œã€‚</li>
</ul>
<p>è¡¥å……ï¼šé€šè¿‡ä¸Šè¿°ç»§æ‰¿å…³ç³»æˆ‘ä»¬å‘ç°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„ç°è±¡ï¼Œ å°±æ˜¯HashMapå·²ç»ç»§æ‰¿äº†AbstractMapè€ŒAbstractMapç±»å®ç°äº†Mapæ¥å£ï¼Œé‚£ä¸ºä»€ä¹ˆHashMapè¿˜è¦åœ¨å®ç°Mapæ¥å£å‘¢ï¼ŸåŒæ ·åœ¨ArrayListä¸­LinkedListä¸­éƒ½æ˜¯è¿™ç§ç»“æ„ã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">æ® java é›†åˆæ¡†æ¶çš„åˆ›å§‹äººJosh Blochæè¿°ï¼Œè¿™æ ·çš„å†™æ³•æ˜¯ä¸€ä¸ªå¤±è¯¯ã€‚åœ¨javaé›†åˆæ¡†æ¶ä¸­ï¼Œç±»ä¼¼è¿™æ ·çš„å†™æ³•å¾ˆå¤šï¼Œæœ€å¼€å§‹å†™javaé›†åˆæ¡†æ¶çš„æ—¶å€™ï¼Œä»–è®¤ä¸ºè¿™æ ·å†™ï¼Œåœ¨æŸäº›åœ°æ–¹å¯èƒ½æ˜¯æœ‰ä»·å€¼çš„ï¼Œç›´åˆ°ä»–æ„è¯†åˆ°é”™äº†ã€‚æ˜¾ç„¶çš„ï¼ŒJDKçš„ç»´æŠ¤è€…ï¼Œåæ¥ä¸è®¤ä¸ºè¿™ä¸ªå°å°çš„å¤±è¯¯å€¼å¾—å»ä¿®æ”¹ï¼Œæ‰€ä»¥å°±è¿™æ ·å­˜åœ¨ä¸‹æ¥äº†ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="4-HashMapé›†åˆç±»çš„æˆå‘˜"><a href="#4-HashMapé›†åˆç±»çš„æˆå‘˜" class="headerlink" title="4.HashMapé›†åˆç±»çš„æˆå‘˜"></a>4.HashMapé›†åˆç±»çš„æˆå‘˜</h2><h3 id="4-1æˆå‘˜å˜é‡"><a href="#4-1æˆå‘˜å˜é‡" class="headerlink" title="4.1æˆå‘˜å˜é‡"></a>4.1æˆå‘˜å˜é‡</h3><p>1.åºåˆ—åŒ–ç‰ˆæœ¬å·</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">362498820763181265L</span>;</span><br></pre></td></tr></table></figure>

<p>2.é›†åˆçš„åˆå§‹åŒ–å®¹é‡( <strong>å¿…é¡»æ˜¯äºŒçš„næ¬¡å¹‚</strong> )</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é»˜è®¤çš„åˆå§‹å®¹é‡æ˜¯16 -- 1&lt;&lt;4ç›¸å½“äº1*2çš„4æ¬¡æ–¹---1*16</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">4</span>;   </span><br></pre></td></tr></table></figure>

<p>é—®é¢˜ï¼š <strong>ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯2çš„næ¬¡å¹‚ï¼Ÿå¦‚æœè¾“å…¥å€¼ä¸æ˜¯2çš„å¹‚æ¯”å¦‚10ä¼šæ€ä¹ˆæ ·ï¼Ÿ</strong> </p>
<p>HashMapæ„é€ æ–¹æ³•è¿˜å¯ä»¥æŒ‡å®šé›†åˆçš„åˆå§‹åŒ–å®¹é‡å¤§å°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HashMap(<span class="keyword">int</span> initialCapacity) æ„é€ ä¸€ä¸ªå¸¦æŒ‡å®šåˆå§‹å®¹é‡å’Œé»˜è®¤åŠ è½½å› å­ (<span class="number">0.75</span>) çš„ç©º HashMapã€‚</span><br></pre></td></tr></table></figure>

<p> æ ¹æ®ä¸Šè¿°è®²è§£æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œå½“å‘HashMapä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦æ ¹æ®keyçš„hashå€¼ï¼Œå»ç¡®å®šå…¶åœ¨æ•°ç»„ä¸­çš„å…·ä½“ä½ç½®ã€‚ HashMapä¸ºäº†å­˜å–é«˜æ•ˆï¼Œè¦å°½é‡è¾ƒå°‘ç¢°æ’ï¼Œå°±æ˜¯è¦å°½é‡æŠŠæ•°æ®åˆ†é…å‡åŒ€ï¼Œæ¯ä¸ªé“¾è¡¨é•¿åº¦å¤§è‡´ç›¸åŒï¼Œè¿™ä¸ªå®ç°å°±åœ¨æŠŠæ•°æ®å­˜åˆ°å“ªä¸ªé“¾è¡¨ä¸­çš„ç®—æ³•ã€‚</p>
<p>è¿™ä¸ªç®—æ³•å®é™…å°±æ˜¯å–æ¨¡ï¼Œhash%lengthï¼Œè®¡ç®—æœºä¸­ç›´æ¥æ±‚ä½™æ•ˆç‡ä¸å¦‚ä½ç§»è¿ç®—(è¿™ç‚¹ä¸Šè¿°å·²ç»è®²è§£)ã€‚æ‰€ä»¥æºç ä¸­åšäº†ä¼˜åŒ–,ä½¿ç”¨ hash&amp;(length-1)ï¼Œè€Œå®é™…ä¸Šhash%lengthç­‰äºhash&amp;(length-1)çš„å‰ææ˜¯lengthæ˜¯2çš„næ¬¡å¹‚ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™æ ·èƒ½å‡åŒ€åˆ†å¸ƒå‡å°‘ç¢°æ’å‘¢ï¼Ÿ2çš„næ¬¡æ–¹å®é™…å°±æ˜¯1åé¢nä¸ª0ï¼Œ2çš„næ¬¡æ–¹-1  å®é™…å°±æ˜¯nä¸ª1ï¼›</p>
<p>ä¸¾ä¾‹ï¼š</p>
<p><strong>è¯´æ˜ï¼šæŒ‰ä½ä¸è¿ç®—ï¼šç›¸åŒçš„äºŒè¿›åˆ¶æ•°ä½ä¸Šï¼Œéƒ½æ˜¯1çš„æ—¶å€™ï¼Œç»“æœä¸º1ï¼Œå¦åˆ™ä¸ºé›¶ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚é•¿åº¦ä¸º<span class="number">8</span>æ—¶å€™ï¼Œ<span class="number">3</span>&amp;(<span class="number">8</span>-<span class="number">1</span>)=<span class="number">3</span>  <span class="number">2</span>&amp;(<span class="number">8</span>-<span class="number">1</span>)=<span class="number">2</span> ï¼Œä¸åŒä½ç½®ä¸Šï¼Œä¸ç¢°æ’ï¼›</span><br><span class="line">ä¾‹å¦‚é•¿åº¦lengthä¸º<span class="number">8</span>æ—¶å€™ï¼Œ<span class="number">8</span>æ˜¯<span class="number">2</span>çš„<span class="number">3</span>æ¬¡å¹‚ã€‚äºŒè¿›åˆ¶æ˜¯ï¼š<span class="number">1000</span></span><br><span class="line">length-<span class="number">1</span> äºŒè¿›åˆ¶è¿ç®—ï¼š</span><br><span class="line">	<span class="number">1000</span></span><br><span class="line">-	   <span class="number">1</span></span><br><span class="line">---------------------</span><br><span class="line">     <span class="number">111</span></span><br><span class="line">å¦‚ä¸‹æ‰€ç¤ºï¼š</span><br><span class="line">hash&amp;(length-<span class="number">1</span>)</span><br><span class="line"><span class="number">3</span>   &amp;(<span class="number">8</span>    - <span class="number">1</span>)=<span class="number">3</span>  </span><br><span class="line">	<span class="number">00000011</span>  <span class="number">3</span> hash</span><br><span class="line">&amp;   <span class="number">00000111</span>  <span class="number">7</span> length-<span class="number">1</span></span><br><span class="line">---------------------</span><br><span class="line">	<span class="number">00000011</span>-----ã€‹<span class="number">3</span> æ•°ç»„ä¸‹æ ‡</span><br><span class="line">	</span><br><span class="line">hash&amp;(length-<span class="number">1</span>)</span><br><span class="line"><span class="number">2</span> &amp;  (<span class="number">8</span> -    <span class="number">1</span>) = <span class="number">2</span>  </span><br><span class="line">	<span class="number">00000010</span>  <span class="number">2</span> hash</span><br><span class="line">&amp;   <span class="number">00000111</span>  <span class="number">7</span> length-<span class="number">1</span></span><br><span class="line">---------------------</span><br><span class="line">	<span class="number">00000010</span>-----ã€‹<span class="number">2</span>  æ•°ç»„ä¸‹æ ‡</span><br><span class="line">è¯´æ˜ï¼šä¸Šè¿°è®¡ç®—ç»“æœæ˜¯ä¸åŒä½ç½®ä¸Šï¼Œä¸ç¢°æ’ï¼›</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚é•¿åº¦ä¸º<span class="number">9</span>æ—¶å€™ï¼Œ<span class="number">3</span>&amp;(<span class="number">9</span>-<span class="number">1</span>)=<span class="number">0</span>  <span class="number">2</span>&amp;(<span class="number">9</span>-<span class="number">1</span>)=<span class="number">0</span> ï¼Œéƒ½åœ¨<span class="number">0</span>ä¸Šï¼Œç¢°æ’äº†ï¼›</span><br><span class="line">ä¾‹å¦‚é•¿åº¦lengthä¸º<span class="number">9</span>æ—¶å€™ï¼Œ<span class="number">9</span>ä¸æ˜¯<span class="number">2</span>çš„næ¬¡å¹‚ã€‚äºŒè¿›åˆ¶æ˜¯ï¼š<span class="number">00001001</span></span><br><span class="line">length-<span class="number">1</span> äºŒè¿›åˆ¶è¿ç®—ï¼š</span><br><span class="line">	<span class="number">1001</span></span><br><span class="line">-	   <span class="number">1</span></span><br><span class="line">---------------------</span><br><span class="line">    <span class="number">1000</span></span><br><span class="line">å¦‚ä¸‹æ‰€ç¤ºï¼š</span><br><span class="line">hash&amp;(length-<span class="number">1</span>)</span><br><span class="line"><span class="number">3</span>   &amp;(<span class="number">9</span>    - <span class="number">1</span>)=<span class="number">0</span>  </span><br><span class="line">	<span class="number">00000011</span>  <span class="number">3</span> hash</span><br><span class="line">&amp;   <span class="number">00001000</span>  <span class="number">8</span> length-<span class="number">1</span> </span><br><span class="line">---------------------</span><br><span class="line">	<span class="number">00000000</span>-----ã€‹<span class="number">0</span>  æ•°ç»„ä¸‹æ ‡</span><br><span class="line">	</span><br><span class="line">hash&amp;(length-<span class="number">1</span>)</span><br><span class="line"><span class="number">2</span> &amp;  (<span class="number">9</span> -    <span class="number">1</span>) = <span class="number">2</span>  </span><br><span class="line">	<span class="number">00000010</span> <span class="number">2</span> hash</span><br><span class="line">&amp;   <span class="number">00001000</span> <span class="number">8</span> length-<span class="number">1</span> </span><br><span class="line">---------------------</span><br><span class="line">	<span class="number">00000000</span>-----ã€‹<span class="number">0</span>  æ•°ç»„ä¸‹æ ‡</span><br><span class="line">è¯´æ˜ï¼šä¸Šè¿°è®¡ç®—ç»“æœéƒ½åœ¨<span class="number">0</span>ä¸Šï¼Œç¢°æ’äº†ï¼›</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼š å½“ç„¶å¦‚æœä¸è€ƒè™‘æ•ˆç‡ç›´æ¥æ±‚ä½™å³å¯ï¼ˆå°±ä¸éœ€è¦è¦æ±‚é•¿åº¦å¿…é¡»æ˜¯2çš„næ¬¡æ–¹äº†ï¼‰</strong> </p>
<p>å°ç»“ï¼š</p>
<p>â€‹    1.ç”±ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œå½“æˆ‘ä»¬æ ¹æ®keyçš„hashç¡®å®šå…¶åœ¨æ•°ç»„çš„ä½ç½®æ—¶ï¼Œå¦‚æœnä¸º2çš„å¹‚æ¬¡æ–¹ï¼Œå¯ä»¥ä¿è¯æ•°æ®çš„å‡åŒ€æ’å…¥ï¼Œå¦‚æœnä¸æ˜¯2çš„å¹‚æ¬¡æ–¹ï¼Œå¯èƒ½æ•°ç»„çš„ä¸€äº›ä½ç½®æ°¸è¿œä¸ä¼šæ’å…¥æ•°æ®ï¼Œæµªè´¹æ•°ç»„çš„ç©ºé—´ï¼ŒåŠ å¤§hashå†²çªã€‚</p>
<p>â€‹    2.å¦ä¸€æ–¹é¢ï¼Œä¸€èˆ¬æˆ‘ä»¬å¯èƒ½ä¼šæƒ³é€šè¿‡ % æ±‚ä½™æ¥ç¡®å®šä½ç½®ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥ï¼Œåªä¸è¿‡æ€§èƒ½ä¸å¦‚ &amp; è¿ç®—ã€‚è€Œä¸”å½“næ˜¯2çš„å¹‚æ¬¡æ–¹æ—¶ï¼šhash &amp; (length - 1) == hash % length</p>
<p>â€‹    3.å› æ­¤ï¼ŒHashMap å®¹é‡ä¸º2æ¬¡å¹‚çš„åŸå› ï¼Œå°±æ˜¯ä¸ºäº†æ•°æ®çš„çš„å‡åŒ€åˆ†å¸ƒï¼Œå‡å°‘hashå†²çªï¼Œæ¯•ç«Ÿhashå†²çªè¶Šå¤§ï¼Œä»£è¡¨æ•°ç»„ä¸­ä¸€ä¸ªé“¾çš„é•¿åº¦è¶Šå¤§ï¼Œè¿™æ ·çš„è¯ä¼šé™ä½hashmapçš„æ€§èƒ½</p>
<p>â€‹    <strong>4.å¦‚æœåˆ›å»ºHashMapå¯¹è±¡æ—¶ï¼Œè¾“å…¥çš„æ•°ç»„é•¿åº¦æ˜¯10ï¼Œä¸æ˜¯2çš„å¹‚ï¼ŒHashMapé€šè¿‡ä¸€é€šä½ç§»è¿ç®—å’Œæˆ–è¿ç®—å¾—åˆ°çš„è‚¯å®šæ˜¯2çš„å¹‚æ¬¡æ•°ï¼Œå¹¶ä¸”æ˜¯ç¦»é‚£ä¸ªæ•°æœ€è¿‘çš„æ•°å­—ã€‚</strong></p>
<p>æºä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºHashMapé›†åˆçš„å¯¹è±¡ï¼ŒæŒ‡å®šæ•°ç»„é•¿åº¦æ˜¯10ï¼Œä¸æ˜¯2çš„å¹‚</span></span><br><span class="line">HashMap hashMap = <span class="keyword">new</span> HashMap(<span class="number">10</span>);</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;<span class="comment">//initialCapacity=10</span></span><br><span class="line">   <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line"> &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;<span class="comment">//initialCapacity=10</span></span><br><span class="line">     <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal initial capacity: &quot;</span> +</span><br><span class="line">                                               initialCapacity);</span><br><span class="line">        <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">            initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">        <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal load factor: &quot;</span> +</span><br><span class="line">                                               loadFactor);</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity);<span class="comment">//initialCapacity=10</span></span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Returns a power of two size for the given target capacity.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">tableSizeFor</span><span class="params">(<span class="keyword">int</span> cap)</span> </span>&#123;<span class="comment">//int cap = 10</span></span><br><span class="line">        <span class="keyword">int</span> n = cap - <span class="number">1</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">8</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">16</span>;</span><br><span class="line">        <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ? <span class="number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<p>ç”±æ­¤å¯ä»¥çœ‹åˆ°ï¼Œå½“åœ¨å®ä¾‹åŒ–HashMapå®ä¾‹æ—¶ï¼Œå¦‚æœç»™å®šäº†initialCapacity(å‡è®¾æ˜¯10)ï¼Œç”±äºHashMapçš„capacityå¿…é¡»éƒ½æ˜¯2çš„å¹‚ï¼Œå› æ­¤è¿™ä¸ªæ–¹æ³•ç”¨äºæ‰¾åˆ°å¤§äºç­‰äºinitialCapacity(å‡è®¾æ˜¯10)çš„æœ€å°çš„2çš„å¹‚ï¼ˆinitialCapacityå¦‚æœå°±æ˜¯2çš„å¹‚ï¼Œåˆ™è¿”å›çš„è¿˜æ˜¯è¿™ä¸ªæ•°ï¼‰ã€‚<br>ä¸‹é¢åˆ†æè¿™ä¸ªç®—æ³•ï¼š<br>1)ã€é¦–å…ˆï¼Œä¸ºä»€ä¹ˆè¦å¯¹capåšå‡1æ“ä½œã€‚int n = cap - 1;<br>è¿™æ˜¯ä¸ºäº†é˜²æ­¢ï¼Œcapå·²ç»æ˜¯2çš„å¹‚ã€‚å¦‚æœcapå·²ç»æ˜¯2çš„å¹‚ï¼Œ åˆæ²¡æœ‰æ‰§è¡Œè¿™ä¸ªå‡1æ“ä½œï¼Œåˆ™æ‰§è¡Œå®Œåé¢çš„å‡ æ¡æ— ç¬¦å·å³ç§»æ“ä½œä¹‹åï¼Œè¿”å›çš„capacityå°†æ˜¯è¿™ä¸ªcapçš„2å€ã€‚å¦‚æœä¸æ‡‚ï¼Œè¦çœ‹å®Œåé¢çš„å‡ ä¸ªæ— ç¬¦å·å³ç§»ä¹‹åå†å›æ¥çœ‹çœ‹ã€‚<br>ä¸‹é¢çœ‹çœ‹è¿™å‡ ä¸ªæ— ç¬¦å·å³ç§»æ“ä½œï¼š<br>2ï¼‰ã€å¦‚æœnè¿™æ—¶ä¸º0äº†ï¼ˆç»è¿‡äº†cap-1ä¹‹åï¼‰ï¼Œåˆ™ç»è¿‡åé¢çš„å‡ æ¬¡æ— ç¬¦å·å³ç§»ä¾ç„¶æ˜¯0ï¼Œæœ€åè¿”å›çš„capacityæ˜¯        1ï¼ˆæœ€åæœ‰ä¸ªn+1çš„æ“ä½œï¼‰ã€‚<br>è¿™é‡Œåªè®¨è®ºnä¸ç­‰äº0çš„æƒ…å†µã€‚</p>
<p>3ï¼‰ã€æ³¨æ„ï¼š**|ï¼ˆæŒ‰ä½æˆ–è¿ç®—ï¼‰ï¼šè¿ç®—è§„åˆ™ï¼šç›¸åŒçš„äºŒè¿›åˆ¶æ•°ä½ä¸Šï¼Œéƒ½æ˜¯0çš„æ—¶å€™ï¼Œç»“æœä¸º0ï¼Œå¦åˆ™ä¸º1ã€‚**</p>
<p>â€‹     <strong>ç¬¬ä¸€æ¬¡å³ç§»</strong> ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> n = cap - <span class="number">1</span>;<span class="comment">//cap=10  n=9</span></span><br><span class="line">n |= n &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">	<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001001</span> <span class="comment">//9</span></span><br><span class="line">|	</span><br><span class="line">	<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000100</span> <span class="comment">//9å³ç§»ä¹‹åå˜ä¸º4</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line">	<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001101</span> <span class="comment">//æŒ‰ä½å¼‚æˆ–ä¹‹åæ˜¯13</span></span><br></pre></td></tr></table></figure>

<p> ç”±äºnä¸ç­‰äº0ï¼Œåˆ™nçš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æ€»ä¼šæœ‰ä¸€bitä¸º1ï¼Œè¿™æ—¶è€ƒè™‘æœ€é«˜ä½çš„1ã€‚é€šè¿‡æ— ç¬¦å·å³ç§»1ä½ï¼Œåˆ™å°†æœ€é«˜ä½çš„1å³ç§»äº†1ä½ï¼Œå†åšæˆ–æ“ä½œï¼Œä½¿å¾—nçš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ä¸æœ€é«˜ä½çš„1ç´§é‚»çš„å³è¾¹ä¸€ä½ä¹Ÿä¸º1ï¼Œå¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001101</span></span><br></pre></td></tr></table></figure>

<p> <strong>ç¬¬äºŒæ¬¡å³ç§»</strong> ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> n |= n &gt;&gt;&gt; <span class="number">2</span>;<span class="comment">//né€šè¿‡ç¬¬ä¸€æ¬¡å³ç§»å˜ä¸ºäº†ï¼šn=13</span></span><br><span class="line">	<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001101</span>  <span class="comment">// 13</span></span><br><span class="line">|</span><br><span class="line">    <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000011</span>  <span class="comment">//13å³ç§»ä¹‹åå˜ä¸º3</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line">	<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001111</span> <span class="comment">//æŒ‰ä½å¼‚æˆ–ä¹‹åæ˜¯15</span></span><br></pre></td></tr></table></figure>

<p> æ³¨æ„ï¼Œè¿™ä¸ªnå·²ç»ç»è¿‡äº†<code>n |= n &gt;&gt;&gt; 1;</code> æ“ä½œã€‚å‡è®¾æ­¤æ—¶nä¸º00000000 00000000 00000000 00001101 ï¼Œåˆ™næ— ç¬¦å·å³ç§»ä¸¤ä½ï¼Œä¼šå°†æœ€é«˜ä½ä¸¤ä¸ªè¿ç»­çš„1å³ç§»ä¸¤ä½ï¼Œç„¶åå†ä¸åŸæ¥çš„nåšæˆ–æ“ä½œï¼Œè¿™æ ·nçš„äºŒè¿›åˆ¶è¡¨ç¤ºçš„é«˜ä½ä¸­ä¼šæœ‰4ä¸ªè¿ç»­çš„1ã€‚å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001111</span> <span class="comment">//æŒ‰ä½å¼‚æˆ–ä¹‹åæ˜¯15</span></span><br></pre></td></tr></table></figure>

<p> <strong>ç¬¬ä¸‰æ¬¡å³ç§»</strong> :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">n |= n &gt;&gt;&gt; <span class="number">4</span>;<span class="comment">//né€šè¿‡ç¬¬ä¸€ã€äºŒæ¬¡å³ç§»å˜ä¸ºäº†ï¼šn=15</span></span><br><span class="line">	<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001111</span>  <span class="comment">// 15</span></span><br><span class="line">|</span><br><span class="line">    <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>  <span class="comment">//15å³ç§»ä¹‹åå˜ä¸º0</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line">	<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00001111</span> <span class="comment">//æŒ‰ä½å¼‚æˆ–ä¹‹åæ˜¯15</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ¬¡æŠŠå·²ç»æœ‰çš„é«˜ä½ä¸­çš„è¿ç»­çš„4ä¸ª1ï¼Œå³ç§»4ä½ï¼Œå†åšæˆ–æ“ä½œï¼Œè¿™æ ·nçš„äºŒè¿›åˆ¶è¡¨ç¤ºçš„é«˜ä½ä¸­æ­£å¸¸ä¼šæœ‰8ä¸ªè¿ç»­çš„1ã€‚å¦‚00001111 1111xxxxxx ã€‚<br>ä»¥æ­¤ç±»æ¨<br>æ³¨æ„ï¼Œå®¹é‡æœ€å¤§ä¹Ÿå°±æ˜¯32bitçš„æ­£æ•°ï¼Œå› æ­¤æœ€ån |= n &gt;&gt;&gt; 16; ï¼Œæœ€å¤šä¹Ÿå°±32ä¸ª1ï¼ˆä½†æ˜¯è¿™å·²ç»æ˜¯è´Ÿæ•°äº†ã€‚åœ¨æ‰§è¡ŒtableSizeForä¹‹å‰ï¼Œå¯¹initialCapacityåšäº†åˆ¤æ–­ï¼Œå¦‚æœå¤§äºMAXIMUM_CAPACITY(2 ^ 30)ï¼Œåˆ™å–MAXIMUM_CAPACITYã€‚å¦‚æœç­‰äºMAXIMUM_CAPACITY(2 ^ 30)ï¼Œä¼šæ‰§è¡Œç§»ä½æ“ä½œã€‚æ‰€ä»¥è¿™é‡Œé¢çš„ç§»ä½æ“ä½œä¹‹åï¼Œæœ€å¤§30ä¸ª1ï¼Œä¸ä¼šå¤§äºç­‰äºMAXIMUM_CAPACITYã€‚30ä¸ª1ï¼ŒåŠ 1ä¹‹åå¾—2 ^ 30ï¼‰ ã€‚<br>è¯·çœ‹ä¸‹é¢çš„ä¸€ä¸ªå®Œæ•´ä¾‹å­ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191115151657917.png" alt="image-20191115151657917"></p>
<p>  æ³¨æ„ï¼Œå¾—åˆ°çš„è¿™ä¸ªcapacityå´è¢«èµ‹å€¼ç»™äº†thresholdã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity);<span class="comment">//initialCapacity=10</span></span><br></pre></td></tr></table></figure>

<p>3.é»˜è®¤çš„è´Ÿè½½å› å­ï¼Œé»˜è®¤å€¼æ˜¯0.75 </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75f</span>;</span><br></pre></td></tr></table></figure>

<p>4.é›†åˆæœ€å¤§å®¹é‡ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é›†åˆæœ€å¤§å®¹é‡çš„ä¸Šé™æ˜¯ï¼š2çš„30æ¬¡å¹‚</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAXIMUM_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br></pre></td></tr></table></figure>

<p>5.å½“é“¾è¡¨çš„å€¼è¶…è¿‡8åˆ™ä¼šè½¬çº¢é»‘æ ‘(<strong>1.8æ–°å¢</strong>) </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å¤§äºè¿™ä¸ªå€¼æ—¶ä¼šè½¬æˆçº¢é»‘æ ‘</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TREEIFY_THRESHOLD = <span class="number">8</span>;</span><br></pre></td></tr></table></figure>

<p><strong>é—®é¢˜ï¼šä¸ºä»€ä¹ˆMapæ¡¶ä¸­èŠ‚ç‚¹ä¸ªæ•°è¶…è¿‡8æ‰è½¬ä¸ºçº¢é»‘æ ‘ï¼Ÿ</strong></p>
<p>8è¿™ä¸ªé˜ˆå€¼å®šä¹‰åœ¨HashMapä¸­ï¼Œé’ˆå¯¹è¿™ä¸ªæˆå‘˜å˜é‡ï¼Œåœ¨æºç çš„æ³¨é‡Šä¸­åªè¯´æ˜äº†8æ˜¯binï¼ˆbinå°±æ˜¯bucket(æ¡¶)ï¼‰ä»é“¾è¡¨è½¬æˆæ ‘çš„é˜ˆå€¼ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è¯´æ˜ä¸ºä»€ä¹ˆæ˜¯8ï¼š </p>
<p> åœ¨HashMapä¸­æœ‰ä¸€æ®µæ³¨é‡Šè¯´æ˜ï¼š æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Because TreeNodes are about twice the size of regular nodes, <span class="function">we use them only when bins contain enough nodes to warrant <span class="title">use</span> <span class="params">(see TREEIFY_THRESHOLD)</span>. And when they become too <span class="title">small</span> <span class="params">(due to removal or resizing)</span> they are converted back to plain bins.  In usages with well-distributed user hashCodes, tree bins are rarely used.  Ideally, under random hashCodes, the frequency of nodes in bins follows a Poisson distribution</span></span><br><span class="line"><span class="function"><span class="params">(http://en.wikipedia.org/wiki/Poisson_distribution)</span> with a parameter of about 0.5 on average <span class="keyword">for</span> the <span class="keyword">default</span> resizing threshold of 0.75, although with a large variance because of resizing granularity. Ignoring variance, the expected occurrences of list size k <span class="title">are</span> <span class="params">(exp(-<span class="number">0.5</span>)</span>*<span class="title">pow</span><span class="params">(<span class="number">0.5</span>, k)</span>/<span class="title">factorial</span><span class="params">(k)</span>).</span></span><br><span class="line"><span class="function">The first values are:</span></span><br><span class="line"><span class="function">å› ä¸ºæ ‘èŠ‚ç‚¹çš„å¤§å°å¤§çº¦æ˜¯æ™®é€šèŠ‚ç‚¹çš„ä¸¤å€ï¼Œæ‰€ä»¥æˆ‘ä»¬åªåœ¨ç®±å­åŒ…å«è¶³å¤Ÿçš„èŠ‚ç‚¹æ—¶æ‰ä½¿ç”¨æ ‘èŠ‚ç‚¹<span class="params">(å‚è§TREEIFY_THRESHOLD)</span>ã€‚å½“å®ƒä»¬å˜å¾—å¤ªå°<span class="params">(ç”±äºåˆ é™¤æˆ–è°ƒæ•´å¤§å°)</span>æ—¶ï¼Œå°±ä¼šè¢«è½¬æ¢å›æ™®é€šçš„æ¡¶ã€‚åœ¨ä½¿ç”¨åˆ†å¸ƒè‰¯å¥½çš„ç”¨æˆ·hashcodeæ—¶ï¼Œå¾ˆå°‘ä½¿ç”¨æ ‘ç®±ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œåœ¨éšæœºå“ˆå¸Œç ä¸‹ï¼Œç®±å­ä¸­èŠ‚ç‚¹çš„é¢‘ç‡æœä»æ³Šæ¾åˆ†å¸ƒ</span></span><br><span class="line"><span class="function"><span class="params">(http://en.wikipedia.org/wiki/Poisson_distribution)</span>ï¼Œé»˜è®¤è°ƒæ•´é˜ˆå€¼ä¸º0.75ï¼Œå¹³å‡å‚æ•°çº¦ä¸º0.5ï¼Œå°½ç®¡ç”±äºè°ƒæ•´ç²’åº¦çš„å·®å¼‚å¾ˆå¤§ã€‚å¿½ç•¥æ–¹å·®ï¼Œåˆ—è¡¨å¤§å°kçš„é¢„æœŸå‡ºç°æ¬¡æ•°æ˜¯<span class="params">(exp(-<span class="number">0.5</span>)</span>*<span class="title">pow</span><span class="params">(<span class="number">0.5</span>, k)</span>/<span class="title">factorial</span><span class="params">(k)</span>)ã€‚</span></span><br><span class="line"><span class="function">ç¬¬ä¸€ä¸ªå€¼æ˜¯:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">0:    0.60653066</span></span><br><span class="line"><span class="function">1:    0.30326533</span></span><br><span class="line"><span class="function">2:    0.07581633</span></span><br><span class="line"><span class="function">3:    0.01263606</span></span><br><span class="line"><span class="function">4:    0.00157952</span></span><br><span class="line"><span class="function">5:    0.00015795</span></span><br><span class="line"><span class="function">6:    0.00001316</span></span><br><span class="line"><span class="function">7:    0.00000094</span></span><br><span class="line"><span class="function">8:    0.00000006</span></span><br><span class="line"><span class="function">more: less than 1 in ten million</span></span><br></pre></td></tr></table></figure>

<p>TreeNodeså ç”¨ç©ºé—´æ˜¯æ™®é€šNodesçš„ä¸¤å€ï¼Œæ‰€ä»¥åªæœ‰å½“binåŒ…å«è¶³å¤Ÿå¤šçš„èŠ‚ç‚¹æ—¶æ‰ä¼šè½¬æˆTreeNodesï¼Œè€Œæ˜¯å¦è¶³å¤Ÿå¤šå°±æ˜¯ç”±TREEIFY_THRESHOLDçš„å€¼å†³å®šçš„ã€‚å½“binä¸­èŠ‚ç‚¹æ•°å˜å°‘æ—¶ï¼Œåˆä¼šè½¬æˆæ™®é€šçš„binã€‚å¹¶ä¸”æˆ‘ä»¬æŸ¥çœ‹æºç çš„æ—¶å€™å‘ç°ï¼Œé“¾è¡¨é•¿åº¦è¾¾åˆ°8å°±è½¬æˆçº¢é»‘æ ‘ï¼Œå½“é•¿åº¦é™åˆ°6å°±è½¬æˆæ™®é€šbinã€‚</p>
<p>è¿™æ ·å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆä¸æ˜¯ä¸€å¼€å§‹å°±å°†å…¶è½¬æ¢ä¸ºTreeNodesï¼Œè€Œæ˜¯éœ€è¦ä¸€å®šèŠ‚ç‚¹æ•°æ‰è½¬ä¸ºTreeNodesï¼Œè¯´ç™½äº†å°±æ˜¯æƒè¡¡ï¼Œç©ºé—´å’Œæ—¶é—´çš„æƒè¡¡ã€‚</p>
<p> è¿™æ®µå†…å®¹è¿˜è¯´åˆ°ï¼šå½“hashCodeç¦»æ•£æ€§å¾ˆå¥½çš„æ—¶å€™ï¼Œæ ‘å‹binç”¨åˆ°çš„æ¦‚ç‡éå¸¸å°ï¼Œå› ä¸ºæ•°æ®å‡åŒ€åˆ†å¸ƒåœ¨æ¯ä¸ªbinä¸­ï¼Œå‡ ä¹ä¸ä¼šæœ‰binä¸­é“¾è¡¨é•¿åº¦ä¼šè¾¾åˆ°é˜ˆå€¼ã€‚ä½†æ˜¯åœ¨éšæœºhashCodeä¸‹ï¼Œç¦»æ•£æ€§å¯èƒ½ä¼šå˜å·®ï¼Œç„¶è€ŒJDKåˆä¸èƒ½é˜»æ­¢ç”¨æˆ·å®ç°è¿™ç§ä¸å¥½çš„hashç®—æ³•ï¼Œå› æ­¤å°±å¯èƒ½å¯¼è‡´ä¸å‡åŒ€çš„æ•°æ®åˆ†å¸ƒã€‚ä¸è¿‡ç†æƒ³æƒ…å†µä¸‹éšæœºhashCodeç®—æ³•ä¸‹æ‰€æœ‰binä¸­èŠ‚ç‚¹çš„åˆ†å¸ƒé¢‘ç‡ä¼šéµå¾ªæ³Šæ¾åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸€ä¸ªbinä¸­é“¾è¡¨é•¿åº¦è¾¾åˆ°8ä¸ªå…ƒç´ çš„æ¦‚ç‡ä¸º0.00000006ï¼Œå‡ ä¹æ˜¯ä¸å¯èƒ½äº‹ä»¶ã€‚æ‰€ä»¥ï¼Œä¹‹æ‰€ä»¥é€‰æ‹©8ï¼Œä¸æ˜¯éšä¾¿å†³å®šçš„ï¼Œè€Œæ˜¯æ ¹æ®æ¦‚ç‡ç»Ÿè®¡å†³å®šçš„ã€‚ç”±æ­¤å¯è§ï¼Œå‘å±•å°†è¿‘30å¹´çš„Javaæ¯ä¸€é¡¹æ”¹åŠ¨å’Œä¼˜åŒ–éƒ½æ˜¯éå¸¸ä¸¥è°¨å’Œç§‘å­¦çš„ã€‚ </p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼šé€‰æ‹©8å› ä¸ºç¬¦åˆæ³Šæ¾åˆ†å¸ƒï¼Œè¶…è¿‡8çš„æ—¶å€™ï¼Œæ¦‚ç‡å·²ç»éå¸¸å°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©8è¿™ä¸ªæ•°å­—ã€‚</p>
<p>è¡¥å……ï¼š</p>
<p>1ï¼‰.</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"> <span class="selector-tag">Poisson</span>åˆ†å¸ƒ(æ³Šæ¾åˆ†å¸ƒ)ï¼Œæ˜¯ä¸€ç§ç»Ÿè®¡ä¸æ¦‚ç‡å­¦é‡Œå¸¸è§åˆ°çš„ç¦»æ•£<span class="selector-attr">[æ¦‚ç‡åˆ†å¸ƒ]</span>ã€‚</span><br><span class="line">æ³Šæ¾åˆ†å¸ƒçš„æ¦‚ç‡å‡½æ•°ä¸ºï¼š</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191115161055901.png" alt="image-20191115161055901"></p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">æ³Šæ¾åˆ†å¸ƒçš„å‚æ•°Î»æ˜¯å•ä½æ—¶é—´<span class="comment">(æˆ–å•ä½é¢ç§¯)</span>å†…éšæœºäº‹ä»¶çš„å¹³å‡å‘ç”Ÿæ¬¡æ•°ã€‚ æ³Šæ¾åˆ†å¸ƒé€‚åˆäºæè¿°å•ä½æ—¶é—´å†…éšæœºäº‹ä»¶å‘ç”Ÿçš„æ¬¡æ•°ã€‚</span><br></pre></td></tr></table></figure>

<p>2ï¼‰.ä»¥ä¸‹æ˜¯æˆ‘åœ¨ç ”ç©¶è¿™ä¸ªé—®é¢˜æ—¶ï¼Œåœ¨ä¸€äº›èµ„æ–™ä¸Šé¢ç¿»çœ‹çš„è§£é‡Šï¼šä¾›å¤§å®¶å‚è€ƒï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">çº¢é»‘æ ‘çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦æ˜¯log(n)ï¼Œå¦‚æœé•¿åº¦ä¸º<span class="number">8</span>ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸ºlog(<span class="number">8</span>)=<span class="number">3</span>ï¼Œé“¾è¡¨çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸ºn/<span class="number">2</span>ï¼Œå½“é•¿åº¦ä¸º<span class="number">8</span>æ—¶ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º<span class="number">8</span>/<span class="number">2</span>=<span class="number">4</span>ï¼Œè¿™æ‰æœ‰è½¬æ¢æˆæ ‘çš„å¿…è¦ï¼›é“¾è¡¨é•¿åº¦å¦‚æœæ˜¯å°äºç­‰äº<span class="number">6</span>ï¼Œ<span class="number">6</span>/<span class="number">2</span>=<span class="number">3</span>ï¼Œè€Œlog(<span class="number">6</span>)=<span class="number">2.6</span>ï¼Œè™½ç„¶é€Ÿåº¦ä¹Ÿå¾ˆå¿«çš„ï¼Œä½†æ˜¯è½¬åŒ–ä¸ºæ ‘ç»“æ„å’Œç”Ÿæˆæ ‘çš„æ—¶é—´å¹¶ä¸ä¼šå¤ªçŸ­ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>6.å½“é“¾è¡¨çš„å€¼å°äº6åˆ™ä¼šä»çº¢é»‘æ ‘è½¬å›é“¾è¡¨</strong> </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å°äºè¿™ä¸ªå€¼æ—¶æ ‘è½¬é“¾è¡¨</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> UNTREEIFY_THRESHOLD = <span class="number">6</span>;</span><br></pre></td></tr></table></figure>

<p>7.å½“Mapé‡Œé¢çš„æ•°é‡è¶…è¿‡è¿™ä¸ªå€¼æ—¶ï¼Œè¡¨ä¸­çš„æ¡¶æ‰èƒ½è¿›è¡Œæ ‘å½¢åŒ– ï¼Œå¦åˆ™æ¡¶å†…å…ƒç´ å¤ªå¤šæ—¶ä¼šæ‰©å®¹ï¼Œè€Œä¸æ˜¯æ ‘å½¢åŒ– ä¸ºäº†é¿å…è¿›è¡Œæ‰©å®¹ã€æ ‘å½¢åŒ–é€‰æ‹©çš„å†²çªï¼Œè¿™ä¸ªå€¼ä¸èƒ½å°äº 4 * TREEIFY_THRESHOLD (8)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ¡¶ä¸­ç»“æ„è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯¹åº”çš„æ•°ç»„é•¿åº¦æœ€å°çš„å€¼ </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MIN_TREEIFY_CAPACITY = <span class="number">64</span>;</span><br></pre></td></tr></table></figure>

<p><strong>8ã€tableç”¨æ¥åˆå§‹åŒ–(å¿…é¡»æ˜¯äºŒçš„næ¬¡å¹‚)(é‡ç‚¹)</strong> </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å­˜å‚¨å…ƒç´ çš„æ•°ç»„ </span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br></pre></td></tr></table></figure>

<p><strong>table</strong>åœ¨JDK1.8ä¸­æˆ‘ä»¬äº†è§£åˆ°HashMapæ˜¯ç”±æ•°ç»„åŠ é“¾è¡¨åŠ çº¢é»‘æ ‘æ¥ç»„æˆçš„ç»“æ„å…¶ä¸­tableå°±æ˜¯HashMapä¸­çš„æ•°ç»„ï¼Œjdk8ä¹‹å‰æ•°ç»„ç±»å‹æ˜¯Entry&lt;K,V&gt;ç±»å‹ã€‚ä»jdk1.8ä¹‹åæ˜¯Node&lt;K,V&gt;ç±»å‹ã€‚åªæ˜¯æ¢äº†ä¸ªåå­—ï¼Œéƒ½å®ç°äº†ä¸€æ ·çš„æ¥å£ï¼šMap.Entry&lt;K,V&gt;ã€‚è´Ÿè´£å­˜å‚¨é”®å€¼å¯¹æ•°æ®çš„ã€‚</p>
<p>9ã€ç”¨æ¥å­˜æ”¾ç¼“å­˜ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å­˜æ”¾å…·ä½“å…ƒç´ çš„é›†åˆ</span></span><br><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span><br></pre></td></tr></table></figure>

<p><strong>10ã€ HashMapä¸­å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°(é‡ç‚¹)</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°ï¼Œæ³¨æ„è¿™ä¸ªä¸ç­‰äºæ•°ç»„çš„é•¿åº¦ã€‚</span></span><br><span class="line"> <span class="keyword">transient</span> <span class="keyword">int</span> size;</span><br></pre></td></tr></table></figure>

<p><strong>size</strong>ä¸ºHashMapä¸­K-Vçš„å®æ—¶æ•°é‡ï¼Œä¸æ˜¯æ•°ç»„tableçš„é•¿åº¦ã€‚</p>
<p>11ã€ ç”¨æ¥è®°å½•HashMapçš„ä¿®æ”¹æ¬¡æ•° </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¯æ¬¡æ‰©å®¹å’Œæ›´æ”¹mapç»“æ„çš„è®¡æ•°å™¨</span></span><br><span class="line"> <span class="keyword">transient</span> <span class="keyword">int</span> modCount;  </span><br></pre></td></tr></table></figure>

<p>12ã€ ç”¨æ¥è°ƒæ•´å¤§å°ä¸‹ä¸€ä¸ªå®¹é‡çš„å€¼è®¡ç®—æ–¹å¼ä¸º(å®¹é‡*è´Ÿè½½å› å­) </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸´ç•Œå€¼ å½“å®é™…å¤§å°(å®¹é‡*è´Ÿè½½å› å­)è¶…è¿‡ä¸´ç•Œå€¼æ—¶ï¼Œä¼šè¿›è¡Œæ‰©å®¹</span></span><br><span class="line"><span class="keyword">int</span> threshold;</span><br></pre></td></tr></table></figure>

<p><strong>13ã€ å“ˆå¸Œè¡¨çš„åŠ è½½å› å­(é‡ç‚¹)</strong> </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½å› å­</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span> loadFactor;</span><br></pre></td></tr></table></figure>

<p><strong>è¯´æ˜ï¼š</strong></p>
<p>1.<strong>loadFactor</strong>åŠ è½½å› å­ï¼Œæ˜¯ç”¨æ¥è¡¡é‡ HashMap æ»¡çš„ç¨‹åº¦ï¼Œ<strong>è¡¨ç¤ºHashMapçš„ç–å¯†ç¨‹åº¦ï¼Œå½±å“hashæ“ä½œåˆ°åŒä¸€ä¸ªæ•°ç»„ä½ç½®çš„æ¦‚ç‡</strong>ï¼Œè®¡ç®—HashMapçš„å®æ—¶åŠ è½½å› å­çš„æ–¹æ³•ä¸ºï¼šsize/capacityï¼Œè€Œä¸æ˜¯å ç”¨æ¡¶çš„æ•°é‡å»é™¤ä»¥capacityã€‚capacity æ˜¯æ¡¶çš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯ table çš„é•¿åº¦lengthã€‚</p>
<p><strong>loadFactorå¤ªå¤§å¯¼è‡´æŸ¥æ‰¾å…ƒç´ æ•ˆç‡ä½ï¼Œå¤ªå°å¯¼è‡´æ•°ç»„çš„åˆ©ç”¨ç‡ä½ï¼Œå­˜æ”¾çš„æ•°æ®ä¼šå¾ˆåˆ†æ•£ã€‚loadFactorçš„é»˜è®¤å€¼ä¸º0.75fæ˜¯å®˜æ–¹ç»™å‡ºçš„ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¸´ç•Œå€¼</strong>ã€‚</p>
<p><strong>å½“HashMapé‡Œé¢å®¹çº³çš„å…ƒç´ å·²ç»è¾¾åˆ°HashMapæ•°ç»„é•¿åº¦çš„75%æ—¶ï¼Œè¡¨ç¤ºHashMapå¤ªæŒ¤äº†ï¼Œéœ€è¦æ‰©å®¹ï¼Œè€Œæ‰©å®¹è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° rehashã€å¤åˆ¶æ•°æ®ç­‰æ“ä½œï¼Œéå¸¸æ¶ˆè€—æ€§èƒ½ã€‚ï¼Œæ‰€ä»¥å¼€å‘ä¸­å°½é‡å‡å°‘æ‰©å®¹çš„æ¬¡æ•°ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºHashMapé›†åˆå¯¹è±¡æ—¶æŒ‡å®šåˆå§‹å®¹é‡æ¥å°½é‡é¿å…ã€‚</strong></p>
<p><strong>åŒæ—¶åœ¨HashMapçš„æ„é€ å™¨ä¸­å¯ä»¥å®šåˆ¶loadFactorã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">æ„é€ æ–¹æ³•ï¼š</span><br><span class="line">HashMap(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor) æ„é€ ä¸€ä¸ªå¸¦æŒ‡å®šåˆå§‹å®¹é‡å’ŒåŠ è½½å› å­çš„ç©º HashMapã€‚</span><br></pre></td></tr></table></figure>



<p>2.ä¸ºä»€ä¹ˆåŠ è½½å› å­è®¾ç½®ä¸º0.75,åˆå§‹åŒ–ä¸´ç•Œå€¼æ˜¯12ï¼Ÿ</p>
<p>loadFactorè¶Šè¶‹è¿‘äº1ï¼Œé‚£ä¹ˆ æ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå¤šï¼Œä¹Ÿå°±è¶Šå¯†ï¼Œä¹Ÿå°±æ˜¯ä¼šè®©é“¾è¡¨çš„é•¿åº¦å¢åŠ ï¼ŒloadFactorè¶Šå°ï¼Œä¹Ÿå°±æ˜¯è¶‹è¿‘äº0ï¼Œæ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå°‘ï¼Œä¹Ÿå°±è¶Šç¨€ç–ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191115173553375.png" alt="image-20191115173553375"></p>
<p>å¦‚æœå¸Œæœ›é“¾è¡¨å°½å¯èƒ½å°‘äº›ã€‚è¦æå‰æ‰©å®¹ï¼Œæœ‰çš„æ•°ç»„ç©ºé—´æœ‰å¯èƒ½ä¸€ç›´æ²¡æœ‰å­˜å‚¨æ•°æ®ã€‚åŠ è½½å› å­å°½å¯èƒ½å°ä¸€äº›ã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚ï¼šåŠ è½½å› å­æ˜¯<span class="number">0.4</span>ã€‚ é‚£ä¹ˆ<span class="number">16</span>*<span class="number">0.4</span><span class="comment">---&gt;6 å¦‚æœæ•°ç»„ä¸­æ»¡6ä¸ªç©ºé—´å°±æ‰©å®¹ä¼šé€ æˆæ•°ç»„åˆ©ç”¨ç‡å¤ªä½äº†ã€‚</span></span><br><span class="line">	 åŠ è½½å› å­æ˜¯<span class="number">0.9</span>ã€‚ é‚£ä¹ˆ<span class="number">16</span>*<span class="number">0.9</span><span class="comment">----&gt;14 é‚£ä¹ˆè¿™æ ·å°±ä¼šå¯¼è‡´é“¾è¡¨æœ‰ç‚¹å¤šäº†ã€‚å¯¼è‡´æŸ¥æ‰¾å…ƒç´ æ•ˆç‡ä½ã€‚</span></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ—¢å…¼é¡¾æ•°ç»„åˆ©ç”¨ç‡åˆè€ƒè™‘é“¾è¡¨ä¸è¦å¤ªå¤šï¼Œç»è¿‡å¤§é‡æµ‹è¯•0.75æ˜¯æœ€ä½³æ–¹æ¡ˆã€‚</p>
<ul>
<li><strong>threshold</strong>è®¡ç®—å…¬å¼ï¼šcapacity(æ•°ç»„é•¿åº¦é»˜è®¤16) * loadFactor(è´Ÿè½½å› å­é»˜è®¤0.75)ã€‚è¿™ä¸ªå€¼æ˜¯å½“å‰å·²å ç”¨æ•°ç»„é•¿åº¦çš„æœ€å¤§å€¼ã€‚<strong>å½“Size&gt;=threshold</strong>çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±è¦è€ƒè™‘å¯¹æ•°ç»„çš„resize(æ‰©å®¹)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªçš„æ„æ€å°±æ˜¯ <strong>è¡¡é‡æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å¢çš„ä¸€ä¸ªæ ‡å‡†</strong>ã€‚ æ‰©å®¹åçš„ HashMap å®¹é‡æ˜¯ä¹‹å‰å®¹é‡çš„ä¸¤å€.</li>
</ul>
<h3 id="4-2æ„é€ æ–¹æ³•"><a href="#4-2æ„é€ æ–¹æ³•" class="headerlink" title="4.2æ„é€ æ–¹æ³•"></a>4.2æ„é€ æ–¹æ³•</h3><p> HashMap ä¸­é‡è¦çš„æ„é€ æ–¹æ³•ï¼Œå®ƒä»¬åˆ†åˆ«å¦‚ä¸‹ï¼š </p>
<p>1ã€æ„é€ ä¸€ä¸ªç©ºçš„ <code>HashMap</code> ï¼Œé»˜è®¤åˆå§‹å®¹é‡ï¼ˆ16ï¼‰å’Œé»˜è®¤è´Ÿè½½å› å­ï¼ˆ0.75ï¼‰ã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// å°†é»˜è®¤çš„åŠ è½½å› å­0.75èµ‹å€¼ç»™loadFactorï¼Œå¹¶æ²¡æœ‰åˆ›å»ºæ•°ç»„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€ æ„é€ ä¸€ä¸ªå…·æœ‰æŒ‡å®šçš„åˆå§‹å®¹é‡å’Œé»˜è®¤è´Ÿè½½å› å­ï¼ˆ0.75ï¼‰ <code>HashMap</code>ã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ„é€ å‡½æ•°</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>3ã€ æ„é€ ä¸€ä¸ªå…·æœ‰æŒ‡å®šçš„åˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­çš„ <code>HashMap</code>ã€‚æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	 æŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œåŠ è½½å› å­â€çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">	 initialCapacity: æŒ‡å®šçš„å®¹é‡</span></span><br><span class="line"><span class="comment">	 loadFactor:æŒ‡å®šçš„åŠ è½½å› å­</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    	<span class="comment">//åˆ¤æ–­åˆå§‹åŒ–å®¹é‡initialCapacityæ˜¯å¦å°äº0</span></span><br><span class="line">        <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="comment">//å¦‚æœå°äº0ï¼Œåˆ™æŠ›å‡ºéæ³•çš„å‚æ•°å¼‚å¸¸IllegalArgumentException</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal initial capacity: &quot;</span> +</span><br><span class="line">                                               initialCapacity);</span><br><span class="line">    	<span class="comment">//åˆ¤æ–­åˆå§‹åŒ–å®¹é‡initialCapacityæ˜¯å¦å¤§äºé›†åˆçš„æœ€å¤§å®¹é‡MAXIMUM_CAPACITY-ã€‹2çš„30æ¬¡å¹‚</span></span><br><span class="line">        <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">            <span class="comment">//å¦‚æœè¶…è¿‡MAXIMUM_CAPACITYï¼Œä¼šå°†MAXIMUM_CAPACITYèµ‹å€¼ç»™initialCapacity</span></span><br><span class="line">            initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    	<span class="comment">//åˆ¤æ–­è´Ÿè½½å› å­loadFactoræ˜¯å¦å°äºç­‰äº0æˆ–è€…æ˜¯å¦æ˜¯ä¸€ä¸ªéæ•°å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">            <span class="comment">//å¦‚æœæ»¡è¶³ä¸Šè¿°å…¶ä¸­ä¹‹ä¸€ï¼Œåˆ™æŠ›å‡ºéæ³•çš„å‚æ•°å¼‚å¸¸IllegalArgumentException</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal load factor: &quot;</span> +</span><br><span class="line">                                               loadFactor);</span><br><span class="line">     	<span class="comment">//å°†æŒ‡å®šçš„åŠ è½½å› å­èµ‹å€¼ç»™HashMapæˆå‘˜å˜é‡çš„è´Ÿè½½å› å­loadFactor</span></span><br><span class="line">        <span class="keyword">this</span>.loadFactor = loadFactor;</span><br><span class="line">    	<span class="comment">/*</span></span><br><span class="line"><span class="comment">    		tableSizeFor(initialCapacity) åˆ¤æ–­æŒ‡å®šçš„åˆå§‹åŒ–å®¹é‡æ˜¯å¦æ˜¯2çš„næ¬¡å¹‚ï¼Œå¦‚æœä¸æ˜¯é‚£ä¹ˆä¼šå˜ä¸ºæ¯”æŒ‡			å®šåˆå§‹åŒ–å®¹é‡å¤§çš„æœ€å°çš„2çš„næ¬¡å¹‚ã€‚è¿™ç‚¹ä¸Šè¿°å·²ç»è®²è§£è¿‡ã€‚</span></span><br><span class="line"><span class="comment">    		ä½†æ˜¯æ³¨æ„ï¼Œåœ¨tableSizeForæ–¹æ³•ä½“å†…éƒ¨å°†è®¡ç®—åçš„æ•°æ®è¿”å›ç»™è°ƒç”¨è¿™é‡Œäº†ï¼Œå¹¶ä¸”ç›´æ¥èµ‹å€¼ç»™thresholdè¾¹			ç•Œå€¼äº†ã€‚æœ‰äº›äººä¼šè§‰å¾—è¿™é‡Œæ˜¯ä¸€ä¸ªbug,åº”è¯¥è¿™æ ·ä¹¦å†™ï¼š</span></span><br><span class="line"><span class="comment">    		this.threshold = tableSizeFor(initialCapacity) * this.loadFactor;</span></span><br><span class="line"><span class="comment">    		è¿™æ ·æ‰ç¬¦åˆthresholdçš„æ„æ€ï¼ˆå½“HashMapçš„sizeåˆ°è¾¾thresholdè¿™ä¸ªé˜ˆå€¼æ—¶ä¼šæ‰©å®¹ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">			ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œåœ¨jdk8ä»¥åçš„æ„é€ æ–¹æ³•ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹tableè¿™ä¸ªæˆå‘˜å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œtableçš„åˆå§‹åŒ–è¢«æ¨			 è¿Ÿåˆ°äº†putæ–¹æ³•ä¸­ï¼Œåœ¨putæ–¹æ³•ä¸­ä¼šå¯¹thresholdé‡æ–°è®¡ç®—ï¼Œputæ–¹æ³•çš„å…·ä½“å®ç°æˆ‘ä»¬ä¸‹é¢ä¼šè¿›è¡Œè®²è§£</span></span><br><span class="line"><span class="comment">    	*/</span></span><br><span class="line">        <span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">æœ€åè°ƒç”¨äº†tableSizeForï¼Œæ¥çœ‹ä¸€ä¸‹æ–¹æ³•å®ç°ï¼š</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a power of two size for the given target capacity.</span></span><br><span class="line"><span class="comment">       è¿”å›æ¯”æŒ‡å®šåˆå§‹åŒ–å®¹é‡å¤§çš„æœ€å°çš„2çš„næ¬¡å¹‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">tableSizeFor</span><span class="params">(<span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cap - <span class="number">1</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">8</span>;</span><br><span class="line">        n |= n &gt;&gt;&gt; <span class="number">16</span>;</span><br><span class="line">        <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ? <span class="number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<p>å¯¹äº this.threshold = tableSizeFor(initialCapacity); ç–‘é—®è§£ç­”ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">tableSizeFor(initialCapacity) åˆ¤æ–­æŒ‡å®šçš„åˆå§‹åŒ–å®¹é‡æ˜¯å¦æ˜¯<span class="number">2</span>çš„næ¬¡å¹‚ï¼Œå¦‚æœä¸æ˜¯é‚£ä¹ˆä¼šå˜ä¸ºæ¯”æŒ‡			å®šåˆå§‹åŒ–å®¹é‡å¤§çš„æœ€å°çš„<span class="number">2</span>çš„næ¬¡å¹‚ã€‚è¿™ç‚¹ä¸Šè¿°å·²ç»è®²è§£è¿‡ã€‚</span><br><span class="line">ä½†æ˜¯æ³¨æ„ï¼Œåœ¨tableSizeForæ–¹æ³•ä½“å†…éƒ¨å°†è®¡ç®—åçš„æ•°æ®è¿”å›ç»™è°ƒç”¨è¿™é‡Œäº†ï¼Œå¹¶ä¸”ç›´æ¥èµ‹å€¼ç»™thresholdè¾¹			ç•Œå€¼äº†ã€‚æœ‰äº›äººä¼šè§‰å¾—è¿™é‡Œæ˜¯ä¸€ä¸ªbug,åº”è¯¥è¿™æ ·ä¹¦å†™ï¼š</span><br><span class="line"><span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity) * <span class="keyword">this</span>.loadFactor;</span><br><span class="line">è¿™æ ·æ‰ç¬¦åˆthresholdçš„æ„æ€ï¼ˆå½“HashMapçš„sizeåˆ°è¾¾thresholdè¿™ä¸ªé˜ˆå€¼æ—¶ä¼šæ‰©å®¹ï¼‰ã€‚</span><br><span class="line">ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œåœ¨jdk8ä»¥åçš„æ„é€ æ–¹æ³•ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹tableè¿™ä¸ªæˆå‘˜å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œtableçš„åˆå§‹åŒ–è¢«æ¨			 è¿Ÿåˆ°äº†putæ–¹æ³•ä¸­ï¼Œåœ¨putæ–¹æ³•ä¸­ä¼šå¯¹thresholdé‡æ–°è®¡ç®—ï¼Œputæ–¹æ³•çš„å…·ä½“å®ç°æˆ‘ä»¬ä¸‹é¢ä¼šè¿›è¡Œè®²è§£</span><br></pre></td></tr></table></figure>

<p>4ã€åŒ…å«å¦ä¸€ä¸ªâ€œMapâ€çš„æ„é€ å‡½æ•° </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ„é€ ä¸€ä¸ªæ˜ å°„å…³ç³»ä¸æŒ‡å®š Map ç›¸åŒçš„æ–° HashMapã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span> </span>&#123;</span><br><span class="line">    	<span class="comment">//è´Ÿè½½å› å­loadFactorå˜ä¸ºé»˜è®¤çš„è´Ÿè½½å› å­0.75</span></span><br><span class="line">         <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;</span><br><span class="line">         putMapEntries(m, <span class="keyword">false</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åè°ƒç”¨äº†putMapEntriesï¼Œæ¥çœ‹ä¸€ä¸‹æ–¹æ³•å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">putMapEntries</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m, <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·å–å‚æ•°é›†åˆçš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">int</span> s = m.size();</span><br><span class="line">    <span class="keyword">if</span> (s &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­å‚æ•°é›†åˆçš„é•¿åº¦æ˜¯å¦å¤§äº0ï¼Œè¯´æ˜å¤§äº0</span></span><br><span class="line">        <span class="keyword">if</span> (table == <span class="keyword">null</span>)  <span class="comment">// åˆ¤æ–­tableæ˜¯å¦å·²ç»åˆå§‹åŒ–</span></span><br><span class="line">        &#123; <span class="comment">// pre-size</span></span><br><span class="line">                <span class="comment">// æœªåˆå§‹åŒ–ï¼Œsä¸ºmçš„å®é™…å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">                <span class="keyword">float</span> ft = ((<span class="keyword">float</span>)s / loadFactor) + <span class="number">1.0F</span>;</span><br><span class="line">                <span class="keyword">int</span> t = ((ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY) ?</span><br><span class="line">                        (<span class="keyword">int</span>)ft : MAXIMUM_CAPACITY);</span><br><span class="line">                <span class="comment">// è®¡ç®—å¾—åˆ°çš„tå¤§äºé˜ˆå€¼ï¼Œåˆ™åˆå§‹åŒ–é˜ˆå€¼</span></span><br><span class="line">                <span class="keyword">if</span> (t &gt; threshold)</span><br><span class="line">                    threshold = tableSizeFor(t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å·²åˆå§‹åŒ–ï¼Œå¹¶ä¸”må…ƒç´ ä¸ªæ•°å¤§äºé˜ˆå€¼ï¼Œè¿›è¡Œæ‰©å®¹å¤„ç†</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s &gt; threshold)</span><br><span class="line">            resize();</span><br><span class="line">        <span class="comment">// å°†mä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³HashMapä¸­</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;? extends K, ? extends V&gt; e : m.entrySet()) &#123;</span><br><span class="line">            K key = e.getKey();</span><br><span class="line">            V value = e.getValue();</span><br><span class="line">            putVal(hash(key), key, value, <span class="keyword">false</span>, evict);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š</p>
<p> float ft = ((float)s / loadFactor) + 1.0F;è¿™ä¸€è¡Œä»£ç ä¸­ä¸ºä»€ä¹ˆè¦åŠ 1.0F ï¼Ÿ</p>
<p> s/loadFactorçš„ç»“æœæ˜¯å°æ•°ï¼ŒåŠ 1.0Fä¸(int)ftç›¸å½“äºæ˜¯å¯¹å°æ•°åšä¸€ä¸ªå‘ä¸Šå–æ•´ä»¥å°½å¯èƒ½çš„ä¿è¯æ›´å¤§å®¹é‡ï¼Œæ›´å¤§çš„å®¹é‡èƒ½å¤Ÿå‡å°‘resizeçš„è°ƒç”¨æ¬¡æ•°ã€‚æ‰€ä»¥ + 1.0Fæ˜¯ä¸ºäº†è·å–æ›´å¤§çš„å®¹é‡ã€‚ </p>
<p>ä¾‹å¦‚ï¼šåŸæ¥é›†åˆçš„å…ƒç´ ä¸ªæ•°æ˜¯6ä¸ªï¼Œé‚£ä¹ˆ6/0.75æ˜¯8ï¼Œæ˜¯2çš„næ¬¡å¹‚ï¼Œé‚£ä¹ˆæ–°çš„æ•°ç»„å¤§å°å°±æ˜¯8äº†ã€‚ç„¶ååŸæ¥æ•°ç»„çš„æ•°æ®å°±ä¼šå­˜å‚¨åˆ°é•¿åº¦æ˜¯8çš„æ–°çš„æ•°ç»„ä¸­äº†ï¼Œè¿™æ ·ä¼šå¯¼è‡´åœ¨å­˜å‚¨å…ƒç´ çš„æ—¶å€™ï¼Œå®¹é‡ä¸å¤Ÿï¼Œè¿˜å¾—ç»§ç»­æ‰©å®¹ï¼Œé‚£ä¹ˆæ€§èƒ½é™ä½äº†ï¼Œè€Œå¦‚æœ+1å‘¢ï¼Œæ•°ç»„é•¿åº¦ç›´æ¥å˜ä¸º16äº†ï¼Œè¿™æ ·å¯ä»¥å‡å°‘æ•°ç»„çš„æ‰©å®¹ã€‚</p>
<h3 id="4-3æˆå‘˜æ–¹æ³•"><a href="#4-3æˆå‘˜æ–¹æ³•" class="headerlink" title="4.3æˆå‘˜æ–¹æ³•"></a>4.3æˆå‘˜æ–¹æ³•</h3><h4 id="4-3-1å¢åŠ æ–¹æ³•"><a href="#4-3-1å¢åŠ æ–¹æ³•" class="headerlink" title="4.3.1å¢åŠ æ–¹æ³•"></a>4.3.1å¢åŠ æ–¹æ³•</h4><p>putæ–¹æ³•æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå®ç°æ­¥éª¤å¤§è‡´å¦‚ä¸‹ï¼š</p>
<p>1ï¼‰å…ˆé€šè¿‡hashå€¼è®¡ç®—å‡ºkeyæ˜ å°„åˆ°å“ªä¸ªæ¡¶ï¼›</p>
<p>2ï¼‰å¦‚æœæ¡¶ä¸Šæ²¡æœ‰ç¢°æ’å†²çªï¼Œåˆ™ç›´æ¥æ’å…¥ï¼›</p>
<p>3ï¼‰å¦‚æœå‡ºç°ç¢°æ’å†²çªäº†ï¼Œåˆ™éœ€è¦å¤„ç†å†²çªï¼š</p>
<p>â€‹    a:å¦‚æœè¯¥æ¡¶ä½¿ç”¨çº¢é»‘æ ‘å¤„ç†å†²çªï¼Œåˆ™è°ƒç”¨çº¢é»‘æ ‘çš„æ–¹æ³•æ’å…¥æ•°æ®ï¼›</p>
<p>â€‹    b:å¦åˆ™é‡‡ç”¨ä¼ ç»Ÿçš„é“¾å¼æ–¹æ³•æ’å…¥ã€‚å¦‚æœé“¾çš„é•¿åº¦è¾¾åˆ°ä¸´ç•Œå€¼ï¼Œåˆ™æŠŠé“¾è½¬å˜ä¸ºçº¢é»‘æ ‘ï¼›</p>
<p>4ï¼‰å¦‚æœæ¡¶ä¸­å­˜åœ¨é‡å¤çš„é”®ï¼Œåˆ™ä¸ºè¯¥é”®æ›¿æ¢æ–°å€¼valueï¼›</p>
<p>5ï¼‰å¦‚æœsizeå¤§äºé˜ˆå€¼thresholdï¼Œåˆ™è¿›è¡Œæ‰©å®¹ï¼›</p>
<p>å…·ä½“çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š </p>
<p>â€‹    1ï¼‰HashMapåªæä¾›äº†putç”¨äºæ·»åŠ å…ƒç´ ï¼ŒputValæ–¹æ³•åªæ˜¯ç»™putæ–¹æ³•è°ƒç”¨çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶æ²¡æœ‰æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚ æ‰€ä»¥æˆ‘ä»¬é‡ç‚¹çœ‹putValæ–¹æ³•ã€‚</p>
<pre><code> 2ï¼‰æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨putVal()æ–¹æ³•ä¸­keyåœ¨è¿™é‡Œæ‰§è¡Œäº†ä¸€ä¸‹hash()æ–¹æ³•,æ¥çœ‹ä¸€ä¸‹Hashæ–¹æ³•æ˜¯å¦‚ä½•å®ç°çš„ã€‚ 
</code></pre>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">       <span class="keyword">int</span> h;</span><br><span class="line">    	<span class="comment">/*</span></span><br><span class="line"><span class="comment">    		1ï¼‰å¦‚æœkeyç­‰äºnullï¼š</span></span><br><span class="line"><span class="comment">    			å¯ä»¥çœ‹åˆ°å½“keyç­‰äºnullçš„æ—¶å€™ä¹Ÿæ˜¯æœ‰å“ˆå¸Œå€¼çš„ï¼Œè¿”å›çš„æ˜¯0.</span></span><br><span class="line"><span class="comment">    		2ï¼‰å¦‚æœkeyä¸ç­‰äºnullï¼š</span></span><br><span class="line"><span class="comment">    			é¦–å…ˆè®¡ç®—å‡ºkeyçš„hashCodeèµ‹å€¼ç»™h,ç„¶åä¸hæ— ç¬¦å·å³ç§»16ä½åçš„äºŒè¿›åˆ¶è¿›è¡ŒæŒ‰ä½å¼‚æˆ–å¾—åˆ°æœ€åçš„					hashå€¼</span></span><br><span class="line"><span class="comment">    	*/</span></span><br><span class="line">       <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»ä¸Šé¢å¯ä»¥å¾—çŸ¥HashMapæ˜¯æ”¯æŒKeyä¸ºç©ºçš„ï¼Œè€ŒHashTableæ˜¯ç›´æ¥ç”¨Keyæ¥è·å–HashCodeæ‰€ä»¥keyä¸ºç©ºä¼šæŠ›å¼‚å¸¸ã€‚</p>
<p>{å…¶å®ä¸Šé¢å°±å·²ç»è§£é‡Šäº†ä¸ºä»€ä¹ˆHashMapçš„é•¿åº¦<strong>ä¸ºä»€ä¹ˆè¦æ˜¯2çš„å¹‚</strong>å› ä¸ºHashMap ä½¿ç”¨çš„æ–¹æ³•å¾ˆå·§å¦™ï¼Œå®ƒé€šè¿‡ hash &amp; (table.length -1)æ¥å¾—åˆ°è¯¥å¯¹è±¡çš„ä¿å­˜ä½ï¼Œå‰é¢è¯´è¿‡ HashMap åº•å±‚æ•°ç»„çš„é•¿åº¦æ€»æ˜¯2çš„næ¬¡æ–¹ï¼Œè¿™æ˜¯HashMapåœ¨é€Ÿåº¦ä¸Šçš„ä¼˜åŒ–ã€‚å½“ length æ€»æ˜¯2çš„næ¬¡æ–¹æ—¶ï¼Œhash &amp; (length-1)è¿ç®—ç­‰ä»·äºå¯¹ length å–æ¨¡ï¼Œä¹Ÿå°±æ˜¯hash%lengthï¼Œä½†æ˜¯&amp;æ¯”%å…·æœ‰æ›´é«˜çš„æ•ˆç‡ã€‚æ¯”å¦‚ n % 32 = n &amp; (32 -1)ã€‚}</p>
<p><strong>è§£è¯»ä¸Šè¿°hashæ–¹æ³•ï¼š</strong></p>
<p>æˆ‘ä»¬å…ˆç ”ç©¶ä¸‹keyçš„å“ˆå¸Œå€¼æ˜¯å¦‚ä½•è®¡ç®—å‡ºæ¥çš„ã€‚keyçš„å“ˆå¸Œå€¼æ˜¯é€šè¿‡ä¸Šè¿°æ–¹æ³•è®¡ç®—å‡ºæ¥çš„ã€‚</p>
<p>è¿™ä¸ªå“ˆå¸Œæ–¹æ³•é¦–å…ˆè®¡ç®—å‡ºkeyçš„hashCodeèµ‹å€¼ç»™h,ç„¶åä¸hæ— ç¬¦å·å³ç§»16ä½åçš„äºŒè¿›åˆ¶è¿›è¡ŒæŒ‰ä½å¼‚æˆ–å¾—åˆ°æœ€åçš„    hashå€¼ã€‚è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">       <span class="keyword">int</span> h;</span><br><span class="line">    	<span class="comment">/*</span></span><br><span class="line"><span class="comment">    		1ï¼‰å¦‚æœkeyç­‰äºnullï¼š</span></span><br><span class="line"><span class="comment">    			å¯ä»¥çœ‹åˆ°å½“keyç­‰äºnullçš„æ—¶å€™ä¹Ÿæ˜¯æœ‰å“ˆå¸Œå€¼çš„ï¼Œè¿”å›çš„æ˜¯0.</span></span><br><span class="line"><span class="comment">    		2ï¼‰å¦‚æœkeyä¸ç­‰äºnullï¼š</span></span><br><span class="line"><span class="comment">    			é¦–å…ˆè®¡ç®—å‡ºkeyçš„hashCodeèµ‹å€¼ç»™h,ç„¶åä¸hæ— ç¬¦å·å³ç§»16ä½åçš„äºŒè¿›åˆ¶è¿›è¡ŒæŒ‰ä½å¼‚æˆ–å¾—åˆ°æœ€åçš„					hashå€¼</span></span><br><span class="line"><span class="comment">    	*/</span></span><br><span class="line">       <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨putValå‡½æ•°ä¸­ä½¿ç”¨åˆ°äº†ä¸Šè¿°hashå‡½æ•°è®¡ç®—çš„å“ˆå¸Œå€¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">                   <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">        <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)<span class="comment">//è¿™é‡Œçš„nè¡¨ç¤ºæ•°ç»„é•¿åº¦16</span></span><br><span class="line">       ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>â€‹    è¯´æ˜ï¼š</p>
<p>â€‹        1ï¼‰key.hashCode()ï¼›è¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcodeã€‚å‡è®¾éšä¾¿ç”Ÿæˆçš„ä¸€ä¸ªå€¼ã€‚</p>
<p>â€‹        2ï¼‰nè¡¨ç¤ºæ•°ç»„åˆå§‹åŒ–çš„é•¿åº¦æ˜¯16</p>
<p>â€‹        3ï¼‰&amp;ï¼ˆæŒ‰ä½ä¸è¿ç®—ï¼‰ï¼šè¿ç®—è§„åˆ™ï¼šç›¸åŒçš„äºŒè¿›åˆ¶æ•°ä½ä¸Šï¼Œéƒ½æ˜¯1çš„æ—¶å€™ï¼Œç»“æœä¸º1ï¼Œå¦åˆ™ä¸ºé›¶ã€‚</p>
<p>â€‹        4ï¼‰^ï¼ˆæŒ‰ä½å¼‚æˆ–è¿ç®—ï¼‰ï¼šè¿ç®—è§„åˆ™ï¼šç›¸åŒçš„äºŒè¿›åˆ¶æ•°ä½ä¸Šï¼Œæ•°å­—ç›¸åŒï¼Œç»“æœä¸º0ï¼Œä¸åŒä¸º1ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191114193730911.png" alt="image-20191114193730911"></p>
<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>
<ul>
<li><p>é«˜16 bit ä¸å˜ï¼Œä½16 bit å’Œé«˜16 bit åšäº†ä¸€ä¸ªå¼‚æˆ–ï¼ˆå¾—åˆ°çš„ hashcode è½¬åŒ–ä¸º32ä½äºŒè¿›åˆ¶ï¼Œå‰16ä½å’Œå16ä½ä½16 bitå’Œé«˜16 bitåšäº†ä¸€ä¸ªå¼‚æˆ–ï¼‰</p>
<p><strong>é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦è¿™æ ·æ“ä½œå‘¢ï¼Ÿ</strong></p>
<p>å¦‚æœå½“nå³æ•°ç»„é•¿åº¦å¾ˆå°ï¼Œå‡è®¾æ˜¯16çš„è¯ï¼Œé‚£ä¹ˆn-1å³ä¸º  â€”ã€‹1111 ï¼Œè¿™æ ·çš„å€¼å’ŒhashCode()ç›´æ¥åšæŒ‰ä½ä¸æ“ä½œï¼Œå®é™…ä¸Šåªä½¿ç”¨äº†å“ˆå¸Œå€¼çš„å4ä½ã€‚å¦‚æœå½“å“ˆå¸Œå€¼çš„é«˜ä½å˜åŒ–å¾ˆå¤§ï¼Œä½ä½å˜åŒ–å¾ˆå°ï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“é€ æˆå“ˆå¸Œå†²çªäº†ï¼Œæ‰€ä»¥è¿™é‡ŒæŠŠé«˜ä½ä½éƒ½åˆ©ç”¨èµ·æ¥ï¼Œä»è€Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚ä¸Šè¿°ï¼š</span><br><span class="line">hashCode()å€¼ï¼š     <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">0000</span> <span class="number">1110</span> <span class="number">1010</span></span><br><span class="line">				&amp;</span><br><span class="line">n-<span class="number">1</span>å³<span class="number">16</span>-<span class="number">1</span>--ã€‹<span class="number">15</span>ï¼š  ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<span class="number">1111</span></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">				  <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">1010</span> ----ã€‹<span class="number">10</span>ä½œä¸ºç´¢å¼•</span><br><span class="line">å…¶å®å°±æ˜¯å°†hashCodeå€¼ä½œä¸ºæ•°ç»„ç´¢å¼•ï¼Œé‚£ä¹ˆå¦‚æœä¸‹ä¸ªé«˜ä½hashCodeä¸ä¸€è‡´ï¼Œä½ä½ä¸€è‡´çš„è¯ï¼Œå°±ä¼šé€ æˆè®¡ç®—çš„ç´¢å¼•è¿˜æ˜¯<span class="number">10</span>,ä»è€Œé€ æˆäº†å“ˆå¸Œå†²çªäº†ã€‚é™ä½æ€§èƒ½ã€‚</span><br></pre></td></tr></table></figure></li>
<li><p>(n-1) &amp; hash = -&gt; å¾—åˆ°ä¸‹æ ‡   (n-1)   nè¡¨ç¤ºæ•°ç»„é•¿åº¦16ï¼Œn-1å°±æ˜¯15</p>
</li>
<li><p>å–ä½™æ•°æœ¬è´¨æ˜¯ä¸æ–­åšé™¤æ³•ï¼ŒæŠŠå‰©ä½™çš„æ•°å‡å»ï¼Œè¿ç®—æ•ˆç‡è¦æ¯”ä½è¿ç®—ä½ã€‚</p>
</li>
</ul>
<p>ç°åœ¨çœ‹putVal()æ–¹æ³•ï¼Œçœ‹çœ‹å®ƒåˆ°åº•åšäº†ä»€ä¹ˆã€‚</p>
<p>ä¸»è¦å‚æ•°ï¼š</p>
<ul>
<li>hash keyçš„hashå€¼</li>
<li>key åŸå§‹Key</li>
<li>value è¦å­˜æ”¾çš„å€¼</li>
<li>onlyIfAbsent å¦‚æœtrueä»£è¡¨ä¸æ›´æ”¹ç°æœ‰çš„å€¼</li>
<li>evict å¦‚æœä¸ºfalseè¡¨ç¤ºtableä¸ºåˆ›å»ºçŠ¶æ€</li>
</ul>
<p>putVal()æ–¹æ³•æºä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">                   <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	1ï¼‰transient Node&lt;K,V&gt;[] table; è¡¨ç¤ºå­˜å‚¨Mapé›†åˆä¸­å…ƒç´ çš„æ•°ç»„ã€‚</span></span><br><span class="line"><span class="comment">    	2ï¼‰(tab = table) == null è¡¨ç¤ºå°†ç©ºçš„tableèµ‹å€¼ç»™tab,ç„¶ååˆ¤æ–­tabæ˜¯å¦ç­‰äºnullï¼Œç¬¬ä¸€æ¬¡è‚¯å®šæ˜¯			null</span></span><br><span class="line"><span class="comment">    	3ï¼‰(n = tab.length) == 0 è¡¨ç¤ºå°†æ•°ç»„çš„é•¿åº¦0èµ‹å€¼ç»™n,ç„¶ååˆ¤æ–­næ˜¯å¦ç­‰äº0ï¼Œnç­‰äº0</span></span><br><span class="line"><span class="comment">    	ç”±äºifåˆ¤æ–­ä½¿ç”¨åŒæˆ–ï¼Œæ»¡è¶³ä¸€ä¸ªå³å¯ï¼Œåˆ™æ‰§è¡Œä»£ç  n = (tab = resize()).length; è¿›è¡Œæ•°ç»„åˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="comment">    	å¹¶å°†åˆå§‹åŒ–å¥½çš„æ•°ç»„é•¿åº¦èµ‹å€¼ç»™n.</span></span><br><span class="line"><span class="comment">    	4ï¼‰æ‰§è¡Œå®Œn = (tab = resize()).lengthï¼Œæ•°ç»„tabæ¯ä¸ªç©ºé—´éƒ½æ˜¯null</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	1ï¼‰i = (n - 1) &amp; hash è¡¨ç¤ºè®¡ç®—æ•°ç»„çš„ç´¢å¼•èµ‹å€¼ç»™iï¼Œå³ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­</span></span><br><span class="line"><span class="comment">    	2ï¼‰p = tab[i = (n - 1) &amp; hash]è¡¨ç¤ºè·å–è®¡ç®—å‡ºçš„ä½ç½®çš„æ•°æ®èµ‹å€¼ç»™èŠ‚ç‚¹p</span></span><br><span class="line"><span class="comment">    	3) (p = tab[i = (n - 1) &amp; hash]) == null åˆ¤æ–­èŠ‚ç‚¹ä½ç½®æ˜¯å¦ç­‰äºnullï¼Œå¦‚æœä¸ºnullï¼Œåˆ™æ‰§è¡Œä»£			ç ï¼štab[i] = newNode(hash, key, value, null);æ ¹æ®é”®å€¼å¯¹åˆ›å»ºæ–°çš„èŠ‚ç‚¹æ”¾å…¥è¯¥ä½ç½®çš„æ¡¶ä¸­</span></span><br><span class="line"><span class="comment">        å°ç»“ï¼šå¦‚æœå½“å‰æ¡¶æ²¡æœ‰å“ˆå¸Œç¢°æ’å†²çªï¼Œåˆ™ç›´æ¥æŠŠé”®å€¼å¯¹æ’å…¥ç©ºé—´ä½ç½®</span></span><br><span class="line"><span class="comment">    */</span> </span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹å­˜å…¥åˆ°æ¡¶ä¸­</span></span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="comment">// æ‰§è¡Œelseè¯´æ˜tab[i]ä¸ç­‰äºnullï¼Œè¡¨ç¤ºè¿™ä¸ªä½ç½®å·²ç»æœ‰å€¼äº†ã€‚</span></span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	æ¯”è¾ƒæ¡¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ (æ•°ç»„ä¸­çš„ç»“ç‚¹)çš„hashå€¼å’Œkeyæ˜¯å¦ç›¸ç­‰</span></span><br><span class="line"><span class="comment">        	1ï¼‰p.hash == hash ï¼šp.hashè¡¨ç¤ºåŸæ¥å­˜åœ¨æ•°æ®çš„hashå€¼  hashè¡¨ç¤ºåæ·»åŠ æ•°æ®çš„hashå€¼ æ¯”è¾ƒä¸¤ä¸ª				 hashå€¼æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line"><span class="comment">                 è¯´æ˜ï¼špè¡¨ç¤ºtab[i]ï¼Œå³ newNode(hash, key, value, null)æ–¹æ³•è¿”å›çš„Nodeå¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment">                    Node&lt;K,V&gt; newNode(int hash, K key, V value, Node&lt;K,V&gt; next) </span></span><br><span class="line"><span class="comment">                    &#123;</span></span><br><span class="line"><span class="comment">                        return new Node&lt;&gt;(hash, key, value, next);</span></span><br><span class="line"><span class="comment">                    &#125;</span></span><br><span class="line"><span class="comment">                    è€Œåœ¨Nodeç±»ä¸­å…·æœ‰æˆå‘˜å˜é‡hashç”¨æ¥è®°å½•ç€ä¹‹å‰æ•°æ®çš„hashå€¼çš„</span></span><br><span class="line"><span class="comment">             2ï¼‰(k = p.key) == key ï¼šp.keyè·å–åŸæ¥æ•°æ®çš„keyèµ‹å€¼ç»™k  key è¡¨ç¤ºåæ·»åŠ æ•°æ®çš„key æ¯”è¾ƒä¸¤					ä¸ªkeyçš„åœ°å€å€¼æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line"><span class="comment">             3ï¼‰key != null &amp;&amp; key.equals(k)ï¼šèƒ½å¤Ÿæ‰§è¡Œåˆ°è¿™é‡Œè¯´æ˜ä¸¤ä¸ªkeyçš„åœ°å€å€¼ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆå…ˆåˆ¤æ–­å				æ·»åŠ çš„keyæ˜¯å¦ç­‰äºnullï¼Œå¦‚æœä¸ç­‰äºnullå†è°ƒç”¨equalsæ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªkeyçš„å†…å®¹æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                	è¯´æ˜ï¼šä¸¤ä¸ªå…ƒç´ å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå¹¶ä¸”keyçš„å€¼ä¹Ÿç›¸ç­‰</span></span><br><span class="line"><span class="comment">                	å°†æ—§çš„å…ƒç´ æ•´ä½“å¯¹è±¡èµ‹å€¼ç»™eï¼Œç”¨eæ¥è®°å½•</span></span><br><span class="line"><span class="comment">                */</span> </span><br><span class="line">                e = p;</span><br><span class="line">        <span class="comment">// hashå€¼ä¸ç›¸ç­‰æˆ–è€…keyä¸ç›¸ç­‰ï¼›åˆ¤æ–­pæ˜¯å¦ä¸ºçº¢é»‘æ ‘ç»“ç‚¹</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            <span class="comment">// æ”¾å…¥æ ‘ä¸­</span></span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="comment">// è¯´æ˜æ˜¯é“¾è¡¨èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            	1)å¦‚æœæ˜¯é“¾è¡¨çš„è¯éœ€è¦éå†åˆ°æœ€åèŠ‚ç‚¹ç„¶åæ’å…¥</span></span><br><span class="line"><span class="comment">            	2)é‡‡ç”¨å¾ªç¯éå†çš„æ–¹å¼ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰é‡å¤çš„key</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                	1)e = p.next è·å–pçš„ä¸‹ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™e</span></span><br><span class="line"><span class="comment">                	2)(e = p.next) == null åˆ¤æ–­p.nextæ˜¯å¦ç­‰äºnullï¼Œç­‰äºnullï¼Œè¯´æ˜pæ²¡æœ‰ä¸‹ä¸€ä¸ªå…ƒ					ç´ ï¼Œé‚£ä¹ˆæ­¤æ—¶åˆ°è¾¾äº†é“¾è¡¨çš„å°¾éƒ¨ï¼Œè¿˜æ²¡æœ‰æ‰¾åˆ°é‡å¤çš„key,åˆ™è¯´æ˜HashMapæ²¡æœ‰åŒ…å«è¯¥é”®</span></span><br><span class="line"><span class="comment">                	å°†è¯¥é”®å€¼å¯¹æ’å…¥é“¾è¡¨ä¸­</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    	1ï¼‰åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ’å…¥åˆ°å°¾éƒ¨</span></span><br><span class="line"><span class="comment">                    	 p.next = newNode(hash, key, value, null);</span></span><br><span class="line"><span class="comment">                    	 Node&lt;K,V&gt; newNode(int hash, K key, V value, Node&lt;K,V&gt; next) </span></span><br><span class="line"><span class="comment">                    	 &#123;</span></span><br><span class="line"><span class="comment">                                return new Node&lt;&gt;(hash, key, value, next);</span></span><br><span class="line"><span class="comment">                         &#125;</span></span><br><span class="line"><span class="comment">                         æ³¨æ„ç¬¬å››ä¸ªå‚æ•°nextæ˜¯nullï¼Œå› ä¸ºå½“å‰å…ƒç´ æ’å…¥åˆ°é“¾è¡¨æœ«å°¾äº†ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªèŠ‚ç‚¹è‚¯å®šæ˜¯								null</span></span><br><span class="line"><span class="comment">                         2ï¼‰è¿™ç§æ·»åŠ æ–¹å¼ä¹Ÿæ»¡è¶³é“¾è¡¨æ•°æ®ç»“æ„çš„ç‰¹ç‚¹ï¼Œæ¯æ¬¡å‘åæ·»åŠ æ–°çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    	1)èŠ‚ç‚¹æ·»åŠ å®Œæˆä¹‹ååˆ¤æ–­æ­¤æ—¶èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¦å¤§äºTREEIFY_THRESHOLDä¸´ç•Œå€¼8ï¼Œå¦‚æœå¤§äº</span></span><br><span class="line"><span class="comment">                    	åˆ™å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line"><span class="comment">                    	2ï¼‰int binCount = 0 ï¼šè¡¨ç¤ºforå¾ªç¯çš„åˆå§‹åŒ–å€¼ã€‚ä»0å¼€å§‹è®¡æ•°ã€‚è®°å½•ç€éå†èŠ‚ç‚¹çš„ä¸ª						æ•°ã€‚å€¼æ˜¯0è¡¨ç¤ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ1è¡¨ç¤ºç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚ã€‚ã€‚ã€‚7è¡¨ç¤ºç¬¬å…«ä¸ªèŠ‚ç‚¹ï¼ŒåŠ ä¸Šæ•°ç»„ä¸­çš„çš„ä¸€						ä¸ªå…ƒç´ ï¼Œå…ƒç´ ä¸ªæ•°æ˜¯9</span></span><br><span class="line"><span class="comment">                    	TREEIFY_THRESHOLD - 1 --ã€‹8 - 1 ---ã€‹7</span></span><br><span class="line"><span class="comment">                    	å¦‚æœbinCountçš„å€¼æ˜¯7(åŠ ä¸Šæ•°ç»„ä¸­çš„çš„ä¸€ä¸ªå…ƒç´ ï¼Œå…ƒç´ ä¸ªæ•°æ˜¯9)</span></span><br><span class="line"><span class="comment">                    	TREEIFY_THRESHOLD - 1ä¹Ÿæ˜¯7ï¼Œæ­¤æ—¶è½¬æ¢çº¢é»‘æ ‘</span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        <span class="comment">//è½¬æ¢ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="comment">// è·³å‡ºå¾ªç¯</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                 </span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                	æ‰§è¡Œåˆ°è¿™é‡Œè¯´æ˜e = p.next ä¸æ˜¯nullï¼Œä¸æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ã€‚ç»§ç»­åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’					  å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="comment">// ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                		è¦æ·»åŠ çš„å…ƒç´ å’Œé“¾è¡¨ä¸­çš„å­˜åœ¨çš„å…ƒç´ çš„keyç›¸ç­‰äº†ï¼Œåˆ™è·³å‡ºforå¾ªç¯ã€‚ä¸ç”¨å†ç»§ç»­æ¯”è¾ƒäº†</span></span><br><span class="line"><span class="comment">                		ç›´æ¥æ‰§è¡Œä¸‹é¢çš„ifè¯­å¥å»æ›¿æ¢å» if (e != null) </span></span><br><span class="line"><span class="comment">                	*/</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                	è¯´æ˜æ–°æ·»åŠ çš„å…ƒç´ å’Œå½“å‰èŠ‚ç‚¹ä¸ç›¸ç­‰ï¼Œç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">                	ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	è¡¨ç¤ºåœ¨æ¡¶ä¸­æ‰¾åˆ°keyå€¼ã€hashå€¼ä¸æ’å…¥å…ƒç´ ç›¸ç­‰çš„ç»“ç‚¹</span></span><br><span class="line"><span class="comment">        	ä¹Ÿå°±æ˜¯è¯´é€šè¿‡ä¸Šé¢çš„æ“ä½œæ‰¾åˆ°äº†é‡å¤çš„é”®ï¼Œæ‰€ä»¥è¿™é‡Œå°±æ˜¯æŠŠè¯¥é”®çš„å€¼å˜ä¸ºæ–°çš„å€¼ï¼Œå¹¶è¿”å›æ—§å€¼</span></span><br><span class="line"><span class="comment">        	è¿™é‡Œå®Œæˆäº†putæ–¹æ³•çš„ä¿®æ”¹åŠŸèƒ½</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="comment">// è®°å½•eçš„value</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="comment">// onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull</span></span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                <span class="comment">//ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼</span></span><br><span class="line">                <span class="comment">//e.value è¡¨ç¤ºæ—§å€¼  valueè¡¨ç¤ºæ–°å€¼ </span></span><br><span class="line">                e.value = value;</span><br><span class="line">            <span class="comment">// è®¿é—®åå›è°ƒ</span></span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="comment">// è¿”å›æ—§å€¼</span></span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä¿®æ”¹è®°å½•æ¬¡æ•°</span></span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å®é™…å¤§å°æ˜¯å¦å¤§äºthresholdé˜ˆå€¼ï¼Œå¦‚æœè¶…è¿‡åˆ™æ‰©å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line">    <span class="comment">// æ’å…¥åå›è°ƒ</span></span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="4-3-2å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘çš„treeifyBinæ–¹æ³•"><a href="#4-3-2å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘çš„treeifyBinæ–¹æ³•" class="headerlink" title="4.3.2å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘çš„treeifyBinæ–¹æ³•"></a>4.3.2å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘çš„treeifyBinæ–¹æ³•</h4><p>èŠ‚ç‚¹æ·»åŠ å®Œæˆä¹‹ååˆ¤æ–­æ­¤æ—¶èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¦å¤§äºTREEIFY_THRESHOLDä¸´ç•Œå€¼8ï¼Œå¦‚æœå¤§äºåˆ™å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œè½¬æ¢çº¢é»‘æ ‘çš„æ–¹æ³•  treeifyBinï¼Œæ•´ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">   <span class="comment">//è½¬æ¢ä¸ºçº¢é»‘æ ‘ tabè¡¨ç¤ºæ•°ç»„å  hashè¡¨ç¤ºå“ˆå¸Œå€¼</span></span><br><span class="line">   treeifyBin(tab, hash);</span><br></pre></td></tr></table></figure>

<p>treeifyBinæ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Replaces all linked nodes in bin at index for given hash unless</span></span><br><span class="line"><span class="comment"> * table is too small, in which case resizes instead.</span></span><br><span class="line"><span class="comment">   æ›¿æ¢æŒ‡å®šå“ˆå¸Œè¡¨çš„ç´¢å¼•å¤„æ¡¶ä¸­çš„æ‰€æœ‰é“¾æ¥èŠ‚ç‚¹ï¼Œé™¤éè¡¨å¤ªå°ï¼Œå¦åˆ™å°†ä¿®æ”¹å¤§å°ã€‚</span></span><br><span class="line"><span class="comment">   Node&lt;K,V&gt;[] tab = tab æ•°ç»„å</span></span><br><span class="line"><span class="comment">   int hash = hashè¡¨ç¤ºå“ˆå¸Œå€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">treeifyBin</span><span class="params">(Node&lt;K,V&gt;[] tab, <span class="keyword">int</span> hash)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> n, index; Node&lt;K,V&gt; e;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">      	å¦‚æœå½“å‰æ•°ç»„ä¸ºç©ºæˆ–è€…æ•°ç»„çš„é•¿åº¦å°äºè¿›è¡Œæ ‘å½¢åŒ–çš„é˜ˆå€¼(MIN_TREEIFY_CAPACITY = 64),</span></span><br><span class="line"><span class="comment">      	å°±å»æ‰©å®¹ã€‚è€Œä¸æ˜¯å°†èŠ‚ç‚¹å˜ä¸ºçº¢é»‘æ ‘ã€‚</span></span><br><span class="line"><span class="comment">      	ç›®çš„ï¼šå¦‚æœæ•°ç»„å¾ˆå°ï¼Œé‚£ä¹ˆè½¬æ¢çº¢é»‘æ ‘ï¼Œç„¶åéå†æ•ˆç‡è¦ä½ä¸€äº›ã€‚è¿™æ—¶è¿›è¡Œæ‰©å®¹ï¼Œé‚£ä¹ˆé‡æ–°è®¡ç®—å“ˆå¸Œå€¼</span></span><br><span class="line"><span class="comment">      	ï¼Œé“¾è¡¨é•¿åº¦æœ‰å¯èƒ½å°±å˜çŸ­äº†ï¼Œæ•°æ®ä¼šæ”¾åˆ°æ•°ç»„ä¸­ï¼Œè¿™æ ·ç›¸å¯¹æ¥è¯´æ•ˆç‡é«˜ä¸€äº›ã€‚</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">if</span> (tab == <span class="keyword">null</span> || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)</span><br><span class="line">          <span class="comment">//æ‰©å®¹æ–¹æ³•</span></span><br><span class="line">          resize();</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> ((e = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">          <span class="comment">/*</span></span><br><span class="line"><span class="comment">          	1ï¼‰æ‰§è¡Œåˆ°è¿™é‡Œè¯´æ˜å“ˆå¸Œè¡¨ä¸­çš„æ•°ç»„é•¿åº¦å¤§äºé˜ˆå€¼64ï¼Œå¼€å§‹è¿›è¡Œæ ‘å½¢åŒ–</span></span><br><span class="line"><span class="comment">          	2ï¼‰e = tab[index = (n - 1) &amp; hash]è¡¨ç¤ºå°†æ•°ç»„ä¸­çš„å…ƒç´ å–å‡ºèµ‹å€¼ç»™e,eæ˜¯å“ˆå¸Œè¡¨ä¸­æŒ‡å®šä½					ç½®æ¡¶é‡Œçš„é“¾è¡¨èŠ‚ç‚¹ï¼Œä»ç¬¬ä¸€ä¸ªå¼€å§‹</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">          <span class="comment">//hdï¼šçº¢é»‘æ ‘çš„å¤´ç»“ç‚¹   tl :çº¢é»‘æ ‘çš„å°¾ç»“ç‚¹</span></span><br><span class="line">          TreeNode&lt;K,V&gt; hd = <span class="keyword">null</span>, tl = <span class="keyword">null</span>;</span><br><span class="line">          <span class="keyword">do</span> &#123;</span><br><span class="line">              <span class="comment">//æ–°åˆ›å»ºä¸€ä¸ªæ ‘çš„èŠ‚ç‚¹ï¼Œå†…å®¹å’Œå½“å‰é“¾è¡¨èŠ‚ç‚¹eä¸€è‡´</span></span><br><span class="line">              TreeNode&lt;K,V&gt; p = replacementTreeNode(e, <span class="keyword">null</span>);</span><br><span class="line">              <span class="keyword">if</span> (tl == <span class="keyword">null</span>)</span><br><span class="line">                  <span class="comment">//å°†æ–°åˆ›é”®çš„pèŠ‚ç‚¹èµ‹å€¼ç»™çº¢é»‘æ ‘çš„å¤´ç»“ç‚¹</span></span><br><span class="line">                  hd = p;</span><br><span class="line">              <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="comment">/*</span></span><br><span class="line"><span class="comment">                  	 p.prev = tlï¼šå°†ä¸Šä¸€ä¸ªèŠ‚ç‚¹pèµ‹å€¼ç»™ç°åœ¨çš„pçš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">                  	 tl.next = p;å°†ç°åœ¨èŠ‚ç‚¹pä½œä¸ºæ ‘çš„å°¾ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">                  */</span></span><br><span class="line">                  p.prev = tl;</span><br><span class="line">                  tl.next = p;</span><br><span class="line">              &#125;</span><br><span class="line">              tl = p;</span><br><span class="line">              <span class="comment">/*</span></span><br><span class="line"><span class="comment">              	e = e.next å°†å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹èµ‹å€¼ç»™e,å¦‚æœä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ç­‰äºnull</span></span><br><span class="line"><span class="comment">              	åˆ™å›åˆ°ä¸Šé¢ç»§ç»­å–å‡ºé“¾è¡¨ä¸­èŠ‚ç‚¹è½¬æ¢ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line"><span class="comment">              */</span></span><br><span class="line">          &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">          <span class="comment">/*</span></span><br><span class="line"><span class="comment">          	è®©æ¡¶ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å³æ•°ç»„ä¸­çš„å…ƒç´ æŒ‡å‘æ–°å»ºçš„çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œä»¥åè¿™ä¸ªæ¡¶é‡Œçš„å…ƒç´ å°±æ˜¯çº¢é»‘æ ‘</span></span><br><span class="line"><span class="comment">          	è€Œä¸æ˜¯é“¾è¡¨æ•°æ®ç»“æ„äº†</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">          <span class="keyword">if</span> ((tab[index] = hd) != <span class="keyword">null</span>)</span><br><span class="line">              hd.treeify(tab);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å°ç»“ï¼šä¸Šè¿°æ“ä½œä¸€å…±åšäº†å¦‚ä¸‹å‡ ä»¶äº‹ï¼š</p>
<p>1.æ ¹æ®å“ˆå¸Œè¡¨ä¸­å…ƒç´ ä¸ªæ•°ç¡®å®šæ˜¯æ‰©å®¹è¿˜æ˜¯æ ‘å½¢åŒ–</p>
<p>2.å¦‚æœæ˜¯æ ‘å½¢åŒ–éå†æ¡¶ä¸­çš„å…ƒç´ ï¼Œåˆ›å»ºç›¸åŒä¸ªæ•°çš„æ ‘å½¢èŠ‚ç‚¹ï¼Œå¤åˆ¶å†…å®¹ï¼Œå»ºç«‹èµ·è”ç³»</p>
<p>3.ç„¶åè®©æ¡¶ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å‘æ–°åˆ›å»ºçš„æ ‘æ ¹èŠ‚ç‚¹ï¼Œæ›¿æ¢æ¡¶çš„é“¾è¡¨å†…å®¹ä¸ºæ ‘å½¢åŒ–å†…å®¹</p>
<h4 id="4-3-3æ‰©å®¹æ–¹æ³•-resize"><a href="#4-3-3æ‰©å®¹æ–¹æ³•-resize" class="headerlink" title="4.3.3æ‰©å®¹æ–¹æ³•_resize"></a>4.3.3æ‰©å®¹æ–¹æ³•_resize</h4><h5 id="4-3-3-1æ‰©å®¹æœºåˆ¶"><a href="#4-3-3-1æ‰©å®¹æœºåˆ¶" class="headerlink" title="4.3.3.1æ‰©å®¹æœºåˆ¶"></a>4.3.3.1æ‰©å®¹æœºåˆ¶</h5><p>æƒ³è¦äº†è§£HashMapçš„æ‰©å®¹æœºåˆ¶ä½ è¦æœ‰è¿™ä¸¤ä¸ªé—®é¢˜</p>
<ul>
<li>1.ä»€ä¹ˆæ—¶å€™æ‰éœ€è¦æ‰©å®¹</li>
<li>2.HashMapçš„æ‰©å®¹æ˜¯ä»€ä¹ˆ</li>
</ul>
<p><strong>1.ä»€ä¹ˆæ—¶å€™æ‰éœ€è¦æ‰©å®¹</strong></p>
<p>å½“HashMapä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å°(æ•°ç»„é•¿åº¦)*loadFactor(è´Ÿè½½å› å­)æ—¶ï¼Œå°±ä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼ŒloadFactorçš„é»˜è®¤å€¼(DEFAULT_LOAD_FACTOR)æ˜¯0.75,è¿™æ˜¯ä¸€ä¸ªæŠ˜ä¸­çš„å–å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º16ï¼Œé‚£ä¹ˆå½“HashMapä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡16Ã—0.75=12(è¿™ä¸ªå€¼å°±æ˜¯é˜ˆå€¼æˆ–è€…è¾¹ç•Œå€¼thresholdå€¼)çš„æ—¶å€™ï¼Œå°±æŠŠæ•°ç»„çš„å¤§å°æ‰©å±•ä¸º2Ã—16=32ï¼Œå³æ‰©å¤§ä¸€å€ï¼Œç„¶åé‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œè€Œè¿™æ˜¯ä¸€ä¸ªéå¸¸è€—æ€§èƒ½çš„æ“ä½œï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å·²ç»é¢„çŸ¥HashMapä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆé¢„çŸ¥å…ƒç´ çš„ä¸ªæ•°èƒ½å¤Ÿæœ‰æ•ˆçš„æé«˜HashMapçš„æ€§èƒ½ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong></p>
<p><strong>å½“HashMapä¸­çš„å…¶ä¸­ä¸€ä¸ªé“¾è¡¨çš„å¯¹è±¡ä¸ªæ•°å¦‚æœè¾¾åˆ°äº†8ä¸ªï¼Œæ­¤æ—¶å¦‚æœæ•°ç»„é•¿åº¦æ²¡æœ‰è¾¾åˆ°64ï¼Œé‚£ä¹ˆHashMapä¼šå…ˆæ‰©å®¹è§£å†³ï¼Œå¦‚æœå·²ç»è¾¾åˆ°äº†64ï¼Œé‚£ä¹ˆè¿™ä¸ªé“¾è¡¨ä¼šå˜æˆçº¢é»‘æ ‘ï¼ŒèŠ‚ç‚¹ç±»å‹ç”±Nodeå˜æˆTreeNodeç±»å‹ã€‚å½“ç„¶ï¼Œå¦‚æœæ˜ å°„å…³ç³»è¢«ç§»é™¤åï¼Œä¸‹æ¬¡æ‰§è¡Œresizeæ–¹æ³•æ—¶åˆ¤æ–­æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ä½äº6ï¼Œä¹Ÿä¼šå†æŠŠæ ‘è½¬æ¢ä¸ºé“¾è¡¨ã€‚</strong></p>
<p><strong>2.HashMapçš„æ‰©å®¹æ˜¯ä»€ä¹ˆ</strong></p>
<p> è¿›è¡Œæ‰©å®¹ï¼Œä¼šä¼´éšç€ä¸€æ¬¡é‡æ–°hashåˆ†é…ï¼Œå¹¶ä¸”ä¼šéå†hashè¡¨ä¸­æ‰€æœ‰çš„å…ƒç´ ï¼Œæ˜¯éå¸¸è€—æ—¶çš„ã€‚åœ¨ç¼–å†™ç¨‹åºä¸­ï¼Œè¦å°½é‡é¿å…resizeã€‚ </p>
<p>HashMapåœ¨è¿›è¡Œæ‰©å®¹æ—¶ï¼Œä½¿ç”¨çš„rehashæ–¹å¼éå¸¸å·§å¦™ï¼Œå› ä¸ºæ¯æ¬¡æ‰©å®¹éƒ½æ˜¯ç¿»å€ï¼Œä¸åŸæ¥è®¡ç®—çš„ (n-1)&amp;hashçš„ç»“æœç›¸æ¯”ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªbitä½ï¼Œæ‰€ä»¥èŠ‚ç‚¹è¦ä¹ˆå°±åœ¨åŸæ¥çš„ä½ç½®ï¼Œè¦ä¹ˆå°±è¢«åˆ†é…åˆ°â€<strong>åŸä½ç½®+æ—§å®¹é‡</strong>â€œè¿™ä¸ªä½ç½®ã€‚</p>
<p> æ€ä¹ˆç†è§£å‘¢ï¼Ÿä¾‹å¦‚æˆ‘ä»¬ä»16æ‰©å±•ä¸º32æ—¶ï¼Œå…·ä½“çš„å˜åŒ–å¦‚ä¸‹æ‰€ç¤ºï¼š </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191117110812839.png" alt="image-20191117110812839"></p>
<p> å› æ­¤å…ƒç´ åœ¨é‡æ–°è®¡ç®—hashä¹‹åï¼Œå› ä¸ºnå˜ä¸º2å€ï¼Œé‚£ä¹ˆn-1çš„æ ‡è®°èŒƒå›´åœ¨é«˜ä½å¤š1bit(çº¢è‰²)ï¼Œå› æ­¤æ–°çš„indexå°±ä¼šå‘ç”Ÿè¿™æ ·çš„å˜åŒ–ï¼š </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20191117110934974.png" alt="image-20191117110934974"></p>
<p>è¯´æ˜ï¼š5æ˜¯å‡è®¾è®¡ç®—å‡ºæ¥çš„åŸæ¥çš„ç´¢å¼•ã€‚è¿™æ ·å°±éªŒè¯äº†ä¸Šè¿°æ‰€æè¿°çš„ï¼šæ‰©å®¹ä¹‹åæ‰€ä»¥èŠ‚ç‚¹è¦ä¹ˆå°±åœ¨åŸæ¥çš„ä½ç½®ï¼Œè¦ä¹ˆå°±è¢«åˆ†é…åˆ°â€<strong>åŸä½ç½®+æ—§å®¹é‡</strong>â€œè¿™ä¸ªä½ç½®ã€‚</p>
<p> å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ‰©å……HashMapçš„æ—¶å€™ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—hashï¼Œåªéœ€è¦çœ‹çœ‹åŸæ¥çš„hashå€¼æ–°å¢çš„é‚£ä¸ªbitæ˜¯1è¿˜æ˜¯0å°±å¯ä»¥äº†ï¼Œæ˜¯0çš„è¯ç´¢å¼•æ²¡å˜ï¼Œæ˜¯1çš„è¯ç´¢å¼•å˜æˆâ€œåŸç´¢å¼•+oldCap(<strong>åŸä½ç½®+æ—§å®¹é‡</strong>)â€ã€‚å¯ä»¥çœ‹çœ‹ä¸‹å›¾ä¸º16æ‰©å……ä¸º32çš„resizeç¤ºæ„å›¾ï¼š </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20191117111211630.png" alt="image-20191117111211630"></p>
<p>æ­£æ˜¯å› ä¸ºè¿™æ ·å·§å¦™çš„rehashæ–¹å¼ï¼Œæ—¢çœå»äº†é‡æ–°è®¡ç®—hashå€¼çš„æ—¶é—´ï¼Œè€Œä¸”åŒæ—¶ï¼Œç”±äºæ–°å¢çš„1bitæ˜¯0è¿˜æ˜¯1å¯ä»¥è®¤ä¸ºæ˜¯éšæœºçš„ï¼Œåœ¨resizeçš„è¿‡ç¨‹ä¸­ä¿è¯äº†rehashä¹‹åæ¯ä¸ªæ¡¶ä¸Šçš„èŠ‚ç‚¹æ•°ä¸€å®šå°äºç­‰äºåŸæ¥æ¡¶ä¸Šçš„èŠ‚ç‚¹æ•°ï¼Œä¿è¯äº†rehashä¹‹åä¸ä¼šå‡ºç°æ›´ä¸¥é‡çš„hashå†²çªï¼Œå‡åŒ€çš„æŠŠä¹‹å‰çš„å†²çªçš„èŠ‚ç‚¹åˆ†æ•£åˆ°æ–°çš„æ¡¶ä¸­äº†ã€‚</p>
<h5 id="4-3-3-2æºç resizeæ–¹æ³•çš„è§£è¯»"><a href="#4-3-3-2æºç resizeæ–¹æ³•çš„è§£è¯»" class="headerlink" title="4.3.3.2æºç resizeæ–¹æ³•çš„è§£è¯»"></a>4.3.3.2æºç resizeæ–¹æ³•çš„è§£è¯»</h5><p>ä¸‹é¢æ˜¯ä»£ç çš„å…·ä½“å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    <span class="comment">//å¾—åˆ°å½“å‰æ•°ç»„</span></span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">    <span class="comment">//å¦‚æœå½“å‰æ•°ç»„ç­‰äºnullé•¿åº¦è¿”å›0ï¼Œå¦åˆ™è¿”å›å½“å‰æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">    <span class="comment">//å½“å‰é˜€å€¼ç‚¹ é»˜è®¤æ˜¯12(16*0.75)</span></span><br><span class="line">    <span class="keyword">int</span> oldThr = threshold;</span><br><span class="line">    <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//å¦‚æœè€çš„æ•°ç»„é•¿åº¦å¤§äº0</span></span><br><span class="line">    <span class="comment">//å¼€å§‹è®¡ç®—æ‰©å®¹åçš„å¤§å°</span></span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§</span></span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            <span class="comment">//ä¿®æ”¹é˜ˆå€¼ä¸ºintçš„æœ€å¤§å€¼</span></span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€</span></span><br><span class="line"><span class="comment">        	1)(newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY æ‰©å¤§åˆ°2å€ä¹‹åå®¹é‡è¦å°äºæœ€å¤§å®¹é‡</span></span><br><span class="line"><span class="comment">        	2ï¼‰oldCap &gt;= DEFAULT_INITIAL_CAPACITY åŸæ•°ç»„é•¿åº¦å¤§äºç­‰äºæ•°ç»„åˆå§‹åŒ–é•¿åº¦16</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            <span class="comment">//é˜ˆå€¼æ‰©å¤§ä¸€å€</span></span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è€é˜ˆå€¼ç‚¹å¤§äº0 ç›´æ¥èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// è€é˜ˆå€¼èµ‹å€¼ç»™æ–°çš„æ•°ç»„é•¿åº¦</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="keyword">else</span> &#123;<span class="comment">// ç›´æ¥ä½¿ç”¨é»˜è®¤å€¼</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;<span class="comment">//16</span></span><br><span class="line">        newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®¡ç®—æ–°çš„resizeæœ€å¤§ä¸Šé™</span></span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ–°çš„é˜€å€¼ é»˜è®¤åŸæ¥æ˜¯12 ä¹˜ä»¥2ä¹‹åå˜ä¸º24</span></span><br><span class="line">    threshold = newThr;</span><br><span class="line">    <span class="comment">//åˆ›å»ºæ–°çš„å“ˆå¸Œè¡¨</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    <span class="comment">//newCapæ˜¯æ–°çš„æ•°ç»„é•¿åº¦--ã€‹32</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ—§æ•°ç»„æ˜¯å¦ç­‰äºç©º</span></span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­</span></span><br><span class="line">        <span class="comment">//éå†æ—§çš„å“ˆå¸Œè¡¨çš„æ¯ä¸ªæ¡¶ï¼Œé‡æ–°è®¡ç®—æ¡¶é‡Œå…ƒç´ çš„æ–°ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//åŸæ¥çš„æ•°æ®èµ‹å€¼ä¸ºnull ä¾¿äºGCå›æ”¶</span></span><br><span class="line">                oldTab[j] = <span class="keyword">null</span>;</span><br><span class="line">                <span class="comment">//åˆ¤æ–­æ•°ç»„æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå¼•ç”¨</span></span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="keyword">null</span>)</span><br><span class="line">                    <span class="comment">//æ²¡æœ‰ä¸‹ä¸€ä¸ªå¼•ç”¨ï¼Œè¯´æ˜ä¸æ˜¯é“¾è¡¨ï¼Œå½“å‰æ¡¶ä¸Šåªæœ‰ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç›´æ¥æ’å…¥</span></span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="comment">//åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    <span class="comment">//è¯´æ˜æ˜¯çº¢é»‘æ ‘æ¥å¤„ç†å†²çªçš„ï¼Œåˆ™è°ƒç”¨ç›¸å…³æ–¹æ³•æŠŠæ ‘åˆ†å¼€</span></span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// é‡‡ç”¨é“¾è¡¨å¤„ç†å†²çª</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="comment">//é€šè¿‡ä¸Šè¿°è®²è§£çš„åŸç†æ¥è®¡ç®—èŠ‚ç‚¹çš„æ–°ä½ç½®</span></span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        <span class="comment">// åŸç´¢å¼•</span></span><br><span class="line">                        next = e.next;</span><br><span class="line">                     	<span class="comment">//è¿™é‡Œæ¥åˆ¤æ–­å¦‚æœç­‰äºtrue eè¿™ä¸ªèŠ‚ç‚¹åœ¨resizeä¹‹åä¸éœ€è¦ç§»åŠ¨ä½ç½®</span></span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// åŸç´¢å¼•+oldCap</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                    <span class="comment">// åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ</span></span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ</span></span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="4-3-4-åˆ é™¤æ–¹æ³•-remove"><a href="#4-3-4-åˆ é™¤æ–¹æ³•-remove" class="headerlink" title="4.3.4 åˆ é™¤æ–¹æ³•(remove)"></a>4.3.4 åˆ é™¤æ–¹æ³•(remove)</h4><p> ç†è§£äº†putæ–¹æ³•ä¹‹åï¼Œremoveæ–¹æ³•å·²ç»æ²¡ä»€ä¹ˆéš¾åº¦äº†ï¼Œæ‰€ä»¥é‡å¤çš„å†…å®¹å°±ä¸å†åšè¯¦ç»†ä»‹ç»äº†ã€‚</p>
<p> åˆ é™¤çš„è¯å°±æ˜¯é¦–å…ˆå…ˆæ‰¾åˆ°å…ƒç´ çš„ä½ç½®ï¼Œå¦‚æœæ˜¯é“¾è¡¨å°±éå†é“¾è¡¨æ‰¾åˆ°å…ƒç´ ä¹‹ååˆ é™¤ã€‚å¦‚æœæ˜¯ç”¨çº¢é»‘æ ‘å°±éå†æ ‘ç„¶åæ‰¾åˆ°ä¹‹ååšåˆ é™¤ï¼Œæ ‘å°äº6çš„æ—¶å€™è¦è½¬é“¾è¡¨ã€‚ </p>
<p> åˆ é™¤removeæ–¹æ³•ï¼š </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//removeæ–¹æ³•çš„å…·ä½“å®ç°åœ¨removeNodeæ–¹æ³•ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹removeNodeæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">remove</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        Node&lt;K,V&gt; e;</span><br><span class="line">        <span class="keyword">return</span> (e = removeNode(hash(key), key, <span class="keyword">null</span>, <span class="keyword">false</span>, <span class="keyword">true</span>)) == <span class="keyword">null</span> ?</span><br><span class="line">            <span class="keyword">null</span> : e.value;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p> removeNodeæ–¹æ³•ï¼š </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">removeNode</span><span class="params">(<span class="keyword">int</span> hash, Object key, Object value,</span></span></span><br><span class="line"><span class="function"><span class="params">                               <span class="keyword">boolean</span> matchValue, <span class="keyword">boolean</span> movable)</span> </span>&#123;</span><br><span class="line">        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, index;</span><br><span class="line">    	<span class="comment">//æ ¹æ®hashæ‰¾åˆ°ä½ç½® </span></span><br><span class="line">    	<span class="comment">//å¦‚æœå½“å‰keyæ˜ å°„åˆ°çš„æ¡¶ä¸ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">            (p = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Node&lt;K,V&gt; node = <span class="keyword">null</span>, e; K k; V v;</span><br><span class="line">            <span class="comment">//å¦‚æœæ¡¶ä¸Šçš„èŠ‚ç‚¹å°±æ˜¯è¦æ‰¾çš„keyï¼Œåˆ™å°†nodeæŒ‡å‘è¯¥èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">                ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                node = p;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ((e = p.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//è¯´æ˜èŠ‚ç‚¹å­˜åœ¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    <span class="comment">//è¯´æ˜æ˜¯ä»¥çº¢é»‘æ ‘æ¥å¤„ç†çš„å†²çªï¼Œåˆ™è·å–çº¢é»‘æ ‘è¦åˆ é™¤çš„èŠ‚ç‚¹</span></span><br><span class="line">                    node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//åˆ¤æ–­æ˜¯å¦ä»¥é“¾è¡¨æ–¹å¼å¤„ç†hashå†²çªï¼Œæ˜¯çš„è¯åˆ™é€šè¿‡éå†é“¾è¡¨æ¥å¯»æ‰¾è¦åˆ é™¤çš„èŠ‚ç‚¹</span></span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                            ((k = e.key) == key ||</span><br><span class="line">                             (key != <span class="keyword">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">                            node = e;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        p = e;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//æ¯”è¾ƒæ‰¾åˆ°çš„keyçš„valueå’Œè¦åˆ é™¤çš„æ˜¯å¦åŒ¹é…</span></span><br><span class="line">            <span class="keyword">if</span> (node != <span class="keyword">null</span> &amp;&amp; (!matchValue || (v = node.value) == value ||</span><br><span class="line">                                 (value != <span class="keyword">null</span> &amp;&amp; value.equals(v)))) &#123;</span><br><span class="line">                <span class="comment">//é€šè¿‡è°ƒç”¨çº¢é»‘æ ‘çš„æ–¹æ³•æ¥åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span> (node <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)node).removeTreeNode(<span class="keyword">this</span>, tab, movable);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (node == p)</span><br><span class="line">                    <span class="comment">//é“¾è¡¨åˆ é™¤</span></span><br><span class="line">                    tab[index] = node.next;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    p.next = node.next;</span><br><span class="line">                <span class="comment">//è®°å½•ä¿®æ”¹æ¬¡æ•°</span></span><br><span class="line">                ++modCount;</span><br><span class="line">                <span class="comment">//å˜åŠ¨çš„æ•°é‡</span></span><br><span class="line">                --size;</span><br><span class="line">                afterNodeRemoval(node);</span><br><span class="line">                <span class="keyword">return</span> node;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-3-5æŸ¥æ‰¾å…ƒç´ æ–¹æ³•-get"><a href="#4-3-5æŸ¥æ‰¾å…ƒç´ æ–¹æ³•-get" class="headerlink" title="4.3.5æŸ¥æ‰¾å…ƒç´ æ–¹æ³•(get)"></a>4.3.5æŸ¥æ‰¾å…ƒç´ æ–¹æ³•(get)</h4><p> æŸ¥æ‰¾æ–¹æ³•ï¼Œé€šè¿‡å…ƒç´ çš„Keyæ‰¾åˆ°Valueã€‚ </p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>getæ–¹æ³•ä¸»è¦è°ƒç”¨çš„æ˜¯getNodeæ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="keyword">int</span> n; K k;</span><br><span class="line">    <span class="comment">//å¦‚æœå“ˆå¸Œè¡¨ä¸ä¸ºç©ºå¹¶ä¸”keyå¯¹åº”çš„æ¡¶ä¸Šä¸ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        	åˆ¤æ–­æ•°ç»„å…ƒç´ æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line"><span class="comment">        	æ ¹æ®ç´¢å¼•çš„ä½ç½®æ£€æŸ¥ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">        	æ³¨æ„ï¼šæ€»æ˜¯æ£€æŸ¥ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="comment">// å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰åç»­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œæ˜¯çš„è¯è°ƒç”¨çº¢é»‘æ ‘ä¸­çš„getTreeNodeæ–¹æ³•è·å–èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="comment">// ä¸æ˜¯çº¢é»‘æ ‘çš„è¯ï¼Œé‚£å°±æ˜¯é“¾è¡¨ç»“æ„äº†ï¼Œé€šè¿‡å¾ªç¯çš„æ–¹æ³•åˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦å­˜åœ¨è¯¥key</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°ç»“ï¼š</p>
<p>1.getæ–¹æ³•å®ç°çš„æ­¥éª¤ï¼š</p>
<p>â€‹    1ï¼‰é€šè¿‡hashå€¼è·å–è¯¥keyæ˜ å°„åˆ°çš„æ¡¶</p>
<p>â€‹    2ï¼‰æ¡¶ä¸Šçš„keyå°±æ˜¯è¦æŸ¥æ‰¾çš„key,åˆ™ç›´æ¥æ‰¾åˆ°å¹¶è¿”å›</p>
<p>â€‹    3ï¼‰æ¡¶ä¸Šçš„keyä¸æ˜¯è¦æ‰¾çš„key,åˆ™æŸ¥çœ‹åç»­çš„èŠ‚ç‚¹ï¼š</p>
<p>â€‹            a:å¦‚æœåç»­èŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œé€šè¿‡è°ƒç”¨çº¢é»‘æ ‘çš„æ–¹æ³•æ ¹æ®keyè·å–value</p>
<p>â€‹            b:å¦‚æœåç»­èŠ‚ç‚¹æ˜¯é“¾è¡¨èŠ‚ç‚¹ï¼Œåˆ™é€šè¿‡å¾ªç¯éå†é“¾è¡¨æ ¹æ®keyè·å–value</p>
<p>2.ä¸Šè¿°çº¢é»‘æ ‘èŠ‚ç‚¹è°ƒç”¨çš„æ˜¯getTreeNodeæ–¹æ³•é€šè¿‡æ ‘å½¢èŠ‚ç‚¹çš„findæ–¹æ³•è¿›è¡ŒæŸ¥æ‰¾ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> TreeNode&lt;K,V&gt; <span class="title">getTreeNode</span><span class="params">(<span class="keyword">int</span> h, Object k)</span> </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> ((parent != <span class="keyword">null</span>) ? root() : <span class="keyword">this</span>).find(h, k, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">final</span> TreeNode&lt;K,V&gt; <span class="title">find</span><span class="params">(<span class="keyword">int</span> h, Object k, Class&lt;?&gt; kc)</span> </span>&#123;</span><br><span class="line">           TreeNode&lt;K,V&gt; p = <span class="keyword">this</span>;</span><br><span class="line">           <span class="keyword">do</span> &#123;</span><br><span class="line">               <span class="keyword">int</span> ph, dir; K pk;</span><br><span class="line">               TreeNode&lt;K,V&gt; pl = p.left, pr = p.right, q;</span><br><span class="line">               <span class="keyword">if</span> ((ph = p.hash) &gt; h)</span><br><span class="line">                   p = pl;</span><br><span class="line">               <span class="keyword">else</span> <span class="keyword">if</span> (ph &lt; h)</span><br><span class="line">                   p = pr;</span><br><span class="line">               <span class="keyword">else</span> <span class="keyword">if</span> ((pk = p.key) == k || (k != <span class="keyword">null</span> &amp;&amp; k.equals(pk)))</span><br><span class="line">                   <span class="keyword">return</span> p;<span class="comment">//æ‰¾åˆ°ä¹‹åç›´æ¥è¿”å›</span></span><br><span class="line">               <span class="keyword">else</span> <span class="keyword">if</span> (pl == <span class="keyword">null</span>)</span><br><span class="line">                   p = pr;</span><br><span class="line">               <span class="keyword">else</span> <span class="keyword">if</span> (pr == <span class="keyword">null</span>)</span><br><span class="line">                   p = pl;</span><br><span class="line">               <span class="keyword">else</span> <span class="keyword">if</span> ((kc != <span class="keyword">null</span> ||</span><br><span class="line">                         (kc = comparableClassFor(k)) != <span class="keyword">null</span>) &amp;&amp;</span><br><span class="line">                        (dir = compareComparables(kc, k, pk)) != <span class="number">0</span>)</span><br><span class="line">                   p = (dir &lt; <span class="number">0</span>) ? pl : pr;</span><br><span class="line">               <span class="comment">//é€’å½’æŸ¥æ‰¾</span></span><br><span class="line">               <span class="keyword">else</span> <span class="keyword">if</span> ((q = pr.find(h, k, kc)) != <span class="keyword">null</span>)</span><br><span class="line">                   <span class="keyword">return</span> q;</span><br><span class="line">               <span class="keyword">else</span></span><br><span class="line">                   p = pl;</span><br><span class="line">           &#125; <span class="keyword">while</span> (p != <span class="keyword">null</span>);</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<p>3.æŸ¥æ‰¾çº¢é»‘æ ‘ï¼Œç”±äºä¹‹å‰æ·»åŠ æ—¶å·²ç»ä¿è¯è¿™ä¸ªæ ‘æ˜¯æœ‰åºçš„äº†ï¼Œå› æ­¤æŸ¥æ‰¾æ—¶åŸºæœ¬å°±æ˜¯æŠ˜åŠæŸ¥æ‰¾ï¼Œæ•ˆç‡æ›´é«˜ã€‚</p>
<p>4.è¿™é‡Œå’Œæ’å…¥æ—¶ä¸€æ ·ï¼Œå¦‚æœå¯¹æ¯”èŠ‚ç‚¹çš„å“ˆå¸Œå€¼å’Œè¦æŸ¥æ‰¾çš„å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå°±ä¼šåˆ¤æ–­keyæ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰å°±ç›´æ¥è¿”å›ã€‚ä¸ç›¸ç­‰å°±ä»å­æ ‘ä¸­é€’å½’æŸ¥æ‰¾ã€‚</p>
<p>5.</p>
<p>â€‹    è‹¥ä¸ºæ ‘ï¼Œåˆ™åœ¨æ ‘ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(logn) </p>
<p>â€‹    è‹¥ä¸ºé“¾è¡¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(n)ã€‚</p>
<h4 id="4-3-6éå†HashMapé›†åˆå‡ ç§æ–¹å¼"><a href="#4-3-6éå†HashMapé›†åˆå‡ ç§æ–¹å¼" class="headerlink" title="4.3.6éå†HashMapé›†åˆå‡ ç§æ–¹å¼"></a>4.3.6éå†HashMapé›†åˆå‡ ç§æ–¹å¼</h4><p> 1ã€åˆ†åˆ«éå†Keyå’ŒValues </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191117160455507.png" alt="image-20191117160455507"></p>
<p>2ã€ä½¿ç”¨Iteratorè¿­ä»£å™¨è¿­ä»£ </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191117160627369.png" alt="image-20191117160627369"></p>
<p>3ã€é€šè¿‡getæ–¹å¼ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191117160733756.png" alt="image-20191117160733756"></p>
<p>è¯´æ˜ï¼šæ ¹æ®é˜¿é‡Œå¼€å‘æ‰‹å†Œï¼Œä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå› ä¸ºè¿­ä»£ä¸¤æ¬¡ã€‚keySetè·å–Iteratorä¸€æ¬¡ï¼Œè¿˜æœ‰é€šè¿‡getåˆè¿­ä»£ä¸€æ¬¡ã€‚é™ä½æ€§èƒ½ã€‚</p>
<p>4.jdk8ä»¥åä½¿ç”¨Mapæ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼š</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">default</span> <span class="keyword">void</span> forEach(BiConsumer&lt;? <span class="keyword">super</span> K,? <span class="keyword">super</span> V&gt; action) </span><br><span class="line">BiConsumeræ¥å£ä¸­çš„æ–¹æ³•ï¼š</span><br><span class="line">	<span class="keyword">void</span> acceptâ€‹(T t, U u) å¯¹ç»™å®šçš„å‚æ•°æ‰§è¡Œæ­¤æ“ä½œã€‚  </span><br><span class="line">		å‚æ•° </span><br><span class="line">            t - ç¬¬ä¸€ä¸ªè¾“å…¥å‚æ•° </span><br><span class="line">            u - ç¬¬äºŒä¸ªè¾“å…¥å‚æ•° </span><br></pre></td></tr></table></figure>

<p>éå†ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HashMap&lt;String,String&gt; m1 = <span class="keyword">new</span> HashMap();</span><br><span class="line">        m1.put(<span class="string">&quot;001&quot;</span>, <span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">        m1.put(<span class="string">&quot;002&quot;</span>, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        m1.forEach((key,value)-&gt;&#123;</span><br><span class="line">            System.out.println(key+<span class="string">&quot;---&quot;</span>+value);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-å¦‚ä½•è®¾è®¡å¤šä¸ªéé‡å¤çš„é”®å€¼å¯¹è¦å­˜å‚¨HashMapçš„åˆå§‹åŒ–ï¼Ÿ"><a href="#5-å¦‚ä½•è®¾è®¡å¤šä¸ªéé‡å¤çš„é”®å€¼å¯¹è¦å­˜å‚¨HashMapçš„åˆå§‹åŒ–ï¼Ÿ" class="headerlink" title="5.å¦‚ä½•è®¾è®¡å¤šä¸ªéé‡å¤çš„é”®å€¼å¯¹è¦å­˜å‚¨HashMapçš„åˆå§‹åŒ–ï¼Ÿ"></a>5.å¦‚ä½•è®¾è®¡å¤šä¸ªéé‡å¤çš„é”®å€¼å¯¹è¦å­˜å‚¨HashMapçš„åˆå§‹åŒ–ï¼Ÿ</h2><h3 id="5-1HashMapçš„åˆå§‹åŒ–é—®é¢˜æè¿°"><a href="#5-1HashMapçš„åˆå§‹åŒ–é—®é¢˜æè¿°" class="headerlink" title="5.1HashMapçš„åˆå§‹åŒ–é—®é¢˜æè¿°"></a>5.1HashMapçš„åˆå§‹åŒ–é—®é¢˜æè¿°</h3><p>â€‹    å¦‚æœæˆ‘ä»¬ç¡®åˆ‡çš„çŸ¥é“æˆ‘ä»¬æœ‰å¤šå°‘é”®å€¼å¯¹éœ€è¦å­˜å‚¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨åˆå§‹åŒ–HashMapçš„æ—¶å€™å°±åº”è¯¥æŒ‡å®šå®ƒçš„å®¹é‡ï¼Œä»¥é˜²æ­¢HashMapè‡ªåŠ¨æ‰©å®¹ï¼Œå½±å“ä½¿ç”¨æ•ˆç‡ã€‚</p>
<p>â€‹    é»˜è®¤æƒ…å†µä¸‹HashMapçš„å®¹é‡æ˜¯16ï¼Œä½†æ˜¯ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡æ„é€ å‡½æ•°æŒ‡å®šäº†ä¸€ä¸ªæ•°å­—ä½œä¸ºå®¹é‡ï¼Œé‚£ä¹ˆHashä¼šé€‰æ‹©å¤§äºè¯¥æ•°å­—çš„ç¬¬ä¸€ä¸ª2çš„å¹‚ä½œä¸ºå®¹é‡ã€‚(3-&gt;4ã€7-&gt;8ã€9-&gt;16) .è¿™ç‚¹æˆ‘ä»¬åœ¨ä¸Šè¿°å·²ç»è¿›è¡Œè¿‡è®²è§£ã€‚</p>
<p> ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹ä¸­å»ºè®®æˆ‘ä»¬è®¾ç½®HashMapçš„åˆå§‹åŒ–å®¹é‡ã€‚ </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//2.bmp" alt="image-20191117164748836"></p>
<p> é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå»ºè®®ï¼Ÿä½ æœ‰æƒ³è¿‡æ²¡æœ‰ã€‚ </p>
<p>å½“ç„¶ï¼Œä»¥ä¸Šå»ºè®®ä¹Ÿæ˜¯æœ‰ç†è®ºæ”¯æ’‘çš„ã€‚æˆ‘ä»¬ä¸Šé¢ä»‹ç»è¿‡ï¼ŒHashMapçš„æ‰©å®¹æœºåˆ¶ï¼Œå°±æ˜¯å½“è¾¾åˆ°æ‰©å®¹æ¡ä»¶æ—¶ä¼šè¿›è¡Œæ‰©å®¹ã€‚HashMapçš„æ‰©å®¹æ¡ä»¶å°±æ˜¯å½“HashMapä¸­çš„å…ƒç´ ä¸ªæ•°ï¼ˆsizeï¼‰è¶…è¿‡ä¸´ç•Œå€¼ï¼ˆthresholdï¼‰æ—¶å°±ä¼šè‡ªåŠ¨æ‰©å®¹ã€‚åœ¨HashMapä¸­ï¼Œthreshold = loadFactor * capacityã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰è®¾ç½®åˆå§‹å®¹é‡å¤§å°ï¼Œéšç€å…ƒç´ çš„ä¸æ–­å¢åŠ ï¼ŒHashMapä¼šæœ‰å¯èƒ½å‘ç”Ÿå¤šæ¬¡æ‰©å®¹ï¼Œè€ŒHashMapä¸­çš„æ‰©å®¹æœºåˆ¶å†³å®šäº†æ¯æ¬¡æ‰©å®¹éƒ½éœ€è¦é‡å»ºhashè¡¨ï¼Œæ˜¯éå¸¸å½±å“æ€§èƒ½çš„ã€‚</p>
<p>ä½†æ˜¯è®¾ç½®åˆå§‹åŒ–å®¹é‡ï¼Œè®¾ç½®çš„æ•°å€¼ä¸åŒä¹Ÿä¼šå½±å“æ€§èƒ½ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬å·²çŸ¥HashMapä¸­å³å°†å­˜æ”¾çš„KVä¸ªæ•°çš„æ—¶å€™ï¼Œå®¹é‡è®¾ç½®æˆå¤šå°‘ä¸ºå¥½å‘¢ï¼Ÿ</p>
<h3 id="5-2HashMapä¸­å®¹é‡çš„åˆå§‹åŒ–"><a href="#5-2HashMapä¸­å®¹é‡çš„åˆå§‹åŒ–" class="headerlink" title="5.2HashMapä¸­å®¹é‡çš„åˆå§‹åŒ–"></a>5.2HashMapä¸­å®¹é‡çš„åˆå§‹åŒ–</h3><p>å½“æˆ‘ä»¬ä½¿ç”¨HashMap(int initialCapacity)æ¥åˆå§‹åŒ–å®¹é‡çš„æ—¶å€™ï¼Œjdkä¼šé»˜è®¤å¸®æˆ‘ä»¬è®¡ç®—ä¸€ä¸ªç›¸å¯¹åˆç†çš„å€¼å½“åšåˆå§‹å®¹é‡ã€‚é‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯æˆ‘ä»¬åªéœ€è¦æŠŠå·²çŸ¥çš„HashMapä¸­å³å°†å­˜æ”¾çš„å…ƒç´ ä¸ªæ•°ç›´æ¥ä¼ ç»™initialCapacityå°±å¯ä»¥äº†å‘¢ï¼Ÿ</p>
<p>å…³äºè¿™ä¸ªå€¼çš„è®¾ç½®ï¼Œåœ¨ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹æœ‰ä»¥ä¸‹å»ºè®®ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87//image-20191117165438726.png" alt="image-20191117165438726"></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®çš„é»˜è®¤å€¼æ˜¯7ï¼Œç»è¿‡Jdkå¤„ç†ä¹‹åï¼Œä¼šè¢«è®¾ç½®æˆ8ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªHashMapåœ¨å…ƒç´ ä¸ªæ•°è¾¾åˆ° 8*0.75 = 6çš„æ—¶å€™å°±ä¼šè¿›è¡Œä¸€æ¬¡æ‰©å®¹ï¼Œè¿™æ˜æ˜¾æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›è§åˆ°çš„ã€‚æˆ‘ä»¬åº”è¯¥å°½é‡å‡å°‘æ‰©å®¹ã€‚åŸå› ä¹Ÿå·²ç»åˆ†æè¿‡ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬é€šè¿‡<strong>initialCapacity/ 0.75F + 1.0F</strong>è®¡ç®—ï¼Œ7/0.75 + 1 = 10 ,10ç»è¿‡Jdkå¤„ç†ä¹‹åï¼Œä¼šè¢«è®¾ç½®æˆ16ï¼Œè¿™å°±å¤§å¤§çš„å‡å°‘äº†æ‰©å®¹çš„å‡ ç‡ã€‚</p>
<p>å½“HashMapå†…éƒ¨ç»´æŠ¤çš„å“ˆå¸Œè¡¨çš„å®¹é‡è¾¾åˆ°75%æ—¶ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ï¼Œä¼šè§¦å‘rehashï¼Œè€Œrehashçš„è¿‡ç¨‹æ˜¯æ¯”è¾ƒè€—è´¹æ—¶é—´çš„ã€‚æ‰€ä»¥åˆå§‹åŒ–å®¹é‡è¦è®¾ç½®æˆ<strong>initialCapacity/0.75 + 1</strong>çš„è¯ï¼Œå¯ä»¥æœ‰æ•ˆçš„å‡å°‘å†²çªä¹Ÿå¯ä»¥å‡å°è¯¯å·®ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘å¯ä»¥è®¤ä¸ºï¼Œå½“æˆ‘ä»¬æ˜ç¡®çŸ¥é“HashMapä¸­å…ƒç´ çš„ä¸ªæ•°çš„æ—¶å€™ï¼ŒæŠŠé»˜è®¤å®¹é‡è®¾ç½®æˆ<strong>initialCapacity/ 0.75F + 1.0F</strong>æ˜¯ä¸€ä¸ªåœ¨æ€§èƒ½ä¸Šç›¸å¯¹å¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯ï¼ŒåŒæ—¶ä¹Ÿä¼šç‰ºç‰²äº›å†…å­˜ã€‚</p>
<p>æˆ‘ä»¬æƒ³è¦åœ¨ä»£ç ä¸­åˆ›å»ºä¸€ä¸ªHashMapçš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬å·²çŸ¥è¿™ä¸ªMapä¸­å³å°†å­˜æ”¾çš„å…ƒç´ ä¸ªæ•°ï¼Œç»™HashMapè®¾ç½®åˆå§‹å®¹é‡å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæå‡æ•ˆç‡ã€‚</p>
<p>ä½†æ˜¯ï¼ŒJDKå¹¶ä¸ä¼šç›´æ¥æ‹¿ç”¨æˆ·ä¼ è¿›æ¥çš„æ•°å­—å½“åšé»˜è®¤å®¹é‡ï¼Œè€Œæ˜¯ä¼šè¿›è¡Œä¸€ç•ªè¿ç®—ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ª2çš„å¹‚ã€‚åŸå› ä¹Ÿå·²ç»åˆ†æè¿‡ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸ºäº†æœ€å¤§ç¨‹åº¦çš„é¿å…æ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ï¼Œæˆ‘ä»¬å»ºè®®å¯ä»¥æŠŠé»˜è®¤å®¹é‡çš„æ•°å­—è®¾ç½®æˆ<strong>initialCapacity/ 0.75F + 1.0F</strong>ã€‚</p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Dockerå­¦ä¹ ç¬”è®°</title>
    <url>/2021/04/05/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="Dockerå­¦ä¹ ç¬”è®°"><a href="#Dockerå­¦ä¹ ç¬”è®°" class="headerlink" title="Dockerå­¦ä¹ ç¬”è®°"></a>Dockerå­¦ä¹ ç¬”è®°</h2><ul>
<li>é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œå®ƒåŒ…å«<br>è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚</li>
</ul>
<span id="more"></span>
<h3 id="1-Dockeré•œåƒåŠ è½½åŸç†"><a href="#1-Dockeré•œåƒåŠ è½½åŸç†" class="headerlink" title="1.Dockeré•œåƒåŠ è½½åŸç†"></a>1.Dockeré•œåƒåŠ è½½åŸç†</h3><ul>
<li>UnionFSï¼ˆè”åˆæ–‡ä»¶ç³»ç»Ÿï¼‰</li>
</ul>
<blockquote>
<p>UnionFSï¼ˆè”åˆæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼š<strong>Unionæ–‡ä»¶ç³»ç»Ÿï¼ˆUnionFSï¼‰æ˜¯ä¸€ç§åˆ†å±‚ã€è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œ<br>å®ƒæ”¯æŒå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚çš„å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»<br>ç»Ÿä¸‹(unite several directories into a single virtual filesystem)ã€‚Union æ–‡ä»¶ç³»ç»Ÿæ˜¯ Docker é•œåƒçš„åŸº<br>ç¡€ã€‚é•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥è¿›è¡Œç»§æ‰¿ï¼ŒåŸºäºåŸºç¡€é•œåƒï¼ˆæ²¡æœ‰çˆ¶é•œåƒï¼‰ï¼Œå¯ä»¥åˆ¶ä½œå„ç§å…·ä½“çš„åº”ç”¨é•œåƒã€‚<br>ç‰¹æ€§ï¼š<strong>ä¸€æ¬¡åŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä»å¤–é¢çœ‹èµ·æ¥ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè”åˆåŠ è½½ä¼šæŠŠå„å±‚æ–‡ä»¶</strong><br><strong>ç³»ç»Ÿå åŠ èµ·æ¥ï¼Œè¿™æ ·æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«æ‰€æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•</strong></p>
</blockquote>
<ul>
<li>Dockeré•œåƒåŠ è½½åŸç†</li>
</ul>
<blockquote>
<p>dockerçš„é•œåƒå®é™…ä¸Šç”±ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œè¿™ç§å±‚çº§çš„æ–‡ä»¶ç³»ç»ŸUnionFSã€‚<br>bootfs(boot file system)ä¸»è¦åŒ…å«bootloaderå’Œkernel, bootloaderä¸»è¦æ˜¯å¼•å¯¼åŠ è½½kernel, Linuxåˆšå¯<br>åŠ¨æ—¶ä¼šåŠ è½½bootfsæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨Dockeré•œåƒçš„æœ€åº•å±‚æ˜¯bootfsã€‚è¿™ä¸€å±‚ä¸æˆ‘ä»¬å…¸å‹çš„Linux/Unixç³»ç»Ÿæ˜¯<br>ä¸€æ ·çš„ï¼ŒåŒ…å«bootåŠ è½½å™¨å’Œå†…æ ¸ã€‚å½“bootåŠ è½½å®Œæˆä¹‹åæ•´ä¸ªå†…æ ¸å°±éƒ½åœ¨å†…å­˜ä¸­äº†ï¼Œæ­¤æ—¶å†…å­˜çš„ä½¿ç”¨æƒå·²<br>ç”±bootfsè½¬äº¤ç»™å†…æ ¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¹Ÿä¼šå¸è½½bootfsã€‚<br>rootfs (root file system) ï¼Œåœ¨bootfsä¹‹ä¸Šã€‚åŒ…å«çš„å°±æ˜¯å…¸å‹ Linux ç³»ç»Ÿä¸­çš„ /dev, /proc, /bin, /etc ç­‰æ ‡<br>å‡†ç›®å½•å’Œæ–‡ä»¶ã€‚rootfså°±æ˜¯å„ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆï¼Œæ¯”å¦‚Ubuntuï¼ŒCentosç­‰ç­‰ã€‚</p>
</blockquote>
<ul>
<li>åˆ†å±‚é•œåƒ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull redis  #æ‹‰å–redis</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306152500153.png" alt="image-20210306152500153"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker image inspect redis:latest # æŸ¥çœ‹é•œåƒåˆ†å±‚çš„æ–¹å¼</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306152556075.png" alt="image-20210306152556075"></p>
<ul>
<li>ä¸ºä»€ä¹ˆDockeré•œåƒé‡‡ç”¨åˆ†å±‚çš„ç»“æ„</li>
</ul>
<blockquote>
<p>èµ„æºå…±äº«  æ¯”å¦‚æœ‰å¤šä¸ªé•œåƒéƒ½ä»ç›¸åŒçš„Baseé•œåƒæ„å»ºè€Œæ¥ï¼Œé‚£ä¹ˆå®¿ä¸»æœº<br>åªéœ€åœ¨ç£ç›˜ä¸Šä¿ç•™ä¸€ä»½baseé•œåƒï¼ŒåŒæ—¶å†…å­˜ä¸­ä¹Ÿåªéœ€è¦åŠ è½½ä¸€ä»½baseé•œåƒï¼Œè¿™æ ·å°±å¯ä»¥ä¸ºæ‰€æœ‰çš„å®¹å™¨æœ<br>åŠ¡äº†ï¼Œè€Œä¸”é•œåƒçš„æ¯ä¸€å±‚éƒ½å¯ä»¥è¢«å…±äº«ã€‚</p>
</blockquote>
<h4 id="ç†è§£"><a href="#ç†è§£" class="headerlink" title="ç†è§£"></a>ç†è§£</h4><p>æ‰€æœ‰çš„ Docker é•œåƒéƒ½èµ·å§‹äºä¸€ä¸ªåŸºç¡€é•œåƒå±‚ï¼Œå½“è¿›è¡Œä¿®æ”¹æˆ–å¢åŠ æ–°çš„å†…å®¹æ—¶ï¼Œå°±ä¼šåœ¨å½“å‰é•œåƒå±‚ä¹‹<br>ä¸Šï¼Œåˆ›å»ºæ–°çš„é•œåƒå±‚ã€‚<br>ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå‡å¦‚åŸºäº Ubuntu Linux 16.04 åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒï¼Œè¿™å°±æ˜¯æ–°é•œåƒçš„ç¬¬ä¸€å±‚ï¼›å¦‚æœ<br>åœ¨è¯¥é•œåƒä¸­æ·»åŠ  PythonåŒ…ï¼Œå°±ä¼šåœ¨åŸºç¡€é•œåƒå±‚ä¹‹ä¸Šåˆ›å»ºç¬¬äºŒä¸ªé•œåƒå±‚ï¼›å¦‚æœç»§ç»­æ·»åŠ ä¸€ä¸ªå®‰å…¨è¡¥ä¸ï¼Œå°±<br>ä¼šåˆ›å»ºç¬¬ä¸‰ä¸ªé•œåƒå±‚ã€‚<br>è¯¥é•œåƒå½“å‰å·²ç»åŒ…å« 3 ä¸ªé•œåƒå±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆè¿™åªæ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤ºçš„å¾ˆç®€å•çš„ä¾‹å­ï¼‰ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306152903863.png" alt="image-20210306152903863"></p>
<p>åœ¨æ·»åŠ é¢å¤–çš„é•œåƒå±‚çš„åŒæ—¶ï¼Œé•œåƒå§‹ç»ˆä¿æŒæ˜¯å½“å‰æ‰€æœ‰é•œåƒçš„ç»„åˆï¼Œç†è§£è¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚ä¸‹å›¾ä¸­ä¸¾äº†<br>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¯ä¸ªé•œåƒå±‚åŒ…å« 3 ä¸ªæ–‡ä»¶ï¼Œè€Œé•œåƒåŒ…å«äº†æ¥è‡ªä¸¤ä¸ªé•œåƒå±‚çš„ 6 ä¸ªæ–‡ä»¶ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306152919748.png" alt="image-20210306152919748"></p>
<p>ä¸Šå›¾ä¸­çš„é•œåƒå±‚è·Ÿä¹‹å‰å›¾ä¸­çš„ç•¥æœ‰åŒºåˆ«ï¼Œä¸»è¦ç›®çš„æ˜¯ä¾¿äºå±•ç¤ºæ–‡ä»¶ã€‚<br>ä¸‹å›¾ä¸­å±•ç¤ºäº†ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¸‰å±‚é•œåƒï¼Œåœ¨å¤–éƒ¨çœ‹æ¥æ•´ä¸ªé•œåƒåªæœ‰ 6 ä¸ªæ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºæœ€ä¸Šå±‚ä¸­çš„æ–‡ä»¶<br>7 æ˜¯æ–‡ä»¶ 5 çš„ä¸€ä¸ªæ›´æ–°ç‰ˆæœ¬ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306152937874.png" alt="image-20210306152937874"></p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œä¸Šå±‚é•œåƒå±‚ä¸­çš„æ–‡ä»¶è¦†ç›–äº†åº•å±‚é•œåƒå±‚ä¸­çš„æ–‡ä»¶ã€‚è¿™æ ·å°±ä½¿å¾—æ–‡ä»¶çš„æ›´æ–°ç‰ˆæœ¬ä½œä¸ºä¸€ä¸ªæ–°<br>é•œåƒå±‚æ·»åŠ åˆ°é•œåƒå½“ä¸­ã€‚<br>Docker é€šè¿‡å­˜å‚¨å¼•æ“ï¼ˆæ–°ç‰ˆæœ¬é‡‡ç”¨å¿«ç…§æœºåˆ¶ï¼‰çš„æ–¹å¼æ¥å®ç°é•œåƒå±‚å †æ ˆï¼Œå¹¶ä¿è¯å¤šé•œåƒå±‚å¯¹å¤–å±•ç¤ºä¸ºç»Ÿ<br>ä¸€çš„æ–‡ä»¶ç³»ç»Ÿã€‚<br>Linux ä¸Šå¯ç”¨çš„å­˜å‚¨å¼•æ“æœ‰ AUFSã€Overlay2ã€Device Mapperã€Btrfs ä»¥åŠ ZFSã€‚é¡¾åæ€ä¹‰ï¼Œæ¯ç§å­˜å‚¨<br>å¼•æ“éƒ½åŸºäº Linux ä¸­å¯¹åº”çš„æ–‡ä»¶ç³»ç»Ÿæˆ–è€…å—è®¾å¤‡æŠ€æœ¯ï¼Œå¹¶ä¸”æ¯ç§å­˜å‚¨å¼•æ“éƒ½æœ‰å…¶ç‹¬æœ‰çš„æ€§èƒ½ç‰¹ç‚¹ã€‚<br>Docker åœ¨ Windows ä¸Šä»…æ”¯æŒ windowsfilter ä¸€ç§å­˜å‚¨å¼•æ“ï¼Œè¯¥å¼•æ“åŸºäº NTFS æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šå®ç°äº†åˆ†<br>å±‚å’Œ CoW[1]ã€‚<br>ä¸‹å›¾å±•ç¤ºäº†ä¸ç³»ç»Ÿæ˜¾ç¤ºç›¸åŒçš„ä¸‰å±‚é•œåƒã€‚æ‰€æœ‰é•œåƒå±‚å †å å¹¶åˆå¹¶ï¼Œå¯¹å¤–æä¾›ç»Ÿä¸€çš„è§†å›¾ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306153005448.png" alt="image-20210306153005448"></p>
<ul>
<li>ç‰¹ç‚¹</li>
</ul>
<p>Dockeré•œåƒéƒ½æ˜¯åªè¯»çš„ï¼Œå½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„å¯å†™å±‚è¢«åŠ è½½åˆ°é•œåƒçš„é¡¶éƒ¨ï¼<br>è¿™ä¸€å±‚å°±æ˜¯æˆ‘ä»¬é€šå¸¸è¯´çš„å®¹å™¨å±‚ï¼Œå®¹å™¨ä¹‹ä¸‹çš„éƒ½å«é•œåƒå±‚ï¼</p>
<h3 id="2-é•œåƒCommit"><a href="#2-é•œåƒCommit" class="headerlink" title="2.é•œåƒCommit"></a>2.é•œåƒCommit</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker commit # ä»å®¹å™¨åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒ</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯­æ³•</span></span><br><span class="line">docker commit -m=&quot;æäº¤çš„æè¿°ä¿¡æ¯&quot; -a=&quot;ä½œè€…&quot; å®¹å™¨id è¦åˆ›å»ºçš„ç›®æ ‡é•œåƒå:[æ ‡ç­¾å]</span><br></pre></td></tr></table></figure>

<h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1ã€ä»Docker Hub ä¸‹è½½tomcaté•œåƒåˆ°æœ¬åœ°å¹¶è¿è¡Œ -it äº¤äº’ç»ˆç«¯ -p ç«¯å£æ˜ å°„</span></span><br><span class="line">docker run -it -p 8080:8080 tomcat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ³¨æ„ï¼šå‘çˆ¹ï¼šdockerå¯åŠ¨å®˜æ–¹tomcaté•œåƒçš„å®¹å™¨ï¼Œå‘ç°404æ˜¯å› ä¸ºä½¿ç”¨äº†åŠ é€Ÿå™¨ï¼Œè€ŒåŠ é€Ÿå™¨é‡Œçš„tomcatçš„webappsä¸‹æ²¡æœ‰rootç­‰æ–‡ä»¶ï¼</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½tomcatå®˜æ–¹é•œåƒï¼Œå°±æ˜¯è¿™ä¸ªé•œåƒï¼ˆé˜¿é‡Œäº‘é‡Œçš„tomcatçš„webappsä¸‹æ²¡æœ‰ä»»ä½•æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥tomcatæŸ¥çœ‹<span class="built_in">cd</span>åˆ°webappsä¸‹å‘ç°å…¨éƒ¨ç©ºçš„ï¼Œåè€Œæœ‰ä¸ªwebapps.disté‡Œæœ‰å¯¹åº”æ–‡ä»¶ï¼Œcp -råˆ°webappsä¸‹ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2.è¿›å…¥åˆ°tomcatç›®å½•ä¸­</span></span><br><span class="line">docker exec -it å®¹å™¨ID /bin/bash</span><br><span class="line">/usr/local/tomcat # ce webapps/</span><br><span class="line">/usr/local/tomcat/webapps # ls -l # æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ docsæ–‡ä»¶å¤¹</span><br><span class="line">/usr/local/tomcat/webapps # curl localhost:8080/docs/ Â # å¯ä»¥çœ‹åˆ° docs è¿”å›çš„</span><br><span class="line">å†…å®¹</span><br><span class="line">/usr/local/tomcat/webapps # rm -rf docs # åˆ é™¤å®ƒ</span><br><span class="line">/usr/local/tomcat/webapps # curl localhost:8080/docs/ Â # å†æ¬¡è®¿é—®è¿”å›404</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3ã€å½“å‰è¿è¡Œçš„tomcatå®ä¾‹å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰docsçš„å®¹å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒä¸ºæ¨¡æ¿commitä¸€ä¸ªæ²¡æœ‰docsçš„</span></span><br><span class="line">tomcatæ–°é•œåƒï¼Œ tomcat02</span><br><span class="line"></span><br><span class="line">docker ps -l Â # æŸ¥çœ‹å®¹å™¨çš„id</span><br><span class="line"></span><br><span class="line">[root@bogon ~]# docker ps -l</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">46e66e5d6c69        docker.io/tomcat    &quot;catalina.sh run&quot;   10 minutes ago      Up 10 minutes       8080/tcp            focused_khorana</span><br><span class="line">[root@bogon ~]# docker commit -a=&quot;zhuangkang&quot; -m=&quot;no tomcat docs&quot; 46e66e5d6c69 tomcat02:1.1</span><br><span class="line">sha256:a054127ff9bcfbbfad569cfc1cf52a20987774320ba060e4989f412cb7650f60</span><br><span class="line">[root@bogon ~]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED              SIZE</span><br><span class="line">tomcat02            1.1                 a054127ff9bc        About a minute ago   672 MB</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 4ã€è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬çš„é•œåƒéƒ½æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œå¤§å®¶å¯ä»¥å¯åŠ¨åŸæ¥çš„tomcatï¼Œå’Œæˆ‘ä»¬æ–°çš„tomcat02æ¥</span></span><br><span class="line">æµ‹è¯•çœ‹çœ‹ï¼</span><br><span class="line">[root@kuangshen ~]# docker run -it -p 8080:8080 tomcat02:1.1</span><br><span class="line"></span><br><span class="line">æµ‹è¯• LinuxIP:8080 è®¿é—®æˆåŠŸï¼</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306154214974.png" alt="image-20210306154214974"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306155234112.png" alt="image-20210306155234112"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306155710543.png" alt="image-20210306155710543"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306160248850.png" alt="image-20210306160248850"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306160727354.png" alt="image-20210306160727354"></p>
<h2 id="2-å®¹å™¨æ•°æ®å·"><a href="#2-å®¹å™¨æ•°æ®å·" class="headerlink" title="2.å®¹å™¨æ•°æ®å·"></a>2.å®¹å™¨æ•°æ®å·</h2><h3 id="2-1dockerç†å¿µå›é¡¾"><a href="#2-1dockerç†å¿µå›é¡¾" class="headerlink" title="2.1dockerç†å¿µå›é¡¾"></a>2.1dockerç†å¿µå›é¡¾</h3><p>å°†åº”ç”¨å’Œè¿è¡Œçš„ç¯å¢ƒæ‰“åŒ…å½¢æˆå®¹å™¨è¿è¡Œï¼Œè¿è¡Œå¯ä»¥ä¼´éšç€å®¹å™¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹äºæ•°æ®çš„è¦æ±‚ï¼Œæ˜¯å¸Œæœ›èƒ½å¤Ÿ<br>æŒä¹…åŒ–çš„ï¼<br>å°±å¥½æ¯”ï¼Œä½ å®‰è£…ä¸€ä¸ªMySQLï¼Œç»“æœä½ æŠŠå®¹å™¨åˆ äº†ï¼Œå°±ç›¸å½“äºåˆ åº“è·‘è·¯äº†ï¼Œè¿™TMä¹Ÿå¤ªæ‰¯äº†å§ï¼<br>æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›å®¹å™¨ä¹‹é—´æœ‰å¯èƒ½å¯ä»¥å…±äº«æ•°æ®ï¼ŒDockerå®¹å™¨äº§ç”Ÿçš„æ•°æ®ï¼Œå¦‚æœä¸é€šè¿‡docker commit ç”Ÿæˆ<br>æ–°çš„é•œåƒï¼Œä½¿å¾—æ•°æ®ä½œä¸ºé•œåƒçš„ä¸€éƒ¨åˆ†ä¿å­˜ä¸‹æ¥ï¼Œé‚£ä¹ˆå½“å®¹å™¨åˆ é™¤åï¼Œæ•°æ®è‡ªç„¶ä¹Ÿå°±æ²¡æœ‰äº†ï¼è¿™æ ·æ˜¯è¡Œ<br>ä¸é€šçš„ï¼<br>ä¸ºäº†èƒ½ä¿å­˜æ•°æ®åœ¨Dockerä¸­æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å·ï¼è®©æ•°æ®æŒ‚è½½åˆ°æˆ‘ä»¬æœ¬åœ°ï¼è¿™æ ·æ•°æ®å°±ä¸ä¼šå› ä¸ºå®¹å™¨åˆ é™¤<br>è€Œä¸¢å¤±äº†ï¼</p>
<h3 id="2-2ä½œç”¨"><a href="#2-2ä½œç”¨" class="headerlink" title="2.2ä½œç”¨"></a>2.2ä½œç”¨</h3><p>ä½œç”¨ï¼š<br>å·å°±æ˜¯ç›®å½•æˆ–è€…æ–‡ä»¶ï¼Œå­˜åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ä¸­ï¼Œç”±dockeræŒ‚è½½åˆ°å®¹å™¨ï¼Œä½†ä¸å±äºè”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤<br>èƒ½å¤Ÿç»•è¿‡ Union File System ï¼Œ æä¾›ä¸€äº›ç”¨äºæŒç»­å­˜å‚¨æˆ–å…±äº«æ•°æ®çš„ç‰¹æ€§ï¼š<br>å·çš„è®¾è®¡ç›®çš„å°±æ˜¯æ•°æ®çš„æŒä¹…åŒ–ï¼Œå®Œå…¨ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå­˜å‘¨æœŸï¼Œå› æ­¤Dockerä¸ä¼šåœ¨å®¹å™¨åˆ é™¤æ—¶åˆ é™¤å…¶æŒ‚<br>è½½çš„æ•°æ®å·ã€‚</p>
<h3 id="2-3ç‰¹ç‚¹"><a href="#2-3ç‰¹ç‚¹" class="headerlink" title="2.3ç‰¹ç‚¹"></a>2.3ç‰¹ç‚¹</h3><p>1ã€æ•°æ®å·å¯åœ¨å®¹å™¨ä¹‹é—´å…±äº«æˆ–é‡ç”¨æ•°æ®<br>2ã€å·ä¸­çš„æ›´æ”¹å¯ä»¥ç›´æ¥ç”Ÿæ•ˆ<br>3ã€æ•°æ®å·ä¸­çš„æ›´æ”¹ä¸ä¼šåŒ…å«åœ¨é•œåƒçš„æ›´æ–°ä¸­<br>4ã€æ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢<br><strong>æ‰€ä»¥ï¼šæ€»ç»“ä¸€å¥è¯ï¼š å°±æ˜¯å®¹å™¨çš„æŒä¹…åŒ–ï¼Œä»¥åŠå®¹å™¨é—´çš„ç»§æ‰¿å’Œæ•°æ®å…±äº«ï¼</strong></p>
<h2 id="3-ä½¿ç”¨æ•°æ®å·"><a href="#3-ä½¿ç”¨æ•°æ®å·" class="headerlink" title="3.ä½¿ç”¨æ•°æ®å·"></a>3.ä½¿ç”¨æ•°æ®å·</h2><ul>
<li>æ–¹å¼ä¸€ï¼šå®¹å™¨ä¸­ ç›´æ¥ç”¨å‘½ä»¤æ¥æ·»åŠ </li>
</ul>
<p>æŒ‚è½½</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å‘½ä»¤</span><br><span class="line">docker run -it -v å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:å®¹å™¨å†…ç›®å½• é•œåƒå</span><br><span class="line"># æµ‹è¯•</span><br><span class="line">[root@root~]# docker run -it -v &#x2F;home&#x2F;ceshi:&#x2F;home centos &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•°æ®å·æ˜¯å¦æŒ‚è½½æˆåŠŸ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker inspect å®¹å™¨ID</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•å®¹å™¨å’Œå®¿ä¸»æœºä¹‹é—´æ•°æ®æ˜¯å¦å…±äº«ï¼</p>
<p>æµ‹è¯•å®¹å™¨åœæ­¢é€€å‡ºåï¼Œä¸»æœºä¿®æ”¹æ•°æ®æ˜¯å¦ä¼šåŒæ­¥ï¼</p>
<ol>
<li>åœæ­¢å®¹å™¨</li>
<li>åœ¨å®¿ä¸»æœºä¸Šä¿®æ”¹æ–‡ä»¶ï¼Œå¢åŠ äº›å†…å®¹</li>
<li>å¯åŠ¨åˆšæ‰åœæ­¢çš„å®¹å™¨</li>
<li>ç„¶åæŸ¥çœ‹å¯¹åº”çš„æ–‡ä»¶ï¼Œå‘ç°æ•°æ®ä¾æ—§åŒæ­¥ï¼ok</li>
</ol>
<h2 id="4-ä½¿ç”¨dockerå®‰è£…mysql"><a href="#4-ä½¿ç”¨dockerå®‰è£…mysql" class="headerlink" title="4.ä½¿ç”¨dockerå®‰è£…mysql"></a>4.ä½¿ç”¨dockerå®‰è£…mysql</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.æœç´¢é•œåƒ</span></span><br><span class="line">docker search mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.æ‹‰å–é•œåƒ</span></span><br><span class="line">docker pull mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3å¯åŠ¨å®¹å™¨ -e ç¯å¢ƒå˜é‡ï¼</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ³¨æ„ï¼š mysqlçš„æ•°æ®åº”è¯¥ä¸ä¸¢å¤±ï¼å…ˆä½“éªŒä¸‹ -v æŒ‚è½½å·ï¼</span></span><br><span class="line">docker run -d -p 3310:3306 -v</span><br><span class="line">/home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e</span><br><span class="line">MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4ã€ä½¿ç”¨æœ¬åœ°çš„sqlyogè¿æ¥æµ‹è¯•ä¸€ä¸‹ 3310</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 5ã€æŸ¥çœ‹æœ¬åœ°çš„ /home/mysql ç›®å½• <span class="built_in">pwd</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 6ã€åˆ é™¤mysqlå®¹å™¨</span></span><br><span class="line">docker rm -f mysql01</span><br></pre></td></tr></table></figure>

<h2 id="5-åŒ¿åå’Œå…·åæŒ‚è½½"><a href="#5-åŒ¿åå’Œå…·åæŒ‚è½½" class="headerlink" title="5.åŒ¿åå’Œå…·åæŒ‚è½½"></a>5.åŒ¿åå’Œå…·åæŒ‚è½½</h2><p>ä»¥nginxä¸ºä¾‹ï¼</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åŒ¿åæŒ‚è½½</span></span><br><span class="line">-v å®¹å™¨å†…è·¯å¾„</span><br><span class="line">docker run -d -P --name nginx01 -v /etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash"> åŒ¿åæŒ‚è½½çš„ç¼ºç‚¹ï¼Œå°±æ˜¯ä¸å¥½ç»´æŠ¤ï¼Œé€šå¸¸ä½¿ç”¨å‘½ä»¤ docker volumeç»´æŠ¤</span></span><br><span class="line">docker volume ls</span><br><span class="line"><span class="meta">#</span><span class="bash"> å…·åæŒ‚è½½</span></span><br><span class="line">-v å·å:/å®¹å™¨å†…è·¯å¾„</span><br><span class="line">docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æŒ‚è½½çš„è·¯å¾„</span></span><br><span class="line">docker volume inspect nginxconfig</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ€ä¹ˆåˆ¤æ–­æŒ‚è½½çš„æ˜¯å·åè€Œä¸æ˜¯æœ¬æœºç›®å½•åï¼Ÿ</span></span><br><span class="line">ä¸æ˜¯/å¼€å§‹å°±æ˜¯å·åï¼Œæ˜¯/å¼€å§‹å°±æ˜¯ç›®å½•å</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ”¹å˜æ–‡ä»¶çš„è¯»å†™æƒé™</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ro: <span class="built_in">readonly</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rw: readwrite</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŒ‡å®šå®¹å™¨å¯¹æˆ‘ä»¬æŒ‚è½½å‡ºæ¥çš„å†…å®¹çš„è¯»å†™æƒé™</span></span><br><span class="line">docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx:ro nginx</span><br><span class="line">docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx:rw nginx</span><br></pre></td></tr></table></figure>

<h2 id="6-DockerFile"><a href="#6-DockerFile" class="headerlink" title="6.DockerFile"></a>6.DockerFile</h2><p>å¾®æœåŠ¡æ‰“åŒ…æˆé•œåƒï¼Œä»»ä½•è£…äº†Dockerçš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä¸‹è½½ä½¿ç”¨ï¼Œæå…¶çš„æ–¹ä¾¿ã€‚<br>æµç¨‹ï¼šå¼€å‘åº”ç”¨=&gt;DockerFile=&gt;æ‰“åŒ…ä¸ºé•œåƒ=&gt;ä¸Šä¼ åˆ°ä»“åº“ï¼ˆç§æœ‰ä»“åº“ï¼Œå…¬æœ‰ä»“åº“ï¼‰=&gt; ä¸‹è½½é•œåƒ =&gt; å¯åŠ¨<br>è¿è¡Œã€‚</p>
<h3 id="6-1æ¦‚å¿µ"><a href="#6-1æ¦‚å¿µ" class="headerlink" title="6.1æ¦‚å¿µ"></a>6.1æ¦‚å¿µ</h3><p>dockerfileæ˜¯ç”¨æ¥æ„å»ºDockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ã€‚<br>æ„å»ºæ­¥éª¤ï¼š<br>1ã€ç¼–å†™DockerFileæ–‡ä»¶<br>2ã€docker build æ„å»ºé•œåƒ<br>3ã€docker run</p>
<h3 id="6-2DockerFileæ„å»ºè¿‡ç¨‹"><a href="#6-2DockerFileæ„å»ºè¿‡ç¨‹" class="headerlink" title="6.2DockerFileæ„å»ºè¿‡ç¨‹"></a>6.2DockerFileæ„å»ºè¿‡ç¨‹</h3><h4 id="6-2-1åŸºç¡€çŸ¥è¯†"><a href="#6-2-1åŸºç¡€çŸ¥è¯†" class="headerlink" title="6.2.1åŸºç¡€çŸ¥è¯†"></a>6.2.1åŸºç¡€çŸ¥è¯†</h4><p>1ã€æ¯æ¡ä¿ç•™å­—æŒ‡ä»¤éƒ½å¿…é¡»ä¸ºå¤§å†™å­—æ¯ä¸”åé¢è¦è·Ÿéšè‡³å°‘ä¸€ä¸ªå‚æ•°<br>2ã€æŒ‡ä»¤æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹ï¼Œé¡ºåºæ‰§è¡Œ<br>3ã€# è¡¨ç¤ºæ³¨é‡Š<br>4ã€æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒå±‚ï¼Œå¹¶å¯¹é•œåƒè¿›è¡Œæäº¤</p>
<h4 id="6-2-2æµç¨‹"><a href="#6-2-2æµç¨‹" class="headerlink" title="6.2.2æµç¨‹"></a>6.2.2æµç¨‹</h4><p>1ã€dockerä»åŸºç¡€é•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨<br>2ã€æ‰§è¡Œä¸€æ¡æŒ‡ä»¤å¹¶å¯¹å®¹å™¨åšå‡ºä¿®æ”¹<br>3ã€æ‰§è¡Œç±»ä¼¼ docker commit çš„æ“ä½œæäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚<br>4ã€Dockerå†åŸºäºåˆšæäº¤çš„é•œåƒè¿è¡Œä¸€ä¸ªæ–°å®¹å™¨<br>5ã€æ‰§è¡Œdockerfileä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ç›´åˆ°æ‰€æœ‰æŒ‡ä»¤éƒ½æ‰§è¡Œå®Œæˆï¼</p>
<h4 id="6-2-3è¯´æ˜"><a href="#6-2-3è¯´æ˜" class="headerlink" title="6.2.3è¯´æ˜"></a>6.2.3è¯´æ˜</h4><p>ä»åº”ç”¨è½¯ä»¶çš„è§’åº¦æ¥çœ‹ï¼ŒDockerFileï¼Œdockeré•œåƒä¸dockerå®¹å™¨åˆ†åˆ«ä»£è¡¨è½¯ä»¶çš„ä¸‰ä¸ªä¸åŒé˜¶æ®µã€‚<br>DockerFile æ˜¯è½¯ä»¶çš„åŸææ–™ ï¼ˆä»£ç ï¼‰<br>Docker é•œåƒåˆ™æ˜¯è½¯ä»¶çš„äº¤ä»˜å“ ï¼ˆ.apkï¼‰<br>Docker å®¹å™¨åˆ™æ˜¯è½¯ä»¶çš„è¿è¡ŒçŠ¶æ€ ï¼ˆå®¢æˆ·ä¸‹è½½å®‰è£…æ‰§è¡Œï¼‰<br>DockerFile é¢å‘å¼€å‘ï¼ŒDockeré•œåƒæˆä¸ºäº¤ä»˜æ ‡å‡†ï¼ŒDockerå®¹å™¨åˆ™æ¶‰åŠéƒ¨ç½²ä¸è¿ç»´ï¼Œä¸‰è€…ç¼ºä¸€ä¸å¯ï¼</p>
<p>DockerFileï¼šéœ€è¦å®šä¹‰ä¸€ä¸ªDockerFileï¼ŒDockerFileå®šä¹‰äº†è¿›ç¨‹éœ€è¦çš„ä¸€åˆ‡ä¸œè¥¿ã€‚DockerFileæ¶‰åŠçš„å†…å®¹<br>åŒ…æ‹¬æ‰§è¡Œä»£ç æˆ–è€…æ˜¯æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€ä¾èµ–åŒ…ã€è¿è¡Œæ—¶ç¯å¢ƒã€åŠ¨æ€é“¾æ¥åº“ã€æ“ä½œç³»ç»Ÿçš„å‘è¡Œç‰ˆã€æœåŠ¡è¿›<br>ç¨‹å’Œå†…æ ¸è¿›ç¨‹ï¼ˆå½“å¼•ç”¨è¿›è¡Œéœ€è¦å’Œç³»ç»ŸæœåŠ¡å’Œå†…æ ¸è¿›ç¨‹æ‰“äº¤é“ï¼Œè¿™æ—¶éœ€è¦è€ƒè™‘å¦‚ä½•è®¾è®¡ namespaceçš„æƒ<br>é™æ§åˆ¶ï¼‰ç­‰ç­‰ã€‚<br>Dockeré•œåƒï¼šåœ¨DockerFile å®šä¹‰äº†ä¸€ä¸ªæ–‡ä»¶ä¹‹åï¼ŒDocker build æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªDockeré•œåƒï¼Œå½“è¿è¡Œ<br>Docker é•œåƒæ—¶ï¼Œä¼šçœŸæ­£å¼€å§‹æä¾›æœåŠ¡ï¼›<br>Dockerå®¹å™¨ï¼šå®¹å™¨æ˜¯ç›´æ¥æä¾›æœåŠ¡çš„ã€‚</p>
<h2 id="7-DockerFileæŒ‡ä»¤"><a href="#7-DockerFileæŒ‡ä»¤" class="headerlink" title="7.DockerFileæŒ‡ä»¤"></a>7.DockerFileæŒ‡ä»¤</h2><h4 id="7-1å…³é”®å­—"><a href="#7-1å…³é”®å­—" class="headerlink" title="7.1å…³é”®å­—"></a>7.1å…³é”®å­—</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FROM Â Â Â Â # åŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„</span><br><span class="line">MAINTAINER Â # é•œåƒç»´æŠ¤è€…çš„å§“åæ··åˆé‚®ç®±åœ°å€</span><br><span class="line">RUN Â Â Â Â Â # å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤</span><br><span class="line">EXPOSE Â Â Â # å½“å‰å®¹å™¨å¯¹å¤–ä¿ç•™å‡ºçš„ç«¯å£</span><br><span class="line">WORKDIR Â Â Â # æŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»å½•çš„è¿›æ¥å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹</span><br><span class="line">ENV Â Â Â Â Â # ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="line">ADD Â Â Â Â Â # å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…</span><br><span class="line">COPY Â Â Â Â # ç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ï¼</span><br><span class="line">VOLUME Â Â Â # å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ</span><br><span class="line">CMD Â Â Â Â Â # æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼ŒdockerFileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä½†åªæœ‰æœ€</span><br><span class="line">åä¸€ä¸ªç”Ÿæ•ˆï¼</span><br><span class="line">ENTRYPOINT Â # æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼å’ŒCMDä¸€æ ·</span><br><span class="line">ONBUILD Â Â Â # å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„DockerFileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­é•œåƒç»§æ‰¿åï¼Œçˆ¶é•œåƒçš„</span><br><span class="line">ONBUILDè¢«è§¦å‘</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306162408373.png" alt="image-20210306162408373"></p>
<h3 id="7-2è‡ªå®šä¹‰ä¸€ä¸ªcentos"><a href="#7-2è‡ªå®šä¹‰ä¸€ä¸ªcentos" class="headerlink" title="7.2è‡ªå®šä¹‰ä¸€ä¸ªcentos"></a>7.2è‡ªå®šä¹‰ä¸€ä¸ªcentos</h3><h4 id="7-2-1-ç¼–å†™DockerFile"><a href="#7-2-1-ç¼–å†™DockerFile" class="headerlink" title="7.2.1.ç¼–å†™DockerFile"></a>7.2.1.ç¼–å†™DockerFile</h4><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306162536380.png" alt="image-20210306162536380"></p>
<p>ç›®çš„ï¼šä½¿æˆ‘ä»¬è‡ªå·±çš„é•œåƒå…·å¤‡å¦‚ä¸‹ï¼šç™»é™†åçš„é»˜è®¤è·¯å¾„ã€vimç¼–è¾‘å™¨ã€æŸ¥çœ‹ç½‘ç»œé…ç½®ifconfigæ”¯æŒ<br>å‡†å¤‡ç¼–å†™DockerFlieæ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.åˆ›å»ºä¸€ä¸ªç›®å½•</span></span><br><span class="line">mkdir dockerfile-test</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.ç¼–å†™æ–‡ä»¶</span></span><br><span class="line">vim mydockerfile-test</span><br><span class="line"></span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER zhuangkang&lt;2247830091@qq.com&gt;</span><br><span class="line">ENV MYPATH /usr/local # é»˜è®¤è·¯å¾„</span><br><span class="line">WORKDIR $MYPATH  # å·¥ä½œè·¯å¾„</span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD echo $MYPATH</span><br><span class="line">CMD echo &quot;----------end--------&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡catå‘½ä»¤æŸ¥çœ‹</span></span><br><span class="line">cat mydockerfile-test</span><br></pre></td></tr></table></figure>

<h4 id="7-2-2-æ„å»º"><a href="#7-2-2-æ„å»º" class="headerlink" title="7.2.2.æ„å»º"></a>7.2.2.æ„å»º</h4><p>docker build -f dockerfileåœ°å€ -t æ–°é•œåƒåå­—:TAG .</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker build -f mydockerfile-centos -t mycentos:0.1</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> çœ‹åˆ°ä¸‹é¢å°±æ˜¯æˆåŠŸï¼</span></span><br><span class="line">Successfully built 18888023317c</span><br><span class="line">Successfully tagged mycentos:0.1</span><br></pre></td></tr></table></figure>

<h4 id="7-2-3-è¿è¡Œ"><a href="#7-2-3-è¿è¡Œ" class="headerlink" title="7.2.3. è¿è¡Œ"></a>7.2.3. è¿è¡Œ</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -it æ–°é•œåƒåå­—:TAG</span><br></pre></td></tr></table></figure>

<h4 id="7-2-4-åˆ—å‡ºé•œåƒåœ°çš„å˜æ›´å†å²"><a href="#7-2-4-åˆ—å‡ºé•œåƒåœ°çš„å˜æ›´å†å²" class="headerlink" title="7.2.4.åˆ—å‡ºé•œåƒåœ°çš„å˜æ›´å†å²"></a>7.2.4.åˆ—å‡ºé•œåƒåœ°çš„å˜æ›´å†å²</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker history é•œåƒå</span><br></pre></td></tr></table></figure>

<h2 id="8-Dockerç½‘ç»œ"><a href="#8-Dockerç½‘ç»œ" class="headerlink" title="8.Dockerç½‘ç»œ"></a>8.Dockerç½‘ç»œ</h2><p>é¦–å…ˆæ¸…ç©ºæ‰€æœ‰å®¹å™¨å’Œé•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker rm -f $(docker ps -a -q) Â Â Â Â Â Â # åˆ é™¤æ‰€æœ‰å®¹å™¨</span><br><span class="line">docker rmi -f $(docker images -qa) Â Â Â Â Â # åˆ é™¤å…¨éƒ¨é•œåƒ</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306163506426.png" alt="image-20210306163506426"></p>
<p>å®é™…åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¼€å‘äº†å¾ˆå¤šå¾®æœåŠ¡é¡¹ç›®ï¼Œé‚£äº›å¾®æœåŠ¡é¡¹ç›®éƒ½è¦è¿æ¥æ•°æ®åº“ï¼Œéœ€è¦æŒ‡å®šæ•°æ®åº“çš„urlåœ°<br>å€ï¼Œé€šè¿‡ipã€‚ä½†æ˜¯æˆ‘ä»¬ç”¨Dockerç®¡ç†çš„è¯ï¼Œå‡è®¾æ•°æ®åº“å‡ºé—®é¢˜äº†ï¼Œæˆ‘ä»¬é‡æ–°å¯åŠ¨è¿è¡Œä¸€ä¸ªï¼Œè¿™ä¸ªæ—¶å€™æ•°<br>æ®åº“çš„åœ°å€å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œdockerä¼šç»™æ¯ä¸ªå®¹å™¨éƒ½åˆ†é…ä¸€ä¸ªipï¼Œä¸”å®¹å™¨å’Œå®¹å™¨ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è®¿é—®çš„ã€‚<br>æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸‹å®¹å™¨ä¹‹é—´èƒ½ä¸èƒ½pingé€šè¿‡ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@bogon ~]# docker exec -it tomcat01 ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">12: eth0@if13: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default</span><br><span class="line">    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet 172.17.0.2/16 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:acff:fe11:2/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">[root@bogon ~]# ping 172.17.0.2</span><br><span class="line">PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.089 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.048 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.060 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=4 ttl=64 time=0.047 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=5 ttl=64 time=0.045 ms</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="8-1åŸç†"><a href="#8-1åŸç†" class="headerlink" title="8.1åŸç†"></a>8.1åŸç†</h4><ul>
<li><p>1ã€æ¯ä¸€ä¸ªå®‰è£…äº†Dockerçš„linuxä¸»æœºéƒ½æœ‰ä¸€ä¸ªdocker0çš„è™šæ‹Ÿç½‘å¡ã€‚è¿™æ˜¯ä¸ªæ¡¥æ¥ç½‘å¡ï¼Œä½¿ç”¨äº†veth-pair<br>æŠ€æœ¯ï¼</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306164255054.png" alt="image-20210306164405468"></p>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306163525959.png" alt="image-20210306163525959"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306163607386.png" alt="image-20210306163607386"></p>
<ul>
<li>2.æ¯å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œlinuxä¸»æœºå°±ä¼šå¤šäº†ä¸€ä¸ªè™šæ‹Ÿç½‘å¡ã€‚</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d -P --name tomcat02 tomcat	# å†å¯åŠ¨ä¸€ä¸ªtomcat2</span><br><span class="line"></span><br><span class="line">docker exec -it tomcat02 ip addr # æŸ¥çœ‹ip</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§‚å¯Ÿç°è±¡ï¼š</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> tomcat --- linuxä¸»æœº vethc8584ea@if122 ---- å®¹å™¨å†… eth0@if123</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> tomcat --- linuxä¸»æœº veth021eeea@if124 ---- å®¹å™¨å†… eth0@if125</span></span><br></pre></td></tr></table></figure>

<ul>
<li>3.ç½‘ç»œæ¨¡å‹å›¾</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306164643127.png" alt="image-20210306164643127"></p>
<ul>
<li><p>4.ç»“è®º</p>
</li>
<li><p>tomcat1å’Œtomcat2å…±ç”¨ä¸€ä¸ªè·¯ç”±å™¨ã€‚æ˜¯çš„ï¼Œä»–ä»¬ä½¿ç”¨çš„ä¸€ä¸ªï¼Œå°±æ˜¯docker0ã€‚ä»»ä½•ä¸€ä¸ªå®¹å™¨å¯åŠ¨<br>é»˜è®¤éƒ½æ˜¯docker0ç½‘ç»œã€‚<br>dockeré»˜è®¤ä¼šç»™å®¹å™¨åˆ†é…ä¸€ä¸ªå¯ç”¨ipã€‚</p>
</li>
<li><p>Dockerä½¿ç”¨Linuxæ¡¥æ¥ï¼Œåœ¨å®¿ä¸»æœºè™šæ‹Ÿä¸€ä¸ªDockerå®¹å™¨ç½‘æ¡¥(docker0)ï¼ŒDockerå¯åŠ¨ä¸€ä¸ªå®¹å™¨æ—¶ä¼šæ ¹æ®<br>Dockerç½‘æ¡¥çš„ç½‘æ®µåˆ†é…ç»™å®¹å™¨ä¸€ä¸ªIPåœ°å€ï¼Œç§°ä¸ºContainer-IPï¼ŒåŒæ—¶Dockerç½‘æ¡¥æ˜¯æ¯ä¸ªå®¹å™¨çš„é»˜è®¤ç½‘<br>å…³ã€‚å› ä¸ºåœ¨åŒä¸€å®¿ä¸»æœºå†…çš„å®¹å™¨éƒ½æ¥å…¥åŒä¸€ä¸ªç½‘æ¡¥ï¼Œè¿™æ ·å®¹å™¨ä¹‹é—´å°±èƒ½å¤Ÿé€šè¿‡å®¹å™¨çš„Container-IPç›´æ¥<br>é€šä¿¡ã€‚</p>
</li>
</ul>
<h3 id="8-2æ‰€æœ‰ç½‘ç»œæ¨¡å¼"><a href="#8-2æ‰€æœ‰ç½‘ç»œæ¨¡å¼" class="headerlink" title="8.2æ‰€æœ‰ç½‘ç»œæ¨¡å¼"></a>8.2æ‰€æœ‰ç½‘ç»œæ¨¡å¼</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210306164928025.png" alt="image-20210306164928025"></p>
<h2 id="9-éƒ¨ç½²Redisé›†ç¾¤"><a href="#9-éƒ¨ç½²Redisé›†ç¾¤" class="headerlink" title="9.éƒ¨ç½²Redisé›†ç¾¤"></a>9.éƒ¨ç½²Redisé›†ç¾¤</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºç½‘å¡</span></span><br><span class="line">docker network create redis --subnet 172.38.0.0/16</span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡è„šæœ¬åˆ›å»ºå…­ä¸ªredisé…ç½®</span></span><br><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt; EOF &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF</span><br><span class="line">done</span><br><span class="line">docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/data:/data \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172.38.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server</span><br><span class="line">/etc/redis/redis.conf; \</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨6ä¸ªå®¹å™¨</span></span><br><span class="line">docker run -p 6371:6379 -p 16371:16379 --name redis-1 \</span><br><span class="line">-v /mydata/redis/node-1/data:/data \</span><br><span class="line">-v /mydata/redis/node-1/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172.38.0.11 redis:5.0.9-alpine3.11 redis-server</span><br><span class="line">/etc/redis/redis.conf</span><br><span class="line">docker run -p 6376:6379 -p 16376:16379 --name redis-6 \</span><br><span class="line">-v /mydata/redis/node-6/data:/data \</span><br><span class="line">-v /mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172.38.0.16 redis:5.0.9-alpine3.11 redis-server</span><br><span class="line">/etc/redis/redis.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥ä¸€ä¸ªredisï¼Œæ³¨æ„è¿™é‡Œæ˜¯ shå‘½ä»¤</span></span><br><span class="line">docker exec -it redis-1 /bin/sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºé›†ç¾¤</span></span><br><span class="line">redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379</span><br><span class="line">172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --</span><br><span class="line">cluster-replicas 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿æ¥é›†ç¾¤</span></span><br><span class="line">redis-cli -c</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯</span></span><br><span class="line">cluster info</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹èŠ‚ç‚¹</span></span><br><span class="line">cluster nodes</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span> a b</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åœæ­¢åˆ°å­˜å€¼çš„å®¹å™¨</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç„¶åå†æ¬¡get aï¼Œå‘ç°ä¾æ—§å¯ä»¥è·å–å€¼</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹èŠ‚ç‚¹ï¼Œå‘ç°é«˜å¯ç”¨å®Œå…¨æ²¡é—®é¢˜</span></span><br></pre></td></tr></table></figure>

<h2 id="10-IDEAæ•´åˆRedis"><a href="#10-IDEAæ•´åˆRedis" class="headerlink" title="10.IDEAæ•´åˆRedis"></a>10.IDEAæ•´åˆRedis</h2><ul>
<li>1.åˆ›å»ºä¸€ä¸ªSpringBooté¡¹ç›®</li>
<li>2.åˆ›å»ºä¸€ä¸ªHelloController</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">Â <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">Â <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â <span class="keyword">return</span> <span class="string">&quot;hello,world&quot;</span>;</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>3.å¯åŠ¨æµ‹è¯•ï¼Œç¡®è®¤ç«¯å£æ²¡æœ‰å†²çª</li>
<li>4.ç”¨Mavenæ‰“æˆjaråŒ…</li>
<li>æ‰“åŒ…é•œåƒ</li>
<li>1.åœ¨é¡¹ç›®ä¸‹ç¼–å†™ Dockerfile æ–‡ä»¶ï¼Œå°†æ‰“åŒ…å¥½çš„jaråŒ…æ‹·è´åˆ°DockerfileåŒçº§ç›®å½•</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FROM java:8</span><br><span class="line"><span class="meta">#</span><span class="bash"> æœåŠ¡å™¨åªæœ‰dockerfileå’Œjaråœ¨åŒçº§ç›®å½•</span></span><br><span class="line">COPY *.jar /app.jar</span><br><span class="line">CMD [&quot;--server.port=8080&quot;]</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŒ‡å®šå®¹å™¨å†…è¦æš´éœ²çš„ç«¯å£</span></span><br><span class="line">EXPOSE 8080</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br></pre></td></tr></table></figure>

<ul>
<li>2.å°†Dockerfile å’Œ é¡¹ç›®çš„ jar åŒ…ä¸Šä¼ åˆ°linuxæœåŠ¡å™¨ä¸Šï¼Œæ„å»ºè¿è¡Œ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ„å»ºé•œåƒ</span></span><br><span class="line">docker build -t idea-ks .</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹é•œåƒ</span></span><br><span class="line">docker images</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿è¡Œ</span></span><br><span class="line">docker run -d -P --name idea-ks idea-ks</span><br><span class="line"></span><br><span class="line">docker ps</span><br><span class="line">curl localhost:32779</span><br><span class="line">curl localhost:32779/hello</span><br></pre></td></tr></table></figure>

<h2 id="11-å¸¸ç”¨å‘½ä»¤æ€»ç»“"><a href="#11-å¸¸ç”¨å‘½ä»¤æ€»ç»“" class="headerlink" title="11.å¸¸ç”¨å‘½ä»¤æ€»ç»“"></a>11.å¸¸ç”¨å‘½ä»¤æ€»ç»“</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/20200526095411.png"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> attach    Attach to a running container                 <span class="comment"># å½“å‰ shell ä¸‹ attach è¿æ¥æŒ‡å®šè¿è¡Œé•œåƒ</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> build     Build an image from a Dockerfile              <span class="comment"># é€šè¿‡ Dockerfile å®šåˆ¶é•œåƒ</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> commit    Create a new image from a container changes   <span class="comment"># æäº¤å½“å‰å®¹å™¨ä¸ºæ–°çš„é•œåƒ</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> cp        Copy files/folders from the containers filesystem to the host path   <span class="comment">#ä»å®¹å™¨ä¸­æ‹·è´æŒ‡å®šæ–‡ä»¶æˆ–è€…ç›®å½•åˆ°å®¿ä¸»æœºä¸­</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> create    Create a new container                        <span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼ŒåŒ runï¼Œä½†ä¸å¯åŠ¨å®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> diff      Inspect changes on a container<span class="string">&#x27;s filesystem   # æŸ¥çœ‹ docker å®¹å™¨å˜åŒ–</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> events    Get real time events from the server          <span class="comment"># ä» docker æœåŠ¡è·å–å®¹å™¨å®æ—¶äº‹ä»¶</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">exec</span>      Run a <span class="built_in">command</span> <span class="keyword">in</span> an existing container        <span class="comment"># åœ¨å·²å­˜åœ¨çš„å®¹å™¨ä¸Šè¿è¡Œå‘½ä»¤</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">export</span>    Stream the contents of a container as a tar archive   <span class="comment"># å¯¼å‡ºå®¹å™¨çš„å†…å®¹æµä½œä¸ºä¸€ä¸ª tar å½’æ¡£æ–‡ä»¶[å¯¹åº” import ]</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">history</span>   Show the <span class="built_in">history</span> of an image                  <span class="comment"># å±•ç¤ºä¸€ä¸ªé•œåƒå½¢æˆå†å²</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> images    List images                                   <span class="comment"># åˆ—å‡ºç³»ç»Ÿå½“å‰é•œåƒ</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> import    Create a new filesystem image from the contents of a tarball <span class="comment"># ä»taråŒ…ä¸­çš„å†…å®¹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿæ˜ åƒ[å¯¹åº”export]</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> info      Display system-wide information               <span class="comment"># æ˜¾ç¤ºç³»ç»Ÿç›¸å…³ä¿¡æ¯</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> inspect   Return low-level information on a container   <span class="comment"># æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">kill</span>      Kill a running container                      <span class="comment"># kill æŒ‡å®š docker å®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> load      Load an image from a tar archive              <span class="comment"># ä»ä¸€ä¸ª tar åŒ…ä¸­åŠ è½½ä¸€ä¸ªé•œåƒ[å¯¹åº” save]</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> login     Register or Login to the docker registry server    <span class="comment"># æ³¨å†Œæˆ–è€…ç™»é™†ä¸€ä¸ª docker æºæœåŠ¡å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">logout</span>    Log out from a Docker registry server          <span class="comment"># ä»å½“å‰ Docker registry é€€å‡º</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> logs      Fetch the logs of a container                 <span class="comment"># è¾“å‡ºå½“å‰å®¹å™¨æ—¥å¿—ä¿¡æ¯</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> port      Lookup the public-facing port <span class="built_in">which</span> is NAT-ed to PRIVATE_PORT    <span class="comment"># æŸ¥çœ‹æ˜ å°„ç«¯å£å¯¹åº”çš„å®¹å™¨å†…éƒ¨æºç«¯å£</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> pause     Pause all processes within a container        <span class="comment"># æš‚åœå®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> ps        List containers                               <span class="comment"># åˆ—å‡ºå®¹å™¨åˆ—è¡¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> pull      Pull an image or a repository from the docker registry server   <span class="comment"># ä»dockeré•œåƒæºæœåŠ¡å™¨æ‹‰å–æŒ‡å®šé•œåƒæˆ–è€…åº“é•œåƒ</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> push      Push an image or a repository to the docker registry server   <span class="comment"># æ¨é€æŒ‡å®šé•œåƒæˆ–è€…åº“é•œåƒè‡³dockeræºæœåŠ¡å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> restart   Restart a running container                   <span class="comment"># é‡å¯è¿è¡Œçš„å®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> rm        Remove one or more containers                 <span class="comment"># ç§»é™¤ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> rmi       Remove one or more images             <span class="comment"># ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒ[æ— å®¹å™¨ä½¿ç”¨è¯¥é•œåƒæ‰å¯åˆ é™¤ï¼Œå¦åˆ™éœ€åˆ é™¤ç›¸å…³å®¹å™¨æ‰å¯ç»§ç»­æˆ– -f å¼ºåˆ¶åˆ é™¤]</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> run       Run a <span class="built_in">command</span> <span class="keyword">in</span> a new container              <span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªå‘½ä»¤</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> save      Save an image to a tar archive                <span class="comment"># ä¿å­˜ä¸€ä¸ªé•œåƒä¸ºä¸€ä¸ª tar åŒ…[å¯¹åº” load]</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> search    Search <span class="keyword">for</span> an image on the Docker Hub         <span class="comment"># åœ¨ docker hub ä¸­æœç´¢é•œåƒ</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> start     Start a stopped containers                    <span class="comment"># å¯åŠ¨å®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> stop      Stop a running containers                     <span class="comment"># åœæ­¢å®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> tag       Tag an image into a repository                <span class="comment"># ç»™æºä¸­é•œåƒæ‰“æ ‡ç­¾</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> top       Lookup the running processes of a container   <span class="comment"># æŸ¥çœ‹å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> unpause   Unpause a paused container                    <span class="comment"># å–æ¶ˆæš‚åœå®¹å™¨</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> version   Show the docker version information           <span class="comment"># æŸ¥çœ‹ docker ç‰ˆæœ¬å·</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">wait</span>      Block until a container stops, <span class="keyword">then</span> <span class="built_in">print</span> its <span class="built_in">exit</span> code   <span class="comment"># æˆªå–å®¹å™¨åœæ­¢æ—¶çš„é€€å‡ºçŠ¶æ€å€¼</span></span></span><br></pre></td></tr></table></figure>
<hr>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>è‡ªå®šä¹‰Springæ¡†æ¶</title>
    <url>/2021/04/02/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p><strong>å­¦ä¹ åœ°å€:<a href="https://www.bilibili.com/video/BV1Np4y1z7BU?p=1">https://www.bilibili.com/video/BV1Np4y1z7BU?p=1</a></strong></p>
<h1 id="1ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶"><a href="#1ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶" class="headerlink" title="1ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶"></a>1ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶</h1><h2 id="1-1-springä½¿ç”¨å›é¡¾"><a href="#1-1-springä½¿ç”¨å›é¡¾" class="headerlink" title="1.1 springä½¿ç”¨å›é¡¾"></a>1.1 springä½¿ç”¨å›é¡¾</h2><p>è‡ªå®šä¹‰springæ¡†æ¶å‰ï¼Œå…ˆå›é¡¾ä¸€ä¸‹springæ¡†æ¶çš„ä½¿ç”¨ï¼Œä»è€Œåˆ†æspringçš„æ ¸å¿ƒï¼Œå¹¶å¯¹æ ¸å¿ƒåŠŸèƒ½è¿›è¡Œæ¨¡æ‹Ÿã€‚</p>
<ul>
<li><p>æ•°æ®è®¿é—®å±‚ã€‚å®šä¹‰UserDaoæ¥å£åŠå…¶å­å®ç°ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;userDaoImpl ....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>ä¸šåŠ¡é€»è¾‘å±‚ã€‚å®šä¹‰UserServiceæ¥å£åŠå…¶å­å®ç°ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;userServiceImpl ...&quot;</span>);</span><br><span class="line">        userDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>å®šä¹‰UserControllerç±»ï¼Œä½¿ç”¨mainæ–¹æ³•æ¨¡æ‹Ÿcontrollerå±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºspringå®¹å™¨å¯¹è±¡</span></span><br><span class="line">        ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//ä»IOCå®¹å™¨ä¸­è·å–UserServiceå¯¹è±¡</span></span><br><span class="line">        UserService userService = applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">        <span class="comment">//è°ƒç”¨UserServiceå¯¹è±¡çš„addæ–¹æ³•</span></span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™é…ç½®æ–‡ä»¶ã€‚åœ¨ç±»è·¯å¾„ä¸‹ç¼–å†™ä¸€ä¸ªåä¸ºApplicationContext.xmlçš„é…ç½®æ–‡ä»¶</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=<span class="string">&quot;userService&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.zhuang.service.impl.UserServiceImpl&quot;</span>&gt;</span><br><span class="line">        &lt;property name=&quot;userDao&quot; ref=&quot;userDao&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;userDao&quot; class=&quot;com.zhuang.dao.impl.UserDaoImpl&quot;&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>ä»£ç è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/Snipaste_2021-04-01_16-16-05.png"></p>
</li>
</ul>
<p>é€šè¿‡ä¸Šé¢ä»£ç åŠç»“æœå¯ä»¥çœ‹å‡ºï¼š</p>
<ul>
<li>userServiceå¯¹è±¡æ˜¯ä»applicationContextå®¹å™¨å¯¹è±¡è·å–åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯userServiceå¯¹è±¡äº¤ç”±springè¿›è¡Œç®¡ç†ã€‚</li>
<li>ä¸Šé¢ç»“æœå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†UserDaoå¯¹è±¡ä¸­çš„addæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´UserDaoå­å®ç°ç±»å¯¹è±¡ä¹Ÿäº¤ç”±springç®¡ç†äº†ã€‚</li>
<li>UserServiceä¸­çš„userDaoå˜é‡æˆ‘ä»¬å¹¶æ²¡æœ‰è¿›è¡Œèµ‹å€¼ï¼Œä½†æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œè¯´æ˜springå·²ç»å°†UserDaoå¯¹è±¡èµ‹å€¼ç»™äº†userDaoå˜é‡ã€‚</li>
</ul>
<p>ä¸Šé¢ä¸‰ç‚¹ä½“ç°äº†Springæ¡†æ¶çš„IOCï¼ˆInversion of Controlï¼‰å’ŒDIï¼ˆDependency Injection, DIï¼‰</p>
<h2 id="1-2-springæ ¸å¿ƒåŠŸèƒ½ç»“æ„"><a href="#1-2-springæ ¸å¿ƒåŠŸèƒ½ç»“æ„" class="headerlink" title="1.2 springæ ¸å¿ƒåŠŸèƒ½ç»“æ„"></a>1.2 springæ ¸å¿ƒåŠŸèƒ½ç»“æ„</h2><p>Springå¤§çº¦æœ‰20ä¸ªæ¨¡å—ï¼Œç”±1300å¤šä¸ªä¸åŒçš„æ–‡ä»¶æ„æˆã€‚è¿™äº›æ¨¡å—å¯ä»¥åˆ†ä¸º:</p>
<p>æ ¸å¿ƒå®¹å™¨ã€AOPå’Œè®¾å¤‡æ”¯æŒã€æ•°æ®è®¿é—®ä¸é›†æˆã€Webç»„ä»¶ã€é€šä¿¡æŠ¥æ–‡å’Œé›†æˆæµ‹è¯•ç­‰ï¼Œä¸‹é¢æ˜¯ Spring æ¡†æ¶çš„æ€»ä½“æ¶æ„å›¾ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6image-20200429111324770.png"></p>
<p>æ ¸å¿ƒå®¹å™¨ç”± beansã€coreã€context å’Œ expressionï¼ˆSpring Expression Languageï¼ŒSpELï¼‰4ä¸ªæ¨¡å—ç»„æˆã€‚</p>
<ul>
<li>spring-beanså’Œspring-coreæ¨¡å—æ˜¯Springæ¡†æ¶çš„æ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…å«äº†æ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼ŒIOCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼ŒDIï¼‰ã€‚BeanFactoryä½¿ç”¨æ§åˆ¶åè½¬å¯¹åº”ç”¨ç¨‹åºçš„é…ç½®å’Œä¾èµ–æ€§è§„èŒƒä¸å®é™…çš„åº”ç”¨ç¨‹åºä»£ç è¿›è¡Œäº†åˆ†ç¦»ã€‚BeanFactoryå±äºå»¶æ—¶åŠ è½½ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å®ä¾‹åŒ–å®¹å™¨å¯¹è±¡åå¹¶ä¸ä¼šè‡ªåŠ¨å®ä¾‹åŒ–Beanï¼Œåªæœ‰å½“Beanè¢«ä½¿ç”¨æ—¶ï¼ŒBeanFactoryæ‰ä¼šå¯¹è¯¥ Bean è¿›è¡Œå®ä¾‹åŒ–ä¸ä¾èµ–å…³ç³»çš„è£…é…ã€‚</li>
<li>spring-contextæ¨¡å—æ„æ¶äºæ ¸å¿ƒæ¨¡å—ä¹‹ä¸Šï¼Œæ‰©å±•äº†BeanFactoryï¼Œä¸ºå®ƒæ·»åŠ äº†Beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ã€æ¡†æ¶äº‹ä»¶ä½“ç³»åŠèµ„æºåŠ è½½é€æ˜åŒ–ç­‰åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œè¯¥æ¨¡å—è¿˜æä¾›äº†è®¸å¤šä¼ä¸šçº§æ”¯æŒï¼Œå¦‚é‚®ä»¶è®¿é—®ã€è¿œç¨‹è®¿é—®ã€ä»»åŠ¡è°ƒåº¦ç­‰ï¼ŒApplicationContext æ˜¯è¯¥æ¨¡å—çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒçš„è¶…ç±»æ˜¯ BeanFactoryã€‚ä¸BeanFactoryä¸åŒï¼ŒApplicationContextå®ä¾‹åŒ–åä¼šè‡ªåŠ¨å¯¹æ‰€æœ‰çš„å•å®ä¾‹Beanè¿›è¡Œå®ä¾‹åŒ–ä¸ä¾èµ–å…³ç³»çš„è£…é…ï¼Œä½¿ä¹‹å¤„äºå¾…ç”¨çŠ¶æ€ã€‚</li>
<li>spring-context-supportæ¨¡å—æ˜¯å¯¹Spring IoCå®¹å™¨åŠIoCå­å®¹å™¨çš„æ‰©å±•æ”¯æŒã€‚</li>
<li>spring-context-indexeræ¨¡å—æ˜¯Springçš„ç±»ç®¡ç†ç»„ä»¶å’ŒClasspathæ‰«æç»„ä»¶ã€‚</li>
<li>spring-expression æ¨¡å—æ˜¯ç»Ÿä¸€è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰çš„æ‰©å±•æ¨¡å—ï¼Œå¯ä»¥æŸ¥è¯¢ã€ç®¡ç†è¿è¡Œä¸­çš„å¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹è±¡æ–¹æ³•ï¼Œä»¥åŠæ“ä½œæ•°ç»„ã€é›†åˆç­‰ã€‚å®ƒçš„è¯­æ³•ç±»ä¼¼äºä¼ ç»ŸELï¼Œä½†æä¾›äº†é¢å¤–çš„åŠŸèƒ½ï¼Œæœ€å‡ºè‰²çš„è¦æ•°å‡½æ•°è°ƒç”¨å’Œç®€å•å­—ç¬¦ä¸²çš„æ¨¡æ¿å‡½æ•°ã€‚ELçš„ç‰¹æ€§æ˜¯åŸºäºSpringäº§å“çš„éœ€æ±‚è€Œè®¾è®¡çš„ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°åŒSpring IoCè¿›è¡Œäº¤äº’ã€‚</li>
</ul>
<h3 id="1-1-1-beanæ¦‚è¿°"><a href="#1-1-1-beanæ¦‚è¿°" class="headerlink" title="1.1.1 beanæ¦‚è¿°"></a>1.1.1 beanæ¦‚è¿°</h3><p>Spring å°±æ˜¯é¢å‘ <code>Bean</code> çš„ç¼–ç¨‹ï¼ˆBOP,Bean Oriented Programmingï¼‰ï¼ŒBean åœ¨ Spring ä¸­å¤„äºæ ¸å¿ƒåœ°ä½ã€‚Beanå¯¹äºSpringçš„æ„ä¹‰å°±åƒObjectå¯¹äºOOPçš„æ„ä¹‰ä¸€æ ·ï¼ŒSpringä¸­æ²¡æœ‰Beanä¹Ÿå°±æ²¡æœ‰Springå­˜åœ¨çš„æ„ä¹‰ã€‚Spring IoCå®¹å™¨é€šè¿‡é…ç½®æ–‡ä»¶æˆ–è€…æ³¨è§£çš„æ–¹å¼æ¥ç®¡ç†beanå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p>
<p>springä¸­beanç”¨äºå¯¹ä¸€ä¸ªç±»è¿›è¡Œå°è£…ã€‚å¦‚ä¸‹é¢çš„é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆBeanå¦‚æ­¤é‡è¦å‘¢ï¼Ÿ</p>
<ul>
<li>spring å°†beanå¯¹è±¡äº¤ç”±ä¸€ä¸ªå«IOCå®¹å™¨è¿›è¡Œç®¡ç†ã€‚</li>
<li>beanå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»åœ¨é…ç½®æ–‡ä»¶ä¸­ä½“ç°ï¼Œå¹¶ç”±springå®Œæˆã€‚</li>
</ul>
<h2 id="1-3-Spring-IOCç›¸å…³æ¥å£åˆ†æ"><a href="#1-3-Spring-IOCç›¸å…³æ¥å£åˆ†æ" class="headerlink" title="1.3 Spring IOCç›¸å…³æ¥å£åˆ†æ"></a>1.3 Spring IOCç›¸å…³æ¥å£åˆ†æ</h2><h3 id="1-3-1-BeanFactoryè§£æ"><a href="#1-3-1-BeanFactoryè§£æ" class="headerlink" title="1.3.1 BeanFactoryè§£æ"></a>1.3.1 BeanFactoryè§£æ</h3><p>Springä¸­Beançš„åˆ›å»ºæ˜¯å…¸å‹çš„å·¥å‚æ¨¡å¼ï¼Œè¿™ä¸€ç³»åˆ—çš„Beanå·¥å‚ï¼Œå³IoCå®¹å™¨ï¼Œä¸ºå¼€å‘è€…ç®¡ç†å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»æä¾›äº†å¾ˆå¤šä¾¿åˆ©å’ŒåŸºç¡€æœåŠ¡ï¼Œåœ¨Springä¸­æœ‰è®¸å¤šIoCå®¹å™¨çš„å®ç°ä¾›ç”¨æˆ·é€‰æ‹©ï¼Œå…¶ç›¸äº’å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6image-20200429185050396.png"></p>
<p>å…¶ä¸­ï¼ŒBeanFactoryä½œä¸ºæœ€é¡¶å±‚çš„ä¸€ä¸ªæ¥å£ï¼Œå®šä¹‰äº†IoCå®¹å™¨çš„åŸºæœ¬åŠŸèƒ½è§„èŒƒï¼ŒBeanFactoryæœ‰ä¸‰ä¸ªé‡è¦çš„å­æ¥å£ï¼šListableBeanFactoryã€HierarchicalBeanFactoryå’ŒAutowireCapableBeanFactoryã€‚ä½†æ˜¯ä»ç±»å›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°æœ€ç»ˆçš„é»˜è®¤å®ç°ç±»æ˜¯DefaultListableBeanFactoryï¼Œå®ƒå®ç°äº†æ‰€æœ‰çš„æ¥å£ã€‚</p>
<p>é‚£ä¹ˆä¸ºä½•è¦å®šä¹‰è¿™ä¹ˆå¤šå±‚æ¬¡çš„æ¥å£å‘¢ï¼Ÿ</p>
<p>æ¯ä¸ªæ¥å£éƒ½æœ‰å®ƒçš„ä½¿ç”¨åœºåˆï¼Œä¸»è¦æ˜¯ä¸ºäº†åŒºåˆ†åœ¨Springå†…éƒ¨æ“ä½œè¿‡ç¨‹ä¸­å¯¹è±¡çš„ä¼ é€’å’Œè½¬åŒ–ï¼Œå¯¹å¯¹è±¡çš„æ•°æ®è®¿é—®æ‰€åšçš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œ</p>
<ul>
<li>ListableBeanFactoryæ¥å£è¡¨ç¤ºè¿™äº›Beanå¯åˆ—è¡¨åŒ–ã€‚</li>
<li>HierarchicalBeanFactoryè¡¨ç¤ºè¿™äº›Bean æ˜¯æœ‰ç»§æ‰¿å…³ç³»çš„ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ª Bean å¯èƒ½æœ‰çˆ¶ Bean</li>
<li>AutowireCapableBeanFactory æ¥å£å®šä¹‰Beançš„è‡ªåŠ¨è£…é…è§„åˆ™ã€‚</li>
</ul>
<p>è¿™ä¸‰ä¸ªæ¥å£å…±åŒå®šä¹‰äº†Beançš„é›†åˆã€Beanä¹‹é—´çš„å…³ç³»åŠBeanè¡Œä¸ºã€‚æœ€åŸºæœ¬çš„IoCå®¹å™¨æ¥å£æ˜¯BeanFactoryï¼Œæ¥çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	String FACTORY_BEAN_PREFIX = <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ ¹æ®beançš„åç§°è·å–IOCå®¹å™¨ä¸­çš„çš„beanå¯¹è±¡</span></span><br><span class="line">	<span class="function">Object <span class="title">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line">	<span class="comment">//æ ¹æ®beançš„åç§°è·å–IOCå®¹å™¨ä¸­çš„çš„beanå¯¹è±¡ï¼Œå¹¶æŒ‡å®šè·å–åˆ°çš„beanå¯¹è±¡çš„ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬ä½¿ç”¨æ—¶å°±ä¸éœ€è¦è¿›è¡Œç±»å‹å¼ºè½¬äº†</span></span><br><span class="line">	&lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(String name, Class&lt;T&gt; requiredType)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line">	<span class="function">Object <span class="title">getBean</span><span class="params">(String name, Object... args)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line">	&lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(Class&lt;T&gt; requiredType)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line">	&lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(Class&lt;T&gt; requiredType, Object... args)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line">	</span><br><span class="line">	&lt;T&gt; <span class="function">ObjectProvider&lt;T&gt; <span class="title">getBeanProvider</span><span class="params">(Class&lt;T&gt; requiredType)</span></span>;</span><br><span class="line">	&lt;T&gt; <span class="function">ObjectProvider&lt;T&gt; <span class="title">getBeanProvider</span><span class="params">(ResolvableType requiredType)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//åˆ¤æ–­å®¹å™¨ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šåç§°çš„beanå¯¹è±¡</span></span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">containsBean</span><span class="params">(String name)</span></span>;</span><br><span class="line">	<span class="comment">//æ ¹æ®beançš„åç§°åˆ¤æ–­æ˜¯å¦æ˜¯å•ä¾‹</span></span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">(String name)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">isPrototype</span><span class="params">(String name)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">isTypeMatch</span><span class="params">(String name, ResolvableType typeToMatch)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">isTypeMatch</span><span class="params">(String name, Class&lt;?&gt; typeToMatch)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line">	<span class="meta">@Nullable</span></span><br><span class="line">	Class&lt;?&gt; getType(String name) <span class="keyword">throws</span> NoSuchBeanDefinitionException;</span><br><span class="line">	String[] getAliases(String name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨BeanFactoryé‡Œåªå¯¹IoCå®¹å™¨çš„åŸºæœ¬è¡Œä¸ºåšäº†å®šä¹‰ï¼Œæ ¹æœ¬ä¸å…³å¿ƒä½ çš„Beanæ˜¯å¦‚ä½•å®šä¹‰åŠæ€æ ·åŠ è½½çš„ã€‚æ­£å¦‚æˆ‘ä»¬åªå…³å¿ƒèƒ½ä»å·¥å‚é‡Œå¾—åˆ°ä»€ä¹ˆäº§å“ï¼Œä¸å…³å¿ƒå·¥å‚æ˜¯æ€ä¹ˆç”Ÿäº§è¿™äº›äº§å“çš„ã€‚</p>
<p>BeanFactoryæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å­æ¥å£ï¼Œå°±æ˜¯ApplicationContextæ¥å£ï¼Œè¯¥æ¥å£ä¸»è¦æ¥è§„èŒƒå®¹å™¨ä¸­çš„beanå¯¹è±¡æ˜¯éå»¶æ—¶åŠ è½½ï¼Œå³åœ¨åˆ›å»ºå®¹å™¨å¯¹è±¡çš„æ—¶å€™å°±å¯¹è±¡beanè¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶å­˜å‚¨åˆ°ä¸€ä¸ªå®¹å™¨ä¸­ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6image-20200430220155371.png"></p>
<p>è¦çŸ¥é“å·¥å‚æ˜¯å¦‚ä½•äº§ç”Ÿå¯¹è±¡çš„ï¼Œæˆ‘ä»¬éœ€è¦çœ‹å…·ä½“çš„IoCå®¹å™¨å®ç°ï¼ŒSpringæä¾›äº†è®¸å¤šIoCå®¹å™¨å®ç°ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>ClasspathXmlApplicationContext : æ ¹æ®ç±»è·¯å¾„åŠ è½½xmlé…ç½®æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºIOCå®¹å™¨å¯¹è±¡ã€‚</li>
<li>FileSystemXmlApplicationContext ï¼šæ ¹æ®ç³»ç»Ÿè·¯å¾„åŠ è½½xmlé…ç½®æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºIOCå®¹å™¨å¯¹è±¡ã€‚</li>
<li>AnnotationConfigApplicationContext ï¼šåŠ è½½æ³¨è§£ç±»é…ç½®ï¼Œå¹¶åˆ›å»ºIOCå®¹å™¨ã€‚</li>
</ul>
<h3 id="1-3-2-BeanDefinitionè§£æ"><a href="#1-3-2-BeanDefinitionè§£æ" class="headerlink" title="1.3.2 BeanDefinitionè§£æ"></a>1.3.2 BeanDefinitionè§£æ</h3><p>Spring IoCå®¹å™¨ç®¡ç†æˆ‘ä»¬å®šä¹‰çš„å„ç§Beanå¯¹è±¡åŠå…¶ç›¸äº’å…³ç³»ï¼Œè€ŒBeanå¯¹è±¡åœ¨Springå®ç°ä¸­æ˜¯ä»¥BeanDefinitionæ¥æè¿°çš„ï¼Œå¦‚ä¸‹é¢é…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">beanæ ‡ç­¾è¿˜æœ‰å¾ˆå¤šå±æ€§ï¼š</span><br><span class="line">	scopeã€init-methodã€destory-methodç­‰ã€‚</span><br></pre></td></tr></table></figure>

<p>å…¶ç»§æ‰¿ä½“ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6image-20200429204239868.png"></p>
<h3 id="1-3-3-BeanDefinitionReaderè§£æ"><a href="#1-3-3-BeanDefinitionReaderè§£æ" class="headerlink" title="1.3.3 BeanDefinitionReaderè§£æ"></a>1.3.3 BeanDefinitionReaderè§£æ</h3><p>Beançš„è§£æè¿‡ç¨‹éå¸¸å¤æ‚ï¼ŒåŠŸèƒ½è¢«åˆ†å¾—å¾ˆç»†ï¼Œå› ä¸ºè¿™é‡Œéœ€è¦è¢«æ‰©å±•çš„åœ°æ–¹å¾ˆå¤šï¼Œå¿…é¡»ä¿è¯è¶³å¤Ÿçš„çµæ´»æ€§ï¼Œä»¥åº”å¯¹å¯èƒ½çš„å˜åŒ–ã€‚Beançš„è§£æä¸»è¦å°±æ˜¯å¯¹Springé…ç½®æ–‡ä»¶çš„è§£æã€‚è¿™ä¸ªè§£æè¿‡ç¨‹ä¸»è¦é€šè¿‡BeanDefinitionReaderæ¥å®Œæˆï¼Œçœ‹çœ‹Springä¸­BeanDefinitionReaderçš„ç±»ç»“æ„å›¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6image-20200429204700956.png"></p>
<p>çœ‹çœ‹BeanDefinitionReaderæ¥å£å®šä¹‰çš„åŠŸèƒ½æ¥ç†è§£å®ƒå…·ä½“çš„ä½œç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionReader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//è·å–BeanDefinitionRegistryæ³¨å†Œå™¨å¯¹è±¡</span></span><br><span class="line">	<span class="function">BeanDefinitionRegistry <span class="title">getRegistry</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Nullable</span></span><br><span class="line">	<span class="function">ResourceLoader <span class="title">getResourceLoader</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Nullable</span></span><br><span class="line">	<span class="function">ClassLoader <span class="title">getBeanClassLoader</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">BeanNameGenerator <span class="title">getBeanNameGenerator</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		ä¸‹é¢çš„loadBeanDefinitionséƒ½æ˜¯åŠ è½½beanå®šä¹‰ï¼Œä»æŒ‡å®šçš„èµ„æºä¸­</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(Resource resource)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(Resource... resources)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(String location)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(String... locations)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-3-4-BeanDefinitionRegistryè§£æ"><a href="#1-3-4-BeanDefinitionRegistryè§£æ" class="headerlink" title="1.3.4 BeanDefinitionRegistryè§£æ"></a>1.3.4 BeanDefinitionRegistryè§£æ</h3><p>BeanDefinitionReaderç”¨æ¥è§£æbeanå®šä¹‰ï¼Œå¹¶å°è£…BeanDefinitionå¯¹è±¡ï¼Œè€Œæˆ‘ä»¬å®šä¹‰çš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰äº†å¾ˆå¤šbeanæ ‡ç­¾ï¼Œæ‰€ä»¥å°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè§£æçš„BeanDefinitionå¯¹è±¡å­˜å‚¨åˆ°å“ªå„¿ï¼Ÿç­”æ¡ˆå°±æ˜¯BeanDefinitionçš„æ³¨å†Œä¸­å¿ƒï¼Œè€Œè¯¥æ³¨å†Œä¸­å¿ƒé¡¶å±‚æ¥å£å°±æ˜¯BeanDefinitionRegistryã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionRegistry</span> <span class="keyword">extends</span> <span class="title">AliasRegistry</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å¾€æ³¨å†Œè¡¨ä¸­æ³¨å†Œbean</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">registerBeanDefinition</span><span class="params">(String beanName, BeanDefinition beanDefinition)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤æŒ‡å®šåç§°çš„bean</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">removeBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//è·å–æ³¨å†Œè¡¨ä¸­æŒ‡å®šåç§°çš„bean</span></span><br><span class="line">	<span class="function">BeanDefinition <span class="title">getBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//åˆ¤æ–­æ³¨å†Œè¡¨ä¸­æ˜¯å¦å·²ç»æ³¨å†Œäº†æŒ‡å®šåç§°çš„bean</span></span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">containsBeanDefinition</span><span class="params">(String beanName)</span></span>;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//è·å–æ³¨å†Œè¡¨ä¸­æ‰€æœ‰çš„beançš„åç§°</span></span><br><span class="line">	String[] getBeanDefinitionNames();</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getBeanDefinitionCount</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">isBeanNameInUse</span><span class="params">(String beanName)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»§æ‰¿ç»“æ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6image-20200429211132185.png"></p>
<p>ä»ä¸Šé¢ç±»å›¾å¯ä»¥çœ‹åˆ°BeanDefinitionRegistryæ¥å£çš„å­å®ç°ç±»ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li><p>DefaultListableBeanFactory</p>
<p>åœ¨è¯¥ç±»ä¸­å®šä¹‰äº†å¦‚ä¸‹ä»£ç ï¼Œå°±æ˜¯ç”¨æ¥æ³¨å†Œbean</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, BeanDefinition&gt; beanDefinitionMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;(<span class="number">256</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>SimpleBeanDefinitionRegistry</p>
<p>åœ¨è¯¥ç±»ä¸­å®šä¹‰äº†å¦‚ä¸‹ä»£ç ï¼Œå°±æ˜¯ç”¨æ¥æ³¨å†Œbean</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, BeanDefinition&gt; beanDefinitionMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;(<span class="number">64</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-3-5-åˆ›å»ºå®¹å™¨"><a href="#1-3-5-åˆ›å»ºå®¹å™¨" class="headerlink" title="1.3.5 åˆ›å»ºå®¹å™¨"></a>1.3.5 åˆ›å»ºå®¹å™¨</h3><p>ClassPathXmlApplicationContextå¯¹Beané…ç½®èµ„æºçš„è½½å…¥æ˜¯ä»refreshï¼ˆï¼‰æ–¹æ³•å¼€å§‹çš„ã€‚refreshï¼ˆï¼‰æ–¹æ³•æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œè§„å®šäº† IoC å®¹å™¨çš„å¯åŠ¨æµç¨‹ï¼Œæœ‰äº›é€»è¾‘è¦äº¤ç»™å…¶å­ç±»å®ç°ã€‚å®ƒå¯¹ Bean é…ç½®èµ„æºè¿›è¡Œè½½å…¥ï¼ŒClassPathXmlApplicationContexté€šè¿‡è°ƒç”¨å…¶çˆ¶ç±»AbstractApplicationContextçš„refreshï¼ˆï¼‰æ–¹æ³•å¯åŠ¨æ•´ä¸ªIoCå®¹å™¨å¯¹Beanå®šä¹‰çš„è½½å…¥è¿‡ç¨‹ã€‚</p>
<h2 id="1-4-è‡ªå®šä¹‰SpringIOC"><a href="#1-4-è‡ªå®šä¹‰SpringIOC" class="headerlink" title="1.4 è‡ªå®šä¹‰SpringIOC"></a>1.4 è‡ªå®šä¹‰SpringIOC</h2><p>ç°è¦å¯¹ä¸‹é¢çš„é…ç½®æ–‡ä»¶è¿›è¡Œè§£æï¼Œå¹¶è‡ªå®šä¹‰Springæ¡†æ¶çš„IOCå¯¹æ¶‰åŠåˆ°çš„å¯¹è±¡è¿›è¡Œç®¡ç†ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-4-1-å®šä¹‰beanç›¸å…³çš„pojoç±»"><a href="#1-4-1-å®šä¹‰beanç›¸å…³çš„pojoç±»" class="headerlink" title="1.4.1 å®šä¹‰beanç›¸å…³çš„pojoç±»"></a>1.4.1 å®šä¹‰beanç›¸å…³çš„pojoç±»</h3><h4 id="7-4-1-1-PropertyValueç±»"><a href="#7-4-1-1-PropertyValueç±»" class="headerlink" title="7.4.1.1 PropertyValueç±»"></a>7.4.1.1 PropertyValueç±»</h4><p>ç”¨äºå°è£…beançš„å±æ€§ï¼Œä½“ç°åˆ°ä¸Šé¢çš„é…ç½®æ–‡ä»¶å°±æ˜¯å°è£…beanæ ‡ç­¾çš„å­æ ‡ç­¾propertyæ ‡ç­¾æ•°æ®ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropertyValue</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String ref;</span><br><span class="line">  <span class="keyword">private</span> String value;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PropertyValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PropertyValue</span><span class="params">(String name, String ref,String value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.ref = ref;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getRef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ref;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRef</span><span class="params">(String ref)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.ref = ref;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="7-4-1-2-MutablePropertyValuesç±»"><a href="#7-4-1-2-MutablePropertyValuesç±»" class="headerlink" title="7.4.1.2 MutablePropertyValuesç±»"></a>7.4.1.2 MutablePropertyValuesç±»</h4><p>ä¸€ä¸ªbeanæ ‡ç­¾å¯ä»¥æœ‰å¤šä¸ªpropertyå­æ ‡ç­¾ï¼Œæ‰€ä»¥å†å®šä¹‰ä¸€ä¸ªMutablePropertyValuesç±»ï¼Œç”¨æ¥å­˜å‚¨å¹¶ç®¡ç†å¤šä¸ªPropertyValueå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MutablePropertyValues</span> <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">PropertyValue</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;PropertyValue&gt; propertyValueList;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MutablePropertyValues</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.propertyValueList = <span class="keyword">new</span> ArrayList&lt;PropertyValue&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MutablePropertyValues</span><span class="params">(List&lt;PropertyValue&gt; propertyValueList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.propertyValueList = (propertyValueList != <span class="keyword">null</span> ? propertyValueList : <span class="keyword">new</span> ArrayList&lt;PropertyValue&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> PropertyValue[] getPropertyValues() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.propertyValueList.toArray(<span class="keyword">new</span> PropertyValue[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PropertyValue <span class="title">getPropertyValue</span><span class="params">(String propertyName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (PropertyValue pv : <span class="keyword">this</span>.propertyValueList) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pv.getName().equals(propertyName)) &#123;</span><br><span class="line">                <span class="keyword">return</span> pv;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;PropertyValue&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> propertyValueList.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.propertyValueList.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MutablePropertyValues <span class="title">addPropertyValue</span><span class="params">(PropertyValue pv)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.propertyValueList.size(); i++) &#123;</span><br><span class="line">            PropertyValue currentPv = <span class="keyword">this</span>.propertyValueList.get(i);</span><br><span class="line">            <span class="keyword">if</span> (currentPv.getName().equals(pv.getName())) &#123;</span><br><span class="line">                <span class="keyword">this</span>.propertyValueList.set(i, <span class="keyword">new</span> PropertyValue(pv.getName(),pv.getRef(), pv.getValue()));</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.propertyValueList.add(pv);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(String propertyName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPropertyValue(propertyName) != <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="7-4-1-3-BeanDefinitionç±»"><a href="#7-4-1-3-BeanDefinitionç±»" class="headerlink" title="7.4.1.3 BeanDefinitionç±»"></a>7.4.1.3 BeanDefinitionç±»</h4><p>BeanDefinitionç±»ç”¨æ¥å°è£…beanä¿¡æ¯çš„ï¼Œä¸»è¦åŒ…å«idï¼ˆå³beanå¯¹è±¡çš„åç§°ï¼‰ã€classï¼ˆéœ€è¦äº¤ç”±springç®¡ç†çš„ç±»çš„å…¨ç±»åï¼‰åŠå­æ ‡ç­¾propertyæ•°æ®ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanDefinition</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String className;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MutablePropertyValues propertyValues;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BeanDefinition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        propertyValues = <span class="keyword">new</span> MutablePropertyValues();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getClassName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setClassName</span><span class="params">(String className)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.className = className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPropertyValues</span><span class="params">(MutablePropertyValues propertyValues)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.propertyValues = propertyValues;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MutablePropertyValues <span class="title">getPropertyValues</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> propertyValues;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-2-å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»"><a href="#1-4-2-å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»" class="headerlink" title="1.4.2 å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»"></a>1.4.2 å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»</h3><h4 id="1-4-2-1-BeanDefinitionRegistryæ¥å£"><a href="#1-4-2-1-BeanDefinitionRegistryæ¥å£" class="headerlink" title="1.4.2.1 BeanDefinitionRegistryæ¥å£"></a>1.4.2.1 BeanDefinitionRegistryæ¥å£</h4><p>BeanDefinitionRegistryæ¥å£å®šä¹‰äº†æ³¨å†Œè¡¨çš„ç›¸å…³æ“ä½œï¼Œå®šä¹‰å¦‚ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>æ³¨å†ŒBeanDefinitionå¯¹è±¡åˆ°æ³¨å†Œè¡¨ä¸­</li>
<li>ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤æŒ‡å®šåç§°çš„BeanDefinitionå¯¹è±¡</li>
<li>æ ¹æ®åç§°ä»æ³¨å†Œè¡¨ä¸­è·å–BeanDefinitionå¯¹è±¡</li>
<li>åˆ¤æ–­æ³¨å†Œè¡¨ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šåç§°çš„BeanDefinitionå¯¹è±¡</li>
<li>è·å–æ³¨å†Œè¡¨ä¸­BeanDefinitionå¯¹è±¡çš„ä¸ªæ•°</li>
<li>è·å–æ³¨å†Œè¡¨ä¸­æ‰€æœ‰çš„BeanDefinitionçš„åç§°</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionRegistry</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ³¨å†ŒBeanDefinitionå¯¹è±¡åˆ°æ³¨å†Œè¡¨ä¸­</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">registerBeanDefinition</span><span class="params">(String beanName, BeanDefinition beanDefinition)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤æŒ‡å®šåç§°çš„BeanDefinitionå¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®åç§°ä»æ³¨å†Œè¡¨ä¸­è·å–BeanDefinitionå¯¹è±¡</span></span><br><span class="line">    <span class="function">BeanDefinition <span class="title">getBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">containsBeanDefinition</span><span class="params">(String beanName)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getBeanDefinitionCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    String[] getBeanDefinitionNames();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-2-2-SimpleBeanDefinitionRegistryç±»"><a href="#1-4-2-2-SimpleBeanDefinitionRegistryç±»" class="headerlink" title="1.4.2.2 SimpleBeanDefinitionRegistryç±»"></a>1.4.2.2 SimpleBeanDefinitionRegistryç±»</h4><p>è¯¥ç±»å®ç°äº†BeanDefinitionRegistryæ¥å£ï¼Œå®šä¹‰äº†Mapé›†åˆä½œä¸ºæ³¨å†Œè¡¨å®¹å™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleBeanDefinitionRegistry</span> <span class="keyword">implements</span> <span class="title">BeanDefinitionRegistry</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, BeanDefinition&gt; beanDefinitionMap = <span class="keyword">new</span> HashMap&lt;String, BeanDefinition&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerBeanDefinition</span><span class="params">(String beanName, BeanDefinition beanDefinition)</span> </span>&#123;</span><br><span class="line">        beanDefinitionMap.put(beanName,beanDefinition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        beanDefinitionMap.remove(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BeanDefinition <span class="title">getBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.get(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsBeanDefinition</span><span class="params">(String beanName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.containsKey(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBeanDefinitionCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] getBeanDefinitionNames() &#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.keySet().toArray(<span class="keyword">new</span> String[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-3-å®šä¹‰è§£æå™¨ç›¸å…³ç±»"><a href="#1-4-3-å®šä¹‰è§£æå™¨ç›¸å…³ç±»" class="headerlink" title="1.4.3 å®šä¹‰è§£æå™¨ç›¸å…³ç±»"></a>1.4.3 å®šä¹‰è§£æå™¨ç›¸å…³ç±»</h3><h4 id="1-4-3-1-BeanDefinitionReaderæ¥å£"><a href="#1-4-3-1-BeanDefinitionReaderæ¥å£" class="headerlink" title="1.4.3.1 BeanDefinitionReaderæ¥å£"></a>1.4.3.1 BeanDefinitionReaderæ¥å£</h4><p>BeanDefinitionReaderæ˜¯ç”¨æ¥è§£æé…ç½®æ–‡ä»¶å¹¶åœ¨æ³¨å†Œè¡¨ä¸­æ³¨å†Œbeançš„ä¿¡æ¯ã€‚å®šä¹‰äº†ä¸¤ä¸ªè§„èŒƒï¼š</p>
<ul>
<li>è·å–æ³¨å†Œè¡¨çš„åŠŸèƒ½ï¼Œè®©å¤–ç•Œå¯ä»¥é€šè¿‡è¯¥å¯¹è±¡è·å–æ³¨å†Œè¡¨å¯¹è±¡ã€‚</li>
<li>åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå¹¶æ³¨å†Œbeanæ•°æ®ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionReader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//è·å–æ³¨å†Œè¡¨å¯¹è±¡</span></span><br><span class="line">    <span class="function">BeanDefinitionRegistry <span class="title">getRegistry</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">//åŠ è½½é…ç½®æ–‡ä»¶å¹¶åœ¨æ³¨å†Œè¡¨ä¸­è¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">loadBeanDefinitions</span><span class="params">(String configLocation)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-3-2-XmlBeanDefinitionReaderç±»"><a href="#1-4-3-2-XmlBeanDefinitionReaderç±»" class="headerlink" title="1.4.3.2 XmlBeanDefinitionReaderç±»"></a>1.4.3.2 XmlBeanDefinitionReaderç±»</h4><p>XmlBeanDefinitionReaderç±»æ˜¯ä¸“é—¨ç”¨æ¥è§£æxmlé…ç½®æ–‡ä»¶çš„ã€‚è¯¥ç±»å®ç°BeanDefinitionReaderæ¥å£å¹¶å®ç°æ¥å£ä¸­çš„ä¸¤ä¸ªåŠŸèƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XmlBeanDefinitionReader</span> <span class="keyword">implements</span> <span class="title">BeanDefinitionReader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BeanDefinitionRegistry registry;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XmlBeanDefinitionReader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.registry = <span class="keyword">new</span> SimpleBeanDefinitionRegistry();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BeanDefinitionRegistry <span class="title">getRegistry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> registry;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadBeanDefinitions</span><span class="params">(String configLocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        InputStream is = <span class="keyword">this</span>.getClass().getClassLoader().getResourceAsStream(configLocation);</span><br><span class="line">        SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">        Document document = reader.read(is);</span><br><span class="line">        Element rootElement = document.getRootElement();</span><br><span class="line">        <span class="comment">//è§£æbeanæ ‡ç­¾</span></span><br><span class="line">        parseBean(rootElement);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseBean</span><span class="params">(Element rootElement)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Element&gt; elements = rootElement.elements();</span><br><span class="line">        <span class="keyword">for</span> (Element element : elements) &#123;</span><br><span class="line">            String id = element.attributeValue(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">            String className = element.attributeValue(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">            BeanDefinition beanDefinition = <span class="keyword">new</span> BeanDefinition();</span><br><span class="line">            beanDefinition.setId(id);</span><br><span class="line">            beanDefinition.setClassName(className);</span><br><span class="line">            List&lt;Element&gt; list = element.elements(<span class="string">&quot;property&quot;</span>);</span><br><span class="line">            MutablePropertyValues mutablePropertyValues = <span class="keyword">new</span> MutablePropertyValues();</span><br><span class="line">            <span class="keyword">for</span> (Element element1 : list) &#123;</span><br><span class="line">                String name = element1.attributeValue(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                String ref = element1.attributeValue(<span class="string">&quot;ref&quot;</span>);</span><br><span class="line">                String value = element1.attributeValue(<span class="string">&quot;value&quot;</span>);</span><br><span class="line">                PropertyValue propertyValue = <span class="keyword">new</span> PropertyValue(name,ref,value);</span><br><span class="line">                mutablePropertyValues.addPropertyValue(propertyValue);</span><br><span class="line">            &#125;</span><br><span class="line">            beanDefinition.setPropertyValues(mutablePropertyValues);</span><br><span class="line"></span><br><span class="line">            registry.registerBeanDefinition(id,beanDefinition);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-4-IOCå®¹å™¨ç›¸å…³ç±»"><a href="#1-4-4-IOCå®¹å™¨ç›¸å…³ç±»" class="headerlink" title="1.4.4 IOCå®¹å™¨ç›¸å…³ç±»"></a>1.4.4 IOCå®¹å™¨ç›¸å…³ç±»</h3><h4 id="1-4-4-1-BeanFactoryæ¥å£"><a href="#1-4-4-1-BeanFactoryæ¥å£" class="headerlink" title="1.4.4.1 BeanFactoryæ¥å£"></a>1.4.4.1 BeanFactoryæ¥å£</h4><p>åœ¨è¯¥æ¥å£ä¸­å®šä¹‰IOCå®¹å™¨çš„ç»Ÿä¸€è§„èŒƒå³è·å–beanå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line">	<span class="comment">//æ ¹æ®beanå¯¹è±¡çš„åç§°è·å–beanå¯¹è±¡</span></span><br><span class="line">    <span class="function">Object <span class="title">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">	<span class="comment">//æ ¹æ®beanå¯¹è±¡çš„åç§°è·å–beanå¯¹è±¡ï¼Œå¹¶è¿›è¡Œç±»å‹è½¬æ¢</span></span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(String name, Class&lt;? extends T&gt; clazz)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-4-2-ApplicationContextæ¥å£"><a href="#1-4-4-2-ApplicationContextæ¥å£" class="headerlink" title="1.4.4.2 ApplicationContextæ¥å£"></a>1.4.4.2 ApplicationContextæ¥å£</h4><p>è¯¥æ¥å£çš„æ‰€ä»¥çš„å­å®ç°ç±»å¯¹beanå¯¹è±¡çš„åˆ›å»ºéƒ½æ˜¯éå»¶æ—¶çš„ï¼Œæ‰€ä»¥åœ¨è¯¥æ¥å£ä¸­å®šä¹‰ <code>refresh()</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸»è¦å®Œæˆä»¥ä¸‹ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>åŠ è½½é…ç½®æ–‡ä»¶ã€‚</li>
<li>æ ¹æ®æ³¨å†Œè¡¨ä¸­çš„BeanDefinitionå¯¹è±¡å°è£…çš„æ•°æ®è¿›è¡Œbeanå¯¹è±¡çš„åˆ›å»ºã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApplicationContext</span> <span class="keyword">extends</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line">	<span class="comment">//è¿›è¡Œé…ç½®æ–‡ä»¶åŠ è½½å¹¶è¿›è¡Œå¯¹è±¡åˆ›å»º</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> <span class="keyword">throws</span> IllegalStateException, Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-4-3-AbstractApplicationContextç±»"><a href="#1-4-4-3-AbstractApplicationContextç±»" class="headerlink" title="1.4.4.3 AbstractApplicationContextç±»"></a>1.4.4.3 AbstractApplicationContextç±»</h4><ul>
<li><p>ä½œä¸ºApplicationContextæ¥å£çš„å­ç±»ï¼Œæ‰€ä»¥è¯¥ç±»ä¹Ÿæ˜¯éå»¶æ—¶åŠ è½½ï¼Œæ‰€ä»¥éœ€è¦åœ¨è¯¥ç±»ä¸­å®šä¹‰ä¸€ä¸ªMapé›†åˆï¼Œä½œä¸ºbeanå¯¹è±¡å­˜å‚¨çš„å®¹å™¨ã€‚</p>
</li>
<li><p>å£°æ˜BeanDefinitionReaderç±»å‹çš„å˜é‡ï¼Œç”¨æ¥è¿›è¡Œxmlé…ç½®æ–‡ä»¶çš„è§£æï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</p>
<p>BeanDefinitionReaderç±»å‹çš„å¯¹è±¡åˆ›å»ºäº¤ç”±å­ç±»å®ç°ï¼Œå› ä¸ºåªæœ‰å­ç±»æ˜ç¡®åˆ°åº•åˆ›å»ºBeanDefinitionReaderå“ªå„¿ä¸ªå­å®ç°ç±»å¯¹è±¡ã€‚</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractApplicationContext</span> <span class="keyword">implements</span> <span class="title">ApplicationContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> BeanDefinitionReader beanDefinitionReader;</span><br><span class="line">    <span class="comment">//ç”¨æ¥å­˜å‚¨beanå¯¹è±¡çš„å®¹å™¨   keyå­˜å‚¨çš„æ˜¯beançš„idå€¼ï¼Œvalueå­˜å‚¨çš„æ˜¯beanå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">protected</span> Map&lt;String, Object&gt; singletonObjects = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å­˜å‚¨é…ç½®æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">    <span class="keyword">protected</span> String configLocation;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> <span class="keyword">throws</span> IllegalStateException, Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åŠ è½½BeanDefinition</span></span><br><span class="line">        beanDefinitionReader.loadBeanDefinitions(configLocation);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆå§‹åŒ–bean</span></span><br><span class="line">        finishBeanInitialization();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//beançš„åˆå§‹åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">finishBeanInitialization</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BeanDefinitionRegistry registry = beanDefinitionReader.getRegistry();</span><br><span class="line">        String[] beanNames = registry.getBeanDefinitionNames();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String beanName : beanNames) &#123;</span><br><span class="line">            BeanDefinition beanDefinition = registry.getBeanDefinition(beanName);</span><br><span class="line">            getBean(beanName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼šè¯¥ç±»finishBeanInitialization()æ–¹æ³•ä¸­è°ƒç”¨getBean()æ–¹æ³•ä½¿ç”¨åˆ°äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚</p>
</blockquote>
<h4 id="1-4-4-4-ClassPathXmlApplicationContextç±»"><a href="#1-4-4-4-ClassPathXmlApplicationContextç±»" class="headerlink" title="1.4.4.4 ClassPathXmlApplicationContextç±»"></a>1.4.4.4 ClassPathXmlApplicationContextç±»</h4><p>è¯¥ç±»ä¸»è¦æ˜¯åŠ è½½ç±»è·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œbeanå¯¹è±¡çš„åˆ›å»ºï¼Œä¸»è¦å®Œæˆä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œåˆ›å»ºBeanDefinitionReaderå¯¹è±¡ã€‚</li>
<li>åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œè°ƒç”¨refresh()æ–¹æ³•ï¼Œç”¨äºè¿›è¡Œé…ç½®æ–‡ä»¶åŠ è½½ã€åˆ›å»ºbeanå¯¹è±¡å¹¶å­˜å‚¨åˆ°å®¹å™¨ä¸­ã€‚</li>
<li>é‡å†™çˆ¶æ¥å£ä¸­çš„getBean()æ–¹æ³•ï¼Œå¹¶å®ç°ä¾èµ–æ³¨å…¥æ“ä½œã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassPathXmlApplicationContext</span> <span class="keyword">extends</span> <span class="title">AbstractApplicationContext</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClassPathXmlApplicationContext</span><span class="params">(String configLocation)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.configLocation = configLocation;</span><br><span class="line">        <span class="comment">//æ„å»ºXmlBeanDefinitionReaderå¯¹è±¡</span></span><br><span class="line">        beanDefinitionReader = <span class="keyword">new</span> XmlBeanDefinitionReader();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.refresh();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®beançš„idå±æ€§å€¼è·å–beanå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//return singletonObjects.get(name);</span></span><br><span class="line">        Object obj = singletonObjects.get(name);</span><br><span class="line">        <span class="keyword">if</span>(obj != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> obj;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BeanDefinitionRegistry registry = beanDefinitionReader.getRegistry();</span><br><span class="line">        BeanDefinition beanDefinition = registry.getBeanDefinition(name);</span><br><span class="line">        <span class="keyword">if</span>(beanDefinition == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String className = beanDefinition.getClassName();</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">        Object beanObj = clazz.newInstance();</span><br><span class="line">        MutablePropertyValues propertyValues = beanDefinition.getPropertyValues();</span><br><span class="line">        <span class="keyword">for</span> (PropertyValue propertyValue : propertyValues) &#123;</span><br><span class="line">            String propertyName = propertyValue.getName();</span><br><span class="line">            String value = propertyValue.getValue();</span><br><span class="line">            String ref = propertyValue.getRef();</span><br><span class="line">            <span class="keyword">if</span>(ref != <span class="keyword">null</span> &amp;&amp; !<span class="string">&quot;&quot;</span>.equals(ref)) &#123;</span><br><span class="line"></span><br><span class="line">                Object bean = getBean(ref);</span><br><span class="line">                String methodName = StringUtils.getSetterMethodNameByFieldName(propertyName);</span><br><span class="line">                Method[] methods = clazz.getMethods();</span><br><span class="line">                <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(method.getName().equals(methodName)) &#123;</span><br><span class="line">                        method.invoke(beanObj,bean);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(value != <span class="keyword">null</span> &amp;&amp; !<span class="string">&quot;&quot;</span>.equals(value)) &#123;</span><br><span class="line">                String methodName = StringUtils.getSetterMethodNameByFieldName(propertyName);</span><br><span class="line">                Method method = clazz.getMethod(methodName, String.class);</span><br><span class="line">                method.invoke(beanObj,value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        singletonObjects.put(name,beanObj);</span><br><span class="line">        <span class="keyword">return</span> beanObj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(String name, Class&lt;? extends T&gt; clazz)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        Object bean = getBean(name);</span><br><span class="line">        <span class="keyword">if</span>(bean != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> clazz.cast(bean);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-4-4-5-StringUtilsç±»"><a href="#1-4-4-5-StringUtilsç±»" class="headerlink" title="1.4.4.5 StringUtilsç±»"></a>1.4.4.5 StringUtilsç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringUtils</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">StringUtils</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// userDao ==&gt; setUserDao</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getSetterMethodNameByFieldName</span><span class="params">(String fieldName)</span></span>&#123;</span><br><span class="line">        String methodName=<span class="string">&quot;set&quot;</span> +fieldName.substring(<span class="number">0</span>,<span class="number">1</span>).toUpperCase()+fieldName.substring(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> methodName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-5-è‡ªå®šä¹‰Spring-IOCæ€»ç»“"><a href="#1-4-5-è‡ªå®šä¹‰Spring-IOCæ€»ç»“" class="headerlink" title="1.4.5 è‡ªå®šä¹‰Spring IOCæ€»ç»“"></a>1.4.5 è‡ªå®šä¹‰Spring IOCæ€»ç»“</h3><h4 id="1-4-5-1-ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼"><a href="#1-4-5-1-ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼" class="headerlink" title="1.4.5.1 ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼"></a>1.4.5.1 ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼</h4><ul>
<li>å·¥å‚æ¨¡å¼ã€‚è¿™ä¸ªä½¿ç”¨å·¥å‚æ¨¡å¼ + é…ç½®æ–‡ä»¶çš„æ–¹å¼ã€‚</li>
<li>å•ä¾‹æ¨¡å¼ã€‚Spring IOCç®¡ç†çš„beanå¯¹è±¡éƒ½æ˜¯å•ä¾‹çš„ï¼Œæ­¤å¤„çš„å•ä¾‹ä¸æ˜¯é€šè¿‡æ„é€ å™¨è¿›è¡Œå•ä¾‹çš„æ§åˆ¶çš„ï¼Œè€Œæ˜¯springæ¡†æ¶å¯¹æ¯ä¸€ä¸ªbeanåªåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ã€‚</li>
<li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚AbstractApplicationContextç±»ä¸­çš„finishBeanInitialization()æ–¹æ³•è°ƒç”¨äº†å­ç±»çš„getBean()æ–¹æ³•ï¼Œå› ä¸ºgetBean()çš„å®ç°å’Œç¯å¢ƒæ¯æ¯ç›¸å…³ã€‚</li>
<li>è¿­ä»£å™¨æ¨¡å¼ã€‚å¯¹äºMutablePropertyValuesç±»å®šä¹‰ä½¿ç”¨åˆ°äº†è¿­ä»£å™¨æ¨¡å¼ï¼Œå› ä¸ºæ­¤ç±»å­˜å‚¨å¹¶ç®¡ç†PropertyValueå¯¹è±¡ï¼Œä¹Ÿå±äºä¸€ä¸ªå®¹å™¨ï¼Œæ‰€ä»¥ç»™è¯¥å®¹å™¨æä¾›ä¸€ä¸ªéå†æ–¹å¼ã€‚</li>
</ul>
<p>springæ¡†æ¶å…¶å®ä½¿ç”¨åˆ°äº†å¾ˆå¤šè®¾è®¡æ¨¡å¼ï¼Œå¦‚AOPä½¿ç”¨åˆ°äº†ä»£ç†æ¨¡å¼ï¼Œé€‰æ‹©JDKä»£ç†æˆ–è€…CGLIBä»£ç†ä½¿ç”¨åˆ°äº†ç­–ç•¥æ¨¡å¼ï¼Œè¿˜æœ‰é€‚é…å™¨æ¨¡å¼ï¼Œè£…é¥°è€…æ¨¡å¼ï¼Œè§‚å¯Ÿè€…æ¨¡å¼ç­‰ã€‚</p>
<h4 id="1-4-5-2-ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™"><a href="#1-4-5-2-ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™" class="headerlink" title="1.4.5.2 ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™"></a>1.4.5.2 ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™</h4><h4 id="1-4-5-3-æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥"><a href="#1-4-5-3-æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥" class="headerlink" title="1.4.5.3 æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥"></a>1.4.5.3 æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥</h4><p>springæ¡†æ¶åº•å±‚æ˜¯å¾ˆå¤æ‚çš„ï¼Œè¿›è¡Œäº†å¾ˆæ·±å…¥çš„å°è£…ï¼Œå¹¶å¯¹å¤–æä¾›äº†å¾ˆå¥½çš„æ‰©å±•æ€§ã€‚è€Œæˆ‘ä»¬è‡ªå®šä¹‰SpringIOCæœ‰ä»¥ä¸‹å‡ ä¸ªç›®çš„ï¼š</p>
<ul>
<li>äº†è§£Springåº•å±‚å¯¹å¯¹è±¡çš„å¤§ä½“ç®¡ç†æœºåˆ¶ã€‚</li>
<li>äº†è§£è®¾è®¡æ¨¡å¼åœ¨å…·ä½“çš„å¼€å‘ä¸­çš„ä½¿ç”¨ã€‚</li>
<li>ä»¥åå­¦ä¹ springæºç ï¼Œé€šè¿‡è¯¥æ¡ˆä¾‹çš„å®ç°ï¼Œå¯ä»¥é™ä½springå­¦ä¹ çš„å…¥é—¨æˆæœ¬ã€‚</li>
</ul>
<h2 id="1-6-é¡¹ç›®è·¯å¾„æ‰€æœ‰ä¸€è§ˆ"><a href="#1-6-é¡¹ç›®è·¯å¾„æ‰€æœ‰ä¸€è§ˆ" class="headerlink" title="1.6 é¡¹ç›®è·¯å¾„æ‰€æœ‰ä¸€è§ˆ"></a>1.6 é¡¹ç›®è·¯å¾„æ‰€æœ‰ä¸€è§ˆ</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/Snipaste_2021-04-01_16-20-40.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6%E5%9B%BE%E7%89%87/Snipaste_2021-04-01_16-21-20.png"></p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Gitå­¦ä¹ ç¬”è®°</title>
    <url>/2021/03/11/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Gitå­¦ä¹ ç¬”è®°"><a href="#Gitå­¦ä¹ ç¬”è®°" class="headerlink" title="Gitå­¦ä¹ ç¬”è®°"></a>Gitå­¦ä¹ ç¬”è®°</h1><p>å­¦ä¹ é€”å¾„<a href="https://oschina.gitee.io/learn-git-branching/">https://oschina.gitee.io/learn-git-branching/</a></p>
<h2 id="1-Git-å¸¸ç”¨å‘½ä»¤"><a href="#1-Git-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="1.Git å¸¸ç”¨å‘½ä»¤"></a>1.Git å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> /path/to/repository <span class="comment"># æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ä»¥åˆ›å»ºä¸€ä¸ªæœ¬åœ°ä»“åº“çš„å…‹éš†ç‰ˆæœ¬</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> username@host:/path/to/repository <span class="comment"># è¿œç«¯æœåŠ¡å™¨ä¸Šçš„ä»“åº“</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git pull <span class="comment"># æ›´æ–°ä½ çš„æœ¬åœ°ä»“åº“è‡³æœ€æ–°æ”¹åŠ¨</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -vv <span class="comment"># æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote -v <span class="comment"># æŸ¥çœ‹æœ¬åœ°æ‰€å¯¹åº”çš„è¿œç¨‹URL</span></span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210308151447584.png"></p>
<h2 id="2-æ·»åŠ ä¸æäº¤"><a href="#2-æ·»åŠ ä¸æäº¤" class="headerlink" title="2.æ·»åŠ ä¸æäº¤"></a>2.æ·»åŠ ä¸æäº¤</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git add &lt;filename&gt; <span class="comment"># æ·»åŠ åˆ°ç¼“å­˜åŒº</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;ä»£ç æäº¤ä¿¡æ¯&quot;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="3-æ¨é€æ”¹åŠ¨"><a href="#3-æ¨é€æ”¹åŠ¨" class="headerlink" title="3.æ¨é€æ”¹åŠ¨"></a>3.æ¨é€æ”¹åŠ¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git push origin master <span class="comment"># æäº¤åˆ°è¿œç«¯ä»“åº“</span></span></span><br></pre></td></tr></table></figure>

<h2 id="4-åˆ†æ”¯"><a href="#4-åˆ†æ”¯" class="headerlink" title="4.åˆ†æ”¯"></a>4.åˆ†æ”¯</h2><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210308151825947.png" alt="image-20210308151825947"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git branch åˆ†æ”¯å <span class="comment">#æ–°å»ºåˆ†æ”¯</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -d åˆ†æ”¯å <span class="comment"># åˆ é™¤åˆ†æ”¯</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout åˆ†æ”¯å <span class="comment">#åˆ‡æ¢åˆ°æŸåˆ†æ”¯</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git rebase åˆ†æ”¯å <span class="comment"># ç±»ä¼¼äºå¤åˆ¶åˆ°æ–°åˆ†æ”¯</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout C4 <span class="comment">#å°†HEADæŒ‡å‘C4</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -f åˆ†æ”¯å èŠ‚ç‚¹å <span class="comment"># å¼ºåˆ¶ç§»åŠ¨åˆ°æŸèŠ‚ç‚¹</span></span></span><br></pre></td></tr></table></figure>

<h2 id="5-æ›´æ–°ä¸åˆå¹¶"><a href="#5-æ›´æ–°ä¸åˆå¹¶" class="headerlink" title="5.æ›´æ–°ä¸åˆå¹¶"></a>5.æ›´æ–°ä¸åˆå¹¶</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git pull <span class="comment"># æ›´æ–°ä½ çš„æœ¬åœ°ä»“åº“è‡³æœ€æ–°æ”¹åŠ¨</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git merge åˆ†æ”¯å <span class="comment"># å°†åˆ†æ”¯åˆå¹¶åˆ°masteråˆ†æ”¯</span></span></span><br></pre></td></tr></table></figure>

<h2 id="6-æ ‡ç­¾"><a href="#6-æ ‡ç­¾" class="headerlink" title="6.æ ‡ç­¾"></a>6.æ ‡ç­¾</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> <span class="comment"># è·å–æäº¤ ID</span></span></span><br></pre></td></tr></table></figure>
<h2 id="7-æ›¿æ¢æœ¬åœ°æ”¹åŠ¨"><a href="#7-æ›¿æ¢æœ¬åœ°æ”¹åŠ¨" class="headerlink" title="7.æ›¿æ¢æœ¬åœ°æ”¹åŠ¨"></a>7.æ›¿æ¢æœ¬åœ°æ”¹åŠ¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout -- &lt;filename&gt; <span class="comment"># æ›¿æ¢æ‰æœ¬åœ°æ”¹åŠ¨</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸¢å¼ƒä½ æ‰€æœ‰çš„æœ¬åœ°æ”¹åŠ¨ä¸æäº¤ï¼Œå¯ä»¥åˆ°æœåŠ¡å™¨ä¸Šè·å–æœ€æ–°çš„ç‰ˆæœ¬å¹¶å°†ä½ æœ¬åœ°ä¸»åˆ†æ”¯æŒ‡å‘åˆ°å®ƒï¼š</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git fetch origin</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset --hard origin/master</span></span><br></pre></td></tr></table></figure>
<h2 id="8-Gitå¸¸ç”¨å‘½ä»¤"><a href="#8-Gitå¸¸ç”¨å‘½ä»¤" class="headerlink" title="8.Gitå¸¸ç”¨å‘½ä»¤"></a>8.Gitå¸¸ç”¨å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gitk <span class="comment"># å†…å»ºçš„å›¾å½¢åŒ– gitï¼š</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config color.ui <span class="literal">true</span> <span class="comment"># å½©è‰²çš„ git è¾“å‡ºï¼š</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config format.pretty oneline <span class="comment"># æ˜¾ç¤ºå†å²è®°å½•æ—¶ï¼Œåªæ˜¾ç¤ºä¸€è¡Œæ³¨é‡Šä¿¡æ¯ï¼š</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add -i <span class="comment"># äº¤äº’åœ°æ·»åŠ æ–‡ä»¶è‡³ç¼“å­˜åŒºï¼š</span></span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210308152754868.png" alt="image-20210308152754868"></p>
<h2 id="9-å‘½ä»¤æ€»ç»“"><a href="#9-å‘½ä»¤æ€»ç»“" class="headerlink" title="9.å‘½ä»¤æ€»ç»“"></a>9.å‘½ä»¤æ€»ç»“</h2><h3 id="1-ä»“åº“"><a href="#1-ä»“åº“" class="headerlink" title="1.ä»“åº“"></a>1.ä»“åº“</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªGitä»£ç åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git init</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸ºGitä»£ç åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git init [project-name]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> [url]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-é…ç½®"><a href="#2-é…ç½®" class="headerlink" title="2.é…ç½®"></a>2.é…ç½®</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºå½“å‰çš„Gité…ç½®</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --list</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¼–è¾‘Gité…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config -e [--global]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®æäº¤ä»£ç æ—¶çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config [--global] user.name <span class="string">&quot;[name]&quot;</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config [--global] user.email <span class="string">&quot;[email address]&quot;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="3-å¢åŠ -åˆ é™¤æ–‡ä»¶"><a href="#3-å¢åŠ -åˆ é™¤æ–‡ä»¶" class="headerlink" title="3.å¢åŠ /åˆ é™¤æ–‡ä»¶"></a>3.å¢åŠ /åˆ é™¤æ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add [file1] [file2] ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ æŒ‡å®šç›®å½•åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬å­ç›®å½•</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add [dir]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add .</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ æ¯ä¸ªå˜åŒ–å‰ï¼Œéƒ½ä¼šè¦æ±‚ç¡®è®¤</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯¹äºåŒä¸€ä¸ªæ–‡ä»¶çš„å¤šå¤„å˜åŒ–ï¼Œå¯ä»¥å®ç°åˆ†æ¬¡æäº¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add -p</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git rm [file1] [file2] ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åœæ­¢è¿½è¸ªæŒ‡å®šæ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ä¼šä¿ç•™åœ¨å·¥ä½œåŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git rm --cached [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ”¹åæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªæ”¹åæ”¾å…¥æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git mv [file-original] [file-renamed]</span></span><br></pre></td></tr></table></figure>
<h3 id="4-ä»£ç æäº¤"><a href="#4-ä»£ç æäº¤" class="headerlink" title="4.ä»£ç æäº¤"></a>4.ä»£ç æäº¤</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æäº¤æš‚å­˜åŒºåˆ°ä»“åº“åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m [message]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit [file1] [file2] ... -m [message]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æäº¤å·¥ä½œåŒºè‡ªä¸Šæ¬¡commitä¹‹åçš„å˜åŒ–ï¼Œç›´æ¥åˆ°ä»“åº“åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -a</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æäº¤æ—¶æ˜¾ç¤ºæ‰€æœ‰diffä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -v</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit --amend -m [message]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit --amend [file1] [file2] ...</span></span><br></pre></td></tr></table></figure>

<h3 id="5-åˆ†æ”¯"><a href="#5-åˆ†æ”¯" class="headerlink" title="5.åˆ†æ”¯"></a>5.åˆ†æ”¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -r</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -a</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch [branch-name]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout -b [branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŒ‡å®šcommit</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch [branch] [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch --track [branch] [remote-branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æ›´æ–°å·¥ä½œåŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout [branch-name]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout -</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œåœ¨ç°æœ‰åˆ†æ”¯ä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch --set-upstream [branch] [remote-branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git merge [branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git cherry-pick [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -d [branch-name]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin --delete [branch-name]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -dr [remote/branch]</span></span><br></pre></td></tr></table></figure>

<h3 id="6-æ ‡ç­¾-1"><a href="#6-æ ‡ç­¾-1" class="headerlink" title="6.æ ‡ç­¾"></a>6.æ ‡ç­¾</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡ºæ‰€æœ‰tag</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git tag</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªtagåœ¨å½“å‰commit</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git tag [tag]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªtagåœ¨æŒ‡å®šcommit</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git tag [tag] [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤æœ¬åœ°tag</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git tag -d [tag]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤è¿œç¨‹tag</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin :refs/tags/[tagName]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹tagä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git show [tag]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æäº¤æŒ‡å®štag</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] [tag]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æäº¤æ‰€æœ‰tag</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] --tags</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŸä¸ªtag</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout -b [branch] [tag]</span></span><br></pre></td></tr></table></figure>

<h3 id="7-æŸ¥çœ‹ä¿¡æ¯"><a href="#7-æŸ¥çœ‹ä¿¡æ¯" class="headerlink" title="7.æŸ¥çœ‹ä¿¡æ¯"></a>7.æŸ¥çœ‹ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„ç‰ˆæœ¬å†å²</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºcommitå†å²ï¼Œä»¥åŠæ¯æ¬¡commitå‘ç”Ÿå˜æ›´çš„æ–‡ä»¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --<span class="built_in">stat</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æœç´¢æäº¤å†å²ï¼Œæ ¹æ®å…³é”®è¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> -S [keyword]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œæ¯ä¸ªcommitå æ®ä¸€è¡Œ</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> [tag] HEAD --pretty=format:%s</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œå…¶<span class="string">&quot;æäº¤è¯´æ˜&quot;</span>å¿…é¡»ç¬¦åˆæœç´¢æ¡ä»¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> [tag] HEAD --grep feature</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å†å²ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ”¹å</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --follow [file]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git whatchanged [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶ç›¸å…³çš„æ¯ä¸€æ¬¡diff</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> -p [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºè¿‡å»5æ¬¡æäº¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> -5 --pretty --oneline</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæ‰€æœ‰æäº¤è¿‡çš„ç”¨æˆ·ï¼ŒæŒ‰æäº¤æ¬¡æ•°æ’åº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git shortlog -sn</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æ˜¯ä»€ä¹ˆäººåœ¨ä»€ä¹ˆæ—¶é—´ä¿®æ”¹è¿‡</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git blame [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git diff</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git diff --cached [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºå·¥ä½œåŒºä¸å½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git diff HEAD</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git diff [first-branch]...[second-branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºä»Šå¤©ä½ å†™äº†å¤šå°‘è¡Œä»£ç </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git diff --shortstat <span class="string">&quot;@&#123;0 day ago&#125;&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŸæ¬¡æäº¤çš„å…ƒæ•°æ®å’Œå†…å®¹å˜åŒ–</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git show [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŸæ¬¡æäº¤å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git show --name-only [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŸæ¬¡æäº¤æ—¶ï¼ŒæŸä¸ªæ–‡ä»¶çš„å†…å®¹</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git show [commit]:[filename]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„æœ€è¿‘å‡ æ¬¡æäº¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git reflog</span></span><br></pre></td></tr></table></figure>


<h3 id="8-è¿œç¨‹åŒæ­¥"><a href="#8-è¿œç¨‹åŒæ­¥" class="headerlink" title="8.è¿œç¨‹åŒæ­¥"></a>8.è¿œç¨‹åŒæ­¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git fetch [remote]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote -v</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote show [remote]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½å</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote add [shortname] [url]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git pull [remote] [branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] [branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] --force</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] --all</span></span><br></pre></td></tr></table></figure>


<h3 id="9-æ’¤é”€"><a href="#9-æ’¤é”€" class="headerlink" title="9.æ’¤é”€"></a>9.æ’¤é”€</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¢å¤æŸä¸ªcommitçš„æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒºå’Œå·¥ä½œåŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout [commit] [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¢å¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout .</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡ç½®æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´ï¼Œä½†å·¥ä½œåŒºä¸å˜</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset [file]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset --hard</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡ç½®å½“å‰åˆ†æ”¯çš„æŒ‡é’ˆä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºï¼Œä½†å·¥ä½œåŒºä¸å˜</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡ç½®å½“å‰åˆ†æ”¯çš„HEADä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œä¸æŒ‡å®šcommitä¸€è‡´</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset --hard [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡ç½®å½“å‰HEADä¸ºæŒ‡å®šcommitï¼Œä½†ä¿æŒæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸å˜</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset --keep [commit]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªcommitï¼Œç”¨æ¥æ’¤é”€æŒ‡å®šcommit</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åè€…çš„æ‰€æœ‰å˜åŒ–éƒ½å°†è¢«å‰è€…æŠµæ¶ˆï¼Œå¹¶ä¸”åº”ç”¨åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git revert [commit]</span></span><br><span class="line"></span><br><span class="line">æš‚æ—¶å°†æœªæäº¤çš„å˜åŒ–ç§»é™¤ï¼Œç¨åå†ç§»å…¥</span><br><span class="line"><span class="meta">$</span><span class="bash"> git stash</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git stash pop</span></span><br></pre></td></tr></table></figure>

<h2 id="10-å®æˆ˜è¸©å‘"><a href="#10-å®æˆ˜è¸©å‘" class="headerlink" title="10.å®æˆ˜è¸©å‘"></a>10.å®æˆ˜è¸©å‘</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.åˆå§‹åŒ–ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git init</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.æŸ¥çœ‹è¿œç¨‹ä»“åº“ ç¡®è®¤æ²¡æœ‰ï¼Œæœ‰åˆ é™¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote -v</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote rm origin</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3.æ·»åŠ åˆ°æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add .</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 4.æäº¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;æè¿°&quot;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 5.æ·»åŠ è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote add åˆ«å é“¾æ¥</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 6.æŸ¥çœ‹è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote -v</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 7.æ‹‰å–ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git pull åˆ«å master</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 8.ç¡®è®¤è¿œç¨‹å’Œæœ¬åœ°ä»“åº“ä¸€è‡´ è¿›å»ä¸è¦ä¿®æ”¹ä»»ä½•ä¿å­˜é€€å‡ºå³å¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git pull åˆ«å master --allow-unrelated-histories</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 9.æ¨é€åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push åˆ«å master</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 10.åˆ·æ–°ä»“åº“çœ‹æ˜¯å¦æˆåŠŸï¼</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ActiveMQå­¦ä¹ ç¬”è®°</title>
    <url>/2021/03/05/ActiveMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="ActiveMQå­¦ä¹ ç¬”è®°"><a href="#ActiveMQå­¦ä¹ ç¬”è®°" class="headerlink" title="ActiveMQå­¦ä¹ ç¬”è®°"></a>ActiveMQå­¦ä¹ ç¬”è®°</h1><h2 id="1-ActiveMQå…¥é—¨"><a href="#1-ActiveMQå…¥é—¨" class="headerlink" title="1.ActiveMQå…¥é—¨"></a>1.ActiveMQå…¥é—¨</h2><h3 id="æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨åœºæ™¯"><a href="#æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨åœºæ™¯" class="headerlink" title="æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨åœºæ™¯"></a>æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨åœºæ™¯</h3><ul>
<li>å¼‚æ­¥å¤„ç†</li>
<li>åº”ç”¨è§£è€¦</li>
<li>æµé‡å‰Šå³°</li>
</ul>
<h4 id="å¼‚æ­¥å¤„ç†"><a href="#å¼‚æ­¥å¤„ç†" class="headerlink" title="å¼‚æ­¥å¤„ç†"></a>å¼‚æ­¥å¤„ç†</h4><p>åœºæ™¯è¯´æ˜ï¼šç”¨æˆ·æ³¨å†Œï¼Œéœ€è¦æ‰§è¡Œä¸‰ä¸ªä¸šåŠ¡é€»è¾‘ï¼Œåˆ†åˆ«ä¸ºå†™å…¥ç”¨æˆ·è¡¨ï¼Œå‘æ³¨å†Œé‚®ä»¶ä»¥åŠæ³¨å†ŒçŸ­ä¿¡ã€‚</p>
<ul>
<li>ä¸²è¡Œæ–¹å¼<ul>
<li>å°†æ³¨å†Œä¿¡æ¯å†™å…¥æ•°æ®åº“æˆåŠŸåï¼Œå‘é€æ³¨å†Œé‚®ä»¶ï¼Œå†å‘é€æ³¨å†ŒçŸ­ä¿¡ã€‚ä»¥ä¸Šä¸‰ä¸ªä»»åŠ¡å…¨éƒ¨å®Œæˆåï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313141459082.png" alt="image-20210313141459082"></p>
<ul>
<li>å¹¶è¡Œæ–¹å¼<ul>
<li>å°†æ³¨å†Œä¿¡æ¯å†™å…¥æ•°æ®åº“æˆåŠŸåï¼Œå‘é€æ³¨å†Œé‚®ä»¶çš„åŒæ—¶ï¼Œå‘é€æ³¨å†ŒçŸ­ä¿¡ã€‚ä»¥ä¸Šä¸‰ä¸ªä»»åŠ¡å®Œæˆåï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ä¸ä¸²è¡Œçš„å·®åˆ«æ˜¯ï¼Œå¹¶è¡Œçš„æ–¹å¼å¯ä»¥æé«˜å¤„ç†çš„æ—¶é—´</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313141527875.png" alt="image-20210313141527875"></p>
<ul>
<li>å¼‚æ­¥å¤„ç†<ul>
<li>å¼•å…¥æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå°†éƒ¨åˆ†çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚æ”¹é€ åçš„æ¶æ„å¦‚ä¸‹ï¼š</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313141604405.png" alt="image-20210313141604405"></p>
<p><strong>æŒ‰ç…§ä»¥ä¸Šçº¦å®šï¼Œç”¨æˆ·çš„å“åº”æ—¶é—´ç›¸å½“äºæ˜¯æ³¨å†Œä¿¡æ¯å†™å…¥æ•°æ®åº“çš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ 50æ¯«ç§’ã€‚æ³¨å†Œé‚®ä»¶ï¼Œå‘é€çŸ­ä¿¡å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—åï¼Œç›´æ¥è¿”å›ï¼Œå› æ­¤å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—çš„é€Ÿåº¦å¾ˆå¿«ï¼ŒåŸºæœ¬å¯ä»¥å¿½ç•¥ï¼Œå› æ­¤ç”¨æˆ·çš„å“åº”æ—¶é—´å¯èƒ½æ˜¯50æ¯«ç§’ã€‚å› æ­¤æ¶æ„æ”¹å˜åï¼Œç³»ç»Ÿçš„ååé‡æé«˜å•¦ï¼Œæ¯”ä¸²è¡Œæé«˜äº†3å€ï¼Œæ¯”å¹¶è¡Œæé«˜äº†ä¸¤å€ã€‚</strong></p>
<h4 id="åº”ç”¨è§£è€¦"><a href="#åº”ç”¨è§£è€¦" class="headerlink" title="åº”ç”¨è§£è€¦"></a>åº”ç”¨è§£è€¦</h4><p>åœºæ™¯è¯´æ˜ï¼šç”¨æˆ·ä¸‹å•åï¼Œè®¢å•ç³»ç»Ÿéœ€è¦é€šçŸ¥åº“å­˜ç³»ç»Ÿã€‚<br>ä¼ ç»Ÿçš„åšæ³•æ˜¯ï¼Œè®¢å•ç³»ç»Ÿè°ƒç”¨åº“å­˜ç³»ç»Ÿçš„æ¥å£ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313141811536.png" alt="image-20210313141811536"></p>
<p><strong>ä¼ ç»Ÿæ¨¡å¼çš„ç¼ºç‚¹ï¼š</strong>å‡å¦‚åº“å­˜ç³»ç»Ÿæ— æ³•è®¿é—®ï¼Œåˆ™è®¢å•å‡åº“å­˜å°†å¤±è´¥ï¼Œä»è€Œå¯¼è‡´è®¢å•å¤±è´¥ï¼Œè®¢å•ç³»ç»Ÿä¸åº“å­˜ç³»ç»Ÿè€¦åˆã€‚</p>
<p>å¦‚ä½•è§£å†³ä»¥ä¸Šé—®é¢˜å‘¢ï¼Ÿå¼•å…¥åº”ç”¨æ¶ˆæ¯é˜Ÿåˆ—åçš„æ–¹æ¡ˆï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313141848639.png" alt="image-20210313141848639"></p>
<p><strong>è®¢å•ç³»ç»Ÿï¼šç”¨æˆ·ä¸‹å•åï¼Œè®¢å•ç³»ç»Ÿå®ŒæˆæŒä¹…åŒ–å¤„ç†ï¼Œå°†æ¶ˆæ¯å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿”å›ç”¨æˆ·è®¢å•ä¸‹å•æˆåŠŸ åº“å­˜ç³»ç»Ÿï¼šè®¢é˜…ä¸‹å•çš„æ¶ˆæ¯ï¼Œé‡‡ç”¨æ‹‰/æ¨çš„æ–¹å¼ï¼Œè·å–ä¸‹å•ä¿¡æ¯ï¼Œåº“å­˜ç³»ç»Ÿæ ¹æ®ä¸‹å•ä¿¡æ¯ï¼Œè¿›è¡Œåº“å­˜æ“ä½œ å‡å¦‚ï¼šåœ¨ä¸‹å•æ—¶åº“å­˜ç³»ç»Ÿä¸èƒ½æ­£å¸¸ä½¿ç”¨ã€‚ä¹Ÿä¸å½±å“æ­£å¸¸ä¸‹å•ï¼Œå› ä¸ºä¸‹å•åï¼Œè®¢å•ç³»ç»Ÿå†™å…¥æ¶ˆæ¯é˜Ÿåˆ—å°±ä¸å†å…³å¿ƒå…¶ä»–çš„åç»­æ“ä½œäº†ã€‚å®ç°è®¢å•ç³»ç»Ÿä¸åº“å­˜ç³»ç»Ÿçš„åº”ç”¨è§£è€¦ã€‚</strong></p>
<h4 id="æµé‡å‰Šå³°"><a href="#æµé‡å‰Šå³°" class="headerlink" title="æµé‡å‰Šå³°"></a>æµé‡å‰Šå³°</h4><p>æµé‡å‰Šé”‹ä¹Ÿæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„å¸¸ç”¨åœºæ™¯ï¼Œä¸€èˆ¬åœ¨ç§’æ€æˆ–å›¢æŠ¢æ´»åŠ¨ä¸­ä½¿ç”¨å¹¿æ³›ã€‚åº”ç”¨åœºæ™¯ï¼šç§’æ€æ´»åŠ¨ï¼Œä¸€èˆ¬ä¼šå› ä¸ºæµé‡è¿‡å¤§ï¼Œå¯¼è‡´æµé‡æš´å¢ï¼Œåº”ç”¨æŒ‚æ‰ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬éœ€è¦åœ¨åº”ç”¨å‰ç«¯åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚<br>é€šè¿‡åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—å®Œæˆå¦‚ä¸‹åŠŸèƒ½ï¼š<br>aã€å¯ä»¥æ§åˆ¶æ´»åŠ¨çš„äººæ•°</p>
<p>bã€å¯ä»¥ç¼“è§£çŸ­æ—¶é—´å†…é«˜æµé‡å‹å®åº”ç”¨</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313142125812.png" alt="image-20210313142125812"></p>
<p><strong>ç”¨æˆ·çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥æ”¶åï¼Œé¦–å…ˆå†™å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚å‡å¦‚æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦è¶…è¿‡æœ€å¤§æ•°é‡ï¼Œåˆ™ç›´æ¥æŠ›å¼ƒç”¨æˆ·è¯·</strong><br><strong>æ±‚æˆ–è·³è½¬åˆ°é”™è¯¯é¡µé¢ã€‚ç§’æ€ä¸šåŠ¡æ ¹æ®æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„è¯·æ±‚ä¿¡æ¯ï¼Œå†åšåç»­å¤„ç†</strong></p>
<p><strong>å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶äº§å“å¯¹æ¯”</strong></p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>ActiveMQ</th>
<th>RabbitMQ</th>
<th>RocketMQ</th>
<th>Kafka</th>
</tr>
</thead>
<tbody><tr>
<td>è¯­è¨€</td>
<td>Java</td>
<td>Erlang</td>
<td>Java</td>
<td>Scala</td>
</tr>
<tr>
<td>å•å‡»ååé‡</td>
<td>ä¸‡çº§</td>
<td>ä¸‡çº§</td>
<td>10ä¸‡çº§</td>
<td>10ä¸‡çº§</td>
</tr>
<tr>
<td>æ—¶æ•ˆæ€§</td>
<td>æ¯«ç§’çº§</td>
<td>å¾®ç§’çº§</td>
<td>æ¯«ç§’çº§</td>
<td>æ¯«ç§’çº§</td>
</tr>
<tr>
<td>å¯ç”¨æ€§</td>
<td>é«˜</td>
<td>é«˜</td>
<td>åˆ†å¸ƒå¼æ¶æ„ é«˜</td>
<td>åˆ†å¸ƒå¼æ¶æ„ é«˜</td>
</tr>
<tr>
<td>åŠŸèƒ½æ€§</td>
<td>æˆç†Ÿï¼Œå…¬å¸å¾—åˆ°åº”ç”¨</td>
<td>å¹¶å‘èƒ½åŠ›å¼ºï¼Œç®¡ç†ç•Œé¢æ¯”è¾ƒä¸°å¯Œ</td>
<td>åŠŸèƒ½å®Œå¤‡ï¼Œæ‰©å±•æ€§å¥½</td>
<td>å¤§æ•°æ®åº”ç”¨é€›</td>
</tr>
</tbody></table>
<h3 id="ActiveMQç®€ä»‹åŠJMS"><a href="#ActiveMQç®€ä»‹åŠJMS" class="headerlink" title="ActiveMQç®€ä»‹åŠJMS"></a>ActiveMQç®€ä»‹åŠJMS</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313142739222.png" alt="image-20210313142739222"></p>
<p><strong>å®˜ç½‘<a href="http://activemq.apache.org/">http://activemq.apache.org/</a></strong></p>
<ul>
<li><p><strong>ä»€ä¹ˆæ˜¯AcitveMQ</strong></p>
<ul>
<li>ActiveMQ æ˜¯Apacheå‡ºå“ï¼Œæœ€æµè¡Œçš„ï¼Œèƒ½åŠ›å¼ºåŠ²çš„å¼€æºæ¶ˆæ¯æ€»çº¿ã€‚</li>
<li>ActiveMQ æ˜¯ä¸€ä¸ªå®Œå…¨æ”¯æŒJMS1.1å’ŒJ2EE 1.4è§„èŒƒçš„ JMS Providerå®ç°ã€‚</li>
</ul>
</li>
<li><p>ä»€ä¹ˆæ˜¯JMS</p>
</li>
</ul>
<p>æ¶ˆæ¯ä¸­é—´ä»¶åˆ©ç”¨é«˜æ•ˆå¯é çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶è¿›è¡Œå¹³å°æ— å…³çš„æ•°æ®äº¤æµï¼Œå¹¶åŸºäºæ•°æ®é€šä¿¡æ¥è¿›è¡Œåˆ†å¸ƒå¼ç³»ç»Ÿ<br>çš„é›†æˆã€‚å®ƒå¯ä»¥åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹æ‰©å±•è¿›ç¨‹é—´çš„é€šä¿¡ã€‚å¯¹äºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¸¸è§çš„è§’è‰²å¤§è‡´ä¹Ÿå°±æœ‰<br><strong>Producerï¼ˆç”Ÿäº§è€…ï¼‰ã€Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰ã€‚</strong></p>
<p>æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é‡è¦çš„ç»„ä»¶ï¼Œä¸»è¦è§£å†³<strong>åº”ç”¨è§£è€¦ï¼Œå¼‚æ­¥æ¶ˆæ¯ï¼Œæµé‡å‰Šé”‹</strong>ç­‰é—®é¢˜ï¼Œå®ç°<strong>é«˜</strong><br><strong>æ€§èƒ½ï¼Œé«˜å¯ç”¨ï¼Œå¯ä¼¸ç¼©å’Œæœ€ç»ˆä¸€è‡´æ€§</strong>æ¶æ„ã€‚</p>
<p>JMSï¼ˆ Javaâ€‚Messaging Serviceï¼‰æ˜¯Javaå¹³å°ä¸Šæœ‰<strong>å…³é¢å‘æ¶ˆæ¯ä¸­é—´ä»¶çš„æŠ€æœ¯è§„èŒƒ</strong>ï¼Œå®ƒä¾¿äºæ¶ˆæ¯ç³»ç»Ÿä¸­çš„<br>Javaåº”ç”¨ç¨‹åºè¿›è¡Œæ¶ˆæ¯äº¤æ¢,å¹¶ä¸”é€šè¿‡<strong>æä¾›æ ‡å‡†çš„äº§ç”Ÿã€å‘é€ã€æ¥æ”¶æ¶ˆæ¯çš„æ¥å£ç®€åŒ–ä¼ä¸šåº”ç”¨çš„å¼€å‘</strong>ã€‚</p>
<p>JMSæœ¬èº«<strong>åªå®šä¹‰äº†ä¸€ç³»åˆ—çš„æ¥å£è§„èŒƒ</strong>ï¼Œæ˜¯ä¸€ç§ä¸å‚å•†æ— å…³çš„ APIï¼Œ<strong>ç”¨æ¥è®¿é—®æ¶ˆæ¯æ”¶å‘ç³»ç»Ÿ</strong>ã€‚å®ƒç±»ä¼¼äº<br>JDBC(javaâ€‚Database Connectivity)ï¼šè¿™é‡Œï¼ŒJDBC æ˜¯å¯ä»¥ç”¨æ¥è®¿é—®è®¸å¤šä¸åŒå…³ç³»æ•°æ®åº“ çš„ APIï¼Œè€Œ JMS<br>åˆ™æä¾›åŒæ ·ä¸å‚å•†æ— å…³çš„è®¿é—®æ–¹æ³•ï¼Œä»¥è®¿é—®æ¶ˆæ¯æ”¶å‘æœåŠ¡ã€‚è®¸å¤šå‚å•†ç›®å‰éƒ½æ”¯æŒ JMSï¼ŒåŒ…æ‹¬ IBM çš„<br>MQSeriesã€BEAçš„ Weblogic JMS serviceå’Œ Progress çš„ SonicMQï¼Œè¿™åªæ˜¯å‡ ä¸ªä¾‹å­ã€‚ <strong>JMS ä½¿æ‚¨èƒ½å¤Ÿ</strong><br><strong>é€šè¿‡æ¶ˆæ¯æ”¶å‘æœåŠ¡ï¼ˆæœ‰æ—¶ç§°ä¸ºæ¶ˆæ¯ä¸­ä»‹ç¨‹åºæˆ–è·¯ç”±å™¨ï¼‰ä»ä¸€ä¸ª JMS å®¢æˆ·æœºå‘å¦ä¸€ä¸ª JML å®¢æˆ·æœºå‘é€æ¶ˆ</strong><br><strong>æ¯</strong>ã€‚æ¶ˆæ¯æ˜¯ JMS ä¸­çš„ä¸€ç§ç±»å‹å¯¹è±¡ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<strong>æŠ¥å¤´å’Œæ¶ˆæ¯ä¸»ä½“</strong>ã€‚æŠ¥å¤´ç”±è·¯ç”±ä¿¡æ¯ä»¥åŠæœ‰å…³è¯¥æ¶ˆæ¯<br>çš„å…ƒæ•°æ®ç»„æˆã€‚<strong>æ¶ˆæ¯ä¸»ä½“åˆ™æºå¸¦ç€åº”ç”¨ç¨‹åºçš„æ•°æ®æˆ–æœ‰æ•ˆè´Ÿè½½</strong>ã€‚</p>
<h4 id="JMSæ¶ˆæ¯æ¨¡å‹"><a href="#JMSæ¶ˆæ¯æ¨¡å‹" class="headerlink" title="JMSæ¶ˆæ¯æ¨¡å‹"></a>JMSæ¶ˆæ¯æ¨¡å‹</h4><p>æ¶ˆæ¯ä¸­é—´ä»¶ä¸€èˆ¬æœ‰ä¸¤ç§ä¼ é€’æ¨¡å¼ï¼š<strong>ç‚¹å¯¹ç‚¹æ¨¡å¼(P2P)å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼(Pub/Sub)ã€‚</strong></p>
<ul>
<li>(1) P2P (Point to Point) ç‚¹å¯¹ç‚¹æ¨¡å‹ï¼ˆQueueé˜Ÿåˆ—æ¨¡å‹ï¼‰</li>
<li>(2) Publish/Subscribe(Pub/Sub) å‘å¸ƒ/è®¢é˜…æ¨¡å‹(Topicä¸»é¢˜æ¨¡å‹)ç‚¹å¯¹ç‚¹æ¨¡å‹</li>
</ul>
<blockquote>
<p><strong>ç‚¹å¯¹ç‚¹æ¨¡å‹ï¼ˆ Pointer-to-Pointerï¼‰ï¼šå³ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„æ¶ˆæ¯å¾€æ¥ã€‚</strong></p>
</blockquote>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313143155106.png" alt="image-20210313143155106"></p>
<p>æ¯ä¸ªæ¶ˆæ¯éƒ½è¢«å‘é€åˆ°ç‰¹å®šçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¥æ”¶è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚é˜Ÿåˆ—ä¿ç•™ç€æ¶ˆæ¯ï¼Œç›´åˆ°ä»–ä»¬è¢«æ¶ˆè´¹æˆ–è¶…æ—¶ã€‚</p>
<h5 id="ç‚¹å¯¹ç‚¹æ¨¡å‹çš„ç‰¹ç‚¹"><a href="#ç‚¹å¯¹ç‚¹æ¨¡å‹çš„ç‰¹ç‚¹" class="headerlink" title="ç‚¹å¯¹ç‚¹æ¨¡å‹çš„ç‰¹ç‚¹"></a><strong>ç‚¹å¯¹ç‚¹æ¨¡å‹çš„ç‰¹ç‚¹</strong></h5><ul>
<li>æ¯ä¸ªæ¶ˆæ¯åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆ Consumerï¼‰(å³ä¸€æ—¦è¢«æ¶ˆè´¹ï¼Œæ¶ˆæ¯å°±ä¸å†åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­)ï¼›</li>
<li>å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´åœ¨æ—¶é—´ä¸Šæ²¡æœ‰ä¾èµ–æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‘é€è€…å‘é€äº†æ¶ˆæ¯ä¹‹åï¼Œä¸ç®¡æ¥æ”¶è€…æœ‰æ²¡æœ‰æ­£åœ¨è¿è¡Œï¼Œå®ƒä¸ä¼šå½±å“åˆ°æ¶ˆæ¯è¢«å‘é€åˆ°é˜Ÿåˆ—ï¼›</li>
<li>æ¥æ”¶è€…åœ¨æˆåŠŸæ¥æ”¶æ¶ˆæ¯ä¹‹åéœ€å‘é˜Ÿåˆ—åº”ç­”æˆåŠŸã€‚</li>
</ul>
<p><strong>ä¸¾ä¾‹</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313143350809.png" alt="image-20210313143350809"></p>
<h5 id="å‘å¸ƒ-è®¢é˜…æ¨¡å‹"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å‹" class="headerlink" title="å‘å¸ƒ/è®¢é˜…æ¨¡å‹"></a>å‘å¸ƒ/è®¢é˜…æ¨¡å‹</h5><blockquote>
<p>å‘å¸ƒ/è®¢é˜…ï¼ˆPublish-Subscribeï¼‰</p>
</blockquote>
<p>åŒ…å«ä¸‰ä¸ªè§’è‰²ï¼š<strong>ä¸»é¢˜ï¼ˆTopicï¼‰ï¼Œå‘å¸ƒè€…ï¼ˆPublisherï¼‰ï¼Œè®¢é˜…è€…ï¼ˆSubscriberï¼‰</strong>ï¼Œå¤šä¸ªå‘å¸ƒè€…å°†æ¶ˆæ¯å‘é€åˆ°topicï¼Œç³»ç»Ÿå°†è¿™äº›æ¶ˆæ¯æŠ•é€’åˆ°è®¢é˜…æ­¤topicçš„è®¢é˜…è€…</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313143516023.png" alt="image-20210313143516023"></p>
<p>å‘å¸ƒè€…å‘é€åˆ° topicçš„æ¶ˆæ¯ï¼Œåªæœ‰è®¢é˜…äº†topicçš„è®¢é˜…è€…æ‰ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚topicå®ç°äº†å‘å¸ƒå’Œè®¢é˜…ï¼Œå½“ä½ å‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ï¼Œæ‰€æœ‰è®¢é˜…è¿™ä¸ªtopicçš„æœåŠ¡éƒ½èƒ½å¾—åˆ°è¿™ä¸ªæ¶ˆæ¯ï¼Œæ‰€ä»¥ä»1åˆ°Nä¸ªè®¢é˜…è€…éƒ½èƒ½å¾—åˆ°è¿™ä¸ªæ¶ˆæ¯çš„æ‹·è´</p>
<p><strong>å‘å¸ƒ/è®¢é˜…æ¨¡å‹çš„ç‰¹ç‚¹</strong></p>
<ul>
<li>æ¯ä¸ªæ¶ˆæ¯å¯ä»¥æœ‰å¤šä¸ªæ¶ˆè´¹è€…</li>
<li>å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´æœ‰æ—¶é—´ä¸Šçš„ä¾èµ–æ€§ï¼ˆå…ˆè®¢é˜…ä¸»é¢˜ï¼Œå†æ¥å‘é€æ¶ˆæ¯ï¼‰</li>
<li>è®¢é˜…è€…å¿…é¡»ä¿æŒè¿è¡Œçš„çŠ¶æ€ï¼Œæ‰èƒ½æ¥å—å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯</li>
</ul>
<h4 id="JMSç¼–ç¨‹API"><a href="#JMSç¼–ç¨‹API" class="headerlink" title="JMSç¼–ç¨‹API"></a>JMSç¼–ç¨‹API</h4><table>
<thead>
<tr>
<th>è¦ç´ </th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>Destination</td>
<td>ç”¨æ¥å®šä¹‰æ¶ˆæ¯ä»å‘é€ç«¯å‘å‡ºåè¦èµ°çš„é€šé“ï¼Œè€Œä¸æ˜¯æ¥æ”¶æ–¹ã€‚Destinationå±äºç®¡ç†ç±»å¯¹è±¡</td>
</tr>
<tr>
<td>ConnectionFactory</td>
<td>ç”¨äºåˆ›å»ºè¿æ¥å¯¹è±¡</td>
</tr>
<tr>
<td>Connection</td>
<td>è¿æ¥æ¥å£ï¼Œæ‰€è´Ÿè´£çš„é‡è¦å·¥ä½œæ—¶åˆ›å»ºSession</td>
</tr>
<tr>
<td>Session</td>
<td>ä¼šè¯æ¥å£ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å¯¹è±¡ï¼Œæ¶ˆæ¯å‘é€è€…ã€æ¶ˆæ¯æ¥æ”¶è€…ä»¥åŠæ¶ˆæ¯å¯¹è±¡æœ¬èº«ï¼Œéƒ½æ˜¯é€šè¿‡è¿™ä¸ªä¼šè¯å¯¹è±¡åˆ›å»ºçš„</td>
</tr>
<tr>
<td>MessageConsumer</td>
<td>æ¶ˆæ¯çš„æ¶ˆè´¹è€…ï¼Œä¹Ÿå°±æ˜¯è®¢é˜…æ¶ˆæ¯å¹¶å¤„ç†æ¶ˆæ¯çš„å¯¹è±¡</td>
</tr>
<tr>
<td>MessageProducer</td>
<td>æ¶ˆæ¯çš„ç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯ç”¨æ¥å‘é€æ¶ˆæ¯çš„å¯¹è±¡</td>
</tr>
</tbody></table>
<h5 id="1ï¼‰ConnectionFactory"><a href="#1ï¼‰ConnectionFactory" class="headerlink" title="(1ï¼‰ConnectionFactory"></a>(1ï¼‰ConnectionFactory</h5><p>åˆ›å»ºConnectionå¯¹è±¡çš„å·¥å‚ï¼Œé’ˆå¯¹ä¸¤ç§ä¸åŒçš„jmsæ¶ˆæ¯æ¨¡å‹ï¼Œåˆ†åˆ«æœ‰QueueConnectionFactoryå’ŒTopicConnectionFactoryä¸¤ç§ã€‚</p>
<h5 id="2ï¼‰Destination"><a href="#2ï¼‰Destination" class="headerlink" title="(2ï¼‰Destination"></a>(2ï¼‰Destination</h5><p>Destinationçš„æ„æ€æ˜¯æ¶ˆæ¯ç”Ÿäº§è€…çš„æ¶ˆæ¯å‘é€ç›®æ ‡æˆ–è€…è¯´æ¶ˆæ¯æ¶ˆè´¹è€…çš„æ¶ˆæ¯æ¥æºã€‚å¯¹äºæ¶ˆæ¯ç”Ÿäº§è€…æ¥è¯´ï¼Œå®ƒçš„Destinationæ˜¯æŸä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰æˆ–æŸä¸ªä¸»é¢˜ï¼ˆTopicï¼‰;å¯¹äºæ¶ˆæ¯æ¶ˆè´¹è€…æ¥è¯´ï¼Œå®ƒçš„Destinationä¹Ÿæ˜¯æŸä¸ªé˜Ÿåˆ—æˆ–ä¸»é¢˜ï¼ˆå³æ¶ˆæ¯æ¥æºï¼‰ã€‚æ‰€ä»¥ï¼ŒDestinationå®é™…ä¸Šå°±æ˜¯ä¸¤ç§ç±»å‹çš„å¯¹è±¡ï¼š<strong>Queueã€Topic</strong></p>
<h5 id="3ï¼‰Connection"><a href="#3ï¼‰Connection" class="headerlink" title="(3ï¼‰Connection"></a>(3ï¼‰Connection</h5><p>Connectionè¡¨ç¤ºåœ¨å®¢æˆ·ç«¯å’ŒJMSç³»ç»Ÿä¹‹é—´å»ºç«‹çš„é“¾æ¥ï¼ˆå¯¹TCP/IP socketçš„åŒ…è£…ï¼‰ã€‚<strong>Connectionå¯ä»¥äº§ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªSession</strong></p>
<h5 id="4ï¼‰Session"><a href="#4ï¼‰Session" class="headerlink" title="(4ï¼‰Session"></a>(4ï¼‰Session</h5><p>Session æ˜¯æˆ‘ä»¬å¯¹æ¶ˆæ¯è¿›è¡Œæ“ä½œçš„æ¥å£ï¼Œå¯ä»¥é€šè¿‡session<strong>åˆ›å»ºç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ã€æ¶ˆæ¯</strong>ç­‰ã€‚Session æä¾›äº†äº‹åŠ¡çš„åŠŸèƒ½ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨sessionå‘é€/æ¥æ”¶å¤šä¸ªæ¶ˆæ¯æ—¶ï¼Œå¯ä»¥å°†è¿™äº›å‘é€/æ¥æ”¶åŠ¨ä½œæ”¾åˆ°ä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚</p>
<h5 id="5ï¼‰Producter"><a href="#5ï¼‰Producter" class="headerlink" title="(5ï¼‰Producter"></a>(5ï¼‰Producter</h5><p>Producterï¼ˆæ¶ˆæ¯ç”Ÿäº§è€…ï¼‰ï¼š<strong>æ¶ˆæ¯ç”Ÿäº§è€…ç”±Sessionåˆ›å»º</strong>ï¼Œå¹¶ç”¨äºå°†æ¶ˆæ¯å‘é€åˆ°Destinationã€‚åŒæ ·ï¼Œæ¶ˆæ¯ç”Ÿäº§è€…åˆ†ä¸¤ç§ç±»å‹ï¼š<strong>QueueSenderå’ŒTopicPublisher</strong>ã€‚å¯ä»¥è°ƒç”¨æ¶ˆæ¯ç”Ÿäº§è€…çš„æ–¹æ³•ï¼ˆsendæˆ–publishæ–¹æ³•ï¼‰å‘é€æ¶ˆæ¯ã€‚</p>
<h5 id="6ï¼‰Consumer"><a href="#6ï¼‰Consumer" class="headerlink" title="(6ï¼‰Consumer"></a>(6ï¼‰Consumer</h5><p>Consumer ï¼ˆæ¶ˆæ¯æ¶ˆè´¹è€…ï¼‰ï¼š<strong>æ¶ˆæ¯æ¶ˆè´¹è€…ç”±Sessionåˆ›å»º</strong>ï¼Œç”¨äºæ¥æ”¶è¢«å‘é€åˆ°Destinationçš„æ¶ˆæ¯ã€‚ä¸¤ç§ç±»å‹ï¼š<strong>QueueReceiverå’ŒTopicSubscriber</strong>ã€‚å¯åˆ†åˆ«é€šè¿‡<strong>sessionçš„createReceiver(Queue)æˆ–createSubscriber(Topic)æ¥åˆ›å»º</strong>ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥sessionçš„creatDurableSubscriberæ–¹æ³•æ¥åˆ›å»ºæŒä¹…åŒ–çš„è®¢é˜…è€…ã€‚</p>
<h5 id="7ï¼‰MessageListener"><a href="#7ï¼‰MessageListener" class="headerlink" title="(7ï¼‰MessageListener"></a>(7ï¼‰MessageListener</h5><p>æ¶ˆæ¯ç›‘å¬å™¨ã€‚<strong>å¦‚æœæ³¨å†Œäº†æ¶ˆæ¯ç›‘å¬å™¨ï¼Œä¸€æ—¦æ¶ˆæ¯åˆ°è¾¾ï¼Œå°†è‡ªåŠ¨è°ƒç”¨ç›‘å¬å™¨çš„onMessageæ–¹æ³•</strong>ã€‚EJBä¸­çš„MDBï¼ˆMessage-Driven Beanï¼‰å°±æ˜¯ä¸€ç§MessageListenerã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313144419878.png" alt="image-20210313144419878"></p>
<h2 id="2-ActiveMQå®‰è£…"><a href="#2-ActiveMQå®‰è£…" class="headerlink" title="2.ActiveMQå®‰è£…"></a>2.ActiveMQå®‰è£…</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ç¬¬ä¸€æ­¥ï¼šå®‰è£… jdkï¼ˆç•¥ï¼‰</span><br><span class="line">ç¬¬äºŒæ­¥ï¼šæŠŠ activemqçš„å‹ç¼©åŒ…ï¼ˆapache-activemq-5.14.5-bin.tar.gzï¼‰ä¸Šä¼ åˆ° linux ç³»ç»Ÿ</span><br><span class="line">ç¬¬ä¸‰æ­¥ï¼šè§£å‹ç¼©å‹ç¼©åŒ… </span><br><span class="line"><span class="meta">$</span><span class="bash"> tar -zxvf apache-activemq-5.14.5-bin.tar.gz</span></span><br><span class="line">ç¬¬å››æ­¥ï¼šè¿›å…¥apache-activemq-5.14.5çš„binç›®å½•</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> apache-activemq-5.14.5/bin</span></span><br><span class="line">ç¬¬äº”æ­¥ï¼šå¯åŠ¨ activemq</span><br><span class="line"><span class="meta">$</span><span class="bash"> ./activemq start (æ‰§è¡Œ2æ¬¡ï¼šç¬¬ä¸€æ¬¡ï¼šç”Ÿæˆé…ç½®ä¿¡æ¯ï¼›ç¬¬äºŒæ¬¡ï¼šå¯åŠ¨)</span></span><br><span class="line">ç¬¬å…­æ­¥ï¼šåœæ­¢activemqï¼š</span><br><span class="line"><span class="meta">$</span><span class="bash"> ./activemq stop</span></span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•è¿æ¥</strong></p>
<p><strong>æµè§ˆå™¨è¾“å…¥ï¼šlinuxip:8161</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">é¡µé¢æ§åˆ¶å°ï¼š http://ip:8161 (ç›‘æ§)</span><br><span class="line">è¯·æ±‚åœ°å€ï¼š Â tcp://ip:61616 ï¼ˆjavaä»£ç è®¿é—®æ¶ˆæ¯ä¸­é—´ä»¶ï¼‰</span><br></pre></td></tr></table></figure>

<p>è´¦å·ï¼š admin<br>å¯†ç ï¼šadmin</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313144724034.png" alt="image-20210313144724034"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313144736828.png" alt="image-20210313144736828"></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">åˆ—è¡¨å„åˆ—ä¿¡æ¯å«ä¹‰å¦‚ä¸‹ï¼š</span><br><span class="line">Number Of Pending Messages ï¼šç­‰å¾…æ¶ˆè´¹çš„æ¶ˆæ¯ è¿™ä¸ªæ˜¯å½“å‰æœªå‡ºé˜Ÿåˆ—çš„æ•°é‡ã€‚</span><br><span class="line">Number Of Consumers ï¼šæ¶ˆè´¹è€… è¿™ä¸ªæ˜¯æ¶ˆè´¹è€…ç«¯çš„æ¶ˆè´¹è€…æ•°é‡</span><br><span class="line">Messages Enqueued ï¼šè¿›å…¥é˜Ÿåˆ—çš„æ¶ˆæ¯ è¿›å…¥é˜Ÿåˆ—çš„æ€»æ•°é‡,åŒ…æ‹¬å‡ºé˜Ÿåˆ—çš„ã€‚</span><br><span class="line">Messages Dequeued ï¼šå‡ºäº†é˜Ÿåˆ—çš„æ¶ˆæ¯ å¯ä»¥ç†è§£ä¸ºæ˜¯æ¶ˆè´¹è¿™æ¶ˆè´¹æ‰çš„æ•°é‡ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="3-åŸç”ŸTMS-APIæ“ä½œActiveMQ"><a href="#3-åŸç”ŸTMS-APIæ“ä½œActiveMQ" class="headerlink" title="3.åŸç”ŸTMS APIæ“ä½œActiveMQ"></a>3.åŸç”ŸTMS APIæ“ä½œActiveMQ</h2><h3 id="PTP-æ¨¡å¼-ç”Ÿäº§è€…"><a href="#PTP-æ¨¡å¼-ç”Ÿäº§è€…" class="headerlink" title="PTP æ¨¡å¼(ç”Ÿäº§è€…)"></a>PTP æ¨¡å¼(ç”Ÿäº§è€…)</h3><p> <strong>ï¼ˆ1ï¼‰å¼•å…¥åæ ‡</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.activemq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activemq-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.11.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>æ­¥éª¤ï¼š</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">1.åˆ›å»ºè¿æ¥å·¥å‚</span><br><span class="line">2.åˆ›å»ºè¿æ¥</span><br><span class="line">3.æ‰“å¼€è¿æ¥</span><br><span class="line">4.åˆ›å»ºsession</span><br><span class="line">5.åˆ›å»ºç›®æ ‡åœ°å€ï¼ˆQueue:ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ŒTopicï¼šå‘å¸ƒè®¢é˜…æ¶ˆæ¯ï¼‰</span><br><span class="line">6.åˆ›å»ºæ¶ˆæ¯ç”Ÿäº§è€…</span><br><span class="line">7.åˆ›å»ºæ¶ˆæ¯</span><br><span class="line">8.å‘é€æ¶ˆæ¯</span><br><span class="line">9.é‡Šæ”¾èµ„æº</span><br></pre></td></tr></table></figure>



<p><strong>ï¼ˆ 2ï¼‰ç¼–å†™ç”Ÿäº§æ¶ˆæ¯çš„æµ‹è¯•ç±» QueueProducer</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PTP_Producer</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory factory= <span class="keyword">new</span> ActiveMQConnectionFactory(<span class="string">&quot;tcp://linuxip:61616&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//2.åˆ›å»ºè¿æ¥</span></span><br><span class="line">Â Â Â Â Connection connection = factory.createConnection();</span><br><span class="line">Â Â Â Â <span class="comment">//3.æ‰“å¼€è¿æ¥</span></span><br><span class="line">Â Â Â Â connection.start();</span><br><span class="line">Â Â Â Â <span class="comment">//4.åˆ›å»ºsession</span></span><br><span class="line">Â Â Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â Â Â * å‚æ•°ä¸€ï¼šæ˜¯å¦å¼€å¯äº‹åŠ¡æ“ä½œ</span></span><br><span class="line"><span class="comment">	è§‚å¯Ÿå‘é€æ¶ˆæ¯çš„ç»“æœï¼š</span></span><br><span class="line"><span class="comment">	PTPæ¨¡å¼(æ¶ˆè´¹è€…)</span></span><br><span class="line"><span class="comment">	æ­¥éª¤ï¼š</span></span><br><span class="line"><span class="comment">Â Â Â Â * å‚æ•°äºŒï¼šæ¶ˆæ¯ç¡®è®¤æœºåˆ¶</span></span><br><span class="line"><span class="comment">Â Â Â Â */</span></span><br><span class="line">Â Â Â Â Session session = connection.createSession(<span class="keyword">false</span>,Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â <span class="comment">//5.åˆ›å»ºç›®æ ‡åœ°å€ï¼ˆQueue:ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ŒTopicï¼šå‘å¸ƒè®¢é˜…æ¶ˆæ¯ï¼‰</span></span><br><span class="line">Â Â Â Â Queue queue = session.createQueue(<span class="string">&quot;queue01&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//6.åˆ›å»ºæ¶ˆæ¯ç”Ÿäº§è€…</span></span><br><span class="line">Â Â Â Â MessageProducer producer = session.createProducer(queue);</span><br><span class="line">Â Â Â Â <span class="comment">//7.åˆ›å»ºæ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â <span class="comment">//createTextMessage: æ–‡æœ¬ç±»å‹</span></span><br><span class="line">Â Â Â Â TextMessage textMessage = session.createTextMessage(<span class="string">&quot;test message&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//8.å‘é€æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â producer.send(textMessage);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å®Œæˆ&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//9.é‡Šæ”¾èµ„æº</span></span><br><span class="line">Â Â Â Â session.close();</span><br><span class="line">Â Â Â Â connection.close();</span><br><span class="line">	Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯åŠ¨æµ‹è¯•ç»“æœ</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313145341189.png" alt="image-20210313145341189"></p>
<h3 id="PTPæ¨¡å¼-æ¶ˆè´¹è€…"><a href="#PTPæ¨¡å¼-æ¶ˆè´¹è€…" class="headerlink" title="PTPæ¨¡å¼(æ¶ˆè´¹è€…)"></a>PTPæ¨¡å¼(æ¶ˆè´¹è€…)</h3><p><strong>æ­¥éª¤ï¼š</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">1.åˆ›å»ºè¿æ¥å·¥å‚</span><br><span class="line">2.åˆ›å»ºè¿æ¥</span><br><span class="line">3.æ‰“å¼€è¿æ¥</span><br><span class="line">4.åˆ›å»ºsession</span><br><span class="line">5.æŒ‡å®šç›®æ ‡åœ°å€</span><br><span class="line">6.åˆ›å»ºæ¶ˆæ¯çš„æ¶ˆè´¹è€…</span><br><span class="line">7.é…ç½®æ¶ˆæ¯ç›‘å¬å™¨</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬ä¸€ç§å†™æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PTP_Consumer1</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory factory= <span class="keyword">new</span> ActiveMQConnectionFactory(<span class="string">&quot;tcp://linuxip:61616&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//2.åˆ›å»ºè¿æ¥</span></span><br><span class="line">Â Â Â Â Connection connection = factory.createConnection();</span><br><span class="line">Â Â Â Â <span class="comment">//3.æ‰“å¼€è¿æ¥</span></span><br><span class="line">Â Â Â Â connection.start();</span><br><span class="line">Â Â Â Â <span class="comment">//4.åˆ›å»ºsession</span></span><br><span class="line">Â Â Â Â Session session = connection.createSession(<span class="keyword">false</span>,Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â <span class="comment">//5.æŒ‡å®šç›®æ ‡åœ°å€</span></span><br><span class="line">Â Â Â Â Queue queue = session.createQueue(<span class="string">&quot;queue01&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//6.åˆ›å»ºæ¶ˆæ¯çš„æ¶ˆè´¹è€…</span></span><br><span class="line">Â Â Â Â MessageConsumer consumer = session.createConsumer(queue);</span><br><span class="line">Â Â Â Â <span class="comment">//7.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Message message = consumer.receive();</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//å¦‚æœå·²ç»æ²¡æœ‰æ¶ˆæ¯äº†ï¼Œç»“æŸå•¦</span></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span>(message==<span class="keyword">null</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">break</span>;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//å¦‚æœè¿˜æœ‰æ¶ˆæ¯ï¼Œåˆ¤æ–­ä»€ä¹ˆç±»å‹çš„æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span>(message <span class="keyword">instanceof</span> TextMessage)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â TextMessage textMessage = (TextMessage)message;</span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¥æ”¶çš„æ¶ˆæ¯ï¼š&quot;</span>+textMessage.getText());</span><br><span class="line">Â Â Â 			Â Â &#125;</span><br><span class="line">Â Â 	Â 	&#125;</span><br><span class="line">Â 	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒç§å†™æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PTP_Consumer2</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory factory= <span class="keyword">new</span> ActiveMQConnectionFactory(<span class="string">&quot;tcp://linuxip:61616&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//2.åˆ›å»ºè¿æ¥</span></span><br><span class="line">Â Â Â Â Connection connection = factory.createConnection();</span><br><span class="line">Â Â Â Â <span class="comment">//3.æ‰“å¼€è¿æ¥</span></span><br><span class="line">Â Â Â Â connection.start();</span><br><span class="line">Â Â Â Â <span class="comment">//4.åˆ›å»ºsession</span></span><br><span class="line">Â Â Â Â Session session = connection.createSession(<span class="keyword">false</span>,Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â <span class="comment">//5.æŒ‡å®šç›®æ ‡åœ°å€</span></span><br><span class="line">Â Â Â Â Queue queue = session.createQueue(<span class="string">&quot;queue01&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//6.åˆ›å»ºæ¶ˆæ¯çš„æ¶ˆè´¹è€…</span></span><br><span class="line">Â Â Â Â MessageConsumer consumer = session.createConsumer(queue);</span><br><span class="line">Â Â Â Â <span class="comment">//7.è®¾ç½®æ¶ˆæ¯ç›‘å¬å™¨æ¥æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â consumer.setMessageListener(<span class="keyword">new</span> MessageListener() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(message <span class="keyword">instanceof</span> TextMessage)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â TextMessage textMessage = (TextMessage)message;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¥æ”¶çš„æ¶ˆæ¯ï¼ˆ2ï¼‰ï¼š&quot;</span>+textMessage.getText());</span><br><span class="line">Â Â Â Â Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â Â Â Â <span class="comment">//æ³¨æ„ï¼šåœ¨ç›‘å¬å™¨çš„æ¨¡å¼ä¸‹åƒä¸‡ä¸è¦å…³é—­è¿æ¥ï¼Œä¸€æ—¦å…³é—­ï¼Œæ¶ˆæ¯æ— æ³•æ¥æ”¶</span></span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯åŠ¨æµ‹è¯•</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313145806568.png" alt="image-20210313145806568"></p>
<h3 id="Pub-Subæ¨¡å¼-ç”Ÿæˆè€…"><a href="#Pub-Subæ¨¡å¼-ç”Ÿæˆè€…" class="headerlink" title="Pub/Subæ¨¡å¼(ç”Ÿæˆè€…)"></a>Pub/Subæ¨¡å¼(ç”Ÿæˆè€…)</h3><p><strong>æ­¥éª¤ï¼š</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">1.åˆ›å»ºè¿æ¥å·¥å‚</span><br><span class="line">2.åˆ›å»ºè¿æ¥</span><br><span class="line">3.æ‰“å¼€è¿æ¥</span><br><span class="line">4.åˆ›å»ºsession</span><br><span class="line">5.åˆ›å»ºç›®æ ‡åœ°å€ï¼ˆQueue:ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ŒTopicï¼šå‘å¸ƒè®¢é˜…æ¶ˆæ¯ï¼‰</span><br><span class="line">6.åˆ›å»ºæ¶ˆæ¯ç”Ÿäº§è€…</span><br><span class="line">7.åˆ›å»ºæ¶ˆæ¯</span><br><span class="line">8.å‘é€æ¶ˆæ¯</span><br><span class="line">9.é‡Šæ”¾èµ„æº</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TopicProducer</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory factory = newActiveMQConnectionFactory(<span class="string">&quot;tcp://linuxip:61616&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//2.åˆ›å»ºè¿æ¥</span></span><br><span class="line">Â Â Â Â Connection connection = factory.createConnection();</span><br><span class="line">Â Â Â Â <span class="comment">//3.æ‰“å¼€è¿æ¥</span></span><br><span class="line">Â Â Â Â connection.start();</span><br><span class="line">Â Â Â Â <span class="comment">//4.åˆ›å»ºsession</span></span><br><span class="line">Â Â Â Â Session session = connection.createSession(<span class="keyword">false</span>,Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â <span class="comment">//5.åˆ›å»ºç›®æ ‡åœ°å€ï¼ˆQueue:ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ŒTopicï¼šå‘å¸ƒè®¢é˜…æ¶ˆæ¯ï¼‰</span></span><br><span class="line">Â Â Â Â Topic topic = session.createTopic(<span class="string">&quot;sms&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//6.åˆ›å»ºæ¶ˆæ¯ç”Ÿäº§è€…</span></span><br><span class="line">Â Â Â Â MessageProducer producer = session.createProducer(topic);</span><br><span class="line">Â Â Â Â <span class="comment">//7.åˆ›å»ºæ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â TextMessage message = session.createTextMessage(<span class="string">&quot;å‘çŸ­ä¿¡...&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//8.å‘é€æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â producer.send(message);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;å‘é€æ¶ˆæ¯ï¼šå‘çŸ­ä¿¡...&quot;</span>);</span><br><span class="line">Â Â Â Â session.close();;</span><br><span class="line">Â Â Â Â connection.close();</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313150028026.png" alt="image-20210313150028026"></p>
<h3 id="Pub-Subæ¨¡å¼-æ¶ˆè´¹è€…"><a href="#Pub-Subæ¨¡å¼-æ¶ˆè´¹è€…" class="headerlink" title="Pub/Subæ¨¡å¼(æ¶ˆè´¹è€…)"></a>Pub/Subæ¨¡å¼(æ¶ˆè´¹è€…)</h3><p><strong>æ­¥éª¤ï¼š</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">1.åˆ›å»ºè¿æ¥å·¥å‚</span><br><span class="line">2.åˆ›å»ºè¿æ¥</span><br><span class="line">3.æ‰“å¼€è¿æ¥</span><br><span class="line">4.åˆ›å»ºsession</span><br><span class="line">5æŒ‡å®šç›®æ ‡åœ°å€</span><br><span class="line">6.åˆ›å»ºæ¶ˆæ¯çš„æ¶ˆè´¹è€…</span><br><span class="line">7.é…ç½®æ¶ˆæ¯ç›‘å¬å™¨</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TopicConsumer</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory factory = newActiveMQConnectionFactory(<span class="string">&quot;tcp://linuxip:61616&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//2.åˆ›å»ºè¿æ¥</span></span><br><span class="line">Â Â Â Â Connection connection = factory.createConnection();</span><br><span class="line">Â Â Â Â <span class="comment">//3.æ‰“å¼€è¿æ¥</span></span><br><span class="line">Â Â Â Â connection.start();</span><br><span class="line">Â Â Â Â <span class="comment">//4.åˆ›å»ºsession</span></span><br><span class="line">Â Â Â Â Session session = connection.createSession(<span class="keyword">false</span>,Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â <span class="comment">//5.åˆ›å»ºç›®æ ‡åœ°å€ï¼ˆQueue:ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ŒTopicï¼šå‘å¸ƒè®¢é˜…æ¶ˆæ¯ï¼‰</span></span><br><span class="line">Â Â Â Â Topic topic = session.createTopic(<span class="string">&quot;sms&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//6.åˆ›å»ºæ¶ˆæ¯çš„æ¶ˆè´¹è€…</span></span><br><span class="line">Â Â Â Â MessageConsumer consumer = session.createConsumer(topic);</span><br><span class="line">Â Â Â Â <span class="comment">//7.é…ç½®æ¶ˆæ¯ç›‘å¬å™¨</span></span><br><span class="line">Â Â Â Â consumer.setMessageListener(<span class="keyword">new</span> MessageListener() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â TextMessage textMessage = (TextMessage) message;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆè´¹æ¶ˆæ¯ï¼š&quot;</span> + textMessage.getText());</span><br><span class="line">Â Â Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-Springä¸ActiveMQæ•´åˆ"><a href="#4-Springä¸ActiveMQæ•´åˆ" class="headerlink" title="4.Springä¸ActiveMQæ•´åˆ"></a>4.Springä¸ActiveMQæ•´åˆ</h2><h3 id="æ¶ˆæ¯ç”Ÿäº§è€…"><a href="#æ¶ˆæ¯ç”Ÿäº§è€…" class="headerlink" title="æ¶ˆæ¯ç”Ÿäº§è€…"></a>æ¶ˆæ¯ç”Ÿäº§è€…</h3><p><strong>1.å¯¼å…¥åæ ‡</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.activemq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activemq-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.11.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-oxm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.jms<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.jms-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.xbean<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xbean-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2 . ç¼–å†™Springæ•´åˆActiveMQé…ç½®ï¼šapplicationContext-producer.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:amp</span>=<span class="string">&quot;http://activemq.apache.org/schema/core&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://activemq.apache.org/schema/core</span></span></span><br><span class="line"><span class="tag"><span class="string">http://activemq.apache.org/schema/core/activemq-core.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--1.åˆ›å»ºè¿æ¥å·¥å‚å¯¹è±¡--&gt;</span></span><br><span class="line">  &lt;amp:connectionFactory</span><br><span class="line">    id=&quot;connetionFactory&quot;</span><br><span class="line">    brokerURL=&quot;tcp://linuxip:61616&quot;</span><br><span class="line">    userName=&quot;admin&quot;</span><br><span class="line">    password=&quot;admin&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">  <span class="comment">&lt;!--2.åˆ›å»ºç¼“å­˜è¿æ¥å·¥å‚--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cachingConnectionFactory&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;org.springframework.jms.connection.CachingConnectionFactory&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å…¥è¿æ¥å·¥å‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;targetConnectionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;connetionFactory&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ç¼“å­˜æ¶ˆæ¯æ•°æ®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionCacheSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--3.åˆ›å»ºç”¨äºç‚¹å¯¹ç‚¹å‘é€çš„JmsTemplate--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jmsQueueTemplate&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;org.springframework.jms.core.JmsTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å…¥ç¼“å­˜è¿æ¥å·¥å‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connectionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;cachingConnectionFactory&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æŒ‡å®šæ˜¯å¦ä¸ºå‘å¸ƒè®¢é˜…æ¨¡å¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pubSubDomain&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--4.åˆ›å»ºç”¨äºå‘å¸ƒè®¢é˜…å‘é€çš„JmsTemplate--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jmsTopicTemplate&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;org.springframework.jms.core.JmsTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å…¥ç¼“å­˜è¿æ¥å·¥å‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connectionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;cachingConnectionFactory&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æŒ‡å®šæ˜¯å¦ä¸ºå‘å¸ƒè®¢é˜…æ¨¡å¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pubSubDomain&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>3.ç¼–å†™æµ‹è¯•ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span> <span class="comment">// junitä¸springæ•´åˆ</span></span><br><span class="line"><span class="meta">@ContextConfiguration(&quot;classpath:applicationContext-producer.xml&quot;)</span> <span class="comment">// åŠ è½½springé…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringProducer</span> </span>&#123;</span><br><span class="line">Â Â <span class="comment">//ç‚¹å¯¹ç‚¹æ¨¡å¼</span></span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="meta">@Qualifier(&quot;jmsQueueTemplate&quot;)</span></span><br><span class="line">Â Â <span class="keyword">private</span> JmsTemplate jmsQueueTemplate;</span><br><span class="line">Â Â <span class="comment">//å‘å¸ƒè®¢é˜…æ¨¡å¼</span></span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="meta">@Qualifier(&quot;jmsTopicTemplate&quot;)</span></span><br><span class="line">Â Â <span class="keyword">private</span> JmsTemplate jmsTopicTemplate;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * ç‚¹å¯¹ç‚¹å‘é€</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ptpSender</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â Â Â * å‚æ•°ä¸€ï¼šæŒ‡å®šé˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">Â Â Â Â * å‚æ•°äºŒï¼šMessageCreatoræ¥å£ï¼Œæˆ‘ä»¬éœ€è¦æä¾›è¯¥æ¥å£çš„åŒ¿åå†…éƒ¨å®ç°</span></span><br><span class="line"><span class="comment">Â Â Â Â */</span></span><br><span class="line">Â Â Â Â jmsQueueTemplate.send(<span class="string">&quot;spring_queue&quot;</span>, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//æˆ‘ä»¬åªéœ€è¦è¿”å›å‘é€çš„æ¶ˆæ¯å†…å®¹å³å¯</span></span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//åˆ›å»ºæ–‡æœ¬æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â Â Â Â Â TextMessage textMessage = session.createTextMessage(<span class="string">&quot;spring testmessage&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span> textMessage;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å·²å®Œæˆ&quot;</span>);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å‘å¸ƒè®¢é˜…å‘é€</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">psSender</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â jmsTopicTemplate.send(<span class="string">&quot;spring_topic&quot;</span>, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//åˆ›å»ºæ–‡æœ¬æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â Â Â Â Â TextMessage textMessage = session.createTextMessage(<span class="string">&quot;spring testmessage--topic&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span> textMessage;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å·²å®Œæˆ&quot;</span>);</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ¶ˆæ¯æ¶ˆè´¹è€…"><a href="#æ¶ˆæ¯æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆæ¯æ¶ˆè´¹è€…"></a>æ¶ˆæ¯æ¶ˆè´¹è€…</h3><p><strong>1. ç¼–å†™ç›‘å¬å™¨ï¼šç›‘å¬ä¸»é¢˜æ¶ˆæ¯ã€é˜Ÿåˆ—æ¶ˆæ¯</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line">Â <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmailMessageListener</span> <span class="keyword">implements</span> <span class="title">MessageListener</span> </span>&#123;</span><br><span class="line">Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Â MapMessage mapMessage = (MapMessage) message;</span><br><span class="line">Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â String email = mapMessage.getString(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆè´¹æ¶ˆæ¯ï¼š&quot;</span> + email);</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<p><strong>2. ç¼–å†™Springæ•´åˆActiveMQé…ç½®ï¼šapplicationContext-consumer.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:amq</span>=<span class="string">&quot;http://activemq.apache.org/schema/core&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:jms</span>=<span class="string">&quot;http://www.springframework.org/schema/jms&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/jms</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/jms/spring-jms.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://activemq.apache.org/schema/core</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://activemq.apache.org/schema/core/activemq-core.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 1. åˆ›å»ºActiveMQè¿æ¥å·¥å‚ --&gt;</span></span><br><span class="line">  &lt;amq:connectionFactory</span><br><span class="line">      id=&quot;amqConnectionFactory&quot;</span><br><span class="line">      userName=&quot;admin&quot; password=&quot;admin&quot;</span><br><span class="line">      brokerURL=&quot;tcp://linuxip:61616&quot;/&gt;</span><br><span class="line">  <span class="comment">&lt;!-- 2. åˆ›å»ºç¼“å­˜å·¥å‚ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cachingConnectionFactory&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jms.connection.CachingConnectionFactory&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ³¨å…¥ è¿æ¥å·¥å‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;targetConnectionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;amqConnectionFactory&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- sessionç¼“å­˜æ•°ç›® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionCacheSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--å¼€å¯æ³¨è§£æ‰«æ--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;cn.itcast.spring_activemq_consumer&quot;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    é…ç½®æ¶ˆæ¯ç›‘å¬å™¨ç±»ï¼Œç›‘å¬é˜Ÿåˆ—æˆ–ä¸»é¢˜æ¶ˆæ¯æ¨¡å‹ä¸­çš„æ¶ˆæ¯ã€‚ä»è€Œå®ç°æ¶ˆè´¹æ¶ˆæ¯ã€‚</span></span><br><span class="line"><span class="comment">    jms:listener-container</span></span><br><span class="line"><span class="comment">      destination-type ç›‘å¬çš„JMSæ¶ˆæ¯ç±»å‹ï¼ˆqueueã€topicï¼‰</span></span><br><span class="line"><span class="comment">      connection-factory Springçš„ç¼“å­˜è¿æ¥å·¥å‚</span></span><br><span class="line"><span class="comment">    jms:listener</span></span><br><span class="line"><span class="comment">      destination å¯¹åº”MQä¸­é˜Ÿåˆ—åç§°æˆ–ä¸»é¢˜åç§°</span></span><br><span class="line"><span class="comment">      ref Â Â Â Â æ¶ˆæ¯ç›‘å¬å™¨ç±»ï¼ˆå®ç°MessageListeneræ¥å£ï¼‰</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 3.1 ç›‘å¬æŒ‡å®šåç§°(email)çš„é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">jms:listener-container</span> <span class="attr">destination-type</span>=<span class="string">&quot;queue&quot;</span> <span class="attr">connection-factory</span>=<span class="string">&quot;cachingConnectionFactory&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jms:listener</span> <span class="attr">destination</span>=<span class="string">&quot;email&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;emailMessageListener&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">jms:listener-container</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 3.2 ç›‘å¬æŒ‡å®šåç§°(email)çš„ä¸»é¢˜ä¸­çš„æ¶ˆæ¯ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">jms:listener-container</span> <span class="attr">destination-type</span>=<span class="string">&quot;topic&quot;</span> <span class="attr">connection-factory</span>=<span class="string">&quot;cachingConnectionFactory&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jms:listener</span> <span class="attr">destination</span>=<span class="string">&quot;sms&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;smsMessageListener&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">jms:listener-container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>3.ç¼–å†™æµ‹è¯•ç±»ï¼Œå‘é€æ¶ˆæ¯</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Springæ•´åˆActiveMQæ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">Â Â Â Â ApplicationContext ac =Â <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext-activemq-consumer.xml&quot;</span>);</span><br><span class="line">Â Â Â Â System.in.read(</span><br><span class="line">	Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-SpringBootä¸ActiveMQæ•´åˆ"><a href="#5-SpringBootä¸ActiveMQæ•´åˆ" class="headerlink" title="5.SpringBootä¸ActiveMQæ•´åˆ"></a>5.SpringBootä¸ActiveMQæ•´åˆ</h2><h3 id="æ¶ˆæ¯ç”Ÿäº§è€…-1"><a href="#æ¶ˆæ¯ç”Ÿäº§è€…-1" class="headerlink" title="æ¶ˆæ¯ç”Ÿäº§è€…"></a>æ¶ˆæ¯ç”Ÿäº§è€…</h3><p><strong>1.å¯¼å…¥æ‰€éœ€è¦çš„jaråŒ…</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">maven.compiler.targer</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.targer</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-activemq<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2.ç¼–å†™applicationContex-Producter.ymlé…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">9001</span> <span class="comment">#ç«¯å£</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">application:</span></span><br><span class="line">Â <span class="attr">name:</span> <span class="string">activemq-producer</span> <span class="comment"># æœåŠ¡åç§°</span></span><br><span class="line"><span class="comment"># springbootä¸activemqæ•´åˆé…ç½®</span></span><br><span class="line"><span class="attr">activemq:</span></span><br><span class="line">Â <span class="attr">broker-url:</span> <span class="string">tcp://linuxip:61616</span> <span class="comment"># è¿æ¥åœ°å€</span></span><br><span class="line">Â <span class="attr">user:</span> <span class="string">admin</span> <span class="comment"># activemqç”¨æˆ·å</span></span><br><span class="line">Â <span class="attr">password:</span> <span class="string">admin</span> Â <span class="comment"># activemqå¯†ç </span></span><br><span class="line"><span class="comment"># æŒ‡å®šå‘é€æ¨¡å¼ ï¼ˆç‚¹å¯¹ç‚¹ false ï¼Œ å‘å¸ƒè®¢é˜… trueï¼‰</span></span><br><span class="line"><span class="attr">jms:</span></span><br><span class="line">Â <span class="attr">pub-sub-domain:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p><strong>3.ç¼–å†™å¯åŠ¨ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerApplication</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â SpringApplication.run(ProducerApplication.class,args);</span><br><span class="line">	Â &#125;</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p><strong>4.ç¼–å†™ç”Ÿäº§è€…</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ¼”ç¤ºSpringBootä¸ActiveMQæ•´åˆ- æ¶ˆæ¯ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest(classes = ProducerApplication.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootProducer</span> </span>&#123;</span><br><span class="line">Â Â <span class="comment">//JmsMessagingTemplate: ç”¨äºå·¥å…·ç±»å‘é€æ¶ˆæ¯</span></span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="keyword">private</span> JmsMessagingTemplate jmsMessagingTemplate;</span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ptpSender</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â Â Â * å‚æ•°ä¸€ï¼šé˜Ÿåˆ—çš„åç§°æˆ–ä¸»é¢˜åç§°</span></span><br><span class="line"><span class="comment">Â Â Â Â * å‚æ•°äºŒï¼šæ¶ˆæ¯å†…å®¹</span></span><br><span class="line"><span class="comment">Â Â Â Â */</span></span><br><span class="line">Â Â Â Â jmsMessagingTemplate.convertAndSend(<span class="string">&quot;springboot_queue&quot;</span>,<span class="string">&quot;spring bootmessage&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>5.å¯åŠ¨æµ‹è¯•ï¼</strong></p>
<h3 id="æ¶ˆæ¯æ¶ˆè´¹è€…-1"><a href="#æ¶ˆæ¯æ¶ˆè´¹è€…-1" class="headerlink" title="æ¶ˆæ¯æ¶ˆè´¹è€…"></a>æ¶ˆæ¯æ¶ˆè´¹è€…</h3><p><strong>1.å¯¼å…¥æ‰€éœ€è¦jaråŒ…</strong></p>
<p><strong>2.ç¼–å†™applicationContext-Consumer.ymlé…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">9002</span> <span class="comment">#ç«¯å£</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">application:</span></span><br><span class="line">Â <span class="attr">name:</span> <span class="string">activemq-consumer</span> <span class="comment"># æœåŠ¡åç§°</span></span><br><span class="line"><span class="comment"># springbootä¸activemqæ•´åˆé…ç½®</span></span><br><span class="line"><span class="attr">activemq:</span></span><br><span class="line">Â <span class="attr">broker-url:</span> <span class="string">tcp://linuxip:61616</span> <span class="comment"># è¿æ¥åœ°å€</span></span><br><span class="line">Â <span class="attr">user:</span> <span class="string">admin</span> <span class="comment"># activemqç”¨æˆ·å</span></span><br><span class="line">Â <span class="attr">password:</span> <span class="string">admin</span> Â <span class="comment"># activemqå¯†ç </span></span><br><span class="line"><span class="comment"># æŒ‡å®šå‘é€æ¨¡å¼ ï¼ˆç‚¹å¯¹ç‚¹ false ï¼Œ å‘å¸ƒè®¢é˜… trueï¼‰</span></span><br><span class="line"><span class="attr">jms:</span></span><br><span class="line">Â <span class="attr">pub-sub-domain:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">activemq:</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">springboot_queue</span></span><br></pre></td></tr></table></figure>

<p><strong>3.ç¼–å†™å¯åŠ¨ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerApplication</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â SpringApplication.run(ConsumerApplication.class,args);</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>4.ç¼–å†™ç›‘å¬å™¨ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* ç”¨äºç›‘å¬æ¶ˆæ¯ç±»ï¼ˆæ—¢å¯ä»¥ç”¨äºé˜Ÿåˆ—çš„ç›‘å¬ï¼Œä¹Ÿå¯ä»¥ç”¨äºä¸»é¢˜ç›‘å¬ï¼‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">// æ”¾å…¥IOCå®¹å™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MsgListener</span> </span>&#123;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * ç”¨äºæ¥æ”¶æ¶ˆæ¯çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">Â Â * destination: é˜Ÿåˆ—çš„åç§°æˆ–ä¸»é¢˜çš„åç§°</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@JmsListener(destination = &quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(Message message)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(message <span class="keyword">instanceof</span> TextMessage)&#123;</span><br><span class="line">Â Â Â Â Â Â TextMessage textMessage = (TextMessage)message;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¥æ”¶æ¶ˆæ¯ï¼š&quot;</span>+textMessage.getText());</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-ActiveMQæ¶ˆæ¯ç»„æˆä¸é«˜çº§ç‰¹æ€§"><a href="#6-ActiveMQæ¶ˆæ¯ç»„æˆä¸é«˜çº§ç‰¹æ€§" class="headerlink" title="6.ActiveMQæ¶ˆæ¯ç»„æˆä¸é«˜çº§ç‰¹æ€§"></a>6.ActiveMQæ¶ˆæ¯ç»„æˆä¸é«˜çº§ç‰¹æ€§</h2><h3 id="JMSæ¶ˆæ¯ç»„æˆè¯¦è§£"><a href="#JMSæ¶ˆæ¯ç»„æˆè¯¦è§£" class="headerlink" title="JMSæ¶ˆæ¯ç»„æˆè¯¦è§£"></a>JMSæ¶ˆæ¯ç»„æˆè¯¦è§£</h3><p><strong>JMSæ¶ˆæ¯ç»„æˆæ ¼å¼</strong></p>
<table>
<thead>
<tr>
<th>ç»“æ„</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>JMS Provider</td>
<td>æ¶ˆæ¯ä¸­é—´ä»¶/æ¶ˆæ¯æœåŠ¡å™¨</td>
</tr>
<tr>
<td>JMS Producer</td>
<td>æ¶ˆæ¯ç”Ÿäº§è€…</td>
</tr>
<tr>
<td>JMS Consumer</td>
<td>æ¶ˆæ¯æ¶ˆè´¹è€…</td>
</tr>
<tr>
<td>JMS Message</td>
<td>æ¶ˆæ¯</td>
</tr>
</tbody></table>
<p><strong>JMS Messageæ¶ˆæ¯ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</strong></p>
<ul>
<li>(1ï¼‰æ¶ˆæ¯å¤´</li>
<li>(2ï¼‰æ¶ˆæ¯ä½“</li>
<li>(3ï¼‰æ¶ˆæ¯å±æ€§</li>
</ul>
<h4 id="JMSæ¶ˆæ¯å¤´"><a href="#JMSæ¶ˆæ¯å¤´" class="headerlink" title="JMSæ¶ˆæ¯å¤´"></a><strong>JMSæ¶ˆæ¯å¤´</strong></h4><p>JMSæ¶ˆæ¯å¤´é¢„å®šä¹‰äº†è‹¥å¹²å­—æ®µç”¨äºå®¢æˆ·ç«¯ä¸JMSæä¾›è€…ä¹‹é—´è¯†åˆ«å’Œå‘é€æ¶ˆæ¯ï¼Œé¢„ç¼–è¯‘å¤´å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><font color="red">JMSDestination</font></td>
<td>æ¶ˆæ¯å‘é€çš„ Destinationï¼Œåœ¨å‘é€è¿‡ç¨‹ä¸­ç”±æä¾›è€…è®¾ç½®</td>
</tr>
<tr>
<td><font color="red">JMSMessageID</font></td>
<td>å”¯ä¸€æ ‡è¯†æä¾›è€…å‘é€çš„æ¯ä¸€æ¡æ¶ˆæ¯ã€‚è¿™ä¸ªå­—æ®µæ˜¯åœ¨å‘é€è¿‡ç¨‹ä¸­ç”±æä¾›è€…è®¾<br/>ç½®çš„ï¼Œå®¢æˆ·æœºåªèƒ½åœ¨æ¶ˆæ¯å‘é€åæ‰èƒ½ç¡®å®šæ¶ˆæ¯çš„ JMSMessageID</td>
</tr>
<tr>
<td><font color="red">JMSDeliveryMode</font></td>
<td>æ¶ˆæ¯æŒä¹…åŒ–ã€‚åŒ…å«å€¼ DeliveryMode.PERSISTENT æˆ–è€…<br/>DeliveryMode.NON_PERSISTENTã€‚</td>
</tr>
<tr>
<td>JMSTimestamp</td>
<td>æä¾›è€…å‘é€æ¶ˆæ¯çš„æ—¶é—´ï¼Œç”±æä¾›è€…åœ¨å‘é€è¿‡ç¨‹ä¸­è®¾ç½®</td>
</tr>
<tr>
<td><font color="red">JMSExpiration</font></td>
<td>æ¶ˆæ¯å¤±æ•ˆçš„æ—¶é—´ï¼Œæ¯«ç§’ï¼Œå€¼ 0 è¡¨æ˜æ¶ˆæ¯ä¸ä¼šè¿‡æœŸï¼Œé»˜è®¤å€¼ä¸º0</td>
</tr>
<tr>
<td><font color="red">JMSPriority</font></td>
<td>æ¶ˆæ¯çš„ä¼˜å…ˆçº§ï¼Œç”±æä¾›è€…åœ¨å‘é€è¿‡ç¨‹ä¸­è®¾ç½®ã€‚ä¼˜å…ˆçº§ 0 çš„ä¼˜å…ˆçº§æœ€ä½ï¼Œä¼˜<br/>å…ˆçº§ 9 çš„ä¼˜å…ˆçº§æœ€é«˜ã€‚0-4ä¸ºæ™®é€šæ¶ˆæ¯ï¼Œ5-9ä¸ºåŠ æ€¥æ¶ˆæ¯</td>
</tr>
<tr>
<td><font color="red">JMSCorrelationID</font></td>
<td>é€šå¸¸ç”¨æ¥é“¾æ¥å“åº”æ¶ˆæ¯ä¸è¯·æ±‚æ¶ˆæ¯ï¼Œç”±å‘é€æ¶ˆæ¯çš„ JMS ç¨‹åºè®¾ç½®</td>
</tr>
<tr>
<td>JMSReplyTo</td>
<td>è¯·æ±‚ç¨‹åºç”¨å®ƒæ¥æŒ‡å‡ºå›å¤æ¶ˆæ¯åº”å‘é€çš„åœ°æ–¹ï¼Œç”±å‘é€æ¶ˆæ¯çš„ JMS ç¨‹åºè®¾ç½®</td>
</tr>
<tr>
<td>JMSType</td>
<td>JMS ç¨‹åºç”¨å®ƒæ¥æŒ‡å‡ºæ¶ˆæ¯çš„ç±»å‹</td>
</tr>
<tr>
<td>JMSRedelivered</td>
<td>æ¶ˆæ¯çš„é‡å‘æ ‡å¿—ï¼Œfalseï¼Œä»£è¡¨è¯¥æ¶ˆæ¯æ˜¯ç¬¬ä¸€æ¬¡å‘ç”Ÿï¼Œtrueï¼Œä»£è¡¨è¯¥æ¶ˆæ¯ä¸º<br/>é‡å‘æ¶ˆæ¯</td>
</tr>
</tbody></table>
<p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¼ é€æ¶ˆæ¯æ—¶ï¼Œæ¶ˆæ¯å¤´çš„å€¼ç”±JMSæä¾›è€…æ¥è®¾ç½®ï¼Œå› æ­¤<strong>å¼€å‘è€…ä½¿ç”¨ä»¥ä¸Š****setJMSXXX()æ–¹æ³•åˆ†é…çš„å€¼å°±è¢«å¿½ç•¥äº†</strong>ï¼Œåªæœ‰ä»¥ä¸‹å‡ ä¸ªå€¼æ˜¯å¯ä»¥ç”±å¼€å‘è€…è®¾ç½®çš„ï¼š**</p>
<p><strong>JMSCorrelationIDï¼ŒJMSReplyToï¼ŒJMSType</strong></p>
<h4 id="JMSæ¶ˆæ¯ä½“"><a href="#JMSæ¶ˆæ¯ä½“" class="headerlink" title="JMSæ¶ˆæ¯ä½“"></a>JMSæ¶ˆæ¯ä½“</h4><p>åœ¨æ¶ˆæ¯ä½“ä¸­ï¼ŒJMS APIå®šä¹‰äº†äº”ç§ç±»å‹çš„æ¶ˆæ¯æ ¼å¼ï¼Œè®©æˆ‘ä»¬å¯ä»¥ä»¥ä¸åŒçš„å½¢å¼å‘é€å’Œæ¥å—æ¶ˆæ¯ï¼Œå¹¶æä¾›å¯¹å·²æœ‰æ¶ˆæ¯æ ¼å¼çš„å…¼å®¹ã€‚ä¸åŒçš„æ¶ˆæ¯ç±»å‹å¦‚ä¸‹ï¼š<br><strong>JMS å®šä¹‰äº†äº”ç§ä¸åŒçš„æ¶ˆæ¯æ­£æ–‡æ ¼å¼ï¼Œä»¥åŠè°ƒç”¨çš„æ¶ˆæ¯ç±»å‹ï¼Œå…è®¸ä½ å‘é€å¹¶æ¥æ”¶ä¸€äº›ä¸åŒå½¢å¼çš„æ•°æ®ï¼Œ</strong><br><strong>æä¾›ç°æœ‰æ¶ˆæ¯æ ¼å¼çš„ä¸€äº›çº§åˆ«çš„å…¼å®¹æ€§ã€‚</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Â· TextMessage--ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ Â </span><br><span class="line">Â· MapMessage--ä¸€å¥—åç§°-å€¼å¯¹</span><br><span class="line">Â· ObjectMessage--ä¸€ä¸ªåºåˆ—åŒ–çš„ Java å¯¹è±¡ Â </span><br><span class="line">Â· BytesMessage--ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®æµ Â Â Â </span><br><span class="line">Â· StreamMessage -- JavaåŸå§‹å€¼çš„æ•°æ®æµ</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†åˆ«ç¼–å†™å‘é€å’Œæ¥å—æµ‹è¯•ç±»ï¼</strong></p>
<p><strong>TextMessage:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å‘é€TextMessageæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â jmsTemplate.send(name, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â TextMessage textMessage = session.createTextMessage(<span class="string">&quot;æ–‡æœ¬æ¶ˆæ¯&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span> textMessage;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ¥æ”¶TextMessageçš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@JmsListener(destination = &quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(Message message)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(message <span class="keyword">instanceof</span> TextMessage)&#123;</span><br><span class="line">Â Â Â Â Â Â TextMessage textMessage = (TextMessage)message;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¥æ”¶æ¶ˆæ¯ï¼š&quot;</span>+textMessage.getText());</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<p><strong>MapMessage:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mapMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â jmsTemplate.send(name, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â MapMessage mapMessage = session.createMapMessage();</span><br><span class="line">Â Â Â Â Â Â Â Â mapMessage.setString(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â mapMessage.setInt(<span class="string">&quot;age&quot;</span>,<span class="number">20</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span> mapMessage;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JmsListener(destination = &quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(Message message)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(message <span class="keyword">instanceof</span> MapMessage)&#123;</span><br><span class="line">Â Â Â Â Â Â MapMessage mapMessage = (MapMessage)message;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;åç§°ï¼š&quot;</span>+mapMessage.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;å¹´é¾„ï¼š&quot;</span>+mapMessage.getString(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<p><strong>ObjectMessage:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å‘é€ObjectMessageæ¶ˆæ¯</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â jmsTemplate.send(name, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â User user = <span class="keyword">new</span> User();<span class="comment">//ç¼–å†™ä¸€ä¸ªUserç±»ã€‚ã€‚ã€‚</span></span><br><span class="line">Â Â Â Â Â Â Â Â user.setName(<span class="string">&quot;å°è‹&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â user.setAge(<span class="number">18</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â ObjectMessage objectMessage = session.createObjectMessage(user);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span> objectMessage;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JmsListener(destination = &quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(Message message)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(message <span class="keyword">instanceof</span> ObjectMessage)&#123;</span><br><span class="line">Â Â Â Â Â Â ObjectMessage objectMessage = (ObjectMessage)message;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â User user = (User)objectMessage.getObject();</span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(user.getUsername());</span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(user.getPassword());</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<p><strong><font color="green">æ³¨æ„ï¼š ActiveMQ5.12å ï¼Œä¸ºäº†å®‰å…¨è€ƒè™‘ï¼ŒActiveMQé»˜è®¤ä¸æ¥å—è‡ªå®šä¹‰çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œéœ€è¦å°†è‡ªå®šä¹‰çš„<br>åŠ å…¥åˆ°å—ä¿¡ä»»çš„åˆ—è¡¨ã€‚</font></strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">activemq:</span></span><br><span class="line">Â <span class="attr">broker-url:</span> <span class="string">tcp://linuxip:61616</span></span><br><span class="line">Â <span class="attr">user:</span> <span class="string">admin</span></span><br><span class="line">Â <span class="attr">password:</span> <span class="string">admin</span></span><br><span class="line">Â <span class="attr">packages:</span></span><br><span class="line">Â Â <span class="attr">trust-all:</span> <span class="literal">true</span> <span class="comment"># æ·»åŠ æ‰€æœ‰åŒ…åˆ°ä¿¡ä»»åˆ—è¡¨</span></span><br></pre></td></tr></table></figure>

<p><strong>BytesMessageï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å‘é€BytesMessageæ¶ˆæ¯</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â jmsTemplate.send(name, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â BytesMessage bytesMessage = session.createBytesMessage();</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â File file = <span class="keyword">new</span> File(<span class="string">&quot;d:/spring.jpg&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â FileInputStream in = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[(<span class="keyword">int</span>)file.length()];</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â in.read(bytes);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â bytesMessage.writeBytes(bytes);</span><br><span class="line">Â Â Â Â Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span> bytesMessage;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JmsListener(destination=&quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(Message message)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â Â Â Â BytesMessage bytesMessage = (BytesMessage)message;</span><br><span class="line">Â Â Â Â FileOutputStream out = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;d:/abc.jpg&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[(<span class="keyword">int</span>)bytesMessage.getBodyLength()];</span><br><span class="line">Â Â Â Â bytesMessage.readBytes(buf);</span><br><span class="line">Â Â Â Â out.write(buf);</span><br><span class="line">Â Â Â Â out.close();</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<p><strong>StreamMessage:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å‘é€StreamMessageæ¶ˆæ¯</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â jmsTemplate.send(name, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â StreamMessage streamMessage = session.createStreamMessage();</span><br><span class="line">Â Â Â Â Â Â Â Â streamMessage.writeString(<span class="string">&quot;ä½ å¥½ï¼ŒActiveMQ&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â streamMessage.writeInt(<span class="number">20</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span> streamMessage;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;);</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JmsListener(destination=&quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(Message message)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â Â Â Â StreamMessage streamMessage = (StreamMessage)message;</span><br><span class="line">Â Â Â Â String str = streamMessage.readString();</span><br><span class="line">Â Â Â Â <span class="keyword">int</span> i = streamMessage.readInt();</span><br><span class="line">Â Â Â Â System.out.println(str);</span><br><span class="line">Â Â Â Â System.out.println(i);</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<h4 id="JMSæ¶ˆæ¯å±æ€§"><a href="#JMSæ¶ˆæ¯å±æ€§" class="headerlink" title="JMSæ¶ˆæ¯å±æ€§"></a>JMSæ¶ˆæ¯å±æ€§</h4><p>æˆ‘ä»¬å¯ä»¥ç»™æ¶ˆæ¯è®¾ç½®è‡ªå®šä¹‰å±æ€§ï¼Œè¿™äº›å±æ€§ä¸»è¦æ˜¯æä¾›ç»™åº”ç”¨ç¨‹åºçš„ã€‚å¯¹äºå®ç°æ¶ˆæ¯è¿‡æ»¤åŠŸèƒ½ï¼Œæ¶ˆæ¯å±æ€§éå¸¸æœ‰ç”¨ï¼ŒJMS APIå®šä¹‰äº†ä¸€äº›æ ‡å‡†å±æ€§ï¼Œ<strong>JMSæœåŠ¡æä¾›è€…å¯ä»¥é€‰æ‹©æ€§çš„æä¾›éƒ¨åˆ†æ ‡å‡†å±æ€§</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">message.setStringProperty(<span class="string">&quot;Property&quot;</span>,Property); Â Â <span class="comment">//è‡ªå®šä¹‰å±æ€§</span></span><br></pre></td></tr></table></figure>



<h3 id="æ¶ˆæ¯æŒä¹…åŒ–"><a href="#æ¶ˆæ¯æŒä¹…åŒ–" class="headerlink" title="æ¶ˆæ¯æŒä¹…åŒ–"></a>æ¶ˆæ¯æŒä¹…åŒ–</h3><p><strong>ä¸‰ç§æ¶ˆæ¯å­˜å‚¨æ–¹å¼ï¼š</strong></p>
<ul>
<li> Memory æ¶ˆæ¯å­˜å‚¨-åŸºäºå†…å­˜çš„æ¶ˆæ¯å­˜å‚¨</li>
<li>åŸºäºæ—¥å¿—æ¶ˆæ¯å­˜å‚¨æ–¹å¼ï¼ŒKahaDBæ˜¯ActiveMQçš„é»˜è®¤æ—¥å¿—å­˜å‚¨æ–¹å¼ï¼Œå®ƒæä¾›äº†å®¹é‡çš„æå‡å’Œæ¢å¤èƒ½åŠ›</li>
<li>åŸºäºJDBCçš„æ¶ˆæ¯å­˜å‚¨æ–¹å¼-æ•°æ®å­˜å‚¨äºæ•°æ®åº“ï¼ˆä¾‹å¦‚ï¼šMySQLï¼‰ä¸­</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313173824532.png" alt="image-20210313173824532"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313173843750.png" alt="image-20210313173843750"></p>
<p><strong>JDBCæ¶ˆæ¯å­˜å‚¨</strong></p>
<p><strong>(1)ä¿®æ”¹ymlé…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">9001</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">activemq:</span></span><br><span class="line">Â <span class="attr">broker-url:</span> <span class="string">tcp://192.168.66.133:61616</span></span><br><span class="line">Â <span class="attr">user:</span> <span class="string">admin</span></span><br><span class="line">Â <span class="attr">password:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">jms:</span></span><br><span class="line">Â <span class="attr">pub-sub-domain:</span> <span class="literal">false</span> <span class="comment"># falseï¼šç‚¹å¯¹ç‚¹é˜Ÿåˆ—æ¨¡å¼ï¼Œ trueï¼šå‘å¸ƒ/è®¢é˜…æ¨¡å¼</span></span><br><span class="line">Â <span class="attr">template:</span></span><br><span class="line">Â Â <span class="attr">delivery-mode:</span> <span class="string">persistent</span> <span class="comment"># æŒä¹…åŒ–</span></span><br><span class="line"><span class="attr">activemq:</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">springboot-queue01</span></span><br></pre></td></tr></table></figure>

<p><strong>(2)è¿›å…¥é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹activemq.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®æ•°æ®åº“è¿æ¥æ± --&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;mysql-ds&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://linuxip:3306/db_activemq&quot;</span> /&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;*****&quot;</span>/&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--JDBC Jdbcç”¨äºmaster/slaveæ¨¡å¼çš„æ•°æ®åº“åˆ†äº« --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">persistenceAdapter</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">jdbcPersistenceAdapter</span> <span class="attr">dataSource</span>=<span class="string">&quot;#mysql-ds&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">persistenceAdapter</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>(3ï¼‰æ‹·è´mysqlåŠduridæ•°æ®æºçš„jaråŒ…åˆ°activemqçš„libç›®å½•ä¸‹</strong><br>(<strong>4ï¼‰é‡å¯activemq</strong></p>
<p><strong>æ¶ˆæ¯äº‹åŠ¡</strong></p>
<p>æ¶ˆæ¯äº‹åŠ¡ï¼Œæ˜¯ä¿è¯æ¶ˆæ¯ä¼ é€’åŸå­æ€§çš„ä¸€ä¸ªé‡è¦ç‰¹å¾ï¼Œå’ŒJDBCçš„äº‹åŠ¡ç‰¹å¾ç±»ä¼¼ã€‚<br>ä¸€ä¸ªäº‹åŠ¡æ€§å‘é€ï¼Œå…¶ä¸­ä¸€ç»„æ¶ˆæ¯è¦ä¹ˆèƒ½å¤Ÿå…¨éƒ¨ä¿è¯åˆ°è¾¾æœåŠ¡å™¨ï¼Œè¦ä¹ˆéƒ½ä¸åˆ°è¾¾æœåŠ¡å™¨ã€‚<br>ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ä¸æ¶ˆæ¯æœåŠ¡å™¨ç›´æ¥éƒ½æ”¯æŒäº‹åŠ¡æ€§ï¼›<br>ActionMQçš„äº‹åŠ¡ä¸»è¦åå‘åœ¨ç”Ÿäº§è€…çš„åº”ç”¨ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313174254444.png" alt="image-20210313174254444"></p>
<p><strong>ç”Ÿäº§è€…äº‹åŠ¡</strong></p>
<p>æ–¹å¼ä¸€</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * äº‹åŠ¡æ€§å‘é€--æ–¹æ¡ˆä¸€</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessageTx</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//è·å–è¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory connectionFactory =jmsMessagingTemplate.getConnectionFactory();</span><br><span class="line">Â Â Â Â Session session = <span class="keyword">null</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//åˆ›å»ºè¿æ¥</span></span><br><span class="line">Â Â Â Â Â Â Connection connection = connectionFactory.createConnection();</span><br><span class="line">Â Â Â Â Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â Â Â Â Â * å‚æ•°ä¸€ï¼šæ˜¯å¦å¼€å¯æ¶ˆæ¯äº‹åŠ¡</span></span><br><span class="line"><span class="comment">Â Â Â Â Â Â */</span></span><br><span class="line">Â Â Â Â Â Â session = connection.createSession(<span class="keyword">true</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//åˆ›å»ºç”Ÿäº§è€…</span></span><br><span class="line">Â Â Â Â Â Â MessageProducer producer =session.createProducer(session.createQueue(name));</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(i==<span class="number">4</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="keyword">int</span> a = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â TextMessage textMessage = session.createTextMessage(<span class="string">&quot;æ¶ˆæ¯--&quot;</span> +i);</span><br><span class="line">Â Â Â Â Â Â Â Â producer.send(textMessage);</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//æ³¨æ„ï¼šä¸€æ—¦å¼€å¯äº‹åŠ¡å‘é€ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨commitæ–¹æ³•è¿›è¡Œäº‹åŠ¡æäº¤ï¼Œå¦åˆ™æ¶ˆæ¯æ— æ³•åˆ°è¾¾MQæœåŠ¡å™¨</span></span><br><span class="line">Â Â Â Â Â Â session.commit();</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//æ¶ˆæ¯äº‹åŠ¡å›æ»š</span></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â session.rollback();</span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e1) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â e1.printStackTrace();</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹å¼äºŒ</p>
<p><strong>é…ç½®ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActiveMqConfig</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">transactionManager</span><span class="params">(ConnectionFactory</span></span></span><br><span class="line"><span class="function"><span class="params">connectionFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> JmsTransactionManager(connectionFactory);</span><br><span class="line">	 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿäº§è€…ä¸šåŠ¡ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ¶ˆæ¯å‘é€çš„ä¸šåŠ¡ç±»</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageService</span> </span>&#123;</span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="keyword">private</span> JmsMessagingTemplate jmsMessagingTemplate;</span><br><span class="line">Â Â <span class="meta">@Value(&quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="keyword">private</span> String name;</span><br><span class="line">Â Â <span class="meta">@Transactional</span> <span class="comment">// å¯¹æ¶ˆæ¯å‘é€åŠ å…¥äº‹åŠ¡ç®¡ç†ï¼ˆåŒæ—¶ä¹Ÿå¯¹JDBCæ•°æ®åº“çš„äº‹åŠ¡ç”Ÿæ•ˆï¼‰</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++) &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span>(i==<span class="number">4</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span> a = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â jmsMessagingTemplate.convertAndSend(name, <span class="string">&quot;æ¶ˆæ¯---&quot;</span>+i);</span><br><span class="line">Â 		Â Â &#125;</span><br><span class="line">	Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•ç±»æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="keyword">private</span> MessageService messageService;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * äº‹åŠ¡æ€§å‘é€--æ–¹æ¡ˆäºŒï¼š Springçš„JmsTransactionManageråŠŸèƒ½</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessageTx2</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â messageService.sendMessage();</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>



<p><strong>æ¶ˆè´¹è€…äº‹åŠ¡:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ¶ˆæ¯æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ¥æ”¶æ¶ˆæ¯çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@JmsListener(destination=&quot;$&#123;activemq.name&#125;&quot;,containerFactory =</span></span><br><span class="line"><span class="meta">&quot;jmsQueryListenerFactory&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(TextMessage textMessage,Session session)</span> <span class="keyword">throws</span></span></span><br><span class="line"><span class="function">JMSException </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆæ¯å†…å®¹ï¼š&quot;</span> + textMessage.getText() + <span class="string">&quot;,æ˜¯å¦é‡å‘ï¼š&quot;</span></span><br><span class="line">+ textMessage.getJMSRedelivered());</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">int</span> i = <span class="number">100</span>/<span class="number">0</span>; <span class="comment">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span><br><span class="line">Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â session.commit();<span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â session.rollback();<span class="comment">//å›æ»šäº‹åŠ¡</span></span><br><span class="line">Â Â Â Â Â &#125; <span class="keyword">catch</span> (JMSException e1) &#123;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â 		Â Â &#125;</span><br><span class="line">	Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¶ˆæ¯ç¡®è®¤æœºåˆ¶"><a href="#æ¶ˆæ¯ç¡®è®¤æœºåˆ¶" class="headerlink" title="æ¶ˆæ¯ç¡®è®¤æœºåˆ¶"></a>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</h4><p>JMSæ¶ˆæ¯åªæœ‰åœ¨è¢«ç¡®è®¤ä¹‹åï¼Œæ‰è®¤ä¸ºå·²ç»è¢«æˆåŠŸåœ°æ¶ˆè´¹äº†ã€‚æ¶ˆæ¯çš„æˆåŠŸæ¶ˆè´¹é€šå¸¸åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š<strong>å®¢æˆ·æ¥</strong><br><strong>æ”¶æ¶ˆæ¯ã€å®¢æˆ·å¤„ç†æ¶ˆæ¯å’Œæ¶ˆæ¯è¢«ç¡®è®¤</strong>ã€‚åœ¨äº‹åŠ¡æ€§ä¼šè¯ä¸­ï¼Œå½“ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤çš„æ—¶å€™ï¼Œç¡®è®¤è‡ªåŠ¨å‘ç”Ÿã€‚åœ¨<br>éäº‹åŠ¡æ€§ä¼šè¯ä¸­ï¼Œæ¶ˆæ¯ä½•æ—¶è¢«ç¡®è®¤å–å†³äºåˆ›å»ºä¼šè¯æ—¶çš„åº”ç­”æ¨¡å¼ï¼ˆacknowledgement modeï¼‰ã€‚è¯¥å‚<br>æ•°æœ‰ä»¥ä¸‹ä¸‰ä¸ªå¯é€‰å€¼ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Session.AUTO_ACKNOWLEDGE</td>
<td>å½“å®¢æˆ·æˆåŠŸçš„ä»receiveæ–¹æ³•è¿”å›çš„æ—¶å€™ï¼Œæˆ–è€…ä»MessageListener.onMessageæ–¹æ³•æˆåŠŸè¿”å›çš„æ—¶å€™ï¼Œä¼šè¯è‡ªåŠ¨ç¡®è®¤å®¢æˆ·æ”¶åˆ°çš„æ¶ˆæ¯</td>
</tr>
<tr>
<td>Session.CLIENT_ACKNOWLEDGE</td>
<td>å®¢æˆ·é€šè¿‡æ¶ˆæ¯çš„acknowledgeæ–¹æ³•ç¡®è®¤æ¶ˆæ¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œç¡®è®¤æ˜¯åœ¨ä¼šè¯å±‚ä¸Šè¿›è¡Œï¼šç¡®è®¤ä¸€ä¸ªè¢«æ¶ˆè´¹çš„æ¶ˆæ¯å°†è‡ªåŠ¨ç¡®è®¤æ‰€æœ‰å·²è¢«ä¼šè¯æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæ¶ˆæ¯æ¶ˆè´¹è€…æ¶ˆè´¹äº†10ä¸ªæ¶ˆæ¯ï¼Œç„¶åç¡®è®¤ç¬¬5ä¸ªæ¶ˆæ¯ï¼Œé‚£ä¹ˆæ‰€æœ‰10ä¸ªæ¶ˆæ¯éƒ½è¢«ç¡®è®¤</td>
</tr>
<tr>
<td>Session.DUPS_ACKNOWLEDGE</td>
<td>è¯¥é€‰æ‹©åªæ˜¯ä¼šè¯è¿Ÿé’ç¡®è®¤æ¶ˆæ¯çš„æäº¤ã€‚å¦‚æœJMS providerå¤±è´¥ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é‡å¤çš„æ¶ˆæ¯ã€‚å¦‚æœæ˜¯é‡å¤çš„æ¶ˆæ¯ï¼Œé‚£ä¹ˆJMS providerå¿…é¡»æŠŠæ¶ˆæ¯å¤´çš„JMSRedeliveredå­—æ®µè®¾ç½®ä¸ºtrue</td>
</tr>
</tbody></table>
<p><strong>æ³¨æ„ï¼šæ¶ˆæ¯ç¡®è®¤æœºåˆ¶ä¸äº‹åŠ¡æœºåˆ¶æ˜¯å†²çªçš„ï¼Œåªèƒ½é€‰å…¶ä¸­ä¸€ç§ã€‚æ‰€ä»¥æ¼”ç¤ºæ¶ˆæ¯ç¡®è®¤å‰ï¼Œå…ˆå…³é—­äº‹åŠ¡ã€‚</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313195231306.png" alt="image-20210313195231306"></p>
<p><strong>(1ï¼‰auto_acknowledge è‡ªåŠ¨ç¡®è®¤</strong></p>
<p>ç¼–å†™é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActiveMqConfig</span> </span>&#123;</span><br><span class="line">Â Â <span class="meta">@Bean(name=&quot;jmsQueryListenerFactory&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> DefaultJmsListenerContainerFactory <span class="title">jmsListenerContainerFactory</span><span class="params">(ConnectionFactory connectionFactory)</span></span>&#123;</span><br><span class="line">Â Â Â Â DefaultJmsListenerContainerFactory factory=<span class="keyword">new</span> DefaultJmsListenerContainerFactory();</span><br><span class="line">Â Â Â Â factory.setConnectionFactory(connectionFactory);</span><br><span class="line">Â Â Â Â factory.setSessionTransacted(<span class="keyword">false</span>); <span class="comment">// ä¸å¼€å¯äº‹åŠ¡æ“ä½œ</span></span><br><span class="line">Â Â Â Â factory.setSessionAcknowledgeMode(<span class="number">1</span>); <span class="comment">//è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line">Â Â Â Â <span class="keyword">return</span> factory;</span><br><span class="line">	Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¶ˆè´¹è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ¶ˆæ¯æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ¥æ”¶æ¶ˆæ¯çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@JmsListener(destination=&quot;$&#123;activemq.name&#125;&quot;,containerFactory =</span></span><br><span class="line"><span class="meta">&quot;jmsQueryListenerFactory&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(TextMessage textMessage)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆæ¯å†…å®¹ï¼š&quot;</span> + textMessage.getText() + <span class="string">&quot;,æ˜¯å¦é‡å‘ï¼š&quot;</span></span><br><span class="line">+ textMessage.getJMSRedelivered());</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¦‚æœæ¶ˆè´¹æ–¹æ¥æ”¶æ¶ˆæ¯å¤±è´¥ï¼Œ JMSæœåŠ¡å™¨ä¼šé‡å‘æ¶ˆæ¯ï¼Œé»˜è®¤é‡å‘6æ¬¡ã€‚</strong></p>
<p><strong>(2ï¼‰dups_ok_acknowledge</strong><br>ç±»ä¼¼äº auto_acknowledge ç¡®è®¤æœºåˆ¶ï¼Œä¸ºè‡ªåŠ¨æ‰¹é‡ç¡®è®¤è€Œç”Ÿï¼Œè€Œä¸”å…·æœ‰â€œå»¶è¿Ÿâ€ç¡®è®¤çš„ç‰¹ç‚¹ï¼ŒActiveMQ<br>ä¼šæ ¹æ®å†…éƒ¨ç®—æ³•ï¼Œåœ¨æ”¶åˆ°ä¸€å®šæ•°é‡çš„æ¶ˆæ¯è‡ªåŠ¨è¿›è¡Œç¡®è®¤ã€‚ åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°é‡å¤æ¶ˆæ¯ï¼Œå¦‚æœæ¶ˆè´¹<br>æ–¹ä¸å…è®¸é‡å¤æ¶ˆè´¹ï¼Œä¸å»ºè®®ä½¿ç”¨ï¼</p>
<p><strong>(3ï¼‰client_acknowledge æ‰‹åŠ¨ç¡®è®¤</strong></p>
<p>ç¼–å†™é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActiveMqConfig</span> </span>&#123;</span><br><span class="line">Â Â <span class="meta">@Bean(name=&quot;jmsQueryListenerFactory&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> DefaultJmsListenerContainerFactory <span class="title">jmsListenerContainerFactory</span><span class="params">(ConnectionFactory connectionFactory)</span></span>&#123;</span><br><span class="line">Â Â Â Â DefaultJmsListenerContainerFactory factory=<span class="keyword">new</span> DefaultJmsListenerContainerFactory();</span><br><span class="line">Â Â Â Â factory.setConnectionFactory(connectionFactory);</span><br><span class="line">Â Â Â Â factory.setSessionTransacted(<span class="keyword">false</span>); <span class="comment">// ä¸å¼€å¯äº‹åŠ¡æ“ä½œ</span></span><br><span class="line">Â Â Â Â factory.setSessionAcknowledgeMode(<span class="number">4</span>); <span class="comment">//æ‰‹åŠ¨ç¡®è®¤</span></span><br><span class="line">Â Â Â Â <span class="keyword">return</span> factory;</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¶ˆè´¹è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ¶ˆæ¯æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * æ¥æ”¶æ¶ˆæ¯çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@JmsListener(destination=&quot;$&#123;activemq.name&#125;&quot;,containerFactory =&quot;jmsQueryListenerFactory&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveMessage</span><span class="params">(TextMessage textMessage)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆæ¯å†…å®¹ï¼š&quot;</span> + textMessage.getText() + <span class="string">&quot;,æ˜¯å¦é‡å‘ï¼š&quot;</span>+textMessage.getJMSRedelivered());</span><br><span class="line">Â Â Â Â Â Â textMessage.acknowledge(); <span class="comment">// ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯ï¼Œä¸€æ—¦æ¶ˆæ¯ç¡®è®¤ï¼Œæ¶ˆæ¯ä¸ä¼šé‡æ–°å‘é€</span></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¶ˆæ¯æŠ•é€’æ–¹å¼"><a href="#æ¶ˆæ¯æŠ•é€’æ–¹å¼" class="headerlink" title="æ¶ˆæ¯æŠ•é€’æ–¹å¼"></a>æ¶ˆæ¯æŠ•é€’æ–¹å¼</h3><p><strong>1ã€å¼‚æ­¥æŠ•é€’ vs åŒæ­¥æŠ•é€’</strong><br><strong>åŒæ­¥å‘é€ï¼š</strong><br>æ¶ˆæ¯ç”Ÿäº§è€…ä½¿ç”¨æŒä¹…ï¼ˆPersistentï¼‰ä¼ é€’æ¨¡å¼å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼ŒProducer.send() æ–¹æ³•ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°broker å‘é€ä¸€ä¸ªç¡®è®¤æ¶ˆæ¯ç»™ç”Ÿäº§è€…(ProducerAck)ï¼Œè¿™ä¸ªç¡®è®¤æ¶ˆæ¯æš—ç¤ºbrokerå·²ç»æˆåŠŸæ¥æ”¶åˆ°æ¶ˆæ¯å¹¶æŠŠæ¶ˆæ¯ä¿å­˜åˆ°äºŒçº§å­˜å‚¨ä¸­ã€‚<br><strong>å¼‚æ­¥å‘é€:</strong><br>å¦‚æœåº”ç”¨ç¨‹åºèƒ½å¤Ÿå®¹å¿ä¸€äº›æ¶ˆæ¯çš„ä¸¢å¤±ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¼‚æ­¥å‘é€ã€‚å¼‚æ­¥å‘é€ä¸ä¼šåœ¨å—åˆ°brokerçš„ç¡®è®¤ä¹‹å‰ä¸€ç›´é˜»å¡ Producer.sendæ–¹æ³•ã€‚</p>
<p>æƒ³è¦ä½¿ç”¨å¼‚æ­¥ï¼Œåœ¨brokerURLä¸­å¢åŠ  jms.alwaysSyncSend=false&amp;jms.useAsyncSend=trueå±æ€§(1ï¼‰å¦‚æœè®¾ç½®äº†alwaysSyncSend=trueç³»ç»Ÿå°†ä¼šå¿½ç•¥useAsyncSendè®¾ç½®çš„å€¼éƒ½é‡‡ç”¨åŒæ­¥ 2ï¼‰å½“alwaysSyncSend=falseæ—¶ï¼Œâ€œNON_PERSISTENTâ€(éæŒä¹…åŒ–)ã€äº‹åŠ¡ä¸­çš„æ¶ˆæ¯å°†ä½¿ç”¨â€œå¼‚æ­¥å‘é€â€ 3ï¼‰å½“alwaysSyncSend=falseæ—¶ï¼Œå¦‚æœæŒ‡å®šäº†useAsyncSend=trueï¼Œâ€œPERSISTENTâ€ç±»å‹çš„æ¶ˆæ¯ä½¿ç”¨å¼‚æ­¥å‘é€ã€‚å¦‚æœuseAsyncSend=falseï¼Œâ€œPERSISTENTâ€ç±»å‹çš„æ¶ˆæ¯ä½¿ç”¨åŒæ­¥å‘é€ã€‚</p>
<p><strong>æ€»ç»“ï¼š é»˜è®¤æƒ…å†µ(alwaysSyncSend=false,useAsyncSend=false)ï¼ŒéæŒä¹…åŒ–æ¶ˆæ¯ã€äº‹åŠ¡å†…çš„æ¶ˆæ¯å‡é‡‡ç”¨</strong><br><strong>å¼‚æ­¥å‘é€ï¼›å¯¹äºæŒä¹…åŒ–æ¶ˆæ¯é‡‡ç”¨åŒæ­¥å‘é€ï¼ï¼ï¼</strong></p>
<p><strong>2ã€é…ç½®å¼‚æ­¥æŠ•é€’çš„æ–¹å¼</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>åœ¨è¿æ¥ä¸Šé…ç½®</span><br><span class="line"><span class="keyword">new</span> ActiveMQConnectionFactory(<span class="string">&quot;tcp://locahost:61616?jms.useAsyncSend=true&quot;</span>);</span><br><span class="line"><span class="number">2.</span>é€šè¿‡ConnectionFactory</span><br><span class="line">((ActiveMQConnectionFactory)connectionFactory).setUseAsyncSend(<span class="keyword">true</span>);</span><br><span class="line"><span class="number">3.</span>é€šè¿‡connection</span><br><span class="line">((ActiveMQConnection)connection).setUseAsyncSend(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>



<p><strong>æ³¨æ„ï¼šå¦‚æœæ˜¯Springæˆ–SpringBooté¡¹ç›®ï¼Œé€šè¿‡ä¿®æ”¹JmsTemplateçš„é»˜è®¤å‚æ•°å®ç°å¼‚æ­¥æˆ–åŒæ­¥æŠ•é€’</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActiveConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * é…ç½®ç”¨äºå¼‚æ­¥å‘é€çš„éæŒä¹…åŒ–JmsTemplate</span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="meta">@Bean</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> JmsTemplate <span class="title">asynJmsTemplate</span><span class="params">(PooledConnectionFactory</span></span></span><br><span class="line"><span class="function"><span class="params">pooledConnectionFactory)</span> </span>&#123;</span><br><span class="line">Â Â Â Â JmsTemplate template = <span class="keyword">new</span> JmsTemplate(pooledConnectionFactory);</span><br><span class="line">Â Â Â Â template.setExplicitQosEnabled(<span class="keyword">true</span>);</span><br><span class="line">Â Â Â Â template.setDeliveryMode(DeliveryMode.NON_PERSISTENT);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> template;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * é…ç½®ç”¨äºåŒæ­¥å‘é€çš„æŒä¹…åŒ–JmsTemplate</span></span><br><span class="line"><span class="comment">Â Â */</span> </span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="meta">@Bean</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> JmsTemplate <span class="title">synJmsTemplate</span><span class="params">(PooledConnectionFactory</span></span></span><br><span class="line"><span class="function"><span class="params">pooledConnectionFactory)</span> </span>&#123;</span><br><span class="line">Â Â Â Â JmsTemplate template = <span class="keyword">new</span> JmsTemplate(pooledConnectionFactory);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> template;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¼‚æ­¥æŠ•é€’å¦‚ä½•ç¡®è®¤å‘é€æˆåŠŸï¼Ÿ</strong><br>å¼‚æ­¥æŠ•é€’ä¸¢å¤±æ¶ˆæ¯çš„åœºæ™¯æ˜¯ï¼šç”Ÿäº§è€…è®¾ç½® UseAsyncSend=trueï¼Œä½¿ç”¨ producer.sendï¼ˆmsgï¼‰æŒç»­å‘é€æ¶ˆæ¯ã€‚</p>
<p>ç”±äºæ¶ˆæ¯ä¸é˜»å¡ï¼Œç”Ÿäº§è€…ä¼šè®¤ä¸ºæ‰€æœ‰ send çš„æ¶ˆæ¯å‡è¢«æˆåŠŸå‘é€è‡³ MQã€‚å¦‚æœ MQ çªç„¶å®•æœºï¼Œæ­¤æ—¶ç”Ÿäº§è€…ç«¯å†…å­˜ä¸­å°šæœªè¢«å‘é€è‡³ MQ çš„æ¶ˆæ¯éƒ½ä¼šä¸¢å¤±ã€‚è¿™æ—¶ï¼Œå¯ä»¥ç»™å¼‚æ­¥æŠ•é€’æ–¹æ³•æ¥æ”¶å›è°ƒï¼Œä»¥ç¡®è®¤æ¶ˆæ¯æ˜¯å¦å‘é€æˆåŠŸï¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å¼‚æ­¥æŠ•é€’ï¼Œå›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="meta">@RequestMapping(&quot;/send&quot;)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> String <span class="title">sendQueue</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â Connection connection = <span class="keyword">null</span>;</span><br><span class="line">Â Â Â Â Session session = <span class="keyword">null</span>;</span><br><span class="line">Â Â Â Â ActiveMQMessageProducer producer = <span class="keyword">null</span>;</span><br><span class="line">Â Â Â Â <span class="comment">// è·å–è¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory connectionFactory =jmsMessagingTemplate.getConnectionFactory();</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â connection = connectionFactory.createConnection();</span><br><span class="line">Â Â Â Â Â Â session = connection.createSession(<span class="keyword">true</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â Â Â Queue queue = session.createQueue(name);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">int</span> count = <span class="number">10</span>;</span><br><span class="line">Â Â Â Â Â Â producer = session.createProducer(queue);</span><br><span class="line">Â Â Â Â Â Â producer.setDeliveryMode(DeliveryMode.NON_PERSISTENT);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//åˆ›å»ºéœ€è¦å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â Â Â Â Â TextMessage textMessage = session.createTextMessage(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//è®¾ç½®æ¶ˆæ¯å”¯ä¸€ID</span></span><br><span class="line">Â Â Â Â Â Â Â Â String msgid = UUID.randomUUID().toString();</span><br><span class="line">Â Â Â Â Â Â Â Â textMessage.setJMSMessageID(msgid);</span><br><span class="line">Â Â Â Â Â Â Â Â producer.send(textMessage, <span class="keyword">new</span> AsyncCallback() &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">// ä½¿ç”¨msgidæ ‡è¯†æ¥è¿›è¡Œæ¶ˆæ¯å‘é€æˆåŠŸçš„å¤„ç†</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(msgid+<span class="string">&quot; æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="meta">@Override</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onException</span><span class="params">(JMSException exception)</span> </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">// ä½¿ç”¨msgidè¡¨ç¤ºè¿›è¡Œæ¶ˆæ¯å‘é€å¤±è´¥çš„å¤„ç†</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(msgid+<span class="string">&quot; æ¶ˆæ¯å‘é€å¤±è´¥&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â exception.printStackTrace();</span><br><span class="line">Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â &#125;);</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â session.commit();</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>



<p><strong>å»¶è¿ŸæŠ•é€’</strong><br>ç”Ÿäº§è€…æä¾›ä¸¤ä¸ªå‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯å³æ—¶å‘é€æ¶ˆæ¯ï¼Œä¸€ä¸ªæ˜¯å»¶æ—¶å‘é€æ¶ˆæ¯ã€‚<br><strong>1ã€ä¿®æ”¹activemq.xml</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">&lt;broker</span> <span class="string">xmlns=&quot;http://activemq.apache.org/schema/core&quot;</span> <span class="string">...</span></span><br><span class="line">Â <span class="string">schedulerSupport=&quot;true&quot;</span> <span class="string">&gt;</span></span><br><span class="line">Â <span class="string">......</span></span><br><span class="line"><span class="string">&lt;/broker&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼šæ·»åŠ  schedulerSupport=â€trueâ€é…ç½®</strong></p>
<p><strong>2ã€åœ¨ä»£ç ä¸­è®¾ç½®å»¶è¿Ÿæ—¶é•¿</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å»¶æ—¶æŠ•é€’</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â <span class="meta">@Test</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> String <span class="title">sendQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â Â Â Â Connection connection = <span class="keyword">null</span>;</span><br><span class="line">Â Â Â Â Session session = <span class="keyword">null</span>;</span><br><span class="line">Â Â Â Â ActiveMQMessageProducer producer = <span class="keyword">null</span>;</span><br><span class="line">Â Â Â Â <span class="comment">// è·å–è¿æ¥å·¥å‚</span></span><br><span class="line">Â Â Â Â ConnectionFactory connectionFactory =jmsMessagingTemplate.getConnectionFactory();</span><br><span class="line">Â Â Â Â <span class="keyword">try</span> &#123;</span><br><span class="line">Â Â Â Â Â Â connection = connectionFactory.createConnection();</span><br><span class="line">Â Â Â Â Â Â session = connection.createSession(<span class="keyword">true</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Â Â Â Â Â Â Queue queue = session.createQueue(name);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">int</span> count = <span class="number">10</span>;</span><br><span class="line">Â Â Â Â Â Â producer = (ActiveMQMessageProducer) session.createProducer(queue);</span><br><span class="line">Â Â Â Â Â Â producer.setDeliveryMode(DeliveryMode.NON_PERSISTENT);</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//åˆ›å»ºéœ€è¦å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line">Â Â Â Â Â Â TextMessage textMessage = session.createTextMessage(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â <span class="comment">//è®¾ç½®å»¶æ—¶æ—¶é•¿(å»¶æ—¶10ç§’)</span></span><br><span class="line">Â Â Â Â Â Â textMessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY,<span class="number">10000</span>);</span><br><span class="line">Â Â Â Â Â Â producer.send(textMessage);</span><br><span class="line">Â Â Â Â Â Â session.commit();</span><br><span class="line">Â Â Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â Â Â Â Â Â e.printStackTrace();</span><br><span class="line">Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure>



<p><strong>å®šæ—¶æŠ•é€’</strong></p>
<p>1ã€å¯åŠ¨ç±»æ·»åŠ å®šæ—¶æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableScheduling</span> <span class="comment">// å¼€å¯å®šæ—¶åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyActiveMQApplication</span> </span>&#123;</span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">Â Â Â Â SpringApplication.run(MyActiveMQApplication.class,args);</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€åœ¨ç”Ÿäº§è€…æ·»åŠ @Scheduledè®¾ç½®å®šæ—¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ¶ˆæ¯ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerController3</span> </span>&#123;</span><br><span class="line">Â Â <span class="meta">@Value(&quot;$&#123;activemq.name&#125;&quot;)</span></span><br><span class="line">Â Â <span class="keyword">private</span> String name;</span><br><span class="line">Â Â <span class="meta">@Autowired</span></span><br><span class="line">Â Â <span class="keyword">private</span> JmsMessagingTemplate jmsMessagingTemplate;</span><br><span class="line">Â Â <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â Â * å»¶æ—¶æŠ•é€’</span></span><br><span class="line"><span class="comment">Â Â *</span></span><br><span class="line"><span class="comment">Â Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â Â */</span></span><br><span class="line">Â Â <span class="comment">//æ¯éš”3ç§’å®šæŠ•</span></span><br><span class="line">Â Â <span class="meta">@Scheduled(fixedDelay = 3000)</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â Â Â Â jmsMessagingTemplate.convertAndSend(name, <span class="string">&quot;æ¶ˆæ¯ID:&quot;</span> +UUID.randomUUID().toString().substring(<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">Â Â Â Â System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ...&quot;</span>);</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ­»ä¿¡é˜Ÿåˆ—"><a href="#æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—"></a>æ­»ä¿¡é˜Ÿåˆ—</h3><p><strong>DLQ-Dead Letter Queueï¼Œæ­»ä¿¡é˜Ÿåˆ—ï¼Œç”¨æ¥ä¿å­˜å¤„ç†å¤±è´¥æˆ–è€…è¿‡æœŸçš„æ¶ˆæ¯</strong></p>
<blockquote>
<p>å‡ºç°ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œæ¶ˆæ¯ä¼šè¢«é‡å‘ï¼š<br>A transacted session is used and rollback() is called.<br>A transacted session is closed before commit is called.<br>A session is using CLIENT_ACKNOWLEDGE and Session.recover() is called.<br>å½“ä¸€ä¸ªæ¶ˆæ¯è¢«é‡å‘è¶…è¿‡6(ç¼ºçœä¸º6æ¬¡)æ¬¡æ•°æ—¶ï¼Œä¼šç»™brokerå‘é€ä¸€ä¸ªâ€Poison ackâ€ï¼Œè¿™ä¸ªæ¶ˆæ¯è¢«è®¤ä¸ºæ˜¯apoison pillï¼Œè¿™æ—¶brokerä¼šå°†è¿™ä¸ªæ¶ˆæ¯å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼Œä»¥ä¾¿åç»­å¤„ç†ã€‚<br>æ³¨æ„ä¸¤ç‚¹ï¼š<br><strong>1ï¼‰ç¼ºçœæŒä¹…æ¶ˆæ¯è¿‡æœŸï¼Œä¼šè¢«é€åˆ°DLQï¼ŒéæŒä¹…æ¶ˆæ¯ä¸ä¼šé€åˆ°DLQ</strong><br><strong>2ï¼‰ç¼ºçœçš„æ­»ä¿¡é˜Ÿåˆ—æ˜¯ActiveMQ.DLQï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡å®šï¼Œæ­»ä¿¡éƒ½ä¼šè¢«å‘é€åˆ°è¿™ä¸ªé˜Ÿåˆ—ã€‚</strong><br>å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶(activemq.xml)æ¥è°ƒæ•´æ­»ä¿¡å‘é€ç­–ç•¥ã€‚</p>
</blockquote>
<p><strong>1ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„activemq.xml</strong></p>
<p><strong>ä¸ºæ¯ä¸ªé˜Ÿåˆ—å»ºç«‹ç‹¬ç«‹çš„æ­»ä¿¡é˜Ÿåˆ—</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">destinationPolicy</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;<span class="name">policyMap</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">policyEntries</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">policyEntry</span> <span class="attr">queue</span>=<span class="string">&quot;&gt;&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">deadLetterStrategy</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">individualDeadLetterStrategy</span> <span class="attr">queuePrefix</span>=<span class="string">&quot;DLQ.&quot;</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">useQueueForQueueMessages</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">deadLetterStrategy</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">policyEntry</span>&gt;</span></span><br><span class="line">Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">policyEntry</span> <span class="attr">topic</span>=<span class="string">&quot;&gt;&quot;</span> &gt;</span> Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">pendingMessageLimitStrategy</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">constantPendingMessageLimitStrategy</span> <span class="attr">limit</span>=<span class="string">&quot;1000&quot;</span>/&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">pendingMessageLimitStrategy</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">policyEntry</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">policyEntries</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">policyMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">destinationPolicy</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2ã€RedeliveryPolicyé‡å‘ç­–ç•¥è®¾ç½®</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActiveMqConfig</span> </span>&#123;</span><br><span class="line">Â Â <span class="comment">//RedeliveryPolicyé‡å‘ç­–ç•¥è®¾ç½®</span></span><br><span class="line">Â Â <span class="meta">@Bean</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> RedeliveryPolicy <span class="title">redeliveryPolicy</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â RedeliveryPolicy Â redeliveryPolicy= Â <span class="keyword">new</span> RedeliveryPolicy();</span><br><span class="line">Â Â Â Â <span class="comment">//æ˜¯å¦åœ¨æ¯æ¬¡å°è¯•é‡æ–°å‘é€å¤±è´¥å,å¢é•¿è¿™ä¸ªç­‰å¾…æ—¶é—´</span></span><br><span class="line">Â Â Â Â redeliveryPolicy.setUseExponentialBackOff(<span class="keyword">true</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//é‡å‘æ¬¡æ•°,é»˜è®¤ä¸º6æ¬¡ Â è¿™é‡Œè®¾ç½®ä¸º10æ¬¡</span></span><br><span class="line">Â Â Â Â redeliveryPolicy.setMaximumRedeliveries(<span class="number">10</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//é‡å‘æ—¶é—´é—´éš”,é»˜è®¤ä¸º1ç§’</span></span><br><span class="line">Â Â Â Â redeliveryPolicy.setInitialRedeliveryDelay(<span class="number">1</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//ç¬¬ä¸€æ¬¡å¤±è´¥åé‡æ–°å‘é€ä¹‹å‰ç­‰å¾…500æ¯«ç§’,ç¬¬äºŒæ¬¡å¤±è´¥å†ç­‰å¾…500 * 2æ¯«ç§’,è¿™é‡Œçš„2å°±æ˜¯value</span></span><br><span class="line">Â Â Â Â redeliveryPolicy.setBackOffMultiplier(<span class="number">2</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//æ˜¯å¦é¿å…æ¶ˆæ¯ç¢°æ’</span></span><br><span class="line">Â Â Â Â redeliveryPolicy.setUseCollisionAvoidance(<span class="keyword">false</span>);</span><br><span class="line">Â Â Â Â <span class="comment">//è®¾ç½®é‡å‘æœ€å¤§æ‹–å»¶æ—¶é—´-1 è¡¨ç¤ºæ²¡æœ‰æ‹–å»¶åªæœ‰UseExponentialBackOff(true)ä¸ºtrueæ—¶ç”Ÿ</span></span><br><span class="line">æ•ˆ</span><br><span class="line">Â Â Â Â redeliveryPolicy.setMaximumRedeliveryDelay(-<span class="number">1</span>);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> redeliveryPolicy;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="meta">@Bean</span></span><br><span class="line">Â Â <span class="keyword">public</span> ActiveMQConnectionFactory activeMQConnectionFactory</span><br><span class="line">(<span class="meta">@Value(&quot;$&#123;spring.activemq.broker-url&#125;&quot;)</span>String url,RedeliveryPolicy</span><br><span class="line">redeliveryPolicy)&#123;</span><br><span class="line">Â Â Â Â ActiveMQConnectionFactory activeMQConnectionFactory =</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">new</span> ActiveMQConnectionFactory(</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â url);</span><br><span class="line">Â Â Â Â activeMQConnectionFactory.setRedeliveryPolicy(redeliveryPolicy);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> activeMQConnectionFactory;</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="meta">@Bean</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">transactionManager</span><span class="params">(ConnectionFactory</span></span></span><br><span class="line"><span class="function"><span class="params">connectionFactory)</span> </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> <span class="keyword">new</span> JmsTransactionManager(connectionFactory);</span><br><span class="line">Â &#125;</span><br><span class="line">Â Â <span class="meta">@Bean(name=&quot;jmsQueryListenerFactory&quot;)</span></span><br><span class="line">Â Â <span class="keyword">public</span> DefaultJmsListenerContainerFactory </span><br><span class="line">jmsListenerContainerFactory(ConnectionFactory</span><br><span class="line">connectionFactory,PlatformTransactionManager transactionManager)&#123;</span><br><span class="line">Â Â Â Â DefaultJmsListenerContainerFactory Â factory=<span class="keyword">new</span></span><br><span class="line">DefaultJmsListenerContainerFactory ();</span><br><span class="line">Â Â Â Â factory.setTransactionManager(transactionManager);</span><br><span class="line">Â Â Â Â factory.setConnectionFactory(connectionFactory);</span><br><span class="line">Â Â Â Â factory.setSessionTransacted(<span class="keyword">true</span>); <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">Â Â Â Â factory.setSessionAcknowledgeMode(<span class="number">1</span>);</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> factory;</span><br><span class="line">Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="7-ActiveMQä¼ä¸šé¢è¯•ç»å…¸é—®é¢˜"><a href="#7-ActiveMQä¼ä¸šé¢è¯•ç»å…¸é—®é¢˜" class="headerlink" title="7.ActiveMQä¼ä¸šé¢è¯•ç»å…¸é—®é¢˜"></a>7.ActiveMQä¼ä¸šé¢è¯•ç»å…¸é—®é¢˜</h2><h3 id="é—®é¢˜ï¼šActiveMQå®•æœºäº†æ€ä¹ˆåŠï¼Ÿ"><a href="#é—®é¢˜ï¼šActiveMQå®•æœºäº†æ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šActiveMQå®•æœºäº†æ€ä¹ˆåŠï¼Ÿ"></a>é—®é¢˜ï¼šActiveMQå®•æœºäº†æ€ä¹ˆåŠï¼Ÿ</h3><p><strong>(1ï¼‰ActiveMQä¸»ä»é›†ç¾¤æ–¹æ¡ˆï¼šZookeeperé›†ç¾¤+ Replicated LevelDB + ActiveMQé›†ç¾¤</strong></p>
<p><strong>å®˜ç½‘<a href="http://activemq.apache.org/replicated-leveldb-store">http://activemq.apache.org/replicated-leveldb-store</a></strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/ActiveMQ%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/image-20210313200908657.png" alt="image-20210313200908657"></p>
<p><strong>(2ï¼‰é›†ç¾¤ä¿¡æ¯æ¦‚è§ˆ</strong></p>
<table>
<thead>
<tr>
<th>Zookeeper ç«¯å£</th>
<th>ActiveMQwebç«¯å£</th>
<th>ActiveMQåè®®ç«¯å£</th>
</tr>
</thead>
<tbody><tr>
<td>2181</td>
<td>8161</td>
<td>61616</td>
</tr>
<tr>
<td>2182</td>
<td>8162</td>
<td>61617</td>
</tr>
<tr>
<td>2183</td>
<td>8163</td>
<td>61618</td>
</tr>
</tbody></table>
<p><strong>(3ï¼‰å…ˆæ­å»ºZookeeperé›†ç¾¤</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">1ï¼‰ä¸Šä¼ zookeeper-3.4.6.tar.gzåˆ°linux</span><br><span class="line">2ï¼‰è§£å‹ï¼štar -xzf zookeeper-3.4.6.tar.gz</span><br><span class="line">3ï¼‰åˆ›å»ºæ ¹ç›®å½•ï¼š mkdir /root/zookeeper</span><br><span class="line">4ï¼‰åˆ›å»ºèŠ‚ç‚¹ç›®å½•åŠæ•°æ®ï¼Œæ—¥å¿—å­˜æ”¾ç›®å½•ï¼š</span><br><span class="line">mkdir -p zookeeper/218&#123;1,2,3&#125;/&#123;data,datalogs&#125;</span><br><span class="line">3ä¸ªèŠ‚ç‚¹çš„å­æ–‡ä»¶å¤¹ä¸ºï¼š2181,2182,2183</span><br><span class="line">5ï¼‰å¤åˆ¶Zookeeperåˆ°æ¯ä¸ªèŠ‚ç‚¹ç›®å½•ä¸‹</span><br><span class="line">cp -r zookeeper-3.4.6 zookeeper/2181</span><br><span class="line">cp -r zookeeper-3.4.6 zookeeper/2182</span><br><span class="line">cp -r zookeeper-3.4.6 zookeeper/2183</span><br><span class="line">6ï¼‰ç§»é™¤åŸå§‹ç›®å½•</span><br><span class="line">rm -rf zookeeper-3.4.14/</span><br><span class="line">7ï¼‰ä¿®æ”¹2181èŠ‚ç‚¹çš„zoo.cfg</span><br><span class="line">cd zookeeper/2181/zookeeper-3.4.6/conf/</span><br><span class="line">cp zoo_sample.cfg zoo.cfg</span><br><span class="line">vi zoo.cfg</span><br><span class="line">å†…å®¹å¦‚ä¸‹ï¼š</span><br><span class="line">clientPort=2181</span><br><span class="line">dataDir=/root/zookeeper/2181/data</span><br><span class="line">dataLogDir=/root/zookeeper/2181/datalogs</span><br><span class="line">server.1=192.168.66.133:2881:3881</span><br><span class="line">server.2=192.168.66.133:2882:3882</span><br><span class="line">server.3=192.168.66.133:2883:3883</span><br><span class="line">8ï¼‰ç›¸åŒæ–¹å¼ä¿®æ”¹2182åŠ2183èŠ‚ç‚¹çš„zoo.cfg</span><br><span class="line">2182é…ç½®ä¸ºï¼š</span><br><span class="line">clientPort=2182</span><br><span class="line">dataDir=/root/zookeeper/2182/data</span><br><span class="line">dataLogDir=/root/zookeeper/2182/datalogs</span><br><span class="line">server.1=192.168.66.133:2881:3881</span><br><span class="line">server.2=192.168.66.133:2882:3882</span><br><span class="line">server.3=192.168.66.133:2883:3883</span><br><span class="line">2183é…ç½®ä¸ºï¼š</span><br><span class="line">clientPort=2183</span><br><span class="line">dataDir=/root/zookeeper/2183/data</span><br><span class="line">dataLogDir=/root/zookeeper/2183/datalogs</span><br><span class="line">server.1=192.168.66.133:2881:3881</span><br><span class="line">server.2=192.168.66.133:2882:3882</span><br><span class="line">server.3=192.168.66.133:2883:3883</span><br><span class="line"></span><br><span class="line">9ï¼‰æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»æœ‰myidé…ç½®æ–‡ä»¶ï¼Œè®°å½•èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ï¼Œå¿…é¡»æ”¾åœ¨dataDiræ–‡ä»¶å¤¹ä¸‹ã€‚è€Œä¸”idå€¼å¿…é¡»ä¸ä¸Šé¢</span><br><span class="line">é…ç½®çš„server.xä¸­çš„xå¯¹åº”</span><br><span class="line">touch 2181/data/myid &amp;&amp; echo &quot;1&quot; &gt; 2181/data/myid</span><br><span class="line">touch 2182/data/myid &amp;&amp; echo &quot;2&quot; &gt; 2182/data/myid</span><br><span class="line">touch 2183/data/myid &amp;&amp; echo &quot;3&quot; &gt; 2183/data/myid</span><br><span class="line">æŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸï¼š</span><br><span class="line">more 218*/data/myid</span><br><span class="line">10ï¼‰åˆ†åˆ«å¯åŠ¨ä¸‰å°Zookeeper</span><br><span class="line">å¯åŠ¨ï¼š</span><br><span class="line">cd 2181/ &amp;&amp; zookeeper-3.4.6/bin/zkServer.sh start</span><br><span class="line">cd 2182/ &amp;&amp; zookeeper-3.4.6/bin/zkServer.sh start</span><br><span class="line">cd 2183/ &amp;&amp; zookeeper-3.4.6/bin/zkServer.sh start</span><br><span class="line">æŸ¥çœ‹çŠ¶æ€ï¼š</span><br><span class="line">2181/zookeeper-3.4.6/bin/zkServer.sh status</span><br><span class="line">2182/zookeeper-3.4.6/bin/zkServer.sh status</span><br><span class="line">2183/zookeeper-3.4.6/bin/zkServer.sh status</span><br><span class="line">çœ‹åˆ°Mode: leaderçš„Zookeeperä¸ºä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–ä¸ºä»èŠ‚ç‚¹ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ4ï¼‰æ­å»ºActiveMQé›†ç¾¤</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">1ï¼‰ä¸Šä¼ apache-activemq-5.15.9-bin.tar.gzåˆ°linux</span><br><span class="line">2ï¼‰è§£å‹ï¼štar -xzf apache-activemq-5.15.9-bin.tar.gz</span><br><span class="line">3ï¼‰åˆ›å»ºä¸‰ä¸ªèŠ‚ç‚¹ç›®å½•</span><br><span class="line">    mkdir activemq</span><br><span class="line">    mkdir -p activemq/816&#123;1,2,3&#125;</span><br><span class="line">4ï¼‰å¤åˆ¶activemqåˆ°æ¯ä¸ªèŠ‚ç‚¹ç›®å½•</span><br><span class="line">    cp -r apache-activemq-5.15.9 activemq/8161</span><br><span class="line">    cp -r apache-activemq-5.15.9 activemq/8162</span><br><span class="line">    cp -r apache-activemq-5.15.9 activemq/8163</span><br><span class="line">5ï¼‰ä¿®æ”¹æ¯ä¸ªèŠ‚ç‚¹çš„activemq.xml</span><br><span class="line">    å¿…é¡»ä½¿ç”¨ç›¸åŒçš„é›†ç¾¤åç§°</span><br><span class="line">    &lt;broker xmlns=&quot;http://activemq.apache.org/schema/core&quot; brokerName=&quot;itheima_mq&quot;</span><br><span class="line">    dataDirectory=&quot;$&#123;activemq.data&#125;&quot;&gt;</span><br><span class="line">    æ·»åŠ é…ç½®ï¼š</span><br><span class="line">    61616ï¼š</span><br><span class="line">    &lt;persistenceAdapter&gt;</span><br><span class="line">    &lt;replicatedLevelDB</span><br><span class="line">    directory=&quot;$&#123;activemq.data&#125;/leveldb&quot;</span><br><span class="line">    replicas=&quot;3&quot;</span><br><span class="line">    bind=&quot;tcp://0.0.0.0:61616&quot;</span><br><span class="line">    zkAddress=&quot;192.168.66.133:2181,192.168.66.133:2182,192.168.66.133:2183&quot;</span><br><span class="line">    hostname=&quot;192.168.66.133&quot;</span><br><span class="line">    zkPath=&quot;/activemq/leveldb-stores&quot; /&gt;</span><br><span class="line">    &lt;/persistenceAdapter&gt;</span><br><span class="line">    61617ï¼š</span><br><span class="line">    &lt;persistenceAdapter&gt;</span><br><span class="line">    &lt;replicatedLevelDB</span><br><span class="line">    directory=&quot;$&#123;activemq.data&#125;/leveldb&quot;</span><br><span class="line">    replicas=&quot;3&quot;</span><br><span class="line">    bind=&quot;tcp://0.0.0.0:61617&quot;</span><br><span class="line">    zkAddress=&quot;192.168.66.133:2181,192.168.66.133:2182,192.168.66.133:2183&quot;</span><br><span class="line">    hostname=&quot;192.168.66.133&quot;</span><br><span class="line">    zkPath=&quot;/activemq/leveldb-stores&quot; /&gt;</span><br><span class="line">    &lt;/persistenceAdapter&gt;</span><br><span class="line">    61618ï¼š</span><br><span class="line">    &lt;persistenceAdapter&gt;</span><br><span class="line">    &lt;replicatedLevelDB</span><br><span class="line">    directory=&quot;$&#123;activemq.data&#125;/leveldb&quot;</span><br><span class="line">    replicas=&quot;3&quot;</span><br><span class="line">    bind=&quot;tcp://0.0.0.0:61618&quot;</span><br><span class="line">    zkAddress=&quot;192.168.66.133:2181,192.168.66.133:2182,192.168.66.133:2183&quot;</span><br><span class="line">    hostname=&quot;192.168.66.133&quot;</span><br><span class="line">    zkPath=&quot;/activemq/leveldb-stores&quot; /&gt;</span><br><span class="line">    &lt;/persistenceAdapter&gt;</span><br><span class="line">6ï¼‰ä¿®æ”¹jetty.xml</span><br><span class="line">    &lt;bean id=&quot;jettyPort&quot; class=&quot;org.apache.activemq.web.WebConsolePort&quot; init-</span><br><span class="line">    method=&quot;start&quot;&gt;</span><br><span class="line">          &lt;!-- the default port number for the web console --&gt;</span><br><span class="line">       &lt;property name=&quot;host&quot; value=&quot;0.0.0.0&quot;/&gt;</span><br><span class="line">       &lt;property name=&quot;port&quot; value=&quot;8161&quot;/&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    </span><br><span class="line">7ï¼‰åˆ†åˆ«ä¸º8181,8182,8183åˆ†åˆ«å¯åŠ¨æ¯å°activemqå¯ä»¥ä½¿ç”¨ZooInspectorå·¥å…·æŸ¥çœ‹ActiveMQæ˜¯å¦æ³¨å†ŒæˆåŠŸ</span><br></pre></td></tr></table></figure>

<p><strong>(5ï¼‰ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„broker-urléœ€è¦ä¿®æ”¹</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">9001</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">activemq:</span></span><br><span class="line">Â <span class="attr">broker-url: failover:</span></span><br><span class="line"><span class="string">(tcp://linuxip:61616,tcp://linuxip:61617,tcp://linuxip:616168)</span></span><br><span class="line">Â <span class="attr">user:</span> <span class="string">admin</span></span><br><span class="line">Â <span class="attr">password:</span> <span class="string">admin</span></span><br></pre></td></tr></table></figure>

<h3 id="é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆè´¹æ–¹æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ"><a href="#é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆè´¹æ–¹æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆè´¹æ–¹æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ"></a>é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆè´¹æ–¹æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ</h3><p><strong>è§£å†³æ¶ˆè´¹æ–¹å¹‚ç­‰æ€§é—®é¢˜ï¼</strong><br>å¦‚æœå› ä¸ºç½‘ç»œå»¶è¿Ÿç­‰åŸå› ï¼ŒMQæ— æ³•åŠæ—¶æ¥æ”¶åˆ°æ¶ˆè´¹æ–¹çš„åº”ç­”ï¼Œå¯¼è‡´MQé‡è¯•ã€‚åœ¨é‡è¯•è¿‡ç¨‹ä¸­é€ æˆé‡å¤æ¶ˆè´¹çš„é—®é¢˜ã€‚<br>è§£å†³æ€è·¯ï¼š</p>
<ul>
<li>å¦‚æœæ¶ˆè´¹æ–¹æ˜¯åšæ•°æ®åº“æ“ä½œï¼Œé‚£ä¹ˆå¯ä»¥æŠŠæ¶ˆæ¯çš„IDä½œä¸ºè¡¨çš„å”¯ä¸€ä¸»é”®ï¼Œè¿™æ ·åœ¨é‡è¯•çš„æƒ…<br>å†µä¸‹ï¼Œä¼šè§¦å‘ä¸»é”®å†²çªï¼Œä»è€Œé¿å…æ•°æ®å‡ºç°è„æ•°æ®ã€‚</li>
<li>å¦‚æœæ¶ˆè´¹æ–¹ä¸æ˜¯åšæ•°æ®åº“æ“ä½œï¼Œé‚£ä¹ˆå¯ä»¥å€ŸåŠ©ç¬¬ä¸‰æ–¹çš„åº”ç”¨ï¼Œä¾‹å¦‚Redisï¼Œæ¥è®°å½•æ¶ˆè´¹è®°å½•ã€‚æ¯æ¬¡æ¶ˆ<br>æ¯è¢«æ¶ˆè´¹å®Œæˆæ—¶å€™ï¼ŒæŠŠå½“å‰æ¶ˆæ¯çš„IDä½œä¸ºkeyå­˜å…¥redisï¼Œæ¯æ¬¡æ¶ˆè´¹å‰ï¼Œå…ˆåˆ°redisæŸ¥è¯¢æœ‰æ²¡æœ‰è¯¥æ¶ˆæ¯çš„æ¶ˆè´¹è®°å½•ã€‚</li>
</ul>
<h3 id="é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿ"><a href="#é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿ"></a>é—®é¢˜ï¼šå¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿ</h3><p>ä»¥ä¸‹æ‰‹æ®µå¯ä»¥é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼š<br>1ï¼‰åœ¨æ¶ˆæ¯ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä½¿ç”¨äº‹åŠ¡<br>2ï¼‰åœ¨æ¶ˆè´¹æ–¹é‡‡ç”¨æ‰‹åŠ¨æ¶ˆæ¯ç¡®è®¤ï¼ˆACKï¼‰<br>3ï¼‰æ¶ˆæ¯æŒä¹…åŒ–ï¼Œä¾‹å¦‚JDBCæˆ–æ—¥å¿—</p>
<p><strong>å­¦ä¹ åœ°å€<a href="https://www.bilibili.com/video/BV1vJ41177j1?p=1">https://www.bilibili.com/video/BV1vJ41177j1?p=1</a></strong></p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatiså­¦ä¹ ç¬”è®°</title>
    <url>/2021/02/25/MyBatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="MyBatiså­¦ä¹ ç¬”è®°"><a href="#MyBatiså­¦ä¹ ç¬”è®°" class="headerlink" title="MyBatiså­¦ä¹ ç¬”è®°"></a>MyBatiså­¦ä¹ ç¬”è®°</h1><h2 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h2><h3 id="1-1ã€ä»€ä¹ˆæ˜¯Mybatis"><a href="#1-1ã€ä»€ä¹ˆæ˜¯Mybatis" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯Mybatis"></a>1.1ã€ä»€ä¹ˆæ˜¯Mybatis</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310095243130.png" alt="image-20210310095243130"></p>
<ul>
<li>MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„<strong>æŒä¹…å±‚æ¡†æ¶</strong></li>
<li>å®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚</li>
<li>MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚</li>
<li>MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿç±»å‹ã€æ¥å£å’Œ Java çš„ POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä¸ºæ•°æ®åº“ä¸­çš„è®°å½•ã€‚</li>
<li>MyBatis æœ¬æ˜¯<a href="https://baike.baidu.com/item/apache/6265">apache</a>çš„ä¸€ä¸ªå¼€æºé¡¹ç›®<a href="https://baike.baidu.com/item/iBatis">iBatis</a>, 2010å¹´è¿™ä¸ªé¡¹ç›®ç”±apache software foundation è¿ç§»åˆ°äº†google codeï¼Œå¹¶ä¸”æ”¹åä¸ºMyBatis ã€‚</li>
<li>2013å¹´11æœˆè¿ç§»åˆ°Githubã€‚</li>
<li>å®˜ç½‘åœ°å€:<a href="https://mybatis.org/mybatis-3/">https://mybatis.org/mybatis-3/</a></li>
</ul>
<p>å¦‚ä½•è·å¾—Mybatisï¼Ÿ</p>
<ul>
<li><p>mavenä»“åº“ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>Github ï¼š <a href="https://github.com/mybatis/mybatis-3/releases">https://github.com/mybatis/mybatis-3/releases</a></p>
</li>
<li><p>ä¸­æ–‡æ–‡æ¡£ï¼š<a href="https://mybatis.org/mybatis-3/zh/index.html">https://mybatis.org/mybatis-3/zh/index.html</a></p>
</li>
</ul>
<h3 id="1-2ã€æŒä¹…åŒ–"><a href="#1-2ã€æŒä¹…åŒ–" class="headerlink" title="1.2ã€æŒä¹…åŒ–"></a>1.2ã€æŒä¹…åŒ–</h3><p>æ•°æ®æŒä¹…åŒ–</p>
<ul>
<li>æŒä¹…åŒ–å°±æ˜¯å°†ç¨‹åºçš„æ•°æ®åœ¨æŒä¹…çŠ¶æ€å’Œç¬æ—¶çŠ¶æ€è½¬åŒ–çš„è¿‡ç¨‹</li>
<li>å†…å­˜ï¼š<strong>æ–­ç”µå³å¤±</strong></li>
<li>æ•°æ®åº“(Jdbc)ï¼Œioæ–‡ä»¶æŒä¹…åŒ–</li>
<li>ç”Ÿæ´»ï¼šå†·è—. ç½å¤´</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦éœ€è¦æŒä¹…åŒ–ï¼Ÿ</strong></p>
<ul>
<li><p>æœ‰ä¸€äº›å¯¹è±¡ï¼Œä¸èƒ½è®©ä»–ä¸¢æ‰ã€‚</p>
</li>
<li><p>å†…å­˜å¤ªè´µäº†</p>
</li>
</ul>
<h3 id="1-3ã€æŒä¹…å±‚"><a href="#1-3ã€æŒä¹…å±‚" class="headerlink" title="1.3ã€æŒä¹…å±‚"></a>1.3ã€æŒä¹…å±‚</h3><p>Daoå±‚ï¼ŒServiceå±‚ï¼ŒControllerå±‚â€¦.</p>
<ul>
<li>å®ŒæˆæŒä¹…åŒ–å·¥ä½œçš„ä»£ç å—</li>
<li>å±‚ç•Œé™ååˆ†æ˜æ˜¾</li>
</ul>
<h3 id="1-4-ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ"><a href="#1-4-ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ" class="headerlink" title="1.4 ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ"></a>1.4 ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ</h3><ul>
<li>å¸®åŠ©ç¨‹åºçŒ¿å°†æ•°æ®å­˜å…¥åˆ°æ•°æ®åº“ä¸­ã€‚</li>
<li>æ–¹ä¾¿ä½¿ç”¨</li>
<li>ä¼ ç»Ÿçš„JDBCä»£ç å¤ªå¤æ‚äº†ã€‚ç®€åŒ–ã€‚æ¡†æ¶ã€‚è‡ªåŠ¨åŒ–ã€‚</li>
<li>ä¸ç”¨Mybatisä¹Ÿå¯ä»¥ã€‚æ›´å®¹æ˜“ä¸Šæ‰‹ã€‚ <strong>æŠ€æœ¯æ²¡æœ‰é«˜ä½ä¹‹åˆ†</strong></li>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>ç®€å•æ˜“å­¦</li>
<li>çµæ´»</li>
<li>sqlå’Œä»£ç çš„åˆ†ç¦»ï¼Œæé«˜äº†å¯ç»´æŠ¤æ€§</li>
<li>æä¾›æ˜ å°„æ ‡ç­¾ï¼Œæ”¯æŒå¯¹è±¡ä¸æ•°æ®åº“çš„ormå­—æ®µå…³ç³»æ˜ å°„</li>
<li>æä¾›å¯¹è±¡å…³ç³»æ˜ å°„æ ‡ç­¾ï¼Œæ”¯æŒå¯¹è±¡å…³ç³»ç»„å»ºç»´æŠ¤</li>
<li>æä¾›xmlæ ‡ç­¾ï¼Œæ”¯æŒç¼–å†™åŠ¨æ€sql</li>
</ul>
</li>
</ul>
<h2 id="2ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº"><a href="#2ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº" class="headerlink" title="2ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº"></a>2ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº</h2><p>æ€è·¯ï¼šæ­å»ºç¯å¢ƒâ€“&gt;å¯¼å…¥Mybatisâ€“&gt;ç¼–å†™ä»£ç â€“&gt;æµ‹è¯•ï¼</p>
<h3 id="2-1ã€æ­å»ºç¯å¢ƒ"><a href="#2-1ã€æ­å»ºç¯å¢ƒ" class="headerlink" title="2.1ã€æ­å»ºç¯å¢ƒ"></a>2.1ã€æ­å»ºç¯å¢ƒ</h3><p>æ­å»ºæ•°æ®åº“</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">CREATE DATABASE `mybatis`;</span><br><span class="line"></span><br><span class="line">USE `mybatis`;</span><br><span class="line"></span><br><span class="line">CREATE TABLE `user`(</span><br><span class="line">  `id` INT(<span class="number">20</span>) NOT NULL PRIMARY KEY,</span><br><span class="line">  `name` VARCHAR(<span class="number">30</span>) DEFAULT NULL,</span><br><span class="line">  `pwd` VARCHAR(<span class="number">30</span>) DEFAULT NULL</span><br><span class="line">)ENGINE=INNODB DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">INSERT INTO `user`(`id`,`name`,`pwd`) VALUES </span><br><span class="line">(<span class="number">1</span>,<span class="string">&#x27;åº·åº·&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;å¼ ä¸‰&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;æå››&#x27;</span>,<span class="string">&#x27;123890&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æ–°å»ºé¡¹ç›®</p>
<ol>
<li><p>æ–°å»ºä¸€ä¸ªæ™®é€šçš„mavené¡¹ç›®</p>
</li>
<li><p>åˆ é™¤srcç›®å½•</p>
</li>
<li><p>å¯¼å…¥mavenä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">   </span><br><span class="line"><span class="comment">&lt;!--å¯¼å…¥ä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--junit--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-2ã€åˆ›å»ºä¸€ä¸ªæ¨¡å—"><a href="#2-2ã€åˆ›å»ºä¸€ä¸ªæ¨¡å—" class="headerlink" title="2.2ã€åˆ›å»ºä¸€ä¸ªæ¨¡å—"></a>2.2ã€åˆ›å»ºä¸€ä¸ªæ¨¡å—</h3><ul>
<li><p>ç¼–å†™mybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--configurationæ ¸å¿ƒé…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;*****&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™mybatiså·¥å…·ç±»</p>
<p>æ¯ä¸ªåŸºäº MyBatis çš„åº”ç”¨éƒ½æ˜¯<strong>ä»¥ä¸€ä¸ª SqlSessionFactory çš„å®ä¾‹ä¸ºæ ¸å¿ƒ</strong>çš„ã€‚<strong>SqlSessionFactory çš„å®ä¾‹å¯ä»¥é€šè¿‡ SqlSessionFactoryBuilder è·å¾—</strong>ã€‚è€Œ SqlSessionFactoryBuilder åˆ™<strong>å¯ä»¥ä» XML é…ç½®æ–‡ä»¶æˆ–ä¸€ä¸ªé¢„å…ˆé…ç½®çš„ Configuration å®ä¾‹æ¥æ„å»ºå‡º SqlSessionFactory å®ä¾‹</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//sqlSessionFactory --&gt; sqlSession</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨Mybatisç¬¬ä¸€æ­¥ï¼šè·å–sqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">            String resource = <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ—¢ç„¶æœ‰äº† SqlSessionFactoryï¼Œé¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»ä¸­è·å¾— SqlSession çš„å®ä¾‹äº†ã€‚</span></span><br><span class="line">    <span class="comment">// SqlSession å®Œå…¨åŒ…å«äº†é¢å‘æ•°æ®åº“æ‰§è¡Œ SQL å‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession  <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-3ã€ç¼–å†™ä»£ç "><a href="#2-3ã€ç¼–å†™ä»£ç " class="headerlink" title="2.3ã€ç¼–å†™ä»£ç "></a>2.3ã€ç¼–å†™ä»£ç </h3><ul>
<li><p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.pojo;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ä½“ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> id, String name, String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPwd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPwd</span><span class="params">(String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, pwd=&#x27;&quot;</span> + pwd + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>Daoæ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>æ¥å£å®ç°ç±»ç”±åŸæ¥çš„UserDaoImplè½¬å˜ä¸ºä¸€ä¸ª Mapperé…ç½®æ–‡ä»¶.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line">        <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">                <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">                <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--namespace=ç»‘å®šä¸€ä¸ªå¯¹åº”çš„Dao/Mapperæ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.zhuang.dao.UserDao&quot;</span>&gt;</span> <span class="comment">&lt;!--å…¨é™å®šåç§°--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--selectæŸ¥è¯¢è¯­å¥--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">       select * from mybatis.user</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-4ã€æµ‹è¯•"><a href="#2-4ã€æµ‹è¯•" class="headerlink" title="2.4ã€æµ‹è¯•"></a>2.4ã€æµ‹è¯•</h3><p>æ³¨æ„ç‚¹ï¼š</p>
<p>org.apache.ibatis.binding.BindingException: Type interface com.kuang.dao.UserDao is not known to the MapperRegistry.</p>
<p><strong>MapperRegistryæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ mappers</p>
<ul>
<li><p>junitæµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥ï¼šè·å¾—SqlSessionå¯¹è±¡</span></span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ–¹å¼ä¸€ï¼šgetMapper</span></span><br><span class="line">    UserDao userDao = sqlSession.getMapper(UserDao.class);</span><br><span class="line">    List&lt;User&gt; userList = userDao.getUserList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­SqlSession</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>ä½ ä»¬å¯ä»¥èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼š</p>
<ol>
<li>é…ç½®æ–‡ä»¶æ²¡æœ‰æ³¨å†Œ</li>
<li>ç»‘å®šæ¥å£é”™è¯¯ã€‚</li>
<li>æ–¹æ³•åä¸å¯¹</li>
<li>è¿”å›ç±»å‹ä¸å¯¹</li>
<li>Mavenå¯¼å‡ºèµ„æºé—®é¢˜</li>
</ol>
<h2 id="3ã€CRUD"><a href="#3ã€CRUD" class="headerlink" title="3ã€CRUD"></a>3ã€CRUD</h2><h3 id="1ã€namespace"><a href="#1ã€namespace" class="headerlink" title="1ã€namespace"></a>1ã€namespace</h3><p>namespaceä¸­çš„åŒ…åè¦å’Œ Dao/mapper æ¥å£çš„åŒ…åä¸€è‡´ï¼</p>
<h3 id="2ã€select"><a href="#2ã€select" class="headerlink" title="2ã€select"></a>2ã€select</h3><p>é€‰æ‹©ï¼ŒæŸ¥è¯¢è¯­å¥;</p>
<ul>
<li>id : å°±æ˜¯å¯¹åº”çš„namespaceä¸­çš„æ–¹æ³•åï¼›</li>
<li>resultTypeï¼šSqlè¯­å¥æ‰§è¡Œçš„è¿”å›å€¼ï¼</li>
<li>parameterType ï¼š å‚æ•°ç±»å‹ï¼</li>
</ul>
<ol>
<li><p>ç¼–å†™æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line"><span class="function">User <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™å¯¹åº”çš„mapperä¸­çš„sqlè¯­å¥</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;select id=<span class="string">&quot;getUserById&quot;</span> parameterType=<span class="string">&quot;int&quot;</span> resultType=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span><br><span class="line">        select * from mybatis.user where id = #&#123;id&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">   </span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">   </span><br><span class="line">    User user = mapper.getUserById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">   </span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="3ã€Insert"><a href="#3ã€Insert" class="headerlink" title="3ã€Insert"></a>3ã€Insert</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¯¹è±¡ä¸­çš„å±æ€§ï¼Œå¯ä»¥ç›´æ¥å–å‡ºæ¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    insert into mybatis.user (id, name, pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4ã€update"><a href="#4ã€update" class="headerlink" title="4ã€update"></a>4ã€update</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    update mybatis.user set name=#&#123;name&#125;,pwd=#&#123;pwd&#125;  where id = #&#123;id&#125; ;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5ã€Delete"><a href="#5ã€Delete" class="headerlink" title="5ã€Delete"></a>5ã€Delete</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    delete from mybatis.user where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>å¢åˆ æ”¹éœ€è¦æäº¤äº‹åŠ¡ï¼</li>
</ul>
<h3 id="6ã€åˆ†æé”™è¯¯"><a href="#6ã€åˆ†æé”™è¯¯" class="headerlink" title="6ã€åˆ†æé”™è¯¯"></a>6ã€åˆ†æé”™è¯¯</h3><ul>
<li>æ ‡ç­¾ä¸è¦åŒ¹é…é”™</li>
<li>resource ç»‘å®šmapperï¼Œéœ€è¦ä½¿ç”¨è·¯å¾„ï¼</li>
<li>ç¨‹åºé…ç½®æ–‡ä»¶å¿…é¡»ç¬¦åˆè§„èŒƒï¼</li>
<li>NullPointerExceptionï¼Œæ²¡æœ‰æ³¨å†Œåˆ°èµ„æº!</li>
<li>è¾“å‡ºçš„xmlæ–‡ä»¶ä¸­å­˜åœ¨ä¸­æ–‡ä¹±ç é—®é¢˜ï¼</li>
<li>mavenèµ„æºæ²¡æœ‰å¯¼å‡ºé—®é¢˜ï¼</li>
</ul>
<h3 id="7ã€ä¸‡èƒ½Map"><a href="#7ã€ä¸‡èƒ½Map" class="headerlink" title="7ã€ä¸‡èƒ½Map"></a>7ã€ä¸‡èƒ½Map</h3><p>å‡è®¾ï¼Œæˆ‘ä»¬çš„å®ä½“ç±»ï¼Œæˆ–è€…æ•°æ®åº“ä¸­çš„è¡¨ï¼Œå­—æ®µæˆ–è€…å‚æ•°è¿‡å¤šï¼Œæˆ‘ä»¬åº”å½“è€ƒè™‘ä½¿ç”¨Mapï¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¸‡èƒ½çš„Map</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addUser2</span><span class="params">(Map&lt;String,Object&gt; map)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¯¹è±¡ä¸­çš„å±æ€§ï¼Œå¯ä»¥ç›´æ¥å–å‡ºæ¥    ä¼ é€’mapçš„key--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">       insert into mybatis.user (id, pwd) values (#&#123;userid&#125;,#&#123;passWord&#125;);</span><br><span class="line">   <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void addUser2()&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();</span><br><span class="line"></span><br><span class="line">    map.put(&quot;userid&quot;,5);</span><br><span class="line">    map.put(&quot;passWord&quot;,&quot;2222333&quot;);</span><br><span class="line"></span><br><span class="line">    mapper.addUser2(map);</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>Mapä¼ é€’å‚æ•°ï¼Œç›´æ¥åœ¨sqlä¸­å–å‡ºkeyå³å¯ï¼    ã€parameterType=â€mapâ€ã€‘</p>
<p>å¯¹è±¡ä¼ é€’å‚æ•°ï¼Œç›´æ¥åœ¨sqlä¸­å–å¯¹è±¡çš„å±æ€§å³å¯ï¼ã€parameterType=â€Objectâ€ã€‘</p>
<p>åªæœ‰ä¸€ä¸ªåŸºæœ¬ç±»å‹å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥åœ¨sqlä¸­å–åˆ°ï¼</p>
<p>å¤šä¸ªå‚æ•°ç”¨Mapï¼Œ<strong>æˆ–è€…æ³¨è§£ï¼</strong></p>
<h3 id="8ã€æ€è€ƒé¢˜"><a href="#8ã€æ€è€ƒé¢˜" class="headerlink" title="8ã€æ€è€ƒé¢˜"></a>8ã€æ€è€ƒé¢˜</h3><p>æ¨¡ç³ŠæŸ¥è¯¢æ€ä¹ˆå†™ï¼Ÿ</p>
<ol>
<li><p>Javaä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼ é€’é€šé…ç¬¦ % %</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;User&gt; userList = mapper.getUserLike(<span class="string">&quot;%æ%&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨sqlæ‹¼æ¥ä¸­ä½¿ç”¨é€šé…ç¬¦ï¼</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">select * from mybatis.user where name like &quot;%&quot;#&#123;value&#125;&quot;%&quot;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="4ã€é…ç½®è§£æ"><a href="#4ã€é…ç½®è§£æ" class="headerlink" title="4ã€é…ç½®è§£æ"></a>4ã€é…ç½®è§£æ</h2><h3 id="1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶</h3><ul>
<li><p>mybatis-config.xml</p>
</li>
<li><p>MyBatis çš„é…ç½®æ–‡ä»¶åŒ…å«äº†ä¼šæ·±æ·±å½±å“ MyBatis è¡Œä¸ºçš„è®¾ç½®å’Œå±æ€§ä¿¡æ¯ã€‚ </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">configurationï¼ˆé…ç½®ï¼‰</span><br><span class="line">propertiesï¼ˆå±æ€§ï¼‰</span><br><span class="line">settingsï¼ˆè®¾ç½®ï¼‰</span><br><span class="line">typeAliasesï¼ˆç±»å‹åˆ«åï¼‰</span><br><span class="line">typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</span><br><span class="line">objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</span><br><span class="line">pluginsï¼ˆæ’ä»¶ï¼‰</span><br><span class="line">environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰</span><br><span class="line">environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰</span><br><span class="line">transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</span><br><span class="line">dataSourceï¼ˆæ•°æ®æºï¼‰</span><br><span class="line">databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰</span><br><span class="line">mappersï¼ˆæ˜ å°„å™¨ï¼‰</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"><a href="#2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰" class="headerlink" title="2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"></a>2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰</h3><p>MyBatis å¯ä»¥é…ç½®æˆé€‚åº”å¤šç§ç¯å¢ƒ</p>
<p><strong>ä¸è¿‡è¦è®°ä½ï¼šå°½ç®¡å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œä½†æ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒã€‚</strong></p>
<p>å­¦ä¼šä½¿ç”¨é…ç½®å¤šå¥—è¿è¡Œç¯å¢ƒï¼</p>
<p>Mybatisé»˜è®¤çš„äº‹åŠ¡ç®¡ç†å™¨å°±æ˜¯ JDBC  ï¼Œ è¿æ¥æ±  ï¼š POOLED</p>
<h3 id="3ã€å±æ€§ï¼ˆpropertiesï¼‰"><a href="#3ã€å±æ€§ï¼ˆpropertiesï¼‰" class="headerlink" title="3ã€å±æ€§ï¼ˆpropertiesï¼‰"></a>3ã€å±æ€§ï¼ˆpropertiesï¼‰</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡propertieså±æ€§æ¥å®ç°å¼•ç”¨é…ç½®æ–‡ä»¶</p>
<p>è¿™äº›å±æ€§éƒ½æ˜¯å¯å¤–éƒ¨é…ç½®ä¸”å¯åŠ¨æ€æ›¿æ¢çš„ï¼Œæ—¢å¯ä»¥åœ¨å…¸å‹çš„ Java å±æ€§æ–‡ä»¶ä¸­é…ç½®ï¼Œäº¦å¯é€šè¿‡ properties å…ƒç´ çš„å­å…ƒç´ æ¥ä¼ é€’ã€‚ã€db.propertiesã€‘</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310100831414.png" alt="image-20210310100831414"></p>
<p>ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶</p>
<p>db.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ˜ å…¥</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼•å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">value</span>=<span class="string">&quot;11111&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¯ä»¥ç›´æ¥å¼•å…¥å¤–éƒ¨æ–‡ä»¶</li>
<li>å¯ä»¥åœ¨å…¶ä¸­å¢åŠ ä¸€äº›å±æ€§é…ç½®</li>
<li>å¦‚æœä¸¤ä¸ªæ–‡ä»¶æœ‰åŒä¸€ä¸ªå­—æ®µï¼Œä¼˜å…ˆä½¿ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶çš„ï¼</li>
</ul>
<h3 id="4ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"><a href="#4ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰" class="headerlink" title="4ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"></a>4ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰</h3><ul>
<li>ç±»å‹åˆ«åæ˜¯ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªçŸ­çš„åå­—ã€‚â€˜</li>
<li>å­˜åœ¨çš„æ„ä¹‰ä»…åœ¨äºç”¨æ¥å‡å°‘ç±»å®Œå…¨é™å®šåçš„å†—ä½™ã€‚</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¯ä»¥ç»™å®ä½“ç±»èµ·åˆ«å--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;User&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…åï¼ŒMyBatis ä¼šåœ¨åŒ…åä¸‹é¢æœç´¢éœ€è¦çš„ Java Beanï¼Œæ¯”å¦‚ï¼š</p>
<p>æ‰«æå®ä½“ç±»çš„åŒ…ï¼Œå®ƒçš„é»˜è®¤åˆ«åå°±ä¸ºè¿™ä¸ªç±»çš„ ç±»åï¼Œé¦–å­—æ¯å°å†™ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¯ä»¥ç»™å®ä½“ç±»èµ·åˆ«å--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.zhuang.pojo&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨å®ä½“ç±»æ¯”è¾ƒå°‘çš„æ—¶å€™ï¼Œä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ã€‚</p>
<p>å¦‚æœå®ä½“ç±»ååˆ†å¤šï¼Œå»ºè®®ä½¿ç”¨ç¬¬äºŒç§ã€‚</p>
<p>ç¬¬ä¸€ç§å¯ä»¥DIYåˆ«åï¼Œç¬¬äºŒç§åˆ™Â·ä¸è¡ŒÂ·ï¼Œå¦‚æœéè¦æ”¹ï¼Œéœ€è¦åœ¨å®ä½“ä¸Šå¢åŠ æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Alias(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5ã€è®¾ç½®"><a href="#5ã€è®¾ç½®" class="headerlink" title="5ã€è®¾ç½®"></a>5ã€è®¾ç½®</h3><p>è¿™æ˜¯ MyBatis ä¸­æä¸ºé‡è¦çš„è°ƒæ•´è®¾ç½®ï¼Œå®ƒä»¬ä¼šæ”¹å˜ MyBatis çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚ </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310100939648.png" alt="image-20210310100939648"></p>
<p>å®Œæ•´çš„settingsä¾‹å­</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;settings&gt;</span><br><span class="line"> <span class="comment">//å…¨å±€æ€§åœ°å¼€å¯æˆ–å…³é—­æ‰€æœ‰æ˜ å°„å™¨é…ç½®æ–‡ä»¶ä¸­å·²é…ç½®çš„ä»»ä½•ç¼“å­˜ã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;cacheEnabled&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//å»¶è¿ŸåŠ è½½çš„å…¨å±€å¼€å…³ã€‚å½“å¼€å¯æ—¶ï¼Œæ‰€æœ‰å…³è”å¯¹è±¡éƒ½ä¼šå»¶è¿ŸåŠ è½½ã€‚ ç‰¹å®šå…³è”å…³ç³»ä¸­å¯é€šè¿‡è®¾ç½® fetchType å±æ€§æ¥è¦†ç›–è¯¥é¡¹çš„å¼€å…³çŠ¶æ€ã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;lazyLoadingEnabled&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//å¼€å¯æ—¶ï¼Œä»»ä¸€æ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šåŠ è½½è¯¥å¯¹è±¡çš„æ‰€æœ‰å»¶è¿ŸåŠ è½½å±æ€§ã€‚ å¦åˆ™ï¼Œæ¯ä¸ªå»¶è¿ŸåŠ è½½å±æ€§ä¼šæŒ‰éœ€åŠ è½½   </span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;multipleResultSetsEnabled&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//ä½¿ç”¨åˆ—æ ‡ç­¾ä»£æ›¿åˆ—åã€‚å®é™…è¡¨ç°ä¾èµ–äºæ•°æ®åº“é©±åŠ¨</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;useColumnLabel&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//å…è®¸ JDBC æ”¯æŒè‡ªåŠ¨ç”Ÿæˆä¸»é”®ï¼Œéœ€è¦æ•°æ®åº“é©±åŠ¨æ”¯æŒã€‚å¦‚æœè®¾ç½®ä¸º trueï¼Œå°†å¼ºåˆ¶ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆä¸»é”®ã€‚   </span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;useGeneratedKeys&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//æŒ‡å®š MyBatis åº”å¦‚ä½•è‡ªåŠ¨æ˜ å°„åˆ—åˆ°å­—æ®µæˆ–å±æ€§ã€‚ NONE è¡¨ç¤ºå…³é—­è‡ªåŠ¨æ˜ å°„ï¼›PARTIAL åªä¼šè‡ªåŠ¨æ˜ å°„æ²¡æœ‰å®šä¹‰åµŒå¥—ç»“æœæ˜ å°„çš„å­—æ®µã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;autoMappingBehavior&quot;</span> value=<span class="string">&quot;PARTIAL&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//æŒ‡å®šå‘ç°è‡ªåŠ¨æ˜ å°„ç›®æ ‡æœªçŸ¥åˆ—ï¼ˆæˆ–æœªçŸ¥å±æ€§ç±»å‹ï¼‰çš„è¡Œä¸ºã€‚</span></span><br><span class="line">NONE: ä¸åšä»»ä½•ååº”</span><br><span class="line">WARNING: è¾“å‡ºè­¦å‘Šæ—¥å¿—ï¼ˆ<span class="string">&#x27;org.apache.ibatis.session.AutoMappingUnknownColumnBehavior&#x27;</span> çš„æ—¥å¿—ç­‰çº§å¿…é¡»è®¾ç½®ä¸º WARNï¼‰</span><br><span class="line">FAILING: æ˜ å°„å¤±è´¥ (æŠ›å‡º SqlSessionException)   </span><br><span class="line">  &lt;setting name=<span class="string">&quot;autoMappingUnknownColumnBehavior&quot;</span> value=<span class="string">&quot;WARNING&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//é…ç½®é»˜è®¤çš„æ‰§è¡Œå™¨ã€‚SIMPLE å°±æ˜¯æ™®é€šçš„æ‰§è¡Œå™¨ï¼›REUSE æ‰§è¡Œå™¨ä¼šé‡ç”¨é¢„å¤„ç†è¯­å¥ï¼ˆPreparedStatementï¼‰ï¼› BATCH æ‰§è¡Œå™¨ä¸ä»…é‡ç”¨è¯­å¥è¿˜ä¼šæ‰§è¡Œæ‰¹é‡æ›´æ–°ã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;defaultExecutorType&quot;</span> value=<span class="string">&quot;SIMPLE&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå®ƒå†³å®šæ•°æ®åº“é©±åŠ¨ç­‰å¾…æ•°æ®åº“å“åº”çš„ç§’æ•°ã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;defaultStatementTimeout&quot;</span> value=<span class="string">&quot;25&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//ä¸ºé©±åŠ¨çš„ç»“æœé›†è·å–æ•°é‡ï¼ˆfetchSizeï¼‰è®¾ç½®ä¸€ä¸ªå»ºè®®å€¼ã€‚  </span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;defaultFetchSize&quot;</span> value=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//æŒ‡å®šè¯­å¥é»˜è®¤çš„æ»šåŠ¨ç­–ç•¥</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;safeRowBoundsEnabled&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//æ˜¯å¦å¼€å¯é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„ã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//MyBatis åˆ©ç”¨æœ¬åœ°ç¼“å­˜æœºåˆ¶ï¼ˆLocal Cacheï¼‰é˜²æ­¢å¾ªç¯å¼•ç”¨å’ŒåŠ é€Ÿé‡å¤çš„åµŒå¥—æŸ¥è¯¢ã€‚ é»˜è®¤å€¼ä¸º SESSIONï¼Œä¼šç¼“å­˜ä¸€ä¸ªä¼šè¯ä¸­æ‰§è¡Œçš„æ‰€æœ‰æŸ¥è¯¢ã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;localCacheScope&quot;</span> value=<span class="string">&quot;SESSION&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//å½“æ²¡æœ‰ä¸ºå‚æ•°æŒ‡å®šç‰¹å®šçš„ JDBC ç±»å‹æ—¶ï¼Œç©ºå€¼çš„é»˜è®¤ JDBC ç±»å‹ã€‚ æŸäº›æ•°æ®åº“é©±åŠ¨éœ€è¦æŒ‡å®šåˆ—çš„ JDBC ç±»å‹</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;jdbcTypeForNull&quot;</span> value=<span class="string">&quot;OTHER&quot;</span>/&gt;</span><br><span class="line"> <span class="comment">//æŒ‡å®šå¯¹è±¡çš„å“ªäº›æ–¹æ³•è§¦å‘ä¸€æ¬¡å»¶è¿ŸåŠ è½½ã€‚</span></span><br><span class="line">  &lt;setting name=<span class="string">&quot;lazyLoadTriggerMethods&quot;</span> value=<span class="string">&quot;equals,clone,hashCode,toString&quot;</span>/&gt;</span><br><span class="line">&lt;/settings&gt;</span><br></pre></td></tr></table></figure>
<h3 id="6ã€ç±»å‹å¤„ç†å™¨ï¼ˆtypeHandlersï¼‰"><a href="#6ã€ç±»å‹å¤„ç†å™¨ï¼ˆtypeHandlersï¼‰" class="headerlink" title="6ã€ç±»å‹å¤„ç†å™¨ï¼ˆtypeHandlersï¼‰"></a>6ã€ç±»å‹å¤„ç†å™¨ï¼ˆtypeHandlersï¼‰</h3><p>MyBatis åœ¨è®¾ç½®é¢„å¤„ç†è¯­å¥ï¼ˆPreparedStatementï¼‰ä¸­çš„å‚æ•°æˆ–ä»ç»“æœé›†ä¸­å–å‡ºä¸€ä¸ªå€¼æ—¶ï¼Œ éƒ½ä¼šç”¨ç±»å‹å¤„ç†å™¨å°†è·å–åˆ°çš„å€¼ä»¥åˆé€‚çš„æ–¹å¼è½¬æ¢æˆ Java ç±»å‹ã€‚ä¸‹è¡¨æè¿°äº†ä¸€äº›é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310103335225.png" alt="image-20210310103335225"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310103507100.png" alt="image-20210310103507100"></p>
<p>é€šè¿‡ç±»å‹å¤„ç†å™¨çš„æ³›å‹ï¼ŒMyBatis å¯ä»¥å¾—çŸ¥è¯¥ç±»å‹å¤„ç†å™¨å¤„ç†çš„ Java ç±»å‹ï¼Œä¸è¿‡è¿™ç§è¡Œä¸ºå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹æ³•æ”¹å˜ï¼š</p>
<ul>
<li>åœ¨ç±»å‹å¤„ç†å™¨çš„é…ç½®å…ƒç´ ï¼ˆtypeHandler å…ƒç´ ï¼‰ä¸Šå¢åŠ ä¸€ä¸ª <code>javaType</code> å±æ€§ï¼ˆæ¯”å¦‚ï¼š<code>javaType=&quot;String&quot;</code>ï¼‰ï¼›</li>
<li>åœ¨ç±»å‹å¤„ç†å™¨çš„ç±»ä¸Šå¢åŠ ä¸€ä¸ª <code>@MappedTypes</code> æ³¨è§£æŒ‡å®šä¸å…¶å…³è”çš„ Java ç±»å‹åˆ—è¡¨ã€‚ å¦‚æœåœ¨ <code>javaType</code> å±æ€§ä¸­ä¹ŸåŒæ—¶æŒ‡å®šï¼Œåˆ™æ³¨è§£ä¸Šçš„é…ç½®å°†è¢«å¿½ç•¥ã€‚</li>
</ul>
<p>é€šè¿‡ä¸¤ç§æ–¹å¼æ¥æŒ‡å®šå…³è”çš„ JDBC ç±»å‹ï¼š</p>
<ul>
<li><p>åœ¨ç±»å‹å¤„ç†å™¨çš„é…ç½®å…ƒç´ ä¸Šå¢åŠ ä¸€ä¸ª <code>jdbcType</code> å±æ€§ï¼ˆæ¯”å¦‚ï¼š<code>jdbcType=&quot;VARCHAR&quot;</code>ï¼‰ï¼›</p>
</li>
<li><p>åœ¨ç±»å‹å¤„ç†å™¨çš„ç±»ä¸Šå¢åŠ ä¸€ä¸ª <code>@MappedJdbcTypes</code> æ³¨è§£æŒ‡å®šä¸å…¶å…³è”çš„ JDBC ç±»å‹åˆ—è¡¨ã€‚</p>
</li>
<li><p>pluginsæ’ä»¶</p>
<ul>
<li>mybatis-generator-core</li>
<li>mybatis-plus</li>
<li>é€šç”¨mapper</li>
</ul>
</li>
</ul>
<h3 id="7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰"><a href="#7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰" class="headerlink" title="7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰"></a>7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰</h3><p>MapperRegistryï¼šæ³¨å†Œç»‘å®šæˆ‘ä»¬çš„Mapperæ–‡ä»¶ï¼›</p>
<p>æ–¹å¼ä¸€ï¼š ã€æ¨èä½¿ç”¨ã€‘</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ¯ä¸€ä¸ªMapper.XMLéƒ½éœ€è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œï¼--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/zhuang/dao/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ–¹å¼äºŒï¼šä½¿ç”¨classæ–‡ä»¶ç»‘å®šæ³¨å†Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ¯ä¸€ä¸ªMapper.XMLéƒ½éœ€è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œï¼--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.dao.UserMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åŒåï¼</li>
<li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼</li>
</ul>
<p>æ–¹å¼ä¸‰ï¼šä½¿ç”¨æ‰«æåŒ…è¿›è¡Œæ³¨å…¥ç»‘å®š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ¯ä¸€ä¸ªMapper.XMLéƒ½éœ€è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œï¼--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.zhuang.dao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åŒåï¼</li>
<li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼</li>
</ul>
<p>ç»ƒä¹ æ—¶é—´ï¼š</p>
<ul>
<li>å°†æ•°æ®åº“é…ç½®æ–‡ä»¶å¤–éƒ¨å¼•å…¥</li>
<li>å®ä½“ç±»åˆ«å</li>
<li>ä¿è¯UserMapper æ¥å£ å’Œ UserMapper .xml æ”¹ä¸ºä¸€è‡´ï¼å¹¶ä¸”æ”¾åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼</li>
</ul>
<h3 id="8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"><a href="#8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ" class="headerlink" title="8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"></a>8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310101054058.png" alt="image-20210310101054058"></p>
<p>ç”Ÿå‘½å‘¨æœŸï¼Œå’Œä½œç”¨åŸŸï¼Œæ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„<strong>å¹¶å‘é—®é¢˜</strong>ã€‚</p>
<p><strong>SqlSessionFactoryBuilderï¼š</strong></p>
<ul>
<li>ä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†</li>
<li>å±€éƒ¨å˜é‡</li>
</ul>
<p><strong>SqlSessionFactoryï¼š</strong></p>
<ul>
<li>è¯´ç™½äº†å°±æ˜¯å¯ä»¥æƒ³è±¡ä¸º ï¼šæ•°æ®åº“è¿æ¥æ± </li>
<li>SqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œ<strong>æ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ã€‚</strong> </li>
<li>å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚ </li>
<li>æœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨<strong>å•ä¾‹æ¨¡å¼</strong>æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚</li>
</ul>
<p><strong>SqlSession</strong></p>
<ul>
<li>è¿æ¥åˆ°è¿æ¥æ± çš„ä¸€ä¸ªè¯·æ±‚ï¼</li>
<li>SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚</li>
<li>ç”¨å®Œä¹‹åéœ€è¦èµ¶ç´§å…³é—­ï¼Œå¦åˆ™èµ„æºè¢«å ç”¨ï¼</li>
</ul>
<p>!<img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310101129258.png" alt="image-20210310101129258"></p>
<p>è¿™é‡Œé¢çš„æ¯ä¸€ä¸ªMapperï¼Œå°±ä»£è¡¨ä¸€ä¸ªå…·ä½“çš„ä¸šåŠ¡ï¼</p>
<h2 id="5ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"><a href="#5ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜" class="headerlink" title="5ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"></a>5ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜</h2><h3 id="1ã€-é—®é¢˜"><a href="#1ã€-é—®é¢˜" class="headerlink" title="1ã€ é—®é¢˜"></a>1ã€ é—®é¢˜</h3><p>æ•°æ®åº“ä¸­çš„å­—æ®µ</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310101229939.png" alt="image-20210310101229939"></p>
<p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ‹·è´ä¹‹å‰çš„ï¼Œæµ‹è¯•å®ä½“ç±»å­—æ®µä¸ä¸€è‡´çš„æƒ…å†µ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•å‡ºç°é—®é¢˜</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">//    select * from mybatis.user where id = #&#123;id&#125;</span><br><span class="line">//ç±»å‹å¤„ç†å™¨</span><br><span class="line">//    select id,name,pwd from mybatis.user where id = #&#123;id&#125;</span><br></pre></td></tr></table></figure>

<p>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li><p>èµ·åˆ«å</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    select id,name,pwd as password from mybatis.user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2ã€resultMap"><a href="#2ã€resultMap" class="headerlink" title="2ã€resultMap"></a>2ã€resultMap</h3><p>ç»“æœé›†æ˜ å°„</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">id</span>   <span class="built_in">name</span>   pwd</span><br><span class="line"><span class="built_in">id</span>   <span class="built_in">name</span>   password</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç»“æœé›†æ˜ å°„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--columnæ•°æ®åº“ä¸­çš„å­—æ®µï¼Œpropertyå®ä½“ç±»ä¸­çš„å±æ€§--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">property</span>=<span class="string">&quot;password&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>resultMap</code> å…ƒç´ æ˜¯ MyBatis ä¸­æœ€é‡è¦æœ€å¼ºå¤§çš„å…ƒç´ </li>
<li>ResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œå¯¹äºç®€å•çš„è¯­å¥æ ¹æœ¬ä¸éœ€è¦é…ç½®æ˜¾å¼çš„ç»“æœæ˜ å°„ï¼Œè€Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥åªéœ€è¦æè¿°å®ƒä»¬çš„å…³ç³»å°±è¡Œäº†ã€‚</li>
<li><code>ResultMap</code> æœ€ä¼˜ç§€çš„åœ°æ–¹åœ¨äºï¼Œè™½ç„¶ä½ å·²ç»å¯¹å®ƒç›¸å½“äº†è§£äº†ï¼Œä½†æ˜¯æ ¹æœ¬å°±ä¸éœ€è¦æ˜¾å¼åœ°ç”¨åˆ°ä»–ä»¬ã€‚</li>
<li> å¦‚æœä¸–ç•Œæ€»æ˜¯è¿™ä¹ˆç®€å•å°±å¥½äº†ã€‚</li>
</ul>
<h2 id="6ã€æ—¥å¿—"><a href="#6ã€æ—¥å¿—" class="headerlink" title="6ã€æ—¥å¿—"></a>6ã€æ—¥å¿—</h2><h3 id="6-1ã€æ—¥å¿—å·¥å‚"><a href="#6-1ã€æ—¥å¿—å·¥å‚" class="headerlink" title="6.1ã€æ—¥å¿—å·¥å‚"></a>6.1ã€æ—¥å¿—å·¥å‚</h3><p>å¦‚æœä¸€ä¸ªæ•°æ®åº“æ“ä½œï¼Œå‡ºç°äº†å¼‚å¸¸ï¼Œæˆ‘ä»¬éœ€è¦æ’é”™ã€‚æ—¥å¿—å°±æ˜¯æœ€å¥½çš„åŠ©æ‰‹ï¼</p>
<p>æ›¾ç»ï¼šsout ã€debug</p>
<p>ç°åœ¨ï¼šæ—¥å¿—å·¥å‚ï¼</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310104324897.png" alt="image-20210310104324897"></p>
<ul>
<li><p>SLF4J </p>
</li>
<li><p>LOG4J  ã€æŒæ¡ã€‘</p>
</li>
<li><p>LOG4J2</p>
</li>
<li><p> JDK_LOGGING</p>
</li>
<li><p>COMMONS_LOGGING</p>
</li>
<li><p>STDOUT_LOGGING   ã€æŒæ¡ã€‘</p>
</li>
<li><p>NO_LOGGING</p>
</li>
</ul>
<p>åœ¨Mybatisä¸­å…·ä½“ä½¿ç”¨é‚£ä¸ªä¸€æ—¥å¿—å®ç°ï¼Œåœ¨è®¾ç½®ä¸­è®¾å®šï¼</p>
<p><strong>STDOUT_LOGGINGæ ‡å‡†æ—¥å¿—è¾“å‡º</strong></p>
<p>åœ¨mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®æˆ‘ä»¬çš„æ—¥å¿—ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310104408391.png" alt="image-20210310104408391"></p>
<p>ä¹Ÿå¯ä»¥ç”¨ä¸‹åˆ—çš„ä»»æ„ä¸€ä¸ª</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">org.apache.ibatis.logging.LogFactory.useSlf4jLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useLog4JLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useJdkLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useCommonsLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useStdOutLogging();</span><br></pre></td></tr></table></figure>



<h3 id="6-2ã€Log4j"><a href="#6-2ã€Log4j" class="headerlink" title="6.2ã€Log4j"></a>6.2ã€Log4j</h3><p>ä»€ä¹ˆæ˜¯Log4jï¼Ÿ</p>
<ul>
<li>Log4jæ˜¯<a href="https://baike.baidu.com/item/Apache/8512995">Apache</a>çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œé€šè¿‡ä½¿ç”¨Log4jï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“é€çš„ç›®çš„åœ°æ˜¯<a href="https://baike.baidu.com/item/%E6%8E%A7%E5%88%B6%E5%8F%B0/2438626">æ§åˆ¶å°</a>ã€æ–‡ä»¶ã€<a href="https://baike.baidu.com/item/GUI">GUI</a>ç»„ä»¶</li>
<li>æˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶æ¯ä¸€æ¡æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ï¼›</li>
<li>é€šè¿‡å®šä¹‰æ¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯çš„çº§åˆ«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç»†è‡´åœ°æ§åˆ¶æ—¥å¿—çš„ç”Ÿæˆè¿‡ç¨‹ã€‚</li>
<li>é€šè¿‡ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/286550">é…ç½®æ–‡ä»¶</a>æ¥çµæ´»åœ°è¿›è¡Œé…ç½®ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åº”ç”¨çš„ä»£ç ã€‚</li>
</ul>
<ol>
<li><p>å…ˆå¯¼å…¥log4jçš„åŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>log4j.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°†ç­‰çº§ä¸ºDEBUGçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°consoleå’Œfileè¿™ä¸¤ä¸ªç›®çš„åœ°ï¼Œconsoleå’Œfileçš„å®šä¹‰åœ¨ä¸‹é¢çš„ä»£ç </span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,console,file</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ§åˆ¶å°è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="meta">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.console.Target</span> = <span class="string">System.out</span></span><br><span class="line"><span class="meta">log4j.appender.console.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout.ConversionPattern</span>=<span class="string">[%c]-%m%n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ–‡ä»¶è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="meta">log4j.appender.file</span> = <span class="string">org.apache.log4j.RollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.file.File</span>=<span class="string">./log/kuang.log</span></span><br><span class="line"><span class="meta">log4j.appender.file.MaxFileSize</span>=<span class="string">10mb</span></span><br><span class="line"><span class="meta">log4j.appender.file.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">[%p][%d&#123;yy-MM-dd&#125;][%c]%m%n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ—¥å¿—è¾“å‡ºçº§åˆ«</span></span><br><span class="line"><span class="meta">log4j.logger.org.mybatis</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.Statement</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.ResultSet</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.PreparedStatement</span>=<span class="string">DEBUG</span></span><br></pre></td></tr></table></figure></li>
<li><p>é…ç½®log4jä¸ºæ—¥å¿—çš„å®ç°</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>Log4jçš„ä½¿ç”¨ï¼ï¼Œç›´æ¥æµ‹è¯•è¿è¡Œåˆšæ‰çš„æŸ¥è¯¢</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310104542421.png" alt="image-20210310104542421"></p>
</li>
</ol>
<p><strong>ç®€å•ä½¿ç”¨</strong></p>
<ol>
<li><p>åœ¨è¦ä½¿ç”¨Log4j çš„ç±»ä¸­ï¼Œå¯¼å…¥åŒ…  import org.apache.log4j.Logger;</p>
</li>
<li><p>æ—¥å¿—å¯¹è±¡ï¼Œå‚æ•°ä¸ºå½“å‰ç±»çš„class</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> Logger logger = Logger.getLogger(UserDaoTest.class);</span><br></pre></td></tr></table></figure></li>
<li><p>æ—¥å¿—çº§åˆ«</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">logger.info(<span class="string">&quot;info:è¿›å…¥äº†testLog4j&quot;</span>);</span><br><span class="line">logger.debug(<span class="string">&quot;debug:è¿›å…¥äº†testLog4j&quot;</span>);</span><br><span class="line">logger.error(<span class="string">&quot;error:è¿›å…¥äº†testLog4j&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="7ã€åˆ†é¡µ"><a href="#7ã€åˆ†é¡µ" class="headerlink" title="7ã€åˆ†é¡µ"></a>7ã€åˆ†é¡µ</h2><p><strong>æ€è€ƒï¼šä¸ºä»€ä¹ˆè¦åˆ†é¡µï¼Ÿ</strong></p>
<ul>
<li>å‡å°‘æ•°æ®çš„å¤„ç†é‡</li>
</ul>
<h3 id="7-1ã€ä½¿ç”¨Limitåˆ†é¡µ"><a href="#7-1ã€ä½¿ç”¨Limitåˆ†é¡µ" class="headerlink" title="7.1ã€ä½¿ç”¨Limitåˆ†é¡µ"></a>7.1ã€ä½¿ç”¨Limitåˆ†é¡µ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">è¯­æ³•ï¼š<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> limit startIndex,pageSize;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> limit <span class="number">3</span>;  #[<span class="number">0</span>,n]</span><br></pre></td></tr></table></figure>



<p>ä½¿ç”¨Mybatiså®ç°åˆ†é¡µï¼Œæ ¸å¿ƒSQL</p>
<ol>
<li><p>æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µ</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserByLimit</span><span class="params">(Map&lt;String,Integer&gt; map)</span></span>;</span><br></pre></td></tr></table></figure></li>
<li><p>Mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--//åˆ†é¡µ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByLimit&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span>&gt;</span></span><br><span class="line">    select * from  mybatis.user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserByLimit</span><span class="params">()</span></span>&#123;</span><br><span class="line">SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">HashMap&lt;String, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;startIndex&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    map.put(<span class="string">&quot;pageSize&quot;</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; userList =  mapper.getUserByLimit(map);</span><br><span class="line">    <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-2ã€RowBoundsåˆ†é¡µ"><a href="#7-2ã€RowBoundsåˆ†é¡µ" class="headerlink" title="7.2ã€RowBoundsåˆ†é¡µ"></a>7.2ã€RowBoundsåˆ†é¡µ</h3><p>ä¸å†ä½¿ç”¨SQLå®ç°åˆ†é¡µ</p>
<ol>
<li><p>æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µ2</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserByRowBounds</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure></li>
<li><p>mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--åˆ†é¡µ2--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByRowBounds&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span>&gt;</span></span><br><span class="line">    select * from  mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserByRowBounds</span><span class="params">()</span></span>&#123;</span><br><span class="line">SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line"><span class="comment">//RowBoundså®ç°</span></span><br><span class="line">RowBounds rowBounds = <span class="keyword">new</span> RowBounds(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//é€šè¿‡Javaä»£ç å±‚é¢å®ç°åˆ†é¡µ</span></span><br><span class="line">List&lt;User&gt; userList = sqlSession.selectList(<span class="string">&quot;com.kuang.dao.UserMapper.getUserByRowBounds&quot;</span>,<span class="keyword">null</span>,rowBounds);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-3ã€åˆ†é¡µæ’ä»¶"><a href="#7-3ã€åˆ†é¡µæ’ä»¶" class="headerlink" title="7.3ã€åˆ†é¡µæ’ä»¶"></a>7.3ã€åˆ†é¡µæ’ä»¶</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310105034474.png" alt="image-20210310105034474"></p>
<p>PageHelperæ˜¯ä¸€ä¸ªMybatisçš„åˆ†é¡µæ’ä»¶, è´Ÿè´£å°†å·²ç»å†™å¥½çš„sqlè¯­å¥, è¿›è¡Œåˆ†é¡µåŠ å·¥ã€‚å®˜ç½‘è¯´æ³•ï¼šå¦‚æœä½ ä¹Ÿåœ¨ç”¨ MyBatisï¼Œå»ºè®®å°è¯•è¯¥åˆ†é¡µæ’ä»¶ï¼Œè¿™ä¸€å®šæ˜¯æœ€æ–¹ä¾¿ä½¿ç”¨çš„åˆ†é¡µæ’ä»¶ã€‚åˆ†é¡µæ’ä»¶æ”¯æŒä»»ä½•å¤æ‚çš„å•è¡¨ã€å¤šè¡¨åˆ†é¡µã€‚</p>
<p>ä¼˜ç‚¹ï¼šæ— éœ€ä½ è‡ªå·±å»å°è£…ä»¥åŠå…³å¿ƒsqlåˆ†é¡µç­‰é—®é¢˜ï¼Œä½¿ç”¨å¾ˆæ–¹ä¾¿ï¼Œå‰ç«¯å–æ•°æ®ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚</p>
<h4 id="7-3-1ã€å¯¼å…¥PageHelperæ’å…¥ä¾èµ–"><a href="#7-3-1ã€å¯¼å…¥PageHelperæ’å…¥ä¾èµ–" class="headerlink" title="7.3.1ã€å¯¼å…¥PageHelperæ’å…¥ä¾èµ–"></a>7.3.1ã€å¯¼å…¥PageHelperæ’å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--MyBatisçš„PageHelperæ’ä»¶--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="æ·»åŠ åˆ†é¡µæ’ä»¶é…ç½®"><a href="#æ·»åŠ åˆ†é¡µæ’ä»¶é…ç½®" class="headerlink" title="æ·»åŠ åˆ†é¡µæ’ä»¶é…ç½®"></a>æ·»åŠ åˆ†é¡µæ’ä»¶é…ç½®</h4><p>SqlMapConfig.xmlé…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- com.github.pagehelperä¸ºPageHelperç±»æ‰€åœ¨åŒ…å --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ•°æ®åº“æ–¹è¨€--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;helperDialect&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆç†åŒ–åˆ†é¡µ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;reasonable&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¿…é¡»æ³¨æ„é…ç½®çš„é¡ºåºï¼Œé¡ºåºå‡ºé”™ï¼Œä¼šæ‰§è¡ŒæŠ¥é”™ï¼</p>
<p>å¦‚æœæ˜¯MyBatisä¸Springæ•´åˆï¼Œéœ€è¦ä¿®æ”¹Springçš„applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span>  </span><br><span class="line">  <span class="comment">&lt;!-- æ³¨æ„ï¼šè¿™é‡Œè¿˜æœ‰å…¶ä»–Springç›¸å…³é…ç½® --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;plugins&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">            helperDialect=mysql</span><br><span class="line">            reasonable=true</span><br><span class="line">          <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Daoæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CustomerDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCustomerDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.è·å–SqlSessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MyBatisUtils.getSession();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.ç”ŸæˆDaoä»£ç†å¯¹è±¡</span></span><br><span class="line">        CustomerDao customerDao = sqlSession.getMapper(CustomerDao.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.è®¾ç½®åˆ†é¡µå‚æ•°</span></span><br><span class="line">        <span class="keyword">int</span> pageNun = <span class="number">1</span>; <span class="comment">// é¡µç </span></span><br><span class="line">        <span class="keyword">int</span> pageSize = <span class="number">2</span>;<span class="comment">// æ¯é¡µæ˜¾ç¤ºæ¡æ•°</span></span><br><span class="line">        PageHelper.startPage(pageNun,pageSize);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. æŸ¥è¯¢ç”¨æˆ·æ•°æ®</span></span><br><span class="line">        List&lt;Customer&gt; list = customerDao.findAll();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.æŠŠç”¨æˆ·æ•°æ®å°è£…åˆ°PageInfoåˆ†é¡µç»“æœå¯¹è±¡</span></span><br><span class="line">        PageInfo&lt;Customer&gt; page = <span class="keyword">new</span> PageInfo&lt;&gt;(list);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.å–å‡ºPageInfoçš„å±æ€§</span></span><br><span class="line">        <span class="comment">//æµ‹è¯•PageInfoå…¨éƒ¨å±æ€§</span></span><br><span class="line">        <span class="comment">//PageInfoåŒ…å«äº†éå¸¸å…¨é¢çš„åˆ†é¡µå±æ€§</span></span><br><span class="line">        System.out.println(<span class="string">&quot;å½“å‰é¡µç =&quot;</span>+page.getPageNum());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¯é¡µæ˜¾ç¤ºæ¡æ•°=&quot;</span>+page.getPageSize());</span><br><span class="line">        System.out.println(<span class="string">&quot;å½“å‰é¡µèµ·å§‹è¡Œå·=&quot;</span>+page.getStartRow());</span><br><span class="line">        System.out.println(<span class="string">&quot;å½“å‰é¡µç»“æŸè¡Œå·=&quot;</span>+page.getEndRow());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ€»è®°å½•æ•°=&quot;</span>+page.getTotal());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ€»é¡µæ•°=&quot;</span>+page.getPages());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦ä¸ºç¬¬1é¡µ=&quot;</span>+page.isIsFirstPage());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦ä¸ºæœ€å1é¡µ=&quot;</span>+page.isIsLastPage());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦æœ‰ä¸Šä¸€é¡µ=&quot;</span>+page.isHasPreviousPage());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ=&quot;</span>+page.isHasNextPage());</span><br><span class="line">        System.out.println(<span class="string">&quot;å½“å‰é¡µæ•°æ®=&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(Customer c:page.getList())&#123;</span><br><span class="line">            System.out.println(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//7.å…³é—­è¿æ¥</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæµ‹è¯•ï¼ŒæŸ¥çœ‹ç»“æœ</p>
<h2 id="8ã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8ã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8ã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8ã€ä½¿ç”¨æ³¨è§£å¼€å‘</h2><h3 id="8-1ã€é¢å‘æ¥å£ç¼–ç¨‹"><a href="#8-1ã€é¢å‘æ¥å£ç¼–ç¨‹" class="headerlink" title="8.1ã€é¢å‘æ¥å£ç¼–ç¨‹"></a>8.1ã€é¢å‘æ¥å£ç¼–ç¨‹</h3><p>- å¤§å®¶ä¹‹å‰éƒ½å­¦è¿‡é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œä¹Ÿå­¦ä¹ è¿‡æ¥å£ï¼Œä½†åœ¨çœŸæ­£çš„å¼€å‘ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šé€‰æ‹©é¢å‘æ¥å£ç¼–ç¨‹<br>- <strong>æ ¹æœ¬åŸå›  :  ==è§£è€¦== , å¯æ‹“å±• , æé«˜å¤ç”¨ , åˆ†å±‚å¼€å‘ä¸­ , ä¸Šå±‚ä¸ç”¨ç®¡å…·ä½“çš„å®ç° , å¤§å®¶éƒ½éµå®ˆå…±åŒçš„æ ‡å‡† , ä½¿å¾—å¼€å‘å˜å¾—å®¹æ˜“ , è§„èŒƒæ€§æ›´å¥½</strong><br>- åœ¨ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿçš„å„ç§åŠŸèƒ½æ˜¯ç”±è®¸è®¸å¤šå¤šçš„ä¸åŒå¯¹è±¡åä½œå®Œæˆçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå„ä¸ªå¯¹è±¡å†…éƒ¨æ˜¯å¦‚ä½•å®ç°è‡ªå·±çš„,å¯¹ç³»ç»Ÿè®¾è®¡äººå‘˜æ¥è®²å°±ä¸é‚£ä¹ˆé‡è¦äº†ï¼›<br>- è€Œå„ä¸ªå¯¹è±¡ä¹‹é—´çš„åä½œå…³ç³»åˆ™æˆä¸ºç³»ç»Ÿè®¾è®¡çš„å…³é”®ã€‚å°åˆ°ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¤§åˆ°å„æ¨¡å—ä¹‹é—´çš„äº¤äº’ï¼Œåœ¨ç³»ç»Ÿè®¾è®¡ä¹‹åˆéƒ½æ˜¯è¦ç€é‡è€ƒè™‘çš„ï¼Œè¿™ä¹Ÿæ˜¯ç³»ç»Ÿè®¾è®¡çš„ä¸»è¦å·¥ä½œå†…å®¹ã€‚é¢å‘æ¥å£ç¼–ç¨‹å°±æ˜¯æŒ‡æŒ‰ç…§è¿™ç§æ€æƒ³æ¥ç¼–ç¨‹ã€‚</p>
<p><strong>å…³äºæ¥å£çš„ç†è§£</strong></p>
<p>- æ¥å£ä»æ›´æ·±å±‚æ¬¡çš„ç†è§£ï¼Œåº”æ˜¯å®šä¹‰ï¼ˆè§„èŒƒï¼Œçº¦æŸï¼‰ä¸å®ç°ï¼ˆåå®åˆ†ç¦»çš„åŸåˆ™ï¼‰çš„åˆ†ç¦»ã€‚<br>- æ¥å£çš„æœ¬èº«åæ˜ äº†ç³»ç»Ÿè®¾è®¡äººå‘˜å¯¹ç³»ç»Ÿçš„æŠ½è±¡ç†è§£ã€‚<br>- æ¥å£åº”æœ‰ä¸¤ç±»ï¼š<br>  - ç¬¬ä¸€ç±»æ˜¯å¯¹ä¸€ä¸ªä¸ªä½“çš„æŠ½è±¡ï¼Œå®ƒå¯å¯¹åº”ä¸ºä¸€ä¸ªæŠ½è±¡ä½“(abstract class)ï¼›<br>  - ç¬¬äºŒç±»æ˜¯å¯¹ä¸€ä¸ªä¸ªä½“æŸä¸€æ–¹é¢çš„æŠ½è±¡ï¼Œå³å½¢æˆä¸€ä¸ªæŠ½è±¡é¢ï¼ˆinterfaceï¼‰ï¼›<br>- ä¸€ä¸ªä½“æœ‰å¯èƒ½æœ‰å¤šä¸ªæŠ½è±¡é¢ã€‚æŠ½è±¡ä½“ä¸æŠ½è±¡é¢æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p>
<p><strong>ä¸‰ä¸ªé¢å‘åŒºåˆ«</strong></p>
<p>- é¢å‘å¯¹è±¡æ˜¯æŒ‡ï¼Œæˆ‘ä»¬è€ƒè™‘é—®é¢˜æ—¶ï¼Œä»¥å¯¹è±¡ä¸ºå•ä½ï¼Œè€ƒè™‘å®ƒçš„å±æ€§åŠæ–¹æ³• .<br>- é¢å‘è¿‡ç¨‹æ˜¯æŒ‡ï¼Œæˆ‘ä»¬è€ƒè™‘é—®é¢˜æ—¶ï¼Œä»¥ä¸€ä¸ªå…·ä½“çš„æµç¨‹ï¼ˆäº‹åŠ¡è¿‡ç¨‹ï¼‰ä¸ºå•ä½ï¼Œè€ƒè™‘å®ƒçš„å®ç° .<br>- æ¥å£è®¾è®¡ä¸éæ¥å£è®¾è®¡æ˜¯é’ˆå¯¹å¤ç”¨æŠ€æœ¯è€Œè¨€çš„ï¼Œä¸é¢å‘å¯¹è±¡ï¼ˆè¿‡ç¨‹ï¼‰ä¸æ˜¯ä¸€ä¸ªé—®é¢˜.æ›´å¤šçš„ä½“ç°å°±æ˜¯å¯¹ç³»ç»Ÿæ•´ä½“çš„æ¶æ„</p>
<h3 id="8-2ã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8-2ã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8.2ã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8.2ã€ä½¿ç”¨æ³¨è§£å¼€å‘</h3><ol>
<li><p>æ³¨è§£åœ¨æ¥å£ä¸Šå®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure></li>
<li><p>éœ€è¦å†æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ç»‘å®šæ¥å£ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç»‘å®šæ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.kuang.dao.UserMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æµ‹è¯•</p>
</li>
</ol>
<p>æœ¬è´¨ï¼šåå°„æœºåˆ¶å®ç°</p>
<p>åº•å±‚ï¼šåŠ¨æ€ä»£ç†ï¼</p>
<p> <img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310105641459.png" alt="image-20210310105641459"></p>
<p><strong>Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹ï¼</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310111357628.png" alt="image-20210310111357628"></p>
<h3 id="8-3ã€CRUD"><a href="#8-3ã€CRUD" class="headerlink" title="8.3ã€CRUD"></a>8.3ã€CRUD</h3><p>æˆ‘ä»¬å¯ä»¥åœ¨å·¥å…·ç±»åˆ›å»ºçš„æ—¶å€™å®ç°è‡ªåŠ¨æäº¤äº‹åŠ¡ï¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession  <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ç¼–å†™æ¥å£ï¼Œå¢åŠ æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹æ³•å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œæ‰€æœ‰çš„å‚æ•°å‰é¢å¿…é¡»åŠ ä¸Š @Param(&quot;id&quot;)æ³¨è§£</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function">User <span class="title">getUserByID</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into user(id,name,pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;password&#125;)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Update(&quot;update user set name=#&#123;name&#125;,pwd=#&#123;password&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Delete(&quot;delete from user where id = #&#123;uid&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(<span class="meta">@Param(&quot;uid&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•ç±»</p>
<p>ã€æ³¨æ„ï¼šæˆ‘ä»¬å¿…é¡»è¦è®²æ¥å£æ³¨å†Œç»‘å®šåˆ°æˆ‘ä»¬çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ï¼ã€‘</p>
<p><strong>å…³äº@Param() æ³¨è§£</strong></p>
<ul>
<li>åŸºæœ¬ç±»å‹çš„å‚æ•°æˆ–è€…Stringç±»å‹ï¼Œéœ€è¦åŠ ä¸Š</li>
<li>å¼•ç”¨ç±»å‹ä¸éœ€è¦åŠ </li>
<li>å¦‚æœåªæœ‰ä¸€ä¸ªåŸºæœ¬ç±»å‹çš„è¯ï¼Œå¯ä»¥å¿½ç•¥ï¼Œä½†æ˜¯å»ºè®®å¤§å®¶éƒ½åŠ ä¸Šï¼</li>
<li>æˆ‘ä»¬åœ¨SQLä¸­å¼•ç”¨çš„å°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„ @Param() ä¸­è®¾å®šçš„å±æ€§åï¼</li>
</ul>
<p><strong>#{}     ${} åŒºåˆ«</strong></p>
<ul>
<li>$ å®¹æ˜“SQLæ³¨å…¥ï¼</li>
</ul>
<h2 id="9ã€Lombok"><a href="#9ã€Lombok" class="headerlink" title="9ã€Lombok"></a>9ã€Lombok</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Project Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java.</span><br><span class="line">Never write another getter or equals method again, with one annotation your <span class="class"><span class="keyword">class</span> <span class="title">has</span> <span class="title">a</span> <span class="title">fully</span> <span class="title">featured</span> <span class="title">builder</span>, <span class="title">Automate</span> <span class="title">your</span> <span class="title">logging</span> <span class="title">variables</span>, <span class="title">and</span> <span class="title">much</span> <span class="title">more</span>.</span></span><br></pre></td></tr></table></figure>

<ul>
<li>java library</li>
<li>plugs</li>
<li>build tools</li>
<li>with one annotation your class</li>
</ul>
<p>ä½¿ç”¨æ­¥éª¤ï¼š</p>
<ol>
<li><p>åœ¨IDEAä¸­å®‰è£…Lombokæ’ä»¶ï¼</p>
</li>
<li><p>åœ¨é¡¹ç›®ä¸­å¯¼å…¥lombokçš„jaråŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨å®ä½“ç±»ä¸ŠåŠ æ³¨è§£å³å¯ï¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Getter</span> and <span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@FieldNameConstants</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span>, <span class="meta">@RequiredArgsConstructor</span> and <span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Log</span>, <span class="meta">@Log4j</span>, <span class="meta">@Log4j2</span>, <span class="meta">@Slf4j</span>, <span class="meta">@XSlf4j</span>, <span class="meta">@CommonsLog</span>, <span class="meta">@JBossLog</span>, <span class="meta">@Flogger</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@Singular</span></span><br><span class="line"><span class="meta">@Delegate</span></span><br><span class="line"><span class="meta">@Value</span></span><br><span class="line"><span class="meta">@Accessors</span></span><br><span class="line"><span class="meta">@Wither</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@Data</span>ï¼šæ— å‚æ„é€ ï¼Œgetã€setã€tostringã€hashcodeï¼Œequals</span><br><span class="line"><span class="variable">@AllArgsConstructor</span></span><br><span class="line"><span class="variable">@NoArgsConstructor</span></span><br><span class="line"><span class="variable">@EqualsAndHashCode</span></span><br><span class="line"><span class="variable">@ToString</span></span><br><span class="line"><span class="variable">@Getter</span></span><br></pre></td></tr></table></figure>



<h2 id="10ã€å¤šå¯¹ä¸€å¤„ç†"><a href="#10ã€å¤šå¯¹ä¸€å¤„ç†" class="headerlink" title="10ã€å¤šå¯¹ä¸€å¤„ç†"></a>10ã€å¤šå¯¹ä¸€å¤„ç†</h2><p>å¤šå¯¹ä¸€ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310105837691.png" alt="image-20210310105837691"></p>
<ul>
<li>å¤šä¸ªå­¦ç”Ÿï¼Œå¯¹åº”ä¸€ä¸ªè€å¸ˆ</li>
<li>å¯¹äºå­¦ç”Ÿè¿™è¾¹è€Œè¨€ï¼Œ  <strong>å…³è”</strong> ..  å¤šä¸ªå­¦ç”Ÿï¼Œå…³è”ä¸€ä¸ªè€å¸ˆ  ã€å¤šå¯¹ä¸€ã€‘</li>
<li>å¯¹äºè€å¸ˆè€Œè¨€ï¼Œ <strong>é›†åˆ</strong> ï¼Œ ä¸€ä¸ªè€å¸ˆï¼Œæœ‰å¾ˆå¤šå­¦ç”Ÿ ã€ä¸€å¯¹å¤šã€‘</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310105855538.png" alt="image-20210310105855538"></p>
<p>SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `teacher` (</span><br><span class="line">  `id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> teacher(`id`, `name`) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;å¼ ä¸‰&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `student` (</span><br><span class="line">  `id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tid` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `fktid` (`tid`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `fktid` <span class="keyword">FOREIGN</span> KEY (`tid`) <span class="keyword">REFERENCES</span> `teacher` (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;å°çº¢&#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;å°å¼ &#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;å°æ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;å°ç‹&#x27;</span>, <span class="string">&#x27;1&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="æµ‹è¯•ç¯å¢ƒæ­å»º"></a>æµ‹è¯•ç¯å¢ƒæ­å»º</h3><ol>
<li>å¯¼å…¥lombok</li>
<li>æ–°å»ºå®ä½“ç±» Teacherï¼ŒStudent</li>
<li>å»ºç«‹Mapperæ¥å£</li>
<li>å»ºç«‹Mapper.XMLæ–‡ä»¶</li>
<li>åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ç»‘å®šæ³¨å†Œæˆ‘ä»¬çš„Mapperæ¥å£æˆ–è€…æ–‡ä»¶ï¼ã€æ–¹å¼å¾ˆå¤šï¼Œéšå¿ƒé€‰ã€‘</li>
<li>æµ‹è¯•æŸ¥è¯¢æ˜¯å¦èƒ½å¤ŸæˆåŠŸï¼</li>
</ol>
<h3 id="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    æ€è·¯:</span></span><br><span class="line"><span class="comment">        1. æŸ¥è¯¢æ‰€æœ‰çš„å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line"><span class="comment">        2. æ ¹æ®æŸ¥è¯¢å‡ºæ¥çš„å­¦ç”Ÿçš„tidï¼Œå¯»æ‰¾å¯¹åº”çš„è€å¸ˆï¼  å­æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudent&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentTeacher&quot;</span>&gt;</span></span><br><span class="line">    select * from student</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentTeacher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¤æ‚çš„å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦å•ç‹¬å¤„ç† å¯¹è±¡ï¼š association é›†åˆï¼š collection --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Teacher&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getTeacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacher&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Teacher&quot;</span>&gt;</span></span><br><span class="line">    select * from teacher where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"></a>æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudent2&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentTeacher2&quot;</span>&gt;</span></span><br><span class="line">    select s.id sid,s.name sname,t.name tname</span><br><span class="line">    from student s,teacher t</span><br><span class="line">    where s.tid = t.id;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentTeacher2&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Teacher&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>å›é¡¾Mysql å¤šå¯¹ä¸€æŸ¥è¯¢æ–¹å¼ï¼š</p>
<ul>
<li>å­æŸ¥è¯¢</li>
<li>è”è¡¨æŸ¥è¯¢</li>
</ul>
<h2 id="11ã€ä¸€å¯¹å¤šå¤„ç†"><a href="#11ã€ä¸€å¯¹å¤šå¤„ç†" class="headerlink" title="11ã€ä¸€å¯¹å¤šå¤„ç†"></a>11ã€ä¸€å¯¹å¤šå¤„ç†</h2><p>æ¯”å¦‚ï¼šä¸€ä¸ªè€å¸ˆæ‹¥æœ‰å¤šä¸ªå­¦ç”Ÿï¼</p>
<p>å¯¹äºè€å¸ˆè€Œè¨€ï¼Œå°±æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»!</p>
<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><ol>
<li>ç¯å¢ƒæ­å»ºï¼Œå’Œåˆšæ‰ä¸€æ ·</li>
</ol>
<p><strong>å®ä½“ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> tid;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸€ä¸ªè€å¸ˆæ‹¥æœ‰å¤šä¸ªå­¦ç”Ÿ</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†-1"><a href="#æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†-1" class="headerlink" title="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"></a>æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æŒ‰ç»“æœåµŒå¥—æŸ¥è¯¢--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacher&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TeacherStudent&quot;</span>&gt;</span></span><br><span class="line">    select s.id sid, s.name sname, t.name tname,t.id tid</span><br><span class="line">    from student s,teacher t</span><br><span class="line">    where s.tid = t.id and t.id = #&#123;tid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;TeacherStudent&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Teacher&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¤æ‚çš„å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦å•ç‹¬å¤„ç† å¯¹è±¡ï¼š association é›†åˆï¼š collection</span></span><br><span class="line"><span class="comment">    javaType=&quot;&quot; æŒ‡å®šå±æ€§çš„ç±»å‹ï¼</span></span><br><span class="line"><span class="comment">    é›†åˆä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ofTypeè·å–</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;tid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†-1"><a href="#æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†-1" class="headerlink" title="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacher2&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TeacherStudent2&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.teacher where id = #&#123;tid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;TeacherStudent2&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Teacher&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;ArrayList&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getStudentByTeacherId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentByTeacherId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.student where tid = #&#123;tid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ol>
<li>å…³è” - association   ã€å¤šå¯¹ä¸€ã€‘</li>
<li>é›†åˆ - collection   ã€ä¸€å¯¹å¤šã€‘</li>
<li>javaType    &amp;   ofType<ol>
<li>JavaType  ç”¨æ¥æŒ‡å®šå®ä½“ç±»ä¸­å±æ€§çš„ç±»å‹</li>
<li>ofType  ç”¨æ¥æŒ‡å®šæ˜ å°„åˆ°Listæˆ–è€…é›†åˆä¸­çš„ pojoç±»å‹ï¼Œæ³›å‹ä¸­çš„çº¦æŸç±»å‹ï¼</li>
</ol>
</li>
</ol>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>ä¿è¯SQLçš„å¯è¯»æ€§ï¼Œå°½é‡ä¿è¯é€šä¿—æ˜“æ‡‚</li>
<li>æ³¨æ„ä¸€å¯¹å¤šå’Œå¤šå¯¹ä¸€ä¸­ï¼Œå±æ€§åå’Œå­—æ®µçš„é—®é¢˜ï¼</li>
<li>å¦‚æœé—®é¢˜ä¸å¥½æ’æŸ¥é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨æ—¥å¿— ï¼Œ å»ºè®®ä½¿ç”¨ Log4j</li>
</ul>
<p><strong>æ…¢SQL       1s        1000s</strong>      </p>
<p>é¢è¯•é«˜é¢‘</p>
<ul>
<li>Mysqlå¼•æ“</li>
<li>InnoDBåº•å±‚åŸç†</li>
<li>ç´¢å¼•</li>
<li>ç´¢å¼•ä¼˜åŒ–ï¼</li>
</ul>
<h2 id="12ã€åŠ¨æ€-SQL"><a href="#12ã€åŠ¨æ€-SQL" class="headerlink" title="12ã€åŠ¨æ€ SQL"></a>12ã€åŠ¨æ€ SQL</h2><p>==<strong>ä»€ä¹ˆæ˜¯åŠ¨æ€SQLï¼šåŠ¨æ€SQLå°±æ˜¯æŒ‡æ ¹æ®ä¸åŒçš„æ¡ä»¶ç”Ÿæˆä¸åŒçš„SQLè¯­å¥</strong>==</p>
<p>åˆ©ç”¨åŠ¨æ€ SQL è¿™ä¸€ç‰¹æ€§å¯ä»¥å½»åº•æ‘†è„±è¿™ç§ç—›è‹¦ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">åŠ¨æ€ SQL å…ƒç´ å’Œ JSTL æˆ–åŸºäºç±»ä¼¼ XML çš„æ–‡æœ¬å¤„ç†å™¨ç›¸ä¼¼ã€‚åœ¨ MyBatis ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæœ‰å¾ˆå¤šå…ƒç´ éœ€è¦èŠ±æ—¶é—´äº†è§£ã€‚MyBatis 3 å¤§å¤§ç²¾ç®€äº†å…ƒç´ ç§ç±»ï¼Œç°åœ¨åªéœ€å­¦ä¹ åŸæ¥ä¸€åŠçš„å…ƒç´ ä¾¿å¯ã€‚MyBatis é‡‡ç”¨åŠŸèƒ½å¼ºå¤§çš„åŸºäº OGNL çš„è¡¨è¾¾å¼æ¥æ·˜æ±°å…¶å®ƒå¤§éƒ¨åˆ†å…ƒç´ ã€‚</span><br><span class="line"></span><br><span class="line">if</span><br><span class="line">choose (when, otherwise)</span><br><span class="line">trim (where, set)</span><br><span class="line">foreach</span><br></pre></td></tr></table></figure>



<h3 id="æ­å»ºç¯å¢ƒ"><a href="#æ­å»ºç¯å¢ƒ" class="headerlink" title="æ­å»ºç¯å¢ƒ"></a>æ­å»ºç¯å¢ƒ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `blog` (</span><br><span class="line">  `id` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åšå®¢id&#x27;</span>,</span><br><span class="line">  `title` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åšå®¢æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  `author` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åšå®¢ä½œè€…&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `views` <span class="type">int</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æµè§ˆé‡&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>åˆ›å»ºä¸€ä¸ªåŸºç¡€å·¥ç¨‹</p>
<ol>
<li><p>å¯¼åŒ…</p>
</li>
<li><p>ç¼–å†™é…ç½®æ–‡ä»¶</p>
</li>
<li><p>ç¼–å†™å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> views;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™å®ä½“ç±»å¯¹åº”Mapperæ¥å£ å’Œ Mapper.XMLæ–‡ä»¶</p>
</li>
</ol>
<h3 id="IF"><a href="#IF" class="headerlink" title="IF"></a>IF</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogIF&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog where 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">        and title = #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span></span><br><span class="line">        and author = #&#123;author&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="choose-when-otherwise"><a href="#choose-when-otherwise" class="headerlink" title="choose (when, otherwise)"></a>choose (when, otherwise)</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogChoose&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">                title = #&#123;title&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span></span><br><span class="line">                and author = #&#123;author&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                and views = #&#123;views&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="trim-where-set"><a href="#trim-where-set" class="headerlink" title="trim (where,set)"></a>trim (where,set)</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">select * from mybatis.blog</span><br><span class="line"><span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">        title = #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span></span><br><span class="line">        and author = #&#123;author&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBlog&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">    update mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">            title = #&#123;title&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span></span><br><span class="line">            author = #&#123;author&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>æ‰€è°“çš„åŠ¨æ€SQLï¼Œæœ¬è´¨è¿˜æ˜¯SQLè¯­å¥ ï¼Œ åªæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨SQLå±‚é¢ï¼Œå»æ‰§è¡Œä¸€ä¸ªé€»è¾‘ä»£ç </strong></p>
<h3 id="SQLç‰‡æ®µ"><a href="#SQLç‰‡æ®µ" class="headerlink" title="SQLç‰‡æ®µ"></a>SQLç‰‡æ®µ</h3><p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå°†ä¸€äº›åŠŸèƒ½çš„éƒ¨åˆ†æŠ½å–å‡ºæ¥ï¼Œæ–¹ä¾¿å¤ç”¨ï¼</p>
<ol>
<li><p>ä½¿ç”¨SQLæ ‡ç­¾æŠ½å–å…¬å…±çš„éƒ¨åˆ†</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;if-title-author&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">        title = #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span></span><br><span class="line">        and author = #&#123;author&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨éœ€è¦ä½¿ç”¨çš„åœ°æ–¹ä½¿ç”¨Includeæ ‡ç­¾å¼•ç”¨å³å¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogIF&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;if-title-author&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>æœ€å¥½åŸºäºå•è¡¨æ¥å®šä¹‰SQLç‰‡æ®µï¼</li>
<li>ä¸è¦å­˜åœ¨whereæ ‡ç­¾</li>
</ul>
<h3 id="Foreach"><a href="#Foreach" class="headerlink" title="Foreach"></a>Foreach</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> </span><br><span class="line"></span><br><span class="line">  <span class="operator">&lt;</span>foreach item<span class="operator">=</span>&quot;id&quot; collection<span class="operator">=</span>&quot;ids&quot;</span><br><span class="line">      <span class="keyword">open</span><span class="operator">=</span>&quot;(&quot; separator<span class="operator">=</span>&quot;or&quot; <span class="keyword">close</span><span class="operator">=</span>&quot;)&quot;<span class="operator">&gt;</span></span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">/</span>foreach<span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">(id<span class="operator">=</span><span class="number">1</span> <span class="keyword">or</span> id<span class="operator">=</span><span class="number">2</span> <span class="keyword">or</span> id<span class="operator">=</span><span class="number">3</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310110351535.png" alt="image-20210310110351535"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        select * from mybatis.blog where 1=1 and (id=1 or id = 2 or id=3)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        æˆ‘ä»¬ç°åœ¨ä¼ é€’ä¸€ä¸ªä¸‡èƒ½çš„map ï¼Œ è¿™mapä¸­å¯ä»¥å­˜åœ¨ä¸€ä¸ªé›†åˆï¼</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogForeach&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">open</span>=<span class="string">&quot;and (&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;or&quot;</span>&gt;</span></span><br><span class="line">            id = #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>åŠ¨æ€SQLå°±æ˜¯åœ¨æ‹¼æ¥SQLè¯­å¥ï¼Œæˆ‘ä»¬åªè¦ä¿è¯SQLçš„æ­£ç¡®æ€§ï¼ŒæŒ‰ç…§SQLçš„æ ¼å¼ï¼Œå»æ’åˆ—ç»„åˆå°±å¯ä»¥äº†</strong></p>
<p>å»ºè®®ï¼š</p>
<ul>
<li>ç°åœ¨Mysqlä¸­å†™å‡ºå®Œæ•´çš„SQL,å†å¯¹åº”çš„å»ä¿®æ”¹æˆä¸ºæˆ‘ä»¬çš„åŠ¨æ€SQLå®ç°é€šç”¨å³å¯ï¼</li>
</ul>
<h2 id="13ã€ç¼“å­˜-ï¼ˆäº†è§£ï¼‰"><a href="#13ã€ç¼“å­˜-ï¼ˆäº†è§£ï¼‰" class="headerlink" title="13ã€ç¼“å­˜ ï¼ˆäº†è§£ï¼‰"></a>13ã€ç¼“å­˜ ï¼ˆäº†è§£ï¼‰</h2><h3 id="13-1ã€ç®€ä»‹"><a href="#13-1ã€ç®€ä»‹" class="headerlink" title="13.1ã€ç®€ä»‹"></a>13.1ã€ç®€ä»‹</h3><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">æŸ¥è¯¢  ï¼š  è¿æ¥æ•°æ®åº“ ï¼Œè€—èµ„æºï¼</span><br><span class="line">	ä¸€æ¬¡æŸ¥è¯¢çš„ç»“æœï¼Œç»™ä»–æš‚å­˜åœ¨ä¸€ä¸ªå¯ä»¥ç›´æ¥å–åˆ°çš„åœ°æ–¹ï¼<span class="comment">--&gt; å†…å­˜ ï¼š ç¼“å­˜</span></span><br><span class="line">	</span><br><span class="line">æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢ç›¸åŒæ•°æ®çš„æ—¶å€™ï¼Œç›´æ¥èµ°ç¼“å­˜ï¼Œå°±ä¸ç”¨èµ°æ•°æ®åº“äº†</span><br></pre></td></tr></table></figure>



<ol>
<li>ä»€ä¹ˆæ˜¯ç¼“å­˜ [ Cache ]ï¼Ÿ<ul>
<li>å­˜åœ¨å†…å­˜ä¸­çš„ä¸´æ—¶æ•°æ®ã€‚</li>
<li>å°†ç”¨æˆ·ç»å¸¸æŸ¥è¯¢çš„æ•°æ®æ”¾åœ¨ç¼“å­˜ï¼ˆå†…å­˜ï¼‰ä¸­ï¼Œç”¨æˆ·å»æŸ¥è¯¢æ•°æ®å°±ä¸ç”¨ä»ç£ç›˜ä¸Š(å…³ç³»å‹æ•°æ®åº“æ•°æ®æ–‡ä»¶)æŸ¥è¯¢ï¼Œä»ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œè§£å†³äº†é«˜å¹¶å‘ç³»ç»Ÿçš„æ€§èƒ½é—®é¢˜ã€‚</li>
</ul>
</li>
<li>ä¸ºä»€ä¹ˆä½¿ç”¨ç¼“å­˜ï¼Ÿ<ul>
<li>å‡å°‘å’Œæ•°æ®åº“çš„äº¤äº’æ¬¡æ•°ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€ï¼Œæé«˜ç³»ç»Ÿæ•ˆç‡ã€‚</li>
</ul>
</li>
<li>ä»€ä¹ˆæ ·çš„æ•°æ®èƒ½ä½¿ç”¨ç¼“å­˜ï¼Ÿ<ul>
<li>ç»å¸¸æŸ¥è¯¢å¹¶ä¸”ä¸ç»å¸¸æ”¹å˜çš„æ•°æ®ã€‚ã€å¯ä»¥ä½¿ç”¨ç¼“å­˜ã€‘</li>
</ul>
</li>
</ol>
<h3 id="13-2ã€Mybatisç¼“å­˜"><a href="#13-2ã€Mybatisç¼“å­˜" class="headerlink" title="13.2ã€Mybatisç¼“å­˜"></a>13.2ã€Mybatisç¼“å­˜</h3><ul>
<li>MyBatisåŒ…å«ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æŸ¥è¯¢ç¼“å­˜ç‰¹æ€§ï¼Œå®ƒå¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®šåˆ¶å’Œé…ç½®ç¼“å­˜ã€‚ç¼“å­˜å¯ä»¥æå¤§çš„æå‡æŸ¥è¯¢æ•ˆç‡ã€‚</li>
<li>MyBatisç³»ç»Ÿä¸­é»˜è®¤å®šä¹‰äº†ä¸¤çº§ç¼“å­˜ï¼š<strong>ä¸€çº§ç¼“å­˜</strong>å’Œ<strong>äºŒçº§ç¼“å­˜</strong><ul>
<li><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€çº§ç¼“å­˜å¼€å¯ã€‚ï¼ˆSqlSessionçº§åˆ«çš„ç¼“å­˜ï¼Œä¹Ÿç§°ä¸ºæœ¬åœ°ç¼“å­˜ï¼‰</p>
</li>
<li><p>äºŒçº§ç¼“å­˜éœ€è¦æ‰‹åŠ¨å¼€å¯å’Œé…ç½®ï¼Œä»–æ˜¯åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ã€‚</p>
</li>
<li><p>ä¸ºäº†æé«˜æ‰©å±•æ€§ï¼ŒMyBatiså®šä¹‰äº†ç¼“å­˜æ¥å£Cacheã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°Cacheæ¥å£æ¥è‡ªå®šä¹‰äºŒçº§ç¼“å­˜</p>
</li>
</ul>
</li>
</ul>
<h3 id="13-3ã€ä¸€çº§ç¼“å­˜"><a href="#13-3ã€ä¸€çº§ç¼“å­˜" class="headerlink" title="13.3ã€ä¸€çº§ç¼“å­˜"></a>13.3ã€ä¸€çº§ç¼“å­˜</h3><ul>
<li>ä¸€çº§ç¼“å­˜ä¹Ÿå«æœ¬åœ°ç¼“å­˜ï¼š  SqlSession<ul>
<li>ä¸æ•°æ®åº“åŒä¸€æ¬¡ä¼šè¯æœŸé—´æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼šæ”¾åœ¨æœ¬åœ°ç¼“å­˜ä¸­ã€‚</li>
<li>ä»¥åå¦‚æœéœ€è¦è·å–ç›¸åŒçš„æ•°æ®ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿ï¼Œæ²¡å¿…é¡»å†å»æŸ¥è¯¢æ•°æ®åº“ï¼›</li>
</ul>
</li>
</ul>
<p>æµ‹è¯•æ­¥éª¤ï¼š</p>
<ol>
<li>å¼€å¯æ—¥å¿—ï¼</li>
<li>æµ‹è¯•åœ¨ä¸€ä¸ªSesionä¸­æŸ¥è¯¢ä¸¤æ¬¡ç›¸åŒè®°å½•</li>
<li>æŸ¥çœ‹æ—¥å¿—è¾“å‡º</li>
</ol>
<p>ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼š</p>
<ol>
<li><p>æŸ¥è¯¢ä¸åŒçš„ä¸œè¥¿</p>
</li>
<li><p>å¢åˆ æ”¹æ“ä½œï¼Œå¯èƒ½ä¼šæ”¹å˜åŸæ¥çš„æ•°æ®ï¼Œæ‰€ä»¥å¿…å®šä¼šåˆ·æ–°ç¼“å­˜ï¼</p>
</li>
<li><p>æŸ¥è¯¢ä¸åŒçš„Mapper.xml</p>
</li>
<li><p>æ‰‹åŠ¨æ¸…ç†ç¼“å­˜ï¼</p>
</li>
</ol>
<p>å°ç»“ï¼šä¸€çº§ç¼“å­˜é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œåªåœ¨ä¸€æ¬¡SqlSessionä¸­æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯æ‹¿åˆ°è¿æ¥åˆ°å…³é—­è¿æ¥è¿™ä¸ªåŒºé—´æ®µï¼</p>
<p>ä¸€çº§ç¼“å­˜å°±æ˜¯ä¸€ä¸ªMapã€‚</p>
<h3 id="13-4ã€äºŒçº§ç¼“å­˜"><a href="#13-4ã€äºŒçº§ç¼“å­˜" class="headerlink" title="13.4ã€äºŒçº§ç¼“å­˜"></a>13.4ã€äºŒçº§ç¼“å­˜</h3><ul>
<li>äºŒçº§ç¼“å­˜ä¹Ÿå«å…¨å±€ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜ä½œç”¨åŸŸå¤ªä½äº†ï¼Œæ‰€ä»¥è¯ç”Ÿäº†äºŒçº§ç¼“å­˜</li>
<li>åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ï¼Œä¸€ä¸ªåç§°ç©ºé—´ï¼Œå¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜ï¼›</li>
<li>å·¥ä½œæœºåˆ¶<ul>
<li>ä¸€ä¸ªä¼šè¯æŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®å°±ä¼šè¢«æ”¾åœ¨å½“å‰ä¼šè¯çš„ä¸€çº§ç¼“å­˜ä¸­ï¼›</li>
<li>å¦‚æœå½“å‰ä¼šè¯å…³é—­äº†ï¼Œè¿™ä¸ªä¼šè¯å¯¹åº”çš„ä¸€çº§ç¼“å­˜å°±æ²¡äº†ï¼›ä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ˜¯ï¼Œä¼šè¯å…³é—­äº†ï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®è¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼›</li>
<li>æ–°çš„ä¼šè¯æŸ¥è¯¢ä¿¡æ¯ï¼Œå°±å¯ä»¥ä»äºŒçº§ç¼“å­˜ä¸­è·å–å†…å®¹ï¼›</li>
<li>ä¸åŒçš„mapperæŸ¥å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜ï¼ˆmapï¼‰ä¸­ï¼›</li>
</ul>
</li>
</ul>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li><p>å¼€å¯å…¨å±€ç¼“å­˜</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ˜¾ç¤ºçš„å¼€å¯å…¨å±€ç¼“å­˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨è¦ä½¿ç”¨äºŒçº§ç¼“å­˜çš„Mapperä¸­å¼€å¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨å½“å‰Mapper.xmlä¸­ä½¿ç”¨äºŒçº§ç¼“å­˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å‚æ•°</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨å½“å‰Mapper.xmlä¸­ä½¿ç”¨äºŒçº§ç¼“å­˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span>  <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">size</span>=<span class="string">&quot;512&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æµ‹è¯•</p>
<ol>
<li><p>é—®é¢˜:æˆ‘ä»¬éœ€è¦å°†å®ä½“ç±»åºåˆ—åŒ–ï¼å¦åˆ™å°±ä¼šæŠ¥é”™ï¼</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">Caused by: java<span class="selector-class">.io</span><span class="selector-class">.NotSerializableException</span>: com<span class="selector-class">.kuang</span><span class="selector-class">.pojo</span>.User</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<p>å°ç»“ï¼š</p>
<ul>
<li>åªè¦å¼€å¯äº†äºŒçº§ç¼“å­˜ï¼Œåœ¨åŒä¸€ä¸ªMapperä¸‹å°±æœ‰æ•ˆ</li>
<li>æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šå…ˆæ”¾åœ¨ä¸€çº§ç¼“å­˜ä¸­ï¼›</li>
<li>åªæœ‰å½“ä¼šè¯æäº¤ï¼Œæˆ–è€…å…³é—­çš„æ—¶å€™ï¼Œæ‰ä¼šæäº¤åˆ°äºŒçº§ç¼“å†²ä¸­ï¼</li>
</ul>
<h3 id="13-5ã€ç¼“å­˜åŸç†"><a href="#13-5ã€ç¼“å­˜åŸç†" class="headerlink" title="13.5ã€ç¼“å­˜åŸç†"></a>13.5ã€ç¼“å­˜åŸç†</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210310110835283.png" alt="image-20210310110835283"></p>
<h3 id="13-6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache"><a href="#13-6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache" class="headerlink" title="13.6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache"></a>13.6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">Ehcacheæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å¼€æºJavaåˆ†å¸ƒå¼ç¼“å­˜ã€‚ä¸»è¦é¢å‘é€šç”¨ç¼“å­˜</span><br></pre></td></tr></table></figure>

<p>è¦åœ¨ç¨‹åºä¸­ä½¿ç”¨ehcacheï¼Œå…ˆè¦å¯¼åŒ…ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-ehcache --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.caches<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨mapperä¸­æŒ‡å®šä½¿ç”¨æˆ‘ä»¬çš„ehcacheç¼“å­˜å®ç°ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨å½“å‰Mapper.xmlä¸­ä½¿ç”¨äºŒçº§ç¼“å­˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ehcache.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">&quot;http://ehcache.org/ehcache.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">updateCheck</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       diskStoreï¼šä¸ºç¼“å­˜è·¯å¾„ï¼Œehcacheåˆ†ä¸ºå†…å­˜å’Œç£ç›˜ä¸¤çº§ï¼Œæ­¤å±æ€§å®šä¹‰ç£ç›˜çš„ç¼“å­˜ä½ç½®ã€‚å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">       user.home â€“ ç”¨æˆ·ä¸»ç›®å½•</span></span><br><span class="line"><span class="comment">       user.dir  â€“ ç”¨æˆ·å½“å‰å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="comment">       java.io.tmpdir â€“ é»˜è®¤ä¸´æ—¶æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">&quot;./tmpdir/Tmp_EhCache&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    &lt;defaultCache</span><br><span class="line">            eternal=&quot;false&quot;</span><br><span class="line">            maxElementsInMemory=&quot;10000&quot;</span><br><span class="line">            overflowToDisk=&quot;false&quot;</span><br><span class="line">            diskPersistent=&quot;false&quot;</span><br><span class="line">            timeToIdleSeconds=&quot;1800&quot;</span><br><span class="line">            timeToLiveSeconds=&quot;259200&quot;</span><br><span class="line">            memoryStoreEvictionPolicy=&quot;LRU&quot;/&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;cache</span><br><span class="line">            name=&quot;cloud_user&quot;</span><br><span class="line">            eternal=&quot;false&quot;</span><br><span class="line">            maxElementsInMemory=&quot;5000&quot;</span><br><span class="line">            overflowToDisk=&quot;false&quot;</span><br><span class="line">            diskPersistent=&quot;false&quot;</span><br><span class="line">            timeToIdleSeconds=&quot;1800&quot;</span><br><span class="line">            timeToLiveSeconds=&quot;1800&quot;</span><br><span class="line">            memoryStoreEvictionPolicy=&quot;LRU&quot;/&gt;</span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       defaultCacheï¼šé»˜è®¤ç¼“å­˜ç­–ç•¥ï¼Œå½“ehcacheæ‰¾ä¸åˆ°å®šä¹‰çš„ç¼“å­˜æ—¶ï¼Œåˆ™ä½¿ç”¨è¿™ä¸ªç¼“å­˜ç­–ç•¥ã€‚åªèƒ½å®šä¹‰ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      name:ç¼“å­˜åç§°ã€‚</span></span><br><span class="line"><span class="comment">      maxElementsInMemory:ç¼“å­˜æœ€å¤§æ•°ç›®</span></span><br><span class="line"><span class="comment">      maxElementsOnDiskï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚</span></span><br><span class="line"><span class="comment">      eternal:å¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚</span></span><br><span class="line"><span class="comment">      overflowToDisk:æ˜¯å¦ä¿å­˜åˆ°ç£ç›˜ï¼Œå½“ç³»ç»Ÿå½“æœºæ—¶</span></span><br><span class="line"><span class="comment">      timeToIdleSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚</span></span><br><span class="line"><span class="comment">      timeToLiveSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0.ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚</span></span><br><span class="line"><span class="comment">      diskPersistentï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ® Whether the disk store persists between restarts of the Virtual Machine. The default value is false.</span></span><br><span class="line"><span class="comment">      diskSpoolBufferSizeMBï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚</span></span><br><span class="line"><span class="comment">      diskExpiryThreadIntervalSecondsï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚</span></span><br><span class="line"><span class="comment">      memoryStoreEvictionPolicyï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥å»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">      clearOnFlushï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚</span></span><br><span class="line"><span class="comment">      memoryStoreEvictionPolicy:å¯é€‰ç­–ç•¥æœ‰ï¼šLRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼Œé»˜è®¤ç­–ç•¥ï¼‰ã€FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ã€LFUï¼ˆæœ€å°‘è®¿é—®æ¬¡æ•°ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">      FIFOï¼Œfirst in first outï¼Œè¿™ä¸ªæ˜¯å¤§å®¶æœ€ç†Ÿçš„ï¼Œå…ˆè¿›å…ˆå‡ºã€‚</span></span><br><span class="line"><span class="comment">      LFUï¼Œ Less Frequently Usedï¼Œå°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼Œç›´ç™½ä¸€ç‚¹å°±æ˜¯è®²ä¸€ç›´ä»¥æ¥æœ€å°‘è¢«ä½¿ç”¨çš„ã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªhitå±æ€§ï¼Œhitå€¼æœ€å°çš„å°†ä¼šè¢«æ¸…å‡ºç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">      LRUï¼ŒLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå½“ç¼“å­˜å®¹é‡æ»¡äº†ï¼Œè€Œåˆéœ€è¦è…¾å‡ºåœ°æ–¹æ¥ç¼“å­˜æ–°çš„å…ƒç´ çš„æ—¶å€™ï¼Œé‚£ä¹ˆç°æœ‰ç¼“å­˜å…ƒç´ ä¸­æ—¶é—´æˆ³ç¦»å½“å‰æ—¶é—´æœ€è¿œçš„å…ƒç´ å°†è¢«æ¸…å‡ºç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Redisæ•°æ®åº“æ¥åšç¼“å­˜ï¼  K-V</p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVCå­¦ä¹ ç¬”è®°</title>
    <url>/2021/02/15/SpringMVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="1ã€å›é¡¾MVC"><a href="#1ã€å›é¡¾MVC" class="headerlink" title="1ã€å›é¡¾MVC"></a>1ã€å›é¡¾MVC</h2><h3 id="1-1ã€ä»€ä¹ˆæ˜¯MVC"><a href="#1-1ã€ä»€ä¹ˆæ˜¯MVC" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯MVC"></a>1.1ã€ä»€ä¹ˆæ˜¯MVC</h3><ul>
<li>MVCæ˜¯æ¨¡å‹(Model)ã€è§†å›¾(View)ã€æ§åˆ¶å™¨(Controller)çš„ç®€å†™ï¼Œæ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡è§„èŒƒã€‚</li>
<li>æ˜¯å°†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®ã€æ˜¾ç¤ºåˆ†ç¦»çš„æ–¹æ³•æ¥ç»„ç»‡ä»£ç ã€‚</li>
<li>MVCä¸»è¦ä½œç”¨æ˜¯<strong>é™ä½äº†è§†å›¾ä¸ä¸šåŠ¡é€»è¾‘é—´çš„åŒå‘å¶åˆ</strong>ã€‚</li>
<li>MVCä¸æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œ<strong>MVCæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼</strong>ã€‚å½“ç„¶ä¸åŒçš„MVCå­˜åœ¨å·®å¼‚ã€‚</li>
</ul>
<p><strong>Modelï¼ˆæ¨¡å‹ï¼‰ï¼š</strong>æ•°æ®æ¨¡å‹ï¼Œæä¾›è¦å±•ç¤ºçš„æ•°æ®ï¼Œå› æ­¤åŒ…å«æ•°æ®å’Œè¡Œä¸ºï¼Œå¯ä»¥è®¤ä¸ºæ˜¯é¢†åŸŸæ¨¡å‹æˆ–JavaBeanç»„ä»¶ï¼ˆåŒ…å«æ•°æ®å’Œè¡Œä¸ºï¼‰ï¼Œä¸è¿‡ç°åœ¨ä¸€èˆ¬éƒ½åˆ†ç¦»å¼€æ¥ï¼šValue Objectï¼ˆæ•°æ®Daoï¼‰ å’Œ æœåŠ¡å±‚ï¼ˆè¡Œä¸ºServiceï¼‰ã€‚ä¹Ÿå°±æ˜¯æ¨¡å‹æä¾›äº†æ¨¡å‹æ•°æ®æŸ¥è¯¢å’Œæ¨¡å‹æ•°æ®çš„çŠ¶æ€æ›´æ–°ç­‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®å’Œä¸šåŠ¡ã€‚</p>
<p><strong>Viewï¼ˆè§†å›¾ï¼‰ï¼š</strong>è´Ÿè´£è¿›è¡Œæ¨¡å‹çš„å±•ç¤ºï¼Œä¸€èˆ¬å°±æ˜¯æˆ‘ä»¬è§åˆ°çš„ç”¨æˆ·ç•Œé¢ï¼Œå®¢æˆ·æƒ³çœ‹åˆ°çš„ä¸œè¥¿ã€‚</p>
<p><strong>Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ï¼š</strong>æ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œå§”æ‰˜ç»™æ¨¡å‹è¿›è¡Œå¤„ç†ï¼ˆçŠ¶æ€æ”¹å˜ï¼‰ï¼Œå¤„ç†å®Œæ¯•åæŠŠè¿”å›çš„æ¨¡å‹æ•°æ®è¿”å›ç»™è§†å›¾ï¼Œç”±è§†å›¾è´Ÿè´£å±•ç¤ºã€‚ä¹Ÿå°±æ˜¯è¯´æ§åˆ¶å™¨åšäº†ä¸ªè°ƒåº¦å‘˜çš„å·¥ä½œã€‚</p>
<p>**æœ€å…¸å‹çš„MVCå°±æ˜¯JSP + servlet + javabeançš„æ¨¡å¼ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309154338645.png"></p>
<h3 id="1-2ã€Model1æ—¶ä»£"><a href="#1-2ã€Model1æ—¶ä»£" class="headerlink" title="1.2ã€Model1æ—¶ä»£"></a>1.2ã€Model1æ—¶ä»£</h3><ul>
<li>åœ¨webæ—©æœŸçš„å¼€å‘ä¸­ï¼Œé€šå¸¸é‡‡ç”¨çš„éƒ½æ˜¯Model1ã€‚</li>
<li>Model1ä¸­ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å±‚ï¼Œè§†å›¾å±‚å’Œæ¨¡å‹å±‚ã€‚</li>
</ul>
<p>Model1ä¼˜ç‚¹ï¼šæ¶æ„ç®€å•ï¼Œæ¯”è¾ƒé€‚åˆå°å‹é¡¹ç›®å¼€å‘ï¼›</p>
<p>Model1ç¼ºç‚¹ï¼šJSPèŒè´£ä¸å•ä¸€ï¼ŒèŒè´£è¿‡é‡ï¼Œä¸ä¾¿äºç»´æŠ¤ï¼›</p>
<h3 id="1-3ã€Model2æ—¶ä»£"><a href="#1-3ã€Model2æ—¶ä»£" class="headerlink" title="1.3ã€Model2æ—¶ä»£"></a>1.3ã€Model2æ—¶ä»£</h3><p>Model2æŠŠä¸€ä¸ªé¡¹ç›®åˆ†æˆä¸‰éƒ¨åˆ†ï¼ŒåŒ…æ‹¬<strong>è§†å›¾ã€æ§åˆ¶ã€æ¨¡å‹ã€‚</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309155009710.png" alt="image-20210309155009710"></p>
<ol>
<li>ç”¨æˆ·å‘è¯·æ±‚</li>
<li>Servletæ¥æ”¶è¯·æ±‚æ•°æ®ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•</li>
<li>ä¸šåŠ¡å¤„ç†å®Œæ¯•ï¼Œè¿”å›æ›´æ–°åçš„æ•°æ®ç»™servlet</li>
<li>servletè½¬å‘åˆ°JSPï¼Œç”±JSPæ¥æ¸²æŸ“é¡µé¢</li>
<li>å“åº”ç»™å‰ç«¯æ›´æ–°åçš„é¡µé¢</li>
</ol>
<p><strong>èŒè´£åˆ†æï¼š</strong></p>
<p><strong>Controllerï¼šæ§åˆ¶å™¨</strong></p>
<ol>
<li>å–å¾—è¡¨å•æ•°æ®</li>
<li>è°ƒç”¨ä¸šåŠ¡é€»è¾‘</li>
<li>è½¬å‘æŒ‡å®šçš„é¡µé¢</li>
</ol>
<p><strong>Modelï¼šæ¨¡å‹</strong></p>
<ol>
<li>ä¸šåŠ¡é€»è¾‘</li>
<li>ä¿å­˜æ•°æ®çš„çŠ¶æ€</li>
</ol>
<p><strong>Viewï¼šè§†å›¾</strong></p>
<ol>
<li>æ˜¾ç¤ºé¡µé¢</li>
</ol>
<p>Model2è¿™æ ·ä¸ä»…æé«˜çš„ä»£ç çš„å¤ç”¨ç‡ä¸é¡¹ç›®çš„æ‰©å±•æ€§ï¼Œä¸”å¤§å¤§é™ä½äº†é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬ã€‚Model 1æ¨¡å¼çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œé€‚ç”¨äºå¿«é€Ÿå¼€å‘å°è§„æ¨¡é¡¹ç›®ï¼ŒModel1ä¸­JSPé¡µé¢èº«å…¼Viewå’ŒControllerä¸¤ç§è§’è‰²ï¼Œå°†æ§åˆ¶é€»è¾‘å’Œè¡¨ç°é€»è¾‘æ··æ‚åœ¨ä¸€èµ·ï¼Œä»è€Œå¯¼è‡´ä»£ç çš„é‡ç”¨æ€§éå¸¸ä½ï¼Œå¢åŠ äº†åº”ç”¨çš„æ‰©å±•æ€§å’Œç»´æŠ¤çš„éš¾åº¦ã€‚Model2æ¶ˆé™¤äº†Model1çš„ç¼ºç‚¹ã€‚</p>
<h3 id="1-4ã€å›é¡¾Servlet"><a href="#1-4ã€å›é¡¾Servlet" class="headerlink" title="1.4ã€å›é¡¾Servlet"></a>1.4ã€å›é¡¾Servlet</h3><ol>
<li><p>æ–°å»ºä¸€ä¸ªMavenå·¥ç¨‹å½“åšçˆ¶å·¥ç¨‹ï¼pomä¾èµ–ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>å»ºç«‹ä¸€ä¸ªMoudleï¼šspringmvc-01-servlet ï¼Œ æ·»åŠ Web appçš„æ”¯æŒï¼</p>
</li>
<li><p>å¯¼å…¥servlet å’Œ jsp çš„ jar ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™ä¸€ä¸ªServletç±»ï¼Œç”¨æ¥å¤„ç†ç”¨æˆ·çš„è¯·æ±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.servlet;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ç°Servletæ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">       <span class="comment">//å–å¾—å‚æ•°</span></span><br><span class="line">       String method = req.getParameter(<span class="string">&quot;method&quot;</span>);</span><br><span class="line">       <span class="keyword">if</span> (method.equals(<span class="string">&quot;add&quot;</span>))&#123;</span><br><span class="line">           req.getSession().setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;æ‰§è¡Œäº†addæ–¹æ³•&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="keyword">if</span> (method.equals(<span class="string">&quot;delete&quot;</span>))&#123;</span><br><span class="line">           req.getSession().setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;æ‰§è¡Œäº†deleteæ–¹æ³•&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="comment">//ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">       <span class="comment">//è§†å›¾è·³è½¬</span></span><br><span class="line">       req.getRequestDispatcher(<span class="string">&quot;/WEB-INF/jsp/hello.jsp&quot;</span>).forward(req,resp);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">       doGet(req,resp);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™Hello.jspï¼Œåœ¨WEB-INFç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªjspçš„æ–‡ä»¶å¤¹ï¼Œæ–°å»ºhello.jsp</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>kangxiaozhuang<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">$&#123;msg&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨web.xmlä¸­æ³¨å†ŒServlet</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.zhuang.servlet.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/user<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>é…ç½®Tomcatï¼Œå¹¶å¯åŠ¨æµ‹è¯•</p>
<ul>
<li>localhost:8080/user?method=add</li>
<li>localhost:8080/user?method=delete</li>
</ul>
</li>
</ol>
<h2 id="2ã€ä»€ä¹ˆæ˜¯SpringMVC"><a href="#2ã€ä»€ä¹ˆæ˜¯SpringMVC" class="headerlink" title="2ã€ä»€ä¹ˆæ˜¯SpringMVC"></a>2ã€ä»€ä¹ˆæ˜¯SpringMVC</h2><h3 id="2-1ã€æ¦‚è¿°"><a href="#2-1ã€æ¦‚è¿°" class="headerlink" title="2.1ã€æ¦‚è¿°"></a>2.1ã€æ¦‚è¿°</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309155417639.png" alt="image-20210309155417639"></p>
<p><font color=red>Spring MVCæ˜¯Spring Frameworkçš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯åŸºäºJavaå®ç°MVCçš„è½»é‡çº§Webæ¡†æ¶ã€‚</font></p>
<p>æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.spring.io/spring/docs/5.2.0.RELEASE/spring-framework-reference/web.html#spring-web">https://docs.spring.io/spring/docs/5.2.0.RELEASE/spring-framework-reference/web.html#spring-web</a></p>
<p><strong>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å­¦ä¹ SpringMVCå‘¢?</strong></p>
<p> Spring MVCçš„ç‰¹ç‚¹ï¼š</p>
<ol>
<li>è½»é‡çº§ï¼Œç®€å•æ˜“å­¦</li>
<li>é«˜æ•ˆ , åŸºäºè¯·æ±‚å“åº”çš„MVCæ¡†æ¶</li>
<li>ä¸Springå…¼å®¹æ€§å¥½ï¼Œæ— ç¼ç»“åˆ</li>
<li>çº¦å®šä¼˜äºé…ç½®</li>
<li>åŠŸèƒ½å¼ºå¤§ï¼šRESTfulã€æ•°æ®éªŒè¯ã€æ ¼å¼åŒ–ã€æœ¬åœ°åŒ–ã€ä¸»é¢˜ç­‰</li>
<li>ç®€æ´çµæ´»</li>
</ol>
<p>Springçš„webæ¡†æ¶å›´ç»•<strong>DispatcherServlet</strong> [ è°ƒåº¦Servlet ] è®¾è®¡ã€‚</p>
<p>DispatcherServletçš„ä½œç”¨æ˜¯å°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„å¤„ç†å™¨ã€‚ä»Spring 2.5å¼€å§‹ï¼Œä½¿ç”¨Java 5æˆ–è€…ä»¥ä¸Šç‰ˆæœ¬çš„ç”¨æˆ·å¯ä»¥é‡‡ç”¨åŸºäºæ³¨è§£å½¢å¼è¿›è¡Œå¼€å‘ï¼Œååˆ†ç®€æ´ï¼›</p>
<p>æ­£å› ä¸ºSpringMVCå¥½ , ç®€å• , ä¾¿æ· , æ˜“å­¦ , å¤©ç”Ÿå’ŒSpringæ— ç¼é›†æˆ(ä½¿ç”¨SpringIoCå’ŒAop) , ä½¿ç”¨çº¦å®šä¼˜äºé…ç½® . èƒ½å¤Ÿè¿›è¡Œç®€å•çš„junitæµ‹è¯• . æ”¯æŒRestfulé£æ ¼ .å¼‚å¸¸å¤„ç† , æœ¬åœ°åŒ– , å›½é™…åŒ– , æ•°æ®éªŒè¯ , ç±»å‹è½¬æ¢ , æ‹¦æˆªå™¨ ç­‰ç­‰â€¦â€¦</p>
<h3 id="2-2ã€ä¸­å¿ƒæ§åˆ¶å™¨"><a href="#2-2ã€ä¸­å¿ƒæ§åˆ¶å™¨" class="headerlink" title="2.2ã€ä¸­å¿ƒæ§åˆ¶å™¨"></a>2.2ã€ä¸­å¿ƒæ§åˆ¶å™¨</h3><ul>
<li><p>Springçš„webæ¡†æ¶å›´ç»•DispatcherServletè®¾è®¡ã€‚DispatcherServletçš„ä½œç”¨æ˜¯å°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„å¤„ç†å™¨ã€‚ä»Spring 2.5å¼€å§‹ï¼Œä½¿ç”¨Java 5æˆ–è€…ä»¥ä¸Šç‰ˆæœ¬çš„ç”¨æˆ·å¯ä»¥é‡‡ç”¨åŸºäºæ³¨è§£çš„controllerå£°æ˜æ–¹å¼ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309155457801.png" alt="image-20210309155457801"></p>
<p>Spring MVCæ¡†æ¶åƒè®¸å¤šå…¶ä»–MVCæ¡†æ¶ä¸€æ ·, <strong>ä»¥è¯·æ±‚ä¸ºé©±åŠ¨</strong> , <strong>å›´ç»•ä¸€ä¸ªä¸­å¿ƒServletåˆ†æ´¾è¯·æ±‚åŠæä¾›å…¶ä»–åŠŸèƒ½</strong>ï¼Œ**DispatcherServletæ˜¯ä¸€ä¸ªå®é™…çš„Servlet (å®ƒç»§æ‰¿è‡ªHttpServlet åŸºç±»)**ã€‚</p>
</li>
<li><p>SpringMVCçš„åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p>å½“å‘èµ·è¯·æ±‚æ—¶è¢«å‰ç½®çš„æ§åˆ¶å™¨æ‹¦æˆªåˆ°è¯·æ±‚ï¼Œæ ¹æ®è¯·æ±‚å‚æ•°ç”Ÿæˆä»£ç†è¯·æ±‚ï¼Œæ‰¾åˆ°è¯·æ±‚å¯¹åº”çš„å®é™…æ§åˆ¶å™¨ï¼Œæ§åˆ¶å™¨å¤„ç†è¯·æ±‚ï¼Œåˆ›å»ºæ•°æ®æ¨¡å‹ï¼Œè®¿é—®æ•°æ®åº“ï¼Œå°†æ¨¡å‹å“åº”ç»™ä¸­å¿ƒæ§åˆ¶å™¨ï¼Œæ§åˆ¶å™¨ä½¿ç”¨æ¨¡å‹ä¸è§†å›¾æ¸²æŸ“è§†å›¾ç»“æœï¼Œå°†ç»“æœè¿”å›ç»™ä¸­å¿ƒæ§åˆ¶å™¨ï¼Œå†å°†ç»“æœè¿”å›ç»™è¯·æ±‚è€…ã€‚</p>
<p><font color=blue>åŸå›¾</font></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309155546138.png" alt="image-20210309155546138"></p>
</li>
</ul>
<p><font color=blue>ä¸­æ–‡å›¾</font></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309155615245.png" alt="image-20210309155615245"></p>
<h3 id="2-3ã€SpringMVCæ‰§è¡ŒåŸç†"><a href="#2-3ã€SpringMVCæ‰§è¡ŒåŸç†" class="headerlink" title="2.3ã€SpringMVCæ‰§è¡ŒåŸç†"></a>2.3ã€SpringMVCæ‰§è¡ŒåŸç†</h3><p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309155709092.png" alt="image-20210309155709092"></p>
<p>å›¾ä¸ºSpringMVCçš„ä¸€ä¸ªè¾ƒå®Œæ•´çš„æµç¨‹å›¾ï¼Œå®çº¿è¡¨ç¤ºSpringMVCæ¡†æ¶æä¾›çš„æŠ€æœ¯ï¼Œä¸éœ€è¦å¼€å‘è€…å®ç°ï¼Œè™šçº¿è¡¨ç¤ºéœ€è¦å¼€å‘è€…å®ç°ã€‚</p>
<p><strong>ç®€è¦åˆ†ææ‰§è¡Œæµç¨‹</strong></p>
<ol>
<li><p>DispatcherServletè¡¨ç¤ºå‰ç½®æ§åˆ¶å™¨ï¼Œæ˜¯æ•´ä¸ªSpringMVCçš„æ§åˆ¶ä¸­å¿ƒã€‚ç”¨æˆ·å‘å‡ºè¯·æ±‚ï¼ŒDispatcherServletæ¥æ”¶è¯·æ±‚å¹¶æ‹¦æˆªè¯·æ±‚ã€‚</p>
<ul>
<li><p>æˆ‘ä»¬å‡è®¾è¯·æ±‚çš„urlä¸º : <a href="http://localhost:8080/SpringMVC/hello">http://localhost:8080/SpringMVC/hello</a></p>
</li>
<li><p><strong>å¦‚ä¸Šurlæ‹†åˆ†æˆä¸‰éƒ¨åˆ†ï¼š</strong></p>
</li>
<li><p><a href="http://localhost:8080/">http://localhost:8080</a> â€”â€”&gt; æœåŠ¡å™¨åŸŸå</p>
</li>
<li><p>SpringMVC â€”â€”&gt; éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šçš„webç«™ç‚¹</p>
</li>
<li><p>hello â€”â€”&gt; è¡¨ç¤ºæ§åˆ¶å™¨</p>
</li>
<li><p>é€šè¿‡åˆ†æï¼Œå¦‚ä¸Šurlè¡¨ç¤ºä¸ºï¼šè¯·æ±‚ä½äºæœåŠ¡å™¨localhost:8080ä¸Šçš„SpringMVCç«™ç‚¹çš„helloæ§åˆ¶å™¨ã€‚</p>
</li>
</ul>
</li>
<li><p>HandlerMappingä¸ºå¤„ç†å™¨æ˜ å°„ã€‚DispatcherServletè°ƒç”¨HandlerMapping,HandlerMappingæ ¹æ®è¯·æ±‚urlæŸ¥æ‰¾Handlerã€‚</p>
</li>
<li><p>HandlerExecutionè¡¨ç¤ºå…·ä½“çš„Handler,å…¶ä¸»è¦ä½œç”¨æ˜¯æ ¹æ®urlæŸ¥æ‰¾æ§åˆ¶å™¨ï¼Œå¦‚ä¸Šurlè¢«æŸ¥æ‰¾æ§åˆ¶å™¨ä¸ºï¼šhelloã€‚</p>
</li>
<li><p>HandlerExecutionå°†è§£æåçš„ä¿¡æ¯ä¼ é€’ç»™DispatcherServlet,å¦‚è§£ææ§åˆ¶å™¨æ˜ å°„ç­‰ã€‚</p>
</li>
<li><p>HandlerAdapterè¡¨ç¤ºå¤„ç†å™¨é€‚é…å™¨ï¼Œå…¶æŒ‰ç…§ç‰¹å®šçš„è§„åˆ™å»æ‰§è¡ŒHandlerã€‚</p>
</li>
<li><p>Handlerè®©å…·ä½“çš„Controlleræ‰§è¡Œã€‚</p>
</li>
<li><p>Controllerå°†å…·ä½“çš„æ‰§è¡Œä¿¡æ¯è¿”å›ç»™HandlerAdapter,å¦‚ModelAndViewã€‚</p>
</li>
<li><p>HandlerAdapterå°†è§†å›¾é€»è¾‘åæˆ–æ¨¡å‹ä¼ é€’ç»™DispatcherServletã€‚</p>
</li>
<li><p>DispatcherServletè°ƒç”¨è§†å›¾è§£æå™¨(ViewResolver)æ¥è§£æHandlerAdapterä¼ é€’çš„é€»è¾‘è§†å›¾åã€‚</p>
</li>
<li><p>è§†å›¾è§£æå™¨å°†è§£æçš„é€»è¾‘è§†å›¾åä¼ ç»™DispatcherServletã€‚</p>
</li>
<li><p>DispatcherServletæ ¹æ®è§†å›¾è§£æå™¨è§£æçš„è§†å›¾ç»“æœï¼Œè°ƒç”¨å…·ä½“çš„è§†å›¾ã€‚</p>
</li>
<li><p>æœ€ç»ˆè§†å›¾å‘ˆç°ç»™ç”¨æˆ·ã€‚</p>
</li>
</ol>
<h2 id="3ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº"><a href="#3ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº" class="headerlink" title="3ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº"></a>3ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº</h2><h3 id="3-1ã€é…ç½®ç‰ˆ"><a href="#3-1ã€é…ç½®ç‰ˆ" class="headerlink" title="3.1ã€é…ç½®ç‰ˆ"></a>3.1ã€é…ç½®ç‰ˆ</h3><ol>
<li><p>æ–°å»ºä¸€ä¸ªMoudle ï¼Œ springmvc-02-hello ï¼Œ æ·»åŠ webçš„æ”¯æŒï¼</p>
</li>
<li><p>ç¡®å®šå¯¼å…¥äº†SpringMVC çš„ä¾èµ–ï¼</p>
</li>
<li><p>é…ç½®web.xml  ï¼Œ æ³¨å†ŒDispatcherServlet</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--1.æ³¨å†ŒDispatcherServlet--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--å…³è”ä¸€ä¸ªspringmvcçš„é…ç½®æ–‡ä»¶:ã€servlet-nameã€‘-servlet.xml--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--å¯åŠ¨çº§åˆ«-1--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--/ åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆä¸åŒ…æ‹¬.jspï¼‰--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--/* åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆåŒ…æ‹¬.jspï¼‰--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™SpringMVC çš„ é…ç½®æ–‡ä»¶ï¼åç§°ï¼šspringmvc-servlet.xml  : [servletname]-servlet.xml</p>
<p>è¯´æ˜ï¼Œè¿™é‡Œçš„åç§°è¦æ±‚æ˜¯æŒ‰ç…§å®˜æ–¹æ¥çš„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æ·»åŠ  å¤„ç†æ˜ å°„å™¨ï¼ˆå¯çœç•¥ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æ·»åŠ  å¤„ç†å™¨é€‚é…å™¨ï¼ˆå¯çœç•¥ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æ·»åŠ  è§†å›¾è§£æå™¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--è§†å›¾è§£æå™¨:DispatcherServletç»™ä»–çš„ModelAndView--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span> <span class="attr">id</span>=<span class="string">&quot;InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--å‰ç¼€--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--åç¼€--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™æˆ‘ä»¬è¦æ“ä½œä¸šåŠ¡Controller ï¼Œè¦ä¹ˆå®ç°Controlleræ¥å£ï¼Œè¦ä¹ˆå¢åŠ æ³¨è§£ï¼›éœ€è¦è¿”å›ä¸€ä¸ªModelAndViewï¼Œè£…æ•°æ®ï¼Œå°è§†å›¾ï¼›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> nuc.ss.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬å…ˆå¯¼å…¥Controlleræ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       <span class="comment">//ModelAndView æ¨¡å‹å’Œè§†å›¾</span></span><br><span class="line">       ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//å°è£…å¯¹è±¡ï¼Œæ”¾åœ¨ModelAndViewä¸­ã€‚Model</span></span><br><span class="line">       mv.addObject(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;HelloSpringMVC!&quot;</span>);</span><br><span class="line">       <span class="comment">//å°è£…è¦è·³è½¬çš„è§†å›¾ï¼Œæ”¾åœ¨ModelAndViewä¸­</span></span><br><span class="line">       mv.setViewName(<span class="string">&quot;hello&quot;</span>); <span class="comment">//: /WEB-INF/jsp/hello.jsp</span></span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>å°†è‡ªå·±çš„ç±»äº¤ç»™SpringIOCå®¹å™¨ï¼Œæ³¨å†Œbean</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--Handler--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;/hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.controller.HelloController&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>å†™è¦è·³è½¬çš„jspé¡µé¢ï¼Œæ˜¾ç¤ºModelandViewå­˜æ”¾çš„æ•°æ®ï¼Œä»¥åŠæˆ‘ä»¬çš„æ­£å¸¸é¡µé¢ï¼›</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>kangxiaozhuang<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">$&#123;msg&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>é…ç½®Tomcat å¯åŠ¨æµ‹è¯•ï¼</p>
</li>
</ol>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309160013771.png" alt="image-20210309160013771"></p>
<p><strong>å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼šè®¿é—®å‡ºç°404ï¼Œæ’æŸ¥æ­¥éª¤ï¼š</strong></p>
<ol>
<li>æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼Œçœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯ç¼ºå°‘äº†ä»€ä¹ˆjaråŒ…ã€‚</li>
<li>å¦‚æœjaråŒ…å­˜åœ¨ï¼Œæ˜¾ç¤ºæ— æ³•è¾“å‡ºï¼Œå°±åœ¨IDEAçš„é¡¹ç›®å‘å¸ƒä¸­ï¼Œæ·»åŠ libä¾èµ–ï¼</li>
<li>é‡å¯Tomcat å³å¯è§£å†³ï¼</li>
</ol>
<h3 id="3-2ã€æ³¨è§£ç‰ˆ"><a href="#3-2ã€æ³¨è§£ç‰ˆ" class="headerlink" title="3.2ã€æ³¨è§£ç‰ˆ"></a>3.2ã€æ³¨è§£ç‰ˆ</h3><ol>
<li><p><strong>æ–°å»ºä¸€ä¸ªMoudleï¼Œspringmvc-03-hello-annotation ã€‚æ·»åŠ webæ”¯æŒï¼</strong></p>
</li>
<li><p>ç”±äºMavenå¯èƒ½å­˜åœ¨èµ„æºè¿‡æ»¤çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°†é…ç½®å®Œå–„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨pom.xmlæ–‡ä»¶å¼•å…¥ç›¸å…³çš„ä¾èµ–ï¼šä¸»è¦æœ‰Springæ¡†æ¶æ ¸å¿ƒåº“ã€Spring MVCã€servlet , JSTLç­‰ã€‚æˆ‘ä»¬åœ¨çˆ¶ä¾èµ–ä¸­å·²ç»å¼•å…¥äº†ï¼</p>
</li>
<li><p><strong>é…ç½®web.xml</strong></p>
<p>æ³¨æ„ç‚¹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--1.æ³¨å†Œservlet--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›è¡Œå…³è”--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å¯åŠ¨é¡ºåºï¼Œæ•°å­—è¶Šå°ï¼Œå¯åŠ¨è¶Šæ—© --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«springmvcæ‹¦æˆª --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>/ å’Œ /* çš„åŒºåˆ«ï¼š</strong></p>
<ul>
<li>&lt; url-pattern &gt; / &lt;/ url-pattern &gt; ä¸ä¼šåŒ¹é…åˆ°.jspï¼Œ åªé’ˆå¯¹æˆ‘ä»¬ç¼–å†™çš„è¯·æ±‚ï¼›å³ï¼š.jsp ä¸ä¼šè¿›å…¥springçš„ DispatcherServletç±» ã€‚</li>
<li>&lt; url-pattern &gt; /* &lt;/ url-pattern &gt; ä¼šåŒ¹é… *.jspï¼Œä¼šå‡ºç°è¿”å› jspè§†å›¾ æ—¶å†æ¬¡è¿›å…¥springçš„DispatcherServlet ç±»ï¼Œå¯¼è‡´æ‰¾ä¸åˆ°å¯¹åº”çš„controlleræ‰€ä»¥æŠ¥404é”™ã€‚</li>
</ul>
</li>
<li><p><strong>æ·»åŠ Spring MVCé…ç½®æ–‡ä»¶</strong></p>
<p>åœ¨resourceç›®å½•ä¸‹æ·»åŠ springmvc-servlet.xmlé…ç½®æ–‡ä»¶ï¼Œé…ç½®çš„å½¢å¼ä¸Springå®¹å™¨é…ç½®åŸºæœ¬ç±»ä¼¼ï¼Œä¸ºäº†æ”¯æŒåŸºäºæ³¨è§£çš„IOCï¼Œè®¾ç½®äº†è‡ªåŠ¨æ‰«æåŒ…çš„åŠŸèƒ½ï¼Œå…·ä½“é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è‡ªåŠ¨æ‰«æåŒ…ï¼Œè®©æŒ‡å®šåŒ…ä¸‹çš„æ³¨è§£ç”Ÿæ•ˆ,ç”±IOCå®¹å™¨ç»Ÿä¸€ç®¡ç† --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.zhuang.controller&quot;</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- è®©Spring MVCä¸å¤„ç†é™æ€èµ„æº --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">   æ”¯æŒmvcæ³¨è§£é©±åŠ¨</span></span><br><span class="line"><span class="comment">       åœ¨springä¸­ä¸€èˆ¬é‡‡ç”¨@RequestMappingæ³¨è§£æ¥å®Œæˆæ˜ å°„å…³ç³»</span></span><br><span class="line"><span class="comment">       è¦æƒ³ä½¿@RequestMappingæ³¨è§£ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment">       å¿…é¡»å‘ä¸Šä¸‹æ–‡ä¸­æ³¨å†ŒDefaultAnnotationHandlerMapping</span></span><br><span class="line"><span class="comment">       å’Œä¸€ä¸ªAnnotationMethodHandlerAdapterå®ä¾‹</span></span><br><span class="line"><span class="comment">       è¿™ä¸¤ä¸ªå®ä¾‹åˆ†åˆ«åœ¨ç±»çº§åˆ«å’Œæ–¹æ³•çº§åˆ«å¤„ç†ã€‚</span></span><br><span class="line"><span class="comment">       è€Œannotation-drivené…ç½®å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨å®Œæˆä¸Šè¿°ä¸¤ä¸ªå®ä¾‹çš„æ³¨å…¥ã€‚</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">id</span>=<span class="string">&quot;internalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å‰ç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span> /&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- åç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>åœ¨è§†å›¾è§£æå™¨ä¸­æˆ‘ä»¬æŠŠæ‰€æœ‰çš„è§†å›¾éƒ½å­˜æ”¾åœ¨/WEB-INF/ç›®å½•ä¸‹ï¼Œè¿™æ ·å¯ä»¥ä¿è¯è§†å›¾å®‰å…¨ï¼Œå› ä¸ºè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥è®¿é—®ã€‚</p>
<ul>
<li>è®©IOCçš„æ³¨è§£ç”Ÿæ•ˆ</li>
<li>é™æ€èµ„æºè¿‡æ»¤ ï¼šHTML . JS . CSS . å›¾ç‰‡ ï¼Œ è§†é¢‘ â€¦..<ul>
<li>MVCçš„æ³¨è§£é©±åŠ¨</li>
<li>é…ç½®è§†å›¾è§£æå™¨</li>
</ul>
</li>
</ul>
<ol start="7">
<li><p><strong>åˆ›å»ºController</strong></p>
<p>ç¼–å†™ä¸€ä¸ªJavaæ§åˆ¶ç±»ï¼šcom.zhuang.controller.HelloController , æ³¨æ„ç¼–ç è§„èŒƒ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/HelloController&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//çœŸå®è®¿é—®åœ°å€ : é¡¹ç›®å/HelloController/hello</span></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">       <span class="comment">//å‘æ¨¡å‹ä¸­æ·»åŠ å±æ€§msgä¸å€¼ï¼Œå¯ä»¥åœ¨JSPé¡µé¢ä¸­å–å‡ºå¹¶æ¸²æŸ“</span></span><br><span class="line">       model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;hello,SpringMVC&quot;</span>);</span><br><span class="line">       <span class="comment">//web-inf/jsp/hello.jsp</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>@Controlleræ˜¯ä¸ºäº†è®©Spring IOCå®¹å™¨åˆå§‹åŒ–æ—¶è‡ªåŠ¨æ‰«æåˆ°ï¼›</li>
<li>@RequestMappingæ˜¯ä¸ºäº†æ˜ å°„è¯·æ±‚è·¯å¾„ï¼Œè¿™é‡Œå› ä¸ºç±»ä¸æ–¹æ³•ä¸Šéƒ½æœ‰æ˜ å°„æ‰€ä»¥è®¿é—®æ—¶åº”è¯¥æ˜¯/HelloController/helloï¼›</li>
<li>æ–¹æ³•ä¸­å£°æ˜Modelç±»å‹çš„å‚æ•°æ˜¯ä¸ºäº†æŠŠActionä¸­çš„æ•°æ®å¸¦åˆ°è§†å›¾ä¸­ï¼›</li>
<li>æ–¹æ³•è¿”å›çš„ç»“æœæ˜¯è§†å›¾çš„åç§°helloï¼ŒåŠ ä¸Šé…ç½®æ–‡ä»¶ä¸­çš„å‰åç¼€å˜æˆWEB-INF/jsp/<strong>hello</strong>.jsp</li>
</ul>
</li>
<li><p><strong>åˆ›å»ºè§†å›¾å±‚</strong></p>
<p>åœ¨WEB-INF/ jspç›®å½•ä¸­åˆ›å»ºhello.jsp ï¼Œ è§†å›¾å¯ä»¥ç›´æ¥å–å‡ºå¹¶å±•ç¤ºä»Controllerå¸¦å›çš„ä¿¡æ¯ï¼›</p>
<p>å¯ä»¥é€šè¿‡ELè¡¨ç¤ºå–å‡ºModelä¸­å­˜æ”¾çš„å€¼ï¼Œæˆ–è€…å¯¹è±¡ï¼›</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">$&#123;msg&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>é…ç½®Tomcatè¿è¡Œ</strong></p>
<p>é…ç½®Tomcat ï¼Œ  å¼€å¯æœåŠ¡å™¨ ï¼Œ è®¿é—® å¯¹åº”çš„è¯·æ±‚è·¯å¾„ï¼</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309160713973.png" alt="image-20210309160713973"></p>
<p><strong>OKï¼Œè¿è¡ŒæˆåŠŸï¼</strong></p>
</li>
</ol>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å®ç°æ­¥éª¤å…¶å®éå¸¸çš„ç®€å•ï¼š</p>
<ol>
<li>æ–°å»ºä¸€ä¸ªwebé¡¹ç›®</li>
<li>å¯¼å…¥ç›¸å…³jaråŒ…</li>
<li>ç¼–å†™web.xml , æ³¨å†ŒDispatcherServlet</li>
<li>ç¼–å†™springmvcé…ç½®æ–‡ä»¶</li>
<li>æ¥ä¸‹æ¥å°±æ˜¯å»åˆ›å»ºå¯¹åº”çš„æ§åˆ¶ç±» , controller</li>
<li>æœ€åå®Œå–„å‰ç«¯è§†å›¾å’Œcontrollerä¹‹é—´çš„å¯¹åº”</li>
<li>æµ‹è¯•è¿è¡Œè°ƒè¯•.</li>
</ol>
<p><font color=red>ä½¿ç”¨springMVCå¿…é¡»é…ç½®çš„ä¸‰å¤§ä»¶</font></p>
<p><strong><font color=red>å¤„ç†å™¨æ˜ å°„å™¨ã€å¤„ç†å™¨é€‚é…å™¨ã€è§†å›¾è§£æå™¨</font></strong></p>
<p><font color=red>é€šå¸¸ï¼Œæˆ‘ä»¬åªéœ€è¦<strong>æ‰‹åŠ¨é…ç½®è§†å›¾è§£æå™¨</strong>ï¼Œè€Œ<strong>å¤„ç†å™¨æ˜ å°„å™¨</strong>å’Œ<strong>å¤„ç†å™¨é€‚é…å™¨</strong>åªéœ€è¦å¼€å¯<strong>æ³¨è§£é©±åŠ¨</strong>å³å¯ï¼Œè€Œçœå»äº†å¤§æ®µçš„xmlé…ç½®</font></p>
<h2 id="4ã€RestFulå’Œæ§åˆ¶å™¨"><a href="#4ã€RestFulå’Œæ§åˆ¶å™¨" class="headerlink" title="4ã€RestFulå’Œæ§åˆ¶å™¨"></a>4ã€RestFulå’Œæ§åˆ¶å™¨</h2><h3 id="4-1ã€æ§åˆ¶å™¨Controller"><a href="#4-1ã€æ§åˆ¶å™¨Controller" class="headerlink" title="4.1ã€æ§åˆ¶å™¨Controller"></a>4.1ã€æ§åˆ¶å™¨Controller</h3><ul>
<li><p>æ§åˆ¶å™¨å¤æ‚æä¾›è®¿é—®åº”ç”¨ç¨‹åºçš„è¡Œä¸ºï¼Œé€šå¸¸é€šè¿‡æ¥å£å®šä¹‰æˆ–æ³¨è§£å®šä¹‰ä¸¤ç§æ–¹æ³•å®ç°ã€‚</p>
</li>
<li><p>æ§åˆ¶å™¨è´Ÿè´£è§£æç”¨æˆ·çš„è¯·æ±‚å¹¶å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªæ¨¡å‹ã€‚</p>
</li>
<li><p>åœ¨Spring MVCä¸­ä¸€ä¸ªæ§åˆ¶å™¨ç±»å¯ä»¥åŒ…å«å¤šä¸ªæ–¹æ³•</p>
</li>
<li><p>åœ¨Spring MVCä¸­ï¼Œå¯¹äºControllerçš„é…ç½®æ–¹å¼æœ‰å¾ˆå¤šç§</p>
</li>
</ul>
<h3 id="4-2ã€å®ç°Controlleræ¥å£"><a href="#4-2ã€å®ç°Controlleræ¥å£" class="headerlink" title="4.2ã€å®ç°Controlleræ¥å£"></a>4.2ã€å®ç°Controlleræ¥å£</h3><p>Controlleræ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨org.springframework.web.servlet.mvcåŒ…ä¸‹ï¼Œæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®ç°è¯¥æ¥å£çš„ç±»è·å¾—æ§åˆ¶å™¨åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">   <span class="comment">//å¤„ç†è¯·æ±‚ä¸”è¿”å›ä¸€ä¸ªæ¨¡å‹ä¸è§†å›¾å¯¹è±¡</span></span><br><span class="line">   <span class="function">ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest var1, HttpServletResponse var2)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>æµ‹è¯•</strong></p>
<ol>
<li><p>æ–°å»ºä¸€ä¸ªMoudleï¼Œspringmvc-04-controllerï¼</p>
</li>
<li><ul>
<li>mvcçš„é…ç½®æ–‡ä»¶åªç•™ä¸‹ è§†å›¾è§£æå™¨ï¼</li>
</ul>
</li>
<li><p>ç¼–å†™ä¸€ä¸ªControllerç±»ï¼ŒControllerTest1</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰æ§åˆ¶å™¨</span></span><br><span class="line"><span class="comment">//æ³¨æ„ç‚¹ï¼šä¸è¦å¯¼é”™åŒ…ï¼Œå®ç°Controlleræ¥å£ï¼Œé‡å†™æ–¹æ³•ï¼›</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ControllerTest1</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       <span class="comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">       ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">       mv.addObject(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;Test1Controller&quot;</span>);</span><br><span class="line">       mv.setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™å®Œæ¯•åï¼Œå»Springé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œè¯·æ±‚çš„beanï¼›nameå¯¹åº”è¯·æ±‚è·¯å¾„ï¼Œclasså¯¹åº”å¤„ç†è¯·æ±‚çš„ç±»</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;/t1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.controller.ControllerTest1&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™å‰ç«¯test.jspï¼Œæ³¨æ„åœ¨WEB-INF/jspç›®å½•ä¸‹ç¼–å†™ï¼Œå¯¹åº”æˆ‘ä»¬çš„è§†å›¾è§£æå™¨</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>kangxiaozhuang<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">$&#123;msg&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>é…ç½®Tomcatè¿è¡Œæµ‹è¯•ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰é¡¹ç›®å‘å¸ƒåé…ç½®çš„å°±æ˜¯ä¸€ä¸ª / ï¼Œæ‰€ä»¥è¯·æ±‚ä¸ç”¨åŠ é¡¹ç›®åï¼ŒOKï¼</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309161232765.png" alt="image-20210309161232765"></p>
</li>
</ol>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><p>å®ç°æ¥å£Controllerå®šä¹‰æ§åˆ¶å™¨æ˜¯è¾ƒè€çš„åŠæ³•</p>
</li>
<li><p>ç¼ºç‚¹æ˜¯ï¼šä¸€ä¸ªæ§åˆ¶å™¨ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœè¦å¤šä¸ªæ–¹æ³•åˆ™éœ€è¦å®šä¹‰å¤šä¸ªControllerï¼›å®šä¹‰çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼›</p>
</li>
</ul>
<h3 id="ä½¿ç”¨æ³¨è§£-Controller"><a href="#ä½¿ç”¨æ³¨è§£-Controller" class="headerlink" title="ä½¿ç”¨æ³¨è§£@Controller"></a>ä½¿ç”¨æ³¨è§£@Controller</h3><ul>
<li><p>@Controlleræ³¨è§£ç±»å‹ç”¨äºå£°æ˜Springç±»çš„å®ä¾‹æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆåœ¨è®²IOCæ—¶è¿˜æåˆ°äº†å¦å¤–3ä¸ªæ³¨è§£ï¼‰ï¼›</p>
</li>
<li><p>Springå¯ä»¥ä½¿ç”¨æ‰«ææœºåˆ¶æ¥æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­æ‰€æœ‰åŸºäºæ³¨è§£çš„æ§åˆ¶å™¨ç±»ï¼Œä¸ºäº†ä¿è¯Springèƒ½æ‰¾åˆ°ä½ çš„æ§åˆ¶å™¨ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å£°æ˜ç»„ä»¶æ‰«æã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„åŒ…ï¼Œä¸‹é¢æ‰€æœ‰æ³¨è§£ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.zhuang.controller&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>å¢åŠ ä¸€ä¸ªControllerTest2ç±»ï¼Œä½¿ç”¨æ³¨è§£å®ç°ï¼›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//@Controlleræ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨æ·»åŠ åˆ°Springä¸Šä¸‹æ–‡ä¸­</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ControllerTest2</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„</span></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/t2&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">       <span class="comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span></span><br><span class="line">       model.addAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;ControllerTest2&quot;</span>);</span><br><span class="line">       <span class="comment">//è¿”å›è§†å›¾ä½ç½®</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>è¿è¡Œtomcatæµ‹è¯•</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309161309453.png" alt="image-20210309161309453"></p>
</li>
</ul>
<p><strong>å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬çš„ä¸¤ä¸ªè¯·æ±‚éƒ½å¯ä»¥æŒ‡å‘ä¸€ä¸ªè§†å›¾(test)ï¼Œä½†æ˜¯é¡µé¢ç»“æœçš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºè§†å›¾æ˜¯è¢«å¤ç”¨çš„ï¼Œè€Œæ§åˆ¶å™¨ä¸è§†å›¾ä¹‹é—´æ˜¯å¼±å¶åˆå…³ç³»ã€‚</strong></p>
<h3 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="RequestMapping"></a>RequestMapping</h3><p><strong>@RequestMapping</strong></p>
<ul>
<li><p>@RequestMappingæ³¨è§£ç”¨äºæ˜ å°„urlåˆ°æ§åˆ¶å™¨ç±»æˆ–ä¸€ä¸ªç‰¹å®šçš„å¤„ç†ç¨‹åºæ–¹æ³•ã€‚å¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚</p>
</li>
<li><p>ä¸ºäº†æµ‹è¯•ç»“è®ºæ›´åŠ å‡†ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸Šä¸€ä¸ªé¡¹ç›®åæµ‹è¯• myweb</p>
</li>
<li><p>åªæ³¨è§£åœ¨æ–¹æ³•ä¸Šé¢</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/h1&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/">http://localhost:8080</a> / é¡¹ç›®å / h1</p>
</li>
<li><p>åŒæ—¶æ³¨è§£ç±»ä¸æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/h1&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/">http://localhost:8080</a> / é¡¹ç›®å/ admin /h1  , éœ€è¦å…ˆæŒ‡å®šç±»çš„è·¯å¾„å†æŒ‡å®šæ–¹æ³•çš„è·¯å¾„ï¼›</p>
</li>
</ul>
<h3 id="RestFul-é£æ ¼"><a href="#RestFul-é£æ ¼" class="headerlink" title="RestFul é£æ ¼"></a>RestFul é£æ ¼</h3><p><strong>æ¦‚å¿µ</strong></p>
<p>Restfulå°±æ˜¯ä¸€ä¸ªèµ„æºå®šä½åŠèµ„æºæ“ä½œçš„é£æ ¼ã€‚ä¸æ˜¯æ ‡å‡†ä¹Ÿä¸æ˜¯åè®®ï¼Œåªæ˜¯ä¸€ç§é£æ ¼ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚</p>
<p><strong>åŠŸèƒ½</strong></p>
<p>èµ„æºï¼šäº’è”ç½‘æ‰€æœ‰çš„äº‹ç‰©éƒ½å¯ä»¥è¢«æŠ½è±¡ä¸ºèµ„æº</p>
<p>èµ„æºæ“ä½œï¼šä½¿ç”¨POSTã€DELETEã€PUTã€GETï¼Œä½¿ç”¨ä¸åŒæ–¹æ³•å¯¹èµ„æºè¿›è¡Œæ“ä½œã€‚</p>
<p>åˆ†åˆ«å¯¹åº” æ·»åŠ ã€ åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥è¯¢ã€‚</p>
<p><strong>ä¼ ç»Ÿæ–¹å¼æ“ä½œèµ„æº</strong>  ï¼šé€šè¿‡ä¸åŒçš„å‚æ•°æ¥å®ç°ä¸åŒçš„æ•ˆæœï¼æ–¹æ³•å•ä¸€ï¼Œpost å’Œ get</p>
<pre><code>http://127.0.0.1/item/queryItem.action?id=1 æŸ¥è¯¢,GET

http://127.0.0.1/item/saveItem.action æ–°å¢,POST

http://127.0.0.1/item/updateItem.action æ›´æ–°,POST

http://127.0.0.1/item/deleteItem.action?id=1 åˆ é™¤,GETæˆ–POST
</code></pre>
<p><strong>ä½¿ç”¨RESTfulæ“ä½œèµ„æº</strong> ï¼šå¯ä»¥é€šè¿‡ä¸åŒçš„è¯·æ±‚æ–¹å¼æ¥å®ç°ä¸åŒçš„æ•ˆæœï¼å¦‚ä¸‹ï¼šè¯·æ±‚åœ°å€ä¸€æ ·ï¼Œä½†æ˜¯åŠŸèƒ½å¯ä»¥ä¸åŒï¼</p>
<table>
<thead>
<tr>
<th align="center">URL</th>
<th align="center">è¯·æ±‚æ–¹å¼</th>
<th align="center">ç»“æœ</th>
</tr>
</thead>
<tbody><tr>
<td align="center">/account/1</td>
<td align="center">HTTP GET</td>
<td align="center">å¾—åˆ°id=1çš„account</td>
</tr>
<tr>
<td align="center">/account/1</td>
<td align="center">HTTP DELETE</td>
<td align="center">åˆ é™¤id=1çš„account</td>
</tr>
<tr>
<td align="center">/account/1</td>
<td align="center">HTTP PUT</td>
<td align="center">æ›´æ–°id=1çš„account</td>
</tr>
<tr>
<td align="center">/account</td>
<td align="center">HTTP POST</td>
<td align="center">æ–°å¢account</td>
</tr>
</tbody></table>
<p><strong>å­¦ä¹ æµ‹è¯•</strong></p>
<ol>
<li><p>åœ¨æ–°å»ºä¸€ä¸ªç±» RestFulController</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestFulController</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨Spring MVCä¸­å¯ä»¥ä½¿ç”¨  @PathVariable æ³¨è§£ï¼Œè®©æ–¹æ³•å‚æ•°çš„å€¼å¯¹åº”ç»‘å®šåˆ°ä¸€ä¸ªURIæ¨¡æ¿å˜é‡ä¸Šã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestFulController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„</span></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/add/&#123;p1&#125;/&#123;p2&#125;&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">(<span class="meta">@PathVariable</span> <span class="keyword">int</span> p1, <span class="meta">@PathVariable</span> <span class="keyword">int</span> p2, Model model)</span></span>&#123;</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">int</span> result = p1+p2;</span><br><span class="line">       <span class="comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span></span><br><span class="line">       model.addAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;ç»“æœï¼š&quot;</span>+result);</span><br><span class="line">       <span class="comment">//è¿”å›è§†å›¾ä½ç½®</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">       </span><br><span class="line">  &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>æˆ‘ä»¬æ¥æµ‹è¯•è¯·æ±‚æŸ¥çœ‹ä¸‹</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309161734240.png" alt="image-20210309161734240"></p>
</li>
<li><p>æ€è€ƒï¼šä½¿ç”¨è·¯å¾„å˜é‡çš„å¥½å¤„ï¼Ÿ</p>
<ul>
<li><p>ä½¿è·¯å¾„å˜å¾—æ›´åŠ ç®€æ´ï¼›</p>
</li>
<li><p>è·å¾—å‚æ•°æ›´åŠ æ–¹ä¾¿ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ã€‚</p>
</li>
<li><p>é€šè¿‡è·¯å¾„å˜é‡çš„ç±»å‹å¯ä»¥çº¦æŸè®¿é—®å‚æ•°ï¼Œå¦‚æœç±»å‹ä¸ä¸€æ ·ï¼Œåˆ™è®¿é—®ä¸åˆ°å¯¹åº”çš„è¯·æ±‚æ–¹æ³•ï¼Œå¦‚è¿™é‡Œè®¿é—®æ˜¯çš„è·¯å¾„æ˜¯/add/1/aï¼Œåˆ™è·¯å¾„ä¸æ–¹æ³•ä¸åŒ¹é…ï¼Œè€Œä¸ä¼šæ˜¯å‚æ•°è½¬æ¢å¤±è´¥ã€‚</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309161744812.png" alt="image-20210309161744812"></p>
</li>
</ul>
</li>
<li><p>æˆ‘ä»¬æ¥ä¿®æ”¹ä¸‹å¯¹åº”çš„å‚æ•°ç±»å‹ï¼Œå†æ¬¡æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/add/&#123;p1&#125;/&#123;p2&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">(<span class="meta">@PathVariable</span> <span class="keyword">int</span> p1, <span class="meta">@PathVariable</span> String p2, Model model)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   String result = p1+p2;</span><br><span class="line">   <span class="comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span></span><br><span class="line">   model.addAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;ç»“æœï¼š&quot;</span>+result);</span><br><span class="line">   <span class="comment">//è¿”å›è§†å›¾ä½ç½®</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309161758326.png" alt="image-20210309161758326"></p>
</li>
</ol>
<p><strong>ä½¿ç”¨methodå±æ€§æŒ‡å®šè¯·æ±‚ç±»å‹</strong></p>
<p>ç”¨äºçº¦æŸè¯·æ±‚çš„ç±»å‹ï¼Œå¯ä»¥æ”¶çª„è¯·æ±‚èŒƒå›´ã€‚æŒ‡å®šè¯·æ±‚è°“è¯çš„ç±»å‹å¦‚GET, POST, HEAD, OPTIONS, PUT, PATCH, DELETE, TRACEç­‰</p>
<p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<ul>
<li><p>å¢åŠ ä¸€ä¸ªæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„,å¿…é¡»æ˜¯POSTè¯·æ±‚</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/hello&quot;,method = &#123;RequestMethod.POST&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">index2</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">   model.addAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;hello!&quot;</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨åœ°å€æ è¿›è¡Œè®¿é—®é»˜è®¤æ˜¯Getè¯·æ±‚ï¼Œä¼šæŠ¥é”™405ï¼š</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309161810788.png" alt="image-20210309161810788"></p>
</li>
<li><p>å¦‚æœå°†POSTä¿®æ”¹ä¸ºGETåˆ™æ­£å¸¸äº†ï¼›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„,å¿…é¡»æ˜¯Getè¯·æ±‚</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/hello&quot;,method = &#123;RequestMethod.GET&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">index2</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">   model.addAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;hello!&quot;</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\image-20210309161823143.png" alt="image-20210309161823143"></p>
</li>
</ul>
<p><strong>å°ç»“ï¼š</strong></p>
<p>Spring MVC çš„ @RequestMapping æ³¨è§£èƒ½å¤Ÿå¤„ç† HTTP è¯·æ±‚çš„æ–¹æ³•, æ¯”å¦‚ GET, PUT, POST, DELETE ä»¥åŠ PATCHã€‚</p>
<p><strong>æ‰€æœ‰çš„åœ°å€æ è¯·æ±‚é»˜è®¤éƒ½ä¼šæ˜¯ HTTP GET ç±»å‹çš„ã€‚</strong></p>
<p>æ–¹æ³•çº§åˆ«çš„æ³¨è§£å˜ä½“æœ‰å¦‚ä¸‹å‡ ä¸ªï¼šç»„åˆæ³¨è§£</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@GetMapping</span></span><br><span class="line"><span class="variable">@PostMapping</span></span><br><span class="line"><span class="variable">@PutMapping</span></span><br><span class="line"><span class="variable">@DeleteMapping</span></span><br><span class="line"><span class="variable">@PatchMapping</span></span><br></pre></td></tr></table></figure>

<p>@GetMapping æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œå¹³æ—¶ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šï¼</p>
<p>å®ƒæ‰€æ‰®æ¼”çš„æ˜¯ @RequestMapping(method =RequestMethod.GET) çš„ä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚</p>
<h2 id="5ã€ç»“æœè·³è½¬æ–¹å¼"><a href="#5ã€ç»“æœè·³è½¬æ–¹å¼" class="headerlink" title="5ã€ç»“æœè·³è½¬æ–¹å¼"></a>5ã€ç»“æœè·³è½¬æ–¹å¼</h2><h3 id="5-1ã€ModelAndView"><a href="#5-1ã€ModelAndView" class="headerlink" title="5.1ã€ModelAndView"></a>5.1ã€ModelAndView</h3><p>è®¾ç½®ModelAndViewå¯¹è±¡ , æ ¹æ®viewçš„åç§° , å’Œè§†å›¾è§£æå™¨è·³åˆ°æŒ‡å®šçš„é¡µé¢ .</p>
<p>é¡µé¢ : {è§†å›¾è§£æå™¨å‰ç¼€} + viewName +{è§†å›¾è§£æå™¨åç¼€}</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">id</span>=<span class="string">&quot;internalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- å‰ç¼€ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span> /&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- åç¼€ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„controllerç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ControllerTest1</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       <span class="comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">       ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">       mv.addObject(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;ControllerTest1&quot;</span>);</span><br><span class="line">       mv.setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2ã€ServletAPI"><a href="#5-2ã€ServletAPI" class="headerlink" title="5.2ã€ServletAPI"></a>5.2ã€ServletAPI</h3><p>ServletAPI</p>
<p>é€šè¿‡è®¾ç½®ServletAPI , ä¸éœ€è¦è§†å›¾è§£æå™¨ .</p>
<ol>
<li><p>é€šè¿‡HttpServletResponseè¿›è¡Œè¾“å‡º</p>
</li>
<li><p>é€šè¿‡HttpServletResponseå®ç°é‡å®šå‘</p>
</li>
<li><p>é€šè¿‡HttpServletResponseå®ç°è½¬å‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultGo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/result/t1&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       rsp.getWriter().println(<span class="string">&quot;Hello,Spring BY servlet API&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/result/t2&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       rsp.sendRedirect(<span class="string">&quot;/index.jsp&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/result/t3&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       <span class="comment">//è½¬å‘</span></span><br><span class="line">       req.setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;/result/t3&quot;</span>);</span><br><span class="line">       req.getRequestDispatcher(<span class="string">&quot;/WEB-INF/jsp/test.jsp&quot;</span>).forward(req,rsp);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="5-3ã€SpringMVC"><a href="#5-3ã€SpringMVC" class="headerlink" title="5.3ã€SpringMVC"></a>5.3ã€SpringMVC</h3><p><strong>é€šè¿‡SpringMVCæ¥å®ç°è½¬å‘å’Œé‡å®šå‘ - æ— éœ€è§†å›¾è§£æå™¨ï¼›</strong></p>
<p>æµ‹è¯•å‰ï¼Œéœ€è¦å°†è§†å›¾è§£æå™¨æ³¨é‡Šæ‰</p>
<ul>
<li>é»˜è®¤ä¸ºforwardè½¬å‘ï¼ˆ<font color=red>ä¹Ÿå¯ä»¥åŠ ä¸Š</font>ï¼‰</li>
<li>redirectè½¬å‘éœ€ç‰¹åˆ«åŠ </li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultSpringMVC</span> </span>&#123;</span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/rsm/t1&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//è½¬å‘</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/rsm/t2&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//è½¬å‘äºŒ</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;forward:/index.jsp&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/rsm/t3&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//é‡å®šå‘</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;redirect:/index.jsp&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€šè¿‡SpringMVCæ¥å®ç°è½¬å‘å’Œé‡å®šå‘ - æœ‰è§†å›¾è§£æå™¨ï¼›</strong></p>
<p>é‡å®šå‘ , ä¸éœ€è¦è§†å›¾è§£æå™¨ , æœ¬è´¨å°±æ˜¯é‡æ–°è¯·æ±‚ä¸€ä¸ªæ–°åœ°æ–¹å˜› , æ‰€ä»¥æ³¨æ„è·¯å¾„é—®é¢˜.</p>
<p>å¯ä»¥é‡å®šå‘åˆ°å¦å¤–ä¸€ä¸ªè¯·æ±‚å®ç° .</p>
<ul>
<li>é»˜è®¤ä¸ºforwardè½¬å‘ï¼ˆ<font color=red>ä¸å¯ä»¥åŠ ä¸Š</font>ï¼‰</li>
<li>redirectè½¬å‘éœ€ç‰¹åˆ«åŠ </li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultSpringMVC2</span> </span>&#123;</span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/rsm2/t1&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//è½¬å‘</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/rsm2/t2&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//é‡å®šå‘</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;redirect:/index.jsp&quot;</span>;</span><br><span class="line">       <span class="comment">//return &quot;redirect:hello.do&quot;; //hello.doä¸ºå¦ä¸€ä¸ªè¯·æ±‚/</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6ã€æ•°æ®å¤„ç†"><a href="#6ã€æ•°æ®å¤„ç†" class="headerlink" title="6ã€æ•°æ®å¤„ç†"></a>6ã€æ•°æ®å¤„ç†</h2><h3 id="6-1ã€å¤„ç†æäº¤æ•°æ®"><a href="#6-1ã€å¤„ç†æäº¤æ•°æ®" class="headerlink" title="6.1ã€å¤„ç†æäº¤æ•°æ®"></a>6.1ã€å¤„ç†æäº¤æ•°æ®</h3><p><strong>1ã€æäº¤çš„åŸŸåç§°å’Œå¤„ç†æ–¹æ³•çš„å‚æ•°åä¸€è‡´</strong></p>
<p>æäº¤æ•°æ® : <a href="http://localhost:8080/hello?name=kuangshen">http://localhost:8080/hello?name=kuangshen</a></p>
<p>å¤„ç†æ–¹æ³• :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åå°è¾“å‡º : kuangshen</p>
<p><strong>2ã€æäº¤çš„åŸŸåç§°å’Œå¤„ç†æ–¹æ³•çš„å‚æ•°åä¸ä¸€è‡´</strong></p>
<p>æäº¤æ•°æ® : <a href="http://localhost:8080/hello?username=kangxiaozhuang">http://localhost:8080/hello?username=kangxiaozhuang</a></p>
<p>å¤„ç†æ–¹æ³• :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//@RequestParam(&quot;username&quot;) : usernameæäº¤çš„åŸŸçš„åç§° .</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String name)</span></span>&#123;</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åå°è¾“å‡º : kangxiaozhuang</p>
<p><strong>3ã€æäº¤çš„æ˜¯ä¸€ä¸ªå¯¹è±¡</strong></p>
<p>è¦æ±‚æäº¤çš„è¡¨å•åŸŸå’Œå¯¹è±¡çš„å±æ€§åä¸€è‡´  , å‚æ•°ä½¿ç”¨å¯¹è±¡å³å¯</p>
<ol>
<li><p>å®ä½“ç±»</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">   <span class="comment">//æ„é€ </span></span><br><span class="line">   <span class="comment">//get/set</span></span><br><span class="line">   <span class="comment">//tostring()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>æäº¤æ•°æ® : <a href="http://localhost:8080/mvc04/user?name=kangxiaozhuang&amp;id=1&amp;age=15">http://localhost:8080/mvc04/user?name=kangxiaozhuang&amp;id=1&amp;age=15</a></p>
</li>
<li><p>å¤„ç†æ–¹æ³• :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">user</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">   System.out.println(user);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>åå°è¾“å‡º : User { id=1, name=â€™kangxiaozhuangâ€™, age=15 }</p>
<p>è¯´æ˜ï¼šå¦‚æœä½¿ç”¨å¯¹è±¡çš„è¯ï¼Œå‰ç«¯ä¼ é€’çš„<font color=red>å‚æ•°åå’Œå¯¹è±¡åå¿…é¡»ä¸€è‡´</font>ï¼Œå¦åˆ™å°±æ˜¯nullã€‚</p>
<h3 id="6-2ã€æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯"><a href="#6-2ã€æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯" class="headerlink" title="6.2ã€æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯"></a>6.2ã€æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯</h3><p><strong>ç¬¬ä¸€ç§ : é€šè¿‡ModelAndView</strong></p>
<p>æˆ‘ä»¬å‰é¢ä¸€ç›´éƒ½æ˜¯å¦‚æ­¤ . å°±ä¸è¿‡å¤šè§£é‡Š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ControllerTest1</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       <span class="comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">       ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">       mv.addObject(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;ControllerTest1&quot;</span>);</span><br><span class="line">       mv.setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒç§ : é€šè¿‡ModelMap</strong></p>
<p>ModelMap</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String name, ModelMap modelMap)</span></span>&#123;</span><br><span class="line">   <span class="comment">//å°è£…è¦æ˜¾ç¤ºåˆ°è§†å›¾ä¸­çš„æ•°æ®</span></span><br><span class="line">   <span class="comment">//ç›¸å½“äºreq.setAttribute(&quot;name&quot;,name);</span></span><br><span class="line">   modelMap.addAttribute(<span class="string">&quot;name&quot;</span>,name);</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬ä¸‰ç§ : é€šè¿‡Model</strong></p>
<p>Model</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/ct2/hello&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String name, Model model)</span></span>&#123;</span><br><span class="line">   <span class="comment">//å°è£…è¦æ˜¾ç¤ºåˆ°è§†å›¾ä¸­çš„æ•°æ®</span></span><br><span class="line">   <span class="comment">//ç›¸å½“äºreq.setAttribute(&quot;name&quot;,name);</span></span><br><span class="line">   model.addAttribute(<span class="string">&quot;msg&quot;</span>,name);</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3ã€å¯¹æ¯”"><a href="#6-3ã€å¯¹æ¯”" class="headerlink" title="6.3ã€å¯¹æ¯”"></a>6.3ã€å¯¹æ¯”</h3><p>å°±å¯¹äºæ–°æ‰‹è€Œè¨€ç®€å•æ¥è¯´ä½¿ç”¨åŒºåˆ«å°±æ˜¯ï¼š</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Model</span> åªæœ‰å¯¥å¯¥å‡ ä¸ªæ–¹æ³•åªé€‚åˆç”¨äºå‚¨å­˜æ•°æ®ï¼Œç®€åŒ–äº†æ–°æ‰‹å¯¹äº<span class="keyword">Model</span>å¯¹è±¡çš„æ“ä½œå’Œç†è§£ï¼›</span><br><span class="line">ModelMap ç»§æ‰¿äº† LinkedMap ï¼Œé™¤äº†å®ç°äº†è‡ªèº«çš„ä¸€äº›æ–¹æ³•ï¼ŒåŒæ ·çš„ç»§æ‰¿ LinkedMap çš„æ–¹æ³•å’Œç‰¹æ€§ï¼›</span><br><span class="line">ModelAndView å¯ä»¥åœ¨å‚¨å­˜æ•°æ®çš„åŒæ—¶ï¼Œå¯ä»¥è¿›è¡Œè®¾ç½®è¿”å›çš„é€»è¾‘è§†å›¾ï¼Œè¿›è¡Œæ§åˆ¶å±•ç¤ºå±‚çš„è·³è½¬ã€‚</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶æ›´å¤šçš„ä»¥åå¼€å‘è€ƒè™‘çš„æ›´å¤šçš„æ˜¯æ€§èƒ½å’Œä¼˜åŒ–ï¼Œå°±ä¸èƒ½å•å•ä»…é™äºæ­¤çš„äº†è§£ã€‚</p>
<h2 id="7ã€ä¹±ç é—®é¢˜"><a href="#7ã€ä¹±ç é—®é¢˜" class="headerlink" title="7ã€ä¹±ç é—®é¢˜"></a>7ã€ä¹±ç é—®é¢˜</h2><p>æµ‹è¯•æ­¥éª¤ï¼š</p>
<ol>
<li><p>æˆ‘ä»¬å¯ä»¥åœ¨é¦–é¡µç¼–å†™ä¸€ä¸ªæäº¤çš„è¡¨å•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/e/t&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>åå°ç¼–å†™å¯¹åº”çš„å¤„ç†ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Encoding</span> </span>&#123;</span><br><span class="line">   <span class="meta">@RequestMapping(&quot;/e/t&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(Model model,String name)</span></span>&#123;</span><br><span class="line">       model.addAttribute(<span class="string">&quot;msg&quot;</span>,name); <span class="comment">//è·å–è¡¨å•æäº¤çš„å€¼</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>; <span class="comment">//è·³è½¬åˆ°testé¡µé¢æ˜¾ç¤ºè¾“å…¥çš„å€¼</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>è¾“å…¥ä¸­æ–‡æµ‹è¯•ï¼Œå‘ç°ä¹±ç </p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309163334044.png" alt="image-20210309163334044"></p>
</li>
</ol>
<p>ä¸å¾—ä¸è¯´ï¼Œä¹±ç é—®é¢˜æ˜¯åœ¨æˆ‘ä»¬å¼€å‘ä¸­ååˆ†å¸¸è§çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯è®©æˆ‘ä»¬ç¨‹åºçŒ¿æ¯”è¾ƒå¤´å¤§çš„é—®é¢˜ï¼</p>
<p>ä»¥å‰ä¹±ç é—®é¢˜é€šè¿‡è¿‡æ»¤å™¨è§£å†³ , è€ŒSpringMVCç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè¿‡æ»¤å™¨ , å¯ä»¥åœ¨web.xmlä¸­é…ç½® .</p>
<p>ä¿®æ”¹äº†xmlæ–‡ä»¶éœ€è¦é‡å¯æœåŠ¡å™¨ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">filter&gt;</span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><font color=red>æ³¨æ„ï¼šè¿™é‡Œå†™/*ï¼Œå†™/çš„è¯è¿‡æ»¤ä¸äº†jspé¡µé¢ï¼Œä¸èƒ½è§£å†³ä¹±ç </font></p>
<p>ä½†æ˜¯æˆ‘ä»¬å‘ç° , æœ‰äº›æç«¯æƒ…å†µä¸‹.è¿™ä¸ªè¿‡æ»¤å™¨å¯¹getçš„æ”¯æŒä¸å¥½ .</p>
<p>å¤„ç†æ–¹æ³• :</p>
<ol>
<li><p>ä¿®æ”¹tomcaté…ç½®æ–‡ä»¶ ï¼šè®¾ç½®ç¼–ç ï¼</p>
 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">port</span>=<span class="string">&quot;8080&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼ˆä¸‡èƒ½è§£å†³ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequestWrapper;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* è§£å†³getå’Œpostè¯·æ±‚ å…¨éƒ¨ä¹±ç çš„è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericEncodingFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">       <span class="comment">//å¤„ç†responseçš„å­—ç¬¦ç¼–ç </span></span><br><span class="line">       HttpServletResponse myResponse=(HttpServletResponse) response;</span><br><span class="line">       myResponse.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// è½¬å‹ä¸ºä¸åè®®ç›¸å…³å¯¹è±¡</span></span><br><span class="line">       HttpServletRequest httpServletRequest = (HttpServletRequest) request;</span><br><span class="line">       <span class="comment">// å¯¹requeståŒ…è£…å¢å¼º</span></span><br><span class="line">       HttpServletRequest myrequest = <span class="keyword">new</span> MyRequest(httpServletRequest);</span><br><span class="line">       chain.doFilter(myrequest, response);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªå®šä¹‰requestå¯¹è±¡ï¼ŒHttpServletRequestçš„åŒ…è£…ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyRequest</span> <span class="keyword">extends</span> <span class="title">HttpServletRequestWrapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> HttpServletRequest request;</span><br><span class="line">   <span class="comment">//æ˜¯å¦ç¼–ç çš„æ ‡è®°</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">boolean</span> hasEncode;</span><br><span class="line">   <span class="comment">//å®šä¹‰ä¸€ä¸ªå¯ä»¥ä¼ å…¥HttpServletRequestå¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œè£…é¥°</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">MyRequest</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>(request);<span class="comment">// superå¿…é¡»å†™</span></span><br><span class="line">       <span class="keyword">this</span>.request = request;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// å¯¹éœ€è¦å¢å¼ºæ–¹æ³• è¿›è¡Œè¦†ç›–</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Map <span class="title">getParameterMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="comment">// å…ˆè·å¾—è¯·æ±‚æ–¹å¼</span></span><br><span class="line">       String method = request.getMethod();</span><br><span class="line">       <span class="keyword">if</span> (method.equalsIgnoreCase(<span class="string">&quot;post&quot;</span>)) &#123;</span><br><span class="line">           <span class="comment">// postè¯·æ±‚</span></span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               <span class="comment">// å¤„ç†postä¹±ç </span></span><br><span class="line">               request.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">               <span class="keyword">return</span> request.getParameterMap();</span><br><span class="line">          &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equalsIgnoreCase(<span class="string">&quot;get&quot;</span>)) &#123;</span><br><span class="line">           <span class="comment">// getè¯·æ±‚</span></span><br><span class="line">           Map&lt;String, String[]&gt; parameterMap = request.getParameterMap();</span><br><span class="line">           <span class="keyword">if</span> (!hasEncode) &#123; <span class="comment">// ç¡®ä¿getæ‰‹åŠ¨ç¼–ç é€»è¾‘åªè¿è¡Œä¸€æ¬¡</span></span><br><span class="line">               <span class="keyword">for</span> (String parameterName : parameterMap.keySet()) &#123;</span><br><span class="line">                   String[] values = parameterMap.get(parameterName);</span><br><span class="line">                   <span class="keyword">if</span> (values != <span class="keyword">null</span>) &#123;</span><br><span class="line">                       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; values.length; i++) &#123;</span><br><span class="line">                           <span class="keyword">try</span> &#123;</span><br><span class="line">                               <span class="comment">// å¤„ç†getä¹±ç </span></span><br><span class="line">                               values[i] = <span class="keyword">new</span> String(values[i]</span><br><span class="line">                                      .getBytes(<span class="string">&quot;ISO-8859-1&quot;</span>), <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                          &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">                               e.printStackTrace();</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">               hasEncode = <span class="keyword">true</span>;</span><br><span class="line">          &#125;</span><br><span class="line">           <span class="keyword">return</span> parameterMap;</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">super</span>.getParameterMap();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å–ä¸€ä¸ªå€¼</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">getParameter</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">       Map&lt;String, String[]&gt; parameterMap = getParameterMap();</span><br><span class="line">       String[] values = parameterMap.get(name);</span><br><span class="line">       <span class="keyword">if</span> (values == <span class="keyword">null</span>) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="keyword">return</span> values[<span class="number">0</span>]; <span class="comment">// å–å›å‚æ•°çš„ç¬¬ä¸€ä¸ªå€¼</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å–æ‰€æœ‰å€¼</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> String[] getParameterValues(String name) &#123;</span><br><span class="line">       Map&lt;String, String[]&gt; parameterMap = getParameterMap();</span><br><span class="line">       String[] values = parameterMap.get(name);</span><br><span class="line">       <span class="keyword">return</span> values;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSpringMVCé»˜è®¤çš„ä¹±ç å¤„ç†å°±å·²ç»èƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³äº†ï¼</p>
<p><strong>ç„¶ååœ¨web.xmlä¸­é…ç½®è¿™ä¸ªè¿‡æ»¤å™¨å³å¯ï¼</strong></p>
<p>ä¹±ç é—®é¢˜ï¼Œéœ€è¦å¹³æ—¶å¤šæ³¨æ„ï¼Œåœ¨å°½å¯èƒ½èƒ½è®¾ç½®ç¼–ç çš„åœ°æ–¹ï¼Œéƒ½è®¾ç½®ä¸ºç»Ÿä¸€ç¼–ç  UTF-8ï¼</p>
</li>
</ol>
<h2 id="8ã€Jsonäº¤äº’å¤„ç†"><a href="#8ã€Jsonäº¤äº’å¤„ç†" class="headerlink" title="8ã€Jsonäº¤äº’å¤„ç†"></a>8ã€Jsonäº¤äº’å¤„ç†</h2><h3 id="8-1ã€ä»€ä¹ˆæ˜¯JSONï¼Ÿ"><a href="#8-1ã€ä»€ä¹ˆæ˜¯JSONï¼Ÿ" class="headerlink" title="8.1ã€ä»€ä¹ˆæ˜¯JSONï¼Ÿ"></a>8.1ã€ä»€ä¹ˆæ˜¯JSONï¼Ÿ</h3><ul>
<li>JSON(JavaScript Object Notation, JS å¯¹è±¡æ ‡è®°) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œç›®å‰ä½¿ç”¨ç‰¹åˆ«å¹¿æ³›ã€‚</li>
<li>é‡‡ç”¨å®Œå…¨ç‹¬ç«‹äºç¼–ç¨‹è¯­è¨€çš„<strong>æ–‡æœ¬æ ¼å¼</strong>æ¥å­˜å‚¨å’Œè¡¨ç¤ºæ•°æ®ã€‚</li>
<li>ç®€æ´å’Œæ¸…æ™°çš„å±‚æ¬¡ç»“æ„ä½¿å¾— JSON æˆä¸ºç†æƒ³çš„æ•°æ®äº¤æ¢è¯­è¨€ã€‚</li>
<li>æ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆï¼Œå¹¶æœ‰æ•ˆåœ°æå‡ç½‘ç»œä¼ è¾“æ•ˆç‡ã€‚</li>
</ul>
<p>åœ¨ JavaScript è¯­è¨€ä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ã€‚å› æ­¤ï¼Œä»»ä½•JavaScript æ”¯æŒçš„ç±»å‹éƒ½å¯ä»¥é€šè¿‡ JSON æ¥è¡¨ç¤ºï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ã€æ•°ç»„ç­‰ã€‚çœ‹çœ‹ä»–çš„è¦æ±‚å’Œè¯­æ³•æ ¼å¼ï¼š</p>
<ul>
<li>å¯¹è±¡è¡¨ç¤ºä¸ºé”®å€¼å¯¹ï¼Œæ•°æ®ç”±é€—å·åˆ†éš”</li>
<li>èŠ±æ‹¬å·ä¿å­˜å¯¹è±¡</li>
<li>æ–¹æ‹¬å·ä¿å­˜æ•°ç»„</li>
</ul>
<p><strong>JSON é”®å€¼å¯¹</strong>æ˜¯ç”¨æ¥ä¿å­˜ JavaScript å¯¹è±¡çš„ä¸€ç§æ–¹å¼ï¼Œå’Œ JavaScript å¯¹è±¡çš„å†™æ³•ä¹Ÿå¤§åŒå°å¼‚ï¼Œé”®/å€¼å¯¹ç»„åˆä¸­çš„é”®åå†™åœ¨å‰é¢å¹¶ç”¨åŒå¼•å· â€œâ€ åŒ…è£¹ï¼Œä½¿ç”¨å†’å· : åˆ†éš”ï¼Œç„¶åç´§æ¥ç€å€¼ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;QinJiang&quot;</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;age&quot;</span>: <span class="string">&quot;3&quot;</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;sex&quot;</span>: <span class="string">&quot;ç”·&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>å¾ˆå¤šäººæä¸æ¸…æ¥š JSON å’Œ JavaScript å¯¹è±¡çš„å…³ç³»ï¼Œç”šè‡³è¿è°æ˜¯è°éƒ½ä¸æ¸…æ¥šã€‚å…¶å®ï¼Œå¯ä»¥è¿™ä¹ˆç†è§£ï¼š</p>
<p>JSON æ˜¯ JavaScript å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºæ³•ï¼Œå®ƒä½¿ç”¨æ–‡æœ¬è¡¨ç¤ºä¸€ä¸ª JS å¯¹è±¡çš„ä¿¡æ¯ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>: <span class="string">&#x27;Hello&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;World&#x27;</span>&#125;; <span class="comment">//è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ³¨æ„é”®åä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨å¼•å·åŒ…è£¹çš„</span></span><br><span class="line"><span class="keyword">var</span> json = <span class="string">&#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span>; <span class="comment">//è¿™æ˜¯ä¸€ä¸ª JSON å­—ç¬¦ä¸²ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2ã€JSON-å’Œ-JavaScript-å¯¹è±¡äº’è½¬"><a href="#8-2ã€JSON-å’Œ-JavaScript-å¯¹è±¡äº’è½¬" class="headerlink" title="8.2ã€JSON å’Œ JavaScript å¯¹è±¡äº’è½¬"></a>8.2ã€<strong>JSON å’Œ JavaScript å¯¹è±¡äº’è½¬</strong></h3><p>è¦å®ç°ä»JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºJavaScript å¯¹è±¡ï¼Œä½¿ç”¨ JSON.parse() æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">JSON</span>.parse(<span class="string">&#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span>);</span><br><span class="line"><span class="comment">//ç»“æœæ˜¯ &#123;a: &#x27;Hello&#x27;, b: &#x27;World&#x27;&#125;</span></span><br></pre></td></tr></table></figure>

<p>è¦å®ç°ä»JavaScript å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ JSON.stringify() æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> json = <span class="built_in">JSON</span>.stringify(&#123;<span class="attr">a</span>: <span class="string">&#x27;Hello&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;World&#x27;</span>&#125;);</span><br><span class="line"><span class="comment">//ç»“æœæ˜¯ &#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>ä»£ç æµ‹è¯•</strong></p>
<ol>
<li><p>æ–°å»ºä¸€ä¸ªmodule ï¼Œspringmvc-05-json ï¼Œ æ·»åŠ webçš„æ”¯æŒ</p>
</li>
<li><p>åœ¨webç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª json-1.html ï¼Œ ç¼–å†™æµ‹è¯•å†…å®¹</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>kangxiaozhuang<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">   <span class="comment">//ç¼–å†™ä¸€ä¸ªjsçš„å¯¹è±¡</span></span></span><br><span class="line"><span class="javascript">   <span class="keyword">var</span> user = &#123;</span></span><br><span class="line"><span class="javascript">       name:<span class="string">&quot;å¼ ä¸‰&quot;</span>,</span></span><br><span class="line">       age:3,</span><br><span class="line"><span class="javascript">       sex:<span class="string">&quot;ç”·&quot;</span></span></span><br><span class="line">  &#125;;</span><br><span class="line"><span class="javascript">   <span class="comment">//å°†jså¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²</span></span></span><br><span class="line"><span class="javascript">   <span class="keyword">var</span> str = <span class="built_in">JSON</span>.stringify(user);</span></span><br><span class="line"><span class="javascript">   <span class="built_in">console</span>.log(str);</span></span><br><span class="line">   </span><br><span class="line"><span class="javascript">   <span class="comment">//å°†jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºjså¯¹è±¡</span></span></span><br><span class="line"><span class="javascript">   <span class="keyword">var</span> user2 = <span class="built_in">JSON</span>.parse(str);</span></span><br><span class="line"><span class="javascript">   <span class="built_in">console</span>.log(user2.age,user2.name,user2.sex);</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨IDEAä¸­ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼</p>
</li>
</ol>
<h3 id="8-3ã€Controllerè¿”å›JSONæ•°æ®"><a href="#8-3ã€Controllerè¿”å›JSONæ•°æ®" class="headerlink" title="8.3ã€Controllerè¿”å›JSONæ•°æ®"></a>8.3ã€Controllerè¿”å›JSONæ•°æ®</h3><ul>
<li><p>Jacksonåº”è¯¥æ˜¯ç›®å‰æ¯”è¾ƒå¥½çš„jsonè§£æå·¥å…·äº†</p>
</li>
<li><p>å½“ç„¶å·¥å…·ä¸æ­¢è¿™ä¸€ä¸ªï¼Œæ¯”å¦‚è¿˜æœ‰é˜¿é‡Œå·´å·´çš„ fastjson ç­‰ç­‰ã€‚</p>
</li>
<li><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨Jacksonï¼Œä½¿ç”¨å®ƒéœ€è¦å¯¼å…¥å®ƒçš„jaråŒ…ï¼›</p>
  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>é…ç½®SpringMVCéœ€è¦çš„é…ç½®</p>
<ul>
<li><p>ï¼ˆweb.xmlï¼‰</p>
  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--1.æ³¨å†Œservlet--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›è¡Œå…³è”--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å¯åŠ¨é¡ºåºï¼Œæ•°å­—è¶Šå°ï¼Œå¯åŠ¨è¶Šæ—© --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«springmvcæ‹¦æˆª --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>springmvc-servlet.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„åŒ…ï¼Œä¸‹é¢æ‰€æœ‰æ³¨è§£ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç† --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.zhuang.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">id</span>=<span class="string">&quot;internalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å‰ç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span> /&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- åç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>æˆ‘ä»¬éšä¾¿ç¼–å†™ä¸€ä¸ªUserçš„å®ä½“ç±»ï¼Œç„¶åæˆ‘ä»¬å»ç¼–å†™æˆ‘ä»¬çš„æµ‹è¯•Controllerï¼›</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
<li><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ–°ä¸œè¥¿ï¼Œä¸€ä¸ªæ˜¯@ResponseBodyï¼Œä¸€ä¸ªæ˜¯ObjectMapperå¯¹è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸‹å…·ä½“çš„ç”¨æ³•</p>
<p>ç¼–å†™ä¸€ä¸ªControllerï¼›</p>
   <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/j1&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span><span class="comment">//ä»–å°±ä¸ä¼šèµ°è§†å›¾è§£æå™¨ï¼Œä¼šç›´æ¥è¿”å›ä¸€ä¸ª å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">json1</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line">        <span class="comment">//jackson,ObjectMapper</span></span><br><span class="line">        ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">&quot;å¼ ä¸‰ä¸€å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">        <span class="comment">//System.out.println(user);</span></span><br><span class="line"></span><br><span class="line">        String str = mapper.writeValueAsString(user);</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>æ­¤æ—¶è¾“å…¥ä¸­æ–‡ä¼šäº§ç”Ÿä¹±ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//produces:æŒ‡å®šå“åº”ä½“è¿”å›ç±»å‹å’Œç¼–ç </span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/json1&quot;,produces = &quot;application/json;charset=utf-8&quot;)</span></span><br></pre></td></tr></table></figure></li>
<li><p>é…ç½®Tomcat ï¼Œ å¯åŠ¨æµ‹è¯•ä¸€ä¸‹ï¼<a href="http://localhost:8080/json1">http://localhost:8080/json1</a></p>
</li>
</ul>
</li>
</ul>
<p><font color=red>ã€æ³¨æ„ï¼šä½¿ç”¨jsonè®°å¾—å¤„ç†ä¹±ç é—®é¢˜ã€‘</font></p>
<h3 id="8-4ä»£ç ä¼˜åŒ–"><a href="#8-4ä»£ç ä¼˜åŒ–" class="headerlink" title="8.4ä»£ç ä¼˜åŒ–"></a>8.4ä»£ç ä¼˜åŒ–</h3><p><strong>ä¹±ç ç»Ÿä¸€è§£å†³</strong></p>
<p>ä¸Šä¸€ç§æ–¹æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœé¡¹ç›®ä¸­æœ‰è®¸å¤šè¯·æ±‚åˆ™æ¯ä¸€ä¸ªéƒ½è¦æ·»åŠ ï¼Œå¯ä»¥é€šè¿‡Springé…ç½®ç»Ÿä¸€æŒ‡å®šï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éƒ½å»å¤„ç†äº†ï¼</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨springmvcçš„é…ç½®æ–‡ä»¶ä¸Šæ·»åŠ ä¸€æ®µæ¶ˆæ¯StringHttpMessageConverterè½¬æ¢é…ç½®ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;objectMapper&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;failOnEmptyBeans&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>è¿”å›jsonå­—ç¬¦ä¸²ç»Ÿä¸€è§£å†³</strong></p>
<ul>
<li><p>@ResponseBodyè§£å†³ï¼ˆæ¯ä¸ªæ–¹æ³•éƒ½å¾—åŠ ï¼Œä¸å»ºè®®ä½¿ç”¨ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">   <span class="comment">//produces:æŒ‡å®šå“åº”ä½“è¿”å›ç±»å‹å’Œç¼–ç </span></span><br><span class="line">   <span class="meta">@RequestMapping(value = &quot;/json1&quot;)</span></span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">json1</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span></span><br><span class="line">       ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">       User user = <span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">&quot;å¼ ä¸‰ä¸€å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">       <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">       String str = mapper.writeValueAsString(user);</span><br><span class="line">       <span class="comment">//ç”±äº@ResponseBodyæ³¨è§£ï¼Œè¿™é‡Œä¼šå°†strè½¬æˆjsonæ ¼å¼è¿”å›ï¼›ååˆ†æ–¹ä¾¿</span></span><br><span class="line">       <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>@RestController</strong>ï¼ˆç›´æ¥åŠ åˆ°ç±»ä¸Šå³å¯ï¼‰</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">   <span class="meta">@RequestMapping(value = &quot;/j1&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">json1</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span></span><br><span class="line">       ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">       User user = <span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">&quot;å¼ ä¸‰ä¸€å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">       <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">       String str = mapper.writeValueAsString(user);</span><br><span class="line">       <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="8-5ã€æµ‹è¯•é›†åˆè¾“å‡º"><a href="#8-5ã€æµ‹è¯•é›†åˆè¾“å‡º" class="headerlink" title="8.5ã€æµ‹è¯•é›†åˆè¾“å‡º"></a>8.5ã€æµ‹è¯•é›†åˆè¾“å‡º</h3><p>å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/j2&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">json2</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span></span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">   	User user1 = <span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">&quot;å¼ ä¸‰1å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">    User user2 = <span class="keyword">new</span> User(<span class="number">2</span>, <span class="string">&quot;å¼ ä¸‰2å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">    User user3 = <span class="keyword">new</span> User(<span class="number">3</span>, <span class="string">&quot;å¼ ä¸‰3å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">    User user4 = <span class="keyword">new</span> User(<span class="number">4</span>, <span class="string">&quot;å¼ ä¸‰4å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">    User user5 = <span class="keyword">new</span> User(<span class="number">5</span>, <span class="string">&quot;å¼ ä¸‰5å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">    List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">    list.add(user1);</span><br><span class="line">    list.add(user2);</span><br><span class="line">    list.add(user3);</span><br><span class="line">    list.add(user4);</span><br><span class="line">    list.add(user5);</span><br><span class="line">    <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">    String str = mapper.writeValueAsString(list);</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ : ååˆ†å®Œç¾ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼</p>
<h3 id="8-6ã€è¾“å‡ºæ—¶é—´å¯¹è±¡"><a href="#8-6ã€è¾“å‡ºæ—¶é—´å¯¹è±¡" class="headerlink" title="8.6ã€è¾“å‡ºæ—¶é—´å¯¹è±¡"></a>8.6ã€è¾“å‡ºæ—¶é—´å¯¹è±¡</h3><ul>
<li><p>å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/j3&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">json3</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line"></span><br><span class="line">   ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">   <span class="comment">//åˆ›å»ºæ—¶é—´ä¸€ä¸ªå¯¹è±¡ï¼Œjava.util.Date</span></span><br><span class="line">   Date date = <span class="keyword">new</span> Date();</span><br><span class="line">   <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">   String str = mapper.writeValueAsString(date);</span><br><span class="line">   <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>è¿è¡Œç»“æœ :</p>
<p>  <img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309163701099.png" alt="image-20210309163710250"></p>
</li>
<li><p>é»˜è®¤æ—¥æœŸæ ¼å¼ä¼šå˜æˆä¸€ä¸ªæ•°å­—ï¼Œæ˜¯1970å¹´1æœˆ1æ—¥åˆ°å½“å‰æ—¥æœŸçš„æ¯«ç§’æ•°ï¼</p>
</li>
<li><p>Jackson é»˜è®¤æ˜¯ä¼šæŠŠæ—¶é—´è½¬æˆtimestampså½¢å¼</p>
</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šå–æ¶ˆtimestampså½¢å¼ ï¼Œ è‡ªå®šä¹‰æ—¶é—´æ ¼å¼</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/j3&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">json4</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line"></span><br><span class="line">   ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ä¸ä½¿ç”¨æ—¶é—´æˆ³çš„æ–¹å¼</span></span><br><span class="line">   mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, <span class="keyword">false</span>);</span><br><span class="line">   <span class="comment">//è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼å¯¹è±¡</span></span><br><span class="line">   SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">   <span class="comment">//æŒ‡å®šæ—¥æœŸæ ¼å¼</span></span><br><span class="line">   mapper.setDateFormat(sdf);</span><br><span class="line"></span><br><span class="line">   Date date = <span class="keyword">new</span> Date();</span><br><span class="line">   String str = mapper.writeValueAsString(date);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ : æˆåŠŸçš„è¾“å‡ºäº†æ—¶é—´ï¼</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309163731796.png" alt="image-20210309163731796"></p>
<p><strong><font color=red>æŠ½å–ä¸ºå·¥å…·ç±»</font></strong></p>
<p><strong>å¦‚æœè¦ç»å¸¸ä½¿ç”¨çš„è¯ï¼Œè¿™æ ·æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä»£ç å°è£…åˆ°ä¸€ä¸ªå·¥å…·ç±»ä¸­ï¼›æˆ‘ä»¬å»ç¼–å†™ä¸‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonUtils</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getJson</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getJson(object,<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getJson</span><span class="params">(Object object, String dateFormat)</span> </span>&#123;</span><br><span class="line">        ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//javaè‡ªå®šä¹‰æ—¥æœŸæ ¼å¼</span></span><br><span class="line">        SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(dateFormat);</span><br><span class="line">        <span class="comment">//sdf.format(date)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨ObjectMapper æ¥æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line">        mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS,<span class="keyword">false</span>);</span><br><span class="line">        mapper.setDateFormat(sdf);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//ObjectMapper,æ—¶é—´è§£æåçš„é»˜è®¤æ ¼å¼ä¸ºï¼šTImestamp.æ—¶é—´æˆ³</span></span><br><span class="line">            <span class="keyword">return</span> mapper.writeValueAsString(object);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä½¿ç”¨å·¥å…·ç±»ï¼Œä»£ç å°±æ›´åŠ ç®€æ´äº†ï¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/j3&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">json3</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        Date date = <span class="keyword">new</span> Date();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JsonUtils.getJson(date,<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§åŠŸå‘Šæˆï¼å®Œç¾ï¼</p>
<h3 id="8-7ã€FastJson"><a href="#8-7ã€FastJson" class="headerlink" title="8.7ã€FastJson"></a>8.7ã€FastJson</h3><ul>
<li>fastjson.jaræ˜¯é˜¿é‡Œå¼€å‘çš„ä¸€æ¬¾ä¸“é—¨ç”¨äºJavaå¼€å‘çš„åŒ…ï¼Œ</li>
<li>å®ç°jsonå¯¹è±¡ä¸JavaBeanå¯¹è±¡çš„è½¬æ¢ï¼Œ</li>
<li>å®ç°JavaBeanå¯¹è±¡ä¸jsonå­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œ</li>
<li>å®ç°jsonå¯¹è±¡ä¸jsonå­—ç¬¦ä¸²çš„è½¬æ¢ã€‚</li>
<li>å®ç°jsonçš„è½¬æ¢æ–¹æ³•å¾ˆå¤šï¼Œæœ€åçš„å®ç°ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>
</ul>
<p>fastjson çš„ pomä¾èµ–ï¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.60<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>fastjson ä¸‰ä¸ªä¸»è¦çš„ç±»ï¼š</strong></p>
<ol>
<li>JSONObject  ä»£è¡¨ json å¯¹è±¡<ul>
<li>JSONObjectå®ç°äº†Mapæ¥å£, çŒœæƒ³ JSONObjectåº•å±‚æ“ä½œæ˜¯ç”±Mapå®ç°çš„ã€‚</li>
<li>JSONObjectå¯¹åº”jsonå¯¹è±¡ï¼Œé€šè¿‡å„ç§å½¢å¼çš„get()æ–¹æ³•å¯ä»¥è·å–jsonå¯¹è±¡ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯åˆ©ç”¨è¯¸å¦‚size()ï¼ŒisEmpty()ç­‰æ–¹æ³•è·å–â€é”®ï¼šå€¼â€å¯¹çš„ä¸ªæ•°å’Œåˆ¤æ–­æ˜¯å¦ä¸ºç©ºã€‚å…¶æœ¬è´¨æ˜¯é€šè¿‡å®ç°Mapæ¥å£å¹¶è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•å®Œæˆçš„ã€‚</li>
</ul>
</li>
<li>JSONArray   ä»£è¡¨ json å¯¹è±¡æ•°ç»„<ul>
<li>å†…éƒ¨æ˜¯æœ‰Listæ¥å£ä¸­çš„æ–¹æ³•æ¥å®Œæˆæ“ä½œçš„ã€‚</li>
</ul>
</li>
<li>JSONä»£è¡¨ JSONObjectå’ŒJSONArrayçš„è½¬åŒ–<ul>
<li>JSONç±»æºç åˆ†æä¸ä½¿ç”¨</li>
<li>ä»”ç»†è§‚å¯Ÿè¿™äº›æ–¹æ³•ï¼Œä¸»è¦æ˜¯å®ç°jsonå¯¹è±¡ï¼Œjsonå¯¹è±¡æ•°ç»„ï¼Œjavabeanå¯¹è±¡ï¼Œjsonå­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬åŒ–ã€‚</li>
</ul>
</li>
</ol>
<p><strong>ä»£ç æµ‹è¯•ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªFastJsonDemo ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/j4&quot;)</span></span><br><span class="line">    <span class="comment">//@ResponseBody//ä»–å°±ä¸ä¼šèµ°è§†å›¾è§£æå™¨ï¼Œä¼šç›´æ¥è¿”å›ä¸€ä¸ª å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">json4</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        User user1 = <span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">&quot;å¼ ä¸‰1å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">        User user2 = <span class="keyword">new</span> User(<span class="number">2</span>, <span class="string">&quot;å¼ ä¸‰2å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">        User user3 = <span class="keyword">new</span> User(<span class="number">3</span>, <span class="string">&quot;å¼ ä¸‰3å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">        User user4 = <span class="keyword">new</span> User(<span class="number">4</span>, <span class="string">&quot;å¼ ä¸‰4å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line">        User user5 = <span class="keyword">new</span> User(<span class="number">5</span>, <span class="string">&quot;å¼ ä¸‰5å·&quot;</span>, <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">        list.add(user1);</span><br><span class="line">        list.add(user2);</span><br><span class="line">        list.add(user3);</span><br><span class="line">        list.add(user4);</span><br><span class="line">        list.add(user5);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;*******Javaå¯¹è±¡ è½¬ JSONå­—ç¬¦ä¸²*******&quot;</span>);</span><br><span class="line">        String str1 = JSON.toJSONString(list);</span><br><span class="line">        System.out.println(<span class="string">&quot;JSON.toJSONString(list)==&gt;&quot;</span>+str1);</span><br><span class="line">        String str2 = JSON.toJSONString(user1);</span><br><span class="line">        System.out.println(<span class="string">&quot;JSON.toJSONString(user1)==&gt;&quot;</span>+str2);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n****** JSONå­—ç¬¦ä¸² è½¬ Javaå¯¹è±¡*******&quot;</span>);</span><br><span class="line">        User jp_user1=JSON.parseObject(str2,User.class);</span><br><span class="line">        System.out.println(<span class="string">&quot;JSON.parseObject(str2,User.class)==&gt;&quot;</span>+jp_user1);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n****** Javaå¯¹è±¡ è½¬ JSONå¯¹è±¡ ******&quot;</span>);</span><br><span class="line">        JSONObject jsonObject1 = (JSONObject) JSON.toJSON(user2);</span><br><span class="line">        System.out.println(<span class="string">&quot;(JSONObject) JSON.toJSON(user2)==&gt;&quot;</span>+jsonObject1.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n****** JSONå¯¹è±¡ è½¬ Javaå¯¹è±¡ ******&quot;</span>);</span><br><span class="line">        User to_java_user = JSON.toJavaObject(jsonObject1, User.class);</span><br><span class="line">        System.out.println(<span class="string">&quot;JSON.toJavaObject(jsonObject1, User.class)==&gt;&quot;</span>+to_java_user);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(list);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§å·¥å…·ç±»ï¼Œæˆ‘ä»¬åªéœ€è¦æŒæ¡ä½¿ç”¨å°±å¥½äº†ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™åœ¨æ ¹æ®å…·ä½“çš„ä¸šåŠ¡å»æ‰¾å¯¹åº”çš„å®ç°ã€‚å’Œä»¥å‰çš„commons-ioé‚£ç§å·¥å…·åŒ…ä¸€æ ·ï¼Œæ‹¿æ¥ç”¨å°±å¥½äº†ï¼</p>
<h2 id="9ã€æ‹¦æˆªå™¨"><a href="#9ã€æ‹¦æˆªå™¨" class="headerlink" title="9ã€æ‹¦æˆªå™¨"></a>9ã€æ‹¦æˆªå™¨</h2><h3 id="9-1ã€æ¦‚è¿°"><a href="#9-1ã€æ¦‚è¿°" class="headerlink" title="9.1ã€æ¦‚è¿°"></a>9.1ã€æ¦‚è¿°</h3><ul>
<li>SpringMVCçš„å¤„ç†å™¨æ‹¦æˆªå™¨ç±»ä¼¼äºServletå¼€å‘ä¸­çš„è¿‡æ»¤å™¨Filter,ç”¨äºå¯¹å¤„ç†å™¨è¿›è¡Œé¢„å¤„ç†å’Œåå¤„ç†ã€‚</li>
<li>å¼€å‘è€…å¯ä»¥è‡ªå·±å®šä¹‰ä¸€äº›æ‹¦æˆªå™¨æ¥å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚</li>
</ul>
<p><strong>è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„åŒºåˆ«ï¼š</strong>æ‹¦æˆªå™¨æ˜¯<font color=red>AOPæ€æƒ³</font>çš„å…·ä½“åº”ç”¨ã€‚</p>
<p><strong>è¿‡æ»¤å™¨</strong></p>
<ul>
<li>servletè§„èŒƒä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä»»ä½•javawebå·¥ç¨‹éƒ½å¯ä»¥ä½¿ç”¨</li>
<li>åœ¨url-patternä¸­é…ç½®äº†/*ä¹‹åï¼Œå¯ä»¥å¯¹æ‰€æœ‰è¦è®¿é—®çš„èµ„æºè¿›è¡Œæ‹¦æˆª</li>
</ul>
<p><strong>æ‹¦æˆªå™¨</strong> </p>
<ul>
<li>æ‹¦æˆªå™¨æ˜¯SpringMVCæ¡†æ¶è‡ªå·±çš„ï¼Œåªæœ‰ä½¿ç”¨äº†SpringMVCæ¡†æ¶çš„å·¥ç¨‹æ‰èƒ½ä½¿ç”¨</li>
<li>æ‹¦æˆªå™¨åªä¼šæ‹¦æˆªè®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œ å¦‚æœè®¿é—®çš„æ˜¯jsp/html/css/image/jsæ˜¯ä¸ä¼šè¿›è¡Œæ‹¦æˆªçš„</li>
</ul>
<h3 id="9-2ã€è‡ªå®šä¹‰æ‹¦æˆªå™¨"><a href="#9-2ã€è‡ªå®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="9.2ã€è‡ªå®šä¹‰æ‹¦æˆªå™¨"></a>9.2ã€è‡ªå®šä¹‰æ‹¦æˆªå™¨</h3><ol>
<li><p>æ–°å»ºä¸€ä¸ªMoudule ï¼Œ springmvc-Interceptor  ï¼Œ æ·»åŠ webæ”¯æŒ</p>
</li>
<li><p>é…ç½®web.xml å’Œ springmvc-servlet.xml æ–‡ä»¶</p>
</li>
<li><p>ç¼–å†™ä¸€ä¸ªæ‹¦æˆªå™¨ï¼ˆå¿…é¡»å®ç°<font color=red> HandlerInterceptor æ¥å£</font>ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> nuc.ss.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="comment">//return true; æ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œæ”¾è¡Œ</span></span><br><span class="line">    <span class="comment">//return false; ä¸æ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œæ‹¦æˆª</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========å¤„ç†å‰===========&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ—¥å¿—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========å¤„ç†å===========&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ—¥å¿—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========æ¸…ç†===========&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨springmvcçš„é…ç½®æ–‡ä»¶ä¸­é…ç½®æ‹¦æˆªå™¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ‹¦æˆªå™¨é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åŒ…æ‹¬è¿™ä¸ªè¯·æ±‚ä¸‹é¢çš„æ‰€æœ‰è¯·æ±‚--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;nuc.ss.config.MyInterceptor&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™ä¸€ä¸ªControllerï¼Œæ¥æ”¶è¯·æ±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/t1&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestController.test&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>å¯åŠ¨tomcat æµ‹è¯•ä¸€ä¸‹ï¼(<a href="http://localhost:8888/t1">http://localhost:8888/t1</a>)</p>
</li>
</ol>
<h3 id="10-3ã€éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•-è®¤è¯ç”¨æˆ·"><a href="#10-3ã€éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•-è®¤è¯ç”¨æˆ·" class="headerlink" title="10.3ã€éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½• (è®¤è¯ç”¨æˆ·)"></a>10.3ã€éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½• (è®¤è¯ç”¨æˆ·)</h3><p><strong>å®ç°æ€è·¯</strong></p>
<ol>
<li><p>æœ‰ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œéœ€è¦å†™ä¸€ä¸ªcontrollerè®¿é—®é¡µé¢ã€‚</p>
</li>
<li><p>ç™»é™†é¡µé¢æœ‰ä¸€æäº¤è¡¨å•çš„åŠ¨ä½œã€‚éœ€è¦åœ¨controllerä¸­å¤„ç†ã€‚åˆ¤æ–­ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœæ­£ç¡®ï¼Œå‘sessionä¸­å†™å…¥ç”¨æˆ·ä¿¡æ¯ã€‚<em>è¿”å›ç™»é™†æˆåŠŸã€‚</em></p>
</li>
<li><p>æ‹¦æˆªç”¨æˆ·è¯·æ±‚ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†ã€‚å¦‚æœç”¨æˆ·å·²ç»ç™»é™†ã€‚æ”¾è¡Œï¼Œ å¦‚æœç”¨æˆ·æœªç™»é™†ï¼Œè·³è½¬åˆ°ç™»é™†é¡µé¢</p>
</li>
</ol>
<p><strong>æµ‹è¯•ï¼š</strong></p>
<ol>
<li><p>ç¼–å†™ä¸€ä¸ªç™»é™†é¡µé¢  login.jsp</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ç™»å½•&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%--åœ¨web-infä¸‹é¢çš„æ‰€æœ‰é¡µé¢æˆ–è€…èµ„æºï¼Œåªèƒ½é€šè¿‡controlleræˆ–è€…Servletè¿›è¡Œè®¿é—®--%&gt;</span><br><span class="line">&lt;h1&gt;ç™»å½•é¡µé¢&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/user/login&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    ç”¨æˆ·åï¼š&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">    å¯†ç ï¼š&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;password&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;æäº¤&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™ä¸€ä¸ªControllerå¤„ç†è¯·æ±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/main&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;main&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/goLogin&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(HttpSession session, String username, String password, Model model)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŠŠç”¨æˆ·çš„ä¿¡æ¯å­˜åœ¨sessionä¸­</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;userLoginInfo&quot;</span>,username);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;password&quot;</span>,password);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;username&quot;</span>,username);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;main&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/goOut&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">goOut</span><span class="params">(HttpSession sessionl)</span> </span>&#123;</span><br><span class="line">        sessionl.removeAttribute(<span class="string">&quot;userLoginInfo&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™ä¸€ä¸ªç™»é™†æˆåŠŸçš„é¡µé¢ main.jsp</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;é¦–é¡µ&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;é¦–é¡µ&lt;/h1&gt;</span><br><span class="line">&lt;span&gt;$&#123;password&#125;&lt;/span&gt;</span><br><span class="line">&lt;span&gt;$&#123;username&#125;&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;</span><br><span class="line">    &lt;a href=&quot;$&#123;pageContext.request.contextPath&#125;/user/goOut&quot;&gt;æ³¨é”€&lt;/a&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨ index é¡µé¢ä¸Šæµ‹è¯•è·³è½¬ï¼å¯åŠ¨Tomcat æµ‹è¯•ï¼Œæœªç™»å½•ä¹Ÿå¯ä»¥è¿›å…¥ä¸»é¡µï¼</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;index&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;&lt;a href=&quot;$&#123;pageContext.request.contextPath&#125;/user/goLogin&quot;&gt;ç™»å½•é¡µé¢&lt;/a&gt;&lt;/h1&gt;</span><br><span class="line">&lt;h1&gt;&lt;a href=&quot;$&#123;pageContext.request.contextPath&#125;/user/main&quot;&gt;é¦–é¡µ&lt;/a&gt;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>ç¼–å†™ç”¨æˆ·ç™»å½•æ‹¦æˆªå™¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        HttpSession session = request.getSession();</span><br><span class="line">        <span class="comment">//æ”¾è¡Œ:åˆ¤æ–­ä»€ä¹ˆæƒ…å†µä¸‹ç™»å½•</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç™»å½•é¡µé¢ä¹Ÿä¼šæ”¾è¡Œ</span></span><br><span class="line">        <span class="keyword">if</span> (request.getRequestURI().contains(<span class="string">&quot;goLogin&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (request.getRequestURI().contains(<span class="string">&quot;login&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (session.getAttribute(<span class="string">&quot;userLoginInfo&quot;</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­ä»€ä¹ˆæƒ…å†µä¸‹æ²¡æœ‰ç™»å½•</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;/WEB-INF/jsp/login.jsp&quot;</span>).forward(request,response);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨Springmvcçš„é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œæ‹¦æˆªå™¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å…³äºæ‹¦æˆªå™¨çš„é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;loginInterceptor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.kuang.interceptor.LoginInterceptor&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>å†æ¬¡é‡å¯Tomcatæµ‹è¯•ï¼</p>
</li>
</ol>
<p><strong>OKï¼Œæµ‹è¯•ç™»å½•æ‹¦æˆªåŠŸèƒ½æ— è¯¯.</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture/raw/master/%E5%9B%BE%E7%89%87/image-20210309163924702.png" alt="image-20210309163924702"></p>
<h2 id="10ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½"><a href="#10ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½" class="headerlink" title="10ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½"></a>10ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½</h2><h3 id="11-1ã€å‡†å¤‡å·¥ä½œ"><a href="#11-1ã€å‡†å¤‡å·¥ä½œ" class="headerlink" title="11.1ã€å‡†å¤‡å·¥ä½œ"></a>11.1ã€å‡†å¤‡å·¥ä½œ</h3><ul>
<li>æ–‡ä»¶ä¸Šä¼ æ˜¯é¡¹ç›®å¼€å‘ä¸­æœ€å¸¸è§çš„åŠŸèƒ½ä¹‹ä¸€ ,springMVC å¯ä»¥å¾ˆå¥½çš„æ”¯æŒæ–‡ä»¶ä¸Šä¼ ã€‚</li>
<li>SpringMVCä¸Šä¸‹æ–‡ä¸­é»˜è®¤æ²¡æœ‰è£…é…MultipartResolverï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹å…¶ä¸èƒ½å¤„ç†æ–‡ä»¶ä¸Šä¼ å·¥ä½œã€‚å¦‚æœæƒ³ä½¿ç”¨Springçš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­é…ç½®MultipartResolverã€‚</li>
<li>å‰ç«¯è¡¨å•è¦æ±‚ï¼šä¸ºäº†èƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œå¿…é¡»å°†è¡¨å•çš„methodè®¾ç½®ä¸ºPOSTï¼Œå¹¶å°†enctypeè®¾ç½®ä¸ºmultipart/form-dataã€‚åªæœ‰åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ‰ä¼šæŠŠç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶ä»¥äºŒè¿›åˆ¶æ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼›</li>
</ul>
<p><strong>å¯¹è¡¨å•ä¸­çš„ enctype å±æ€§åšä¸ªè¯¦ç»†çš„è¯´æ˜ï¼š</strong></p>
<ul>
<li>application/x-www=form-urlencodedï¼šé»˜è®¤æ–¹å¼ï¼Œåªå¤„ç†è¡¨å•åŸŸä¸­çš„ value å±æ€§å€¼ï¼Œé‡‡ç”¨è¿™ç§ç¼–ç æ–¹å¼çš„è¡¨å•ä¼šå°†è¡¨å•åŸŸä¸­çš„å€¼å¤„ç†æˆ URL ç¼–ç æ–¹å¼ã€‚</li>
<li>multipart/form-dataï¼šè¿™ç§ç¼–ç æ–¹å¼ä¼šä»¥äºŒè¿›åˆ¶æµçš„æ–¹å¼æ¥å¤„ç†è¡¨å•æ•°æ®ï¼Œè¿™ç§ç¼–ç æ–¹å¼ä¼šæŠŠæ–‡ä»¶åŸŸæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ä¹Ÿå°è£…åˆ°è¯·æ±‚å‚æ•°ä¸­ï¼Œä¸ä¼šå¯¹å­—ç¬¦ç¼–ç ã€‚</li>
<li>text/plainï¼šé™¤äº†æŠŠç©ºæ ¼è½¬æ¢ä¸º â€œ+â€ å·å¤–ï¼Œå…¶ä»–å­—ç¬¦éƒ½ä¸åšç¼–ç å¤„ç†ï¼Œè¿™ç§æ–¹å¼é€‚ç”¨ç›´æ¥é€šè¿‡è¡¨å•å‘é€é‚®ä»¶ã€‚</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸€æ—¦è®¾ç½®äº†enctypeä¸ºmultipart/form-dataï¼Œæµè§ˆå™¨å³ä¼šé‡‡ç”¨äºŒè¿›åˆ¶æµçš„æ–¹å¼æ¥å¤„ç†è¡¨å•æ•°æ®ï¼Œè€Œå¯¹äºæ–‡ä»¶ä¸Šä¼ çš„å¤„ç†åˆ™æ¶‰åŠåœ¨æœåŠ¡å™¨ç«¯è§£æåŸå§‹çš„HTTPå“åº”ã€‚åœ¨2003å¹´ï¼ŒApache Software Foundationå‘å¸ƒäº†å¼€æºçš„Commons FileUploadç»„ä»¶ï¼Œå…¶å¾ˆå¿«æˆä¸ºServlet/JSPç¨‹åºå‘˜ä¸Šä¼ æ–‡ä»¶çš„æœ€ä½³é€‰æ‹©ã€‚</p>
<ul>
<li>Servlet3.0è§„èŒƒå·²ç»æä¾›æ–¹æ³•æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼Œä½†è¿™ç§ä¸Šä¼ éœ€è¦åœ¨Servletä¸­å®Œæˆã€‚</li>
<li>è€ŒSpring MVCåˆ™æä¾›äº†æ›´ç®€å•çš„å°è£…ã€‚</li>
<li>Spring MVCä¸ºæ–‡ä»¶ä¸Šä¼ æä¾›äº†ç›´æ¥çš„æ”¯æŒï¼Œè¿™ç§æ”¯æŒæ˜¯ç”¨å³æ’å³ç”¨çš„MultipartResolverå®ç°çš„ã€‚</li>
<li>Spring MVCä½¿ç”¨Apache Commons FileUploadæŠ€æœ¯å®ç°äº†ä¸€ä¸ªMultipartResolverå®ç°ç±»ï¼š</li>
<li>CommonsMultipartResolverã€‚å› æ­¤ï¼Œ<font color=red>SpringMVCçš„æ–‡ä»¶ä¸Šä¼ è¿˜éœ€è¦ä¾èµ–Apache Commons FileUploadçš„ç»„ä»¶ã€‚</font></li>
</ul>
<h3 id="11-2ã€æ–‡ä»¶ä¸Šä¼ "><a href="#11-2ã€æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="11.2ã€æ–‡ä»¶ä¸Šä¼ "></a>11.2ã€æ–‡ä»¶ä¸Šä¼ </h3><ol>
<li><p>å¯¼å…¥æ–‡ä»¶ä¸Šä¼ çš„jaråŒ…ï¼Œcommons-fileupload ï¼Œ Mavenä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å¯¼å…¥ä»–çš„ä¾èµ–åŒ… commons-ioåŒ…ï¼›</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–‡ä»¶ä¸Šä¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--servlet-apiå¯¼å…¥é«˜ç‰ˆæœ¬çš„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>é…ç½®beanï¼šmultipartResolver</p>
<p><font color=red>ã€<strong>æ³¨æ„ï¼ï¼ï¼è¿™ä¸ªbenaçš„idå¿…é¡»ä¸ºï¼šmultipartResolver ï¼Œ å¦åˆ™ä¸Šä¼ æ–‡ä»¶ä¼šæŠ¥400çš„é”™è¯¯ï¼åœ¨è¿™é‡Œæ ½è¿‡å‘,æ•™è®­ï¼</strong>ã€‘</font></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–‡ä»¶ä¸Šä¼ é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span>  <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- è¯·æ±‚çš„ç¼–ç æ ¼å¼ï¼Œå¿…é¡»å’ŒjSPçš„pageEncodingå±æ€§ä¸€è‡´ï¼Œä»¥ä¾¿æ­£ç¡®è¯»å–è¡¨å•çš„å†…å®¹ï¼Œé»˜è®¤ä¸ºISO-8859-1 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;utf-8&quot;</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼ˆ10485760=10Mï¼‰ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxUploadSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10485760&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxInMemorySize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;40960&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>CommonsMultipartFile çš„ å¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li><strong>String getOriginalFilename()ï¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„åŸå</strong></li>
<li><strong>InputStream getInputStream()ï¼šè·å–æ–‡ä»¶æµ</strong></li>
<li><strong>void transferTo(File dest)ï¼šå°†ä¸Šä¼ æ–‡ä»¶ä¿å­˜åˆ°ä¸€ä¸ªç›®å½•æ–‡ä»¶ä¸­</strong></li>
</ul>
<p> æˆ‘ä»¬å»å®é™…æµ‹è¯•ä¸€ä¸‹</p>
</li>
<li><p>ç¼–å†™å‰ç«¯é¡µé¢</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;/upload&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line"> &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span>/&gt;</span><br><span class="line"> &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;upload&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Controller</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> nuc.ss.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.commons.CommonsMultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//@RequestParam(&quot;file&quot;) å°†name=fileæ§ä»¶å¾—åˆ°çš„æ–‡ä»¶å°è£…æˆCommonsMultipartFile å¯¹è±¡</span></span><br><span class="line">    <span class="comment">//æ‰¹é‡ä¸Šä¼ CommonsMultipartFileåˆ™ä¸ºæ•°ç»„å³å¯</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">fileUpload</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> CommonsMultipartFile file , HttpServletRequest request)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–æ–‡ä»¶å : file.getOriginalFilename();</span></span><br><span class="line">        String uploadFileName = file.getOriginalFilename();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœæ–‡ä»¶åä¸ºç©ºï¼Œç›´æ¥å›åˆ°é¦–é¡µï¼</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;&quot;</span>.equals(uploadFileName))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/index.jsp&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å : &quot;</span>+uploadFileName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span></span><br><span class="line">        String path = request.getServletContext().getRealPath(<span class="string">&quot;/upload&quot;</span>);</span><br><span class="line">        <span class="comment">//å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ª</span></span><br><span class="line">        File realPath = <span class="keyword">new</span> File(path);</span><br><span class="line">        <span class="keyword">if</span> (!realPath.exists())&#123;</span><br><span class="line">            realPath.mkdir();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š&quot;</span>+realPath);</span><br><span class="line"></span><br><span class="line">        InputStream is = file.getInputStream(); <span class="comment">//æ–‡ä»¶è¾“å…¥æµ</span></span><br><span class="line">        OutputStream os = <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(realPath,uploadFileName)); <span class="comment">//æ–‡ä»¶è¾“å‡ºæµ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¯»å–å†™å‡º</span></span><br><span class="line">        <span class="keyword">int</span> len=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">while</span> ((len=is.read(buffer))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            os.write(buffer,<span class="number">0</span>,len);</span><br><span class="line">            os.flush();</span><br><span class="line">        &#125;</span><br><span class="line">        os.close();</span><br><span class="line">        is.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/index.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * é‡‡ç”¨file.Transto æ¥ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/upload2&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String  <span class="title">fileUpload2</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> CommonsMultipartFile file, HttpServletRequest request)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span></span><br><span class="line">        String path = request.getServletContext().getRealPath(<span class="string">&quot;/upload&quot;</span>);</span><br><span class="line">        File realPath = <span class="keyword">new</span> File(path);</span><br><span class="line">        <span class="keyword">if</span> (!realPath.exists())&#123;</span><br><span class="line">            realPath.mkdir();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä¸Šä¼ æ–‡ä»¶åœ°å€</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š&quot;</span>+realPath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡CommonsMultipartFileçš„æ–¹æ³•ç›´æ¥å†™æ–‡ä»¶ï¼ˆæ³¨æ„è¿™ä¸ªæ—¶å€™ï¼‰</span></span><br><span class="line">        file.transferTo(<span class="keyword">new</span> File(realPath +<span class="string">&quot;/&quot;</span>+ file.getOriginalFilename()));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/index.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value=&quot;/download&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">downloads</span><span class="params">(HttpServletResponse response , HttpServletRequest request)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//è¦ä¸‹è½½çš„å›¾ç‰‡åœ°å€</span></span><br><span class="line">        String  path = request.getServletContext().getRealPath(<span class="string">&quot;/upload&quot;</span>);</span><br><span class="line">        String  fileName = <span class="string">&quot;bg1.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1ã€è®¾ç½®response å“åº”å¤´</span></span><br><span class="line">        response.reset(); <span class="comment">//è®¾ç½®é¡µé¢ä¸ç¼“å­˜,æ¸…ç©ºbuffer</span></span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>); <span class="comment">//å­—ç¬¦ç¼–ç </span></span><br><span class="line">        response.setContentType(<span class="string">&quot;multipart/form-data&quot;</span>); <span class="comment">//äºŒè¿›åˆ¶ä¼ è¾“æ•°æ®</span></span><br><span class="line">        <span class="comment">//è®¾ç½®å“åº”å¤´</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,</span><br><span class="line">                <span class="string">&quot;attachment;fileName=&quot;</span>+ URLEncoder.encode(fileName, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">        File file = <span class="keyword">new</span> File(path,fileName);</span><br><span class="line">        <span class="comment">//2ã€ è¯»å–æ–‡ä»¶--è¾“å…¥æµ</span></span><br><span class="line">        InputStream input=<span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">        <span class="comment">//3ã€ å†™å‡ºæ–‡ä»¶--è¾“å‡ºæµ</span></span><br><span class="line">        OutputStream out = response.getOutputStream();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] buff =<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//4ã€æ‰§è¡Œ å†™å‡ºæ“ä½œ</span></span><br><span class="line">        <span class="keyword">while</span>((index= input.read(buff))!= -<span class="number">1</span>)&#123;</span><br><span class="line">            out.write(buff, <span class="number">0</span>, index);</span><br><span class="line">            out.flush();</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        input.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>æµ‹è¯•ä¸Šä¼ æ–‡ä»¶ï¼ŒOKï¼</p>
</li>
</ol>
<p><strong>é‡‡ç”¨file.Transto æ¥ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶</strong></p>
<ol>
<li><p>ç¼–å†™Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* é‡‡ç”¨file.Transto æ¥ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/upload2&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String  <span class="title">fileUpload2</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> CommonsMultipartFile file, HttpServletRequest request)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span></span><br><span class="line">   String path = request.getServletContext().getRealPath(<span class="string">&quot;/upload&quot;</span>);</span><br><span class="line">   File realPath = <span class="keyword">new</span> File(path);</span><br><span class="line">   <span class="keyword">if</span> (!realPath.exists())&#123;</span><br><span class="line">       realPath.mkdir();</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">//ä¸Šä¼ æ–‡ä»¶åœ°å€</span></span><br><span class="line">   System.out.println(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š&quot;</span>+realPath);</span><br><span class="line"></span><br><span class="line">   <span class="comment">//é€šè¿‡CommonsMultipartFileçš„æ–¹æ³•ç›´æ¥å†™æ–‡ä»¶ï¼ˆæ³¨æ„è¿™ä¸ªæ—¶å€™ï¼‰</span></span><br><span class="line">   file.transferTo(<span class="keyword">new</span> File(realPath +<span class="string">&quot;/&quot;</span>+ file.getOriginalFilename()));</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;redirect:/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>å‰ç«¯è¡¨å•æäº¤åœ°å€ä¿®æ”¹</p>
</li>
<li><p>è®¿é—®æäº¤æµ‹è¯•ï¼ŒOKï¼</p>
</li>
</ol>
<h3 id="11-3ã€æ–‡ä»¶ä¸‹è½½"><a href="#11-3ã€æ–‡ä»¶ä¸‹è½½" class="headerlink" title="11.3ã€æ–‡ä»¶ä¸‹è½½"></a>11.3ã€æ–‡ä»¶ä¸‹è½½</h3><p><strong>æ–‡ä»¶ä¸‹è½½æ­¥éª¤ï¼š</strong></p>
<ol>
<li><p>è®¾ç½® response å“åº”å¤´</p>
</li>
<li><p>è¯»å–æ–‡ä»¶ â€“ InputStream</p>
</li>
<li><p>å†™å‡ºæ–‡ä»¶ â€“ OutputStream</p>
</li>
<li><p>æ‰§è¡Œæ“ä½œ</p>
</li>
<li><p>å…³é—­æµ ï¼ˆå…ˆå¼€åå…³ï¼‰</p>
</li>
</ol>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value=&quot;/download&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">downloads</span><span class="params">(HttpServletResponse response ,HttpServletRequest request)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">   <span class="comment">//è¦ä¸‹è½½çš„å›¾ç‰‡åœ°å€</span></span><br><span class="line">   String  path = request.getServletContext().getRealPath(<span class="string">&quot;/upload&quot;</span>);</span><br><span class="line">   String  fileName = <span class="string">&quot;åŸºç¡€è¯­æ³•.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//1ã€è®¾ç½®response å“åº”å¤´</span></span><br><span class="line">   response.reset(); <span class="comment">//è®¾ç½®é¡µé¢ä¸ç¼“å­˜,æ¸…ç©ºbuffer</span></span><br><span class="line">   response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>); <span class="comment">//å­—ç¬¦ç¼–ç </span></span><br><span class="line">   response.setContentType(<span class="string">&quot;multipart/form-data&quot;</span>); <span class="comment">//äºŒè¿›åˆ¶ä¼ è¾“æ•°æ®</span></span><br><span class="line">   <span class="comment">//è®¾ç½®å“åº”å¤´</span></span><br><span class="line">   response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,</span><br><span class="line">           <span class="string">&quot;attachment;fileName=&quot;</span>+URLEncoder.encode(fileName, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">   File file = <span class="keyword">new</span> File(path,fileName);</span><br><span class="line">   <span class="comment">//2ã€ è¯»å–æ–‡ä»¶--è¾“å…¥æµ</span></span><br><span class="line">   InputStream input=<span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">   <span class="comment">//3ã€ å†™å‡ºæ–‡ä»¶--è¾“å‡ºæµ</span></span><br><span class="line">   OutputStream out = response.getOutputStream();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">byte</span>[] buff =<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">   <span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line">   <span class="comment">//4ã€æ‰§è¡Œ å†™å‡ºæ“ä½œ</span></span><br><span class="line">   <span class="keyword">while</span>((index= input.read(buff))!= -<span class="number">1</span>)&#123;</span><br><span class="line">       out.write(buff, <span class="number">0</span>, index);</span><br><span class="line">       out.flush();</span><br><span class="line">  &#125;</span><br><span class="line">   out.close();</span><br><span class="line">   input.close();</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‰ç«¯</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;a href=&quot;/download&quot;&gt;ç‚¹å‡»ä¸‹è½½&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼Œæ–‡ä»¶ä¸‹è½½OK</p>
<h2 id="11-SpringMVCæ¡†æ¶æ€»ç»“"><a href="#11-SpringMVCæ¡†æ¶æ€»ç»“" class="headerlink" title="11.SpringMVCæ¡†æ¶æ€»ç»“"></a>11.SpringMVCæ¡†æ¶æ€»ç»“</h2><ul>
<li><code>DispatcherServlet</code>å‰ç«¯æ§åˆ¶å™¨ï¼šæ¥æ”¶requestï¼Œè¿›è¡Œresponse</li>
<li><strong><code>HandlerMapping</code>å¤„ç†å™¨æ˜ å°„å™¨</strong>ï¼šæ ¹æ®urlæŸ¥æ‰¾Handlerã€‚ï¼ˆå¯ä»¥é€šè¿‡xmlé…ç½®æ–¹å¼ï¼Œæ³¨è§£æ–¹å¼ï¼‰</li>
<li><strong><code>HandlerAdapter</code>å¤„ç†å™¨é€‚é…å™¨</strong>ï¼šæ ¹æ®ç‰¹å®šè§„åˆ™å»æ‰§è¡ŒHandlerï¼Œç¼–å†™Handleræ—¶éœ€è¦æŒ‰ç…§HandlerAdapterçš„è¦æ±‚å»ç¼–å†™ã€‚</li>
<li><strong><code>Handler</code>å¤„ç†å™¨</strong>ï¼ˆåç«¯æ§åˆ¶å™¨ï¼‰ï¼šéœ€è¦ç¨‹åºå‘˜å»ç¼–å†™ï¼Œ<strong>å¸¸ç”¨æ³¨è§£å¼€å‘æ–¹å¼</strong>ã€‚<ul>
<li>Handlerå¤„ç†å™¨æ‰§è¡Œåç»“æœæ˜¯<code>ModelAndView</code>ï¼Œå…·ä½“å¼€å‘æ—¶<code>Handler</code>è¿”å›æ–¹æ³•å€¼ç±»å‹åŒ…æ‹¬ï¼š<code>ModelAndView</code>ã€<code>String</code>ï¼ˆé€»è¾‘è§†å›¾åï¼‰ã€<code>void</code>ï¼ˆé€šè¿‡åœ¨Handlerå½¢å‚ä¸­æ·»åŠ requestå’Œresponseï¼Œç±»ä¼¼åŸå§‹ servletå¼€å‘æ–¹å¼ï¼Œæ³¨æ„ï¼šå¯ä»¥é€šè¿‡æŒ‡å®šresponseå“åº”çš„ç»“æœç±»å‹å®ç°jsonæ•°æ®è¾“å‡ºï¼‰</li>
</ul>
</li>
<li><code>View Resolver</code>è§†å›¾è§£æå™¨ï¼šæ ¹æ®é€»è¾‘è§†å›¾åç”ŸæˆçœŸæ­£çš„è§†å›¾ï¼ˆåœ¨springmvcä¸­ä½¿ç”¨Viewå¯¹è±¡è¡¨ç¤ºï¼‰</li>
<li><code>View</code>è§†å›¾ï¼šjspé¡µé¢ï¼Œä»…æ˜¯æ•°æ®å±•ç¤ºï¼Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘ã€‚</li>
</ul>
<h3 id="11-1ã€æ³¨è§£å¼€å‘"><a href="#11-1ã€æ³¨è§£å¼€å‘" class="headerlink" title="11.1ã€æ³¨è§£å¼€å‘"></a>11.1ã€æ³¨è§£å¼€å‘</h3><h4 id="ä½¿ç”¨æ³¨è§£æ–¹å¼çš„å¤„ç†å™¨æ˜ å°„å™¨å’Œé€‚é…å™¨"><a href="#ä½¿ç”¨æ³¨è§£æ–¹å¼çš„å¤„ç†å™¨æ˜ å°„å™¨å’Œé€‚é…å™¨" class="headerlink" title="ä½¿ç”¨æ³¨è§£æ–¹å¼çš„å¤„ç†å™¨æ˜ å°„å™¨å’Œé€‚é…å™¨"></a>ä½¿ç”¨æ³¨è§£æ–¹å¼çš„å¤„ç†å™¨æ˜ å°„å™¨å’Œé€‚é…å™¨</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ³¨è§£æ˜ å°„å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ³¨è§£é€‚é…å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨å®é™…å¼€å‘ï¼Œä½¿ç”¨<code>&lt;mvc:annotation-driven&gt;</code>ä»£æ›¿ä¸Šè¾¹å¤„ç†å™¨æ˜ å°„å™¨å’Œé€‚é…å™¨é…ç½®ã€‚</p>
<ul>
<li><code>@controller</code>æ³¨è§£å¿…é¡»è¦åŠ ï¼Œä½œç”¨æ ‡è¯†ç±»æ˜¯ä¸€ä¸ªHandlerå¤„ç†å™¨ã€‚</li>
<li><code>@requestMapping</code>æ³¨è§£å¿…é¡»è¦åŠ ï¼Œä½œç”¨ï¼š<ul>
<li>1ã€å¯¹urlå’ŒHandlerçš„<strong>æ–¹æ³•</strong>è¿›è¡Œæ˜ å°„ã€‚</li>
<li>2ã€å¯ä»¥çª„åŒ–è¯·æ±‚æ˜ å°„ï¼Œè®¾ç½®Handlerçš„æ ¹è·¯å¾„ï¼Œurlå°±æ˜¯æ ¹è·¯å¾„+å­è·¯å¾„è¯·æ±‚æ–¹å¼</li>
<li>3ã€å¯ä»¥é™åˆ¶httpè¯·æ±‚çš„æ–¹æ³•</li>
</ul>
</li>
</ul>
<p>æ˜ å°„æˆåŠŸåï¼Œspringmvcæ¡†æ¶ç”Ÿæˆä¸€ä¸ªHandlerå¯¹è±¡ï¼Œå¯¹è±¡ä¸­åªåŒ…æ‹¬ ä¸€ä¸ªæ˜ å°„æˆåŠŸçš„methodã€‚</p>
<h4 id="æ³¨è§£å¼€å‘ä¸­å‚æ•°ç»‘å®š"><a href="#æ³¨è§£å¼€å‘ä¸­å‚æ•°ç»‘å®š" class="headerlink" title="æ³¨è§£å¼€å‘ä¸­å‚æ•°ç»‘å®š"></a>æ³¨è§£å¼€å‘ä¸­å‚æ•°ç»‘å®š</h4><p>å°†requestè¯·æ±‚è¿‡æ¥çš„key/valueçš„æ•°æ®ï¼ˆç†è§£ä¸€ä¸ªä¸²ï¼‰ï¼Œé€šè¿‡è½¬æ¢ï¼ˆå‚æ•°ç»‘å®šçš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œå°†key/valueä¸²è½¬æˆå½¢å‚ï¼Œå°†è½¬æ¢åçš„ç»“æœä¼ ç»™å½¢å‚ï¼ˆæ•´ä¸ªå‚æ•°ç»‘å®šè¿‡ç¨‹ï¼‰ã€‚</p>
<p>springmvcæ‰€æ”¯æŒå‚æ•°ç»‘å®šï¼š</p>
<ul>
<li>1ã€é»˜è®¤æ”¯æŒå¾ˆå¤šç±»å‹ï¼š<code>HttpServletRequest</code>ã€<code>response</code>ã€<code>session</code>ã€<code>model/modelMap</code>(å°†æ¨¡å‹æ•°æ®å¡«å……åˆ°requeståŸŸ)</li>
<li>2ã€æ”¯æŒç®€å•æ•°æ®ç±»å‹ï¼Œæ•´å‹ã€å­—ç¬¦ä¸²ã€æ—¥æœŸ..ç­‰<ul>
<li>åªè¦ä¿è¯requestè¯·æ±‚çš„å‚æ•°åå’Œå½¢å‚åç§°ä¸€è‡´ï¼Œè‡ªåŠ¨ç»‘å®šæˆåŠŸ</li>
<li>å¦‚æœrequestè¯·æ±‚çš„å‚æ•°åå’Œå½¢å‚åç§°ä¸ä¸€è‡´ï¼Œå¯ä»¥ä½¿ç”¨<code>@RequestParam</code>ï¼ˆæŒ‡å®šrequestè¯·æ±‚çš„å‚æ•°åï¼‰ï¼Œ<code>@RequestParam</code>åŠ åœ¨å½¢å‚çš„å‰è¾¹ã€‚</li>
</ul>
</li>
<li>3ã€æ”¯æŒpojoç±»å‹<ul>
<li>åªè¦ä¿è¯requestè¯·æ±‚çš„å‚æ•°åç§°å’Œpojoä¸­çš„å±æ€§åä¸€è‡´ï¼Œè‡ªåŠ¨å°†requestè¯·æ±‚çš„å‚æ•°è®¾ç½®åˆ°pojoçš„å±æ€§ä¸­ã€‚</li>
</ul>
</li>
<li>4ã€åŒ…è£…ç±»å‹pojoå‚æ•°ç»‘å®š<ul>
<li>ç¬¬ä¸€ç§æ–¹æ³•ï¼šåœ¨å½¢å‚ä¸­æ·»åŠ <code>HttpServletRequest request</code>å‚æ•°ï¼Œé€šè¿‡requestæ¥æ”¶æŸ¥è¯¢æ¡ä»¶å‚æ•°ã€‚</li>
<li>ç¬¬äºŒç§æ–¹æ³•ï¼šåœ¨å½¢å‚ä¸­è®©åŒ…è£…ç±»å‹çš„pojoæ¥æ”¶æŸ¥è¯¢æ¡ä»¶å‚æ•°ã€‚</li>
</ul>
</li>
<li>5ã€é›†åˆç±»å‹å‚æ•°ç»‘å®š<ul>
<li>æ•°ç»„ç»‘å®šï¼šæ–¹æ³•å½¢å‚ä½¿ç”¨æ•°ç»„æ¥æ”¶é¡µé¢è¯·æ±‚çš„å¤šä¸ªå‚æ•°</li>
<li>listç»‘å®šï¼šä½¿ç”¨Listæ¥æ”¶é¡µé¢æäº¤çš„æ‰¹é‡æ•°æ®ï¼Œé€šè¿‡åŒ…è£…pojoæ¥æ”¶ï¼Œåœ¨åŒ…è£…pojoä¸­å®šä¹‰<code>list&lt;pojo&gt;</code>å±æ€§</li>
<li>mapç»‘å®šï¼šåœ¨åŒ…è£…ç±»ä¸­å®šä¹‰Mapå¯¹è±¡ï¼Œå¹¶æ·»åŠ <code>get/set</code>æ–¹æ³•ï¼Œactionä½¿ç”¨åŒ…è£…å¯¹è±¡æ¥æ”¶</li>
</ul>
</li>
</ul>
<p><em>æ³¨æ„ï¼šå½¢å‚ä¸­å³æœ‰pojoç±»å‹åˆæœ‰ç®€å•ç±»å‹ï¼Œå‚æ•°ç»‘å®šäº’ä¸å½±å“ã€‚</em></p>
<p>è‡ªå®šä¹‰å‚æ•°ç»‘å®š</p>
<ul>
<li>æ—¥æœŸç±»å‹ç»‘å®šè‡ªå®šä¹‰ï¼š</li>
</ul>
<p>å®šä¹‰çš„<code>Converter&lt;æºç±»å‹ï¼Œç›®æ ‡ç±»å‹&gt;</code>æ¥å£å®ç°ç±»ï¼Œæ¯”å¦‚ï¼š<code>Converter&lt;String,Date&gt;</code>,è¡¨ç¤ºï¼šå°†è¯·æ±‚çš„æ—¥æœŸæ•°æ®ä¸²è½¬æˆjavaä¸­çš„æ—¥æœŸç±»å‹ã€‚</p>
<p><em>æ³¨æ„ï¼šè¦è½¬æ¢çš„ç›®æ ‡ç±»å‹ä¸€å®šå’Œæ¥æ”¶çš„pojoä¸­çš„å±æ€§ç±»å‹ä¸€è‡´ã€‚</em></p>
<p>å°†å®šä¹‰çš„Converterå®ç°ç±»æ³¨å…¥åˆ°å¤„ç†å™¨é€‚é…å™¨ä¸­ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">conversion-service</span>=<span class="string">&quot;conversionService&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- conversionService --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;conversionService&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">class</span>=<span class="string">&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- è½¬æ¢å™¨ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;converters&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;cn.krislin.controller.converter.CustomDateConverter&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h4 id="springmvcå’Œstruts2åŒºåˆ«"><a href="#springmvcå’Œstruts2åŒºåˆ«" class="headerlink" title="springmvcå’Œstruts2åŒºåˆ«"></a>springmvcå’Œstruts2åŒºåˆ«</h4><p>springmvcé¢å‘æ–¹æ³•å¼€å‘çš„ï¼ˆæ›´æ¥è¿‘serviceæ¥å£çš„å¼€å‘æ–¹å¼ï¼‰ï¼Œstruts2é¢å‘ç±»å¼€å‘ã€‚</p>
<p>springmvcå¯ä»¥å•ä¾‹å¼€å‘ï¼Œstruts2åªèƒ½æ˜¯å¤šä¾‹å¼€å‘ã€‚</p>
<h3 id="11-2ã€æ ¡éªŒ"><a href="#11-2ã€æ ¡éªŒ" class="headerlink" title="11.2ã€æ ¡éªŒ"></a>11.2ã€æ ¡éªŒ</h3><p>æœåŠ¡ç«¯æ ¡éªŒï¼š</p>
<ul>
<li>æ§åˆ¶å±‚conrollerï¼šæ ¡éªŒé¡µé¢è¯·æ±‚çš„å‚æ•°çš„åˆæ³•æ€§ã€‚åœ¨æœåŠ¡ç«¯æ§åˆ¶å±‚conrolleræ ¡éªŒï¼Œä¸åŒºåˆ†å®¢æˆ·ç«¯ç±»å‹ï¼ˆæµè§ˆå™¨ã€æ‰‹æœºå®¢æˆ·ç«¯ã€è¿œç¨‹è°ƒç”¨ï¼‰</li>
<li>ä¸šåŠ¡å±‚serviceï¼ˆä½¿ç”¨è¾ƒå¤šï¼‰ï¼šä¸»è¦æ ¡éªŒå…³é”®ä¸šåŠ¡å‚æ•°ï¼Œä»…é™äºserviceæ¥å£ä¸­ä½¿ç”¨çš„å‚æ•°ã€‚</li>
<li>æŒä¹…å±‚daoï¼šä¸€èˆ¬æ˜¯ä¸æ ¡éªŒçš„ã€‚</li>
</ul>
<p>ä¸€èˆ¬ä½¿ç”¨hibernateçš„æ ¡éªŒæ¡†æ¶ï¼Œä¾èµ–<code>hibernate-validator.jar</code>,<code>jboss-logging.jar</code>,<code>validation-api.jar</code>è¿™å‡ ä¸ªjaråŒ…</p>
<p>å¼€å‘æ­¥éª¤</p>
<ul>
<li>åœ¨springmvc.xmlä¸­æ·»åŠ æ ¡éªŒå™¨</li>
<li>æ ¡éªŒå™¨æ³¨å…¥åˆ°å¤„ç†å™¨é€‚é…å™¨ä¸­</li>
<li>åœ¨CustomValidationMessages.propertiesé…ç½®æ ¡éªŒé”™è¯¯ä¿¡æ¯</li>
<li>åœ¨pojoä¸­æ·»åŠ æ ¡éªŒè§„åˆ™</li>
<li>åœ¨æ§åˆ¶å™¨ä¸­å¯¹å‚æ•°æ³¨è§£<code>@Validated</code>æ¥æ•è·å’Œæ˜¾ç¤ºæ ¡éªŒé”™è¯¯ä¿¡æ¯</li>
</ul>
<p>åˆ†ç»„æ ¡éªŒ</p>
<ul>
<li>å®šä¹‰æ ¡éªŒåˆ†ç»„</li>
<li>åœ¨æ ¡éªŒè§„åˆ™ä¸­æ·»åŠ åˆ†ç»„</li>
<li>åœ¨controlleræ–¹æ³•ä½¿ç”¨æŒ‡å®šåˆ†ç»„çš„æ ¡éªŒ</li>
</ul>
<h3 id="11-3ã€æ•°æ®å›æ˜¾"><a href="#11-3ã€æ•°æ®å›æ˜¾" class="headerlink" title="11.3ã€æ•°æ®å›æ˜¾"></a>11.3ã€æ•°æ®å›æ˜¾</h3><p>æ•°æ®å›æ˜¾æœ‰ä¸‰ç§æ–¹æ³•</p>
<ul>
<li>1.springmvcé»˜è®¤å¯¹pojoæ•°æ®è¿›è¡Œå›æ˜¾ã€‚<ul>
<li>pojoæ•°æ®ä¼ å…¥controlleræ–¹æ³•åï¼Œspringmvcè‡ªåŠ¨å°†pojoæ•°æ®æ”¾åˆ°requeståŸŸï¼Œkeyç­‰äºpojoç±»å‹ï¼ˆé¦–å­—æ¯å°å†™ï¼‰</li>
<li>ä½¿ç”¨<code>@ModelAttribute</code>æŒ‡å®špojoå›æ˜¾åˆ°é¡µé¢åœ¨requestä¸­çš„key</li>
</ul>
</li>
<li>2.<code>@ModelAttribute</code>è¿˜å¯ä»¥å°†æ–¹æ³•çš„è¿”å›å€¼ä¼ åˆ°é¡µé¢</li>
<li>3.ä½¿ç”¨æœ€ç®€å•æ–¹æ³•ä½¿ç”¨modelï¼Œå¯ä»¥ä¸ç”¨<code>@ModelAttribute</code></li>
</ul>
<h3 id="11-4ã€å¼‚å¸¸å¤„ç†"><a href="#11-4ã€å¼‚å¸¸å¤„ç†" class="headerlink" title="11.4ã€å¼‚å¸¸å¤„ç†"></a>11.4ã€å¼‚å¸¸å¤„ç†</h3><p>ç³»ç»Ÿçš„daoã€serviceã€controllerå‡ºç°éƒ½é€šè¿‡throws Exceptionå‘ä¸ŠæŠ›å‡ºï¼Œæœ€åç”±springmvcå‰ç«¯æ§åˆ¶å™¨äº¤ç”±å¼‚å¸¸å¤„ç†å™¨è¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚</p>
<p>springmvcæä¾›å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼ˆä¸€ä¸ªç³»ç»Ÿåªæœ‰ä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨ï¼‰è¿›è¡Œç»Ÿä¸€å¼‚å¸¸å¤„ç†ã€‚</p>
<p>å…¨å±€å¼‚å¸¸å¤„ç†å™¨å¤„ç†æ€è·¯ï¼š</p>
<p>è§£æå‡ºå¼‚å¸¸ç±»å‹</p>
<ul>
<li>å¦‚æœè¯¥å¼‚å¸¸ç±»å‹æ˜¯ç³»ç»Ÿè‡ªå®šä¹‰çš„å¼‚å¸¸ï¼Œç›´æ¥å–å‡ºå¼‚å¸¸ä¿¡æ¯ï¼Œåœ¨é”™è¯¯é¡µé¢å±•ç¤º</li>
<li>å¦‚æœè¯¥å¼‚å¸¸ç±»å‹ä¸æ˜¯ç³»ç»Ÿè‡ªå®šä¹‰çš„å¼‚å¸¸ï¼Œæ„é€ ä¸€ä¸ªè‡ªå®šä¹‰çš„å¼‚å¸¸ç±»å‹ï¼ˆä¿¡æ¯ä¸ºâ€œæœªçŸ¥é”™è¯¯â€ï¼‰</li>
</ul>
<p>æŠ›å‡ºå¼‚å¸¸çš„ä½ç½®</p>
<ul>
<li>å¦‚æœä¸ä¸šåŠ¡åŠŸèƒ½ç›¸å…³çš„å¼‚å¸¸ï¼Œå»ºè®®åœ¨serviceä¸­æŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li>ä¸ä¸šåŠ¡åŠŸèƒ½æ²¡æœ‰å…³ç³»çš„å¼‚å¸¸ï¼Œå»ºè®®åœ¨controllerä¸­æŠ›å‡ºã€‚</li>
</ul>
<h3 id="11-5ã€ä¸Šä¼ å›¾ç‰‡"><a href="#11-5ã€ä¸Šä¼ å›¾ç‰‡" class="headerlink" title="11.5ã€ä¸Šä¼ å›¾ç‰‡"></a>11.5ã€ä¸Šä¼ å›¾ç‰‡</h3><p>å¼€å‘æ­¥éª¤</p>
<ul>
<li>åœ¨é¡µé¢formä¸­æäº¤enctype=â€multipart/form-dataâ€çš„æ•°æ®æ—¶ï¼Œéœ€è¦springmvcå¯¹multipartç±»å‹çš„æ•°æ®è¿›è¡Œè§£æã€‚</li>
<li>åœ¨springmvc.xmlä¸­é…ç½®multipartç±»å‹è§£æå™¨</li>
<li>åŠ å…¥ä¸Šä¼ å›¾ç‰‡çš„jarï¼š<code>commons-fileupload</code></li>
<li>åˆ›å»ºå›¾ç‰‡è™šæ‹Ÿç›®å½•å­˜å‚¨å›¾ç‰‡</li>
</ul>
<h3 id="11-6ã€jsonæ•°æ®äº¤äº’"><a href="#11-6ã€jsonæ•°æ®äº¤äº’" class="headerlink" title="11.6ã€jsonæ•°æ®äº¤äº’"></a>11.6ã€jsonæ•°æ®äº¤äº’</h3><p>ä¸¤ç§jsonæ•°æ®äº¤äº’çš„å½¢å¼ï¼š</p>
<ul>
<li>è¯·æ±‚jsonã€è¾“å‡ºjsonï¼Œè¦æ±‚è¯·æ±‚çš„æ˜¯jsonä¸²ï¼Œæ‰€ä»¥åœ¨å‰ç«¯é¡µé¢ä¸­éœ€è¦å°†è¯·æ±‚çš„å†…å®¹è½¬æˆjsonï¼Œä¸å¤ªæ–¹ä¾¿ã€‚</li>
<li>è¯·æ±‚key/valueã€è¾“å‡ºjsonã€‚æ­¤æ–¹æ³•æ¯”è¾ƒå¸¸ç”¨ã€‚</li>
</ul>
<p>éœ€è¦çš„ä¾èµ–ï¼š</p>
<ul>
<li><code>jackson-databind</code></li>
<li><code>jackson-mapper-asl</code></li>
</ul>
<p>åœ¨æ³¨è§£é€‚é…å™¨ä¸­åŠ å…¥<code>messageConverters</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ³¨è§£é€‚é…å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;messageConverters&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJacksonHttpMessageConverter&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼šå¦‚æœä½¿ç”¨<code>&lt;mvc:annotation-driven /&gt;</code>åˆ™ä¸ç”¨å®šä¹‰ä¸Šè¾¹çš„å†…å®¹ã€‚</strong></p>
<p>åœ¨controllerçš„è¿”å›å€¼ä¸ŠåŠ æ³¨è§£<code>@ResponseBody</code>æ¥å°†javaå¯¹è±¡è¾“å‡ºjsonï¼Œè¿”å›jsonæ ¼å¼æ•°æ®</p>
<h3 id="11-7ã€RESTfulæ”¯æŒ"><a href="#11-7ã€RESTfulæ”¯æŒ" class="headerlink" title="11.7ã€RESTfulæ”¯æŒ"></a>11.7ã€RESTfulæ”¯æŒ</h3><p><code>@RequestMapping(value=&quot;/ itemsView/&#123;id&#125;&quot;)</code>ï¼š<code>&#123;Ã—Ã—Ã—&#125;</code>å ä½ç¬¦ï¼Œè¯·æ±‚çš„URLå¯ä»¥æ˜¯<code>/viewItems/1</code>æˆ–<code>/viewItems/2</code>ï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸­ä½¿ç”¨<code>@PathVariable</code>è·å–{Ã—Ã—Ã—}ä¸­çš„Ã—Ã—Ã—å˜é‡ã€‚<code>@PathVariable</code>ç”¨äºå°†è¯·æ±‚URLä¸­çš„æ¨¡æ¿å˜é‡æ˜ å°„åˆ°åŠŸèƒ½å¤„ç†æ–¹æ³•çš„å‚æ•°ä¸Šã€‚</p>
<p>å¦‚æœ<code>@RequestMapping</code>ä¸­è¡¨ç¤ºä¸º<code>/itemsView/&#123;id&#125;</code>ï¼Œidå’Œå½¢å‚åç§°ä¸€è‡´ï¼Œ<code>@PathVariable</code>ä¸ç”¨æŒ‡å®šåç§°ã€‚</p>
<p>åŒæ—¶éœ€è¦é…ç½®å‰ç«¯æ§åˆ¶å™¨ã€‚è‹¥è¦è®¿é—®é™æ€èµ„æºï¼Œè¿˜éœ€åœ¨springmvc.xmlä¸­æ·»åŠ é™æ€èµ„æºè§£ææ–¹æ³•,å¦‚<code>&lt;mvc:resources location=&quot;/js/&quot; mapping=&quot;/js/**&quot;/&gt;</code></p>
<h3 id="11-8ã€æ‹¦æˆªå™¨"><a href="#11-8ã€æ‹¦æˆªå™¨" class="headerlink" title="11.8ã€æ‹¦æˆªå™¨"></a>11.8ã€æ‹¦æˆªå™¨</h3><h4 id="11-8-1ã€æ‹¦æˆªå™¨å®šä¹‰"><a href="#11-8-1ã€æ‹¦æˆªå™¨å®šä¹‰" class="headerlink" title="11.8.1ã€æ‹¦æˆªå™¨å®šä¹‰"></a>11.8.1ã€æ‹¦æˆªå™¨å®šä¹‰</h4><p>å®šä¹‰æ‹¦æˆªå™¨ï¼Œå®ç°<code>HandlerInterceptor</code>æ¥å£ã€‚æ¥å£ä¸­æä¾›ä¸‰ä¸ªæ–¹æ³•ã€‚å¯ä»¥ä»åç§°å’Œå‚æ•°çœ‹å‡ºå„ä¸ªæ¥å£çš„é¡ºåºå’Œä½œç”¨</p>
<ul>
<li><code>public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception</code><ul>
<li>å‚æ•°æœ€å°‘ï¼Œåªæœ‰ä¸‰ä¸ª</li>
<li>è¿›å…¥ Handleræ–¹æ³•ä¹‹å‰æ‰§è¡Œ</li>
<li>ç”¨äºèº«ä»½è®¤è¯ã€èº«ä»½æˆæƒã€‚æ¯”å¦‚èº«ä»½è®¤è¯ï¼Œå¦‚æœè®¤è¯é€šè¿‡è¡¨ç¤ºå½“å‰ç”¨æˆ·æ²¡æœ‰ç™»é™†ï¼Œéœ€è¦æ­¤æ–¹æ³•æ‹¦æˆªä¸å†å‘ä¸‹æ‰§è¡Œ</li>
</ul>
</li>
<li><code>public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception</code><ul>
<li>å¤šäº†ä¸€ä¸ªmodelAndViewå‚æ•°</li>
<li>è¿›å…¥Handleræ–¹æ³•ä¹‹åï¼Œè¿”å›modelAndViewä¹‹å‰æ‰§è¡Œ </li>
<li>åº”ç”¨åœºæ™¯ä»modelAndViewå‡ºå‘ï¼šå°†å…¬ç”¨çš„æ¨¡å‹æ•°æ®(æ¯”å¦‚èœå•å¯¼èˆª)åœ¨è¿™é‡Œä¼ åˆ°è§†å›¾ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œç»Ÿä¸€æŒ‡å®šè§†å›¾</li>
</ul>
</li>
<li><code>public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception</code><ul>
<li>å¤šäº†ä¸€ä¸ªExceptionçš„ç±»å‹çš„å‚æ•°</li>
<li>æ‰§è¡ŒHandlerå®Œæˆæ‰§è¡Œæ­¤æ–¹æ³•</li>
<li>åº”ç”¨åœºæ™¯ï¼šç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œç»Ÿä¸€æ—¥å¿—å¤„ç†</li>
</ul>
</li>
</ul>
<h4 id="11-8-2ã€æ‹¦æˆªå™¨çš„é…ç½®"><a href="#11-8-2ã€æ‹¦æˆªå™¨çš„é…ç½®" class="headerlink" title="11.8.2ã€æ‹¦æˆªå™¨çš„é…ç½®"></a>11.8.2ã€æ‹¦æˆªå™¨çš„é…ç½®</h4><ul>
<li>é’ˆå¯¹HandlerMappingé…ç½®(ä¸€èˆ¬ä¸æ¨è)<ul>
<li>springmvcæ‹¦æˆªå™¨é’ˆå¯¹HandlerMappingè¿›è¡Œæ‹¦æˆªè®¾ç½®ï¼Œå¦‚æœåœ¨æŸä¸ªHandlerMappingä¸­é…ç½®æ‹¦æˆªï¼Œç»è¿‡è¯¥HandlerMappingæ˜ å°„æˆåŠŸçš„handleræœ€ç»ˆä½¿ç”¨è¯¥æ‹¦æˆªå™¨ </li>
</ul>
</li>
<li>ç±»ä¼¼å…¨å±€çš„æ‹¦æˆªå™¨<ul>
<li>springmvcé…ç½®ç±»ä¼¼å…¨å±€çš„æ‹¦æˆªå™¨ï¼Œspringmvcæ¡†æ¶å°†é…ç½®çš„ç±»ä¼¼å…¨å±€çš„æ‹¦æˆªå™¨æ³¨å…¥åˆ°æ¯ä¸ªHandlerMappingä¸­ã€‚ </li>
</ul>
</li>
</ul>
<h4 id="11-8-3ã€æ‹¦æˆªå™¨æµ‹è¯•åŠå…¶åº”ç”¨"><a href="#11-8-3ã€æ‹¦æˆªå™¨æµ‹è¯•åŠå…¶åº”ç”¨" class="headerlink" title="11.8.3ã€æ‹¦æˆªå™¨æµ‹è¯•åŠå…¶åº”ç”¨"></a>11.8.3ã€æ‹¦æˆªå™¨æµ‹è¯•åŠå…¶åº”ç”¨</h4><p>é“¾å¼æ‰§è¡Œæµ‹è¯•</p>
<ul>
<li>ä¸¤ä¸ªæ‹¦æˆªå™¨éƒ½æ”¾è¡Œ<ul>
<li>preHandleæ–¹æ³•æŒ‰é¡ºåºæ‰§è¡Œï¼ŒpostHandleå’ŒafterCompletionæŒ‰æ‹¦æˆªå™¨é…ç½®çš„é€†å‘é¡ºåºæ‰§è¡Œ</li>
</ul>
</li>
<li>æ‹¦æˆªå™¨1æ”¾è¡Œï¼Œæ‹¦æˆªå™¨2ä¸æ”¾è¡Œ<ul>
<li>æ‹¦æˆªå™¨1æ”¾è¡Œï¼Œæ‹¦æˆªå™¨2 preHandleæ‰ä¼šæ‰§è¡Œã€‚</li>
<li>æ‹¦æˆªå™¨2 preHandleä¸æ”¾è¡Œï¼Œæ‹¦æˆªå™¨2 postHandleå’ŒafterCompletionä¸ä¼šæ‰§è¡Œã€‚</li>
<li>åªè¦æœ‰ä¸€ä¸ªæ‹¦æˆªå™¨ä¸æ”¾è¡Œï¼ŒpostHandleä¸ä¼šæ‰§è¡Œã€‚</li>
</ul>
</li>
<li>ä¸¤ä¸ªæ‹¦æˆªå™¨éƒ½ä¸æ”¾ <ul>
<li>æ‹¦æˆªå™¨1 preHandleä¸æ”¾è¡Œï¼ŒpostHandleå’ŒafterCompletionä¸ä¼šæ‰§è¡Œã€‚</li>
<li>æ‹¦æˆªå™¨1 preHandleä¸æ”¾è¡Œï¼Œæ‹¦æˆªå™¨2ä¸æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
<p>åº”ç”¨</p>
<ul>
<li>ç»Ÿä¸€æ—¥å¿—å¤„ç†æ‹¦æˆªå™¨ï¼Œéœ€è¦è¯¥æ‹¦æˆªå™¨preHandleä¸€å®šè¦æ”¾è¡Œï¼Œä¸”å°†å®ƒæ”¾åœ¨æ‹¦æˆªå™¨é“¾æ¥ä¸­ç¬¬ä¸€ä¸ªä½ç½®ã€‚</li>
<li>ç™»é™†è®¤è¯æ‹¦æˆªå™¨ï¼Œæ”¾åœ¨æ‹¦æˆªå™¨é“¾æ¥ä¸­ç¬¬ä¸€ä¸ªä½ç½®ã€‚æƒé™æ ¡éªŒæ‹¦æˆªå™¨ï¼Œæ”¾åœ¨ç™»é™†è®¤è¯æ‹¦æˆªå™¨ä¹‹åã€‚ï¼ˆå› ä¸ºç™»é™†é€šè¿‡åæ‰æ ¡éªŒæƒé™ï¼Œå½“ç„¶ç™»å½•è®¤è¯æ‹¦æˆªå™¨è¦æ”¾åœ¨ç»Ÿä¸€æ—¥å¿—å¤„ç†æ‹¦æˆªå™¨åé¢ï¼‰</li>
</ul>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Springå­¦ä¹ ç¬”è®°</title>
    <url>/2021/02/05/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Springå­¦ä¹ ç¬”è®°"><a href="#Springå­¦ä¹ ç¬”è®°" class="headerlink" title="Springå­¦ä¹ ç¬”è®°"></a>Springå­¦ä¹ ç¬”è®°</h1><h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h2><p>springç†å¿µï¼šæ˜¯ç°æœ‰çš„æŠ€æœ¯æ›´åŠ å®¹æ˜“ä½¿ç”¨ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ã€‚</p>
<ul>
<li>SSHï¼šStruct2 + Spring + Hibernate</li>
<li>SSM: SpringMVC + Spring + Mybatis</li>
</ul>
<p>å®˜ç½‘ï¼š <a href="https://spring.io/projects/spring-framework#overview">https://spring.io/projects/spring-framework#overview</a> </p>
<p>å®˜æ–¹ä¸‹è½½ï¼š <a href="https://repo.spring.io/release/org/springframework/spring/">https://repo.spring.io/release/org/springframework/spring/</a> </p>
<p>GitHubï¼š <a href="https://github.com/spring-projects/spring-framework">https://github.com/spring-projects/spring-framework</a> </p>
<p><a href="https://mvnrepository.com/artifact/org.springframework/spring-webmvc">Spring Web MVC</a> <strong>Â»</strong> <a href="https://mvnrepository.com/artifact/org.springframework/spring-webmvc/5.2.5.RELEASE">5.2.5.RELEASE</a></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>springæ˜¯å¼€æºçš„å…è´¹çš„å®¹å™¨ã€‚</li>
<li>springæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ï¼Œéå…¥ä¾µå¼çš„ã€‚</li>
<li>æ§åˆ¶åè½¬ï¼ˆIOCï¼‰ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ (AOP)ã€‚</li>
<li>æ”¯æŒäº‹åŠ¡å¤„ç†ï¼Œå¯¹æ¡†æ¶æ•´åˆçš„æ”¯æŒã€‚</li>
</ul>
<p>æ€»ç»“ï¼šspringæ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬(IOC)å’Œé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)çš„æ¡†æ¶ã€‚</p>
<h2 id="2-IOCç†è®º"><a href="#2-IOCç†è®º" class="headerlink" title="2.IOCç†è®º"></a>2.IOCç†è®º</h2><ol>
<li><p>UserDao</p>
</li>
<li><p>UserDaoImp</p>
</li>
<li><p>UserSevice</p>
</li>
<li><p>UserServiceImp</p>
</li>
</ol>
<p>åœ¨ä¹‹å‰ï¼Œç”¨æˆ·çš„éœ€æ±‚å¯èƒ½ä¼šå½±å“åŸæ¥çš„ä»£ç ã€‚</p>
<p>ä½¿ç”¨ä¸€ä¸ªsetã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>ä¹‹å‰æ˜¯ä¸»åŠ¨åˆ›å»ºå¯¹è±¡ï¼Œæ§åˆ¶æƒåœ¨ç¨‹åºå‘˜æ‰‹ä¸Šã€‚</p>
</li>
<li><p>ä½¿ç”¨setä¹‹åï¼Œæ˜¯è¢«åŠ¨æ¥å—å¯¹è±¡ã€‚</p>
</li>
</ul>
<h2 id="3-Hello-Spring"><a href="#3-Hello-Spring" class="headerlink" title="3. Hello Spring"></a>3. Hello Spring</h2><p>pojoä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>resourceä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--bean = å¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id = å˜é‡å--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--class = newçš„å¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--property ç›¸å½“äºç»™å¯¹è±¡ä¸­çš„å±æ€§è®¾å€¼--&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.pojo.Hello&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Spring&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>testä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.hou.pojo.Hello;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mytest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–springä¸Šä¸‹æ–‡å¯¹è±¡</span></span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//æˆ‘ä»¬çš„å¯¹è±¡ä¸‹èƒ½åœ¨éƒ½åœ¨springÂ·ä¸­ç®¡ç†äº†ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ï¼Œç›´æ¥å–å‡ºæ¥å°±å¯ä»¥äº†</span></span><br><span class="line">        Hello hello = (Hello) context.getBean(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        System.out.println(hello.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>bean = å¯¹è±¡<br>id = å˜é‡å<br>class = newçš„å¯¹è±¡<br>property ç›¸å½“äºç»™å¯¹è±¡ä¸­çš„å±æ€§è®¾å€¼</p>
<p>æ ¸å¿ƒç”¨setæ³¨å…¥</p>
<p>ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userdaomysql&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.hou.zhuang.UserDaoMysqlImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.service.UserServiceImp&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--refå¼•ç”¨springä¸­å·²ç»åˆ›å»ºå¾ˆå¥½çš„å¯¹è±¡--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--valueæ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userdaomysql&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"><a href="#4-IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼" class="headerlink" title="4. IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"></a>4. IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h2><ol>
<li>ä½¿ç”¨æ— å‚æ„é€ åˆ›å»ºå¯¹è±¡ï¼Œé»˜è®¤ã€‚</li>
<li>ä½¿ç”¨æœ‰å‚æ„é€ </li>
</ol>
<p>ä¸‹æ ‡èµ‹å€¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hou&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç±»å‹èµ‹å€¼ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;dong&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥é€šè¿‡å‚æ•°å</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hou&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="5-Springé…ç½®"><a href="#5-Springé…ç½®" class="headerlink" title="5. Springé…ç½®"></a>5. Springé…ç½®</h2><p><strong>åˆ«å</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zhuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhuang&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;user2aaa&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>Beançš„é…ç½®</strong></p>
<ul>
<li>idï¼šbeançš„idæ ‡è¯†ç¬¦</li>
<li>classï¼šbeanå¯¹è±¡æ‰€å¯¹åº”çš„ç±»å‹</li>
<li>nameï¼šåˆ«åï¼Œæ›´é«˜çº§ï¼Œå¯ä»¥åŒæ—¶å–å¤šä¸ªåˆ«åã€‚</li>
</ul>
<p><strong>import</strong></p>
<p>ä¸€èˆ¬ç”¨äºå›¢é˜Ÿå¼€å‘ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯¼å…¥åˆå¹¶ä¸ºä¸€ä¸ª</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-DIä¾èµ–æ³¨å…¥"><a href="#6-DIä¾èµ–æ³¨å…¥" class="headerlink" title="6. DIä¾èµ–æ³¨å…¥"></a>6. DIä¾èµ–æ³¨å…¥</h2><p><strong>æ„é€ å™¨æ³¨å…¥</strong></p>
<p><strong>setæ–¹å¼æ³¨å…¥</strong>ï¼ˆé‡ç‚¹ï¼‰</p>
<ul>
<li>ä¾èµ–ï¼šbeanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨</li>
<li>æ³¨å…¥ï¼šbeanå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œç”±å®¹å™¨æ¥æ³¨å…¥</li>
</ul>
<p>ã€ç¯å¢ƒæ­å»ºã€‘</p>
<ol>
<li>å¤æ‚ç±»å‹</li>
<li>çœŸå®æµ‹è¯•å¯¹è±¡</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] books;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hobbies;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; card;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; game;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Properties infor;</span><br><span class="line">    <span class="keyword">private</span> String wife;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&quot;</span> + address +</span><br><span class="line">                <span class="string">&quot;, books=&quot;</span> + Arrays.toString(books) +</span><br><span class="line">                <span class="string">&quot;, hobbies=&quot;</span> + hobbies +</span><br><span class="line">                <span class="string">&quot;, card=&quot;</span> + card +</span><br><span class="line">                <span class="string">&quot;, game=&quot;</span> + game +</span><br><span class="line">                <span class="string">&quot;, infor=&quot;</span> + infor +</span><br><span class="line">                <span class="string">&quot;, wife=&#x27;&quot;</span> + wife + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Address&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;address&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.Address&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;xian&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hou&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--æ•°ç»„æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ä¸‰å›½<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>è¥¿æ¸¸<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ°´æµ’<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--list--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hobbies&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>eat<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>drink<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>play<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;12&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;23&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;game&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>wangzhe<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>daota<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>lol<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">null</span>&gt;</span><span class="tag">&lt;/<span class="name">null</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--properties--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;infor&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;id&quot;</span>&gt;</span>20200405<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;name&quot;</span>&gt;</span>hdk<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬ä¸‰æ–¹</strong></p>
<p>pæ ‡ç­¾å’Œcæ ‡ç­¾</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:c</span>=<span class="string">&quot;http://www.springframework.org/schema/c&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--på‘½åç©ºé—´æ³¨å…¥ï¼Œå¯ä»¥ç›´æ¥æ³¨å…¥å±æ€§çš„å€¼/setæ³¨å…¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;use&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.User&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;dong&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--cå‘½åç©ºé—´é€šè¿‡æ„é€ å™¨æ³¨å…¥/æ„é€ å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;use2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.User&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;kun&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;19&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>beançš„ä½œç”¨åŸŸ</strong></p>
<ol>
<li>å•ä¾‹æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;use2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.User&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;kun&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;19&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åŸå‹æ¨¡å¼: æ¯æ¬¡ä»å®¹å™¨ä¸­getçš„æ—¶å€™ï¼Œéƒ½äº§ç”Ÿä¸€ä¸ªæ–°å¯¹è±¡ï¼</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;use2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.User&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;kun&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;19&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å…¶ä½™çš„requestã€sessionã€applicationè¿™äº›åªèƒ½åœ¨webå¼€æ”¾ä¸­ä½¿ç”¨ï¼</li>
</ol>
<h2 id="7-Beançš„è‡ªåŠ¨è£…é…"><a href="#7-Beançš„è‡ªåŠ¨è£…é…" class="headerlink" title="7. Beançš„è‡ªåŠ¨è£…é…"></a>7. Beançš„è‡ªåŠ¨è£…é…</h2><ul>
<li><p>è‡ªåŠ¨è£…é…æ˜¯Springæ˜¯æ»¡è¶³beanä¾èµ–çš„ä¸€ç§æ–¹å¼</p>
</li>
<li><p>Springä¼šåœ¨ä¸Šä¸‹æ–‡è‡ªåŠ¨å¯»æ‰¾ï¼Œå¹¶è‡ªåŠ¨ç»™beanè£…é…å±æ€§</p>
</li>
</ul>
<p>åœ¨Springä¸­æœ‰ä¸‰ç§è£…é…çš„æ–¹å¼</p>
<ol>
<li><p>åœ¨xmlä¸­æ˜¾ç¤ºé…ç½®</p>
</li>
<li><p>åœ¨javaä¸­æ˜¾ç¤ºé…ç½®</p>
</li>
<li><p>éšå¼çš„è‡ªåŠ¨è£…é…bean ã€é‡è¦ã€‘</p>
</li>
<li><p>ç¯å¢ƒæ­å»ºï¼šä¸€ä¸ªäººæœ‰ä¸¤ä¸ªå® ç‰©</p>
</li>
<li><p>Bynameè‡ªåŠ¨è£…é…ï¼šbynameä¼šè‡ªåŠ¨æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡setå¯¹åº”çš„å€¼å¯¹åº”çš„id</p>
<p>ä¿è¯æ‰€æœ‰idå”¯ä¸€ï¼Œå¹¶ä¸”å’Œsetæ³¨å…¥çš„å€¼ä¸€è‡´</p>
</li>
<li><p>Bytypeè‡ªåŠ¨è£…é…ï¼šbyTypeä¼šè‡ªåŠ¨æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡å±æ€§ç›¸åŒçš„bean</p>
<p>ä¿è¯æ‰€æœ‰çš„classå”¯ä¸€</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jiao</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;miao&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jiao</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;wow&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.pojo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;People&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cat=&quot;</span> + cat +</span><br><span class="line">                <span class="string">&quot;, dog=&quot;</span> + dog +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">getCat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCat</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cat = cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">getDog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDog</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dog = dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat11&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--bynameä¼šè‡ªåŠ¨æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡setå¯¹åº”çš„å€¼å¯¹åº”çš„id--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;bean id=&quot;people&quot; class=&quot;com.pojo.People&quot; autowire=&quot;byName&quot;&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;property name=&quot;name&quot; value=&quot;hou&quot;&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/bean&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--byTypeä¼šè‡ªåŠ¨æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡å±æ€§ç›¸åŒçš„bean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;people&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.pojo.People&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hou&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°ç»“ï¼š</p>
<ul>
<li>bynameçš„æ—¶å€™ï¼Œéœ€è¦ä¿è¯æ‰€æœ‰beançš„idå”¯ä¸€ï¼Œå¹¶ä¸”è¿™ä¸ªbeanéœ€è¦å’Œè‡ªåŠ¨æ³¨å…¥çš„å±æ€§çš„setæ–¹æ³•çš„å€¼ä¸€è‡´ï¼</li>
<li>bytypeçš„æ—¶å€™ï¼Œéœ€è¦ä¿è¯æ‰€æœ‰beançš„classå”¯ä¸€ï¼Œå¹¶ä¸”è¿™ä¸ªbeanéœ€è¦å’Œè‡ªåŠ¨æ³¨å…¥çš„å±æ€§çš„ç±»å‹ä¸€è‡´ï¼</li>
</ul>
<h3 id="ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…"><a href="#ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…" class="headerlink" title="ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…"></a>ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…</h3><p>jdk1.5æ”¯æŒçš„æ³¨è§£ï¼Œspring2.5æ”¯æŒçš„æ³¨è§£</p>
<p> The introduction of annotation-based configuration raised the question of whether this approach is â€œbetterâ€ than XML. </p>
<p>å¯¼å…¥contextçº¦æŸ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>@Autowire</strong></p>
<p>åœ¨å±æ€§ä¸Šä¸ªä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨setä¸Šä½¿ç”¨</p>
<p>ä½¿ç”¨**@Autowire**æˆ‘ä»¬å¯ä»¥ä¸ç”¨ç¼–å†™setæ–¹æ³•äº†ï¼Œå‰ææ˜¯ä½ è¿™ä¸ªè‡ªåŠ¨è£…é…çš„å±æ€§åœ¨IOC(spring)å®¹å™¨ä¸­å­˜åœ¨ï¼Œä¸”ç¬¦åˆåå­—byname</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">@Nullable å­—æ®µæ ‡å¿—çš„æ³¨è§£ï¼Œè¯´æ˜è¿™ä¸ªå­—æ®µå¯ä»¥ä¸ºnull</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ@Autowiredè‡ªåŠ¨è£…é…ç¯å¢ƒæ¯”è¾ƒå¤æ‚ã€‚è‡ªåŠ¨è£…é…æ— æ³•é€šè¿‡ä¸€ä¸ªæ³¨è§£å®Œæˆçš„æ—¶å€™</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Qualifier(value = â€œdogâ€)å»é…åˆä½¿ç”¨ï¼ŒæŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„idå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value = &quot;dog&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Resource(name=â€dogâ€)ä¹Ÿå¯ä»¥</p>
<p>åŒºåˆ«ï¼š</p>
<ul>
<li>@autowireé»˜è®¤é€šè¿‡bynameå®ç°ï¼Œè€Œä¸”å¿…é¡»è¦æ±‚è¿™ä¸ªå¯¹è±¡å­˜åœ¨</li>
<li>@resourceé»˜è®¤é€šè¿‡byNameå®ç°ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé€šè¿‡byTypeå®ç°</li>
</ul>
<h2 id="8-ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8-ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8. ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8. ä½¿ç”¨æ³¨è§£å¼€å‘</h2><p>åœ¨spring4ä¹‹åï¼Œå¿…é¡»è¦ä¿è¯aopçš„åŒ…å¯¼å…¥</p>
<p>ä½¿ç”¨æ³¨è§£éœ€è¦å¯¼å…¥contexçš„çº¦æŸ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>å±æ€§å¦‚ä½•æ³¨å…¥</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Value(&quot;dong&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è¡ç”Ÿçš„æ³¨è§£</li>
</ol>
<p>@Componentæœ‰å‡ ä¸ªè¡ç”Ÿæ³¨è§£ï¼Œä¼šæŒ‰ç…§webå¼€å‘ä¸­ï¼Œmvcæ¶æ„ä¸­åˆ†å±‚ã€‚</p>
<ul>
<li>dao ï¼ˆ@Repositoryï¼‰</li>
<li>serviceï¼ˆ@Serviceï¼‰</li>
<li>controllerï¼ˆ@Controllerï¼‰</li>
</ul>
<p>è¿™å››ä¸ªæ³¨è§£åŠŸèƒ½ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä»£è¡¨å°†æŸä¸ªç±»æ³¨å†Œåˆ°å®¹å™¨ä¸­</p>
<ol start="3">
<li>ä½œç”¨åŸŸ</li>
</ol>
<p>@Scope(â€œsingletonâ€)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;dong&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°ç»“ï¼š</p>
<p>xmlä¸æ³¨è§£</p>
<ul>
<li>xmlæ›´åŠ ä¸‡èƒ½ï¼Œç»´æŠ¤ç®€å•</li>
<li>æ³¨è§£ï¼Œä¸æ˜¯è‡ªå·±çš„ç±»ï¼Œä½¿ç”¨ä¸äº†ï¼Œç»´æŠ¤å¤æ‚</li>
</ul>
<p>æœ€ä½³å®è·µï¼š</p>
<ul>
<li>xmlç”¨æ¥ç®¡ç†bean</li>
<li>æ³¨è§£åªç”¨æ¥å®Œæˆå±æ€§çš„æ³¨å…¥</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æŒ‡å®šè¦æ‰«æçš„åŒ…--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.pojo&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="9-ä½¿ç”¨javaæ–¹å¼é…ç½®spring"><a href="#9-ä½¿ç”¨javaæ–¹å¼é…ç½®spring" class="headerlink" title="9. ä½¿ç”¨javaæ–¹å¼é…ç½®spring"></a>9. ä½¿ç”¨javaæ–¹å¼é…ç½®spring</h2><p>JavaConfig</p>
<p>Springçš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œåœ¨spring4ä¹‹åï¼Œï¼Œä»–æˆä¸ºäº†æ ¸å¿ƒåŠŸèƒ½</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//è¿™ä¸ªä¹Ÿä¼šè¢«springå®¹å™¨æ‰˜ç®¡ï¼Œæ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œå› ä¸ºä»–æœ¬æ¥å°±æ˜¯ä¸€ä¸ª@Component</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.pojo&quot;)</span></span><br><span class="line"><span class="meta">@Import(Config2.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;dong&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-åŠ¨æ€ä»£ç†"><a href="#10-åŠ¨æ€ä»£ç†" class="headerlink" title="10. åŠ¨æ€ä»£ç†"></a>10. åŠ¨æ€ä»£ç†</h2><p>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†</p>
<p>è§’è‰²ä¸€æ ·</p>
<p>åŠ¨æ€ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œä¸æ˜¯æˆ‘ä»¬ç›´æ¥å†™å¥½çš„ï¼</p>
<p>åŠ¨æ€ä»£ç†ï¼šåŸºäºæ¥å£ï¼ŒåŸºäºç±»</p>
<ul>
<li>åŸºäºæ¥å£ï¼šJDKçš„åŠ¨æ€ä»£ç†ã€ä½¿ç”¨ã€‘</li>
<li>åŸºäºç±»ï¼šcglib</li>
<li>javaå­—èŠ‚ç </li>
</ul>
<p>InvocationHandlerï¼šè°ƒç”¨å¤„ç†ç¨‹åºå¹¶è¿”å›ä¸€ä¸ªç»“æœã€‚</p>
<p>Proxyï¼šä»£ç†ã€‚ä½œç”¨ï¼šç”ŸæˆåŠ¨æ€ä»£ç†è¿™ä¸ªå®ä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¼šè¿™ä¸ªç±»ï¼Œè‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyInvocation</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¢«ä»£ç†çš„æ¥å£</span></span><br><span class="line">    <span class="keyword">private</span> Rent rent;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRent</span><span class="params">(Rent rent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.rent = rent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”Ÿæˆä»£ç†ç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(<span class="keyword">this</span>.getClass().getClassLoader(),rent.getClass().getInterfaces(),<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¤„ç†ä»£ç†å®ä¾‹ï¼Œå¹¶è¿”å›ç»“æœ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        seeHouse();</span><br><span class="line">        Object result = method.invoke(rent, args);</span><br><span class="line">        fare();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">seeHouse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;see house&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fare</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;fare&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Host</span> <span class="keyword">implements</span> <span class="title">Rent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;host rent&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çœŸå®è§’è‰²</span></span><br><span class="line">        Host host = <span class="keyword">new</span> Host();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä»£ç†è§’è‰²</span></span><br><span class="line">        ProxyInvocation proxyInvocation = <span class="keyword">new</span> ProxyInvocation();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡è°ƒç”¨ç¨‹åºå¤„ç†è§’è‰²æ¥å¤„ç†æˆ‘ä»¬è¦è°ƒç”¨çš„æ¥å£å¯¹è±¡</span></span><br><span class="line">        proxyInvocation.setRent(host);</span><br><span class="line"></span><br><span class="line">        Rent proxy = (Rent) proxyInvocation.getProxy();  <span class="comment">//è¿™é‡Œçš„proxyæ˜¯åŠ¨æ€ç”Ÿæˆçš„</span></span><br><span class="line"></span><br><span class="line">        proxy.rent();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="11-AOP"><a href="#11-AOP" class="headerlink" title="11.AOP"></a>11.AOP</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•ä¸€ï¼šä½¿ç”¨springæ¥å£ã€springAPIæ¥å£å®ç°ã€‘</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beanss</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userservice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.service.UserServiceImp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;log&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.log.Log&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;afterlog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.log.AfterLog&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®aop--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆ‡å…¥ç‚¹ï¼šexpression:è¡¨è¾¾å¼ï¼Œexecutionï¼ˆè¦æ‰§è¡Œçš„ä½ç½®ï¼‰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;point&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.service.UserServiceImp.*(..))&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ‰§è¡Œç¯ç»•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;log&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;afterlog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImp</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;delete&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;query&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;update&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.aop.MethodBeforeAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Log</span> <span class="keyword">implements</span> <span class="title">MethodBeforeAdvice</span> </span>&#123;</span><br><span class="line">    <span class="comment">//methodï¼šè¦æ‰§è¡Œçš„ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//argsï¼šå‚æ•°</span></span><br><span class="line">    <span class="comment">//targetï¼šç›®æ ‡å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(target.getClass().getName()+method.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterLog</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//returnVaule: è¿”å›å€¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object returnValue, Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(method.getName()+returnValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mytest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;ApplcationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//åŠ¨æ€ä»£ç†ä»£ç†çš„æ˜¯æ¥å£</span></span><br><span class="line">        UserService userService = (UserService) context.getBean(<span class="string">&quot;userservice&quot;</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒï¼šè‡ªå®šä¹‰æ¥å®ç°AOPã€ä¸»è¦æ˜¯åˆ‡é¢å®šä¹‰ã€‘å»ºè®®ç¬¬äºŒç§</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userservice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.service.UserServiceImp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;log&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.log.Log&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;afterlog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.log.AfterLog&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;diy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.diy.DiyPointcut&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è‡ªå®šä¹‰åˆ‡é¢--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;diy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--åˆ‡å…¥ç‚¹--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;point&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.service.UserServiceImp.*(..))&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;before&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;after&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DiyPointcut</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;before&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;after&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•ä¸‰ï¼šæ³¨è§£æ–¹å¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;ann&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.diy.Annotation&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userservice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.service.UserServiceImp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span>  <span class="comment">//æ ‡æ³¨è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªåˆ‡é¢</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Annotation</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.service.UserServiceImp.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;before&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.service.UserServiceImp.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;after&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨ç¯ç»•å¢å¼ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™åœ°æš–ç®¡ä¸€ä¸ªå‚æ•°ï¼Œä»£è¡¨æˆ‘ä»¬è¦è·å–åˆ‡å…¥çš„ç‚¹</span></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.service.UserServiceImp.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">around</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;around&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Object proceed = joinPoint.proceed();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;after around&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>Spring æ¡†æ¶,å¦‚æœç±»å®ç°äº†æ¥å£,å°±ä½¿ç”¨ JDK çš„åŠ¨æ€ä»£ç†ç”Ÿæˆä»£ç†å¯¹è±¡,å¦‚æœè¿™ä¸ªç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£,ä½¿ç”¨CGLIB ç”Ÿæˆä»£ç†å¯¹è±¡.ï¼ˆ åº•å±‚ä¼šè‡ªåŠ¨åˆ‡æ¢ï¼‰</p>
<h3 id="Spring-ä»£ç†çŸ¥è¯†æ€»ç»“"><a href="#Spring-ä»£ç†çŸ¥è¯†æ€»ç»“" class="headerlink" title="Spring ä»£ç†çŸ¥è¯†æ€»ç»“"></a>Spring ä»£ç†çŸ¥è¯†æ€»ç»“</h3><p>Spring åœ¨è¿è¡ŒæœŸï¼Œ ç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œ ä¸éœ€è¦ç‰¹æ®Šçš„ç¼–è¯‘å™¨<br>Spring AOP çš„åº•å±‚å°±æ˜¯é€šè¿‡ JDK åŠ¨æ€ä»£ç†æˆ– CGLib åŠ¨æ€ä»£ç†æŠ€æœ¯ ä¸ºç›®æ ‡Bean æ‰§è¡Œæ¨ªå‘ç»‡å…¥</p>
<ul>
<li>1.è‹¥ç›®æ ‡å¯¹è±¡å®ç°äº†è‹¥å¹²æ¥å£ï¼Œ spring ä½¿ç”¨ JDK çš„ <code>java.lang.reflect.Proxy</code> ç±»ä»£ç†ã€‚</li>
<li>2.è‹¥ç›®æ ‡å¯¹è±¡æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œ spring ä½¿ç”¨ CGLIB åº“ç”Ÿæˆç›®æ ‡å¯¹è±¡çš„å­ç±»ã€‚</li>
<li>ç¨‹åºä¸­åº”ä¼˜å…ˆå¯¹æ¥å£åˆ›å»ºä»£ç†ï¼Œ ä¾¿äºç¨‹åºè§£è€¦ç»´æŠ¤</li>
<li>æ ‡è®°ä¸º final çš„æ–¹æ³•ï¼Œ ä¸èƒ½è¢«ä»£ç†ï¼Œ å› ä¸ºæ— æ³•è¿›è¡Œè¦†ç›–</li>
<li>JDK åŠ¨æ€ä»£ç†ï¼Œ æ˜¯é’ˆå¯¹æ¥å£ç”Ÿæˆå­ç±»ï¼Œ æ¥å£ä¸­æ–¹æ³•ä¸èƒ½ä½¿ç”¨ final ä¿®é¥°</li>
<li>CGLib æ˜¯é’ˆå¯¹ç›®æ ‡ç±»ç”Ÿäº§å­ç±»ï¼Œ å› æ­¤ç±»æˆ–æ–¹æ³• ä¸èƒ½ä½¿ final çš„</li>
<li>Spring åªæ”¯æŒæ–¹æ³•è¿æ¥ç‚¹ï¼Œ ä¸æä¾›å±æ€§è¿æ¥</li>
</ul>
<h3 id="JdbcTemplate"><a href="#JdbcTemplate" class="headerlink" title="JdbcTemplate"></a>JdbcTemplate</h3><h4 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql connectorç‰ˆæœ¬å·--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- springç‰ˆæœ¬å· --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.1.5.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-dbcp/commons-dbcp --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-dbcp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-dbcp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="é…ç½®æ•°æ®æº"><a href="#é…ç½®æ•°æ®æº" class="headerlink" title="é…ç½®æ•°æ®æº"></a>é…ç½®æ•°æ®æº</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--åŠ è½½é…ç½®æ–‡ä»¶jdbc.properties--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:jdbc.properties&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Springä¸­é»˜è®¤çš„æ•°æ®æº"><a href="#Springä¸­é»˜è®¤çš„æ•°æ®æº" class="headerlink" title="Springä¸­é»˜è®¤çš„æ•°æ®æº"></a>Springä¸­é»˜è®¤çš„æ•°æ®æº</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--springå†…ç½®æ•°æ®æº--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClass&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="C3P0æ•°æ®æº"><a href="#C3P0æ•°æ®æº" class="headerlink" title="C3P0æ•°æ®æº"></a>C3P0æ•°æ®æº</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--c3p0æ•°æ®æº--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClass&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="DBCPæ•°æ®æº"><a href="#DBCPæ•°æ®æº" class="headerlink" title="DBCPæ•°æ®æº"></a>DBCPæ•°æ®æº</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--DBCPæ•°æ®æº--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClass&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="12-JdbcTemplateçš„å¢åˆ æ”¹æŸ¥"><a href="#12-JdbcTemplateçš„å¢åˆ æ”¹æŸ¥" class="headerlink" title="12.JdbcTemplateçš„å¢åˆ æ”¹æŸ¥"></a>12.JdbcTemplateçš„å¢åˆ æ”¹æŸ¥</h2><h4 id="é…ç½®æ•°æ®åº“çš„æ“ä½œæ¨¡æ¿-JdbcTemplate"><a href="#é…ç½®æ•°æ®åº“çš„æ“ä½œæ¨¡æ¿-JdbcTemplate" class="headerlink" title="é…ç½®æ•°æ®åº“çš„æ“ä½œæ¨¡æ¿ JdbcTemplate"></a>é…ç½®æ•°æ®åº“çš„æ“ä½œæ¨¡æ¿ JdbcTemplate</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®ä¸€ä¸ªæ•°æ®åº“çš„æ“ä½œæ¨¡æ¿ï¼š JdbcTemplate --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--springçš„é»˜è®¤æ•°æ®æº--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å…¥æ•°æ®æº--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="è·å–å¯¹è±¡"><a href="#è·å–å¯¹è±¡" class="headerlink" title="è·å–å¯¹è±¡"></a>è·å–å¯¹è±¡</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.åŠ è½½springé…ç½®</span></span><br><span class="line">ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"><span class="comment">// 2.æ ¹æ®idè·å–beanå¯¹è±¡</span></span><br><span class="line">JdbcTemplate jdbcTemplate = (JdbcTemplate) ac.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>);</span><br><span class="line"><span class="comment">// 3.æ‰§è¡Œæ“ä½œ</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¿å­˜æ“ä½œ"><a href="#ä¿å­˜æ“ä½œ" class="headerlink" title="ä¿å­˜æ“ä½œ"></a>ä¿å­˜æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 3.1 ä¿å­˜æ“ä½œ</span></span><br><span class="line">jdbcTemplate.update(<span class="string">&quot;insert into account(name,money) values (&#x27;ffff&#x27;,77777.0)&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹æ“ä½œ"><a href="#ä¿®æ”¹æ“ä½œ" class="headerlink" title="ä¿®æ”¹æ“ä½œ"></a>ä¿®æ”¹æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 3.2 ä¿®æ”¹æ“ä½œ</span></span><br><span class="line">jdbcTemplate.update(<span class="string">&quot;update account set money=money-? where id=?&quot;</span>,<span class="number">300</span>,<span class="number">11</span>);</span><br></pre></td></tr></table></figure>

<h4 id="åˆ é™¤æ“ä½œ"><a href="#åˆ é™¤æ“ä½œ" class="headerlink" title="åˆ é™¤æ“ä½œ"></a>åˆ é™¤æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 3.3 åˆ é™¤æ“ä½œ</span></span><br><span class="line">jdbcTemplate.update(<span class="string">&quot;delete account where id=?&quot;</span>,<span class="number">11</span>);</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥è¯¢æ‰€æœ‰æ“ä½œ"><a href="#æŸ¥è¯¢æ‰€æœ‰æ“ä½œ" class="headerlink" title="æŸ¥è¯¢æ‰€æœ‰æ“ä½œ"></a>æŸ¥è¯¢æ‰€æœ‰æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 3.4 æŸ¥è¯¢æ‰€ç”¨æ“ä½œ</span></span><br><span class="line">List&lt;Account&gt; accounts = jdbcTemplate.query(<span class="string">&quot;select * from account where money&gt;?&quot;</span>,<span class="keyword">new</span> AccountRowMapper(),<span class="number">500</span>);</span><br><span class="line"><span class="keyword">for</span> (Account account:accounts) &#123;</span><br><span class="line">    System.out.println(account);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AccountRowMapper</span> <span class="keyword">implements</span> <span class="title">RowMapper</span>&lt;<span class="title">Account</span>&gt;</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Account <span class="title">mapRow</span><span class="params">(ResultSet resultSet, <span class="keyword">int</span> i)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setId(resultSet.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">        account.setName(resultSet.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        account.setMoney(resultSet.getFloat(<span class="string">&quot;money&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> account;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥è¯¢ä¸€ä¸ªæ“ä½œ"><a href="#æŸ¥è¯¢ä¸€ä¸ªæ“ä½œ" class="headerlink" title="æŸ¥è¯¢ä¸€ä¸ªæ“ä½œ"></a>æŸ¥è¯¢ä¸€ä¸ªæ“ä½œ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 3.5 æŸ¥è¯¢ä¸€ä¸ªæ“ä½œ</span></span><br><span class="line">List&lt;Account&gt; account = jdbcTemplate.query(<span class="string">&quot;select * from account where id=?&quot;</span>,<span class="keyword">new</span> AccountRowMapper(),<span class="number">23</span>);</span><br><span class="line">System.out.println(account.isEmpty()?<span class="string">&quot;æ²¡æœ‰ç»“æœ&quot;</span>:account.get(<span class="number">0</span>));</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥è¯¢ä¸€è¡Œä¸€åˆ—æ“ä½œ"><a href="#æŸ¥è¯¢ä¸€è¡Œä¸€åˆ—æ“ä½œ" class="headerlink" title="æŸ¥è¯¢ä¸€è¡Œä¸€åˆ—æ“ä½œ"></a>æŸ¥è¯¢ä¸€è¡Œä¸€åˆ—æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 3.6 æŸ¥è¯¢è¿”å›ä¸€è¡Œä¸€åˆ—æ“ä½œ</span></span><br><span class="line"><span class="comment">// æŸ¥è¯¢è¿”å›ä¸€è¡Œä¸€åˆ—ï¼šä½¿ç”¨èšåˆå‡½æ•°ï¼Œåœ¨ä¸ä½¿ç”¨ group by å­—å¥æ—¶ï¼Œéƒ½æ˜¯è¿”å›ä¸€è¡Œä¸€åˆ—ã€‚æœ€å¸¸ç”¨çš„å°±æ˜¯åˆ†é¡µä¸­è·å–æ€»è®°å½•æ¡æ•°</span></span><br><span class="line"><span class="keyword">int</span> count = jdbcTemplate.queryForObject(<span class="string">&quot;select count(*) from account where money&gt;?&quot;</span>,Integer.class,<span class="number">500</span>);</span><br><span class="line">System.out.println(count);</span><br></pre></td></tr></table></figure>

<h2 id="13-æ•´åˆmybatis"><a href="#13-æ•´åˆmybatis" class="headerlink" title="13. æ•´åˆmybatis"></a>13. æ•´åˆmybatis</h2><p>æ–‡æ¡£ï¼š <a href="https://mybatis.org/spring/zh/">https://mybatis.org/spring/zh/</a> </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-study<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.hou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-10-mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://111.230.212.103:3306/mybatis?userSSL=true<span class="symbol">&amp;amp;</span></span></span></span><br><span class="line"><span class="tag"><span class="string">                userUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;****&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.mapper.UserMapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">selectUser</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•´åˆ</p>
<p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperImpl</span> <span class="keyword">implements</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SqlSessionTemplate sqlSessionTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSqlSessionTemplate</span><span class="params">(SqlSessionTemplate sqlSessionTemplate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sqlSessionTemplate = sqlSessionTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">selectUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        UserMapper mapper = sqlSessionTemplate.getMapper(UserMapper.class);</span><br><span class="line">        <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>mybatis.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>spring.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--data source--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;datasource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://111.230.212.103:3306/mybatis?userSSL=true<span class="symbol">&amp;amp;</span></span></span></span><br><span class="line"><span class="tag"><span class="string">                userUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;****&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--sqlsession--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--bound mybatis--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:com/mapper/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userMapper&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mapper.UserMapperImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSession&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>test</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mytest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;spring-dao.xml&quot;</span>);</span><br><span class="line">        UserMapper userMapper = context.getBean(<span class="string">&quot;userMapper&quot;</span>, UserMapper.class);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (User user : userMapper.selectUser()) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--data source--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;datasource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://111.230.212.103:3306/mybatis?userSSL=true<span class="symbol">&amp;amp;</span></span></span></span><br><span class="line"><span class="tag"><span class="string">                userUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hdk123&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--sqlsession--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--bound mybatis--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:com/mapper/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;bean id=&quot;sqlSession&quot; class=&quot;org.mybatis.spring.SqlSessionTemplate&quot;&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;constructor-arg index=&quot;0&quot; ref=&quot;sqlSessionFactory&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/bean&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;bean id=&quot;userMapper&quot; class=&quot;com.mapper.UserMapperImpl&quot;&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;property name=&quot;sqlSessionTemplate&quot; ref=&quot;sqlSession&quot;&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/bean&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userMapper2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mapper.UserMapperIml2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.support.SqlSessionDaoSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperIml2</span> <span class="keyword">extends</span> <span class="title">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">selectUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SqlSession sqlSession = getSqlSession();</span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="14-å£°æ˜å¼äº‹åŠ¡"><a href="#14-å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="14. å£°æ˜å¼äº‹åŠ¡"></a>14. å£°æ˜å¼äº‹åŠ¡</h2><ul>
<li>è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥</li>
<li>ååˆ†é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®ä¸€è‡´æ€§</li>
<li>ç¡®ä¿å®Œæ•´æ€§å’Œä¸€è‡´æ€§</li>
</ul>
<p>äº‹åŠ¡çš„acidåŸåˆ™ï¼š</p>
<ul>
<li><p>åŸå­æ€§</p>
</li>
<li><p>ä¸€è‡´æ€§</p>
</li>
<li><p>éš”ç¦»æ€§</p>
<ul>
<li>å¤šä¸ªä¸šåŠ¡å¯èƒ½æ“ä½œä¸€ä¸ªèµ„æºï¼Œé˜²æ­¢æ•°æ®æŸå</li>
</ul>
</li>
<li><p>æŒä¹…æ€§</p>
<ul>
<li>äº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œæ— è®ºç³»ç»Ÿå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Œç»“æœéƒ½ä¸ä¼šè¢«å½±å“ã€‚</li>
</ul>
</li>
</ul>
<p>Springä¸­çš„äº‹åŠ¡ç®¡ç†</p>
<ul>
<li>å£°æ˜å¼äº‹åŠ¡</li>
<li>ç¼–ç¨‹å¼äº‹åŠ¡</li>
</ul>
<p>å£°æ˜å¼äº‹åŠ¡</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-tx.aop&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--data source--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;datasource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://111.230.212.103:3306/mybatis?userSSL=true<span class="symbol">&amp;amp;</span></span></span></span><br><span class="line"><span class="tag"><span class="string">                userUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--sqlsession--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--bound mybatis--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:com/mapper/*.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å£°æ˜å¼äº‹åŠ¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;datasource&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»“åˆaopå®ç°äº‹åŠ¡ç½®å…¥--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®äº‹åŠ¡çš„ç±»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;tx1&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç»™å“ªäº›æ–¹æ³•é…ç½®äº‹åŠ¡--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é…ç½®äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;delete&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;query&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®äº‹åŠ¡åˆ‡å…¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;txpointxut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.mapper.*.*(..))&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;tx1&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;txpointxut&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;spring-dao.xml&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userMapper2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mapper.UserMapperIml2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Mapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">selectUser</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        insert into mybatis.user (id, name, pwd) values</span><br><span class="line">        (#&#123;id&#125;, #&#123;name&#125;, #&#123;pwd&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;delete&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        delete from mybatis.user where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.support.SqlSessionDaoSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperIml2</span> <span class="keyword">extends</span> <span class="title">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">selectUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="number">6</span>, <span class="string">&quot;long&quot;</span>, <span class="string">&quot;zhi&quot;</span>);</span><br><span class="line">        SqlSession sqlSession = getSqlSession();</span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        mapper.addUser(user);</span><br><span class="line">        mapper.delete(<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getSqlSession().getMapper(UserMapper.class).addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getSqlSession().getMapper(UserMapper.class).delete(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>JDBCå­¦ä¹ ç¬”è®°</title>
    <url>/2021/01/25/JDBC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="JDBCå’Œæ•°æ®åº“è¿æ¥æ± "><a href="#JDBCå’Œæ•°æ®åº“è¿æ¥æ± " class="headerlink" title="JDBCå’Œæ•°æ®åº“è¿æ¥æ± "></a>JDBCå’Œæ•°æ®åº“è¿æ¥æ± </h1><p><strong>å†™åœ¨å‰é¢</strong></p>
<p><strong>å­¦ä¹ åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1zv41157NC">ã€éŸ©é¡ºå¹³è®²JDBCã€‘</a></strong></p>
<p><strong>æ„Ÿè°¢éŸ©è€å¸ˆçš„è§†é¢‘ï¼ååˆ†æ„Ÿè°¢</strong></p>
<h1 id="1-JDBCæ¦‚è¿°"><a href="#1-JDBCæ¦‚è¿°" class="headerlink" title="1. JDBCæ¦‚è¿°"></a>1. JDBCæ¦‚è¿°</h1><h2 id="1-1-åŸºæœ¬ä»‹ç»"><a href="#1-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="1.1 åŸºæœ¬ä»‹ç»"></a>1.1 åŸºæœ¬ä»‹ç»</h2><ul>
<li>JDBCä¸ºè®¿é—®ä¸åŒçš„æ•°æ®åº“æä¾›äº†ç»Ÿä¸€çš„æ¥å£ï¼Œä¸ºä½¿ç”¨è€…å±è”½äº†ç»†èŠ‚é—®é¢˜</li>
<li>ä½¿ç”¨JDBC,å¯ä»¥è¿æ¥ä»»ä½•æä¾›JDBCé©±åŠ¨ç¨‹åºçš„æ•°æ®åº“ç³»ç»Ÿï¼Œä»è€Œå®Œæˆå¯¹æ•°æ®åº“çš„å„ç§æ“ä½œ</li>
</ul>
<h2 id="1-2-åŸç†å›¾"><a href="#1-2-åŸç†å›¾" class="headerlink" title="1.2 åŸç†å›¾"></a>1.2 åŸç†å›¾</h2><p><img src="https://pic.imgdb.cn/item/60c8046c844ef46bb28ab3af.jpg"></p>
<h2 id="1-3-å¥½å¤„"><a href="#1-3-å¥½å¤„" class="headerlink" title="1.3 å¥½å¤„"></a>1.3 å¥½å¤„</h2><p>JDBCæ˜¯ç”¨Javaæä¾›ä¸€å¥—ç”¨äºæ•°æ®åº“æ“ä½œçš„æ¥å£APIï¼ŒJavaç¨‹åºå‘˜åªéœ€è¦é¢å‘æ¥å£ç¼–ç¨‹å³å¯ï¼Œä¸åŒçš„æ•°æ®åº“å‚å•†ï¼Œéœ€è¦é’ˆå¯¹è¿™å¥—æ¥å£ï¼Œæä¾›ä¸åŒçš„å®ç°ã€‚</p>
<p><img src="https://pic.imgdb.cn/item/60c80569844ef46bb296377e.jpg"></p>
<h1 id="2-JDBCå…¥é—¨"><a href="#2-JDBCå…¥é—¨" class="headerlink" title="2. JDBCå…¥é—¨"></a>2. JDBCå…¥é—¨</h1><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œä¸€å¼ è¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE `mybatis`;</span><br><span class="line"></span><br><span class="line">USE `mybatis`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>`(</span><br><span class="line"></span><br><span class="line"> `id` <span class="type">INT</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line"> `name` <span class="type">VARCHAR</span>(<span class="number">30</span>)<span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> `pwd` <span class="type">VARCHAR</span>(<span class="number">30</span>)<span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure>

<h2 id="2-1-æ¼”ç¤ºä¸€æŠŠ"><a href="#2-1-æ¼”ç¤ºä¸€æŠŠ" class="headerlink" title="2.1 æ¼”ç¤ºä¸€æŠŠ"></a>2.1 æ¼”ç¤ºä¸€æŠŠ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Driver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Jdbc01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç¤ºèŒƒå¦‚ä½•ä½¿ç”¨Jdbc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/15 8:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Jdbc01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//æ³¨å†Œé©±åŠ¨</span></span><br><span class="line">        Driver driver = <span class="keyword">new</span> Driver();</span><br><span class="line">        <span class="comment">//sqlè¯­å¥</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *  jdbc:mysql: è§„å®šå¥½çš„åè®®ï¼Œé€šè¿‡jdbcçš„æ–¹å¼è¿æ¥mysql</span></span><br><span class="line"><span class="comment">         *  localhost è¡¨ç¤ºä¸»æœº</span></span><br><span class="line"><span class="comment">         *  3306 è¡¨ç¤ºmysqlç›‘å¬çš„ç«¯å£</span></span><br><span class="line"><span class="comment">         *  mybatisè¡¨ç¤ºå“ªä¸ªæ•°æ®åº“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        <span class="comment">//å°†è´¦å·å¯†ç  æ”¾å…¥åˆ°Properties</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        <span class="comment">//è´¦å·å¯†ç </span></span><br><span class="line">        properties.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        Connection connect = driver.connect(url, properties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰§è¡Œsql</span></span><br><span class="line">        String sql = <span class="string">&quot;insert into user value (&#x27;10&#x27;,&#x27;å¼ ä¸‰&#x27;,&#x27;123&#x27;)&quot;</span>;</span><br><span class="line">        <span class="comment">//statementç”¨äºæ‰§è¡Œé™æ€SQLè¯­å¥å¹¶è¿”å›å…¶ç”Ÿæˆçš„ç»“æœçš„å¯¹è±¡</span></span><br><span class="line">        Statement statement = connect.createStatement();</span><br><span class="line">        <span class="keyword">int</span> row = statement.executeUpdate(sql);</span><br><span class="line">        System.out.println(row &gt; <span class="number">0</span> ? <span class="string">&quot;æˆåŠŸ&quot;</span> : <span class="string">&quot;å¤±è´¥&quot;</span>);</span><br><span class="line"></span><br><span class="line">        statement.close();</span><br><span class="line">        connect.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-2-è¿æ¥æ•°æ®åº“çš„5ç§æ–¹å¼"><a href="#2-2-è¿æ¥æ•°æ®åº“çš„5ç§æ–¹å¼" class="headerlink" title="2.2 è¿æ¥æ•°æ®åº“çš„5ç§æ–¹å¼"></a>2.2 è¿æ¥æ•°æ®åº“çš„5ç§æ–¹å¼</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Driver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> JdbcConn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> java è¿æ¥ mysql çš„ 5ç§æ–¹å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/15 9:07</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcConn</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        connect01();</span><br><span class="line">        connect02();</span><br><span class="line">        connect03();</span><br><span class="line">        connect04();</span><br><span class="line">        connect05();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">connect01</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºDriverå¯¹è±¡</span></span><br><span class="line">        Driver driver = <span class="keyword">new</span> Driver();</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        <span class="comment">//å°†è´¦å·å¯†ç  æ”¾å…¥åˆ°Properties</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        <span class="comment">//è´¦å·å¯†ç </span></span><br><span class="line">        properties.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        Connection connect = driver.connect(url, properties);</span><br><span class="line">        System.out.println(connect);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">connect02</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨ DriverManager æ›¿ä»£ driver è¿›è¡Œç»Ÿä¸€ç®¡ç†</span></span><br><span class="line">        <span class="comment">//ä½¿ç”¨åå°„åŠ è½½ Driver ç±» , åŠ¨æ€åŠ è½½ï¼Œæ›´åŠ çš„çµæ´»ï¼Œå‡å°‘ä¾èµ–æ€§</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Driver driver = (Driver) aClass.newInstance();</span><br><span class="line"></span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        <span class="comment">//å°†è´¦å·å¯†ç  æ”¾å…¥åˆ°Properties</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        <span class="comment">//è´¦å·å¯†ç </span></span><br><span class="line">        properties.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        Connection connect = driver.connect(url, properties);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹å¼ 2=&quot;</span> + connect);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">connect03</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨åå°„åŠ è½½ Driver ç±» , åŠ¨æ€åŠ è½½ï¼Œæ›´åŠ çš„çµæ´»ï¼Œå‡å°‘ä¾èµ–æ€§</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Driver driver = (Driver) aClass.newInstance();</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        String user = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹å¼3=&quot;</span> + connection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">connect04</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨åå°„åŠ è½½äº† Driver ç±»</span></span><br><span class="line">        <span class="comment">//åœ¨åŠ è½½ Driver ç±»æ—¶ï¼Œå®Œæˆæ³¨å†Œ</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æºç : 1. é™æ€ä»£ç å—ï¼Œåœ¨ç±»åŠ è½½æ—¶ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡. 2. DriverManager.registerDriver(new Driver());</span></span><br><span class="line"><span class="comment">        3. å› æ­¤æ³¨å†Œ driver çš„å·¥ä½œå·²ç»å®Œæˆ</span></span><br><span class="line"><span class="comment">        static &#123;</span></span><br><span class="line"><span class="comment">        try &#123;</span></span><br><span class="line"><span class="comment">        DriverManager.registerDriver(new Driver());</span></span><br><span class="line"><span class="comment">        &#125; catch (SQLException var1) &#123;</span></span><br><span class="line"><span class="comment">        throw new RuntimeException(&quot;Can&#x27;t register driver!&quot;);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        String user = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹å¼4=&quot;</span> + connection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">connect05</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//é€šè¿‡ Properties å¯¹è±¡è·å–é…ç½®æ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.load(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;src\\jdbc.properties&quot;</span>));</span><br><span class="line"><span class="comment">//è·å–ç›¸å…³çš„å€¼</span></span><br><span class="line">        String user = properties.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        String password = properties.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        String driver = properties.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        String url = properties.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        Class.forName(driver);</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹å¼ 5 &quot;</span> + connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3-ResultSet"><a href="#3-ResultSet" class="headerlink" title="3. ResultSet"></a>3. ResultSet</h1><h2 id="3-1-åŸºæœ¬ä»‹ç»"><a href="#3-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="3.1 åŸºæœ¬ä»‹ç»"></a>3.1 åŸºæœ¬ä»‹ç»</h2><ol>
<li>è¡¨ç¤ºæ•°æ®åº“ç»“æœé›†çš„æ•°æ®è¡¨ï¼Œé€šå¸¸é€šè¿‡æ‰§è¡ŒæŸ¥è¯¢æ•°æ®åº“çš„è¯­å¥ç”Ÿæˆ</li>
<li><code>ResultSet</code>å¯¹è±¡ä¿æŒä¸€ä¸ªå…‰æ ‡æŒ‡å‘å…¶å½“å‰çš„æ•°æ®è¡Œï¼Œæœ€åˆï¼Œå…‰æ ‡ä½äºç¬¬ä¸€è¡Œ</li>
<li>nextæ–¹æ³•å°†å…‰æ ‡ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œï¼Œå¹¶ä¸”ç”±äºåœ¨ResultSetå¯¹è±¡ä¸­æ²¡æœ‰æ›´å¤šè¡Œæ—¶è¿”å›falseï¼Œå› æ­¤å¯ä»¥ç”¨<code>while</code>å¾ªç¯æ¥éå†ç»“æœé›†</li>
</ol>
<h2 id="3-2-ä»£ç ç¤ºä¾‹"><a href="#3-2-ä»£ç ç¤ºä¾‹" class="headerlink" title="3.2 ä»£ç ç¤ºä¾‹"></a>3.2 ä»£ç ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ResultSet_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ResultSetç»“æœé›†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/15 12:53</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultSet_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        String user = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="comment">//å¾—åˆ° statementå¯¹è±¡</span></span><br><span class="line">        Statement statement = connection.createStatement();</span><br><span class="line">        <span class="comment">//sqlè¯­å¥</span></span><br><span class="line">        String sql = <span class="string">&quot;select id,name,pwd from user&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨æŸ¥è¯¢æ–¹æ³• è¿”å›ç»“æœé›†</span></span><br><span class="line">        ResultSet resultSet = statement.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">            <span class="keyword">int</span> id = resultSet.getInt(<span class="number">1</span>);</span><br><span class="line">            String name = resultSet.getString(<span class="number">2</span>);</span><br><span class="line">            String pwd = resultSet.getString(<span class="number">3</span>);</span><br><span class="line">            System.out.println(id + <span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;\t&quot;</span> + pwd );</span><br><span class="line">        &#125;</span><br><span class="line">        resultSet.close();</span><br><span class="line">        statement.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-Statement"><a href="#4-Statement" class="headerlink" title="4. Statement"></a>4. Statement</h1><h2 id="4-1-åŸºæœ¬ä»‹ç»"><a href="#4-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="4.1 åŸºæœ¬ä»‹ç»"></a>4.1 åŸºæœ¬ä»‹ç»</h2><ol>
<li><code>Statement</code>å¯¹è±¡ï¼Œç”¨äºæ‰§è¡Œé™æ€SQLè¯­å¥å¹¶è¿”å›å…¶ç”Ÿæˆçš„ç»“æœçš„å¯¹è±¡</li>
<li>åœ¨å»ºç«‹è¿æ¥åï¼Œéœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œè®¿é—®ï¼Œæ‰§è¡Œå‘½åæˆ–æ˜¯SQLè¯­å¥ï¼Œå¯ä»¥é€šè¿‡</li>
</ol>
<ul>
<li><code>Statement</code> <strong>å­˜åœ¨SQLæ³¨å…¥é—®é¢˜</strong></li>
<li><code>PreparedStatement</code> <strong>é¢„å¤„ç†</strong></li>
<li><code>CallableStatement</code> <strong>å­˜å‚¨è¿‡ç¨‹</strong> </li>
</ul>
<ol start="4">
<li>Statementå¯¹è±¡æ‰§è¡ŒSQLè¯­å¥ï¼Œå­˜åœ¨SQLæ³¨å…¥é£é™©</li>
<li>SQLæ³¨å…¥æ˜¯åˆ©ç”¨æŸäº›ç³»ç»Ÿå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œå……åˆ†çš„æ£€æŸ¥ï¼Œè€Œåœ¨ç”¨æˆ·è¾“å…¥æ•°æ®ä¸­éæ³•çš„SQLè¯­å¥æ®µæˆ–å‘½ä»¤ï¼Œæ¶æ„æ”»å‡»æ•°æ®åº“</li>
<li>è¦é˜²èŒƒSQLæ³¨å…¥ï¼Œç”¨<code>PrepareStatement</code>å–ä»£<code>Statement</code>å³å¯</li>
</ol>
<h2 id="4-2-ä»£ç æ¼”ç¤º"><a href="#4-2-ä»£ç æ¼”ç¤º" class="headerlink" title="4.2 ä»£ç æ¼”ç¤º"></a>4.2 ä»£ç æ¼”ç¤º</h2><p>é¦–å…ˆåˆ›ä¸ªè¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ç®¡ç†å‘˜è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> admin ( </span><br><span class="line">NAME <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>, pwd <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ·»åŠ æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> admin <span class="keyword">VALUES</span>(<span class="string">&#x27;tom&#x27;</span>, <span class="string">&#x27;123&#x27;</span>); <span class="comment">-- æŸ¥æ‰¾æŸä¸ªç®¡ç†æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> admin</span><br><span class="line"><span class="keyword">WHERE</span> NAME <span class="operator">=</span> <span class="string">&#x27;tom&#x27;</span> <span class="keyword">AND</span> pwd <span class="operator">=</span> <span class="string">&#x27;123&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL</span></span><br><span class="line"><span class="comment">-- è¾“å…¥ç”¨æˆ·å ä¸º 1&#x27; or</span></span><br><span class="line"><span class="comment">-- è¾“å…¥ä¸‡èƒ½å¯†ç  ä¸º or &#x27;1&#x27;= &#x27;1</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> admin</span><br><span class="line"><span class="keyword">WHERE</span> NAME <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">OR</span><span class="string">&#x27; AND pwd = &#x27;</span><span class="keyword">OR</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span> <span class="string">&#x27;1&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>Statement_</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Statement_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Statementæ¼”ç¤º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/15 13:17</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Statement_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="comment">//è®©ç”¨æˆ·è¾“å…¥ç®¡ç†å‘˜åå’Œå¯†ç </span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„åå­—: &quot;</span>);</span><br><span class="line">        <span class="comment">//next(): å½“æ¥æ”¶åˆ° ç©ºæ ¼æˆ–è€… &#x27;å°±æ˜¯è¡¨ç¤ºç»“æŸ</span></span><br><span class="line">        String adminName = scanner.nextLine();</span><br><span class="line">        <span class="comment">//å¦‚æœå¸Œæœ›çœ‹åˆ° SQL æ³¨å…¥ï¼Œè¿™é‡Œéœ€è¦ç”¨ nextLine</span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„å¯†ç : &quot;</span>);</span><br><span class="line">        String adminPwd = scanner.nextLine();</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        String user = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="comment">//å¾—åˆ° statementå¯¹è±¡</span></span><br><span class="line">        Statement statement = connection.createStatement();</span><br><span class="line">        <span class="comment">//sqlè¯­å¥</span></span><br><span class="line">        String sql = <span class="string">&quot;select name,pwd from admin &quot;</span> +</span><br><span class="line">                <span class="string">&quot;where name =&#x27;&quot;</span> + adminName + <span class="string">&quot;&#x27; and pwd = &#x27;&quot;</span> + adminPwd + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        ResultSet resultSet = statement.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æŸ¥è¯¢æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        connection.close();</span><br><span class="line">        resultSet.close();</span><br><span class="line">        statement.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-PrepareStatement"><a href="#5-PrepareStatement" class="headerlink" title="5. PrepareStatement"></a>5. PrepareStatement</h1><h2 id="5-1-åŸºæœ¬ä»‹ç»"><a href="#5-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="5.1 åŸºæœ¬ä»‹ç»"></a>5.1 åŸºæœ¬ä»‹ç»</h2><ol>
<li><code>PrepareStatement</code>æ‰§è¡Œçš„SQLè¯­å¥ä¸­å‚æ•°ç”¨<code>?</code>è¡¨ç¤ºï¼Œè°ƒç”¨<code>PrepareStatement</code>å¯¹è±¡çš„setXXX()æ–¹æ³•æ¥è®¾ç½®è¿™äº›å‚æ•°</li>
</ol>
<ul>
<li>setXXX()æ–¹æ³• æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è®¾ç½®SQLè¯­å¥ä¸­çš„å‚æ•°çš„ç´¢å¼•(ä»1å¼€å§‹)ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è®¾ç½® SQLè¯­å¥ä¸­çš„å‚æ•°çš„å€¼</li>
</ul>
<ol start="2">
<li>è°ƒç”¨<code>excuteQuery()</code>è¿”å›<code>Result</code>å¯¹è±¡</li>
<li>è°ƒç”¨<code>excuteUpdate()</code>æ‰§è¡Œæ›´æ–°ï¼ŒåŒ…æ‹¬å¢åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤</li>
</ol>
<h2 id="5-2-é¢„å¤„ç†çš„å¥½å¤„"><a href="#5-2-é¢„å¤„ç†çš„å¥½å¤„" class="headerlink" title="5.2 é¢„å¤„ç†çš„å¥½å¤„"></a>5.2 é¢„å¤„ç†çš„å¥½å¤„</h2><ol>
<li>ä¸å†ä½¿ç”¨+æ‹¼æ¥SQLè¯­å¥ï¼Œå‡å°‘è¯­æ³•é”™è¯¯</li>
<li>æœ‰æ•ˆè§£å†³SQLæ³¨å…¥é—®é¢˜</li>
<li>å¤§å¤§å‡å°‘ç¼–è¯‘æ¬¡æ•°ï¼Œæ•ˆç‡è¾ƒé«˜</li>
</ol>
<h2 id="5-3-ä»£ç æ¼”ç¤º"><a href="#5-3-ä»£ç æ¼”ç¤º" class="headerlink" title="5.3 ä»£ç æ¼”ç¤º"></a>5.3 ä»£ç æ¼”ç¤º</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PreparedStatement_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> PreparedStatementä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/15 13:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PreparedStatement_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="comment">//è®©ç”¨æˆ·è¾“å…¥ç®¡ç†å‘˜åå’Œå¯†ç </span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„åå­—: &quot;</span>);</span><br><span class="line">        <span class="comment">//next(): å½“æ¥æ”¶åˆ° ç©ºæ ¼æˆ–è€… &#x27;å°±æ˜¯è¡¨ç¤ºç»“æŸ</span></span><br><span class="line">        String adminName = scanner.nextLine();</span><br><span class="line">        <span class="comment">//å¦‚æœå¸Œæœ›çœ‹åˆ° SQL æ³¨å…¥ï¼Œè¿™é‡Œéœ€è¦ç”¨ nextLine</span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„å¯†ç : &quot;</span>);</span><br><span class="line">        String adminPwd = scanner.nextLine();</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        String user = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="comment">//å¾—åˆ° statementå¯¹è±¡</span></span><br><span class="line">        Statement statement = connection.createStatement();</span><br><span class="line">        <span class="comment">//sqlè¯­å¥</span></span><br><span class="line">        String sql = <span class="string">&quot;select * from admin where NAME = ? and pwd = ?&quot;</span>;</span><br><span class="line">        <span class="comment">//preparedStatement å¯¹è±¡å®ç°äº† PreparedStatement æ¥å£çš„å®ç°ç±»çš„å¯¹è±¡</span></span><br><span class="line">        PreparedStatement preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//ç»™ ? èµ‹å€¼</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>, adminName);</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>, adminPwd);</span><br><span class="line">        ResultSet resultSet = preparedStatement.executeQuery();</span><br><span class="line">        <span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æŸ¥è¯¢æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        connection.close();</span><br><span class="line">        resultSet.close();</span><br><span class="line">        statement.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-4-CRUDæ“ä½œ"><a href="#5-4-CRUDæ“ä½œ" class="headerlink" title="5.4 CRUDæ“ä½œ"></a>5.4 CRUDæ“ä½œ</h2><p><strong>æ’å…¥æ“ä½œ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PreparedStatement_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> PreparedStatementä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/15 13:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PreparedStatement_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="comment">//è®©ç”¨æˆ·è¾“å…¥ç®¡ç†å‘˜åå’Œå¯†ç </span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„åå­—: &quot;</span>);</span><br><span class="line">        <span class="comment">//next(): å½“æ¥æ”¶åˆ° ç©ºæ ¼æˆ–è€… &#x27;å°±æ˜¯è¡¨ç¤ºç»“æŸ</span></span><br><span class="line">        String adminName = scanner.nextLine();</span><br><span class="line">        <span class="comment">//å¦‚æœå¸Œæœ›çœ‹åˆ° SQL æ³¨å…¥ï¼Œè¿™é‡Œéœ€è¦ç”¨ nextLine</span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„å¯†ç : &quot;</span>);</span><br><span class="line">        String adminPwd = scanner.nextLine();</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        String user = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="comment">//å¾—åˆ° statementå¯¹è±¡</span></span><br><span class="line">        Statement statement = connection.createStatement();</span><br><span class="line">        <span class="comment">//sqlè¯­å¥</span></span><br><span class="line">      <span class="comment">//  String sql = &quot;select * from admin where NAME = ? and pwd = ?&quot;;</span></span><br><span class="line">        String sql = <span class="string">&quot;insert into admin values(?, ?)&quot;</span>;</span><br><span class="line">        <span class="comment">//preparedStatement å¯¹è±¡å®ç°äº† PreparedStatement æ¥å£çš„å®ç°ç±»çš„å¯¹è±¡</span></span><br><span class="line">        PreparedStatement preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//ç»™ ? èµ‹å€¼</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>, adminName);</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>, adminPwd);</span><br><span class="line">        <span class="keyword">int</span> i = preparedStatement.executeUpdate();</span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>? <span class="string">&quot;æˆåŠŸ&quot;</span>:<span class="string">&quot;å¤±è´¥&quot;</span>);</span><br><span class="line">        connection.close();</span><br><span class="line">       <span class="comment">// resultSet.close();</span></span><br><span class="line">        statement.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ é™¤æ“ä½œ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PreparedStatement_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> PreparedStatementä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/15 13:32</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PreparedStatement_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="comment">//è®©ç”¨æˆ·è¾“å…¥ç®¡ç†å‘˜åå’Œå¯†ç </span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„åå­—: &quot;</span>);</span><br><span class="line">        <span class="comment">//next(): å½“æ¥æ”¶åˆ° ç©ºæ ¼æˆ–è€… &#x27;å°±æ˜¯è¡¨ç¤ºç»“æŸ</span></span><br><span class="line">        String adminName = scanner.nextLine();</span><br><span class="line">        <span class="comment">//å¦‚æœå¸Œæœ›çœ‹åˆ° SQL æ³¨å…¥ï¼Œè¿™é‡Œéœ€è¦ç”¨ nextLine</span></span><br><span class="line">        System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç®¡ç†å‘˜çš„å¯†ç : &quot;</span>);</span><br><span class="line">        String adminPwd = scanner.nextLine();</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>;</span><br><span class="line">        String user = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="comment">//å¾—åˆ° statementå¯¹è±¡</span></span><br><span class="line">        Statement statement = connection.createStatement();</span><br><span class="line">        <span class="comment">//sqlè¯­å¥</span></span><br><span class="line">        <span class="comment">//  String sql = &quot;select * from admin where NAME = ? and pwd = ?&quot;;</span></span><br><span class="line">        <span class="comment">//String sql = &quot;insert into admin values(?, ?)&quot;;</span></span><br><span class="line">        <span class="comment">//preparedStatement å¯¹è±¡å®ç°äº† PreparedStatement æ¥å£çš„å®ç°ç±»çš„å¯¹è±¡</span></span><br><span class="line">        String sql = <span class="string">&quot;delete from admin where name = ?&quot;</span>;</span><br><span class="line">        PreparedStatement preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//ç»™ ? èµ‹å€¼</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>, adminName);</span><br><span class="line">     <span class="comment">//   preparedStatement.setString(2, adminPwd);</span></span><br><span class="line">        <span class="comment">// ResultSet resultSet = preparedStatement.executeQuery();</span></span><br><span class="line">        <span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æŸ¥è¯¢æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        connection.close();</span><br><span class="line">        resultSet.close();</span><br><span class="line">        statement.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-Jdbc-API"><a href="#6-Jdbc-API" class="headerlink" title="6. Jdbc API"></a>6. Jdbc API</h1><p><img src="https://pic.imgdb.cn/item/60c848b1844ef46bb2f7e5a0.jpg"></p>
<h1 id="7-JDBCUtils"><a href="#7-JDBCUtils" class="headerlink" title="7. JDBCUtils"></a>7. JDBCUtils</h1><p>ç¼–å†™ä¸€ä¸ªå·¥å…·ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> JDBCUtils</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> JDBCUtilså·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/16 20:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®šä¹‰4ä¸ªç›¸å…³å±æ€§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">            properties.load(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;src\\jdbc.properties&quot;</span>));</span><br><span class="line">            user = properties.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            password = properties.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">            url = properties.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">            driver = properties.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// å°†ç¼–è¯‘å¼‚å¸¸è½¬æˆè¿è¡Œå¼‚å¸¸</span></span><br><span class="line">            <span class="comment">// å¯ä»¥é€‰æ‹©æ•è·å¼‚å¸¸æˆ–è€…é€‰æ‹©é»˜è®¤å¤„ç†å¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿æ¥æ•°æ®åº“ è¿”å›è¿æ¥</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­ç›¸å…³èµ„æº</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        1. ResultSet ç»“æœé›†</span></span><br><span class="line"><span class="comment">        2. Statement æˆ–è€… PreparedStatement</span></span><br><span class="line"><span class="comment">        3. Connection</span></span><br><span class="line"><span class="comment">        4. å¦‚æœéœ€è¦å…³é—­èµ„æºï¼Œå°±ä¼ å…¥å¯¹è±¡ï¼Œå¦åˆ™ä¼ å…¥ null</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ResultSet set, Statement statement, Connection connection)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸º null</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (set != <span class="keyword">null</span>) &#123;</span><br><span class="line">                set.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (statement != <span class="keyword">null</span>) &#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (connection != <span class="keyword">null</span>) &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">//å°†ç¼–è¯‘å¼‚å¸¸è½¬æˆè¿è¡Œå¼‚å¸¸æŠ›å‡º</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ä¸‹å·¥å…·ç±»è¿›è¡ŒæŸ¥è¯¢ï¼Œä¿®æ”¹ï¼Œå¢åŠ </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> JDBCUtils_Use</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> JDBCUtils_Useæ¼”ç¤ºå·¥å…·ç±»çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/16 20:57</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtils_Use</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//   testSelect();</span></span><br><span class="line">        testDML();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. å¾—åˆ°è¿æ¥</span></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//2. ç»„ç»‡ä¸€ä¸ª sql</span></span><br><span class="line">        String sql = <span class="string">&quot;select * from user where id = ?&quot;</span>;</span><br><span class="line">        PreparedStatement preparedStatement = <span class="keyword">null</span>;</span><br><span class="line">        ResultSet set = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//3. åˆ›å»º PreparedStatement å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtils.getConnection();</span><br><span class="line">            <span class="comment">//com.mysql.jdbc.JDBC4Connection</span></span><br><span class="line">            System.out.println(connection.getClass());</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//ç»™?å·èµ‹å€¼</span></span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="comment">//æ‰§è¡Œ, å¾—åˆ°ç»“æœé›†</span></span><br><span class="line">            set = preparedStatement.executeQuery();</span><br><span class="line">            <span class="comment">//éå†è¯¥ç»“æœé›†</span></span><br><span class="line">            <span class="keyword">while</span> (set.next()) &#123;</span><br><span class="line">                <span class="keyword">int</span> id = set.getInt(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                String name = set.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                String pwd = set.getString(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">                System.out.println(id + <span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;\t&quot;</span> + pwd);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">            JDBCUtils.close(set, preparedStatement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testDML</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        String sql = <span class="string">&quot;update user set name=? where id=?&quot;</span>;</span><br><span class="line">        PreparedStatement preparedStatement = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">            connection = JDBCUtils.getConnection();</span><br><span class="line">            <span class="comment">//åˆ›å»ºpreparedStatementå¯¹è±¡</span></span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//èµ‹å€¼</span></span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>, <span class="string">&quot;å‘¨æ˜Ÿé©°&quot;</span>);</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>, <span class="string">&quot;10&quot;</span>);</span><br><span class="line">            <span class="comment">//æ‰§è¡Œ</span></span><br><span class="line">            preparedStatement.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtils.close(<span class="keyword">null</span>, preparedStatement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="8-äº‹åŠ¡"><a href="#8-äº‹åŠ¡" class="headerlink" title="8. äº‹åŠ¡"></a>8. äº‹åŠ¡</h1><h2 id="8-1-åŸºæœ¬ä»‹ç»"><a href="#8-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="8.1 åŸºæœ¬ä»‹ç»"></a>8.1 åŸºæœ¬ä»‹ç»</h2><ol>
<li>JDBCç¨‹åºä¸­å½“ä¸€ä¸ª<code>Connection</code>å¯¹è±¡åˆ›å»ºæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡ï¼Œæ¯æ¬¡æ‰§è¡Œä¸€ä¸ªSQLè¯­å¥ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå°±ä¼šå‘æ•°æ®åº“è‡ªåŠ¨æäº¤ï¼Œè€Œä¸èƒ½å›æ»š</li>
<li>JDBCç¨‹åºä¸­ä¸ºäº†è®©å¤šä¸ªSQLè¯­å¥ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œéœ€è¦<strong>ä½¿ç”¨äº‹åŠ¡</strong></li>
<li>è°ƒç”¨<code>Connection</code>çš„<code>setAutoCommit(false)</code>å¯ä»¥å–æ¶ˆè‡ªåŠ¨æäº¤äº‹åŠ¡</li>
<li>åœ¨æ‰€æœ‰çš„SQLè¯­å¥éƒ½æˆåŠŸæ‰§è¡Œåï¼Œè°ƒç”¨<code>Connection</code>çš„<code>commit()</code>ï¼Œæ–¹æ³•æäº¤äº‹åŠ¡</li>
<li>åœ¨å…¶ä¸­æŸä¸ªæ“ä½œå¤±è´¥åï¼Œè°ƒç”¨<code>Connection</code>çš„<code>rollback()</code>ï¼Œæ–¹æ³•å›æ»šäº‹åŠ¡</li>
</ol>
<h1 id="9-æ•°æ®åº“è¿æ¥æ± "><a href="#9-æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="9. æ•°æ®åº“è¿æ¥æ± "></a>9. æ•°æ®åº“è¿æ¥æ± </h1><ol>
<li><p>ä¼ ç»Ÿçš„JDBCæ•°æ®åº“è¿æ¥ä½¿ç”¨ DriverManageræ¥è·å–ï¼Œæ¯æ¬¡å‘æ•°æ®åº“å»ºç«‹è¿æ¥çš„æ—¶å€™éƒ½è¦å°† ConnectionåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†éªŒè¯IPåœ°å€ï¼Œç”¨æˆ·åå’Œå¯†ç (0.05s ~1sæ—¶é—´)ã€‚éœ€è¦æ•°æ®åº“è¿æ¥çš„æ—¶å€™ï¼Œå°±å‘æ•°æ®åº“è¦æ±‚ä¸€ä¸ªï¼Œé¢‘ç¹çš„è¿›è¡Œæ•°æ®åº“è¿æ¥æ“ä½œå°†å ç”¨å¾ˆå¤šçš„ç³»ç»Ÿèµ„æºï¼Œå®¹æ˜“é€ æˆæœåŠ¡å™¨å´©æºƒã€‚</p>
</li>
<li><p>æ¯ä¸€æ¬¡æ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨å®Œåéƒ½å¾—æ–­å¼€,å¦‚æœç¨‹åºå‡ºç°å¼‚å¸¸è€Œæœªèƒ½å…³é—­ï¼Œå°†å¯¼è‡´æ•°æ®åº“å†…å­˜æ³„æ¼ï¼Œæœ€ç»ˆå°†å¯¼è‡´é‡å¯æ•°æ®åº“ã€‚</p>
</li>
<li><p>ä¼ ç»Ÿè·å–è¿æ¥çš„æ–¹å¼,ä¸èƒ½æ§åˆ¶åˆ›å»ºçš„è¿æ¥æ•°é‡ï¼Œå¦‚è¿æ¥è¿‡å¤šï¼Œä¹Ÿå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ŒMySQLå´©æºƒã€‚</p>
</li>
<li><p>è§£å†³ä¼ ç»Ÿå¼€å‘ä¸­çš„æ•°æ®åº“è¿æ¥é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯(connection pool)ã€‚</p>
</li>
</ol>
<h2 id="9-1-C3P0è¿æ¥æ± "><a href="#9-1-C3P0è¿æ¥æ± " class="headerlink" title="9.1 C3P0è¿æ¥æ± "></a>9.1 C3P0è¿æ¥æ± </h2><p>ä½¿ç”¨<code>jdbc.properties</code>å’Œ<code>c3p0-config.xml</code>æµ‹è¯•è¿æ¥</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ•°æ®æºåç§°ä»£è¡¨è¿æ¥æ±  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">named-config</span> <span class="attr">name</span>=<span class="string">&quot;mybatis&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é©±åŠ¨ç±» --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- url--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://127.0.0.1:3306/mybatis<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ç”¨æˆ·å --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- å¯†ç  --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- æ¯æ¬¡å¢é•¿çš„è¿æ¥æ•°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquireIncrement&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åˆå§‹çš„è¿æ¥æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æœ€å°è¿æ¥æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- æœ€å¤§è¿æ¥æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>50<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- å¯è¿æ¥çš„æœ€å¤šçš„å‘½ä»¤å¯¹è±¡æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatements&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- æ¯ä¸ªè¿æ¥å¯¹è±¡å¯è¿æ¥çš„æœ€å¤šçš„å‘½ä»¤å¯¹è±¡æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatementsPerConnection&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">named-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> C3P0_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> C3P0è¿æ¥æ± </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/17 20:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C3P0_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        testC3P0_01();</span><br><span class="line">        testC3P0_02();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testC3P0_01</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource comboPooledDataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        <span class="comment">// é€šè¿‡é…ç½®æ–‡ä»¶è·å–ç›¸å…³è¿æ¥ä¿¡æ¯</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.load(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;src\\jdbc.properties&quot;</span>));</span><br><span class="line">        <span class="comment">//è¯»å–ç›¸å…³çš„å±æ€§å€¼</span></span><br><span class="line">        String user = properties.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        String password = properties.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        String url = properties.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        String driver = properties.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»™æ•°æ®æº comboPooledDataSource è®¾ç½®ç›¸å…³çš„å‚æ•°</span></span><br><span class="line">        comboPooledDataSource.setDriverClass(driver);</span><br><span class="line">        comboPooledDataSource.setJdbcUrl(url);</span><br><span class="line">        comboPooledDataSource.setUser(user);</span><br><span class="line">        comboPooledDataSource.setPassword(password);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®åˆå§‹åŒ–è¿æ¥æ•°</span></span><br><span class="line">        comboPooledDataSource.setInitialPoolSize(<span class="number">10</span>);</span><br><span class="line">        <span class="comment">//æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">        comboPooledDataSource.setMaxPoolSize(<span class="number">50</span>);</span><br><span class="line">        <span class="comment">//æµ‹è¯•è¿æ¥æ± çš„æ•ˆç‡, æµ‹è¯•å¯¹ mysql 5000 æ¬¡æ“ä½œ</span></span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5000</span>; i++) &#123;</span><br><span class="line">            Connection connection = comboPooledDataSource.getConnection();</span><br><span class="line">            <span class="comment">//System.out.println(&quot;è¿æ¥ OK&quot;);</span></span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">        <span class="comment">//c3p0 5000 è¿æ¥ mysql è€—æ—¶=391</span></span><br><span class="line">        System.out.println(<span class="string">&quot;c3p0 5000 è¿æ¥ mysql è€—æ—¶=&quot;</span> + (end - start));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testC3P0_02</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource comboPooledDataSource = <span class="keyword">new</span> ComboPooledDataSource(<span class="string">&quot;mybatis&quot;</span>);</span><br><span class="line">        <span class="comment">//æµ‹è¯• 5000 æ¬¡è¿æ¥ mysql</span></span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;å¼€å§‹æ‰§è¡Œ....&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">500000</span>; i++) &#123;</span><br><span class="line">            Connection connection = comboPooledDataSource.getConnection();</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;c3p0 çš„ç¬¬äºŒç§æ–¹å¼(500000) è€—æ—¶=&quot;</span> + (end - start));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-2-Druidå¾·é²ä¼Šè¿æ¥æ± "><a href="#9-2-Druidå¾·é²ä¼Šè¿æ¥æ± " class="headerlink" title="9.2 Druidå¾·é²ä¼Šè¿æ¥æ± "></a>9.2 Druidå¾·é²ä¼Šè¿æ¥æ± </h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Druid_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Druidè¿æ¥æ± </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/17 20:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Druid_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        testDruid();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testDruid</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        DruidDataSource dataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mybatis&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Connection connection = dataSource.getConnection();</span><br><span class="line">        String sql = <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line">        PreparedStatement prepareStatement = connection.prepareStatement(sql);</span><br><span class="line">        ResultSet resultSet = prepareStatement.executeQuery();</span><br><span class="line">        <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">            Object id = resultSet.getObject(<span class="number">1</span>);</span><br><span class="line">            Object username = resultSet.getObject(<span class="number">2</span>);</span><br><span class="line">            Object password = resultSet.getObject(<span class="number">3</span>);</span><br><span class="line">            System.out.println(id + <span class="string">&quot;:&quot;</span> + username + <span class="string">&quot;:&quot;</span> + password);</span><br><span class="line">        &#125;</span><br><span class="line">        resultSet.close();</span><br><span class="line">        connection.close();</span><br><span class="line">        dataSource.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>å†™åœ¨æœ€å</strong></p>
<ul>
<li>ç†Ÿç»ƒè¿ç”¨JDBCå’ŒMysqlæ•°æ®åº“å¯¹ä»¥åè¿›é˜¶æ‰“å¥½åŸºç¡€:muscle:</li>
</ul>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQLå­¦ä¹ ç¬”è®°</title>
    <url>/2021/01/18/MySQL%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="MySQLå­¦ä¹ ç¬”è®°"><a href="#MySQLå­¦ä¹ ç¬”è®°" class="headerlink" title="MySQLå­¦ä¹ ç¬”è®°"></a>MySQLå­¦ä¹ ç¬”è®°</h1><p>å†™åœ¨å‰é¢ï¼šå®‰è£…å’Œæ•°æ®åº“è¿æ¥åœ¨æ­¤å°±ä¸èµ˜è¿°ï¼Œè¯¦æƒ…å‚è€ƒå…¶ä»–åšå®¢ï¼</p>
<p><strong>å­¦ä¹ å‚è€ƒ:<a href="https://www.runoob.com/mysql/mysql-tutorial.html">MySQL æ•™ç¨‹ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></strong></p>
<h1 id="1-SQLè¯­å¥åŸºç¡€è¯­æ³•"><a href="#1-SQLè¯­å¥åŸºç¡€è¯­æ³•" class="headerlink" title="1. SQLè¯­å¥åŸºç¡€è¯­æ³•"></a>1. SQLè¯­å¥åŸºç¡€è¯­æ³•</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE æ•°æ®åº“å; #åˆ›å»ºæ•°æ®åº“</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> database <span class="operator">&lt;</span>æ•°æ®åº“å<span class="operator">&gt;</span>; #åˆ é™¤æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">use æ•°æ®åº“å; #é€‰æ‹©æ•°æ®åº“</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> tables; #æŸ¥çœ‹å½“å‰åº“çš„æ‰€æœ‰è¡¨</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> è¡¨å(   #åˆ›å»ºè¡¨</span><br><span class="line"></span><br><span class="line">	åˆ—å åˆ—ç±»å‹,</span><br><span class="line">	åˆ—å åˆ—ç±»å‹ï¼Œ</span><br><span class="line">	ã€‚ã€‚ã€‚</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">desc</span> è¡¨å; #æŸ¥çœ‹è¡¨ç»“æ„</span><br><span class="line"></span><br><span class="line">mysql <span class="comment">--version; #æŸ¥çœ‹æœåŠ¡å™¨çš„ç‰ˆæœ¬</span></span><br></pre></td></tr></table></figure>



<h1 id="2-SQLè¯­å¥è¯­æ³•è§„èŒƒ"><a href="#2-SQLè¯­å¥è¯­æ³•è§„èŒƒ" class="headerlink" title="2. SQLè¯­å¥è¯­æ³•è§„èŒƒ"></a>2. SQLè¯­å¥è¯­æ³•è§„èŒƒ</h1><p>â€‹    1.ä¸åŒºåˆ†å¤§å°å†™,ä½†å»ºè®®å…³é”®å­—å¤§å†™ï¼Œè¡¨åã€åˆ—åå°å†™<br>â€‹    2.æ¯æ¡å‘½ä»¤æœ€å¥½ç”¨åˆ†å·ç»“å°¾<br>â€‹    3.æ¯æ¡å‘½ä»¤æ ¹æ®éœ€è¦ï¼Œå¯ä»¥è¿›è¡Œç¼©è¿› æˆ–æ¢è¡Œ<br>â€‹    4.æ³¨é‡Š<br>â€‹        å•è¡Œæ³¨é‡Šï¼š#æ³¨é‡Šæ–‡å­—<br>â€‹        å•è¡Œæ³¨é‡Šï¼šâ€“ æ³¨é‡Šæ–‡å­—<br>â€‹        å¤šè¡Œæ³¨é‡Šï¼š/* æ³¨é‡Šæ–‡å­—  */</p>
<h3 id="2-1-SQLè¯­å¥çš„åˆ†ç±»"><a href="#2-1-SQLè¯­å¥çš„åˆ†ç±»" class="headerlink" title="2.1 SQLè¯­å¥çš„åˆ†ç±»"></a>2.1 SQLè¯­å¥çš„åˆ†ç±»</h3><ul>
<li><p>DQLï¼ˆData Query Languageï¼‰ï¼šæ•°æ®æŸ¥è¯¢è¯­è¨€</p>
<pre><code>    select 
</code></pre>
</li>
<li><p>DML(Data Manipulate Language):æ•°æ®æ“ä½œè¯­è¨€</p>
<pre><code>    insert ã€updateã€delete
</code></pre>
</li>
<li><p>DDLï¼ˆData Define Langugeï¼‰ï¼šæ•°æ®å®šä¹‰è¯­è¨€</p>
<pre><code>    createã€dropã€alter
</code></pre>
</li>
<li><p>TCLï¼ˆTransaction Control Languageï¼‰ï¼šäº‹åŠ¡æ§åˆ¶è¯­è¨€</p>
<pre><code>    commitã€rollback
</code></pre>
</li>
</ul>
<h3 id="2-2-æ’å…¥è¯­å¥"><a href="#2-2-æ’å…¥è¯­å¥" class="headerlink" title="2.2 æ’å…¥è¯­å¥"></a>2.2 æ’å…¥è¯­å¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name ( field1, field2,...fieldN ) <span class="keyword">VALUES</span>( value1, value2,...valueN ); #æ’å…¥æ•°æ®</span><br></pre></td></tr></table></figure>

<h3 id="2-3-æŸ¥è¯¢è¯­å¥"><a href="#2-3-æŸ¥è¯¢è¯­å¥" class="headerlink" title="2.3 æŸ¥è¯¢è¯­å¥"></a>2.3 æŸ¥è¯¢è¯­å¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name,column_name</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line">[<span class="keyword">WHERE</span> Clause]</span><br><span class="line">[LIMIT N][ <span class="keyword">OFFSET</span> M]        # æŸ¥è¯¢æ•°æ®é€šç”¨çš„ <span class="keyword">SELECT</span> è¯­æ³•</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥è¯¢è¯­å¥ä¸­ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¡¨ï¼Œè¡¨ä¹‹é—´ä½¿ç”¨é€—å·(,)åˆ†å‰²ï¼Œå¹¶ä½¿ç”¨WHEREè¯­å¥æ¥è®¾å®šæŸ¥è¯¢æ¡ä»¶ã€‚</li>
<li>SELECT å‘½ä»¤å¯ä»¥è¯»å–ä¸€æ¡æˆ–è€…å¤šæ¡è®°å½•ã€‚</li>
<li>ä½ å¯ä»¥ä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰æ¥ä»£æ›¿å…¶ä»–å­—æ®µï¼ŒSELECTè¯­å¥ä¼šè¿”å›è¡¨çš„æ‰€æœ‰å­—æ®µæ•°æ®</li>
<li>ä½ å¯ä»¥ä½¿ç”¨ WHERE è¯­å¥æ¥åŒ…å«ä»»ä½•æ¡ä»¶ã€‚</li>
<li>ä½ å¯ä»¥ä½¿ç”¨ LIMIT å±æ€§æ¥è®¾å®šè¿”å›çš„è®°å½•æ•°ã€‚</li>
<li>ä½ å¯ä»¥é€šè¿‡OFFSETæŒ‡å®šSELECTè¯­å¥å¼€å§‹æŸ¥è¯¢çš„æ•°æ®åç§»é‡ã€‚é»˜è®¤æƒ…å†µä¸‹åç§»é‡ä¸º0ã€‚</li>
</ul>
<h4 id="2-3-1-WHERE-å­å¥"><a href="#2-3-1-WHERE-å­å¥" class="headerlink" title="2.3.1 WHERE å­å¥"></a>2.3.1 WHERE å­å¥</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN <span class="keyword">FROM</span> table_name1, table_name2...</span><br><span class="line">[<span class="keyword">WHERE</span> condition1 [<span class="keyword">AND</span> [<span class="keyword">OR</span>]] condition2.....</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥è¯¢è¯­å¥ä¸­ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¡¨ï¼Œè¡¨ä¹‹é—´ä½¿ç”¨é€—å·**,** åˆ†å‰²ï¼Œå¹¶ä½¿ç”¨WHEREè¯­å¥æ¥è®¾å®šæŸ¥è¯¢æ¡ä»¶ã€‚</li>
<li>ä½ å¯ä»¥åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶ã€‚</li>
<li>ä½ å¯ä»¥ä½¿ç”¨ AND æˆ–è€… OR æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶ã€‚</li>
<li>WHERE å­å¥ä¹Ÿå¯ä»¥è¿ç”¨äº SQL çš„ DELETE æˆ–è€… UPDATE å‘½ä»¤ã€‚</li>
<li>WHERE å­å¥ç±»ä¼¼äºç¨‹åºè¯­è¨€ä¸­çš„ if æ¡ä»¶ï¼Œæ ¹æ® MySQL è¡¨ä¸­çš„å­—æ®µå€¼æ¥è¯»å–æŒ‡å®šçš„æ•°æ®</li>
</ul>
<h4 id="2-3-2-LIKEå­å¥"><a href="#2-3-2-LIKEå­å¥" class="headerlink" title="2.3.2 LIKEå­å¥"></a>2.3.2 LIKEå­å¥</h4><p>SQL LIKE å­å¥ä¸­ä½¿ç”¨ç™¾åˆ†å· **%**å­—ç¬¦æ¥è¡¨ç¤ºä»»æ„å­—ç¬¦ï¼Œç±»ä¼¼äºUNIXæˆ–æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„æ˜Ÿå· *****ã€‚</p>
<p>å¦‚æœæ²¡æœ‰ä½¿ç”¨ç™¾åˆ†å· <strong>%</strong>, LIKE å­å¥ä¸ç­‰å· <strong>=</strong> çš„æ•ˆæœæ˜¯ä¸€æ ·çš„</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN </span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> field1 <span class="keyword">LIKE</span> condition1 [<span class="keyword">AND</span> [<span class="keyword">OR</span>]] filed2 <span class="operator">=</span> <span class="string">&#x27;somevalue&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¯ä»¥åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶ã€‚</li>
<li>å¯ä»¥åœ¨ WHERE å­å¥ä¸­ä½¿ç”¨LIKEå­å¥ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨LIKEå­å¥ä»£æ›¿ç­‰å· **=**ã€‚</li>
<li>LIKE é€šå¸¸ä¸ <strong>%</strong> ä¸€åŒä½¿ç”¨ï¼Œç±»ä¼¼äºä¸€ä¸ªå…ƒå­—ç¬¦çš„æœç´¢ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ AND æˆ–è€… OR æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶ã€‚</li>
<li>å¯ä»¥åœ¨ DELETE æˆ– UPDATE å‘½ä»¤ä¸­ä½¿ç”¨ WHEREâ€¦LIKE å­å¥æ¥æŒ‡å®šæ¡ä»¶ã€‚</li>
</ul>
<blockquote>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">&#x27;%a&#x27;     <span class="comment">//ä»¥aç»“å°¾çš„æ•°æ®</span></span><br><span class="line">&#x27;a%&#x27;     <span class="comment">//ä»¥aå¼€å¤´çš„æ•°æ®</span></span><br><span class="line">&#x27;%a%&#x27;    <span class="comment">//å«æœ‰açš„æ•°æ®</span></span><br><span class="line">&#x27;_a_&#x27;    <span class="comment">//ä¸‰ä½ä¸”ä¸­é—´å­—æ¯æ˜¯açš„</span></span><br><span class="line">&#x27;_a&#x27;     <span class="comment">//ä¸¤ä½ä¸”ç»“å°¾å­—æ¯æ˜¯açš„</span></span><br><span class="line">&#x27;a_&#x27;     <span class="comment">//ä¸¤ä½ä¸”å¼€å¤´å­—æ¯æ˜¯açš„</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>ä¸¾ä¾‹</strong></p>
<ul>
<li>æŸ¥è¯¢ä»¥ java å­—æ®µå¼€å¤´çš„ä¿¡æ¯</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> position <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;java%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥è¯¢åŒ…å« java å­—æ®µçš„ä¿¡æ¯</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> position <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%java%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥è¯¢ä»¥ java å­—æ®µç»“å°¾çš„ä¿¡æ¯</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> position <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%java&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-æ›´æ–°è¯­å¥"><a href="#2-4-æ›´æ–°è¯­å¥" class="headerlink" title="2.4 æ›´æ–°è¯­å¥"></a>2.4 æ›´æ–°è¯­å¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">UPDATE table_name <span class="keyword">SET</span> field1<span class="operator">=</span><span class="keyword">new</span><span class="operator">-</span>value1, field2<span class="operator">=</span><span class="keyword">new</span><span class="operator">-</span>value2</span><br><span class="line">[<span class="keyword">WHERE</span> Clause]</span><br></pre></td></tr></table></figure>

<ul>
<li>åŒæ—¶æ›´æ–°ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µã€‚</li>
<li>åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶ã€‚</li>
<li>åœ¨ä¸€ä¸ªå•ç‹¬è¡¨ä¸­åŒæ—¶æ›´æ–°æ•°æ®ã€‚</li>
</ul>
<h3 id="2-5-åˆ é™¤è¯­å¥"><a href="#2-5-åˆ é™¤è¯­å¥" class="headerlink" title="2.5 åˆ é™¤è¯­å¥"></a>2.5 åˆ é™¤è¯­å¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> Clause]</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœæ²¡æœ‰æŒ‡å®š WHERE å­å¥ï¼ŒMySQL è¡¨ä¸­çš„æ‰€æœ‰è®°å½•å°†è¢«åˆ é™¤ã€‚</li>
<li>å¯ä»¥åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶</li>
<li>å¯ä»¥åœ¨å•ä¸ªè¡¨ä¸­ä¸€æ¬¡æ€§åˆ é™¤è®°å½•ã€‚</li>
</ul>
<h3 id="2-6-æ’åºè¯­å¥"><a href="#2-6-æ’åºè¯­å¥" class="headerlink" title="2.6 æ’åºè¯­å¥"></a>2.6 æ’åºè¯­å¥</h3><p>SQL SELECT è¯­å¥ä½¿ç”¨ ORDER BY å­å¥å°†æŸ¥è¯¢æ•°æ®æ’åºåå†è¿”å›æ•°æ®</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN <span class="keyword">FROM</span> table_name1, table_name2...</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> field1 [<span class="keyword">ASC</span> [<span class="keyword">DESC</span>][é»˜è®¤ <span class="keyword">ASC</span>]], [field2...] [<span class="keyword">ASC</span> [<span class="keyword">DESC</span>][é»˜è®¤ <span class="keyword">ASC</span>]]</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯ä»¥ä½¿ç”¨ä»»ä½•å­—æ®µæ¥ä½œä¸ºæ’åºçš„æ¡ä»¶ï¼Œä»è€Œè¿”å›æ’åºåçš„æŸ¥è¯¢ç»“æœã€‚</li>
<li>å¯ä»¥è®¾å®šå¤šä¸ªå­—æ®µæ¥æ’åºã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ ASC æˆ– DESC å…³é”®å­—æ¥è®¾ç½®æŸ¥è¯¢ç»“æœæ˜¯æŒ‰å‡åºæˆ–é™åºæ’åˆ—ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯æŒ‰å‡åºæ’åˆ—ã€‚</li>
<li>å¯ä»¥æ·»åŠ  WHEREâ€¦LIKE å­å¥æ¥è®¾ç½®æ¡ä»¶ã€‚</li>
</ul>
<h3 id="2-7-åˆ†ç»„è¯­å¥"><a href="#2-7-åˆ†ç»„è¯­å¥" class="headerlink" title="2.7 åˆ†ç»„è¯­å¥"></a>2.7 åˆ†ç»„è¯­å¥</h3><p>GROUP BY è¯­å¥æ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—å¯¹ç»“æœé›†è¿›è¡Œåˆ†ç»„</p>
<p>åœ¨åˆ†ç»„çš„åˆ—ä¸Šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ COUNT, SUM, AVG,ç­‰å‡½æ•°</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name, <span class="keyword">function</span>(column_name)</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> column_name operator <span class="keyword">value</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> column_name;</span><br></pre></td></tr></table></figure>



<h1 id="3-MySQLè¿æ¥çš„ä½¿ç”¨"><a href="#3-MySQLè¿æ¥çš„ä½¿ç”¨" class="headerlink" title="3. MySQLè¿æ¥çš„ä½¿ç”¨"></a>3. MySQLè¿æ¥çš„ä½¿ç”¨</h1><p>SELECT, UPDATE å’Œ DELETE è¯­å¥ä¸­ä½¿ç”¨ Mysql çš„ JOIN æ¥è”åˆå¤šè¡¨æŸ¥è¯¢</p>
<p>JOIN æŒ‰ç…§åŠŸèƒ½å¤§è‡´åˆ†ä¸ºå¦‚ä¸‹ä¸‰ç±»ï¼š</p>
<ul>
<li><strong>INNER JOINï¼ˆå†…è¿æ¥,æˆ–ç­‰å€¼è¿æ¥ï¼‰</strong>ï¼šè·å–ä¸¤ä¸ªè¡¨ä¸­å­—æ®µåŒ¹é…å…³ç³»çš„è®°å½•ã€‚</li>
<li><strong>LEFT JOINï¼ˆå·¦è¿æ¥ï¼‰ï¼š</strong>è·å–å·¦è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å³è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•ã€‚</li>
<li><strong>RIGHT JOINï¼ˆå³è¿æ¥ï¼‰ï¼š</strong> ä¸ LEFT JOIN ç›¸åï¼Œç”¨äºè·å–å³è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å·¦è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µï¼Œ...</span><br><span class="line"><span class="keyword">from</span> è¡¨<span class="number">1</span></span><br><span class="line">ã€<span class="keyword">inner</span><span class="operator">|</span><span class="keyword">left</span> <span class="keyword">outer</span><span class="operator">|</span><span class="keyword">right</span> <span class="keyword">outer</span><span class="operator">|</span><span class="keyword">cross</span>ã€‘<span class="keyword">join</span> è¡¨<span class="number">2</span> <span class="keyword">on</span>  è¿æ¥æ¡ä»¶</span><br><span class="line">ã€<span class="keyword">inner</span><span class="operator">|</span><span class="keyword">left</span> <span class="keyword">outer</span><span class="operator">|</span><span class="keyword">right</span> <span class="keyword">outer</span><span class="operator">|</span><span class="keyword">cross</span>ã€‘<span class="keyword">join</span> è¡¨<span class="number">3</span> <span class="keyword">on</span>  è¿æ¥æ¡ä»¶</span><br><span class="line">ã€<span class="keyword">where</span> ç­›é€‰æ¡ä»¶ã€‘</span><br><span class="line">ã€<span class="keyword">group</span> <span class="keyword">by</span> åˆ†ç»„å­—æ®µã€‘</span><br><span class="line">ã€<span class="keyword">having</span> åˆ†ç»„åçš„ç­›é€‰æ¡ä»¶ã€‘</span><br><span class="line">ã€<span class="keyword">order</span> <span class="keyword">by</span> æ’åºçš„å­—æ®µæˆ–è¡¨è¾¾å¼ã€‘</span><br></pre></td></tr></table></figure>



<h1 id="4-MySQLNULLå€¼å¤„ç†"><a href="#4-MySQLNULLå€¼å¤„ç†" class="headerlink" title="4. MySQLNULLå€¼å¤„ç†"></a>4. MySQLNULLå€¼å¤„ç†</h1><p>MySQL ä½¿ç”¨ SQL SELECT å‘½ä»¤åŠ WHERE å­å¥æ¥è¯»å–æ•°æ®è¡¨ä¸­çš„æ•°æ®,ä½†æ˜¯å½“æä¾›çš„æŸ¥è¯¢æ¡ä»¶å­—æ®µä¸º NULL æ—¶ï¼Œè¯¥å‘½ä»¤å¯èƒ½å°±æ— æ³•æ­£å¸¸å·¥ä½œ</p>
<p>MySQLæä¾›äº†ä¸‰å¤§è¿ç®—ç¬¦:</p>
<ul>
<li><strong>IS NULL:</strong> å½“åˆ—çš„å€¼æ˜¯ NULL,æ­¤è¿ç®—ç¬¦è¿”å› true</li>
<li><strong>IS NOT NULL:</strong> å½“åˆ—çš„å€¼ä¸ä¸º NULL, è¿ç®—ç¬¦è¿”å› true</li>
<li><strong>&lt;=&gt;:</strong> æ¯”è¾ƒæ“ä½œç¬¦ï¼ˆä¸åŒäº = è¿ç®—ç¬¦ï¼‰ï¼Œå½“æ¯”è¾ƒçš„çš„ä¸¤ä¸ªå€¼ç›¸ç­‰æˆ–è€…éƒ½ä¸º NULL æ—¶è¿”å› true</li>
</ul>
<p><strong>æ³¨æ„ï¼šåœ¨è¯­å¥ä¸­ = å’Œ != è¿ç®—ç¬¦æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå¿…é¡»ä½¿ç”¨  IS NULL å’Œ IS NOT NULL</strong></p>
<h1 id="5-æŸ¥è¯¢è¿›é˜¶"><a href="#5-æŸ¥è¯¢è¿›é˜¶" class="headerlink" title="5.æŸ¥è¯¢è¿›é˜¶"></a>5.æŸ¥è¯¢è¿›é˜¶</h1><h2 id="5-1-å­æŸ¥è¯¢"><a href="#5-1-å­æŸ¥è¯¢" class="headerlink" title="5.1 å­æŸ¥è¯¢"></a>5.1 å­æŸ¥è¯¢</h2><p>ä¸€æ¡æŸ¥è¯¢è¯­å¥ä¸­åˆåµŒå¥—äº†å¦ä¸€æ¡å®Œæ•´çš„selectè¯­å¥ï¼Œå…¶ä¸­è¢«åµŒå¥—çš„selectè¯­å¥ï¼Œç§°ä¸ºå­æŸ¥è¯¢æˆ–å†…æŸ¥è¯¢<br>åœ¨å¤–é¢çš„æŸ¥è¯¢è¯­å¥ï¼Œç§°ä¸ºä¸»æŸ¥è¯¢æˆ–å¤–æŸ¥è¯¢</p>
<p>ç‰¹ç‚¹</p>
<ul>
<li>1ã€å­æŸ¥è¯¢éƒ½æ”¾åœ¨å°æ‹¬å·å†…</li>
<li>2ã€å­æŸ¥è¯¢å¯ä»¥æ”¾åœ¨fromåé¢ã€selectåé¢ã€whereåé¢ã€havingåé¢ï¼Œä½†ä¸€èˆ¬æ”¾åœ¨æ¡ä»¶çš„å³ä¾§</li>
<li>3ã€å­æŸ¥è¯¢ä¼˜å…ˆäºä¸»æŸ¥è¯¢æ‰§è¡Œï¼Œä¸»æŸ¥è¯¢ä½¿ç”¨äº†å­æŸ¥è¯¢çš„æ‰§è¡Œç»“æœ</li>
<li>4ã€å­æŸ¥è¯¢æ ¹æ®æŸ¥è¯¢ç»“æœçš„è¡Œæ•°ä¸åŒåˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š</li>
<li>â‘  å•è¡Œå­æŸ¥è¯¢<pre><code>ç»“æœé›†åªæœ‰ä¸€è¡Œ
ä¸€èˆ¬æ­é…å•è¡Œæ“ä½œç¬¦ä½¿ç”¨ï¼š&gt; &lt; = &lt;&gt; &gt;= &lt;= 
éæ³•ä½¿ç”¨å­æŸ¥è¯¢çš„æƒ…å†µï¼š
aã€å­æŸ¥è¯¢çš„ç»“æœä¸ºä¸€ç»„å€¼
bã€å­æŸ¥è¯¢çš„ç»“æœä¸ºç©º
</code></pre>
</li>
<li>â‘¡ å¤šè¡Œå­æŸ¥è¯¢<pre><code>ç»“æœé›†æœ‰å¤šè¡Œ
ä¸€èˆ¬æ­é…å¤šè¡Œæ“ä½œç¬¦ä½¿ç”¨ï¼šanyã€allã€inã€not in
inï¼š å±äºå­æŸ¥è¯¢ç»“æœä¸­çš„ä»»æ„ä¸€ä¸ªå°±è¡Œ
anyå’Œallå¾€å¾€å¯ä»¥ç”¨å…¶ä»–æŸ¥è¯¢ä»£æ›¿
</code></pre>
</li>
</ul>
<h2 id="5-2-åˆ†é¡µæŸ¥è¯¢"><a href="#5-2-åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="5.2 åˆ†é¡µæŸ¥è¯¢"></a>5.2 åˆ†é¡µæŸ¥è¯¢</h2><p>å®é™…çš„webé¡¹ç›®ä¸­éœ€è¦æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚æäº¤å¯¹åº”çš„åˆ†é¡µæŸ¥è¯¢çš„sqlè¯­å¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µ<span class="operator">|</span>è¡¨è¾¾å¼,...</span><br><span class="line"><span class="keyword">from</span> è¡¨</span><br><span class="line">ã€<span class="keyword">where</span> æ¡ä»¶ã€‘</span><br><span class="line">ã€<span class="keyword">group</span> <span class="keyword">by</span> åˆ†ç»„å­—æ®µã€‘</span><br><span class="line">ã€<span class="keyword">having</span> æ¡ä»¶ã€‘</span><br><span class="line">ã€<span class="keyword">order</span> <span class="keyword">by</span> æ’åºçš„å­—æ®µã€‘</span><br><span class="line">limit ã€èµ·å§‹çš„æ¡ç›®ç´¢å¼•ï¼Œã€‘æ¡ç›®æ•°;</span><br></pre></td></tr></table></figure>

<p>ç‰¹ç‚¹</p>
<ul>
<li>1.èµ·å§‹æ¡ç›®ç´¢å¼•ä»0å¼€å§‹</li>
<li>2.limitå­å¥æ”¾åœ¨æŸ¥è¯¢è¯­å¥çš„æœ€å</li>
<li>3.å…¬å¼ï¼šselect * from  è¡¨ limit ï¼ˆpage-1ï¼‰*sizePerPage,sizePerPage</li>
</ul>
<blockquote>
<p>å‡å¦‚:<br>æ¯é¡µæ˜¾ç¤ºæ¡ç›®æ•°sizePerPage<br>è¦æ˜¾ç¤ºçš„é¡µæ•° page</p>
</blockquote>
<h2 id="5-3-è”åˆæŸ¥è¯¢"><a href="#5-3-è”åˆæŸ¥è¯¢" class="headerlink" title="5.3 è”åˆæŸ¥è¯¢"></a>5.3 è”åˆæŸ¥è¯¢</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µ<span class="operator">|</span>å¸¸é‡<span class="operator">|</span>è¡¨è¾¾å¼<span class="operator">|</span>å‡½æ•° ã€<span class="keyword">from</span> è¡¨ã€‘ ã€<span class="keyword">where</span> æ¡ä»¶ã€‘ <span class="keyword">union</span> ã€<span class="keyword">all</span>ã€‘</span><br><span class="line"><span class="keyword">select</span> å­—æ®µ<span class="operator">|</span>å¸¸é‡<span class="operator">|</span>è¡¨è¾¾å¼<span class="operator">|</span>å‡½æ•° ã€<span class="keyword">from</span> è¡¨ã€‘ ã€<span class="keyword">where</span> æ¡ä»¶ã€‘ <span class="keyword">union</span> ã€<span class="keyword">all</span>ã€‘</span><br><span class="line"><span class="keyword">select</span> å­—æ®µ<span class="operator">|</span>å¸¸é‡<span class="operator">|</span>è¡¨è¾¾å¼<span class="operator">|</span>å‡½æ•° ã€<span class="keyword">from</span> è¡¨ã€‘ ã€<span class="keyword">where</span> æ¡ä»¶ã€‘ <span class="keyword">union</span>  ã€<span class="keyword">all</span>ã€‘</span><br><span class="line">.....</span><br><span class="line"><span class="keyword">select</span> å­—æ®µ<span class="operator">|</span>å¸¸é‡<span class="operator">|</span>è¡¨è¾¾å¼<span class="operator">|</span>å‡½æ•° ã€<span class="keyword">from</span> è¡¨ã€‘ ã€<span class="keyword">where</span> æ¡ä»¶ã€‘</span><br></pre></td></tr></table></figure>

<p>ç‰¹ç‚¹</p>
<ul>
<li>1ã€å¤šæ¡æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢çš„åˆ—æ•°å¿…é¡»æ˜¯ä¸€è‡´çš„</li>
<li>2ã€å¤šæ¡æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢çš„åˆ—çš„ç±»å‹å‡ ä¹ç›¸åŒ</li>
<li>3ã€unionä»£è¡¨å»é‡ï¼Œunion allä»£è¡¨ä¸å»é‡</li>
</ul>
<h1 id="6-MySQL-æ­£åˆ™è¡¨è¾¾å¼"><a href="#6-MySQL-æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="6. MySQL æ­£åˆ™è¡¨è¾¾å¼"></a>6. MySQL æ­£åˆ™è¡¨è¾¾å¼</h1><table>
<thead>
<tr>
<th>æ¨¡å¼</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>^</td>
<td align="left">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®</td>
</tr>
<tr>
<td>$</td>
<td align="left">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®</td>
</tr>
<tr>
<td>.</td>
<td align="left">åŒ¹é…é™¤ â€œ\nâ€ ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td>[â€¦]</td>
<td align="left">å­—ç¬¦é›†åˆã€‚åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td>[^â€¦]</td>
<td align="left">è´Ÿå€¼å­—ç¬¦é›†åˆã€‚åŒ¹é…æœªåŒ…å«çš„ä»»æ„å­—ç¬¦</td>
</tr>
<tr>
<td>p1|p2|p3</td>
<td align="left">åŒ¹é… p1 æˆ– p2 æˆ– p3</td>
</tr>
<tr>
<td>*</td>
<td align="left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡</td>
</tr>
<tr>
<td>+</td>
<td align="left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡</td>
</tr>
<tr>
<td>{n}</td>
<td align="left">n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡</td>
</tr>
<tr>
<td>{n,m}</td>
<td align="left">m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mï¼Œæœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚</td>
</tr>
</tbody></table>
<p> ä¸¾å‡ ä¸ªä¾‹å­</p>
<ul>
<li>æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥â€™stâ€™ä¸ºå¼€å¤´çš„æ‰€æœ‰æ•°æ®ï¼š</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> person_tbl <span class="keyword">WHERE</span> name REGEXP <span class="string">&#x27;^st&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥â€™okâ€™ä¸ºç»“å°¾çš„æ‰€æœ‰æ•°æ®ï¼š</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> person_tbl <span class="keyword">WHERE</span> name REGEXP <span class="string">&#x27;ok$&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥æ‰¾nameå­—æ®µä¸­åŒ…å«â€™marâ€™å­—ç¬¦ä¸²çš„æ‰€æœ‰æ•°æ®ï¼š</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> person_tbl <span class="keyword">WHERE</span> name REGEXP <span class="string">&#x27;mar&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥å…ƒéŸ³å­—ç¬¦å¼€å¤´æˆ–ä»¥â€™okâ€™å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰æ•°æ®ï¼š</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> person_tbl <span class="keyword">WHERE</span> name REGEXP <span class="string">&#x27;^[aeiou]|ok$&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h1 id="7-MySQLäº‹åŠ¡"><a href="#7-MySQLäº‹åŠ¡" class="headerlink" title="7. MySQLäº‹åŠ¡"></a>7. MySQLäº‹åŠ¡</h1><p>MySQL äº‹åŠ¡ä¸»è¦ç”¨äºå¤„ç†æ“ä½œé‡å¤§ï¼Œå¤æ‚åº¦é«˜çš„æ•°æ®</p>
<ul>
<li>åœ¨ MySQL ä¸­åªæœ‰ä½¿ç”¨äº† Innodb æ•°æ®åº“å¼•æ“çš„æ•°æ®åº“æˆ–è¡¨æ‰æ”¯æŒäº‹åŠ¡ã€‚</li>
<li>äº‹åŠ¡å¤„ç†å¯ä»¥ç”¨æ¥ç»´æŠ¤æ•°æ®åº“çš„å®Œæ•´æ€§ï¼Œä¿è¯æˆæ‰¹çš„ SQL è¯­å¥è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚</li>
<li>äº‹åŠ¡ç”¨æ¥ç®¡ç† insert,update,delete è¯­å¥</li>
</ul>
<p>äº‹åŠ¡æ˜¯å¿…é¡»æ»¡è¶³4ä¸ªæ¡ä»¶ï¼ˆACIDï¼‰ï¼šï¼šåŸå­æ€§ï¼ˆ<strong>A</strong>tomicityï¼Œæˆ–ç§°ä¸å¯åˆ†å‰²æ€§ï¼‰ã€ä¸€è‡´æ€§ï¼ˆ<strong>C</strong>onsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆ<strong>I</strong>solationï¼Œåˆç§°ç‹¬ç«‹æ€§ï¼‰ã€æŒä¹…æ€§ï¼ˆ<strong>D</strong>urabilityï¼‰</p>
<ul>
<li><strong>åŸå­æ€§ï¼š</strong>ä¸€ä¸ªäº‹åŠ¡ï¼ˆtransactionï¼‰ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼Œä¸ä¼šç»“æŸåœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œä¼šè¢«å›æ»šï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ä¸€æ ·ã€‚</li>
<li><strong>ä¸€è‡´æ€§ï¼š</strong>åœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ²¡æœ‰è¢«ç ´åã€‚è¿™è¡¨ç¤ºå†™å…¥çš„èµ„æ–™å¿…é¡»å®Œå…¨ç¬¦åˆæ‰€æœ‰çš„é¢„è®¾è§„åˆ™ï¼Œè¿™åŒ…å«èµ„æ–™çš„ç²¾ç¡®åº¦ã€ä¸²è”æ€§ä»¥åŠåç»­æ•°æ®åº“å¯ä»¥è‡ªå‘æ€§åœ°å®Œæˆé¢„å®šçš„å·¥ä½œã€‚</li>
<li><strong>éš”ç¦»æ€§ï¼š</strong>æ•°æ®åº“å…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹å…¶æ•°æ®è¿›è¡Œè¯»å†™å’Œä¿®æ”¹çš„èƒ½åŠ›ï¼Œéš”ç¦»æ€§å¯ä»¥é˜²æ­¢å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ç”±äºäº¤å‰æ‰§è¡Œè€Œå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚äº‹åŠ¡éš”ç¦»åˆ†ä¸ºä¸åŒçº§åˆ«ï¼ŒåŒ…æ‹¬è¯»æœªæäº¤ï¼ˆRead uncommittedï¼‰ã€è¯»æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ã€‚</li>
<li><strong>æŒä¹…æ€§ï¼š</strong>äº‹åŠ¡å¤„ç†ç»“æŸåï¼Œå¯¹æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…çš„ï¼Œå³ä¾¿ç³»ç»Ÿæ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</li>
</ul>
<h2 id="7-1-äº‹åŠ¡æ§åˆ¶è¯­å¥ï¼š"><a href="#7-1-äº‹åŠ¡æ§åˆ¶è¯­å¥ï¼š" class="headerlink" title="7.1 äº‹åŠ¡æ§åˆ¶è¯­å¥ï¼š"></a>7.1 äº‹åŠ¡æ§åˆ¶è¯­å¥ï¼š</h2><ul>
<li>BEGIN æˆ– START TRANSACTION æ˜¾å¼åœ°å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼›</li>
<li>COMMIT ä¹Ÿå¯ä»¥ä½¿ç”¨ COMMIT WORKï¼Œä¸è¿‡äºŒè€…æ˜¯ç­‰ä»·çš„ã€‚COMMIT ä¼šæäº¤äº‹åŠ¡ï¼Œå¹¶ä½¿å·²å¯¹æ•°æ®åº“è¿›è¡Œçš„æ‰€æœ‰ä¿®æ”¹æˆä¸ºæ°¸ä¹…æ€§çš„ï¼›</li>
<li>ROLLBACK ä¹Ÿå¯ä»¥ä½¿ç”¨ ROLLBACK WORKï¼Œä¸è¿‡äºŒè€…æ˜¯ç­‰ä»·çš„ã€‚å›æ»šä¼šç»“æŸç”¨æˆ·çš„äº‹åŠ¡ï¼Œå¹¶æ’¤é”€æ­£åœ¨è¿›è¡Œçš„æ‰€æœ‰æœªæäº¤çš„ä¿®æ”¹ï¼›</li>
<li>SAVEPOINT identifierï¼ŒSAVEPOINT å…è®¸åœ¨äº‹åŠ¡ä¸­åˆ›å»ºä¸€ä¸ªä¿å­˜ç‚¹ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­å¯ä»¥æœ‰å¤šä¸ª SAVEPOINTï¼›</li>
<li>RELEASE SAVEPOINT identifier åˆ é™¤ä¸€ä¸ªäº‹åŠ¡çš„ä¿å­˜ç‚¹ï¼Œå½“æ²¡æœ‰æŒ‡å®šçš„ä¿å­˜ç‚¹æ—¶ï¼Œæ‰§è¡Œè¯¥è¯­å¥ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼›</li>
<li>ROLLBACK TO identifier æŠŠäº‹åŠ¡å›æ»šåˆ°æ ‡è®°ç‚¹ï¼›</li>
<li>SET TRANSACTION ç”¨æ¥è®¾ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚InnoDB å­˜å‚¨å¼•æ“æä¾›äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æœ‰READ UNCOMMITTEDã€READ COMMITTEDã€REPEATABLE READ å’Œ SERIALIZABLEã€‚</li>
</ul>
<h2 id="7-2-MYSQL-äº‹åŠ¡å¤„ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼š"><a href="#7-2-MYSQL-äº‹åŠ¡å¤„ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼š" class="headerlink" title="7.2 MYSQL äº‹åŠ¡å¤„ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼š"></a>7.2 MYSQL äº‹åŠ¡å¤„ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼š</h2><p>1ã€ç”¨ BEGIN, ROLLBACK, COMMITæ¥å®ç°</p>
<ul>
<li><strong>BEGIN</strong> å¼€å§‹ä¸€ä¸ªäº‹åŠ¡</li>
<li><strong>ROLLBACK</strong> äº‹åŠ¡å›æ»š</li>
<li><strong>COMMIT</strong> äº‹åŠ¡ç¡®è®¤</li>
</ul>
<p>2ã€ç›´æ¥ç”¨ SET æ¥æ”¹å˜ MySQL çš„è‡ªåŠ¨æäº¤æ¨¡å¼:</p>
<ul>
<li><strong>SET AUTOCOMMIT=0</strong> ç¦æ­¢è‡ªåŠ¨æäº¤</li>
<li><strong>SET AUTOCOMMIT=1</strong> å¼€å¯è‡ªåŠ¨æäº¤</li>
</ul>
<h2 id="7-3-äº‹åŠ¡çš„éš”ç¦»çº§åˆ«"><a href="#7-3-äº‹åŠ¡çš„éš”ç¦»çº§åˆ«" class="headerlink" title="7.3 äº‹åŠ¡çš„éš”ç¦»çº§åˆ«"></a>7.3 äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</h2><p>äº‹åŠ¡å¹¶å‘é—®é¢˜å¦‚ä½•å‘ç”Ÿï¼Ÿ</p>
<ul>
<li>å½“å¤šä¸ªäº‹åŠ¡åŒæ—¶æ“ä½œåŒä¸€ä¸ªæ•°æ®åº“çš„ç›¸åŒæ•°æ®æ—¶</li>
</ul>
<p>äº‹åŠ¡çš„å¹¶å‘é—®é¢˜æœ‰å“ªäº›ï¼Ÿ</p>
<ul>
<li>è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦å¤–ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®<br>ä¸å¯é‡å¤è¯»ï¼šåŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå¤šæ¬¡è¯»å–åˆ°çš„æ•°æ®ä¸ä¸€è‡´</li>
<li>å¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–æ•°æ®æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡è¿›è¡Œæ›´æ–°ï¼Œå¯¼è‡´ç¬¬ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†æ²¡æœ‰æ›´æ–°çš„æ•°æ®</li>
</ul>
<p>å¦‚ä½•é¿å…äº‹åŠ¡çš„å¹¶å‘é—®é¢˜ï¼Ÿ</p>
<blockquote>
<p>é€šè¿‡è®¾ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«<br>1ã€READ UNCOMMITTED<br>2ã€READ COMMITTED å¯ä»¥é¿å…è„è¯»<br>3ã€REPEATABLE READ å¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œä¸€éƒ¨åˆ†å¹»è¯»<br>4ã€SERIALIZABLEå¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»</p>
</blockquote>
<ul>
<li>è®¾ç½®éš”ç¦»çº§åˆ«ï¼š</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> session<span class="operator">|</span><span class="keyword">global</span>  transaction isolation level éš”ç¦»çº§åˆ«å;</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥çœ‹éš”ç¦»çº§åˆ«:</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@tx</span>_isolation;</span><br></pre></td></tr></table></figure>



<h1 id="8-MySQLç´¢å¼•"><a href="#8-MySQLç´¢å¼•" class="headerlink" title="8. MySQLç´¢å¼•"></a>8. MySQLç´¢å¼•</h1><p>MySQLç´¢å¼•çš„å»ºç«‹å¯¹äºMySQLçš„é«˜æ•ˆè¿è¡Œæ˜¯å¾ˆé‡è¦çš„ï¼Œç´¢å¼•å¯ä»¥å¤§å¤§æé«˜MySQLçš„æ£€ç´¢é€Ÿåº¦ã€‚</p>
<p>ç´¢å¼•åˆ†å•åˆ—ç´¢å¼•å’Œç»„åˆç´¢å¼•ã€‚</p>
<ul>
<li><p>å•åˆ—ç´¢å¼•ï¼Œå³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•ï¼Œä½†è¿™ä¸æ˜¯ç»„åˆç´¢å¼•ã€‚</p>
</li>
<li><p>ç»„åˆç´¢å¼•ï¼Œå³ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ—ã€‚</p>
</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li><p>è™½ç„¶ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶å´ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡ŒINSERTã€UPDATEå’ŒDELETEã€‚å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼ŒMySQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶ã€‚</p>
</li>
<li><p>å»ºç«‹ç´¢å¼•ä¼šå ç”¨ç£ç›˜ç©ºé—´çš„ç´¢å¼•æ–‡ä»¶ã€‚</p>
</li>
</ul>
<h2 id="8-1-æ™®é€šç´¢å¼•"><a href="#8-1-æ™®é€šç´¢å¼•" class="headerlink" title="8.1 æ™®é€šç´¢å¼•"></a>8.1 æ™®é€šç´¢å¼•</h2><p><strong>åˆ›å»ºç´¢å¼•</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX indexName <span class="keyword">ON</span> table_name (column_name)</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹è¡¨ç»“æ„(æ·»åŠ ç´¢å¼•)</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">table</span> tableName <span class="keyword">ADD</span> INDEX indexName(columnName)</span><br></pre></td></tr></table></figure>

<p><strong>åˆ›å»ºè¡¨çš„æ—¶å€™ç›´æ¥æŒ‡å®š</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mytable(  </span><br><span class="line"> </span><br><span class="line">ID <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,   </span><br><span class="line"> </span><br><span class="line">username <span class="type">VARCHAR</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,  </span><br><span class="line"> </span><br><span class="line">INDEX [indexName] (username(length))  </span><br><span class="line"> </span><br><span class="line">);  </span><br></pre></td></tr></table></figure>

<p><strong>åˆ é™¤ç´¢å¼•çš„è¯­æ³•</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX [indexName] <span class="keyword">ON</span> mytable; </span><br></pre></td></tr></table></figure>

<h2 id="8-2-å”¯ä¸€ç´¢å¼•"><a href="#8-2-å”¯ä¸€ç´¢å¼•" class="headerlink" title="8.2 å”¯ä¸€ç´¢å¼•"></a>8.2 å”¯ä¸€ç´¢å¼•</h2><p>ç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼ã€‚å¦‚æœæ˜¯ç»„åˆç´¢å¼•ï¼Œåˆ™åˆ—å€¼çš„ç»„åˆå¿…é¡»å”¯ä¸€ã€‚</p>
<p><strong>åˆ›å»ºç´¢å¼•</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> INDEX indexName <span class="keyword">ON</span> mytable(username(length)) </span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹è¡¨ç»“æ„</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">table</span> mytable <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> [indexName] (username(length))</span><br></pre></td></tr></table></figure>

<p><strong>åˆ›å»ºè¡¨çš„æ—¶å€™ç›´æ¥æŒ‡å®š</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mytable(  </span><br><span class="line"> </span><br><span class="line">ID <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,   </span><br><span class="line"> </span><br><span class="line">username <span class="type">VARCHAR</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,  </span><br><span class="line"> </span><br><span class="line"><span class="keyword">UNIQUE</span> [indexName] (username(length))  </span><br><span class="line"> </span><br><span class="line">);  </span><br></pre></td></tr></table></figure>



<h1 id="9-MySQLå¤„ç†é‡å¤æ•°æ®"><a href="#9-MySQLå¤„ç†é‡å¤æ•°æ®" class="headerlink" title="9. MySQLå¤„ç†é‡å¤æ•°æ®"></a>9. MySQLå¤„ç†é‡å¤æ•°æ®</h1><p>æœ‰äº› MySQL æ•°æ®è¡¨ä¸­å¯èƒ½å­˜åœ¨é‡å¤çš„è®°å½•ï¼Œæœ‰äº›æƒ…å†µæˆ‘ä»¬å…è®¸é‡å¤æ•°æ®çš„å­˜åœ¨ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦åˆ é™¤è¿™äº›é‡å¤çš„æ•°æ®ã€‚</p>
<p><strong>é˜²æ­¢è¡¨ä¸­å‡ºç°é‡å¤æ•°æ®</strong></p>
<p>ä½ å¯ä»¥åœ¨ MySQL æ•°æ®è¡¨ä¸­è®¾ç½®æŒ‡å®šçš„å­—æ®µä¸º <strong>PRIMARY KEYï¼ˆä¸»é”®ï¼‰</strong> æˆ–è€… <strong>UNIQUEï¼ˆå”¯ä¸€ï¼‰</strong> ç´¢å¼•æ¥ä¿è¯æ•°æ®çš„å”¯ä¸€æ€§ã€‚</p>
<p>è®©æˆ‘ä»¬å°è¯•ä¸€ä¸ªå®ä¾‹ï¼šä¸‹è¡¨ä¸­æ— ç´¢å¼•åŠä¸»é”®ï¼Œæ‰€ä»¥è¯¥è¡¨å…è®¸å‡ºç°å¤šæ¡é‡å¤è®°å½•ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person_tbl</span><br><span class="line">(</span><br><span class="line">    first_name <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">    last_name <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">    sex <span class="type">CHAR</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ æƒ³è®¾ç½®è¡¨ä¸­å­—æ®µ first_nameï¼Œlast_name æ•°æ®ä¸èƒ½é‡å¤ï¼Œä½ å¯ä»¥è®¾ç½®åŒä¸»é”®æ¨¡å¼æ¥è®¾ç½®æ•°æ®çš„å”¯ä¸€æ€§ï¼Œ å¦‚æœä½ è®¾ç½®äº†åŒä¸»é”®ï¼Œé‚£ä¹ˆé‚£ä¸ªé”®çš„é»˜è®¤å€¼ä¸èƒ½ä¸º NULLï¼Œå¯è®¾ç½®ä¸º NOT NULLã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person_tbl</span><br><span class="line">(</span><br><span class="line">   first_name <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">   last_name <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">   sex <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="keyword">PRIMARY</span> KEY (last_name, first_name)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬è®¾ç½®äº†å”¯ä¸€ç´¢å¼•ï¼Œé‚£ä¹ˆåœ¨æ’å…¥é‡å¤æ•°æ®æ—¶ï¼ŒSQL è¯­å¥å°†æ— æ³•æ‰§è¡ŒæˆåŠŸ,å¹¶æŠ›å‡ºé”™ã€‚</p>
<p>INSERT IGNORE INTO ä¸ INSERT INTO çš„åŒºåˆ«å°±æ˜¯ INSERT IGNORE INTO ä¼šå¿½ç•¥æ•°æ®åº“ä¸­å·²ç»å­˜åœ¨çš„æ•°æ®ï¼Œå¦‚æœæ•°æ®åº“æ²¡æœ‰æ•°æ®ï¼Œå°±æ’å…¥æ–°çš„æ•°æ®ï¼Œå¦‚æœæœ‰æ•°æ®çš„è¯å°±è·³è¿‡è¿™æ¡æ•°æ®ã€‚è¿™æ ·å°±å¯ä»¥ä¿ç•™æ•°æ®åº“ä¸­å·²ç»å­˜åœ¨æ•°æ®ï¼Œè¾¾åˆ°åœ¨é—´éš™ä¸­æ’å…¥æ•°æ®çš„ç›®çš„ã€‚</p>
<p>ä»¥ä¸‹å®ä¾‹ä½¿ç”¨äº† INSERT IGNORE INTOï¼Œæ‰§è¡Œåä¸ä¼šå‡ºé”™ï¼Œä¹Ÿä¸ä¼šå‘æ•°æ®è¡¨ä¸­æ’å…¥é‡å¤æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> IGNORE <span class="keyword">INTO</span> person_tbl (last_name, first_name)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">VALUES</span>( <span class="string">&#x27;Jay&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> IGNORE <span class="keyword">INTO</span> person_tbl (last_name, first_name)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">VALUES</span>( <span class="string">&#x27;Jay&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>INSERT IGNORE INTO å½“æ’å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è®°å½•çš„å”¯ä¸€æ€§åï¼Œå¦‚æœæ’å…¥é‡å¤æ•°æ®ï¼Œå°†ä¸è¿”å›é”™è¯¯ï¼Œåªä»¥è­¦å‘Šå½¢å¼è¿”å›ã€‚ è€Œ REPLACE INTO å¦‚æœå­˜åœ¨ primary æˆ– unique ç›¸åŒçš„è®°å½•ï¼Œåˆ™å…ˆåˆ é™¤æ‰ã€‚å†æ’å…¥æ–°è®°å½•ã€‚</p>
<p>å¦ä¸€ç§è®¾ç½®æ•°æ®çš„å”¯ä¸€æ€§æ–¹æ³•æ˜¯æ·»åŠ ä¸€ä¸ª UNIQUE ç´¢å¼•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person_tbl</span><br><span class="line">(</span><br><span class="line">   first_name <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">   last_name <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">   sex <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="keyword">UNIQUE</span> (last_name, first_name)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>ç»Ÿè®¡é‡å¤æ•°æ®</strong></p>
<p>ä»¥ä¸‹æˆ‘ä»¬å°†ç»Ÿè®¡è¡¨ä¸­ first_name å’Œ last_nameçš„é‡å¤è®°å½•æ•°ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">as</span> repetitions, last_name, first_name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> person_tbl</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> last_name, first_name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> repetitions <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸ŠæŸ¥è¯¢è¯­å¥å°†è¿”å› person_tbl è¡¨ä¸­é‡å¤çš„è®°å½•æ•°ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢é‡å¤çš„å€¼ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>ç¡®å®šå“ªä¸€åˆ—åŒ…å«çš„å€¼å¯èƒ½ä¼šé‡å¤ã€‚</li>
<li>åœ¨åˆ—é€‰æ‹©åˆ—è¡¨ä½¿ç”¨COUNT(*)åˆ—å‡ºçš„é‚£äº›åˆ—ã€‚</li>
<li>åœ¨GROUP BYå­å¥ä¸­åˆ—å‡ºçš„åˆ—ã€‚</li>
<li>HAVINGå­å¥è®¾ç½®é‡å¤æ•°å¤§äº1ã€‚</li>
</ul>
<p><strong>è¿‡æ»¤é‡å¤æ•°æ®</strong></p>
<p>å¦‚æœä½ éœ€è¦è¯»å–ä¸é‡å¤çš„æ•°æ®å¯ä»¥åœ¨ SELECT è¯­å¥ä¸­ä½¿ç”¨ DISTINCT å…³é”®å­—æ¥è¿‡æ»¤é‡å¤æ•°æ®ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> last_name, first_name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> person_tbl;</span><br></pre></td></tr></table></figure>

<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ GROUP BY æ¥è¯»å–æ•°æ®è¡¨ä¸­ä¸é‡å¤çš„æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> last_name, first_name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> person_tbl</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> (last_name, first_name);</span><br></pre></td></tr></table></figure>

<p><strong>åˆ é™¤é‡å¤æ•°æ®</strong></p>
<p>å¦‚æœä½ æƒ³åˆ é™¤æ•°æ®è¡¨ä¸­çš„é‡å¤æ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„SQLè¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tmp <span class="keyword">SELECT</span> last_name, first_name, sex <span class="keyword">FROM</span> person_tbl  <span class="keyword">GROUP</span> <span class="keyword">BY</span> (last_name, first_name, sex);</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> person_tbl;</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tmp RENAME <span class="keyword">TO</span> person_tbl;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨æ•°æ®è¡¨ä¸­æ·»åŠ  INDEXï¼ˆç´¢å¼•ï¼‰ å’Œ PRIMAY KEYï¼ˆä¸»é”®ï¼‰è¿™ç§ç®€å•çš„æ–¹æ³•æ¥åˆ é™¤è¡¨ä¸­çš„é‡å¤è®°å½•ã€‚æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> IGNORE <span class="keyword">TABLE</span> person_tbl</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (last_name, first_name);</span><br></pre></td></tr></table></figure>



<h1 id="10-MySQL-å¯¼å‡ºæ•°æ®"><a href="#10-MySQL-å¯¼å‡ºæ•°æ®" class="headerlink" title="10.MySQL å¯¼å‡ºæ•°æ®"></a>10.MySQL å¯¼å‡ºæ•°æ®</h1><p>MySQLä¸­ä½ å¯ä»¥ä½¿ç”¨<strong>SELECTâ€¦INTO OUTFILE</strong>è¯­å¥æ¥ç®€å•çš„å¯¼å‡ºæ•°æ®åˆ°æ–‡æœ¬æ–‡ä»¶ä¸Šã€‚</p>
<p><strong>ä½¿ç”¨ SELECT â€¦ INTO OUTFILE è¯­å¥å¯¼å‡ºæ•°æ®</strong></p>
<p>å°†æ•°æ®è¡¨ runoob_tbl æ•°æ®å¯¼å‡ºåˆ° /tmp/runoob.txt æ–‡ä»¶ä¸­:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> runoob_tbl </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">INTO</span> OUTFILE <span class="string">&#x27;/tmp/runoob.txt&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥é€šè¿‡å‘½ä»¤é€‰é¡¹æ¥è®¾ç½®æ•°æ®è¾“å‡ºçš„æŒ‡å®šæ ¼å¼ï¼Œä»¥ä¸‹å®ä¾‹ä¸ºå¯¼å‡º CSV æ ¼å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> passwd <span class="keyword">INTO</span> OUTFILE <span class="string">&#x27;/tmp/runoob.txt&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;,&#x27;</span> ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> LINES TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\r\n&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>SELECT â€¦ INTO OUTFILE è¯­å¥æœ‰ä»¥ä¸‹å±æ€§:</strong></p>
<ul>
<li>LOAD DATA INFILEæ˜¯SELECT â€¦ INTO OUTFILEçš„é€†æ“ä½œï¼ŒSELECTå¥æ³•ã€‚ä¸ºäº†å°†ä¸€ä¸ªæ•°æ®åº“çš„æ•°æ®å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨SELECT â€¦ INTO OUTFILEï¼Œä¸ºäº†å°†æ–‡ä»¶è¯»å›æ•°æ®åº“ï¼Œä½¿ç”¨LOAD DATA INFILEã€‚</li>
<li>SELECTâ€¦INTO OUTFILE â€˜file_nameâ€™å½¢å¼çš„SELECTå¯ä»¥æŠŠè¢«é€‰æ‹©çš„è¡Œå†™å…¥ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚è¯¥æ–‡ä»¶è¢«åˆ›å»ºåˆ°æœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå› æ­¤æ‚¨å¿…é¡»æ‹¥æœ‰FILEæƒé™ï¼Œæ‰èƒ½ä½¿ç”¨æ­¤è¯­æ³•ã€‚</li>
<li>è¾“å‡ºä¸èƒ½æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶ã€‚é˜²æ­¢æ–‡ä»¶æ•°æ®è¢«ç¯¡æ”¹ã€‚</li>
<li>ä½ éœ€è¦æœ‰ä¸€ä¸ªç™»é™†æœåŠ¡å™¨çš„è´¦å·æ¥æ£€ç´¢æ–‡ä»¶ã€‚å¦åˆ™ SELECT â€¦ INTO OUTFILE ä¸ä¼šèµ·ä»»ä½•ä½œç”¨ã€‚</li>
<li>åœ¨UNIXä¸­ï¼Œè¯¥æ–‡ä»¶è¢«åˆ›å»ºåæ˜¯å¯è¯»çš„ï¼Œæƒé™ç”±MySQLæœåŠ¡å™¨æ‰€æ‹¥æœ‰ã€‚è¿™æ„å‘³ç€ï¼Œè™½ç„¶ä½ å°±å¯ä»¥è¯»å–è¯¥æ–‡ä»¶ï¼Œä½†å¯èƒ½æ— æ³•å°†å…¶åˆ é™¤ã€‚</li>
</ul>
<p><strong>å¯¼å‡ºè¡¨ä½œä¸ºåŸå§‹æ•°æ®</strong></p>
<p><strong>mysqldump</strong> æ˜¯ mysql ç”¨äºè½¬å­˜å‚¨æ•°æ®åº“çš„å®ç”¨ç¨‹åºã€‚å®ƒä¸»è¦äº§ç”Ÿä¸€ä¸ª SQL è„šæœ¬ï¼Œå…¶ä¸­åŒ…å«ä»å¤´é‡æ–°åˆ›å»ºæ•°æ®åº“æ‰€å¿…éœ€çš„å‘½ä»¤ CREATE TABLE INSERT ç­‰ã€‚</p>
<p><strong>å¯¼å‡º SQL æ ¼å¼çš„æ•°æ®</strong></p>
<p>å¯¼å‡º SQL æ ¼å¼çš„æ•°æ®åˆ°æŒ‡å®šæ–‡ä»¶</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump <span class="operator">-</span>u root <span class="operator">-</span>p RUNOOB runoob_tbl <span class="operator">&gt;</span> dump.txt</span><br><span class="line">password <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>

<p><strong>éœ€è¦å¯¼å‡ºæ•´ä¸ªæ•°æ®åº“çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump <span class="operator">-</span>u root <span class="operator">-</span>p RUNOOB <span class="operator">&gt;</span> database_dump.txt</span><br><span class="line">password <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>

<p><strong>éœ€è¦å¤‡ä»½æ‰€æœ‰æ•°æ®åº“ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump <span class="operator">-</span>u root <span class="operator">-</span>p <span class="comment">--all-databases &gt; database_dump.txt</span></span><br><span class="line">password <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>



<h1 id="11-MySQLå¯¼å…¥æ•°æ®"><a href="#11-MySQLå¯¼å…¥æ•°æ®" class="headerlink" title="11. MySQLå¯¼å…¥æ•°æ®"></a>11. MySQLå¯¼å…¥æ•°æ®</h1><p><strong>1ã€mysql å‘½ä»¤å¯¼å…¥</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql <span class="operator">-</span>uç”¨æˆ·å    <span class="operator">-</span>på¯†ç     <span class="operator">&lt;</span>  è¦å¯¼å…¥çš„æ•°æ®åº“æ•°æ®(xxxx.sql)</span><br><span class="line"></span><br><span class="line">mysql <span class="operator">-</span>uroot <span class="operator">-</span>p123456 <span class="operator">&lt;</span> xxxx.sql</span><br></pre></td></tr></table></figure>

<p><strong>2ã€source å‘½ä»¤å¯¼å…¥</strong></p>
<p>source å‘½ä»¤å¯¼å…¥æ•°æ®åº“éœ€è¦å…ˆç™»å½•åˆ°æ•°åº“ç»ˆç«¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> database xxx;      # åˆ›å»ºæ•°æ®åº“</span><br><span class="line">mysql<span class="operator">&gt;</span> use xxx;                  # ä½¿ç”¨å·²åˆ›å»ºçš„æ•°æ®åº“ </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> names utf8;           # è®¾ç½®ç¼–ç </span><br><span class="line">mysql<span class="operator">&gt;</span> source <span class="operator">/</span>xxx<span class="operator">/</span>xxx<span class="operator">/</span>xxx.sql  # å¯¼å…¥å¤‡ä»½æ•°æ®åº“</span><br></pre></td></tr></table></figure>



<h1 id="12-MySQLå‡½æ•°"><a href="#12-MySQLå‡½æ•°" class="headerlink" title="12.MySQLå‡½æ•°"></a>12.MySQLå‡½æ•°</h1><p>éœ€è¦ç”¨åˆ°æ¥å‚è€ƒ</p>
<p><strong>å‚è€ƒåœ°å€ï¼š<a href="https://www.runoob.com/mysql/mysql-functions.html">MySQL å‡½æ•° | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></strong></p>
<h1 id="13-MySQLè¿ç®—ç¬¦"><a href="#13-MySQLè¿ç®—ç¬¦" class="headerlink" title="13. MySQLè¿ç®—ç¬¦"></a>13. MySQLè¿ç®—ç¬¦</h1><p><strong>å‚è€ƒåœ°å€ï¼š<a href="https://www.runoob.com/mysql/mysql-operator.html">MySQL è¿ç®—ç¬¦ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></strong></p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaåå°„å­¦ä¹ ç¬”è®°</title>
    <url>/2021/01/15/Java%E5%8F%8D%E5%B0%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Javaåå°„å­¦ä¹ ç¬”è®°"><a href="#Javaåå°„å­¦ä¹ ç¬”è®°" class="headerlink" title="Javaåå°„å­¦ä¹ ç¬”è®°"></a>Javaåå°„å­¦ä¹ ç¬”è®°</h1><p>å†™åœ¨å‰é¢</p>
<ul>
<li>æ„Ÿè°¢éŸ©è€å¸ˆçš„è§†é¢‘è®²è§£ï¼</li>
<li>å­¦ä¹ åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1g84y1F7df">ã€éŸ©é¡ºå¹³è®²Javaã€‘Javaåå°„ä¸“é¢˜ </a></li>
</ul>
<h1 id="1-åå°„æœºåˆ¶"><a href="#1-åå°„æœºåˆ¶" class="headerlink" title="1. åå°„æœºåˆ¶"></a>1. åå°„æœºåˆ¶</h1><ul>
<li>åå°„æœºåˆ¶å…è®¸ç¨‹åºåœ¨æ‰§è¡ŒæœŸå€ŸåŠ©äº<code>ReflectionAPI</code>å–å¾—ä»»ä½•ç±»çš„å†…éƒ¨ä¿¡æ¯ï¼Œ(æ¯”å¦‚æˆå‘˜å˜é‡ï¼Œæ„é€ å™¨ï¼Œæˆå‘˜æ–¹æ³•ç­‰)ï¼Œå¹¶èƒ½æ“ä½œå¯¹è±¡çš„å±æ€§åŠæ–¹æ³•ï¼Œåœ¨è®¾è®¡æ¨¡å¼å’Œæ¡†æ¶éƒ½ä¼šç”¨åˆ°</li>
<li>åŠ è½½å®Œç±»åï¼Œåœ¨å †ä¸­å°±äº§ç”Ÿäº†ä¸€ä¸ª<code>Class</code>ç±»å‹çš„å¯¹è±¡ï¼ˆä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªClasså¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº†ç±»çš„å®Œæ•´ç»“æ„ä¿¡æ¯ï¼Œé€šè¿‡å¯¹è¿™ä¸ªå¯¹è±¡å¾—åˆ°è¿™ç±»çš„ç»“æ„ï¼Œè¿™ä¸ª<code>Class</code>å¯¹è±¡å°±åƒä¸€é¢é•œå­ï¼Œé€è¿‡è¿™ä¸ªé•œå­çœ‹åˆ°ç±»çš„ç»“æ„ï¼Œå½¢è±¡çš„ç§°ä¹‹ä¸ºåå°„</li>
</ul>
<h2 id="1-1-åå°„æœºåˆ¶åŸç†ç¤ºæ„å›¾"><a href="#1-1-åå°„æœºåˆ¶åŸç†ç¤ºæ„å›¾" class="headerlink" title="1.1 åå°„æœºåˆ¶åŸç†ç¤ºæ„å›¾"></a>1.1 åå°„æœºåˆ¶åŸç†ç¤ºæ„å›¾</h2><p><a href="https://imgtu.com/i/2R8eL8"><img src="https://z3.ax1x.com/2021/06/10/2R8eL8.png" alt="2R8eL8.png"></a></p>
<h2 id="1-2-Java-åå°„æœºåˆ¶å¯ä»¥å®Œæˆ"><a href="#1-2-Java-åå°„æœºåˆ¶å¯ä»¥å®Œæˆ" class="headerlink" title="1.2 Java åå°„æœºåˆ¶å¯ä»¥å®Œæˆ"></a>1.2 Java åå°„æœºåˆ¶å¯ä»¥å®Œæˆ</h2><ol>
<li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»</li>
<li>åœ¨è¿è¡Œæ„é€ æ—¶ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡</li>
<li>åœ¨è¿è¡Œæ—¶å¾—åˆ°ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•</li>
<li>åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•</li>
<li>ç”ŸæˆåŠ¨æ€ä»£ç†</li>
</ol>
<h2 id="1-3-åå°„ç›¸å…³çš„ä¸»è¦ç±»"><a href="#1-3-åå°„ç›¸å…³çš„ä¸»è¦ç±»" class="headerlink" title="1.3 åå°„ç›¸å…³çš„ä¸»è¦ç±»"></a>1.3 åå°„ç›¸å…³çš„ä¸»è¦ç±»</h2><p><a href="https://imgtu.com/i/2R8sQx"><img src="https://z3.ax1x.com/2021/06/10/2R8sQx.png" alt="2R8sQx.png"></a></p>
<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Reflection01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> åå°„ç±»01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/10 19:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reflection01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨Propertiesç±» ï¼Œè¯»å†™é…ç½®æ–‡ä»¶</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.load(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;f:\\re.properties&quot;</span>));</span><br><span class="line">        String classfullPath=properties.get(<span class="string">&quot;classfullpath&quot;</span>).toString();</span><br><span class="line">        String methodName=properties.get(<span class="string">&quot;method&quot;</span>).toString();</span><br><span class="line">        System.out.println(classfullPath);</span><br><span class="line">        System.out.println(methodName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä½¿ç”¨åå°„æœºåˆ¶è§£å†³</span></span><br><span class="line">        <span class="comment">//åŠ è½½ç±»ï¼Œè¿”å›Classç±»å‹å¯¹è±¡</span></span><br><span class="line">        Class cls = Class.forName(<span class="string">&quot;com.zhuang.reflection.Cat&quot;</span>);</span><br><span class="line">        <span class="comment">//é€šè¿‡clsçš„åˆ°åŠ è½½ç±»çš„å¯¹è±¡å®ä¾‹</span></span><br><span class="line">        Object o = cls.newInstance();</span><br><span class="line">        System.out.println(<span class="string">&quot;oçš„è¿è¡Œç±»å‹=&quot;</span>+o.getClass());</span><br><span class="line">        <span class="comment">//é€šè¿‡clsçš„åŠ è½½çš„ç±» çš„æ–¹æ³•</span></span><br><span class="line">        Method method = cls.getMethod(methodName);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹æ³•æ˜¯&quot;</span>+method);</span><br><span class="line">        <span class="comment">//é€šè¿‡methodè°ƒç”¨æ–¹æ³•ï¼Œé€šè¿‡æ–¹æ³•å¯¹è±¡æ¥å®ç°è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        ä¼ ç»Ÿæ–¹æ³• å¯¹è±¡.æ–¹æ³•()</span></span><br><span class="line"><span class="comment">        åå°„æœºåˆ¶ æ–¹æ³•.invoke(å¯¹è±¡)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        method.invoke(o);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//java.lang.reflect.Field: ä»£è¡¨ç±»çš„æˆå‘˜å˜é‡, Field å¯¹è±¡è¡¨ç¤ºæŸä¸ªç±»çš„æˆå‘˜å˜é‡</span></span><br><span class="line">        <span class="comment">//å¾—åˆ° name å­—æ®µ</span></span><br><span class="line">        <span class="comment">//getField ä¸èƒ½å¾—åˆ°ç§æœ‰çš„å±æ€§</span></span><br><span class="line">        Field nameField = cls.getField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">        <span class="comment">// ä¼ ç»Ÿå†™æ³• å¯¹è±¡.æˆå‘˜å˜é‡ , åå°„ : æˆå‘˜å˜é‡å¯¹è±¡.get(å¯¹è±¡)</span></span><br><span class="line">        System.out.println(nameField.get(o));</span><br><span class="line">    <span class="comment">//java.lang.reflect.Constructor: ä»£è¡¨ç±»çš„æ„é€ æ–¹æ³•, Constructor å¯¹è±¡è¡¨ç¤ºæ„é€ å™¨</span></span><br><span class="line">        <span class="comment">//()ä¸­å¯ä»¥æŒ‡å®šæ„é€ å™¨å‚æ•°ç±»å‹, è¿”å›æ— å‚æ„é€ å™¨</span></span><br><span class="line">        Constructor constructor = cls.getConstructor();</span><br><span class="line">        System.out.println(constructor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/2RJqiQ"><img src="https://z3.ax1x.com/2021/06/10/2RJqiQ.png" alt="2RJqiQ.png"></a></p>
<h2 id="1-4-åå°„ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#1-4-åå°„ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="1.4 åå°„ä¼˜ç‚¹å’Œç¼ºç‚¹"></a>1.4 åå°„ä¼˜ç‚¹å’Œç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å¯ä»¥åŠ¨æ€åœ°åˆ›å»ºå’Œä½¿ç”¨å¯¹è±¡ï¼Œçµæ´»</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li><p>ä½¿ç”¨åå°„åŸºæœ¬æ˜¯è§£é‡Šæ‰§è¡Œï¼Œå¯¹æ‰§è¡Œé€Ÿåº¦æœ‰å½±å“</p>
</li>
<li><p><strong>ä¼˜åŒ–å¯ä»¥ä½¿ç”¨ä¸‹åˆ—æ–¹æ³•</strong></p>
</li>
</ul>
<p><a href="https://imgtu.com/i/2RYAzR"><img src="https://z3.ax1x.com/2021/06/10/2RYAzR.png" alt="2RYAzR.png"></a></p>
<h1 id="2-Classç±»"><a href="#2-Classç±»" class="headerlink" title="2. Classç±»"></a>2. Classç±»</h1><p>åŸºæœ¬ä»‹ç»</p>
<p><a href="https://imgtu.com/i/2RYeL6"><img src="https://z3.ax1x.com/2021/06/10/2RYeL6.png" alt="2RYeL6.png"></a></p>
<ol>
<li><code>Class</code>ä¹Ÿæ˜¯ç±»ï¼Œç»§æ‰¿è‡ª<code>Object</code>ç±»</li>
<li><code>Class</code>ç±»å¯¹è±¡ä¸æ˜¯newå‡ºæ¥çš„ï¼Œè€Œæ˜¯ç³»ç»Ÿåˆ›å»ºçš„</li>
<li>å¯¹äºæŸä¸ªç±»çš„<code>Class</code>ç±»å¯¹è±¡ï¼Œåœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½</li>
<li>æ¯ä¸ªç±»çš„ç¤ºä¾‹éƒ½ä¼šè®°å¾—è‡ªå·±æ˜¯ç”±å“ªä¸ª<code>Class</code>å®ä¾‹æ‰€ç”Ÿæˆ</li>
<li>é€šè¿‡<code>Class</code>å¯¹è±¡å®Œæ•´çš„ä¸€ä¸ªç±»çš„å®Œæ•´ç»“æ„ï¼Œé€šè¿‡ä¸€ç³»åˆ—API</li>
<li><code>Class</code>å¯¹è±¡æ˜¯å­˜æ”¾åœ¨å †é‡Œçš„</li>
<li>ç±»çš„å­—èŠ‚ç äºŒè¿›åˆ¶æ•°æ®ï¼Œæ˜¯åœ¨æ–¹æ³•åŒºçš„</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ClassLoader ç±», ä»ç„¶æ˜¯é€šè¿‡ ClassLoader ç±»åŠ è½½ Cat ç±»çš„ Class å¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> Class&lt;?&gt; loadClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">	<span class="keyword">return</span> loadClass(name, <span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Class01</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Class01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/10 20:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Class01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//æŸä¸ªç±»çš„å¯¹è±¡Class ï¼Œåœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œç±»åªåŠ è½½ä¸€æ¬¡</span></span><br><span class="line">        Class&lt;?&gt; cls1 = Class.forName(<span class="string">&quot;com.zhuang.reflection.Cat&quot;</span>);</span><br><span class="line">        Class&lt;?&gt; cls2 = Class.forName(<span class="string">&quot;com.zhuang.reflection.Cat&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(cls1.hashCode());</span><br><span class="line">        System.out.println(cls2.hashCode());</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        22307196</span></span><br><span class="line"><span class="comment">		22307196</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-1-Classç±»å¸¸ç”¨æ–¹æ³•"><a href="#2-1-Classç±»å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.1 Classç±»å¸¸ç”¨æ–¹æ³•"></a>2.1 Classç±»å¸¸ç”¨æ–¹æ³•</h2><p><a href="https://imgtu.com/i/2RtH3j"><img src="https://z3.ax1x.com/2021/06/10/2RtH3j.png" alt="2RtH3j.png"></a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Class02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºClassç±»çš„å¸¸ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/10 20:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Class02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String classAllPath = <span class="string">&quot;com.zhuang.reflection.Car&quot;</span>;</span><br><span class="line">        <span class="comment">//1 . è·å–åˆ° Car ç±» å¯¹åº”çš„ Class å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//&lt;?&gt; è¡¨ç¤ºä¸ç¡®å®šçš„ Java ç±»å‹</span></span><br><span class="line">        Class&lt;?&gt; cls = Class.forName(classAllPath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. è¾“å‡º cls</span></span><br><span class="line">        <span class="comment">//æ˜¾ç¤º cls å¯¹è±¡, æ˜¯å“ªä¸ªç±»çš„ Class å¯¹è±¡ com.hspedu.Car</span></span><br><span class="line">        System.out.println(cls);</span><br><span class="line">        <span class="comment">//è¾“å‡º cls è¿è¡Œç±»å‹ java.lang.Class</span></span><br><span class="line">        System.out.println(cls.getClass());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. å¾—åˆ°åŒ…å</span></span><br><span class="line">        System.out.println(cls.getPackage().getName());</span><br><span class="line">        <span class="comment">//4. å¾—åˆ°å…¨ç±»å</span></span><br><span class="line">        System.out.println(cls.getName());</span><br><span class="line">        <span class="comment">//5. é€šè¿‡ cls åˆ›å»ºå¯¹è±¡å®ä¾‹</span></span><br><span class="line">        Car car = (Car) cls.newInstance();</span><br><span class="line">        System.out.println(car);</span><br><span class="line">        <span class="comment">//6. é€šè¿‡åå°„è·å–å±æ€§ brand</span></span><br><span class="line">        Field brand = cls.getField(<span class="string">&quot;brand&quot;</span>);</span><br><span class="line">        System.out.println(brand.get(car));</span><br><span class="line">        <span class="comment">//7. é€šè¿‡åå°„ç»™å±æ€§èµ‹å€¼</span></span><br><span class="line">        brand.set(car, <span class="string">&quot;å¥”é©°&quot;</span>);</span><br><span class="line">        System.out.println(brand.get(car));</span><br><span class="line">        <span class="comment">//8 æˆ‘å¸Œæœ›å¤§å®¶å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„å±æ€§(å­—æ®µ)</span></span><br><span class="line">        System.out.println(<span class="string">&quot;=======æ‰€æœ‰çš„å­—æ®µå±æ€§====&quot;</span>);</span><br><span class="line">        Field[] fields = cls.getFields();</span><br><span class="line">        <span class="keyword">for</span> (Field f : fields) &#123;</span><br><span class="line">            System.out.println(f.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/2RNXzd"><img src="https://z3.ax1x.com/2021/06/10/2RNXzd.png" alt="2RNXzd.png"></a></p>
<h2 id="2-2-è·å–Classç±»å¯¹è±¡"><a href="#2-2-è·å–Classç±»å¯¹è±¡" class="headerlink" title="2.2 è·å–Classç±»å¯¹è±¡"></a>2.2 è·å–Classç±»å¯¹è±¡</h2><ol>
<li>å‰æï¼šå·²çŸ¥ä¸€ä¸ªç±»çš„å…¨ç±»åï¼Œä¸”è¯¥ç±»åœ¨ç±»è·¯å¾„ä¸‹ï¼Œå¯é€šè¿‡<code>Class</code>ç±»çš„é™æ€æ–¹æ³•<code>forName()</code>è·å–ï¼Œ</li>
<li>å‰æï¼šè‹¥å·²çŸ¥å…·ä½“çš„ç±»ï¼Œé€šè¿‡ç±»çš„<code>class</code>ï¼Œç¨‹åºæ€§èƒ½æœ€é«˜</li>
<li>å‰æï¼šå·²çŸ¥æŸä¸ªç±»çš„å®ä¾‹ï¼Œè°ƒç”¨è¯¥å®ä¾‹çš„<code>getClass()</code>æ–¹æ³•è·å–<code>Class</code>å¯¹è±¡</li>
<li>åŸºæœ¬æ•°æ®ç±»å‹ï¼Œ æŒ‰ç…§ <code>Class cls=åŸºæœ¬æ•°æ®ç±»å‹.class</code>æ–¹æ³•</li>
<li>åŸºæœ¬æ•°æ®ç±»å‹çš„åŒ…è£…ç±»ï¼Œå¯ä»¥é€šè¿‡<code>.TYPE</code>å¾—åˆ°<code>Class</code>å¯¹è±¡ <code>Class cls=åŒ…è£…ç±».TYPE</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> GetClass_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºå¾—åˆ° Class å¯¹è±¡çš„å„ç§æ–¹å¼(6)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/10 20:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetClass_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1. Class.forName</span></span><br><span class="line">        String classAllPath = <span class="string">&quot;com.zhuang.reflection.Car&quot;</span>;</span><br><span class="line">        Class&lt;?&gt; cls1 = Class.forName(classAllPath);</span><br><span class="line">        System.out.println(cls1);</span><br><span class="line">        <span class="comment">//2. ç±»å.class , åº”ç”¨åœºæ™¯: ç”¨äºå‚æ•°ä¼ é€’</span></span><br><span class="line">        Class cls2 = Car.class;</span><br><span class="line">        System.out.println(cls2);</span><br><span class="line">        <span class="comment">//3. å¯¹è±¡.getClass(), åº”ç”¨åœºæ™¯ï¼Œæœ‰å¯¹è±¡å®ä¾‹</span></span><br><span class="line">        Car car = <span class="keyword">new</span> Car();</span><br><span class="line">        Class cls3 = car.getClass();</span><br><span class="line">        System.out.println(cls3);</span><br><span class="line">        <span class="comment">//4. é€šè¿‡ç±»åŠ è½½å™¨ã€4 ç§ã€‘æ¥è·å–åˆ°ç±»çš„ Class å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//(1)å…ˆå¾—åˆ°ç±»åŠ è½½å™¨ car</span></span><br><span class="line">        ClassLoader classLoader = car.getClass().getClassLoader();</span><br><span class="line">        <span class="comment">//(2)é€šè¿‡ç±»åŠ è½½å™¨å¾—åˆ° Class å¯¹è±¡</span></span><br><span class="line">        Class cls4 = classLoader.loadClass(classAllPath);</span><br><span class="line">        System.out.println(cls4);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. åŸºæœ¬æ•°æ®(int, char,boolean,float,double,byte,long,short) æŒ‰å¦‚ä¸‹æ–¹å¼å¾—åˆ° Class ç±»å¯¹è±¡</span></span><br><span class="line">        Class&lt;Integer&gt; integerClass = <span class="keyword">int</span>.class;</span><br><span class="line">        Class&lt;Character&gt; characterClass = <span class="keyword">char</span>.class;</span><br><span class="line">        Class&lt;Boolean&gt; booleanClass = <span class="keyword">boolean</span>.class;</span><br><span class="line">        System.out.println(integerClass);</span><br><span class="line">        System.out.println(characterClass);</span><br><span class="line">        System.out.println(booleanClass);</span><br><span class="line">        <span class="comment">//6. åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„åŒ…è£…ç±»ï¼Œå¯ä»¥é€šè¿‡ .TYPE å¾—åˆ° Class ç±»å¯¹è±¡</span></span><br><span class="line">        Class&lt;Integer&gt; type1 = Integer.TYPE;</span><br><span class="line">        Class&lt;Character&gt; type2 = Character.TYPE;</span><br><span class="line">        System.out.println(type1);</span><br><span class="line">        System.out.println(integerClass.hashCode());</span><br><span class="line">        System.out.println(type1.hashCode());</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/2Ra8N8"><img src="https://z3.ax1x.com/2021/06/10/2Ra8N8.png" alt="2Ra8N8.png"></a></p>
<h2 id="2-3-å“ªäº›ç±»å‹æœ‰-Class-å¯¹è±¡"><a href="#2-3-å“ªäº›ç±»å‹æœ‰-Class-å¯¹è±¡" class="headerlink" title="2.3 å“ªäº›ç±»å‹æœ‰ Class å¯¹è±¡"></a>2.3 å“ªäº›ç±»å‹æœ‰ Class å¯¹è±¡</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> AllTypeClass</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºå“ªäº›ç±»å‹æœ‰ Class å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/10 21:08</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AllTypeClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//å¤–éƒ¨ç±»</span></span><br><span class="line">        Class&lt;String&gt; cls1 = String.class;</span><br><span class="line">        <span class="comment">//æ¥å£</span></span><br><span class="line">        Class&lt;Serializable&gt; cls2 = Serializable.class;</span><br><span class="line">        <span class="comment">//æ•°ç»„</span></span><br><span class="line">        Class&lt;Integer[]&gt; cls3 = Integer[].class;</span><br><span class="line">        <span class="comment">//äºŒç»´æ•°ç»„</span></span><br><span class="line">        Class&lt;<span class="keyword">float</span>[][]&gt; cls4 = <span class="keyword">float</span>[][].class;</span><br><span class="line">        <span class="comment">//æ³¨è§£</span></span><br><span class="line">        Class&lt;Deprecated&gt; cls5 = Deprecated.class;</span><br><span class="line">        <span class="comment">//æšä¸¾</span></span><br><span class="line">        Class&lt;Thread.State&gt; cls6 = Thread.State.class;</span><br><span class="line">        <span class="comment">//åŸºæœ¬æ•°æ®ç±»å‹</span></span><br><span class="line">        Class&lt;Long&gt; cls7 = <span class="keyword">long</span>.class;</span><br><span class="line">        <span class="comment">//void æ•°æ®ç±»å‹</span></span><br><span class="line">        Class&lt;Void&gt; cls8 = <span class="keyword">void</span>.class;</span><br><span class="line">        Class&lt;Class&gt; cls9 = Class.class;</span><br><span class="line">        System.out.println(cls1);</span><br><span class="line">        System.out.println(cls2);</span><br><span class="line">        System.out.println(cls3);</span><br><span class="line">        System.out.println(cls4);</span><br><span class="line">        System.out.println(cls5);</span><br><span class="line">        System.out.println(cls6);</span><br><span class="line">        System.out.println(cls7);</span><br><span class="line">        System.out.println(cls8);</span><br><span class="line">        System.out.println(cls9);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/2R0t3D"><img src="https://z3.ax1x.com/2021/06/10/2R0t3D.png" alt="2R0t3D.png"></a></p>
<h1 id="3-ç±»åŠ è½½"><a href="#3-ç±»åŠ è½½" class="headerlink" title="3. ç±»åŠ è½½"></a>3. ç±»åŠ è½½</h1><ul>
<li>åå°„æœºåˆ¶æ˜¯javaå®ç°å†¬å¤©è¯­è¨€çš„å…³é”®ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡åå°„å®ç°ç±»åŠ¨æ€åŠ è½½</li>
<li>é™æ€åŠ è½½ï¼šç¼–è¯‘æ—¶åŠ è½½ç›¸å…³çš„ç±»ï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œ<strong>ä¾èµ–æ€§å¤ªå¼º</strong></li>
<li>åŠ¨æ€åŠ è½½ï¼šè¿è¡Œæ—¶åŠ è½½éœ€è¦çš„ç±»ï¼Œå¦‚æœè¿è¡Œæ—¶ä¸ç”¨è¯¥ç±»ï¼Œå³ä½¿ä¸å­˜åœ¨è¯¥ç±»ï¼Œåˆ™ä¸æŠ¥é”™ï¼Œ<strong>é™ä½äº†ä¾èµ–æ€§</strong></li>
</ul>
<h2 id="3-1-ç±»åŠ è½½æ—¶æœº"><a href="#3-1-ç±»åŠ è½½æ—¶æœº" class="headerlink" title="3.1 ç±»åŠ è½½æ—¶æœº"></a>3.1 ç±»åŠ è½½æ—¶æœº</h2><p><strong>é™æ€åŠ è½½</strong></p>
<ol>
<li>å½“åˆ›å»ºå¯¹è±¡æ—¶ <code>new </code></li>
<li>å½“å­ç±»è¢«åŠ è½½æ—¶ï¼Œçˆ¶ç±»ä¹ŸåŠ è½½</li>
<li>è°ƒç”¨ç±»ä¸­çš„é™æ€è½¦æˆå‘˜æ—¶</li>
</ol>
<p><strong>åŠ¨æ€åŠ è½½</strong></p>
<ol>
<li>é€šè¿‡åå°„</li>
</ol>
<h2 id="3-2-ç±»åŠ è½½è¿‡ç¨‹å›¾"><a href="#3-2-ç±»åŠ è½½è¿‡ç¨‹å›¾" class="headerlink" title="3.2 ç±»åŠ è½½è¿‡ç¨‹å›¾"></a>3.2 ç±»åŠ è½½è¿‡ç¨‹å›¾</h2><p><a href="https://imgtu.com/i/2RBixe"><img src="https://z3.ax1x.com/2021/06/10/2RBixe.png" alt="2RBixe.png"></a></p>
<h2 id="3-3-ç±»åŠ è½½å„é˜¶æ®µå®Œæˆä»»åŠ¡"><a href="#3-3-ç±»åŠ è½½å„é˜¶æ®µå®Œæˆä»»åŠ¡" class="headerlink" title="3.3 ç±»åŠ è½½å„é˜¶æ®µå®Œæˆä»»åŠ¡"></a>3.3 ç±»åŠ è½½å„é˜¶æ®µå®Œæˆä»»åŠ¡</h2><p><a href="https://imgtu.com/i/2RBKG8"><img src="https://z3.ax1x.com/2021/06/10/2RBKG8.png" alt="2RBKG8.png"></a></p>
<h2 id="3-4-åŠ è½½é˜¶æ®µ"><a href="#3-4-åŠ è½½é˜¶æ®µ" class="headerlink" title="3.4 åŠ è½½é˜¶æ®µ"></a>3.4 åŠ è½½é˜¶æ®µ</h2><p><a href="https://imgtu.com/i/2RB8qs"><img src="https://z3.ax1x.com/2021/06/10/2RB8qs.png" alt="2RB8qs.png"></a></p>
<h2 id="3-5-è¿æ¥é˜¶æ®µ-éªŒè¯"><a href="#3-5-è¿æ¥é˜¶æ®µ-éªŒè¯" class="headerlink" title="3.5 è¿æ¥é˜¶æ®µ-éªŒè¯"></a>3.5 è¿æ¥é˜¶æ®µ-éªŒè¯</h2><ol>
<li>ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿<code>Class</code>æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºçš„è‡ªèº«å®‰å…¨</li>
<li>åŒ…æ‹¬ï¼šæ–‡ä»¶æ ¼å¼éªŒè¯ï¼Œå…ƒæ•°æ®éªŒè¯ï¼Œå­—èŠ‚ç éªŒè¯ï¼Œç¬¦å·å¼•ç”¨éªŒè¯ç­‰</li>
</ol>
<h2 id="3-6-è¿æ¥é˜¶æ®µ-å‡†å¤‡"><a href="#3-6-è¿æ¥é˜¶æ®µ-å‡†å¤‡" class="headerlink" title="3.6 è¿æ¥é˜¶æ®µ-å‡†å¤‡"></a>3.6 è¿æ¥é˜¶æ®µ-å‡†å¤‡</h2><ul>
<li>JVMä¼šåœ¨è¯¥é˜¶æ®µå¯¹é™æ€å˜é‡ï¼Œåˆ†é…å†…å­˜å¹¶é»˜è®¤åˆå§‹åŒ–(å¯¹åº”æ•°æ®ç±»å‹çš„é»˜è®¤åˆå§‹å€¼)ï¼Œè¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºè¿›è¡Œåˆ†é…</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. n1 æ˜¯å®ä¾‹å±æ€§, ä¸æ˜¯é™æ€å˜é‡ï¼Œå› æ­¤åœ¨å‡†å¤‡é˜¶æ®µï¼Œæ˜¯ä¸ä¼šåˆ†é…å†…å­˜</span></span><br><span class="line"><span class="comment">//2. n2 æ˜¯é™æ€å˜é‡ï¼Œåˆ†é…å†…å­˜ n2 æ˜¯é»˜è®¤åˆå§‹åŒ– 0 ,è€Œä¸æ˜¯ 20</span></span><br><span class="line"><span class="comment">//3. n3 æ˜¯ static final æ˜¯å¸¸é‡, ä»–å’Œé™æ€å˜é‡ä¸ä¸€æ ·, å› ä¸ºä¸€æ—¦èµ‹å€¼å°±ä¸å˜ n3 = 30</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> n1 = <span class="number">10</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> n2 = <span class="number">20</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> n3 = <span class="number">30</span>;</span><br></pre></td></tr></table></figure>



<h2 id="3-7-Initializationï¼ˆåˆå§‹åŒ–"><a href="#3-7-Initializationï¼ˆåˆå§‹åŒ–" class="headerlink" title="3.7 Initializationï¼ˆåˆå§‹åŒ–)"></a>3.7 Initializationï¼ˆåˆå§‹åŒ–)</h2><ol>
<li>åˆ°åˆå§‹åŒ–é˜¶æ®µï¼ŒçœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­çš„å®šä¹‰Javaç¨‹åºä»£ç ï¼Œæ­¤é˜¶æ®µæ‰§è¡Œ<clinit>æ–¹æ³•çš„è¿‡ç¨‹</li>
<li><clinit>æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨æŒ‰è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºï¼Œ<strong>ä¾æ¬¡è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰çš„é™æ€å˜é‡èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—çš„è¯­å¥ï¼Œå¹¶è¿›è¡Œåˆå¹¶</strong></li>
<li>è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„<clinit>æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­æ­£ç¡®åœ°åŠ é”ï¼ŒåŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å»åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªç±»çš„<clinit>æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹éƒ½éœ€è¦é˜»å¡ç­‰å¾…ï¼ŒçŸ¥é“æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œ<clinit>æ–¹æ³•å®Œæ¯•</li>
</ol>
<h1 id="4-é€šè¿‡åå°„è·å–ç±»çš„ç»“æ„ä¿¡æ¯"><a href="#4-é€šè¿‡åå°„è·å–ç±»çš„ç»“æ„ä¿¡æ¯" class="headerlink" title="4. é€šè¿‡åå°„è·å–ç±»çš„ç»“æ„ä¿¡æ¯"></a>4. é€šè¿‡åå°„è·å–ç±»çš„ç»“æ„ä¿¡æ¯</h1><h2 id="4-1-java-lang-Class-ç±»"><a href="#4-1-java-lang-Class-ç±»" class="headerlink" title="4.1 java.lang.Class ç±»"></a>4.1 java.lang.Class ç±»</h2><p><a href="https://imgtu.com/i/2RgBhn"><img src="https://z3.ax1x.com/2021/06/10/2RgBhn.png" alt="2RgBhn.png"></a></p>
<h2 id="4-2-java-lang-reflect-Field-ç±»"><a href="#4-2-java-lang-reflect-Field-ç±»" class="headerlink" title="4.2 java.lang.reflect.Field ç±»"></a>4.2 java.lang.reflect.Field ç±»</h2><p><a href="https://imgtu.com/i/2Rg0ts"><img src="https://z3.ax1x.com/2021/06/10/2Rg0ts.png" alt="2Rg0ts.png"></a></p>
<h2 id="4-3-java-lang-reflect-Method-ç±»"><a href="#4-3-java-lang-reflect-Method-ç±»" class="headerlink" title="4.3 java.lang.reflect.Method ç±»"></a>4.3 java.lang.reflect.Method ç±»</h2><p><a href="https://imgtu.com/i/2Rgwkj"><img src="https://z3.ax1x.com/2021/06/10/2Rgwkj.png" alt="2Rgwkj.png"></a></p>
<h2 id="4-4-java-lang-reflect-Constructor-ç±»"><a href="#4-4-java-lang-reflect-Constructor-ç±»" class="headerlink" title="4.4 java.lang.reflect.Constructor ç±»"></a>4.4 java.lang.reflect.Constructor ç±»</h2><p><a href="https://imgtu.com/i/2Rgs10"><img src="https://z3.ax1x.com/2021/06/10/2Rgs10.png" alt="2Rgs10.png"></a></p>
<h1 id="5-é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡"><a href="#5-é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡" class="headerlink" title="5. é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡"></a>5. é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡</h1><p><a href="https://imgtu.com/i/2W1iVg"><img src="https://z3.ax1x.com/2021/06/11/2W1iVg.png" alt="2W1iVg.png"></a></p>
<ul>
<li><p>æµ‹è¯• 1ï¼šé€šè¿‡åå°„åˆ›å»ºæŸç±»çš„å¯¹è±¡ï¼Œè¦æ±‚è¯¥ç±»ä¸­å¿…é¡»æœ‰ public çš„æ— å‚æ„é€  </p>
</li>
<li><p>æµ‹è¯• 2ï¼šé€šè¿‡è°ƒç”¨æŸä¸ªç‰¹å®šæ„é€ å™¨çš„æ–¹å¼ï¼Œå®ç°åˆ›å»ºæŸç±»çš„å¯¹è±¡</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ReflecCreateInstance</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºé€šè¿‡åå°„æœºåˆ¶åˆ›å»ºå®ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/11 10:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReflecCreateInstance</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. å…ˆè·å–åˆ° User ç±»çš„ Class å¯¹è±¡</span></span><br><span class="line">        Class&lt;?&gt; userClass = Class.forName(<span class="string">&quot;com.zhuang.reflection.User&quot;</span>);</span><br><span class="line">        <span class="comment">//2. é€šè¿‡ public çš„æ— å‚æ„é€ å™¨åˆ›å»ºå®ä¾‹</span></span><br><span class="line">        Object o = userClass.newInstance();</span><br><span class="line">        System.out.println(o);</span><br><span class="line">        <span class="comment">//3. é€šè¿‡ public çš„æœ‰å‚æ„é€ å™¨åˆ›å»ºå®ä¾‹</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        constructor å¯¹è±¡å°±æ˜¯</span></span><br><span class="line"><span class="comment">        public User(String name) &#123;//public çš„æœ‰å‚æ„é€ å™¨</span></span><br><span class="line"><span class="comment">        this.name = name;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">//3.1 å…ˆå¾—åˆ°å¯¹åº”æ„é€ å™¨</span></span><br><span class="line">        Constructor&lt;?&gt; constructor = userClass.getConstructor(String.class);</span><br><span class="line">        <span class="comment">//3.2 åˆ›å»ºå®ä¾‹ï¼Œå¹¶ä¼ å…¥å®å‚</span></span><br><span class="line">        Object zk = constructor.newInstance(<span class="string">&quot;zk&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;zk=&quot;</span> + zk);</span><br><span class="line">        <span class="comment">//4. é€šè¿‡é public çš„æœ‰å‚æ„é€ å™¨åˆ›å»ºå®ä¾‹</span></span><br><span class="line">        <span class="comment">//4.1 å¾—åˆ° private çš„æ„é€ å™¨å¯¹è±¡</span></span><br><span class="line">        Constructor&lt;?&gt; constructor1 = userClass.getDeclaredConstructor(<span class="keyword">int</span>.class, String.class);</span><br><span class="line">        <span class="comment">//4.2 åˆ›å»ºå®ä¾‹</span></span><br><span class="line">        <span class="comment">//æš´ç ´ã€æš´åŠ›ç ´è§£ã€‘ , ä½¿ç”¨åå°„å¯ä»¥è®¿é—® private æ„é€ å™¨/æ–¹æ³•/å±æ€§</span></span><br><span class="line">        constructor1.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        Object user2 = constructor1.newInstance(<span class="number">100</span>, <span class="string">&quot;å¼ ä¸‰ä¸°&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;user2=&quot;</span> + user2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123; <span class="comment">//User ç±»</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">&quot;åº·å°åº„&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;<span class="comment">//æ— å‚ public</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name)</span> </span>&#123;<span class="comment">//public çš„æœ‰å‚æ„é€ å™¨</span></span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> age, String name)</span> </span>&#123;<span class="comment">//private æœ‰å‚æ„é€ å™¨</span></span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User [age=&quot;</span> + age + <span class="string">&quot;, name=&quot;</span> + name + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/2WGLOP"><img src="https://z3.ax1x.com/2021/06/11/2WGLOP.md.png" alt="2WGLOP.md.png"></a></p>
<h1 id="6-è®¿é—®æ–¹æ³•"><a href="#6-è®¿é—®æ–¹æ³•" class="headerlink" title="6. è®¿é—®æ–¹æ³•"></a>6. è®¿é—®æ–¹æ³•</h1><p><a href="https://imgtu.com/i/2WUEv9"><img src="https://z3.ax1x.com/2021/06/11/2WUEv9.png" alt="2WUEv9.png"></a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ReflecAccessMethod</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºé€šè¿‡åå°„è°ƒç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/11 10:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReflecAccessMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//å¾—åˆ°Bossç±»å¯¹åº”çš„Classå¯¹è±¡</span></span><br><span class="line">        Class&lt;?&gt; bossClass = Class.forName(<span class="string">&quot;com.zhuang.reflection.Boss&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        Object o = bossClass.newInstance();</span><br><span class="line">        <span class="comment">//è°ƒç”¨public æ–¹æ³• å¾—åˆ°æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        Method show = bossClass.getMethod(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">        <span class="comment">//è°ƒç”¨</span></span><br><span class="line">        show.invoke(o);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è°ƒç”¨privateæ–¹æ³•</span></span><br><span class="line">        Method say = bossClass.getDeclaredMethod(<span class="string">&quot;say&quot;</span>,<span class="keyword">int</span>.class);</span><br><span class="line">        <span class="comment">//sayæ–¹æ³•æ˜¯privateï¼Œéœ€è¦è®¾ç½®æƒé™</span></span><br><span class="line">        say.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        say.invoke(o,<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boss</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Boss</span><span class="params">()</span> </span>&#123;<span class="comment">//æ— å‚ public</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Boss</span><span class="params">(String name)</span> </span>&#123;<span class="comment">//public çš„æœ‰å‚æ„é€ å™¨</span></span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Boss</span><span class="params">(<span class="keyword">int</span> age, String name)</span> </span>&#123;<span class="comment">//private æœ‰å‚æ„é€ å™¨</span></span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯è€æ¿å“ˆå“ˆå“ˆ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯è€æ¿å˜¿å˜¿å˜¿-&gt;&quot;</span>+i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="7-ä½œä¸šç»ƒä¹ "><a href="#7-ä½œä¸šç»ƒä¹ " class="headerlink" title="7. ä½œä¸šç»ƒä¹ "></a>7. ä½œä¸šç»ƒä¹ </h2><p><strong>HomeWork01</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HomeWork01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä½œä¸š1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/11 10:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeWork01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å®šä¹‰Studentç±»ï¼Œæœ‰ç§æœ‰nameå±æ€§ï¼Œå¹¶ä¸”å±æ€§å€¼ä¸ºhellokitty</span></span><br><span class="line"><span class="comment">         * æä¾›getNameçš„å…¬æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="comment">         * åˆ›å»ºStudentçš„ç±»ï¼Œåˆ©ç”¨Classç±»å¾—åˆ°ç§æœ‰çš„nameå±æ€§ï¼Œä¿®æ”¹ç§æœ‰çš„nameå±æ€§å€¼ï¼Œå¹¶è°ƒç”¨getName()çš„æ–¹æ³•æ‰“å°nameå±æ€§å€¼</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//1. å¾—åˆ° Studentç±»å¯¹åº”çš„Classå¯¹è±¡</span></span><br><span class="line">        Class&lt;Student&gt; studentClass = Student.class;</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡å®ä¾‹</span></span><br><span class="line">        Student student = studentClass.newInstance();</span><br><span class="line">        <span class="comment">//å¾—åˆ°nameå±æ€§å¯¹è±¡</span></span><br><span class="line">        Field name = studentClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®æƒé™</span></span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//èµ‹å€¼</span></span><br><span class="line">        name.set(student,<span class="string">&quot;åº·å°åº„&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å¾—æ–¹æ³•</span></span><br><span class="line">        Method getName = studentClass.getMethod(<span class="string">&quot;getName&quot;</span>);</span><br><span class="line">        <span class="comment">//è°ƒç”¨</span></span><br><span class="line">        Object invoke = getName.invoke(student);</span><br><span class="line">        System.out.println(invoke);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">&quot;hellokitty&quot;</span>;</span><br><span class="line">    <span class="comment">//é»˜è®¤æ— å‚æ„é€ å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HomeWork02</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.reflection.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HomeWork02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ä½œä¸š2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/11 11:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ©ç”¨Classç±»çš„forNameæ–¹æ³•å¾—åˆ°Fileç±»çš„class å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * åœ¨æ§åˆ¶å°æ‰“å°Fileç±»çš„æ‰€æœ‰æ„é€ å™¨</span></span><br><span class="line"><span class="comment"> * é€šè¿‡newInstanceçš„æ–¹æ³•åˆ›å»ºFileå¯¹è±¡ï¼Œå¹¶åˆ›å»ºF:\my.txtæ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeWork02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//è·å–ç±»classå¯¹è±¡</span></span><br><span class="line">        Class&lt;?&gt; cls = Class.forName(<span class="string">&quot;java.io.File&quot;</span>);</span><br><span class="line">        <span class="comment">//éå†clsç±»å¯¹è±¡æ„é€ å™¨</span></span><br><span class="line">        <span class="keyword">for</span> (Constructor&lt;?&gt; declaredConstructor : cls.getDeclaredConstructors()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ„é€ æ–¹æ³•&quot;</span>+declaredConstructor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æŒ‡å®šçš„å¾—åˆ° public java.io.File(java.lang.String)</span></span><br><span class="line">        Constructor&lt;?&gt; declaredConstructor = cls.getDeclaredConstructor(String.class);</span><br><span class="line">        String filePath=<span class="string">&quot;f:\\my.text&quot;</span>;</span><br><span class="line">        Object file = declaredConstructor.newInstance(filePath);</span><br><span class="line">        <span class="comment">//å¾—åˆ°createNewFile çš„æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        Method createNewFile = cls.getMethod(<span class="string">&quot;createNewFile&quot;</span>);</span><br><span class="line">        createNewFile.invoke(file);</span><br><span class="line"></span><br><span class="line">        System.out.println(file.getClass());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶åˆ›å»ºæˆåŠŸ&quot;</span>+filePath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/2WcCpq"><img src="https://z3.ax1x.com/2021/06/11/2WcCpq.png" alt="2WcCpq.png"></a></p>
<p><strong>å†™åœ¨æœ€å</strong></p>
<ul>
<li>è®¸å¤šåŸºç¡€ä»éœ€è¦è¡¥å……</li>
<li>æé«˜ç‹¬ç«‹å†™ä»£ç å’Œæ€è€ƒçš„èƒ½åŠ›</li>
<li>å¤šç»ƒä¹ ï¼Œå¤šæ€è€ƒ:muscle:</li>
</ul>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaç½‘ç»œç¼–ç¨‹å­¦ä¹ ç¬”è®°</title>
    <url>/2021/01/11/Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Javaç½‘ç»œç¼–ç¨‹å­¦ä¹ ç¬”è®°"><a href="#Javaç½‘ç»œç¼–ç¨‹å­¦ä¹ ç¬”è®°" class="headerlink" title="Javaç½‘ç»œç¼–ç¨‹å­¦ä¹ ç¬”è®°"></a>Javaç½‘ç»œç¼–ç¨‹å­¦ä¹ ç¬”è®°</h1><p>å†™åœ¨å‰é¢ï¼šæ„Ÿè°¢éŸ©è€å¸ˆçš„è®²è§£è§†é¢‘ï¼</p>
<p><strong>å­¦ä¹ åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1j54y1b7qv">ã€éŸ©é¡ºå¹³è®²Javaã€‘Javaç½‘ç»œå¤šçº¿ç¨‹ä¸“é¢˜ - TCP UDP Socketç¼–ç¨‹</a></strong></p>
<h1 id="1-ç½‘ç»œçš„ç›¸å…³æ¦‚å¿µ"><a href="#1-ç½‘ç»œçš„ç›¸å…³æ¦‚å¿µ" class="headerlink" title="1. ç½‘ç»œçš„ç›¸å…³æ¦‚å¿µ"></a>1. ç½‘ç»œçš„ç›¸å…³æ¦‚å¿µ</h1><h2 id="1-1-ç½‘ç»œé€šä¿¡"><a href="#1-1-ç½‘ç»œé€šä¿¡" class="headerlink" title="1.1 ç½‘ç»œé€šä¿¡"></a>1.1 ç½‘ç»œé€šä¿¡</h2><ul>
<li>æ¦‚å¿µï¼šä¸¤å°è®¾å¤‡ä¹‹é—´é€šè¿‡ç½‘ç»œå®ç°æ•°æ®ä¼ è¾“</li>
<li>ç½‘ç»œé€šä¿¡ï¼šå°†æ•°æ®é€šè¿‡ç½‘ç»œä»ä¸€å°è®¾å¤‡ä¼ è¾“åˆ°å¦ä»¥å°è®¾å¤‡</li>
<li>java.netåŒ…ä¸‹æä¾›äº†ä¸€ç³»åˆ—çš„ç±»æˆ–æ¥å£ï¼Œä¾›ç¨‹åºå‘˜ä½¿ç”¨ï¼Œå®Œæˆç½‘ç»œé€šä¿¡</li>
</ul>
<p><a href="https://imgtu.com/i/21wsEj"><img src="https://z3.ax1x.com/2021/06/03/21wsEj.png" alt="21wsEj.png"></a></p>
<h2 id="1-2-ç½‘ç»œ"><a href="#1-2-ç½‘ç»œ" class="headerlink" title="1.2 ç½‘ç»œ"></a>1.2 ç½‘ç»œ</h2><ul>
<li>æ¦‚å¿µï¼šä¸¤å°æˆ–å¤šå°è®¾å¤‡é€šè¿‡ä¸€å®šç‰©ç†è®¾å¤‡è¿æ¥æ¥æ„æˆäº†ç½‘ç»œ</li>
<li>æ ¹æ®ç½‘ç»œçš„è¦†ç›–èŒƒå›´ä¸åŒï¼Œå¯¹ç½‘ç»œè¿›è¡Œåˆ†ç±»</li>
<li>å±€åŸŸç½‘ï¼šè¦†ç›–èŒƒå›´æœ€å°ï¼Œä»…ä»…è¦†ç›–ä¸€ä¸ªæ•™å®¤æˆ–è€…ä¸€ä¸ªæœºæˆ¿</li>
<li>åŸåŸŸç½‘ï¼šè¦†ç›–èŒƒå›´æ¯”è¾ƒå¤§ï¼Œå¯ä»¥è¦†ç›–ä¸€ä¸ªåŸå¸‚</li>
<li>å¹¿åŸŸç½‘ï¼šè¦†ç›–èŒƒå›´æœ€å¤§ï¼Œå¯ä»¥è¦†ç›–å…¨å›½ï¼Œç”šè‡³å…¨çƒï¼Œä¸‡ç»´ç½‘æ˜¯å¹¿åŸŸç½‘çš„ä»£è¡¨</li>
</ul>
<p><a href="https://imgtu.com/i/21wyUs"><img src="https://z3.ax1x.com/2021/06/03/21wyUs.png" alt="21wyUs.png"></a></p>
<h2 id="1-3-IPåœ°å€"><a href="#1-3-IPåœ°å€" class="headerlink" title="1.3 IPåœ°å€"></a>1.3 IPåœ°å€</h2><ul>
<li>æ¦‚å¿µï¼šç”¨äºå”¯ä¸€æ ‡è¯†ç½‘ç»œä¸­çš„æ¯å°ä¸»æœº/è®¡ç®—æœº</li>
<li>æŸ¥çœ‹IPåœ°å€çš„å‘½ä»¤ï¼šipconfig</li>
<li>ipåœ°å€çš„è¡¨ç¤ºå½¢å¼ï¼šç‚¹åˆ†åè¿›åˆ¶ xx.xx.xx.xx</li>
<li>æ¯ä¸€ä¸ªåè¿›åˆ¶çš„èŒƒå›´ 0-255</li>
<li>ipåœ°å€çš„ç»„æˆ=ç½‘ç»œåœ°å€+ä¸»æœºåœ°å€  ä¾‹å¦‚192.168.152.xxx</li>
<li>ipv6æ˜¯äº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„è®¾è®¡çš„ç”¨äºæ›¿ä»£IPv4çš„ä¸‹ä¸€ä»£IPåè®®</li>
<li>ç”±äºIPv4æœ€å¤§çš„é—®é¢˜åœ¨äºç½‘ç»œåœ°å€èµ„æºæœ‰é™ï¼Œä¸¥é‡åˆ¶çº¦äº†äº’è”ç½‘çš„åº”ç”¨å’Œå‘å±•ï¼ŒIPv6çš„ä½¿ç”¨å¯ä»¥è§£å†³ç½‘ç»œåœ°å€èµ„æºæ•°é‡çš„é—®é¢˜ï¼Œä¹Ÿè§£å†³äº†å¤šç§æ¥å…¥è®¾å¤‡äº’è”ç½‘çš„éšœç¢</li>
</ul>
<p>æ›´å¤šäº†è§£IPv6å‚è€ƒ <a href="https://baike.baidu.com/item/IPv6/172297">IPv6_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p>
<h2 id="1-4-ipv4-åœ°å€åˆ†ç±»"><a href="#1-4-ipv4-åœ°å€åˆ†ç±»" class="headerlink" title="1.4 ipv4 åœ°å€åˆ†ç±»"></a>1.4 ipv4 åœ°å€åˆ†ç±»</h2><p><a href="https://imgtu.com/i/21w65n"><img src="https://z3.ax1x.com/2021/06/03/21w65n.png" alt="21w65n.png"></a></p>
<p><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/image-20210601211137383.png" alt="image-20210601211137383"></p>
<h2 id="1-5-åŸŸå"><a href="#1-5-åŸŸå" class="headerlink" title="1.5 åŸŸå"></a>1.5 åŸŸå</h2><ul>
<li>å¥½å¤„ï¼šæ–¹ä¾¿è®°å¿†ï¼Œè§£å†³è®°ipçš„å›°éš¾</li>
<li>æ¦‚å¿µï¼šå°†ipåœ°å€æ˜ å°„æˆåŸŸåï¼ŒHTTPåè®®</li>
</ul>
<p><strong>ç«¯å£å·</strong></p>
<ul>
<li>æ¦‚å¿µï¼šç”¨äºæ ‡è¯†è®¡ç®—æœºä¸ŠæŸä¸ªç‰¹å®šçš„ç½‘ç»œç¨‹åº</li>
<li>è¡¨ç¤ºå½¢å¼ï¼šä»¥æ•´æ•°å½¢å¼ï¼Œç«¯å£èŒƒå›´0-65535 [2ä¸ªå­—èŠ‚è¡¨ç¤ºç«¯å£ 0~2çš„16æ¬¡-1]</li>
<li>å¸¸è§ç½‘ç»œç¨‹åºç«¯å£å·<ul>
<li>tomcatï¼š8080</li>
<li>mysqlï¼š3306</li>
<li>sqlserveï¼š1433</li>
</ul>
</li>
</ul>
<h2 id="1-6-ç½‘ç»œé€šä¿¡åè®®"><a href="#1-6-ç½‘ç»œé€šä¿¡åè®®" class="headerlink" title="1.6 ç½‘ç»œé€šä¿¡åè®®"></a>1.6 ç½‘ç»œé€šä¿¡åè®®</h2><p><a href="https://imgtu.com/i/21wDbQ"><img src="https://z3.ax1x.com/2021/06/03/21wDbQ.png" alt="21wDbQ.png"></a></p>
<ul>
<li>TCP/IPï¼ˆTransmission Control Protocol/Internet Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®/ç½‘é™…åè®®ï¼‰æ˜¯æŒ‡èƒ½å¤Ÿåœ¨å¤šä¸ªä¸åŒç½‘ç»œé—´å®ç°ä¿¡æ¯ä¼ è¾“çš„åè®®ç°‡</li>
</ul>
<table>
<thead>
<tr>
<th align="center">OSIæ¨¡å‹</th>
<th align="center">TCP/IPæ¨¡å‹</th>
<th align="center">TCP/IPæ¨¡å‹å„å±‚å¯¹åº”åè®®</th>
</tr>
</thead>
<tbody><tr>
<td align="center">åº”ç”¨å±‚</td>
<td align="center">åº”ç”¨å±‚</td>
<td align="center">HTTP FTP DNSâ€¦</td>
</tr>
<tr>
<td align="center">è¡¨ç¤ºå±‚</td>
<td align="center">åº”ç”¨å±‚</td>
<td align="center">HTTP FTP DNSâ€¦</td>
</tr>
<tr>
<td align="center">ä¼šè¯å±‚</td>
<td align="center">åº”ç”¨å±‚</td>
<td align="center">HTTP FTP DNSâ€¦</td>
</tr>
<tr>
<td align="center">ä¼ è¾“å±‚</td>
<td align="center">ä¼ è¾“å±‚(TCP)</td>
<td align="center">TCP UDPâ€¦</td>
</tr>
<tr>
<td align="center">ç½‘ç»œå±‚</td>
<td align="center">ç½‘ç»œå±‚(IP)</td>
<td align="center">IP ICMP ARP</td>
</tr>
<tr>
<td align="center">æ•°æ®é“¾è·¯å±‚</td>
<td align="center">ç‰©ç†+æ•°æ®é“¾è·¯å±‚</td>
<td align="center">Link</td>
</tr>
<tr>
<td align="center">ç‰©ç†å±‚</td>
<td align="center">ç‰©ç†+æ•°æ®é“¾è·¯å±‚</td>
<td align="center">Link</td>
</tr>
</tbody></table>
<h2 id="1-7-TCPå’ŒUDP"><a href="#1-7-TCPå’ŒUDP" class="headerlink" title="1.7 TCPå’ŒUDP"></a>1.7 TCPå’ŒUDP</h2><p><strong>TCPåè®®:ä¼ è¾“æ§åˆ¶åè®®</strong></p>
<ul>
<li>1.ä½¿ç”¨TCPåè®®å‰ï¼Œé¡»å…ˆå»ºç«‹TCPè¿æ¥ï¼Œå½¢æˆä¼ è¾“æ•°æ®é€šé“</li>
<li>2.ä¼ è¾“å‰ï¼Œé‡‡ç”¨â€ä¸‰æ¬¡æ¡æ‰‹â€æ–¹å¼ï¼Œæ˜¯å¯é çš„</li>
<li>3.TCPåè®®è¿›è¡Œé€šä¿¡çš„ä¸¤ä¸ªåº”ç”¨è¿›ç¨‹:å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯</li>
<li>4.åœ¨è¿æ¥ä¸­å¯è¿›è¡Œå¤§æ•°æ®é‡çš„ä¼ è¾“</li>
<li>5.ä¼ è¾“å®Œæ¯•ï¼Œéœ€é‡Šæ”¾å·²å»ºç«‹çš„è¿æ¥ï¼Œæ•ˆç‡ä½</li>
</ul>
<p><strong>UDPåè®®:ç”¨æˆ·æ•°æ®åè®®</strong></p>
<ul>
<li>1.å°†æ•°æ®ã€æºã€ç›®çš„å°è£…æˆæ•°æ®åŒ…ï¼Œä¸éœ€è¦å»ºç«‹è¿æ¥</li>
<li>2.æ¯ä¸ªæ•°æ®æŠ¥çš„å¤§å°é™åˆ¶åœ¨64Kå†…,ä¸é€‚åˆä¼ è¾“å¤§é‡æ•°æ®</li>
<li>3.å› æ— éœ€è¿æ¥ï¼Œæ•…æ˜¯ä¸å¯é çš„</li>
<li>4.å‘é€æ•°æ®ç»“æŸæ—¶æ— éœ€é‡Šæ”¾èµ„æº(å› ä¸ºä¸æ˜¯é¢å‘è¿æ¥çš„)ï¼Œé€Ÿåº¦å¿«</li>
<li>5.ä¸¾ä¾‹:å•æ‰€é€šçŸ¥:å‘çŸ­ä¿¡</li>
</ul>
<h1 id="2-InetAddressç±»"><a href="#2-InetAddressç±»" class="headerlink" title="2. InetAddressç±»"></a>2. InetAddressç±»</h1><p>å¸¸ç”¨æ–¹æ³•</p>
<p><a href="https://imgtu.com/i/21wBDg"><img src="https://z3.ax1x.com/2021/06/03/21wBDg.png" alt="21wBDg.png"></a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> API_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç½‘ç»œç¼–ç¨‹å¸¸ç”¨api</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 12:02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">API_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–æœ¬æœº InetAddress å¯¹è±¡ getLocalHost</span></span><br><span class="line">        InetAddress localHost = InetAddress.getLocalHost();</span><br><span class="line">        System.out.println(localHost);</span><br><span class="line">        <span class="comment">//æ ¹æ®æŒ‡å®šä¸»æœºå/åŸŸåè·å– ip åœ°å€å¯¹è±¡ getByName</span></span><br><span class="line">        InetAddress host2 = InetAddress.getByName(<span class="string">&quot;DESKTOP-5H1AECH&quot;</span>);</span><br><span class="line">        System.out.println(host2);</span><br><span class="line">        InetAddress host3 = InetAddress.getByName(<span class="string">&quot;itkxz.cn&quot;</span>);</span><br><span class="line">        System.out.println(host3);</span><br><span class="line">        <span class="comment">//è·å– InetAddress å¯¹è±¡çš„ä¸»æœºå getHostName</span></span><br><span class="line">        String host3Name = host3.getHostName();</span><br><span class="line">        System.out.println(host3Name);</span><br><span class="line">        <span class="comment">//è·å– InetAddress å¯¹è±¡çš„åœ°å€ getHostAddress</span></span><br><span class="line">        String host3Address = host3.getHostAddress();</span><br><span class="line">        System.out.println(host3Address);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="3-Socket"><a href="#3-Socket" class="headerlink" title="3. Socket"></a>3. Socket</h1><p>åŸºæœ¬ä»‹ç»</p>
<ul>
<li>å¥—æ¥å­—(Socket)å¼€å‘ç½‘ç»œåº”ç”¨ç¨‹åºè¢«å¹¿æ³›ä½¿ç”¨</li>
<li>é€šä¿¡çš„ä¸¤ç«¯éƒ½è¦æœ‰Socketï¼Œæ˜¯ä¸¤å°æœºå™¨é€šä¿¡çš„ç«¯ç‚¹</li>
<li>ç½‘ç»œé€šä¿¡å…¶å®å°±æ˜¯Socketçš„é€šä¿¡</li>
<li>Socketå…è®¸ç¨‹åºæŠŠç½‘ç»œè¿æ¥å½“åˆä¸€ä¸ªæµï¼Œæ•°æ®åœ¨ä¸¤ä¸ªSocketé—´é€šè¿‡IOä¼ è¾“</li>
<li>ä¸€èˆ¬ä¸»åŠ¨å‘èµ·é€šä¿¡çš„åº”ç”¨ç¨‹åºå±äº<code>å®¢æˆ·ç«¯</code>ï¼Œç­‰å¾…é€šä¿¡è¯·æ±‚çš„ä¸º<code>æœåŠ¡ç«¯</code></li>
</ul>
<p><strong>ç¤ºæ„å›¾</strong></p>
<p><a href="https://imgtu.com/i/21wgCq"><img src="https://z3.ax1x.com/2021/06/03/21wgCq.png" alt="21wgCq.png"></a></p>
<h1 id="4-TCP-ç½‘ç»œé€šä¿¡ç¼–ç¨‹"><a href="#4-TCP-ç½‘ç»œé€šä¿¡ç¼–ç¨‹" class="headerlink" title="4. TCP ç½‘ç»œé€šä¿¡ç¼–ç¨‹"></a>4. TCP ç½‘ç»œé€šä¿¡ç¼–ç¨‹</h1><p>åŸºæœ¬ä»‹ç»</p>
<ul>
<li>åŸºäºå®¢æˆ·ç«¯â€”æœåŠ¡ç«¯çš„ç½‘ç»œé€šä¿¡</li>
<li>åº•å±‚ä½¿ç”¨çš„æ˜¯TCP/IPåè®®</li>
<li>åœºæ™¯ä¸¾ä¾‹ï¼šå®¢æˆ·ç«¯å‘é€æ•°æ®ï¼ŒæœåŠ¡ç«¯æ¥å—å¹¶æ˜¾ç¤ºåœ¨æ§åˆ¶å°</li>
<li>åŸºäºSocketçš„TCPç¼–ç¨‹</li>
</ul>
<h2 id="4-1-ç»ƒä¹ "><a href="#4-1-ç»ƒä¹ " class="headerlink" title="4.1 ç»ƒä¹ "></a>4.1 ç»ƒä¹ </h2><h3 id="4-1-1-ä½¿ç”¨å­—èŠ‚æµ-ç»ƒä¹ 1"><a href="#4-1-1-ä½¿ç”¨å­—èŠ‚æµ-ç»ƒä¹ 1" class="headerlink" title="4.1.1 ä½¿ç”¨å­—èŠ‚æµ(ç»ƒä¹ 1)"></a>4.1.1 ä½¿ç”¨å­—èŠ‚æµ(ç»ƒä¹ 1)</h3><p><a href="https://imgtu.com/i/21wR2V"><img src="https://z3.ax1x.com/2021/06/03/21wR2V.png" alt="21wR2V.png"></a></p>
<p><strong>SocketTCP01Server</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SocketTCP01Server</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 12:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketTCP01Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥9999ç«¯å£ä¼šä¸€ç›´é˜»å¡ï¼Œç­‰å¾…è¿æ¥</span></span><br><span class="line"><span class="comment">        å¦‚æœæœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œä¼šè¿”å›Socketå¯¹è±¡ï¼Œç¨‹åºç»§ç»­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯åœ¨9999ç«¯å£ç›‘å¬ï¼&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Socket socket = serverSocket.accept();</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯ socket=&quot;</span>+socket.getClass());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡socket.getInputStream()  è¯»å–å®¢æˆ·ç«¯å†™å…¥æ•°æ®é€šä¿¡çš„æ•°æ®ï¼Œæ˜¾ç¤º</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// IOè¯»å–</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> readLength = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((readLength=inputStream.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">//è¯»å–åˆ°çš„å®é™…é•¿åº¦ï¼Œæ˜¾ç¤ºå†…å®¹</span></span><br><span class="line">            System.out.println(<span class="keyword">new</span> String(buf,<span class="number">0</span>, readLength));</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        å…³é—­æµå’Œsocket</span></span><br><span class="line">        inputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SocketTCP01Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SocketTCP01Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 12:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketTCP01Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//æ€è·¯</span></span><br><span class="line">    <span class="comment">//1. è¿æ¥æœåŠ¡ç«¯ (ip , ç«¯å£ï¼‰</span></span><br><span class="line">    <span class="comment">//è§£è¯»: è¿æ¥æœ¬æœºçš„ 9999 ç«¯å£, å¦‚æœè¿æ¥æˆåŠŸï¼Œè¿”å› Socket å¯¹è±¡</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯ socket è¿”å›=&quot;</span> + socket.getClass());</span><br><span class="line">    <span class="comment">//2. è¿æ¥ä¸Šåï¼Œç”Ÿæˆ Socket, é€šè¿‡ socket.getOutputStream()</span></span><br><span class="line">    <span class="comment">// å¾—åˆ° å’Œ socket å¯¹è±¡å…³è”çš„è¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">    <span class="comment">//3. é€šè¿‡è¾“å‡ºæµï¼Œå†™å…¥æ•°æ®åˆ° æ•°æ®é€šé“</span></span><br><span class="line">        outputStream.write(<span class="string">&quot;hello, server&quot;</span>.getBytes());</span><br><span class="line">    <span class="comment">//4. å…³é—­æµå¯¹è±¡å’Œ socket, å¿…é¡»å…³é—­</span></span><br><span class="line">        outputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯é€€å‡º.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-1-2-ä½¿ç”¨å­—èŠ‚æµ-ç»ƒä¹ 2"><a href="#4-1-2-ä½¿ç”¨å­—èŠ‚æµ-ç»ƒä¹ 2" class="headerlink" title="4.1.2 ä½¿ç”¨å­—èŠ‚æµ(ç»ƒä¹ 2)"></a>4.1.2 ä½¿ç”¨å­—èŠ‚æµ(ç»ƒä¹ 2)</h3><p><a href="https://imgtu.com/i/21wWvT"><img src="https://z3.ax1x.com/2021/06/03/21wWvT.png" alt="21wWvT.png"></a></p>
<p><strong>SocketTCP02Server</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SocketTCP02Server</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 12:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketTCP02Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥9999ç«¯å£ä¼šä¸€ç›´é˜»å¡ï¼Œç­‰å¾…è¿æ¥</span></span><br><span class="line"><span class="comment">        å¦‚æœæœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œä¼šè¿”å›Socketå¯¹è±¡ï¼Œç¨‹åºç»§ç»­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯åœ¨9999ç«¯å£ç›‘å¬ï¼&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Socket socket = serverSocket.accept();</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯ socket=&quot;</span>+socket.getClass());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡socket.getInputStream()  è¯»å–å®¢æˆ·ç«¯å†™å…¥æ•°æ®é€šä¿¡çš„æ•°æ®ï¼Œæ˜¾ç¤º</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// IOè¯»å–</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> readLength = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((readLength=inputStream.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">//è¯»å–åˆ°çš„å®é™…é•¿åº¦ï¼Œæ˜¾ç¤ºå†…å®¹</span></span><br><span class="line">            System.out.println(<span class="keyword">new</span> String(buf,<span class="number">0</span>, readLength));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//5. è·å– socket ç›¸å…³è”çš„è¾“å‡ºæµ</span></span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">        outputStream.write(<span class="string">&quot;hello, client&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">// è®¾ç½®ç»“æŸæ ‡è®°</span></span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//        å…³é—­æµå’Œsocket</span></span><br><span class="line">        inputStream.close();</span><br><span class="line">        outputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SocketTCP02Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SocketTCP02Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 12:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketTCP02Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//æ€è·¯</span></span><br><span class="line">    <span class="comment">//1. è¿æ¥æœåŠ¡ç«¯ (ip , ç«¯å£ï¼‰</span></span><br><span class="line">    <span class="comment">//è§£è¯»: è¿æ¥æœ¬æœºçš„ 9999 ç«¯å£, å¦‚æœè¿æ¥æˆåŠŸï¼Œè¿”å› Socket å¯¹è±¡</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯ socket è¿”å›=&quot;</span> + socket.getClass());</span><br><span class="line">    <span class="comment">//2. è¿æ¥ä¸Šåï¼Œç”Ÿæˆ Socket, é€šè¿‡ socket.getOutputStream()</span></span><br><span class="line">    <span class="comment">// å¾—åˆ° å’Œ socket å¯¹è±¡å…³è”çš„è¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">    <span class="comment">//3. é€šè¿‡è¾“å‡ºæµï¼Œå†™å…¥æ•°æ®åˆ° æ•°æ®é€šé“</span></span><br><span class="line">        outputStream.write(<span class="string">&quot;hello, server&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">// è®¾ç½®ç»“æŸæ ‡è®°</span></span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">    <span class="comment">//4. è·å–å’Œ socket å…³è”çš„è¾“å…¥æµ. è¯»å–æ•°æ®(å­—èŠ‚)ï¼Œå¹¶æ˜¾ç¤º</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> readLen = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((readLen = inputStream.read(buf)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> String(buf, <span class="number">0</span>, readLen));</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//5. å…³é—­æµå¯¹è±¡å’Œ socket, å¿…é¡»å…³é—­</span></span><br><span class="line">        outputStream.close();</span><br><span class="line">        inputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯é€€å‡º.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-1-3-ä½¿ç”¨å­—ç¬¦æµ-ç»ƒä¹ 3"><a href="#4-1-3-ä½¿ç”¨å­—ç¬¦æµ-ç»ƒä¹ 3" class="headerlink" title="4.1.3 ä½¿ç”¨å­—ç¬¦æµ(ç»ƒä¹ 3)"></a>4.1.3 ä½¿ç”¨å­—ç¬¦æµ(ç»ƒä¹ 3)</h3><p><a href="https://imgtu.com/i/21whKU"><img src="https://z3.ax1x.com/2021/06/03/21whKU.png" alt="21whKU.png"></a></p>
<p><strong>SocketTCP03Server</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SocketTCP03Server</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 12:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketTCP03Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥9999ç«¯å£ä¼šä¸€ç›´é˜»å¡ï¼Œç­‰å¾…è¿æ¥</span></span><br><span class="line"><span class="comment">        å¦‚æœæœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œä¼šè¿”å›Socketå¯¹è±¡ï¼Œç¨‹åºç»§ç»­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯åœ¨9999ç«¯å£ç›‘å¬ï¼&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        Socket socket = serverSocket.accept();</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯ socket=&quot;</span>+socket.getClass());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. è¿æ¥ä¸Šåï¼Œç”Ÿæˆ Socket, é€šè¿‡ socket.getOutputStream()</span></span><br><span class="line">        <span class="comment">//3. é€šè¿‡ socket.getInputStream() è¯»å–å®¢æˆ·ç«¯å†™å…¥åˆ°æ•°æ®é€šé“çš„æ•°æ®, æ˜¾ç¤º</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line">        <span class="comment">//4. IO è¯»å–, ä½¿ç”¨å­—ç¬¦æµ, è€å¸ˆä½¿ç”¨ InputStreamReader å°† inputStream è½¬æˆå­—ç¬¦æµ</span></span><br><span class="line">        BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(inputStream));</span><br><span class="line">        String s = bufferedReader.readLine();</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. è·å– socket ç›¸å…³è”çš„è¾“å‡ºæµ</span></span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨å­—ç¬¦è¾“å‡ºæµçš„æ–¹å¼å›å¤ä¿¡æ¯</span></span><br><span class="line">        BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(outputStream));</span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello client å­—ç¬¦æµ&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();<span class="comment">// æ’å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œè¡¨ç¤ºå›å¤å†…å®¹çš„ç»“æŸ</span></span><br><span class="line">        bufferedWriter.flush();<span class="comment">//æ³¨æ„éœ€è¦æ‰‹åŠ¨çš„ flush</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        bufferedWriter.close();</span><br><span class="line">        bufferedReader.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();<span class="comment">//å…³é—­</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SocketTCP03Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SocketTCP03Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 12:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketTCP03Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯ socket è¿”å›=&quot;</span> + socket.getClass());</span><br><span class="line">        <span class="comment">//2. è¿æ¥ä¸Šåï¼Œç”Ÿæˆ Socket, é€šè¿‡ socket.getOutputStream()</span></span><br><span class="line">        <span class="comment">// å¾—åˆ° å’Œ socket å¯¹è±¡å…³è”çš„è¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">        <span class="comment">//3. é€šè¿‡è¾“å‡ºæµï¼Œå†™å…¥æ•°æ®åˆ° æ•°æ®é€šé“, ä½¿ç”¨å­—ç¬¦æµ</span></span><br><span class="line">        BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(outputStream));</span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello, server å­—ç¬¦æµ&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();<span class="comment">//æ’å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œè¡¨ç¤ºå†™å…¥çš„å†…å®¹ç»“æŸ, æ³¨æ„ï¼Œè¦æ±‚å¯¹æ–¹ä½¿ç”¨ readLine()!!!!</span></span><br><span class="line">        bufferedWriter.flush();<span class="comment">// å¦‚æœä½¿ç”¨çš„å­—ç¬¦æµï¼Œéœ€è¦æ‰‹åŠ¨åˆ·æ–°ï¼Œå¦åˆ™æ•°æ®ä¸ä¼šå†™å…¥æ•°æ®é€šé“</span></span><br><span class="line">        <span class="comment">//4. è·å–å’Œ socket å…³è”çš„è¾“å…¥æµ. è¯»å–æ•°æ®(å­—ç¬¦)ï¼Œå¹¶æ˜¾ç¤º</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line">        BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(inputStream));</span><br><span class="line">        String s = bufferedReader.readLine();</span><br><span class="line">        System.out.println(s);</span><br><span class="line">        <span class="comment">//5. å…³é—­æµå¯¹è±¡å’Œ socket, å¿…é¡»å…³é—­</span></span><br><span class="line">        bufferedReader.close();<span class="comment">//å…³é—­å¤–å±‚æµ</span></span><br><span class="line">        bufferedWriter.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯é€€å‡º.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-1-4-å‘é€å›¾ç‰‡-ç»ƒä¹ 4"><a href="#4-1-4-å‘é€å›¾ç‰‡-ç»ƒä¹ 4" class="headerlink" title="4.1.4 å‘é€å›¾ç‰‡(ç»ƒä¹ 4)"></a>4.1.4 å‘é€å›¾ç‰‡(ç»ƒä¹ 4)</h3><blockquote>
<ul>
<li>ç¼–å†™ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œå’Œä¸€ä¸ªå®¢æˆ·ç«¯</li>
<li>åœ¨8888ç«¯å£ç›‘å¬</li>
<li>è¿æ¥åˆ°æœåŠ¡ç«¯ å‘é€ä¸€å¼ å›¾ç‰‡</li>
<li>æœåŠ¡ç«¯æ¥æ”¶åˆ° å®¢æˆ·ç«¯å‘é€çš„å›¾ç‰‡ ä¿å­˜åˆ°æŒ‡å®šç›®å½•ä¸‹ï¼Œå‘é€â€œæ”¶åˆ°å›¾ç‰‡â€åé€€å‡º</li>
<li>å®¢æˆ·ç«¯æ¥å—åˆ°æœåŠ¡ç«¯å‘é€â€œæ”¶åˆ°å›¾ç‰‡â€ å†é€€å‡º</li>
</ul>
</blockquote>
<p><strong>ä½¿ç”¨åˆ°ä¸€ä¸ªå·¥å…·ç±» StreamUtils</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> StreamUtils</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/3 13:03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ­¤ç±»ç”¨äºæ¼”ç¤ºå…³äºæµçš„è¯»å†™æ–¹æ³•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StreamUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šå°†è¾“å…¥æµè½¬æ¢æˆbyte[]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> is</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] streamToByteArray(InputStream is) <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos = <span class="keyword">new</span> ByteArrayOutputStream();<span class="comment">//åˆ›å»ºè¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span>((len=is.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            bos.write(b, <span class="number">0</span>, len);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">byte</span>[] array = bos.toByteArray();</span><br><span class="line">        bos.close();</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šå°†InputStreamè½¬æ¢æˆString</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> is</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">streamToString</span><span class="params">(InputStream is)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(is));</span><br><span class="line">        StringBuilder builder= <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span>((line=reader.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            builder.append(line+<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> builder.toString();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>TCPFileUploadServer</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> TCPFileUploadServer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ–‡ä»¶ä¸Šä¼ æœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 9:25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TCPFileUploadServer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">// åœ¨æœ¬æœºç›‘å¬8888ç«¯å£</span></span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯åœ¨8888ç«¯å£ç›‘å¬......&quot;</span>);</span><br><span class="line">        <span class="comment">//ç­‰å¾…è¿æ¥</span></span><br><span class="line">        Socket socket = serverSocket.accept();</span><br><span class="line">        <span class="comment">//è¯»å–å®¢æˆ·ç«¯çš„æ•°æ® é€šè¿‡Socketå¾—åˆ°è¾“å…¥æµ</span></span><br><span class="line">        BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(socket.getInputStream());</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = StreamUtils.streamToByteArray(bis);</span><br><span class="line">        <span class="comment">//å°†å¾—åˆ°çš„æ•°ç»„å†™å…¥æŒ‡å®šè·¯å¾„</span></span><br><span class="line">        String desFilePath = <span class="string">&quot;f:\\2.jpg&quot;</span>;</span><br><span class="line">        BufferedOutputStream bos = <span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(desFilePath));</span><br><span class="line">        bos.write(bytes);</span><br><span class="line">        bos.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘å®¢æˆ·ç«¯å›å¤ æ”¶åˆ°å›¾ç‰‡</span></span><br><span class="line">        <span class="comment">//é€šè¿‡socket è·å–åˆ°è¾“å…¥æµ</span></span><br><span class="line">        BufferedWriter writer = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(socket.getOutputStream()));</span><br><span class="line">        writer.write(<span class="string">&quot;æ”¶åˆ°å›¾ç‰‡&quot;</span>);</span><br><span class="line">        <span class="comment">// æŠŠå†…å®¹åˆ·æ–°åˆ°æ•°æ®é€šé“</span></span><br><span class="line">        writer.flush();</span><br><span class="line">        <span class="comment">//è®¾ç½®å†™å…¥ç»“æŸæ ‡è®°</span></span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"></span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">        bos.close();</span><br><span class="line">        bis.close();</span><br><span class="line">        writer.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>TCPFileUploadClient</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> TCPFileUploadClient</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ–‡ä»¶ä¸Šä¼ å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 9:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TCPFileUploadClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯8888ï¼Œå¾—åˆ°Socketå¯¹è±¡</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(InetAddress.getLocalHost(), <span class="number">8888</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºè¯»å–ç£ç›˜çš„æ–‡ä»¶</span></span><br><span class="line">        String filePath=<span class="string">&quot;f:\\1.jpg&quot;</span>;</span><br><span class="line">        BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(filePath));</span><br><span class="line">        <span class="comment">//æ•°ç»„å°±æ˜¯FilePathæ‰€å¯¹åº”çš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="keyword">byte</span>[] bytes = StreamUtils.streamToByteArray(bis);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        é€šè¿‡socketè·å–åˆ°è¾“å…¥æµï¼Œå°†bytesæ•°æ®å‘é€ç»™æœåŠ¡ç«¯</span></span><br><span class="line">        BufferedOutputStream bos = <span class="keyword">new</span> BufferedOutputStream(socket.getOutputStream());</span><br><span class="line">        bos.write(bytes);</span><br><span class="line">        bis.close();</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æ¥å—ä»æœåŠ¡ç«¯å›å¤çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line">        <span class="comment">//è½¬æˆå­—ç¬¦ä¸²</span></span><br><span class="line">        String s = StreamUtils.streamToString(inputStream);</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        inputStream.close();</span><br><span class="line">        bos.close();</span><br><span class="line">        socket.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="5-netstat-æŒ‡ä»¤"><a href="#5-netstat-æŒ‡ä»¤" class="headerlink" title="5. netstat æŒ‡ä»¤"></a>5. netstat æŒ‡ä»¤</h1><p><a href="https://imgtu.com/i/2GKweP"><img src="https://z3.ax1x.com/2021/06/04/2GKweP.png" alt="2GKweP.png"></a></p>
<p><strong>ç¤ºæ„å›¾</strong></p>
<p><a href="https://imgtu.com/i/2GlBo6"><img src="https://z3.ax1x.com/2021/06/04/2GlBo6.png" alt="2GlBo6.png"></a></p>
<ul>
<li>å½“å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡ç«¯åï¼Œå®é™…ä¸Šå®¢æˆ·ç«¯ä¹Ÿæ˜¯é€šè¿‡ä¸€ä¸ªç«¯å£å’ŒæœåŠ¡ç«¯æ¥è¿›è¡Œé€šè®¯çš„ï¼Œè¿™ä¸ªç«¯å£æ˜¯TVP/IPæ¥åˆ†é…çš„ï¼Œæ˜¯éšæœºçš„</li>
</ul>
<h1 id="6-UDP-ç½‘ç»œé€šä¿¡ç¼–ç¨‹"><a href="#6-UDP-ç½‘ç»œé€šä¿¡ç¼–ç¨‹" class="headerlink" title="6. UDP ç½‘ç»œé€šä¿¡ç¼–ç¨‹"></a>6. UDP ç½‘ç»œé€šä¿¡ç¼–ç¨‹</h1><p><strong>åŸºæœ¬ä»‹ç»</strong></p>
<p><a href="https://imgtu.com/i/2G1CpF"><img src="https://z3.ax1x.com/2021/06/04/2G1CpF.png" alt="2G1CpF.png"></a></p>
<p><strong>åŸºæœ¬æµç¨‹</strong></p>
<p><a href="https://imgtu.com/i/2G1nfO"><img src="https://z3.ax1x.com/2021/06/04/2G1nfO.png" alt="2G1nfO.png"></a></p>
<p><strong>æ¡ˆä¾‹</strong></p>
<p><a href="https://imgtu.com/i/2G1lXd"><img src="https://z3.ax1x.com/2021/06/04/2G1lXd.png" alt="2G1lXd.png"></a></p>
<p><strong>UDPReceiverA</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> UDPReceiverA</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> UDP æ¥æ”¶ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 10:04</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UDPReceiverA</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. åˆ›å»ºä¸€ä¸ª DatagramSocket å¯¹è±¡ï¼Œå‡†å¤‡åœ¨9999æ¥æ”¶æ•°æ®</span></span><br><span class="line">        DatagramSocket socket = <span class="keyword">new</span> DatagramSocket(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">//2. æ„å»ºä¸€ä¸ª DatagramPacket å¯¹è±¡ï¼Œå‡†å¤‡æ¥æ”¶æ•°æ®</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        DatagramPacket packet = <span class="keyword">new</span> DatagramPacket(buf, buf.length);</span><br><span class="line">        <span class="comment">//3. è°ƒç”¨ æ¥æ”¶æ–¹æ³•, å°†é€šè¿‡ç½‘ç»œä¼ è¾“çš„ DatagramPacket å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//   å¡«å……åˆ° packetå¯¹è±¡</span></span><br><span class="line">        <span class="comment">//å½“æœ‰æ•°æ®åŒ…å‘é€åˆ° æœ¬æœºçš„9999ç«¯å£æ—¶ï¼Œå°±ä¼šæ¥æ”¶åˆ°æ•°æ®</span></span><br><span class="line">        <span class="comment">//   å¦‚æœæ²¡æœ‰æ•°æ®åŒ…å‘é€åˆ° æœ¬æœºçš„9999ç«¯å£, å°±ä¼šé˜»å¡ç­‰å¾….</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ¥æ”¶ç«¯A ç­‰å¾…æ¥æ”¶æ•°æ®..&quot;</span>);</span><br><span class="line">        socket.receive(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. å¯ä»¥æŠŠpacket è¿›è¡Œæ‹†åŒ…ï¼Œå–å‡ºæ•°æ®ï¼Œå¹¶æ˜¾ç¤º.</span></span><br><span class="line">        <span class="comment">//å®é™…æ¥æ”¶åˆ°çš„æ•°æ®å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        <span class="keyword">int</span> length = packet.getLength();</span><br><span class="line">        <span class="comment">//æ¥æ”¶åˆ°æ•°æ®</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = packet.getData();</span><br><span class="line">        String s = <span class="keyword">new</span> String(data, <span class="number">0</span>, length);</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//===å›å¤ä¿¡æ¯ç»™Bç«¯</span></span><br><span class="line">        <span class="comment">//å°†éœ€è¦å‘é€çš„æ•°æ®ï¼Œå°è£…åˆ° DatagramPacketå¯¹è±¡</span></span><br><span class="line">        data = <span class="string">&quot;å¥½çš„, æ˜å¤©è§&quot;</span>.getBytes();</span><br><span class="line">        <span class="comment">//è¯´æ˜: å°è£…çš„ DatagramPacketå¯¹è±¡ data å†…å®¹å­—èŠ‚æ•°ç»„ , data.length , ä¸»æœº(IP) , ç«¯å£</span></span><br><span class="line">        packet =</span><br><span class="line">                <span class="keyword">new</span> DatagramPacket(data, data.length, InetAddress.getLocalHost(), <span class="number">9998</span>);</span><br><span class="line"></span><br><span class="line">        socket.send(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. å…³é—­èµ„æº</span></span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;Aç«¯é€€å‡º...&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UDPSenderB</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> UDPSenderB</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å‘é€ç«¯ B ====&gt; ä¹Ÿå¯ä»¥æ¥æ”¶æ•°æ®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 10:04</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UDPSenderB</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1.åˆ›å»º DatagramSocket å¯¹è±¡ï¼Œå‡†å¤‡åœ¨9998ç«¯å£ æ¥æ”¶æ•°æ®</span></span><br><span class="line">        DatagramSocket socket = <span class="keyword">new</span> DatagramSocket(<span class="number">9998</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. å°†éœ€è¦å‘é€çš„æ•°æ®ï¼Œå°è£…åˆ° DatagramPacketå¯¹è±¡</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="string">&quot;hello æ˜å¤©åƒç«é”…~&quot;</span>.getBytes();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¯´æ˜: å°è£…çš„ DatagramPacketå¯¹è±¡ data å†…å®¹å­—èŠ‚æ•°ç»„ , data.length , ä¸»æœº(IP) , ç«¯å£</span></span><br><span class="line">        DatagramPacket packet =</span><br><span class="line">                <span class="keyword">new</span> DatagramPacket(data, data.length, InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line"></span><br><span class="line">        socket.send(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.=== æ¥æ”¶ä»Aç«¯å›å¤çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="comment">//(1)   æ„å»ºä¸€ä¸ª DatagramPacket å¯¹è±¡ï¼Œå‡†å¤‡æ¥æ”¶æ•°æ®</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        packet = <span class="keyword">new</span> DatagramPacket(buf, buf.length);</span><br><span class="line">        <span class="comment">//(2)    è°ƒç”¨ æ¥æ”¶æ–¹æ³•, å°†é€šè¿‡ç½‘ç»œä¼ è¾“çš„ DatagramPacket å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//   å¡«å……åˆ° packetå¯¹è±¡</span></span><br><span class="line">        <span class="comment">//å½“æœ‰æ•°æ®åŒ…å‘é€åˆ° æœ¬æœºçš„9998ç«¯å£æ—¶ï¼Œå°±ä¼šæ¥æ”¶åˆ°æ•°æ®</span></span><br><span class="line">        <span class="comment">//   å¦‚æœæ²¡æœ‰æ•°æ®åŒ…å‘é€åˆ° æœ¬æœºçš„9998ç«¯å£, å°±ä¼šé˜»å¡ç­‰å¾….</span></span><br><span class="line">        socket.receive(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//(3)  å¯ä»¥æŠŠpacket è¿›è¡Œæ‹†åŒ…ï¼Œå–å‡ºæ•°æ®ï¼Œå¹¶æ˜¾ç¤º.</span></span><br><span class="line">        <span class="comment">//å®é™…æ¥æ”¶åˆ°çš„æ•°æ®å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        <span class="keyword">int</span> length = packet.getLength();</span><br><span class="line">        <span class="comment">//æ¥æ”¶åˆ°æ•°æ®</span></span><br><span class="line">        data = packet.getData();</span><br><span class="line">        String s = <span class="keyword">new</span> String(data, <span class="number">0</span>, length);</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;Bç«¯é€€å‡º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-1-ç»ƒä¹ "><a href="#6-1-ç»ƒä¹ " class="headerlink" title="6.1 ç»ƒä¹ "></a>6.1 ç»ƒä¹ </h2><h3 id="6-1-1-ä½œä¸š1"><a href="#6-1-1-ä½œä¸š1" class="headerlink" title="6.1.1 ä½œä¸š1"></a>6.1.1 ä½œä¸š1</h3><p><a href="https://imgtu.com/i/2G1R9U"><img src="https://z3.ax1x.com/2021/06/04/2G1R9U.png" alt="2G1R9U.png"></a></p>
<p><strong>Homework01Server</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Homework01Server</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æœåŠ¡ç«¯, ä½¿ç”¨å­—ç¬¦æµæ–¹å¼è¯»å†™</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 10:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Homework01Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//æ€è·¯</span></span><br><span class="line">        <span class="comment">//1. åœ¨æœ¬æœº çš„9999ç«¯å£ç›‘å¬, ç­‰å¾…è¿æ¥</span></span><br><span class="line">        <span class="comment">//   ç»†èŠ‚: è¦æ±‚åœ¨æœ¬æœºæ²¡æœ‰å…¶å®ƒæœåŠ¡åœ¨ç›‘å¬9999</span></span><br><span class="line">        <span class="comment">//   ç»†èŠ‚ï¼šè¿™ä¸ª ServerSocket å¯ä»¥é€šè¿‡ accept() è¿”å›å¤šä¸ªSocket[å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨çš„å¹¶å‘]</span></span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯ï¼Œåœ¨9999ç«¯å£ç›‘å¬ï¼Œç­‰å¾…è¿æ¥..&quot;</span>);</span><br><span class="line">        <span class="comment">//2. å½“æ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥9999ç«¯å£æ—¶ï¼Œç¨‹åºä¼š é˜»å¡, ç­‰å¾…è¿æ¥</span></span><br><span class="line">        <span class="comment">//   å¦‚æœæœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œåˆ™ä¼šè¿”å›Socketå¯¹è±¡ï¼Œç¨‹åºç»§ç»­</span></span><br><span class="line"></span><br><span class="line">        Socket socket = serverSocket.accept();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">//3. é€šè¿‡socket.getInputStream() è¯»å–å®¢æˆ·ç«¯å†™å…¥åˆ°æ•°æ®é€šé“çš„æ•°æ®, æ˜¾ç¤º</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line">        <span class="comment">//4. IOè¯»å–, ä½¿ç”¨å­—ç¬¦æµ, è€å¸ˆä½¿ç”¨ InputStreamReader å°† inputStream è½¬æˆå­—ç¬¦æµ</span></span><br><span class="line">        BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(inputStream));</span><br><span class="line">        String s = bufferedReader.readLine();</span><br><span class="line">        String answer = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;name&quot;</span>.equals(s)) &#123;</span><br><span class="line">            answer = <span class="string">&quot;æˆ‘æ˜¯zk&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;hobby&quot;</span>.equals(s)) &#123;</span><br><span class="line">            answer = <span class="string">&quot;ç¼–å†™javaç¨‹åº&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            answer = <span class="string">&quot;ä½ è¯´çš„å•¥å­&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. è·å–socketç›¸å…³è”çš„è¾“å‡ºæµ</span></span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">        <span class="comment">//    ä½¿ç”¨å­—ç¬¦è¾“å‡ºæµçš„æ–¹å¼å›å¤ä¿¡æ¯</span></span><br><span class="line">        BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(outputStream));</span><br><span class="line">        bufferedWriter.write(answer);</span><br><span class="line">        bufferedWriter.newLine();<span class="comment">// æ’å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œè¡¨ç¤ºå›å¤å†…å®¹çš„ç»“æŸ</span></span><br><span class="line">        bufferedWriter.flush();<span class="comment">//æ³¨æ„éœ€è¦æ‰‹åŠ¨çš„flush</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.å…³é—­æµå’Œsocket</span></span><br><span class="line">        bufferedWriter.close();</span><br><span class="line">        bufferedReader.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();<span class="comment">//å…³é—­</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Homework01Client</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Homework01Client</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å®¢æˆ·ç«¯ï¼Œå‘é€ &quot;hello, server&quot; ç»™æœåŠ¡ç«¯ï¼Œ ä½¿ç”¨å­—ç¬¦æµ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 10:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Homework01Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//æ€è·¯</span></span><br><span class="line">        <span class="comment">//1. è¿æ¥æœåŠ¡ç«¯ (ip , ç«¯å£ï¼‰</span></span><br><span class="line">        <span class="comment">//è§£è¯»: è¿æ¥æœ¬æœºçš„ 9999ç«¯å£, å¦‚æœè¿æ¥æˆåŠŸï¼Œè¿”å›Socketå¯¹è±¡</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. è¿æ¥ä¸Šåï¼Œç”ŸæˆSocket, é€šè¿‡socket.getOutputStream()</span></span><br><span class="line">        <span class="comment">//   å¾—åˆ° å’Œ socketå¯¹è±¡å…³è”çš„è¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">        <span class="comment">//3. é€šè¿‡è¾“å‡ºæµï¼Œå†™å…¥æ•°æ®åˆ° æ•°æ®é€šé“, ä½¿ç”¨å­—ç¬¦æµ</span></span><br><span class="line">        BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(outputStream));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä»é”®ç›˜è¯»å–ç”¨æˆ·çš„é—®é¢˜</span></span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä½ çš„é—®é¢˜&quot;</span>);</span><br><span class="line">        String question = scanner.next();</span><br><span class="line"></span><br><span class="line">        bufferedWriter.write(question);</span><br><span class="line">        bufferedWriter.newLine();<span class="comment">//æ’å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œè¡¨ç¤ºå†™å…¥çš„å†…å®¹ç»“æŸ, æ³¨æ„ï¼Œè¦æ±‚å¯¹æ–¹ä½¿ç”¨readLine()!!!!</span></span><br><span class="line">        bufferedWriter.flush();<span class="comment">// å¦‚æœä½¿ç”¨çš„å­—ç¬¦æµï¼Œéœ€è¦æ‰‹åŠ¨åˆ·æ–°ï¼Œå¦åˆ™æ•°æ®ä¸ä¼šå†™å…¥æ•°æ®é€šé“</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. è·å–å’Œsocketå…³è”çš„è¾“å…¥æµ. è¯»å–æ•°æ®(å­—ç¬¦)ï¼Œå¹¶æ˜¾ç¤º</span></span><br><span class="line">        InputStream inputStream = socket.getInputStream();</span><br><span class="line">        BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(inputStream));</span><br><span class="line">        String s = bufferedReader.readLine();</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. å…³é—­æµå¯¹è±¡å’Œsocket, å¿…é¡»å…³é—­</span></span><br><span class="line">        bufferedReader.close();<span class="comment">//å…³é—­å¤–å±‚æµ</span></span><br><span class="line">        bufferedWriter.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯é€€å‡º.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-1-2-ä½œä¸š2"><a href="#6-1-2-ä½œä¸š2" class="headerlink" title="6.1.2 ä½œä¸š2"></a>6.1.2 ä½œä¸š2</h3><p><a href="https://imgtu.com/i/2G1ghT"><img src="https://z3.ax1x.com/2021/06/04/2G1ghT.png" alt="2G1ghT.png"></a></p>
<p><strong>Homework02ReceiverA</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Homework02ReceiverA</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> UDPæ¥æ”¶ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 10:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Homework02ReceiverA</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. åˆ›å»ºä¸€ä¸ª DatagramSocket å¯¹è±¡ï¼Œå‡†å¤‡åœ¨8888æ¥æ”¶æ•°æ®</span></span><br><span class="line">        DatagramSocket socket = <span class="keyword">new</span> DatagramSocket(<span class="number">8888</span>);</span><br><span class="line">        <span class="comment">//2. æ„å»ºä¸€ä¸ª DatagramPacket å¯¹è±¡ï¼Œå‡†å¤‡æ¥æ”¶æ•°æ®</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        DatagramPacket packet = <span class="keyword">new</span> DatagramPacket(buf, buf.length);</span><br><span class="line">        <span class="comment">//3. è°ƒç”¨ æ¥æ”¶æ–¹æ³•, å°†é€šè¿‡ç½‘ç»œä¼ è¾“çš„ DatagramPacket å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//   å¡«å……åˆ° packetå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ¥æ”¶ç«¯ ç­‰å¾…æ¥æ”¶é—®é¢˜ &quot;</span>);</span><br><span class="line">        socket.receive(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. å¯ä»¥æŠŠpacket è¿›è¡Œæ‹†åŒ…ï¼Œå–å‡ºæ•°æ®ï¼Œå¹¶æ˜¾ç¤º.</span></span><br><span class="line">        <span class="comment">//å®é™…æ¥æ”¶åˆ°çš„æ•°æ®å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        <span class="keyword">int</span> length = packet.getLength();</span><br><span class="line">        <span class="comment">//æ¥æ”¶åˆ°æ•°æ®</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = packet.getData();</span><br><span class="line">        String s = <span class="keyword">new</span> String(data, <span class="number">0</span>, length);</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ¥æ”¶åˆ°çš„ä¿¡æ¯æ˜¯ä»€ä¹ˆ</span></span><br><span class="line">        String answer = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;å››å¤§åè‘—æ˜¯å“ªäº›&quot;</span>.equals(s)) &#123;</span><br><span class="line">            answer = <span class="string">&quot;å››å¤§åè‘— &lt;&lt;çº¢æ¥¼æ¢¦&gt;&gt; &lt;&lt;ä¸‰å›½æ¼”ç¤º&gt;&gt; &lt;&lt;è¥¿æ¸¸è®°&gt;&gt; &lt;&lt;æ°´æµ’ä¼ &gt;&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            answer = <span class="string">&quot;what?&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//===å›å¤ä¿¡æ¯ç»™Bç«¯</span></span><br><span class="line">        <span class="comment">//å°†éœ€è¦å‘é€çš„æ•°æ®ï¼Œå°è£…åˆ° DatagramPacketå¯¹è±¡</span></span><br><span class="line">        data = answer.getBytes();</span><br><span class="line">        <span class="comment">//è¯´æ˜: å°è£…çš„ DatagramPacketå¯¹è±¡ data å†…å®¹å­—èŠ‚æ•°ç»„ , data.length , ä¸»æœº(IP) , ç«¯å£</span></span><br><span class="line">        packet =</span><br><span class="line">                <span class="keyword">new</span> DatagramPacket(data, data.length, InetAddress.getLocalHost(), <span class="number">9998</span>);</span><br><span class="line"></span><br><span class="line">        socket.send(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. å…³é—­èµ„æº</span></span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;Aç«¯é€€å‡º...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Homework02SenderB</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Homework02SenderB</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å‘é€ç«¯B ====&gt; ä¹Ÿå¯ä»¥æ¥æ”¶æ•°æ®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/4 10:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Homework02SenderB</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.åˆ›å»º DatagramSocket å¯¹è±¡ï¼Œå‡†å¤‡åœ¨9998ç«¯å£ æ¥æ”¶æ•°æ®</span></span><br><span class="line">        DatagramSocket socket = <span class="keyword">new</span> DatagramSocket(<span class="number">9998</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. å°†éœ€è¦å‘é€çš„æ•°æ®ï¼Œå°è£…åˆ° DatagramPacketå¯¹è±¡</span></span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä½ çš„é—®é¢˜: &quot;</span>);</span><br><span class="line">        String question = scanner.next();</span><br><span class="line">        <span class="keyword">byte</span>[] data = question.getBytes();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¯´æ˜: å°è£…çš„ DatagramPacketå¯¹è±¡ data å†…å®¹å­—èŠ‚æ•°ç»„ , data.length , ä¸»æœº(IP) , ç«¯å£</span></span><br><span class="line">        DatagramPacket packet =</span><br><span class="line">                <span class="keyword">new</span> DatagramPacket(data, data.length, InetAddress.getLocalHost(), <span class="number">8888</span>);</span><br><span class="line"></span><br><span class="line">        socket.send(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.=== æ¥æ”¶ä»Aç«¯å›å¤çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="comment">//(1)   æ„å»ºä¸€ä¸ª DatagramPacket å¯¹è±¡ï¼Œå‡†å¤‡æ¥æ”¶æ•°æ®</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        packet = <span class="keyword">new</span> DatagramPacket(buf, buf.length);</span><br><span class="line">        <span class="comment">//(2)    è°ƒç”¨ æ¥æ”¶æ–¹æ³•, å°†é€šè¿‡ç½‘ç»œä¼ è¾“çš„ DatagramPacket å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//   å¡«å……åˆ° packetå¯¹è±¡</span></span><br><span class="line">        socket.receive(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//(3)  å¯ä»¥æŠŠpacket è¿›è¡Œæ‹†åŒ…ï¼Œå–å‡ºæ•°æ®ï¼Œå¹¶æ˜¾ç¤º.</span></span><br><span class="line">        <span class="comment">//å®é™…æ¥æ”¶åˆ°çš„æ•°æ®å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        <span class="keyword">int</span> length = packet.getLength();</span><br><span class="line">        <span class="comment">//æ¥æ”¶åˆ°æ•°æ®</span></span><br><span class="line">        data = packet.getData();</span><br><span class="line">        String s = <span class="keyword">new</span> String(data, <span class="number">0</span>, length);</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;Bç«¯é€€å‡º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7-å¤šç”¨æˆ·å³æ—¶é€šè®¯"><a href="#7-å¤šç”¨æˆ·å³æ—¶é€šè®¯" class="headerlink" title="7. å¤šç”¨æˆ·å³æ—¶é€šè®¯"></a>7. å¤šç”¨æˆ·å³æ—¶é€šè®¯</h1><p>æ­¤é¡¹ç›®æ˜¯ç”¨æ¥æ€»ç»“ <code>å¤šçº¿ç¨‹</code>ï¼Œ<code>IOæµ</code>ï¼Œ<code>ç½‘ç»œç¼–ç¨‹</code>æ‰€å­¦çš„é‡è¦çŸ¥è¯†ç‚¹</p>
<p><strong>å…ˆçœ‹é¡¹ç›® ç›®å½•ä¸€è§ˆ</strong></p>
<p><a href="https://imgtu.com/i/2szH4f"><img src="https://z3.ax1x.com/2021/06/09/2szH4f.png" alt="2szH4f.png"></a></p>
<p>æ‰€åŒ…å«çš„åŠŸèƒ½</p>
<ol>
<li>ç”¨æˆ·ç™»å½•</li>
<li>æ‹‰å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</li>
<li>æ— å¼‚å¸¸é€€å‡ºï¼ˆå®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ï¼‰</li>
<li>ç§èŠ</li>
<li>ç¾¤èŠ</li>
<li>å‘æ–‡ä»¶</li>
<li>æœåŠ¡å™¨æ¨é€æ–°é—»</li>
</ol>
<h2 id="7-1-åŠŸèƒ½å®ç°-ç”¨æˆ·ç™»å½•"><a href="#7-1-åŠŸèƒ½å®ç°-ç”¨æˆ·ç™»å½•" class="headerlink" title="7.1 åŠŸèƒ½å®ç°-ç”¨æˆ·ç™»å½•"></a>7.1 åŠŸèƒ½å®ç°-ç”¨æˆ·ç™»å½•</h2><p>å…ˆçœ‹ç¤ºæ„å›¾ï¼Œçœ‹æ‡‚å›¾æ‰èƒ½äº†è§£åŠŸèƒ½å¦‚ä½•å®ç°ï¼</p>
<p><a href="https://imgtu.com/i/2ypoff"><img src="https://z3.ax1x.com/2021/06/09/2ypoff.png" alt="2ypoff.png"></a></p>
<p><strong>å›¾è§£è¯»</strong></p>
<p><strong>å®¢æˆ·ç«¯</strong></p>
<ul>
<li>å’ŒæœåŠ¡ç«¯é€šä¿¡æ—¶ï¼Œä½¿ç”¨å¯¹è±¡æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨<code>å¯¹è±¡æµ</code>æ¥è¯»å†™</li>
<li>å½“å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡ç«¯ï¼Œä¹Ÿä¼šå¾—åˆ°<code>socket</code></li>
<li>å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹æŒæœ‰<code>socket</code></li>
<li>æ–¹ä¾¿ç®¡ç†çº¿ç¨‹ï¼Œå°†çº¿ç¨‹æ”¾å…¥åˆ°é›†åˆ</li>
</ul>
<p><strong>æœåŠ¡ç«¯</strong></p>
<ul>
<li>æœ‰å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œå¾—åˆ°ä¸€ä¸ª<code>socket</code></li>
<li>å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ŒæŒæœ‰è¯¥<code>socket</code>,ä¸”åŒ…å«è¯¥çº¿ç¨‹æ‰€æœ‰å±æ€§</li>
<li>æ–¹ä¾¿ç®¡ç†çº¿ç¨‹ï¼Œéœ€è¦ä½¿ç”¨é›†åˆç®¡ç†</li>
</ul>
<h2 id="7-2-åŠŸèƒ½å®ç°-ç§èŠ"><a href="#7-2-åŠŸèƒ½å®ç°-ç§èŠ" class="headerlink" title="7.2 åŠŸèƒ½å®ç°-ç§èŠ"></a>7.2 åŠŸèƒ½å®ç°-ç§èŠ</h2><p><a href="https://imgtu.com/i/2ypoff"><img src="https://z3.ax1x.com/2021/06/09/2ypoff.png" alt="2ypoff.png"></a></p>
<p><strong>å®¢æˆ·ç«¯</strong></p>
<ul>
<li>æ¥å—ç”¨æˆ·å¸Œæœ›ç»™å…¶ä»–åœ¨çº¿ç”¨æˆ·èŠå¤©çš„å†…å®¹</li>
<li>å°†æ¶ˆæ¯æ„æˆ<code>Message</code>å¯¹è±¡ï¼Œé€šè¿‡å¯¹åº”çš„<code>socket</code>å‘é€ç»™æœåŠ¡å™¨</li>
<li>åœ¨é€šä¿¡çº¿ç¨‹ä¸­ï¼Œè¯»å–åˆ°å‘é€çš„<code>message</code>æ¶ˆæ¯ï¼Œæ˜¾ç¤º</li>
</ul>
<p><strong>æœåŠ¡ç«¯</strong></p>
<ul>
<li>å¯ä»¥ä»å®¢æˆ·ç«¯è¯»å–åˆ°æ¶ˆæ¯</li>
<li>ä»ç®¡ç†çº¿ç¨‹çš„é›†åˆä¸­ï¼Œæ ¹æ®<code>message</code>å¯¹è±¡çš„<code>id</code>è·å–å¯¹åº”çš„<code>socket</code></li>
<li>æœ€åå°†<code>message</code>å¯¹è±¡è½¬å‘ç»™æŒ‡å®šç”¨æˆ·</li>
</ul>
<h2 id="7-3-åŠŸèƒ½å®ç°-å‘æ–‡ä»¶"><a href="#7-3-åŠŸèƒ½å®ç°-å‘æ–‡ä»¶" class="headerlink" title="7.3 åŠŸèƒ½å®ç°-å‘æ–‡ä»¶"></a>7.3 åŠŸèƒ½å®ç°-å‘æ–‡ä»¶</h2><p><a href="https://imgtu.com/i/2yP7p6"><img src="https://z3.ax1x.com/2021/06/09/2yP7p6.png" alt="2yP7p6.png"></a></p>
<p><strong>å®¢æˆ·ç«¯</strong></p>
<ul>
<li>å…ˆæŠŠæ–‡ä»¶è¯»å–åˆ°å®¢æˆ·ç«¯ï¼Œå­˜æ”¾åœ¨å­—èŠ‚æ•°ç»„ä¸­</li>
<li>æŠŠå¯¹åº”çš„æ–‡ä»¶å­—èŠ‚æ•°ç»„å°è£…åˆ°<code>message</code>å¯¹(æ–‡ä»¶å†…å®¹ï¼Œsender,getter)</li>
<li>å°†<code>message</code>å¯¹è±¡å‘é€ç»™æœåŠ¡ç«¯</li>
<li>åœ¨æ¥æ”¶åˆ°æ–‡ä»¶çš„æ¶ˆæ¯åï¼Œå°†è¯¥æ–‡ä»¶ä¿å­˜åˆ°ç£ç›˜</li>
</ul>
<p><strong>æœåŠ¡ç«¯</strong></p>
<ul>
<li>æ¥æ”¶<code>message</code>å¯¹è±¡</li>
<li>æ‹†è§£<code>message</code>å¯¹è±¡çš„<code>id</code>ï¼Œè·å–ç”¨æˆ·çš„é€šä¿¡çº¿ç¨‹</li>
<li>å°†<code>message</code>è½¬å‘ç»™æŒ‡å®šç”¨æˆ·</li>
</ul>
<h2 id="7-4-ä»£ç å®ç°"><a href="#7-4-ä»£ç å®ç°" class="headerlink" title="7.4 ä»£ç å®ç°"></a>7.4 ä»£ç å®ç°</h2><p>åˆ†æå®Œçœ‹ä»£ç å®ç°ï¼Œå…³é”®æ–¹æ³•éƒ½æœ‰æ³¨é‡Š</p>
<h3 id="7-4-1-QQServe"><a href="#7-4-1-QQServe" class="headerlink" title="7.4.1 QQServe"></a>7.4.1 QQServe</h3><p><strong>Message</strong></p>
<ul>
<li>å®ç°åºåˆ—åŒ–æ¥å£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqcommon;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Message</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¡¨ç¤ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é€šä¿¡æ—¶çš„æ¶ˆæ¯å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 12:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="comment">//å‘é€è€…</span></span><br><span class="line">    <span class="keyword">private</span> String sender;</span><br><span class="line">    <span class="comment">//æ¥å—è€…</span></span><br><span class="line">    <span class="keyword">private</span> String getter;</span><br><span class="line">    <span class="comment">//æ¶ˆæ¯å†…å®¹</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="comment">//å‘é€æ—¶é—´</span></span><br><span class="line">    <span class="keyword">private</span> String sendTime;</span><br><span class="line">    <span class="comment">//æ¶ˆæ¯ç±»å‹</span></span><br><span class="line">    <span class="keyword">private</span> String mesType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿›è¡Œæ‹“å±• å’Œæ–‡ä»¶ç›¸å…³çš„æˆå‘˜</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] fileBytes;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> fileLen=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//æ–‡ä»¶ä¼ è¾“çš„ç›®çš„åœ°</span></span><br><span class="line">    <span class="keyword">private</span> String dest;</span><br><span class="line">    <span class="comment">//æºæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    <span class="keyword">private</span> String src;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getFileBytes() &#123;</span><br><span class="line">        <span class="keyword">return</span> fileBytes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFileBytes</span><span class="params">(<span class="keyword">byte</span>[] fileBytes)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fileBytes = fileBytes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFileLen</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fileLen;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFileLen</span><span class="params">(<span class="keyword">int</span> fileLen)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fileLen = fileLen;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dest;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDest</span><span class="params">(String dest)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dest = dest;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSrc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> src;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSrc</span><span class="params">(String src)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.src = src;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMesType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mesType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMesType</span><span class="params">(String mesType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mesType = mesType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSender</span><span class="params">(String sender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sender = sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGetter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGetter</span><span class="params">(String getter)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getter = getter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContent</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSendTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sendTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSendTime</span><span class="params">(String sendTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sendTime = sendTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MessageType</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqcommon;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MessageType</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¡¨ç¤ºæ¶ˆæ¯ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 12:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MessageType</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    æ¥å£ä¸­å®šä¹‰ä¸€äº›å¸¸é‡</span></span><br><span class="line"><span class="comment">    ä¸åŒå¸¸é‡è¡¨ç¤ºä¸åŒçš„æ¶ˆæ¯ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String MESSAGE_LOGIN_SUCCEED = <span class="string">&quot;1&quot;</span>; <span class="comment">//è¡¨ç¤ºç™»å½•æˆåŠŸ</span></span><br><span class="line">    String MESSAGE_LOGIN_FAIL = <span class="string">&quot;2&quot;</span>; <span class="comment">// è¡¨ç¤ºç™»å½•å¤±è´¥</span></span><br><span class="line">    String MESSAGE_COMM_MES = <span class="string">&quot;3&quot;</span>; <span class="comment">//æ™®é€šä¿¡æ¯åŒ…</span></span><br><span class="line">    String MESSAGE_GET_ONLINE_FRIEND = <span class="string">&quot;4&quot;</span>; <span class="comment">//è¦æ±‚è¿”å›åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">    String MESSAGE_RET_ONLINE_FRIEND = <span class="string">&quot;5&quot;</span>; <span class="comment">//è¿”å›åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">    String MESSAGE_CLIENT_EXIT = <span class="string">&quot;6&quot;</span>; <span class="comment">//å®¢æˆ·ç«¯è¯·æ±‚é€€å‡º</span></span><br><span class="line">    String MESSAGE_TO_ALL_MES = <span class="string">&quot;7&quot;</span>; <span class="comment">//ç¾¤å‘æ¶ˆæ¯æŠ¥</span></span><br><span class="line">    String MESSAGE_FILE_MES = <span class="string">&quot;8&quot;</span>; <span class="comment">//æ–‡ä»¶æ¶ˆæ¯(å‘é€æ–‡ä»¶)</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>User</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqcommon;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> User</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¡¨ç¤ºä¸€ä¸ªç”¨æˆ·/å®¢æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 12:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String userId;<span class="comment">//ç”¨æˆ·Id/ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> String passwd;<span class="comment">//ç”¨æˆ·å¯†ç </span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String userId, String passwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">        <span class="keyword">this</span>.passwd = passwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserId</span><span class="params">(String userId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPasswd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> passwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPasswd</span><span class="params">(String passwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.passwd = passwd;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å·¥å…·ç±» æ–¹ä¾¿ç®¡ç†è¾“å…¥</strong></p>
<p><strong>Utility</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Utility</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 12:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> å·¥å…·ç±»çš„ä½œç”¨:</span></span><br><span class="line"><span class="comment"> å¤„ç†å„ç§æƒ…å†µçš„ç”¨æˆ·è¾“å…¥ï¼Œå¹¶ä¸”èƒ½å¤ŸæŒ‰ç…§ç¨‹åºå‘˜çš„éœ€æ±‚ï¼Œå¾—åˆ°ç”¨æˆ·çš„æ§åˆ¶å°è¾“å…¥ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Utility</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é™æ€å±æ€§ã€‚ã€‚ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªèœå•é€‰é¡¹ï¼Œå€¼ï¼š1â€”â€”5çš„èŒƒå›´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 1â€”â€”5</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">char</span> <span class="title">readMenuSelection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c;</span><br><span class="line">        <span class="keyword">for</span> (; ; ) &#123;</span><br><span class="line">            String str = readKeyBoard(<span class="number">1</span>, <span class="keyword">false</span>);<span class="comment">//åŒ…å«ä¸€ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line">            c = str.charAt(<span class="number">0</span>);<span class="comment">//å°†å­—ç¬¦ä¸²è½¬æ¢æˆå­—ç¬¦charç±»å‹</span></span><br><span class="line">            <span class="keyword">if</span> (c != <span class="string">&#x27;1&#x27;</span> &amp;&amp; c != <span class="string">&#x27;2&#x27;</span> &amp;&amp;</span><br><span class="line">                    c != <span class="string">&#x27;3&#x27;</span> &amp;&amp; c != <span class="string">&#x27;4&#x27;</span> &amp;&amp; c != <span class="string">&#x27;5&#x27;</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;é€‰æ‹©é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">char</span> <span class="title">readChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String str = readKeyBoard(<span class="number">1</span>, <span class="keyword">false</span>);<span class="comment">//å°±æ˜¯ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="keyword">return</span> str.charAt(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœç›´æ¥æŒ‰å›è½¦ï¼Œåˆ™è¿”å›æŒ‡å®šçš„é»˜è®¤å€¼ï¼›å¦åˆ™è¿”å›è¾“å…¥çš„é‚£ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> defaultValue æŒ‡å®šçš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é»˜è®¤å€¼æˆ–è¾“å…¥çš„å­—ç¬¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">char</span> <span class="title">readChar</span><span class="params">(<span class="keyword">char</span> defaultValue)</span> </span>&#123;</span><br><span class="line">        String str = readKeyBoard(<span class="number">1</span>, <span class="keyword">true</span>);<span class="comment">//è¦ä¹ˆæ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="keyword">return</span> (str.length() == <span class="number">0</span>) ? defaultValue : str.charAt(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„æ•´å‹ï¼Œé•¿åº¦å°äº2ä½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ•´æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">readInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n;</span><br><span class="line">        <span class="keyword">for</span> (; ; ) &#123;</span><br><span class="line">            String str = readKeyBoard(<span class="number">10</span>, <span class="keyword">false</span>);<span class="comment">//ä¸€ä¸ªæ•´æ•°ï¼Œé•¿åº¦&lt;=10ä½</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                n = Integer.parseInt(str);<span class="comment">//å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;æ•°å­—è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ æ•´æ•°æˆ–é»˜è®¤å€¼ï¼Œå¦‚æœç›´æ¥å›è½¦ï¼Œåˆ™è¿”å›é»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›è¾“å…¥çš„æ•´æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> defaultValue æŒ‡å®šçš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ•´æ•°æˆ–é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">readInt</span><span class="params">(<span class="keyword">int</span> defaultValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n;</span><br><span class="line">        <span class="keyword">for</span> (; ; ) &#123;</span><br><span class="line">            String str = readKeyBoard(<span class="number">10</span>, <span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (str.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> defaultValue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¼‚å¸¸å¤„ç†...</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                n = Integer.parseInt(str);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;æ•°å­—è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> limit é™åˆ¶çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">readString</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> readKeyBoard(limit, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²æˆ–é»˜è®¤å€¼ï¼Œå¦‚æœç›´æ¥å›è½¦ï¼Œè¿”å›é»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> limit é™åˆ¶çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> defaultValue æŒ‡å®šçš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">readString</span><span class="params">(<span class="keyword">int</span> limit, String defaultValue)</span> </span>&#123;</span><br><span class="line">        String str = readKeyBoard(limit, <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> str.equals(<span class="string">&quot;&quot;</span>)? defaultValue : str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ç¡®è®¤é€‰é¡¹ï¼ŒYæˆ–N</span></span><br><span class="line"><span class="comment">     * å°†å°çš„åŠŸèƒ½ï¼Œå°è£…åˆ°ä¸€ä¸ªæ–¹æ³•ä¸­.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Yæˆ–N</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">char</span> <span class="title">readConfirmSelection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä½ çš„é€‰æ‹©(Y/N): è¯·å°å¿ƒé€‰æ‹©&quot;</span>);</span><br><span class="line">        <span class="keyword">char</span> c;</span><br><span class="line">        <span class="keyword">for</span> (; ; ) &#123;<span class="comment">//æ— é™å¾ªç¯</span></span><br><span class="line">            <span class="comment">//åœ¨è¿™é‡Œï¼Œå°†æ¥å—åˆ°å­—ç¬¦ï¼Œè½¬æˆäº†å¤§å†™å­—æ¯</span></span><br><span class="line">            <span class="comment">//y =&gt; Y n=&gt;N</span></span><br><span class="line">            String str = readKeyBoard(<span class="number">1</span>, <span class="keyword">false</span>).toUpperCase();</span><br><span class="line">            c = str.charAt(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">&#x27;Y&#x27;</span> || c == <span class="string">&#x27;N&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;é€‰æ‹©é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½ï¼š è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> limit è¯»å–çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> blankReturn å¦‚æœä¸ºtrue ,è¡¨ç¤º å¯ä»¥è¯»ç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="comment">     *                   å¦‚æœä¸ºfalseè¡¨ç¤º ä¸èƒ½è¯»ç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œæˆ–è€…è¾“å…¥å¤§äºlimitçš„é•¿åº¦ï¼Œå°±ä¼šæç¤ºé‡æ–°è¾“å…¥ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">readKeyBoard</span><span class="params">(<span class="keyword">int</span> limit, <span class="keyword">boolean</span> blankReturn)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®šä¹‰äº†å­—ç¬¦ä¸²</span></span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//scanner.hasNextLine() åˆ¤æ–­æœ‰æ²¡æœ‰ä¸‹ä¸€è¡Œ</span></span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNextLine()) &#123;</span><br><span class="line">            line = scanner.nextLine();<span class="comment">//è¯»å–è¿™ä¸€è¡Œ</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœline.length=0, å³ç”¨æˆ·æ²¡æœ‰è¾“å…¥ä»»ä½•å†…å®¹ï¼Œç›´æ¥å›è½¦</span></span><br><span class="line">            <span class="keyword">if</span> (line.length() == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (blankReturn) &#123;</span><br><span class="line">                    <span class="keyword">return</span> line;<span class="comment">//å¦‚æœblankReturn=true,å¯ä»¥è¿”å›ç©ºä¸²</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">continue</span>; <span class="comment">//å¦‚æœblankReturn=false,ä¸æ¥å—ç©ºä¸²ï¼Œå¿…é¡»è¾“å…¥å†…å®¹</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœç”¨æˆ·è¾“å…¥çš„å†…å®¹å¤§äºäº† limitï¼Œå°±æç¤ºé‡å†™è¾“å…¥</span></span><br><span class="line">            <span class="comment">//å¦‚æœç”¨æˆ·å¦‚çš„å†…å®¹ &gt;0 &lt;= limit ,æˆ‘å°±æ¥å—</span></span><br><span class="line">            <span class="keyword">if</span> (line.length() &lt; <span class="number">1</span> || line.length() &gt; limit) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;è¾“å…¥é•¿åº¦ï¼ˆä¸èƒ½å¤§äº&quot;</span> + limit + <span class="string">&quot;ï¼‰é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š&quot;</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> line;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>ManageClientThreads</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqserver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ManageClientThreads</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¯¥ç±»ç”¨äºç®¡ç†å’Œå®¢æˆ·ç«¯é€šä¿¡çš„çº¿ç¨‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 12:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ManageClientThreads</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String,ServerConnectClientThread&gt; hm=<span class="keyword">new</span> HashMap&lt;String, ServerConnectClientThread&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›hm</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HashMap&lt;String, ServerConnectClientThread&gt; <span class="title">getHm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å°†çº¿ç¨‹æ·»åŠ å¯¹è±¡åˆ°hmé›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">addClientThread</span><span class="params">(String userId,ServerConnectClientThread serverConnectClientThread)</span></span>&#123;</span><br><span class="line">        hm.put(userId, serverConnectClientThread);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®userIdï¼Œè¿”å›ServerConnectClientThreadçº¿ç¨‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  ServerConnectClientThread <span class="title">getServerConnectClientThread</span><span class="params">(String userId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hm.get(userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œä»é›†åˆä¸­ï¼Œç§»é™¤æŸä¸ªçº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeServerConnectClientThread</span><span class="params">(String userId)</span> </span>&#123;</span><br><span class="line">        hm.remove(userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    è¿”å›åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getOnlineUser</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//        éå†é›†åˆ</span></span><br><span class="line">        Iterator&lt;String&gt; iterator = hm.keySet().iterator();</span><br><span class="line">        String onlineUserList=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">            onlineUserList+=iterator.next().toString()+<span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> onlineUserList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>SendNewsToAllService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqserver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.utils.Utility;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SendNewsToAllService</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SendNewsToAllService</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">//ä¸ºäº†å¤šæ¬¡æ¨é€æ–°é—»å¯ä»¥ä½¿ç”¨whileå¾ªç¯</span></span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å…¥æœåŠ¡å™¨è¦æ¨é€çš„æ–°é—»/æ¶ˆæ¯[è¾“å…¥exitè¡¨ç¤ºé€€å‡ºæœåŠ¡çº¿ç¨‹]&quot;</span>);</span><br><span class="line">            String news= Utility.readString(<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;exit&quot;</span>.equals(news))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//æ„å»ºä¸€ä¸ªæ¶ˆæ¯ï¼Œç¾¤å‘ä¿¡æ¯</span></span><br><span class="line">            Message message=<span class="keyword">new</span> Message();</span><br><span class="line">            message.setSender(<span class="string">&quot;æœåŠ¡å™¨&quot;</span>);</span><br><span class="line">            message.setMesType(MessageType.MESSAGE_TO_ALL_MES);</span><br><span class="line">            message.setContent(news);</span><br><span class="line">            message.setSendTime(<span class="keyword">new</span> Date().toString());</span><br><span class="line">            System.out.println(<span class="string">&quot;æœåŠ¡å™¨æ¨é€æ¶ˆæ¯ç»™æ‰€æœ‰äºº è¯´&quot;</span>+news);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//éå†å½“å‰æ‰€æœ‰çš„é€šä¿¡çº¿ç¨‹ï¼Œå¾—åˆ°socket,å¹¶å‘é€message</span></span><br><span class="line">            HashMap&lt;String, ServerConnectClientThread&gt; hm = ManageClientThreads.getHm();</span><br><span class="line">            Iterator&lt;String&gt; iterator = hm.keySet().iterator();</span><br><span class="line">            <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">                String onLineUserId = iterator.next().toString();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ObjectOutputStream oos</span><br><span class="line">                            = <span class="keyword">new</span> ObjectOutputStream(hm.get(onLineUserId).getSocket().getOutputStream());</span><br><span class="line">                    oos.writeObject(message);</span><br><span class="line">                &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>ServerConnectClientThread</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqserver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ServerConnectClientThread</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¯¥ç±»çš„ä¸€ä¸ªå¯¹è±¡å’ŒæŸä¸ªå®¢æˆ·ç«¯ä¿æŒé€šä¿¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 12:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerConnectClientThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="comment">//è¿æ¥æœåŠ¡ç«¯çš„id</span></span><br><span class="line">    <span class="keyword">private</span> String userId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ServerConnectClientThread</span><span class="params">(Socket socket, String userId)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.socket = socket;</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">getSocket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        label:</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯&quot;</span> + userId + <span class="string">&quot; ä¿æŒé€šä¿¡ï¼Œè¯»å–æ•°æ®ä¸­ï¼&quot;</span>);</span><br><span class="line">                ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">                Message message = (Message) ois.readObject();</span><br><span class="line">                <span class="comment">//åé¢æ ¹æ®MessageTypeçš„ç±»å‹åšç›¸åº”çš„ä¸šåŠ¡å¤„ç†</span></span><br><span class="line">                <span class="keyword">switch</span> (message.getMesType()) &#123;</span><br><span class="line">                    <span class="keyword">case</span> MessageType.MESSAGE_GET_ONLINE_FRIEND: &#123;</span><br><span class="line">                        <span class="comment">//æ˜¾ç¤ºå®¢æˆ·ç«¯åœ¨çº¿åˆ—è¡¨</span></span><br><span class="line">                        System.out.println(message.getSender() + <span class="string">&quot; è¦åœ¨çº¿ç”¨æˆ·åˆ—è¡¨&quot;</span>);</span><br><span class="line">                        String onlineUser = ManageClientThreads.getOnlineUser();</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    è¿”å›message</span></span><br><span class="line"><span class="comment">                    æ„å»ºä¸€ä¸ªMessageå¯¹è±¡ è¿”å›å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                        Message message2 = <span class="keyword">new</span> Message();</span><br><span class="line">                        message2.setMesType(MessageType.MESSAGE_RET_ONLINE_FRIEND);</span><br><span class="line">                        message2.setContent(onlineUser);</span><br><span class="line">                        message2.setGetter(message.getSender());</span><br><span class="line">                        <span class="comment">//è¿”å›ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">                        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line">                        oos.writeObject(message2);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> MessageType.MESSAGE_COMM_MES: &#123;</span><br><span class="line">                        <span class="comment">//æ ¹æ®messageè·å–id ç„¶åå¾—åˆ°å¯¹åº”çº¿ç¨‹</span></span><br><span class="line">                        ServerConnectClientThread serverConnectClientThread</span><br><span class="line">                                = ManageClientThreads.getServerConnectClientThread(message.getGetter());</span><br><span class="line">                        <span class="comment">//å¾—åˆ°å¯¹åº”Socketçš„å¯¹è±¡è¾“å‡ºæµï¼Œå°†messageå¯¹è±¡è½¬å‘ç»™æŒ‡å®šçš„å®¢æˆ·ç«¯</span></span><br><span class="line">                        ObjectOutputStream oos</span><br><span class="line">                                = <span class="keyword">new</span> ObjectOutputStream(serverConnectClientThread.getSocket().getOutputStream());</span><br><span class="line">                        oos.writeObject(message);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> MessageType.MESSAGE_TO_ALL_MES:</span><br><span class="line">                        <span class="comment">//éœ€è¦éå† ç®¡ç†çº¿ç¨‹çš„é›†åˆ æŠŠæ‰€æœ‰çš„çº¿ç¨‹çš„socketå¾—åˆ° å¾—åˆ°æŠŠmessageè¿›è¡Œè½¬å‘å³å¯</span></span><br><span class="line">                        HashMap&lt;String, ServerConnectClientThread&gt; hm = ManageClientThreads.getHm();</span><br><span class="line">                        Iterator&lt;String&gt; iterator = hm.keySet().iterator();</span><br><span class="line">                        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">                            <span class="comment">//å–å‡ºåœ¨çº¿ç”¨æˆ·id</span></span><br><span class="line">                            String onLineUserId = iterator.next().toString();</span><br><span class="line">                            <span class="keyword">if</span> (!onLineUserId.equals(message.getSender())) &#123;</span><br><span class="line">                                <span class="comment">//æ’é™¤ç¾¤å‘æ¶ˆæ¯çš„ç”¨æˆ·</span></span><br><span class="line">                                <span class="comment">//è¿›è¡Œè½¬å‘æ¶ˆæ¯message</span></span><br><span class="line">                                ObjectOutputStream oos</span><br><span class="line">                                        = <span class="keyword">new</span> ObjectOutputStream(hm.get(onLineUserId).getSocket().getOutputStream());</span><br><span class="line">                                oos.writeObject(message);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> MessageType.MESSAGE_FILE_MES: &#123;</span><br><span class="line">                        <span class="comment">//æ ¹æ®getter id è·å–åˆ°å¯¹åº”çš„çº¿ç¨‹ ï¼Œå°†messageå¯¹è±¡è½¬å‘</span></span><br><span class="line">                        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(ManageClientThreads</span><br><span class="line">                                .getServerConnectClientThread(message.getGetter()).getSocket().getOutputStream());</span><br><span class="line">                        <span class="comment">//è½¬å‘</span></span><br><span class="line">                        oos.writeObject(message);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> MessageType.MESSAGE_CLIENT_EXIT:</span><br><span class="line">                        <span class="comment">//å®¢æˆ·ç«¯é€€å‡º</span></span><br><span class="line">                        System.out.println(message.getSender() + <span class="string">&quot; é€€å‡º&quot;</span>);</span><br><span class="line">                        <span class="comment">//è¿™ä¸ªå®¢æˆ·ç«¯ä»å¯¹åº”çº¿ç¨‹åˆ é™¤</span></span><br><span class="line">                        ManageClientThreads.removeServerConnectClientThread(message.getSender());</span><br><span class="line">                        socket.close();</span><br><span class="line">                        <span class="keyword">break</span> label;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        System.out.println(<span class="string">&quot;å…¶ä»–ç±»å‹çš„message,æš‚æ—¶ä¸å¤„ç†&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>QQServer</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqserver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> QQServer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> QQæœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QQServer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ServerSocket ss = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œå­˜æ”¾å¤šä¸ªç”¨æˆ·ï¼Œå¦‚æœæ˜¯è¿™äº›ç”¨æˆ·ç™»å½•ï¼Œå°±è®¤ä¸ºæ˜¯åˆæ³•</span></span><br><span class="line">    <span class="comment">//è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ ConcurrentHashMap, å¯ä»¥å¤„ç†å¹¶å‘çš„é›†åˆï¼Œæ²¡æœ‰çº¿ç¨‹å®‰å…¨</span></span><br><span class="line">    <span class="comment">//HashMap æ²¡æœ‰å¤„ç†çº¿ç¨‹å®‰å…¨ï¼Œå› æ­¤åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹æ˜¯ä¸å®‰å…¨</span></span><br><span class="line">    <span class="comment">//ConcurrentHashMap å¤„ç†çš„çº¿ç¨‹å®‰å…¨,å³çº¿ç¨‹åŒæ­¥å¤„ç†, åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹æ˜¯å®‰å…¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ConcurrentHashMap&lt;String, User&gt; validUsers = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">//private static ConcurrentHashMap&lt;String, ArrayList&lt;Message&gt;&gt; offLineDb = new ConcurrentHashMap&lt;&gt;();</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123; <span class="comment">//åœ¨é™æ€ä»£ç å—ï¼Œåˆå§‹åŒ– validUsers</span></span><br><span class="line"></span><br><span class="line">        validUsers.put(<span class="string">&quot;100&quot;</span>, <span class="keyword">new</span> User(<span class="string">&quot;100&quot;</span>, <span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;200&quot;</span>, <span class="keyword">new</span> User(<span class="string">&quot;200&quot;</span>, <span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;300&quot;</span>, <span class="keyword">new</span> User(<span class="string">&quot;300&quot;</span>, <span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;400&quot;</span>, <span class="keyword">new</span> User(<span class="string">&quot;400&quot;</span>, <span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;500&quot;</span>, <span class="keyword">new</span> User(<span class="string">&quot;500&quot;</span>, <span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;600&quot;</span>, <span class="keyword">new</span> User(<span class="string">&quot;600&quot;</span>, <span class="string">&quot;123456&quot;</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//éªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰æ•ˆçš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkUser</span><span class="params">(String userId, String passwd)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        User user = validUsers.get(userId);</span><br><span class="line">        <span class="comment">//è¿‡å…³çš„éªŒè¯æ–¹å¼</span></span><br><span class="line">        <span class="comment">//è¯´æ˜userIdæ²¡æœ‰å­˜åœ¨validUsers çš„keyä¸­</span></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>  <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//userIdæ­£ç¡®ï¼Œä½†æ˜¯å¯†ç é”™è¯¯</span></span><br><span class="line">        <span class="keyword">if</span>(!user.getPasswd().equals(passwd)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>  <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">QQServer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ³¨æ„ï¼šç«¯å£å¯ä»¥å†™åœ¨é…ç½®æ–‡ä»¶.</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æœåŠ¡ç«¯åœ¨9999ç«¯å£ç›‘å¬...&quot;</span>);</span><br><span class="line">            <span class="comment">//å¯åŠ¨æ¨é€æ–°é—»çš„çº¿ç¨‹</span></span><br><span class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> SendNewsToAllService()).start();</span><br><span class="line">            ss = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">            <span class="comment">//å½“å’ŒæŸä¸ªå®¢æˆ·ç«¯è¿æ¥åï¼Œä¼šç»§ç»­ç›‘å¬, å› æ­¤while</span></span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="comment">//å¦‚æœæ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œå°±ä¼šé˜»å¡åœ¨è¿™é‡Œ</span></span><br><span class="line">                Socket socket = ss.accept();</span><br><span class="line">                <span class="comment">//å¾—åˆ°socketå…³è”çš„å¯¹è±¡è¾“å…¥æµ</span></span><br><span class="line">                ObjectInputStream ois =</span><br><span class="line">                        <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å¾—åˆ°socketå…³è”çš„å¯¹è±¡è¾“å‡ºæµ</span></span><br><span class="line">                ObjectOutputStream oos =</span><br><span class="line">                        <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line"></span><br><span class="line">                <span class="comment">//è¯»å–å®¢æˆ·ç«¯å‘é€çš„Userå¯¹è±¡</span></span><br><span class="line">                User u = (User) ois.readObject();</span><br><span class="line">                <span class="comment">//åˆ›å»ºä¸€ä¸ªMessageå¯¹è±¡ï¼Œå‡†å¤‡å›å¤å®¢æˆ·ç«¯</span></span><br><span class="line">                Message message = <span class="keyword">new</span> Message();</span><br><span class="line">                <span class="comment">//éªŒè¯ç”¨æˆ· æ–¹æ³•</span></span><br><span class="line">                <span class="comment">//ç™»å½•é€šè¿‡</span></span><br><span class="line">                <span class="keyword">if</span> (checkUser(u.getUserId(), u.getPasswd())) &#123;</span><br><span class="line">                    message.setMesType(MessageType.MESSAGE_LOGIN_SUCCEED);</span><br><span class="line">                    <span class="comment">//å°†messageå¯¹è±¡å›å¤å®¢æˆ·ç«¯</span></span><br><span class="line">                    oos.writeObject(message);</span><br><span class="line">                    <span class="comment">//åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå’Œå®¢æˆ·ç«¯ä¿æŒé€šä¿¡, è¯¥çº¿ç¨‹éœ€è¦æŒæœ‰socketå¯¹è±¡</span></span><br><span class="line">                    ServerConnectClientThread serverConnectClientThread =</span><br><span class="line">                            <span class="keyword">new</span> ServerConnectClientThread(socket, u.getUserId());</span><br><span class="line">                    <span class="comment">//å¯åŠ¨è¯¥çº¿ç¨‹</span></span><br><span class="line">                    serverConnectClientThread.start();</span><br><span class="line">                    <span class="comment">//æŠŠè¯¥çº¿ç¨‹å¯¹è±¡ï¼Œæ”¾å…¥åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œè¿›è¡Œç®¡ç†.</span></span><br><span class="line">                    ManageClientThreads.addClientThread(u.getUserId(), serverConnectClientThread);</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123; <span class="comment">// ç™»å½•å¤±è´¥</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;ç”¨æˆ· id=&quot;</span> + u.getUserId() + <span class="string">&quot; pwd=&quot;</span> + u.getPasswd() + <span class="string">&quot; éªŒè¯å¤±è´¥&quot;</span>);</span><br><span class="line">                    message.setMesType(MessageType.MESSAGE_LOGIN_FAIL);</span><br><span class="line">                    oos.writeObject(message);</span><br><span class="line">                    <span class="comment">//å…³é—­socket</span></span><br><span class="line">                    socket.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœæœåŠ¡å™¨é€€å‡ºäº†whileï¼Œè¯´æ˜æœåŠ¡å™¨ç«¯ä¸åœ¨ç›‘å¬ï¼Œå› æ­¤å…³é—­ServerSocket</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">assert</span> ss != <span class="keyword">null</span>;</span><br><span class="line">                ss.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>QQFrame</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQServe.qqframe;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqserver.QQServer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> QQFrame</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¯¥ç±»åˆ›å»ºQQServer ,å¯åŠ¨åå°çš„æœåŠ¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QQFrame</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> QQServer();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7-4-2-QQClient"><a href="#7-4-2-QQClient" class="headerlink" title="7.4.2 QQClient"></a>7.4.2 QQClient</h3><p><strong>UserClientService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQClient.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> UserClientService</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¯¥ç±»å®Œæˆç”¨æˆ·ç™»å½•éªŒè¯å’Œç”¨æˆ·æ³¨å†Œç­‰åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserClientService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å› ä¸ºæˆ‘ä»¬å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹ç”¨ä½¿ç”¨userä¿¡æ¯, å› æ­¤ä½œå‡ºæˆå‘˜å±æ€§</span></span><br><span class="line">    <span class="keyword">private</span> User u = <span class="keyword">new</span> User();</span><br><span class="line">    <span class="comment">//å› ä¸ºSocketåœ¨å…¶å®ƒåœ°æ–¹ä¹Ÿå¯èƒ½ä½¿ç”¨ï¼Œå› æ­¤ä½œå‡ºå±æ€§</span></span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®userId å’Œ pwd åˆ°æœåŠ¡å™¨éªŒè¯è¯¥ç”¨æˆ·æ˜¯å¦åˆæ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkUser</span><span class="params">(String userId, String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> b = <span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">//åˆ›å»ºUserå¯¹è±¡</span></span><br><span class="line">        u.setUserId(userId);</span><br><span class="line">        u.setPasswd(pwd);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//è¿æ¥åˆ°æœåŠ¡ç«¯ï¼Œå‘é€uå¯¹è±¡</span></span><br><span class="line">            socket = <span class="keyword">new</span> Socket(InetAddress.getByName(<span class="string">&quot;127.0.0.1&quot;</span>), <span class="number">9999</span>);</span><br><span class="line">            <span class="comment">//å¾—åˆ°ObjectOutputStreamå¯¹è±¡</span></span><br><span class="line">            ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line">            <span class="comment">//å‘é€Userå¯¹è±¡</span></span><br><span class="line">            oos.writeObject(u);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//è¯»å–ä»æœåŠ¡å™¨å›å¤çš„Messageå¯¹è±¡</span></span><br><span class="line">            ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">            Message ms = (Message) ois.readObject();</span><br><span class="line">            <span class="comment">//ç™»å½•OK</span></span><br><span class="line">            <span class="keyword">if</span> (ms.getMesType().equals(MessageType.MESSAGE_LOGIN_SUCCEED)) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="comment">//åˆ›å»ºä¸€ä¸ªå’ŒæœåŠ¡å™¨ç«¯ä¿æŒé€šä¿¡çš„çº¿ç¨‹-&gt; åˆ›å»ºä¸€ä¸ªç±» ClientConnectServerThread</span></span><br><span class="line">                ClientConnectServerThread clientConnectServerThread =</span><br><span class="line">                        <span class="keyword">new</span> ClientConnectServerThread(socket);</span><br><span class="line">                <span class="comment">//å¯åŠ¨å®¢æˆ·ç«¯çš„çº¿ç¨‹</span></span><br><span class="line">                clientConnectServerThread.start();</span><br><span class="line">                <span class="comment">//è¿™é‡Œä¸ºäº†åé¢å®¢æˆ·ç«¯çš„æ‰©å±•ï¼Œæˆ‘ä»¬å°†çº¿ç¨‹æ”¾å…¥åˆ°é›†åˆç®¡ç†</span></span><br><span class="line">                ManageClientConnectServerThread.addClientConnectServerThread(userId, clientConnectServerThread);</span><br><span class="line">                b = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//å¦‚æœç™»å½•å¤±è´¥, æˆ‘ä»¬å°±ä¸èƒ½å¯åŠ¨å’ŒæœåŠ¡å™¨é€šä¿¡çš„çº¿ç¨‹, å…³é—­socket</span></span><br><span class="line">                socket.close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘æœåŠ¡å™¨ç«¯è¯·æ±‚åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onlineFriendList</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€ä¸€ä¸ªMessage , ç±»å‹MESSAGE_GET_ONLINE_FRIEND</span></span><br><span class="line">        Message message = <span class="keyword">new</span> Message();</span><br><span class="line">        message.setMesType(MessageType.MESSAGE_GET_ONLINE_FRIEND);</span><br><span class="line">        message.setSender(u.getUserId());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€ç»™æœåŠ¡å™¨</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//ä»ç®¡ç†çº¿ç¨‹çš„é›†åˆä¸­ï¼Œé€šè¿‡userId, å¾—åˆ°è¿™ä¸ªçº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">            ClientConnectServerThread clientConnectServerThread =</span><br><span class="line">                    ManageClientConnectServerThread.getClientConnectServerThread(u.getUserId());</span><br><span class="line">            <span class="comment">//é€šè¿‡è¿™ä¸ªçº¿ç¨‹å¾—åˆ°å…³è”çš„socket</span></span><br><span class="line">            Socket socket = clientConnectServerThread.getSocket();</span><br><span class="line">            <span class="comment">//å¾—åˆ°å½“å‰çº¿ç¨‹çš„Socket å¯¹åº”çš„ ObjectOutputStreamå¯¹è±¡</span></span><br><span class="line">            ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line">            <span class="comment">//å‘é€ä¸€ä¸ªMessageå¯¹è±¡ï¼Œå‘æœåŠ¡ç«¯è¦æ±‚åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¼–å†™æ–¹æ³•ï¼Œé€€å‡ºå®¢æˆ·ç«¯ï¼Œå¹¶ç»™æœåŠ¡ç«¯å‘é€ä¸€ä¸ªé€€å‡ºç³»ç»Ÿçš„messageå¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">logout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Message message = <span class="keyword">new</span> Message();</span><br><span class="line">        message.setMesType(MessageType.MESSAGE_CLIENT_EXIT);</span><br><span class="line">        <span class="comment">//ä¸€å®šè¦æŒ‡å®šæˆ‘æ˜¯å“ªä¸ªå®¢æˆ·ç«¯id</span></span><br><span class="line">        message.setSender(u.getUserId());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€message</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ObjectOutputStream oos =</span><br><span class="line">                    <span class="keyword">new</span> ObjectOutputStream(ManageClientConnectServerThread.getClientConnectServerThread(u.getUserId()).getSocket().getOutputStream());</span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">            System.out.println(u.getUserId() + <span class="string">&quot; é€€å‡ºç³»ç»Ÿ &quot;</span>);</span><br><span class="line">            <span class="comment">//ç»“æŸè¿›ç¨‹</span></span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MessageClientService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQClient.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MessageClientService</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç§èŠå®ç°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageClientService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content  å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> senderId å‘é€è€…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessageToAll</span><span class="params">(String content, String senderId)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ„å»ºmessage</span></span><br><span class="line">        Message message = <span class="keyword">new</span> Message();</span><br><span class="line">        message.setMesType(MessageType.MESSAGE_TO_ALL_MES);<span class="comment">//ç¾¤å‘æ¶ˆæ¯è¿™ç§ç±»å‹</span></span><br><span class="line">        message.setSender(senderId);</span><br><span class="line">        message.setContent(content);</span><br><span class="line">        message.setSendTime(<span class="keyword">new</span> Date().toString());<span class="comment">//å‘é€æ—¶é—´è®¾ç½®åˆ°messageå¯¹è±¡</span></span><br><span class="line">        System.out.println(senderId + <span class="string">&quot; å¯¹å¤§å®¶è¯´ &quot;</span> + content);</span><br><span class="line">        <span class="comment">//å‘é€ç»™æœåŠ¡ç«¯</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ObjectOutputStream oos =</span><br><span class="line">                    <span class="keyword">new</span> ObjectOutputStream(ManageClientConnectServerThread.getClientConnectServerThread(senderId).getSocket().getOutputStream());</span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content  å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> senderId å‘é€ç”¨æˆ·id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> getterId æ¥æ”¶ç”¨æˆ·id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessageToOne</span><span class="params">(String content, String senderId, String getterId)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ„å»ºmessage</span></span><br><span class="line">        Message message = <span class="keyword">new</span> Message();</span><br><span class="line">        <span class="comment">//æ™®é€šçš„èŠå¤©æ¶ˆæ¯è¿™ç§ç±»å‹</span></span><br><span class="line">        message.setMesType(MessageType.MESSAGE_COMM_MES);</span><br><span class="line">        message.setSender(senderId);</span><br><span class="line">        message.setGetter(getterId);</span><br><span class="line">        message.setContent(content);</span><br><span class="line">        <span class="comment">//å‘é€æ—¶é—´è®¾ç½®åˆ°messageå¯¹è±¡</span></span><br><span class="line">        message.setSendTime(<span class="keyword">new</span> Date().toString());</span><br><span class="line">        System.out.println(senderId + <span class="string">&quot; å¯¹ &quot;</span> + getterId + <span class="string">&quot; è¯´ &quot;</span> + content);</span><br><span class="line">        <span class="comment">//å‘é€ç»™æœåŠ¡ç«¯</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ObjectOutputStream oos =</span><br><span class="line">                    <span class="keyword">new</span> ObjectOutputStream(ManageClientConnectServerThread.getClientConnectServerThread(senderId).getSocket().getOutputStream());</span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>FileClientService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQClient.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileClientService</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ–‡ä»¶ä¼ è¾“ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileClientService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> src      æºæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dest     æŠŠè¯¥æ–‡ä»¶ä¼ è¾“åˆ°å¯¹æ–¹çš„å“ªä¸ªç›®å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> senderId å‘é€ç”¨æˆ·id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> getterId æ¥æ”¶ç”¨æˆ·id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendFileToOne</span><span class="params">(String src, String dest, String senderId, String getterId)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¯»å–srcæ–‡ä»¶  --&gt;  message</span></span><br><span class="line">        Message message = <span class="keyword">new</span> Message();</span><br><span class="line">        message.setMesType(MessageType.MESSAGE_FILE_MES);</span><br><span class="line">        message.setSender(senderId);</span><br><span class="line">        message.setGetter(getterId);</span><br><span class="line">        message.setSrc(src);</span><br><span class="line">        message.setDest(dest);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//éœ€è¦å°†æ–‡ä»¶è¯»å–</span></span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//è·å–æ–‡ä»¶çš„é•¿åº¦ å†™å…¥å­—èŠ‚æ•°ç»„ä¸­</span></span><br><span class="line">        <span class="keyword">byte</span>[] fileBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[(<span class="keyword">int</span>) <span class="keyword">new</span> File(src).length()];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileInputStream = <span class="keyword">new</span> FileInputStream(src);</span><br><span class="line">            <span class="comment">//å°†srcæ–‡ä»¶è¯»å…¥åˆ°ç¨‹åºçš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line">            fileInputStream.read(fileBytes);</span><br><span class="line">            <span class="comment">//å°†æ–‡ä»¶å¯¹åº”çš„å­—èŠ‚æ•°ç»„è®¾ç½®message</span></span><br><span class="line">            message.setFileBytes(fileBytes);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            <span class="keyword">if</span> (fileInputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fileInputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æç¤ºä¿¡æ¯</span></span><br><span class="line">        System.out.println(<span class="string">&quot;\n&quot;</span> + senderId + <span class="string">&quot; ç»™ &quot;</span> + getterId + <span class="string">&quot; å‘é€æ–‡ä»¶: &quot;</span> + src</span><br><span class="line">                + <span class="string">&quot; åˆ°å¯¹æ–¹çš„ç”µè„‘çš„ç›®å½• &quot;</span> + dest);</span><br><span class="line">        <span class="comment">//å‘é€</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ObjectOutputStream oos =</span><br><span class="line">                    <span class="keyword">new</span> ObjectOutputStream(ManageClientConnectServerThread.getClientConnectServerThread(senderId).getSocket().getOutputStream());</span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ClientConnectServerThread</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQClient.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.qqcommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ClientConnectServerThread</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientConnectServerThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¯¥çº¿ç¨‹éœ€è¦æŒæœ‰Socket</span></span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ„é€ å™¨å¯ä»¥æ¥å—ä¸€ä¸ªSocketå¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClientConnectServerThread</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.socket = socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å› ä¸ºThreadéœ€è¦åœ¨åå°å’ŒæœåŠ¡å™¨é€šä¿¡ï¼Œå› æ­¤æˆ‘ä»¬whileå¾ªç¯</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯çº¿ç¨‹ï¼Œç­‰å¾…ä»è¯»å–ä»æœåŠ¡å™¨ç«¯å‘é€çš„æ¶ˆæ¯&quot;</span>);</span><br><span class="line">                ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">                <span class="comment">//å¦‚æœæœåŠ¡å™¨æ²¡æœ‰å‘é€Messageå¯¹è±¡,çº¿ç¨‹ä¼šé˜»å¡åœ¨è¿™é‡Œ</span></span><br><span class="line">                Message message = (Message) ois.readObject();</span><br><span class="line">                <span class="comment">//æ³¨æ„ï¼Œåé¢æˆ‘ä»¬éœ€è¦å»ä½¿ç”¨message</span></span><br><span class="line">                <span class="comment">//åˆ¤æ–­è¿™ä¸ªmessageç±»å‹ï¼Œç„¶ååšç›¸åº”çš„ä¸šåŠ¡å¤„ç†</span></span><br><span class="line">                <span class="comment">//å¦‚æœæ˜¯è¯»å–åˆ°çš„æ˜¯ æœåŠ¡ç«¯è¿”å›çš„åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">                <span class="keyword">if</span> (message.getMesType().equals(MessageType.MESSAGE_RET_ONLINE_FRIEND)) &#123;</span><br><span class="line">                    <span class="comment">//å–å‡ºåœ¨çº¿åˆ—è¡¨ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤º</span></span><br><span class="line">                    <span class="comment">//è§„å®š</span></span><br><span class="line">                    String[] onlineUsers = message.getContent().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;\n=======å½“å‰åœ¨çº¿ç”¨æˆ·åˆ—è¡¨========&quot;</span>);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; onlineUsers.length; i++) &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;ç”¨æˆ·: &quot;</span> + onlineUsers[i]);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message.getMesType().equals(MessageType.MESSAGE_COMM_MES)) &#123;<span class="comment">//æ™®é€šçš„èŠå¤©æ¶ˆæ¯</span></span><br><span class="line">                    <span class="comment">//æŠŠä»æœåŠ¡å™¨è½¬å‘çš„æ¶ˆæ¯ï¼Œæ˜¾ç¤ºåˆ°æ§åˆ¶å°å³å¯</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;\n&quot;</span> + message.getSender()</span><br><span class="line">                            + <span class="string">&quot; å¯¹ &quot;</span> + message.getGetter() + <span class="string">&quot; è¯´: &quot;</span> + message.getContent());</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message.getMesType().equals(MessageType.MESSAGE_TO_ALL_MES)) &#123;</span><br><span class="line">                    <span class="comment">//æ˜¾ç¤ºåœ¨å®¢æˆ·ç«¯çš„æ§åˆ¶å°</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;\n&quot;</span> + message.getSender() + <span class="string">&quot; å¯¹å¤§å®¶è¯´: &quot;</span> + message.getContent());</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message.getMesType().equals(MessageType.MESSAGE_FILE_MES)) &#123;<span class="comment">//å¦‚æœæ˜¯æ–‡ä»¶æ¶ˆæ¯</span></span><br><span class="line">                    <span class="comment">//è®©ç”¨æˆ·æŒ‡å®šä¿å­˜è·¯å¾„ã€‚ã€‚ã€‚</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;\n&quot;</span> + message.getSender() + <span class="string">&quot; ç»™ &quot;</span> + message.getGetter()</span><br><span class="line">                            + <span class="string">&quot; å‘æ–‡ä»¶: &quot;</span> + message.getSrc() + <span class="string">&quot; åˆ°æˆ‘çš„ç”µè„‘çš„ç›®å½• &quot;</span> + message.getDest());</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//å–å‡ºmessageçš„æ–‡ä»¶å­—èŠ‚æ•°ç»„ï¼Œé€šè¿‡æ–‡ä»¶è¾“å‡ºæµå†™å‡ºåˆ°ç£ç›˜</span></span><br><span class="line">                    FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(message.getDest(), <span class="keyword">true</span>);</span><br><span class="line">                    fileOutputStream.write(message.getFileBytes());</span><br><span class="line">                    fileOutputStream.close();</span><br><span class="line">                    System.out.println(<span class="string">&quot;\n ä¿å­˜æ–‡ä»¶æˆåŠŸ~&quot;</span>);</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ˜¯å…¶ä»–ç±»å‹çš„message, æš‚æ—¶ä¸å¤„ç†....&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ºäº†æ›´æ–¹ä¾¿çš„å¾—åˆ°Socket</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">getSocket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ManageClientConnectServerThread</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQClient.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ManageClientConnectServerThread</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> çº¿ç¨‹å®¢æˆ·ç«¯ç®¡ç†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ManageClientConnectServerThread</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æˆ‘ä»¬æŠŠå¤šä¸ªçº¿ç¨‹æ”¾å…¥ä¸€ä¸ªHashMapé›†åˆï¼Œkey å°±æ˜¯ç”¨æˆ·id, value å°±æ˜¯çº¿ç¨‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, ClientConnectServerThread&gt; hm = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°†æŸä¸ªçº¿ç¨‹åŠ å…¥åˆ°é›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addClientConnectServerThread</span><span class="params">(String userId, ClientConnectServerThread clientConnectServerThread)</span> </span>&#123;</span><br><span class="line">        hm.put(userId, clientConnectServerThread);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//é€šè¿‡userId å¯ä»¥å¾—åˆ°å¯¹åº”çº¿ç¨‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ClientConnectServerThread <span class="title">getClientConnectServerThread</span><span class="params">(String userId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hm.get(userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>QQView</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.Intelnet.QQClient.views;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQClient.service.FileClientService;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQClient.service.MessageClientService;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQClient.service.UserClientService;</span><br><span class="line"><span class="keyword">import</span> com.zhuang.Intelnet.QQServe.utils.Utility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> QQView</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> QQå®¢æˆ·ç«¯å¯åŠ¨ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/6/8 14:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QQView</span> </span>&#123;</span><br><span class="line">     <span class="comment">//æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºèœå•</span></span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">boolean</span> loop = <span class="keyword">true</span>;</span><br><span class="line">    <span class="comment">// æ¥æ”¶ç”¨æˆ·çš„é”®ç›˜è¾“å…¥</span></span><br><span class="line">    <span class="keyword">private</span> String key = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">//å¯¹è±¡æ˜¯ç”¨äºç™»å½•æœåŠ¡/æ³¨å†Œç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">private</span> UserClientService userClientService = <span class="keyword">new</span> UserClientService();</span><br><span class="line">    <span class="comment">//å¯¹è±¡ç”¨æˆ·ç§èŠ/ç¾¤èŠ.</span></span><br><span class="line">    <span class="keyword">private</span> MessageClientService messageClientService = <span class="keyword">new</span> MessageClientService();</span><br><span class="line">    <span class="comment">//è¯¥å¯¹è±¡ç”¨æˆ·ä¼ è¾“æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">private</span> FileClientService fileClientService = <span class="keyword">new</span> FileClientService();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> QQView().mainMenu();</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯é€€å‡ºç³»ç»Ÿ.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ˜¾ç¤ºä¸»èœå•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">mainMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (loop) &#123;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;===========æ¬¢è¿ç™»å½•ç½‘ç»œé€šä¿¡ç³»ç»Ÿ===========&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t 1 ç™»å½•ç³»ç»Ÿ&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t 9 é€€å‡ºç³»ç»Ÿ&quot;</span>);</span><br><span class="line">            System.out.print(<span class="string">&quot;è¯·è¾“å…¥ä½ çš„é€‰æ‹©: &quot;</span>);</span><br><span class="line">            key = Utility.readString(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ ¹æ®ç”¨æˆ·çš„è¾“å…¥ï¼Œæ¥å¤„ç†ä¸åŒçš„é€»è¾‘</span></span><br><span class="line">            <span class="keyword">switch</span> (key) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                    System.out.print(<span class="string">&quot;è¯·è¾“å…¥ç”¨æˆ·å·: &quot;</span>);</span><br><span class="line">                    String userId = Utility.readString(<span class="number">50</span>);</span><br><span class="line">                    System.out.print(<span class="string">&quot;è¯·è¾“å…¥å¯†  ç : &quot;</span>);</span><br><span class="line">                    String pwd = Utility.readString(<span class="number">50</span>);</span><br><span class="line">                    <span class="comment">//éœ€è¦åˆ°æœåŠ¡ç«¯å»éªŒè¯è¯¥ç”¨æˆ·æ˜¯å¦åˆæ³•</span></span><br><span class="line">                    <span class="keyword">if</span> (userClientService.checkUser(userId, pwd)) &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;===========æ¬¢è¿ (ç”¨æˆ· &quot;</span> + userId + <span class="string">&quot; ç™»å½•æˆåŠŸ) ===========&quot;</span>);</span><br><span class="line">                        <span class="comment">//è¿›å…¥åˆ°äºŒçº§èœå•</span></span><br><span class="line">                        <span class="keyword">while</span> (loop) &#123;</span><br><span class="line">                            System.out.println(<span class="string">&quot;\n=========ç½‘ç»œé€šä¿¡ç³»ç»ŸäºŒçº§èœå•(ç”¨æˆ· &quot;</span> + userId + <span class="string">&quot; )=======&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 1 æ˜¾ç¤ºåœ¨çº¿ç”¨æˆ·åˆ—è¡¨&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 2 ç¾¤å‘æ¶ˆæ¯&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 3 ç§èŠæ¶ˆæ¯&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 4 å‘é€æ–‡ä»¶&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 9 é€€å‡ºç³»ç»Ÿ&quot;</span>);</span><br><span class="line">                            System.out.print(<span class="string">&quot;è¯·è¾“å…¥ä½ çš„é€‰æ‹©: &quot;</span>);</span><br><span class="line">                            key = Utility.readString(<span class="number">1</span>);</span><br><span class="line">                            <span class="keyword">switch</span> (key) &#123;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                                    <span class="comment">//å†™ä¸€ä¸ªæ–¹æ³•ï¼Œæ¥è·å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">                                    userClientService.onlineFriendList();</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line">                                    System.out.println(<span class="string">&quot;è¯·è¾“å…¥æƒ³å¯¹å¤§å®¶è¯´çš„è¯: &quot;</span>);</span><br><span class="line">                                    String s = Utility.readString(<span class="number">100</span>);</span><br><span class="line">                                    messageClientService.sendMessageToAll(s, userId);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;3&quot;</span>:</span><br><span class="line">                                    System.out.print(<span class="string">&quot;è¯·è¾“å…¥æƒ³èŠå¤©çš„ç”¨æˆ·å·(åœ¨çº¿): &quot;</span>);</span><br><span class="line">                                    String getterId = Utility.readString(<span class="number">50</span>);</span><br><span class="line">                                    System.out.print(<span class="string">&quot;è¯·è¾“å…¥æƒ³è¯´çš„è¯: &quot;</span>);</span><br><span class="line">                                    String content = Utility.readString(<span class="number">100</span>);</span><br><span class="line">                                    <span class="comment">//ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œå°†æ¶ˆæ¯å‘é€ç»™æœåŠ¡å™¨ç«¯</span></span><br><span class="line">                                    messageClientService.sendMessageToOne(content, userId, getterId);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;4&quot;</span>:</span><br><span class="line">                                    System.out.print(<span class="string">&quot;è¯·è¾“å…¥ä½ æƒ³æŠŠæ–‡ä»¶å‘é€ç»™çš„ç”¨æˆ·(åœ¨çº¿ç”¨æˆ·): &quot;</span>);</span><br><span class="line">                                    getterId = Utility.readString(<span class="number">50</span>);</span><br><span class="line">                                    System.out.print(<span class="string">&quot;è¯·è¾“å…¥å‘é€æ–‡ä»¶çš„è·¯å¾„(å½¢å¼ d:\\xx.jpg)&quot;</span>);</span><br><span class="line">                                    String src = Utility.readString(<span class="number">100</span>);</span><br><span class="line">                                    System.out.print(<span class="string">&quot;è¯·è¾“å…¥æŠŠæ–‡ä»¶å‘é€åˆ°å¯¹åº”çš„è·¯å¾„(å½¢å¼ d:\\yy.jpg)&quot;</span>);</span><br><span class="line">                                    String dest = Utility.readString(<span class="number">100</span>);</span><br><span class="line">                                    fileClientService.sendFileToOne(src,dest,userId,getterId);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;9&quot;</span>:</span><br><span class="line">                                    <span class="comment">//è°ƒç”¨æ–¹æ³•ï¼Œç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªé€€å‡ºç³»ç»Ÿçš„message</span></span><br><span class="line">                                    userClientService.logout();</span><br><span class="line">                                    loop = <span class="keyword">false</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123; <span class="comment">//ç™»å½•æœåŠ¡å™¨å¤±è´¥</span></span><br><span class="line">                        System.out.println(<span class="string">&quot;=========ç™»å½•å¤±è´¥=========&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;9&quot;</span>:</span><br><span class="line">                    loop = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-3-ç®€å•æµ‹è¯•ä¸€ä¸‹"><a href="#7-4-3-ç®€å•æµ‹è¯•ä¸€ä¸‹" class="headerlink" title="7.4.3 ç®€å•æµ‹è¯•ä¸€ä¸‹"></a>7.4.3 ç®€å•æµ‹è¯•ä¸€ä¸‹</h3><p><a href="https://imgtu.com/i/2y3neA"><img src="https://z3.ax1x.com/2021/06/09/2y3neA.png" alt="2y3neA.png"></a><br><a href="https://imgtu.com/i/2y3udI"><img src="https://z3.ax1x.com/2021/06/09/2y3udI.png" alt="2y3udI.png"></a><br><a href="https://imgtu.com/i/2y3eLd"><img src="https://z3.ax1x.com/2021/06/09/2y3eLd.png" alt="2y3eLd.png"></a></p>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li>ç½‘ç»œç¼–ç¨‹æœ‰éš¾åº¦ï¼Œè¿˜éœ€è¦å¤šåå¤å·©å›º</li>
<li>åŸºç¡€è¦æ‰å®ï¼Œé¡¹ç›®æ‰èƒ½ç†Ÿç»ƒ</li>
</ul>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaIOæµå­¦ä¹ ç¬”è®°</title>
    <url>/2021/01/08/JavaIO%E6%B5%81%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="JavaIOæµå­¦ä¹ ç¬”è®°"><a href="#JavaIOæµå­¦ä¹ ç¬”è®°" class="headerlink" title="JavaIOæµå­¦ä¹ ç¬”è®°"></a>JavaIOæµå­¦ä¹ ç¬”è®°</h1><p><strong>å†™åœ¨å‰é¢</strong></p>
<p><strong>å­¦ä¹ åœ°å€ï¼š</strong></p>
<p><a href="https://www.bilibili.com/video/BV15B4y1u7Rn">ã€éŸ©é¡ºå¹³è®²Javaã€‘Java IOæµä¸“é¢˜</a></p>
<p><strong>æ„Ÿè°¢éŸ©è€å¸ˆçš„è®²è§£è§†é¢‘ï¼Œååˆ†æ„Ÿè°¢ï¼ï¼ï¼</strong></p>
<p><strong>å…ˆä¸Šæ€ç»´å¯¼å›¾</strong></p>
<p><strong>æµçš„åˆ†ç±»ä¸€è§ˆ</strong></p>
<p><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/mind.jpg" alt="mind"></p>
<h1 id="1-æ–‡ä»¶çš„åŸºæœ¬æ¦‚å¿µ"><a href="#1-æ–‡ä»¶çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1. æ–‡ä»¶çš„åŸºæœ¬æ¦‚å¿µ"></a>1. æ–‡ä»¶çš„åŸºæœ¬æ¦‚å¿µ</h1><h2 id="1-1-æ–‡ä»¶æµ"><a href="#1-1-æ–‡ä»¶æµ" class="headerlink" title="1.1 æ–‡ä»¶æµ"></a>1.1 æ–‡ä»¶æµ</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-30-42.png"></p>
<h1 id="2-åˆ›å»ºæ–‡ä»¶"><a href="#2-åˆ›å»ºæ–‡ä»¶" class="headerlink" title="2. åˆ›å»ºæ–‡ä»¶"></a>2. åˆ›å»ºæ–‡ä»¶</h1><h2 id="2-1é€šè¿‡ä¸‰ä¸ªæ–¹æ³•åˆ›å»ºæ–‡ä»¶"><a href="#2-1é€šè¿‡ä¸‰ä¸ªæ–¹æ³•åˆ›å»ºæ–‡ä»¶" class="headerlink" title="2.1é€šè¿‡ä¸‰ä¸ªæ–¹æ³•åˆ›å»ºæ–‡ä»¶"></a>2.1é€šè¿‡ä¸‰ä¸ªæ–¹æ³•åˆ›å»ºæ–‡ä»¶</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileCreate</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºåˆ›å»ºæ–‡ä»¶çš„3ç§æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 19:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileCreate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      <span class="comment">//  create01();</span></span><br><span class="line">        create03();</span><br><span class="line">      <span class="comment">//  create02();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹å¼1 new File(String pathname)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">create01</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\a.txt&quot;</span>;</span><br><span class="line">        File file = <span class="keyword">new</span> File(filePath);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            file.createNewFile();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–‡ä»¶åˆ›å»ºæˆåŠŸï¼&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–‡ä»¶åˆ›å»ºå¤±è´¥ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">////æ–¹å¼ 2 new File(File parent,String child) //æ ¹æ®çˆ¶ç›®å½•æ–‡ä»¶+å­è·¯å¾„æ„å»º</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">create02</span><span class="params">()</span></span>&#123;</span><br><span class="line">        File parentFile = <span class="keyword">new</span> File(<span class="string">&quot;f:\\&quot;</span>);</span><br><span class="line">        String fileName=<span class="string">&quot;b.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">        File file = <span class="keyword">new</span> File(parentFile, fileName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            file.createNewFile();</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆ›å»ºæˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆ›å»ºå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ–¹å¼ 3 new File(String parent,String child) //æ ¹æ®çˆ¶ç›®å½•+å­è·¯å¾„æ„å»º</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">create03</span><span class="params">()</span></span>&#123;</span><br><span class="line">        File parentPath = <span class="keyword">new</span> File(<span class="string">&quot;f:\\&quot;</span>);</span><br><span class="line">        String fileName=<span class="string">&quot;c.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">        File file = <span class="keyword">new</span> File(parentPath, fileName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            file.createNewFile();</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆ›å»ºæˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆ›å»ºå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-è·å–æ–‡ä»¶çš„ä¿¡æ¯"><a href="#2-2-è·å–æ–‡ä»¶çš„ä¿¡æ¯" class="headerlink" title="2.2 è·å–æ–‡ä»¶çš„ä¿¡æ¯"></a>2.2 è·å–æ–‡ä»¶çš„ä¿¡æ¯</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-35-33.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileInformation</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è·å–æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 19:57</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileInformation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        info();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">info</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å…ˆåˆ›å»ºæ–‡ä»¶å¯¹è±¡</span></span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">&quot;f:\\a.txt&quot;</span>);</span><br><span class="line">        <span class="comment">//è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ï¼Œå¾—åˆ°å¯¹åº”ä¿¡æ¯</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶åå­—=&quot;</span> + file.getName());</span><br><span class="line">        <span class="comment">//getNameã€getAbsolutePathã€getParentã€lengthã€existsã€isFileã€isDirectory</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶ç»å¯¹è·¯å¾„=&quot;</span> + file.getAbsolutePath());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶çˆ¶çº§ç›®å½•=&quot;</span> + file.getParent());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶å¤§å°(å­—èŠ‚)=&quot;</span> + file.length());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶æ˜¯å¦å­˜åœ¨=&quot;</span> + file.exists());<span class="comment">//T</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶=&quot;</span> + file.isFile());<span class="comment">//T</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯ä¸æ˜¯ä¸€ä¸ªç›®å½•=&quot;</span> + file.isDirectory());<span class="comment">//F</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3-IOæµåŸç†åŠæµçš„åˆ†ç±»"><a href="#3-IOæµåŸç†åŠæµçš„åˆ†ç±»" class="headerlink" title="3. IOæµåŸç†åŠæµçš„åˆ†ç±»"></a>3. IOæµåŸç†åŠæµçš„åˆ†ç±»</h1><h2 id="3-1-JavaIOæµåŸç†"><a href="#3-1-JavaIOæµåŸç†" class="headerlink" title="3.1 JavaIOæµåŸç†"></a>3.1 JavaIOæµåŸç†</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-38-26.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-38-42.png" alt="Snipaste_2021-05-29_21-38-42"></p>
<h2 id="3-2-æµçš„åˆ†ç±»"><a href="#3-2-æµçš„åˆ†ç±»" class="headerlink" title="3.2 æµçš„åˆ†ç±»"></a>3.2 æµçš„åˆ†ç±»</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-39-06.png"></p>
<h1 id="4-IOæµä½“ç³»å›¾-å¸¸ç”¨çš„ç±»"><a href="#4-IOæµä½“ç³»å›¾-å¸¸ç”¨çš„ç±»" class="headerlink" title="4. IOæµä½“ç³»å›¾-å¸¸ç”¨çš„ç±»"></a>4. IOæµä½“ç³»å›¾-å¸¸ç”¨çš„ç±»</h1><h1 id="5-FileInputStream"><a href="#5-FileInputStream" class="headerlink" title="5.FileInputStream"></a>5.FileInputStream</h1><p>FileInputStream è¯»å– a.txt æ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileInputStream_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤º FileInputStream çš„ä½¿ç”¨(å­—èŠ‚è¾“å…¥æµ æ–‡ä»¶--&gt; ç¨‹åº)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 20:01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileInputStream_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//  readFile01();</span></span><br><span class="line">        readFile02();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readFile01</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\a.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> readData = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//åˆ›å»ºfileInputStreamå¯¹è±¡ ç”¨äºè¯»å–æ–‡ä»¶</span></span><br><span class="line">            fileInputStream = <span class="keyword">new</span> FileInputStream(filePath);</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            ä»è¯¥è¾“å…¥æµè¯»å–ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰è¾“å…¥å¯ç”¨ï¼Œè¿”å›-1 è¡¨ç¤ºè¯»å–å®Œæ¯•</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">while</span> ((readData = fileInputStream.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                System.out.print((<span class="keyword">char</span>) readData);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            fileInputStream.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨ read(byte[] b) è¯»å–æ–‡ä»¶ï¼Œæé«˜æ•ˆç‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readFile02</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String filePath = <span class="string">&quot;f:\\a.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> readData = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileInputStream = <span class="keyword">new</span> FileInputStream(filePath);</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            ä»è¾“å…¥æµæœ€å¤šè¯»å–b.lengthå­—èŠ‚çš„æ•°æ®åˆ°å­—èŠ‚æ•°ç»„  è¿”å›-1 è¯»å–å®Œæ¯•</span></span><br><span class="line"><span class="comment">            è¯»å–æ­£å¸¸ è¿”å›å®é™…è¯»å–çš„å­—èŠ‚æ•°</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">while</span> ((readData = fileInputStream.read(buf)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                System.out.print(<span class="keyword">new</span> String(buf, <span class="number">0</span>, readData));<span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fileInputStream.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="6-FileOutputStream"><a href="#6-FileOutputStream" class="headerlink" title="6. FileOutputStream"></a>6. FileOutputStream</h1><h2 id="6-1-ç”¨FileOutputStreamè¯»å–æ–‡ä»¶"><a href="#6-1-ç”¨FileOutputStreamè¯»å–æ–‡ä»¶" class="headerlink" title="6.1 ç”¨FileOutputStreamè¯»å–æ–‡ä»¶"></a>6.1 ç”¨FileOutputStreamè¯»å–æ–‡ä»¶</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileOutputStream01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤ºä½¿ç”¨ FileOutputStream å°†æ•°æ®å†™åˆ°æ–‡ä»¶ä¸­, * å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 20:17</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileOutputStream01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        writeFile();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\d.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">        FileOutputStream fileOutputStream=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1. new FileOutputStream(filePath) åˆ›å»ºæ–¹å¼ï¼Œå½“å†™å…¥å†…å®¹æ˜¯ï¼Œä¼šè¦†ç›–åŸæ¥çš„å†…å®¹</span></span><br><span class="line">           <span class="comment">//2. new FileOutputStream(filePath, true) åˆ›å»ºæ–¹å¼ï¼Œå½“å†™å…¥å†…å®¹æ˜¯ï¼Œæ˜¯è¿½åŠ åˆ°æ–‡ä»¶åé¢</span></span><br><span class="line">            fileOutputStream=<span class="keyword">new</span> FileOutputStream(filePath,<span class="keyword">true</span>);</span><br><span class="line">            <span class="comment">//å†™å…¥ä¸€ä¸ªå­—èŠ‚</span></span><br><span class="line">            fileOutputStream.write(<span class="string">&#x27;K&#x27;</span>);</span><br><span class="line">            <span class="comment">//å†™å…¥å­—ç¬¦ä¸²</span></span><br><span class="line">            String str=<span class="string">&quot;kangxiaozhuang&quot;</span>;</span><br><span class="line">            <span class="comment">//è½¬ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line">            <span class="keyword">byte</span>[] bytes = str.getBytes(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            <span class="comment">//æŒ‰ç…§ç¼–ç çš„å½¢å¼å†™å…¥æ–‡ä»¶ä¸­</span></span><br><span class="line">            fileOutputStream.write(str.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            write(byte[] b, int off, int len)</span></span><br><span class="line"><span class="comment">            å°† len å­—èŠ‚ä»ä½äºåç§»é‡ off çš„æŒ‡å®šå­—èŠ‚æ•°ç»„å†™å…¥æ­¤æ–‡ä»¶è¾“å‡ºæµ</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            fileOutputStream.write(str.getBytes(), <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;å†™å…¥æ–‡ä»¶æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;å†™å…¥æ–‡ä»¶å¤±è´¥&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fileOutputStream.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-2-æ–‡ä»¶æ‹·è´"><a href="#6-2-æ–‡ä»¶æ‹·è´" class="headerlink" title="6.2 æ–‡ä»¶æ‹·è´"></a>6.2 æ–‡ä»¶æ‹·è´</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileCopy</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ–‡ä»¶æ‹·è´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 20:28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileCopy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        copyFile();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        åˆ›å»ºè¾“å…¥æµå’Œè¾“å‡ºæµ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String srcFilePath = <span class="string">&quot;f:\\1.jpg&quot;</span>;</span><br><span class="line">        String desFilePath = <span class="string">&quot;f:\\2.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line">        FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line">        FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fis = <span class="keyword">new</span> FileInputStream(srcFilePath);</span><br><span class="line">            fos = <span class="keyword">new</span> FileOutputStream(desFilePath);</span><br><span class="line">            <span class="comment">//å®šä¹‰å­—èŠ‚æ•°ç»„ æé«˜è¯»å–æ•ˆæœ</span></span><br><span class="line">            <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="keyword">int</span> readLen=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> ((readLen=fis.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="comment">//ä¸€è¾¹è¯»ä¸€è¾¹å†™</span></span><br><span class="line">                fos.write(buf, <span class="number">0</span>, readLen);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–‡ä»¶æ‹·è´æˆåŠŸï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fis.close();</span><br><span class="line">                fos.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7-FileReader-å’Œ-FileWriter"><a href="#7-FileReader-å’Œ-FileWriter" class="headerlink" title="7. FileReader å’Œ FileWriter"></a>7. FileReader å’Œ FileWriter</h1><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-55-47.png"></p>
<h2 id="7-1-FileReaderæ–¹æ³•"><a href="#7-1-FileReaderæ–¹æ³•" class="headerlink" title="7.1 FileReaderæ–¹æ³•"></a>7.1 FileReaderæ–¹æ³•</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-57-54.png"></p>
<h2 id="7-2-FileWriteræ–¹æ³•"><a href="#7-2-FileWriteræ–¹æ³•" class="headerlink" title="7.2 FileWriteræ–¹æ³•"></a>7.2 FileWriteræ–¹æ³•</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_21-58-01.png"></p>
<h2 id="7-3-FileReaderè¯»å–æ–‡ä»¶"><a href="#7-3-FileReaderè¯»å–æ–‡ä»¶" class="headerlink" title="7.3 FileReaderè¯»å–æ–‡ä»¶"></a>7.3 FileReaderè¯»å–æ–‡ä»¶</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileReader_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> FileReader</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 21:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileReader_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       <span class="comment">// readFile01();</span></span><br><span class="line">        readFile02();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readFile01</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\d.txt&quot;</span>;</span><br><span class="line">        FileReader fileReader = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">int</span> data = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//1. åˆ›å»º FileReader å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileReader = <span class="keyword">new</span> FileReader(filePath);</span><br><span class="line">        <span class="comment">//å¾ªç¯è¯»å– ä½¿ç”¨ read, å•ä¸ªå­—ç¬¦è¯»å–</span></span><br><span class="line">            <span class="keyword">while</span> ((data = fileReader.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                System.out.print((<span class="keyword">char</span>) data);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (fileReader != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    fileReader.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å­—ç¬¦æ•°ç»„è¯»å–æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readFile02</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===readFile02===&quot;</span>);</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\d.txt&quot;</span>;</span><br><span class="line">        FileReader fileReader = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">int</span> readLen = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span>[] buf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">8</span>];</span><br><span class="line">        <span class="comment">//1. åˆ›å»º FileReader å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileReader = <span class="keyword">new</span> FileReader(filePath);</span><br><span class="line">        <span class="comment">//å¾ªç¯è¯»å– ä½¿ç”¨ read(buf), è¿”å›çš„æ˜¯å®é™…è¯»å–åˆ°çš„å­—ç¬¦æ•°</span></span><br><span class="line">        <span class="comment">//å¦‚æœè¿”å›-1, è¯´æ˜åˆ°æ–‡ä»¶ç»“æŸ</span></span><br><span class="line">            <span class="keyword">while</span> ((readLen = fileReader.read(buf)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                System.out.print(<span class="keyword">new</span> String(buf, <span class="number">0</span>, readLen));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (fileReader != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    fileReader.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">````</span><br><span class="line"></span><br><span class="line">## 7.4 FileWriterå†™å…¥æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> FileWriter_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 20:44</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileWriter_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\note.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//åˆ›å»º FileWriter å¯¹è±¡</span></span><br><span class="line">        FileWriter fileWriter = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">char</span>[] chars = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>&#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileWriter = <span class="keyword">new</span> FileWriter(filePath);<span class="comment">//é»˜è®¤æ˜¯è¦†ç›–å†™å…¥</span></span><br><span class="line">        <span class="comment">// 3) write(int):å†™å…¥å•ä¸ªå­—ç¬¦</span></span><br><span class="line">            fileWriter.write(<span class="string">&#x27;H&#x27;</span>);</span><br><span class="line">        <span class="comment">// 4) write(char[]):å†™å…¥æŒ‡å®šæ•°ç»„</span></span><br><span class="line">            fileWriter.write(chars);</span><br><span class="line">        <span class="comment">// 5) write(char[],off,len):å†™å…¥æŒ‡å®šæ•°ç»„çš„æŒ‡å®šéƒ¨åˆ†</span></span><br><span class="line">            fileWriter.write(<span class="string">&quot;åº·å°åº„2333&quot;</span>.toCharArray(), <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">        <span class="comment">// 6) writeï¼ˆstringï¼‰ï¼šå†™å…¥æ•´ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">            fileWriter.write(<span class="string">&quot; ä½ å¥½åŒ—äº¬~&quot;</span>);</span><br><span class="line">            fileWriter.write(<span class="string">&quot;é£é›¨ä¹‹åï¼Œå®šè§å½©è™¹&quot;</span>);</span><br><span class="line">            <span class="comment">// 7) write(string,off,len):å†™å…¥å­—ç¬¦ä¸²çš„æŒ‡å®šéƒ¨åˆ†</span></span><br><span class="line">            fileWriter.write(<span class="string">&quot;ä¸Šæµ·å¤©æ´¥&quot;</span>, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="comment">//åœ¨æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å¾ªç¯æ“ä½œ</span></span><br><span class="line">            System.out.println(<span class="string">&quot;å†™å…¥æ–‡ä»¶æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//ä¸€å®šè¦å…³é—­æµ æ‰èƒ½å†™å…¥æ•°æ®</span></span><br><span class="line">                fileWriter.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="8-èŠ‚ç‚¹æµå’Œå¤„ç†æµ"><a href="#8-èŠ‚ç‚¹æµå’Œå¤„ç†æµ" class="headerlink" title="8. èŠ‚ç‚¹æµå’Œå¤„ç†æµ"></a>8. èŠ‚ç‚¹æµå’Œå¤„ç†æµ</h1><h2 id="8-1-åŸºæœ¬ä»‹ç»"><a href="#8-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="8.1 åŸºæœ¬ä»‹ç»"></a>8.1 åŸºæœ¬ä»‹ç»</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_22-03-47.png"></p>
<h2 id="8-2-èŠ‚ç‚¹æµå’Œå¤„ç†æµä¸€è§ˆå›¾"><a href="#8-2-èŠ‚ç‚¹æµå’Œå¤„ç†æµä¸€è§ˆå›¾" class="headerlink" title="8.2 èŠ‚ç‚¹æµå’Œå¤„ç†æµä¸€è§ˆå›¾"></a>8.2 èŠ‚ç‚¹æµå’Œå¤„ç†æµä¸€è§ˆå›¾</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/JavaIO%E6%B5%81%E5%9B%BE%E7%89%87/Snipaste_2021-05-29_22-04-45.png"></p>
<h2 id="8-3-èŠ‚ç‚¹æµå’Œå¤„ç†æµçš„åŒºåˆ«å’Œè”ç³»"><a href="#8-3-èŠ‚ç‚¹æµå’Œå¤„ç†æµçš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="8.3 èŠ‚ç‚¹æµå’Œå¤„ç†æµçš„åŒºåˆ«å’Œè”ç³»"></a>8.3 èŠ‚ç‚¹æµå’Œå¤„ç†æµçš„åŒºåˆ«å’Œè”ç³»</h2><ul>
<li>èŠ‚ç‚¹æµæ˜¯åº•å±‚æµ/ä½çº§æµï¼Œç›´æ¥è·Ÿæ•°æ®æºç›¸æ¥</li>
<li>å¤„ç†æµ(åŒ…è£…æµ)åŒ…è£…èŠ‚ç‚¹æµï¼Œæ—¢å¯ä»¥æ¶ˆé™¤ä¸åŒèŠ‚ç‚¹æµçš„å®ç°å·®å¼‚ï¼Œä¹Ÿå¯ä»¥æä¾›æ›´æ–¹ä¾¿çš„æ–¹æ³•æ¥å®Œæˆè¾“å…¥è¾“å‡º</li>
</ul>
<h2 id="8-4-å¤„ç†æµçš„åŠŸèƒ½"><a href="#8-4-å¤„ç†æµçš„åŠŸèƒ½" class="headerlink" title="8.4 å¤„ç†æµçš„åŠŸèƒ½"></a>8.4 å¤„ç†æµçš„åŠŸèƒ½</h2><ul>
<li><p>1ï¼æ€§èƒ½çš„æé«˜:ä¸»è¦ä»¥å¢åŠ ç¼“å†²çš„æ–¹å¼æ¥æé«˜è¾“å…¥è¾“å‡ºçš„æ•ˆç‡ã€‚</p>
</li>
<li><p>2ï¼æ“ä½œçš„ä¾¿æ·:å¤„ç†æµå¯èƒ½æä¾›äº†ä¸€ç³»åˆ—ä¾¿æ·çš„æ–¹æ³•æ¥ä¸€æ¬¡è¾“å…¥è¾“å‡ºå¤§æ‰¹é‡çš„æ•°æ®ï¼Œä½¿ç”¨æ›´åŠ çµæ´»æ–¹ä¾¿</p>
</li>
</ul>
<h1 id="9-å¤„ç†æµ-BufferedReader-å’Œ-BufferedWriter"><a href="#9-å¤„ç†æµ-BufferedReader-å’Œ-BufferedWriter" class="headerlink" title="9. å¤„ç†æµ-BufferedReader å’Œ BufferedWriter"></a>9. å¤„ç†æµ-BufferedReader å’Œ BufferedWriter</h1><h2 id="9-1-BufferedReaderçš„ä½¿ç”¨"><a href="#9-1-BufferedReaderçš„ä½¿ç”¨" class="headerlink" title="9.1 BufferedReaderçš„ä½¿ç”¨"></a>9.1 BufferedReaderçš„ä½¿ç”¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> BufferedReader_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> * æ¼”ç¤º bufferedReader ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 20:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BufferedReader_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\note.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºBufferedReader</span></span><br><span class="line">        BufferedReader  bufferedReader=<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(filePath));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//æŒ‰è¡Œè¯»å– æ•ˆç‡é«˜</span></span><br><span class="line">            String line;</span><br><span class="line">            <span class="comment">//1. bufferedReader.readLine() æ˜¯æŒ‰è¡Œè¯»å–æ–‡ä»¶</span></span><br><span class="line">            <span class="comment">//2. å½“è¿”å› null æ—¶ï¼Œè¡¨ç¤ºæ–‡ä»¶è¯»å–å®Œæ¯•</span></span><br><span class="line">            <span class="keyword">while</span> ((line = bufferedReader.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">           <span class="comment">// å…³é—­æµ, è¿™é‡Œæ³¨æ„ï¼Œåªéœ€è¦å…³é—­ BufferedReader ï¼Œå› ä¸ºåº•å±‚ä¼šè‡ªåŠ¨çš„å»å…³é—­ èŠ‚ç‚¹æµ</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            bufferedReader.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-2-BufferedWriterçš„ä½¿ç”¨"><a href="#9-2-BufferedWriterçš„ä½¿ç”¨" class="headerlink" title="9.2 BufferedWriterçš„ä½¿ç”¨"></a>9.2 BufferedWriterçš„ä½¿ç”¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> BufferedWriter_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤º BufferedWriter çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 21:00</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BufferedWriter_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\ok.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//åˆ›å»º BufferedWriter</span></span><br><span class="line">        <span class="comment">//è¯´æ˜:</span></span><br><span class="line">        <span class="comment">//1. new FileWriter(filePath, true) è¡¨ç¤ºä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥</span></span><br><span class="line">        <span class="comment">//2. new FileWriter(filePath) , è¡¨ç¤ºä»¥è¦†ç›–çš„æ–¹å¼å†™å…¥</span></span><br><span class="line">        BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(filePath));</span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello, åº·å°åº„!&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();<span class="comment">//æ’å…¥ä¸€ä¸ªå’Œç³»ç»Ÿç›¸å…³çš„æ¢è¡Œ</span></span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello2, åº·å°åº„!&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();</span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello3, åº·å°åº„!&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();</span><br><span class="line">        System.out.println(<span class="string">&quot;å†™å…¥æ–‡ä»¶æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="comment">//å…³é—­æµ</span></span><br><span class="line">        bufferedWriter.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-3-æ‹·è´æ–‡ä»¶"><a href="#9-3-æ‹·è´æ–‡ä»¶" class="headerlink" title="9.3 æ‹·è´æ–‡ä»¶"></a>9.3 æ‹·è´æ–‡ä»¶</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> BufferedCopy_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/29 21:07</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BufferedCopy_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String srcFilePath = <span class="string">&quot;f:\\1.jpg&quot;</span>;</span><br><span class="line">        String desFilePath=<span class="string">&quot;f:\\3.jpg&quot;</span>;</span><br><span class="line">        BufferedReader br=<span class="keyword">null</span>;</span><br><span class="line">        BufferedWriter bw=<span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//å®šä¹‰è¡Œ</span></span><br><span class="line">        String line;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            br=<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(srcFilePath));</span><br><span class="line">            bw=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(desFilePath));</span><br><span class="line">            <span class="keyword">while</span> ((line= br.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                bw.write(line);</span><br><span class="line">                <span class="comment">//æ’å…¥æ–°çš„æ¢è¡Œ</span></span><br><span class="line">                bw.newLine();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‹·è´æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                br.close();</span><br><span class="line">                bw.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨BufferedOutputStreamå†™å…¥æ–‡ä»¶</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> BufferedCopy2_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>  æ¼”ç¤ºä½¿ç”¨ BufferedOutputStream å’Œ BufferedInputStream ä½¿ç”¨ å®Œæˆæ–‡ä»¶çš„æ‹·è´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 14:50</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BufferedCopy2_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String srcFilePath = <span class="string">&quot;f:\\a.txt&quot;</span>;</span><br><span class="line">        String destFilePath = <span class="string">&quot;f:\\a2.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//åˆ›å»º BufferedOutputStream å¯¹è±¡ BufferedInputStream å¯¹è±¡</span></span><br><span class="line">        BufferedInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">        BufferedOutputStream bos = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//å› ä¸º FileInputStream æ˜¯ InputStream å­ç±»</span></span><br><span class="line">            bis = <span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(srcFilePath));</span><br><span class="line">         bos = <span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(destFilePath));</span><br><span class="line">        <span class="comment">//å¾ªç¯çš„è¯»å–æ–‡ä»¶ï¼Œå¹¶å†™å…¥åˆ° destFilePath</span></span><br><span class="line">        <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> readLen = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//å½“è¿”å› -1 æ—¶ï¼Œå°±è¡¨ç¤ºæ–‡ä»¶è¯»å–å®Œæ¯•</span></span><br><span class="line">        <span class="keyword">while</span> ((readLen = bis.read(buff)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            bos.write(buff, <span class="number">0</span>, readLen);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶æ‹·è´å®Œæ¯•~~~&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ioException) &#123;</span><br><span class="line">            ioException.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            bis.close();</span><br><span class="line">            bos.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="10-å¯¹è±¡æµ-ObjectInputStream-å’Œ-ObjectOutputStream"><a href="#10-å¯¹è±¡æµ-ObjectInputStream-å’Œ-ObjectOutputStream" class="headerlink" title="10. å¯¹è±¡æµ-ObjectInputStream å’Œ ObjectOutputStream"></a>10. å¯¹è±¡æµ-ObjectInputStream å’Œ ObjectOutputStream</h1><p><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/image-20210531170403674.png" alt="image-20210531170403674"></p>
<h2 id="10-1-å¯¹è±¡æµçš„ä»‹ç»"><a href="#10-1-å¯¹è±¡æµçš„ä»‹ç»" class="headerlink" title="10.1 å¯¹è±¡æµçš„ä»‹ç»"></a>10.1 å¯¹è±¡æµçš„ä»‹ç»</h2><p>åŠŸèƒ½ï¼šæä¾›äº†å¯¹åŸºæœ¬ç±»å‹æˆ–å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹æ³• </p>
<ul>
<li><p>ObjectOutputStream æä¾› åºåˆ—åŒ–åŠŸèƒ½ </p>
</li>
<li><p>ObjectInputStream æä¾› ååºåˆ—åŒ–åŠŸèƒ½</p>
</li>
</ul>
<p><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/image-20210531170512989.png" alt="image-20210531170512989"></p>
<p><strong>å®ç°åºåˆ—åŒ–çš„æ“ä½œ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ObjectOutStream_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ObjectOutStreamå®ç°åºåˆ—åŒ–æ“ä½œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 14:56</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectOutStream_</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//åºåˆ—åŒ–åï¼Œä¿å­˜çš„æ–‡ä»¶æ ¼å¼ï¼Œä¸æ˜¯å­˜æ–‡æœ¬ï¼Œè€Œæ˜¯æŒ‰ç…§ä»–çš„æ ¼å¼æ¥ä¿å­˜</span></span><br><span class="line">        String filePath = <span class="string">&quot;f:\\data.dat&quot;</span>;</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(filePath));</span><br><span class="line">        <span class="comment">//åºåˆ—åŒ–æ•°æ®åˆ° f:\data.dat</span></span><br><span class="line">        oos.writeInt(<span class="number">100</span>);<span class="comment">// int -&gt; Integer (å®ç°äº† Serializable)</span></span><br><span class="line">        oos.writeBoolean(<span class="keyword">true</span>);<span class="comment">// boolean -&gt; Boolean (å®ç°äº† Serializable)</span></span><br><span class="line">        oos.writeChar(<span class="string">&#x27;a&#x27;</span>);<span class="comment">// char -&gt; Character (å®ç°äº† Serializable)</span></span><br><span class="line">        oos.writeDouble(<span class="number">9.5</span>);<span class="comment">// double -&gt; Double (å®ç°äº† Serializable)</span></span><br><span class="line">        oos.writeUTF(<span class="string">&quot;åº·å°åº„&quot;</span>);<span class="comment">//String</span></span><br><span class="line">        <span class="comment">//ä¿å­˜ä¸€ä¸ª dog å¯¹è±¡</span></span><br><span class="line">        oos.writeObject(<span class="keyword">new</span> Dog(<span class="string">&quot;æ—ºè´¢&quot;</span>, <span class="number">10</span>, <span class="string">&quot;æ—¥æœ¬&quot;</span>, <span class="string">&quot;ç™½è‰²&quot;</span>));</span><br><span class="line">        oos.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;æ•°æ®ä¿å­˜å®Œæ¯•(åºåˆ—åŒ–å½¢å¼)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å®ç°ååºåˆ—åŒ–çš„æ“ä½œ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ObjectInputStream_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ObjectInputStreamå®ç°ååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 15:00</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectInputStream_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1.åˆ›å»ºæµå¯¹è±¡</span></span><br><span class="line">        ObjectInputStream ois=<span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;f:\\data.dat&quot;</span>));</span><br><span class="line">        <span class="comment">// 2.è¯»å–ï¼Œ æ³¨æ„é¡ºåº</span></span><br><span class="line">        System.out.println(ois.readInt());</span><br><span class="line">        System.out.println(ois.readBoolean());</span><br><span class="line">        System.out.println(ois.readChar());</span><br><span class="line">        System.out.println(ois.readDouble());</span><br><span class="line">        System.out.println(ois.readUTF());</span><br><span class="line">        <span class="comment">// 3.å…³é—­</span></span><br><span class="line">        ois.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»¥ååºåˆ—åŒ–çš„æ–¹å¼è¯»å–(æ¢å¤)ok~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ“ä½œæ³¨æ„äº‹é¡¹</strong></p>
<p><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/image-20210531170735820.png" alt="image-20210531170735820"></p>
<h1 id="11-è½¬æ¢æµ-InputStreamReader-å’Œ-OutputStreamWriter"><a href="#11-è½¬æ¢æµ-InputStreamReader-å’Œ-OutputStreamWriter" class="headerlink" title="11. è½¬æ¢æµ-InputStreamReader å’Œ OutputStreamWriter"></a>11. è½¬æ¢æµ-InputStreamReader å’Œ OutputStreamWriter</h1><p><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/image-20210531170838279.png" alt="image-20210531170838279"></p>
<p><strong>ä½¿ç”¨InputStreamReaderè¯»å–å†…å®¹ å¹¶æŒ‡å®šç¼–ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> InputStreamReader_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> InputStreamReader</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 15:09</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InputStreamReader_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\a.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//1. æŠŠ FileInputStream è½¬æˆ InputStreamReader</span></span><br><span class="line">        <span class="comment">//2. æŒ‡å®šç¼–ç  gbk</span></span><br><span class="line">        <span class="comment">//InputStreamReader isr = new InputStreamReader(new FileInputStream(filePath), &quot;gbk&quot;);</span></span><br><span class="line">        <span class="comment">//3. æŠŠ InputStreamReader ä¼ å…¥ BufferedReader</span></span><br><span class="line">        <span class="comment">//BufferedReader br = new BufferedReader(isr);</span></span><br><span class="line">        <span class="comment">//å°† 2 å’Œ 3 åˆåœ¨ä¸€èµ·</span></span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(</span><br><span class="line">                <span class="keyword">new</span> FileInputStream(filePath), <span class="string">&quot;gbk&quot;</span>));</span><br><span class="line">        <span class="comment">//4. è¯»å–</span></span><br><span class="line">        String s = br.readLine();</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯»å–å†…å®¹=&quot;</span> + s);</span><br><span class="line">        <span class="comment">//5. å…³é—­å¤–å±‚æµ</span></span><br><span class="line">        br.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="12-æ‰“å°æµ-PrintStream-å’Œ-PrintWriter"><a href="#12-æ‰“å°æµ-PrintStream-å’Œ-PrintWriter" class="headerlink" title="12. æ‰“å°æµ-PrintStream å’Œ PrintWriter"></a>12. æ‰“å°æµ-PrintStream å’Œ PrintWriter</h1><p><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/image-20210531171119302.png" alt="image-20210531171119302"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> PrintStream_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ¼”ç¤º PrintStream ï¼ˆå­—èŠ‚æ‰“å°æµ/è¾“å‡ºæµï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 15:27</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintStream_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        PrintStream out = System.out;</span><br><span class="line">        <span class="comment">//åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒPrintStream è¾“å‡ºæ•°æ®çš„ä½ç½®æ˜¯ æ ‡å‡†è¾“å‡ºï¼Œå³æ˜¾ç¤ºå™¨</span></span><br><span class="line">        out.println(<span class="string">&quot;zk666&quot;</span>);</span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="13-Propertiesç±»"><a href="#13-Propertiesç±»" class="headerlink" title="13. Propertiesç±»"></a>13. Propertiesç±»</h1><p><strong>æˆ‘ä»¬ä¸€èˆ¬ç”¨xxx.propertiesç”¨ä½œé…ç½®æ–‡ä»¶ æ˜¯ä»¥K-Vé”®å€¼å¯¹çš„å½¢å¼</strong></p>
<p><strong>å¸¸ç”¨æ–¹æ³•</strong><br><img src="http://qtwu22ub9.hn-bkt.clouddn.com/img/image-20210531171526982.png" alt="image-20210531171526982"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Properties01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Propertiesç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 16:23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Properties01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//è¯»å– mysql.properties æ–‡ä»¶ï¼Œå¹¶å¾—åˆ° ip, user å’Œ pwd</span></span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">&quot;f:\\mysql.properties&quot;</span>));</span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span> ((line = br.readLine()) != <span class="keyword">null</span>) &#123; <span class="comment">//å¾ªç¯è¯»å–</span></span><br><span class="line">            String[] split = line.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">        <span class="comment">//å¦‚æœæˆ‘ä»¬è¦æ±‚æŒ‡å®šçš„ ip å€¼</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;ip&quot;</span>.equals(split[<span class="number">0</span>])) &#123;</span><br><span class="line">                System.out.println(split[<span class="number">0</span>] + <span class="string">&quot;å€¼æ˜¯: &quot;</span> + split[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        br.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ¥è¯»å–æ–‡ä»¶å¹¶æ˜¾ç¤ºå‡ºæ¥</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Properties02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Properties02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 16:29</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Properties02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨ Properties ç±»æ¥è¯»å– mysql.properties æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//1. åˆ›å»º Properties å¯¹è±¡</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line"><span class="comment">//2. åŠ è½½æŒ‡å®šé…ç½®æ–‡ä»¶</span></span><br><span class="line">        properties.load(<span class="keyword">new</span> FileReader(<span class="string">&quot;f:\\mysql.properties&quot;</span>));</span><br><span class="line"><span class="comment">//3. æŠŠ k-v æ˜¾ç¤ºæ§åˆ¶å°</span></span><br><span class="line">        properties.list(System.out);</span><br><span class="line"><span class="comment">//4. æ ¹æ® key è·å–å¯¹åº”çš„å€¼</span></span><br><span class="line">        String user = properties.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        String pwd = properties.getProperty(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">        String ip = properties.getProperty(<span class="string">&quot;ip&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”¨æˆ·å=&quot;</span> + user);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¯†ç æ˜¯=&quot;</span> + pwd);</span><br><span class="line">        System.out.println(<span class="string">&quot;IPæ˜¯=&quot;</span> + ip);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="14-ç»ƒä¹ "><a href="#14-ç»ƒä¹ " class="headerlink" title="14. ç»ƒä¹ "></a>14. ç»ƒä¹ </h1><h2 id="14-1-ç»ƒä¹ 1"><a href="#14-1-ç»ƒä¹ 1" class="headerlink" title="14.1 ç»ƒä¹ 1"></a>14.1 ç»ƒä¹ 1</h2><blockquote>
<p>åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›®å½• ä¸å­˜åœ¨å°±åˆ›å»º å¹¶åœ¨ç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶ ï¼Œå†™å…¥ä¸€ç‚¹æ•°æ®</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HomeWork01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 16:35</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeWork01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String dirPath = <span class="string">&quot;f:\\mytemp&quot;</span>;</span><br><span class="line">        File file = <span class="keyword">new</span> File(dirPath);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (file.mkdirs()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;åˆ›å»º&quot;</span> + dirPath + <span class="string">&quot;æˆåŠŸ&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;åˆ›å»º&quot;</span> + dirPath + <span class="string">&quot;å¤±è´¥&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String filePath = dirPath + <span class="string">&quot;\\hello.txt&quot;</span>;</span><br><span class="line">        file = <span class="keyword">new</span> File(filePath);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (file.createNewFile()) &#123;</span><br><span class="line">                System.out.println(filePath + <span class="string">&quot;åˆ›å»ºæˆåŠŸ&quot;</span>);</span><br><span class="line">                BufferedWriter bw=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(file));</span><br><span class="line">                bw.write(<span class="string">&quot;å“ˆå“ˆå“ˆï¼ï¼ï¼&quot;</span>);</span><br><span class="line">                bw.close();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(filePath + <span class="string">&quot;åˆ›å»ºå¤±è´¥&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–‡ä»¶å·²ç»å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="14-2-ç»ƒä¹ 2"><a href="#14-2-ç»ƒä¹ 2" class="headerlink" title="14.2 ç»ƒä¹ 2"></a>14.2 ç»ƒä¹ 2</h2><blockquote>
<p>å†™ä¸€ä¸ªpropertiesæ–‡ä»¶ ï¼Œè¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†æ–‡ä»¶çš„å†…å®¹åºåˆ—åŒ–åˆ°ä»»æ„æ–‡ä»¶ä¸­</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.HomeWork;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HomeWork02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> HomeWork02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/31 16:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeWork02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String filePath = <span class="string">&quot;f:\\dog.properties&quot;</span>;</span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.load(<span class="keyword">new</span> FileReader(filePath));</span><br><span class="line"></span><br><span class="line">        String name = (String) properties.get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> age = Integer.parseInt(properties.get(<span class="string">&quot;age&quot;</span>)+<span class="string">&quot;&quot;</span>);</span><br><span class="line">        String color = (String) properties.get(<span class="string">&quot;color&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Dog dog = <span class="keyword">new</span> Dog(name, age, color);</span><br><span class="line">        System.out.println(dog);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†ä¿¡æ¯åºåˆ—åŒ–è¿›æ–‡ä»¶ä¸­</span></span><br><span class="line">        String filePath2=<span class="string">&quot;f:\\a2.txt&quot;</span>;</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(filePath2));</span><br><span class="line">        oos.writeObject(dog);</span><br><span class="line"></span><br><span class="line">        oos.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;å†™å…¥æ–‡ä»¶æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">        <span class="keyword">private</span> String color;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Dog</span><span class="params">(String name, <span class="keyword">int</span> age, String color)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">            <span class="keyword">this</span>.color = color;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Dog&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                    <span class="string">&quot;, color=&#x27;&quot;</span> + color + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ</strong></p>
<p><strong>è‹¥æœ‰é”™è¯¯ï¼Œè¿˜è¯·å„ä½æŒ‡å‡ºé”™è¯¯ï¼ŒåŠæ—¶æ›´æ”¹ï¼</strong></p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaé›†åˆ</title>
    <url>/2021/01/05/Java%E9%9B%86%E5%90%88%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Javaé›†åˆ"><a href="#Javaé›†åˆ" class="headerlink" title="Javaé›†åˆ"></a>Javaé›†åˆ</h1><p><strong>å†™åœ¨å‰é¢</strong></p>
<p><strong>å­¦ä¹ åœ°å€ï¼š</strong></p>
<p><strong><a href="https://www.bilibili.com/video/BV1YA411T76k">[éŸ©é¡ºå¹³è®²Java]Javaé›†åˆä¸“é¢˜ </a></strong></p>
<p><strong>æ„Ÿè°¢éŸ©è€å¸ˆçš„è®²è§£è§†é¢‘ï¼Œååˆ†æ„Ÿè°¢ï¼ï¼ï¼</strong></p>
<p><strong>å…ˆä¸Šæ€ç»´å¯¼å›¾</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/mind.jpg"></p>
<h1 id="1-é›†åˆçš„ç§ç±»"><a href="#1-é›†åˆçš„ç§ç±»" class="headerlink" title="1. é›†åˆçš„ç§ç±»"></a>1. é›†åˆçš„ç§ç±»</h1><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-13-01.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-13-06.png" alt="Snipaste_2021-05-24_22-13-06"></p>
<ul>
<li>é›†åˆä¸»è¦æ˜¯ä¸¤ç»„(å•åˆ—é›†åˆ , åŒåˆ—é›†åˆ)</li>
<li>Collection æ¥å£æœ‰ä¸¤ä¸ªé‡è¦çš„å­æ¥å£ List Set , ä»–ä»¬çš„å®ç°å­ç±»éƒ½æ˜¯å•åˆ—é›†åˆ </li>
<li>Map æ¥å£çš„å®ç°å­ç±» æ˜¯åŒåˆ—é›†åˆï¼Œå­˜æ”¾çš„ K-V</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Collection</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è®¤è¯†é›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 20:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Collection</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList arrayList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        arrayList.add(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        HashMap hashMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">        hashMap.put(<span class="string">&quot;NO1&quot;</span>, <span class="string">&quot;åŒ—äº¬&quot;</span>);</span><br><span class="line">        hashMap.put(<span class="string">&quot;NO2&quot;</span>, <span class="string">&quot;ä¸Šæµ·&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(arrayList.toString());</span><br><span class="line">        System.out.println(hashMap.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="2-é›†åˆå¸¸ç”¨æ–¹æ³•"><a href="#2-é›†åˆå¸¸ç”¨æ–¹æ³•" class="headerlink" title="2. é›†åˆå¸¸ç”¨æ–¹æ³•"></a>2. é›†åˆå¸¸ç”¨æ–¹æ³•</h1><p>è¿™é‡Œè®²è§£å¸¸ç”¨çš„æ–¹æ³• å…·ä½“çš„æ–¹æ³•å¯ä»¥å‚è€ƒJava API</p>
<ul>
<li>add()</li>
<li>remove()</li>
<li>contains()</li>
<li>size()</li>
<li>isEmpty()</li>
<li>addAll()</li>
<li>containsAll()</li>
<li>removeAll()</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> CollectionMethod</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é›†åˆå¸¸ç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 21:01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionMethod</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="comment">// add:æ·»åŠ å•ä¸ªå…ƒç´ </span></span><br><span class="line">        list.add(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        list.add(<span class="number">10</span>);<span class="comment">//list.add(new Integer(10))</span></span><br><span class="line">        list.add(<span class="keyword">true</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        <span class="comment">// remove:åˆ é™¤æŒ‡å®šå…ƒç´ </span></span><br><span class="line">        <span class="comment">//list.remove(0);//åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        list.remove(<span class="keyword">true</span>);<span class="comment">//æŒ‡å®šåˆ é™¤æŸä¸ªå…ƒç´ </span></span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        <span class="comment">// contains:æŸ¥æ‰¾å…ƒç´ æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        System.out.println(list.contains(<span class="string">&quot;jack&quot;</span>));<span class="comment">//T</span></span><br><span class="line">        <span class="comment">// size:è·å–å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">        System.out.println(list.size());<span class="comment">//2</span></span><br><span class="line">        <span class="comment">// isEmpty:åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">        System.out.println(list.isEmpty());<span class="comment">//F</span></span><br><span class="line">        <span class="comment">// clear:æ¸…ç©º</span></span><br><span class="line">        list.clear();</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        <span class="comment">// addAll:æ·»åŠ å¤šä¸ªå…ƒç´ </span></span><br><span class="line">        ArrayList list2 = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list2.add(<span class="string">&quot;çº¢æ¥¼æ¢¦&quot;</span>);</span><br><span class="line">        list2.add(<span class="string">&quot;ä¸‰å›½æ¼”ä¹‰&quot;</span>);</span><br><span class="line">        list.addAll(list2);</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        <span class="comment">// containsAll:æŸ¥æ‰¾å¤šä¸ªå…ƒç´ æ˜¯å¦éƒ½å­˜åœ¨</span></span><br><span class="line">        System.out.println(list.containsAll(list2));<span class="comment">//T</span></span><br><span class="line">        <span class="comment">// removeAllï¼šåˆ é™¤å¤šä¸ªå…ƒç´ </span></span><br><span class="line">        list.add(<span class="string">&quot;èŠæ–‹&quot;</span>);</span><br><span class="line">        list.removeAll(list2);</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);<span class="comment">//[èŠæ–‹]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-17-45.png"></p>
<h1 id="3-è¿­ä»£å™¨çš„ä½¿ç”¨"><a href="#3-è¿­ä»£å™¨çš„ä½¿ç”¨" class="headerlink" title="3. è¿­ä»£å™¨çš„ä½¿ç”¨"></a>3. è¿­ä»£å™¨çš„ä½¿ç”¨</h1><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-18-24.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-18-42.png" alt="Snipaste_2021-05-24_22-18-42"></p>
<p>å¸¸ç”¨æ–¹æ³•</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-19-31.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.print.Book;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> CollectionIterator</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> è¿­ä»£å™¨çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 21:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionIterator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list.add(<span class="keyword">new</span> Book(<span class="string">&quot;ä¸‰å›½æ¼”ä¹‰&quot;</span>, <span class="string">&quot;ç½—è´¯ä¸­&quot;</span>, <span class="number">10.1</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> Book(<span class="string">&quot;å°æé£åˆ€&quot;</span>, <span class="string">&quot;å¤é¾™&quot;</span>, <span class="number">5.1</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> Book(<span class="string">&quot;çº¢æ¥¼æ¢¦&quot;</span>, <span class="string">&quot;æ›¹é›ªèŠ¹&quot;</span>, <span class="number">34.6</span>));</span><br><span class="line"></span><br><span class="line">        Iterator iterator = list.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Object obj =  iterator.next();</span><br><span class="line">            System.out.println(<span class="string">&quot;obj=&quot;</span>+obj);</span><br><span class="line">        &#125;</span><br><span class="line">                iterator = list.iterator();<span class="comment">//æ³¨æ„ ç¬¬äºŒæ¬¡éå† éœ€è¦é‡æ–°è·å–iteartor</span></span><br><span class="line">        System.out.println(<span class="string">&quot;===ç¬¬äºŒæ¬¡éå†===&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Object obj = iterator.next();</span><br><span class="line">            System.out.println(<span class="string">&quot;obj=&quot;</span> + obj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> String author;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">(String name, String author, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.author = author;</span><br><span class="line">            <span class="keyword">this</span>.price = price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> author;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAuthor</span><span class="params">(String author)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.author = author;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.price = price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Book&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, author=&#x27;&quot;</span> + author + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, price=&quot;</span> + price +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_21-21-58.png"></p>
<p><strong>å¢å¼ºforå¾ªç¯éå†</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> CollectionExercise</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é›†åˆç»ƒä¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 21:22</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionExercise</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list.add(<span class="keyword">new</span> Dog(<span class="string">&quot;å°é»‘&quot;</span>, <span class="number">3</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> Dog(<span class="string">&quot;å¤§é»„&quot;</span>, <span class="number">100</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> Dog(<span class="string">&quot;å¤§å£®&quot;</span>, <span class="number">8</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;å¢å¼ºforéå†&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object item : list) &#123;</span><br><span class="line">            System.out.println(item);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;è¿­ä»£å™¨éå†&quot;</span>);</span><br><span class="line">        Iterator iterator = list.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Object next =  iterator.next();</span><br><span class="line">            System.out.println(next);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Dog</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Dog&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_21-25-18.png"></p>
<h1 id="4-Listçš„å¸¸ç”¨æ–¹æ³•"><a href="#4-Listçš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="4. Listçš„å¸¸ç”¨æ–¹æ³•"></a>4. Listçš„å¸¸ç”¨æ–¹æ³•</h1><ul>
<li>add æ–¹æ³• å¾€é›†åˆæœ«å°¾æ·»åŠ ä¸€ä¸ªå…ƒç´ </li>
<li>void add(int index, Object ele):åœ¨ index ä½ç½®æ’å…¥ ele å…ƒç´ </li>
<li>boolean addAll(int index, Collection eles):ä» index ä½ç½®å¼€å§‹å°† eles ä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è¿›æ¥</li>
<li>Object get(int index):è·å–æŒ‡å®š index ä½ç½®çš„å…ƒç´ </li>
<li>int indexOf(Object obj):è¿”å› obj åœ¨é›†åˆä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</li>
<li>int lastIndexOf(Object obj):è¿”å› obj åœ¨å½“å‰é›†åˆä¸­æœ«æ¬¡å‡ºç°çš„ä½ç½®</li>
<li>Object remove(int index):ç§»é™¤æŒ‡å®š index ä½ç½®çš„å…ƒç´ ï¼Œå¹¶è¿”å›æ­¤å…ƒç´ </li>
<li>Object set(int index, Object ele):è®¾ç½®æŒ‡å®š index ä½ç½®çš„å…ƒç´ ä¸º ele , ç›¸å½“äºæ˜¯æ›¿æ¢</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ListMethod</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Listé›†åˆå¸¸ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 21:28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListMethod</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="comment">//add æ–¹æ³• å¾€é›†åˆæœ«å°¾æ·»åŠ ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        list.add(<span class="string">&quot;åˆ˜å¤‡&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;æ›¹æ“&quot;</span>);</span><br><span class="line">        <span class="comment">// void add(int index, Object ele):åœ¨ index ä½ç½®æ’å…¥ ele å…ƒç´ </span></span><br><span class="line">        list.add(<span class="number">1</span>, <span class="string">&quot;åº·å°åº„&quot;</span>);</span><br><span class="line">        System.out.println(list.toString());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//boolean addAll(int index, Collection eles):ä» index ä½ç½®å¼€å§‹å°† eles ä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è¿›æ¥</span></span><br><span class="line">        ArrayList list2 = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list2.add(<span class="string">&quot;è¯¸è‘›äº®&quot;</span>);</span><br><span class="line">        list2.add(<span class="string">&quot;å…³ç¾½&quot;</span>);</span><br><span class="line">        list.addAll(list2);</span><br><span class="line">        System.out.println(list.toString());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Object get(int index):è·å–æŒ‡å®š index ä½ç½®çš„å…ƒç´ </span></span><br><span class="line">        <span class="comment">// int indexOf(Object obj):è¿”å› obj åœ¨é›†åˆä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span></span><br><span class="line">        System.out.println(list.indexOf(<span class="string">&quot;æ›¹æ“&quot;</span>));<span class="comment">//2</span></span><br><span class="line"><span class="comment">// int lastIndexOf(Object obj):è¿”å› obj åœ¨å½“å‰é›†åˆä¸­æœ«æ¬¡å‡ºç°çš„ä½ç½®</span></span><br><span class="line">        list.add(<span class="string">&quot;å´ç”¨&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        System.out.println(list.lastIndexOf(<span class="string">&quot;å´ç”¨&quot;</span>));</span><br><span class="line"><span class="comment">// Object remove(int index):ç§»é™¤æŒ‡å®š index ä½ç½®çš„å…ƒç´ ï¼Œå¹¶è¿”å›æ­¤å…ƒç´ </span></span><br><span class="line">        list.remove(<span class="number">0</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line"><span class="comment">// Object set(int index, Object ele):è®¾ç½®æŒ‡å®š index ä½ç½®çš„å…ƒç´ ä¸º ele , ç›¸å½“äºæ˜¯æ›¿æ¢. list.set(1, &quot;ç›ä¸½&quot;);</span></span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-26-49.png"></p>
<h2 id="4-1-Listä¸‰ç§éå†æ–¹å¼"><a href="#4-1-Listä¸‰ç§éå†æ–¹å¼" class="headerlink" title="4.1 Listä¸‰ç§éå†æ–¹å¼"></a>4.1 Listä¸‰ç§éå†æ–¹å¼</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ListFor</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Listé›†åˆä¸‰ç§éå†æ–¹å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 21:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListFor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;ä¸‰å›½æ¼”ä¹‰&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;çº¢æ¥¼æ¢¦&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;æ°´æµ’ä¼ &quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;è¥¿æ¸¸è®°&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===è¿­ä»£å™¨===&quot;</span>);</span><br><span class="line">        Iterator iterator = list.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Object next =  iterator.next();</span><br><span class="line">            System.out.println(next.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===å¢å¼ºfor===&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object o : list) &#123;</span><br><span class="line">            System.out.println(o.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;===æ™®é€šforå¾ªç¯===&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">            System.out.println(list.get(i).toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_21-40-34.png"></p>
<p><strong>ç»ƒä¹  éå†æŒ‰ç…§ä¹¦çš„ä»·æ ¼æ’åº ä½¿ç”¨å†’æ³¡æ’åº</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ListExercise02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Listé›†åˆç»ƒä¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 21:41</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListExercise02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//List list = new ArrayList();</span></span><br><span class="line">        ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//List list = new Vector();</span></span><br><span class="line">        list.add(<span class="keyword">new</span> CollectionIterator.Book(<span class="string">&quot;çº¢æ¥¼æ¢¦&quot;</span>, <span class="string">&quot;æ›¹é›ªèŠ¹&quot;</span>, <span class="number">100</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> CollectionIterator.Book(<span class="string">&quot;è¥¿æ¸¸è®°&quot;</span>, <span class="string">&quot;å´æ‰¿æ©&quot;</span>, <span class="number">10</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> CollectionIterator.Book(<span class="string">&quot;æ°´æµ’ä¼ &quot;</span>, <span class="string">&quot;æ–½è€åºµ&quot;</span>, <span class="number">19</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> CollectionIterator.Book(<span class="string">&quot;ä¸‰å›½&quot;</span>, <span class="string">&quot;ç½—è´¯ä¸­&quot;</span>, <span class="number">80</span>));</span><br><span class="line">        <span class="comment">//å¦‚ä½•å¯¹é›†åˆè¿›è¡Œæ’åº</span></span><br><span class="line">        <span class="comment">//éå†</span></span><br><span class="line">        System.out.println(<span class="string">&quot;====æ’åºå‰====&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object o : list) &#123;</span><br><span class="line">            System.out.println(o);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;====æ’åºå====&quot;</span>);</span><br><span class="line">        sort(list);</span><br><span class="line">        <span class="keyword">for</span> (Object o : list) &#123;</span><br><span class="line">            System.out.println(o);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//ä»·æ ¼è¦æ±‚æ˜¯ä»å°åˆ°å¤§  å†’æ³¡æ’åº</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(ArrayList list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> listSize = list.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; listSize - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; listSize - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">                <span class="comment">//å–å‡ºå¯¹è±¡ Book</span></span><br><span class="line">                CollectionIterator.Book book1 = (CollectionIterator.Book) list.get(j);</span><br><span class="line">                CollectionIterator.Book book2 = (CollectionIterator.Book) list.get(j + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (book1.getPrice() &gt; book2.getPrice()) &#123;<span class="comment">//äº¤æ¢</span></span><br><span class="line">                    list.set(j, book2);</span><br><span class="line">                    list.set(j + <span class="number">1</span>, book1);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-ArrayListåº•å±‚æºç å’Œç»“æ„"><a href="#5-ArrayListåº•å±‚æºç å’Œç»“æ„" class="headerlink" title="5. ArrayListåº•å±‚æºç å’Œç»“æ„"></a>5. ArrayListåº•å±‚æºç å’Œç»“æ„</h1><h2 id="5-1-ArrayListçš„æ³¨æ„äº‹é¡¹"><a href="#5-1-ArrayListçš„æ³¨æ„äº‹é¡¹" class="headerlink" title="5.1 ArrayListçš„æ³¨æ„äº‹é¡¹"></a>5.1 ArrayListçš„æ³¨æ„äº‹é¡¹</h2><ul>
<li>ArrayListå¯ä»¥åŠ å…¥å¤šä¸ªå…ƒç´  å¯ä»¥æ·»åŠ <code>null</code></li>
<li>ArrayListæ˜¯æœ‰æ•°ç»„æ¥å®ç°æ•°æ®å­˜å‚¨</li>
<li>ArrayListåŸºæœ¬ç­‰åŒäº<code>Vector</code> é™¤äº†<strong>ArrayListæ˜¯çº¿ç¨‹ä¸å®‰å…¨ï¼</strong></li>
</ul>
<h2 id="5-2-ArrayListçš„åº•å±‚æœºåˆ¶æºç åˆ†æ"><a href="#5-2-ArrayListçš„åº•å±‚æœºåˆ¶æºç åˆ†æ" class="headerlink" title="5.2 ArrayListçš„åº•å±‚æœºåˆ¶æºç åˆ†æ"></a>5.2 ArrayListçš„åº•å±‚æœºåˆ¶æºç åˆ†æ</h2><ul>
<li>ArrayListä¸­ç»´æŠ¤äº†ä¸€ä¸ªObjectç±»å‹çš„æ•°ç»„<code>elementData</code></li>
<li>å½“åˆ›å»ºArrayListå¯¹è±¡<ul>
<li>ä½¿ç”¨æ— å‚æ„é€ ï¼Œåˆå§‹<code>elementData</code>å®¹é‡ä¸º0ï¼Œç¬¬ä¸€æ¬¡æ·»åŠ ï¼Œæ‰©å®¹çš„<code>elementData</code>ä¸º10ï¼Œ<strong>å¦‚æœéœ€è¦å†æ¬¡æ‰©å®¹ï¼Œæ‰©å®¹çš„<code>elementData</code>ä¸º1.5å€</strong></li>
<li>ä½¿ç”¨æŒ‡å®šå¤§å°çš„æ„é€ å™¨ï¼Œåˆå§‹åŒ–<code>elementData</code>ä¸ºæŒ‡å®šå¤§å°ï¼Œ<strong>å¦‚æœéœ€è¦æ‰©å®¹ï¼Œç›´æ¥æ‰©å®¹<code>elementData</code>çš„1.5å€</strong></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> ArrayListSource</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ArrayListæºç åˆ†æ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/24 21:47</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayListSource</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨æ— å‚æ„é€ å™¨åˆ›å»º ArrayList å¯¹è±¡</span></span><br><span class="line">        ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="comment">//ArrayList list = new ArrayList(8);</span></span><br><span class="line">        <span class="comment">//ä½¿ç”¨ for ç»™ list é›†åˆæ·»åŠ  1-10 æ•°æ®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">            list.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨ for ç»™ list é›†åˆæ·»åŠ  11-15 æ•°æ®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">11</span>; i &lt;= <span class="number">15</span>; i++) &#123;</span><br><span class="line">            list.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">        list.add(<span class="number">100</span>);</span><br><span class="line">        list.add(<span class="number">200</span>);</span><br><span class="line">        list.add(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>debugä¸€æŠŠ æ–­ç‚¹ä½ç½®</strong></p>
<p><strong>è¿›å…¥æ–¹æ³•ä¾æ¬¡çœ‹åˆ°ä¸‹åˆ—é‡è¦çš„æ–¹æ³•</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_21-54-19.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-11-34.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_21-54-56.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_21-56-54.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-00-20.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-00-51.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-02-53.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-05-35.png"></p>
<p><strong>å¦‚æœæŒ‡å®šå‚æ•°å¤§å°çš„å®¹é‡</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-24_22-09-32.png"></p>
<h1 id="6-Vectoré›†åˆ"><a href="#6-Vectoré›†åˆ" class="headerlink" title="6. Vectoré›†åˆ"></a>6. Vectoré›†åˆ</h1><h2 id="6-1-Vectoré›†åˆçš„åŸºæœ¬ä»‹ç»"><a href="#6-1-Vectoré›†åˆçš„åŸºæœ¬ä»‹ç»" class="headerlink" title="6.1 Vectoré›†åˆçš„åŸºæœ¬ä»‹ç»"></a>6.1 Vectoré›†åˆçš„åŸºæœ¬ä»‹ç»</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-03-03.png"></p>
<p>å†™ä¸ªç¤ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Vector_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Vectoré›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/26 20:41</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vector_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è¿™é‡ŒæŒ‡å®šå¤§å°ä¸º8</span></span><br><span class="line">        Vector&lt;Object&gt; vector = <span class="keyword">new</span> Vector&lt;&gt;(<span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            vector.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(vector.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥æ¢ç©¶ä¸€ä¸‹æºç  debugèµ°èµ·ï¼</p>
<p><strong>æ–­ç‚¹ä½ç½® å¦‚ä¸‹</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-05-04.png"></p>
<ul>
<li>é¦–å…ˆæ˜¯åˆå§‹åŒ–å¤§å°</li>
<li>ç„¶åæ˜¯åˆ¤æ–­å®¹é‡æ˜¯å¦å¤Ÿ<ul>
<li>ä¸å¤Ÿå°±ç”¨ç®—æ³•æ‰©å®¹</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_20-55-44.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_20-56-51.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_20-57-24.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_20-58-07.png"></p>
<p><strong>è¿™é‡Œæ‰©å®¹çš„å¤§å°æ˜¯åŸæ¥çš„2å€</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-01-55.png"></p>
<h2 id="6-2-Vector-å’Œ-ArrayList-çš„æ¯”è¾ƒ"><a href="#6-2-Vector-å’Œ-ArrayList-çš„æ¯”è¾ƒ" class="headerlink" title="6.2 Vector å’Œ ArrayList çš„æ¯”è¾ƒ"></a>6.2 Vector å’Œ ArrayList çš„æ¯”è¾ƒ</h2><table>
<thead>
<tr>
<th></th>
<th>åº•å±‚ç»“æ„</th>
<th>ç‰ˆæœ¬</th>
<th>çº¿ç¨‹å®‰å…¨åŒæ­¥(æ•ˆç‡)</th>
</tr>
</thead>
<tbody><tr>
<td>ArrayList</td>
<td>å¯å˜æ•°ç»„</td>
<td>jdk1.2</td>
<td>ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜</td>
</tr>
<tr>
<td>Vector</td>
<td>å¯å˜æ•°ç»„Object[]</td>
<td>jdk1.0</td>
<td>å®‰å…¨ï¼Œæ•ˆç‡ä¸é«˜</td>
</tr>
</tbody></table>
<p><strong>æ‰©å®¹å€æ•°</strong></p>
<ul>
<li>ArrayList<ul>
<li>å¦‚æœæœ‰å‚æ„é€ 1.5å€</li>
<li>å¦‚æœæ˜¯æ— å‚æ„é€ <ul>
<li>ç¬¬ä¸€æ¬¡10</li>
<li>ç¬¬äºŒæ¬¡å¼€å§‹æŒ‰ç…§1.5å€æ‰©å®¹</li>
</ul>
</li>
</ul>
</li>
<li>Vector<ul>
<li>å¦‚æœæ˜¯æ— å‚ é»˜è®¤æ˜¯10 æ»¡å æŒ‰ç…§2å€å¼€å§‹æ‰©å®¹</li>
<li>æŒ‡å®šå¤§å°ï¼Œæ¯æ¬¡æŒ‰ç…§2å€æ‰©å®¹</li>
</ul>
</li>
</ul>
<h1 id="7-LinkedListé›†åˆ"><a href="#7-LinkedListé›†åˆ" class="headerlink" title="7. LinkedListé›†åˆ"></a>7. LinkedListé›†åˆ</h1><h2 id="7-1-LinkedListåŸºæœ¬ä»‹ç»"><a href="#7-1-LinkedListåŸºæœ¬ä»‹ç»" class="headerlink" title="7.1 LinkedListåŸºæœ¬ä»‹ç»"></a>7.1 LinkedListåŸºæœ¬ä»‹ç»</h2><ul>
<li>LinkedListåº•å±‚å®ç°äº†åŒå‘é“¾è¡¨å’ŒåŒç«¯é˜Ÿåˆ—ç‰¹ç‚¹</li>
<li>å¯ä»¥æ·»åŠ ä»»æ„å…ƒç´  å¯ä»¥é‡å¤ï¼ŒåŒ…æ‹¬null</li>
<li>çº¿ç¨‹ä¸å®‰å…¨ï¼Œæ²¡æœ‰å®ç°åŒæ­¥</li>
</ul>
<h2 id="7-2-LinkedListçš„åº•å±‚æ“ä½œæœºåˆ¶"><a href="#7-2-LinkedListçš„åº•å±‚æ“ä½œæœºåˆ¶" class="headerlink" title="7.2 LinkedListçš„åº•å±‚æ“ä½œæœºåˆ¶"></a>7.2 LinkedListçš„åº•å±‚æ“ä½œæœºåˆ¶</h2><ul>
<li>LinkedListåº•å±‚ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨</li>
<li>LinkedListä¸­ç»´æŠ¤äº†ä¸¤ä¸ªå±æ€§firstå’Œlaståˆ†åˆ«æŒ‡å‘ é¦–èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹</li>
<li>æ¯ä¸ªèŠ‚ç‚¹ Nodeå¯¹è±¡ é‡Œé¢åˆç»´æŠ¤äº†pre next item ä¸‰ä¸ªå±æ€§ é€šè¿‡preæŒ‡å‘å‰ä¸€ä¸ª é€šè¿‡nextæŒ‡å‘åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœ€ç»ˆå®ç°åŒå‘é“¾è¡¨</li>
<li>æ‰€ä»¥LinkedListçš„å…ƒç´ çš„æ·»åŠ å’Œåˆ é™¤ï¼Œä¸æ˜¯é€šè¿‡æ•°ç»„å®Œæˆçš„ï¼Œç›¸å¯¹æ¥è¯´æ•ˆç‡è¾ƒé«˜</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-49-16.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> LinkedList01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> LinkedListä¾‹å­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/26 21:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedList01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ¨¡æ‹Ÿä¸€ä¸ªç®€å•çš„åŒå‘é“¾è¡¨</span></span><br><span class="line">        Node jack = <span class="keyword">new</span> Node(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        Node tom = <span class="keyword">new</span> Node(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        Node kang = <span class="keyword">new</span> Node(<span class="string">&quot;kang&quot;</span>);</span><br><span class="line">        <span class="comment">//è¿æ¥ä¸‰ä¸ªç»“ç‚¹ï¼Œå½¢æˆåŒå‘é“¾è¡¨</span></span><br><span class="line">        <span class="comment">//jack -&gt; tom -&gt; kang</span></span><br><span class="line">        jack.next = tom;</span><br><span class="line">        tom.next = kang;</span><br><span class="line">        <span class="comment">//kang -&gt; tom -&gt; jack</span></span><br><span class="line">        kang.pre = tom;</span><br><span class="line">        tom.pre = jack;</span><br><span class="line">        <span class="comment">//è®© first å¼•ç”¨æŒ‡å‘ jack,å°±æ˜¯åŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹</span></span><br><span class="line">        Node first = jack;</span><br><span class="line">        <span class="comment">//è®© last å¼•ç”¨æŒ‡å‘ kang,å°±æ˜¯åŒå‘é“¾è¡¨çš„å°¾ç»“ç‚¹</span></span><br><span class="line">        Node last = kang;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===ä»å¤´åˆ°å°¾è¿›è¡Œéå†===&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (first==<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(first);</span><br><span class="line">            <span class="comment">//å¤´èŠ‚ç‚¹æŒ‡å‘ä¸‹ä¸€ä¸ª</span></span><br><span class="line">            first = first.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;====ä»å°¾åˆ°å¤´çš„éå†====&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(last == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">//è¾“å‡º last ä¿¡æ¯</span></span><br><span class="line">            System.out.println(last);</span><br><span class="line">            last = last.pre;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–°åŠ ä¸€ä¸ªnodeèŠ‚ç‚¹</span></span><br><span class="line">        Node jerry=<span class="keyword">new</span> Node(<span class="string">&quot;jerry&quot;</span>);</span><br><span class="line"></span><br><span class="line">        jerry.next=tom;</span><br><span class="line">        jerry.pre = jack;</span><br><span class="line">        tom.pre=jerry;</span><br><span class="line">        jack.next=jerry;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®© first å†æ¬¡æŒ‡å‘ jack</span></span><br><span class="line">        first = jack;<span class="comment">//è®© first å¼•ç”¨æŒ‡å‘ jack,å°±æ˜¯åŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        last=kang;</span><br><span class="line">        System.out.println(<span class="string">&quot;===ä»å¤´åˆ°å°¾è¿›è¡Œéå†===&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (first==<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(first);</span><br><span class="line">            <span class="comment">//å¤´èŠ‚ç‚¹æŒ‡å‘ä¸‹ä¸€ä¸ª</span></span><br><span class="line">            first = first.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;====ä»å°¾åˆ°å¤´çš„éå†====&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(last == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//è¾“å‡º last ä¿¡æ¯</span></span><br><span class="line">            System.out.println(last);</span><br><span class="line">            last = last.pre;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ª Node ç±»ï¼ŒNode å¯¹è±¡ è¡¨ç¤ºåŒå‘é“¾è¡¨çš„ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> Object item; <span class="comment">//çœŸæ­£å­˜æ”¾æ•°æ®</span></span><br><span class="line">        <span class="keyword">public</span> Node next; <span class="comment">//æŒ‡å‘åä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line">        <span class="keyword">public</span> Node pre; <span class="comment">//æŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(Object name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.item = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Node name&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;item=&quot;</span> + item +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-27-10.png"></p>
<p>æ¢ç©¶ä¸‹æºç  <strong>çœ‹çœ‹å¢åˆ çš„æ“ä½œ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> LinkedListCRUD</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> é“¾è¡¨çš„å¢åˆ æ”¹æŸ¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/26 21:27</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedListCRUD</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        LinkedList linkedList = <span class="keyword">new</span> LinkedList();</span><br><span class="line">        linkedList.add(<span class="number">1</span>);</span><br><span class="line">        linkedList.add(<span class="number">2</span>);</span><br><span class="line">        linkedList.add(<span class="number">3</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;linkedList=&quot;</span> + linkedList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¼”ç¤ºä¸€ä¸ªåˆ é™¤ç»“ç‚¹çš„</span></span><br><span class="line">        <span class="comment">// è¿™é‡Œé»˜è®¤åˆ é™¤çš„æ˜¯ç¬¬ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line">        linkedList.remove();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;linkedList=&quot;</span> + linkedList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿®æ”¹æŸä¸ªç»“ç‚¹å¯¹è±¡</span></span><br><span class="line">        linkedList.set(<span class="number">1</span>, <span class="number">999</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;linkedList=&quot;</span> + linkedList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¾—åˆ°æŸä¸ªç»“ç‚¹å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//get(1) æ˜¯å¾—åˆ°åŒå‘é“¾è¡¨çš„ç¬¬äºŒä¸ªå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">        Object o = linkedList.get(<span class="number">1</span>);</span><br><span class="line">        System.out.println(o);<span class="comment">//999</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å› ä¸º LinkedList æ˜¯ å®ç°äº† List æ¥å£, éå†æ–¹å¼</span></span><br><span class="line">        System.out.println(<span class="string">&quot;===LinkeList éå†è¿­ä»£å™¨====&quot;</span>);</span><br><span class="line">        Iterator iterator = linkedList.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Object next = iterator.next();</span><br><span class="line">            System.out.println(<span class="string">&quot;next=&quot;</span> + next);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===LinkeList éå†å¢å¼º for====&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object o1 : linkedList) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;o1=&quot;</span> + o1);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;===LinkeList éå†æ™®é€š for====&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; linkedList.size(); i++) &#123;</span><br><span class="line">            System.out.println(linkedList.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-51-19.png"></p>
<p>debugæ–­ç‚¹ä½ç½®</p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-50-14.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-36-43.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-38-48.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-39-26.png" alt="Snipaste_2021-05-26_21-39-26"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-40-07.png" alt="Snipaste_2021-05-26_21-40-07"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-40-46.png" alt="Snipaste_2021-05-26_21-40-46"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-26_21-41-37.png" alt="Snipaste_2021-05-26_21-41-37"></p>
<h2 id="7-3-ArrayListå’ŒLinkedListæ¯”è¾ƒ"><a href="#7-3-ArrayListå’ŒLinkedListæ¯”è¾ƒ" class="headerlink" title="7.3 ArrayListå’ŒLinkedListæ¯”è¾ƒ"></a>7.3 ArrayListå’ŒLinkedListæ¯”è¾ƒ</h2><table>
<thead>
<tr>
<th></th>
<th>åº•å±‚ç»“æ„</th>
<th>å¢åˆ çš„æ•ˆç‡</th>
<th>æ”¹æŸ¥çš„æ•ˆç‡</th>
</tr>
</thead>
<tbody><tr>
<td>ArrayList</td>
<td>å¯å˜æ•°ç»„</td>
<td>è¾ƒä½ æ•°ç»„æ‰©å®¹</td>
<td>è¾ƒé«˜</td>
</tr>
<tr>
<td>LinkedList</td>
<td>åŒå‘é“¾è¡¨</td>
<td>è¾ƒé«˜ é€šè¿‡é“¾è¡¨è¿½åŠ </td>
<td>è¾ƒä½</td>
</tr>
</tbody></table>
<p><strong>å¦‚ä½•é€‰æ‹©ä¸¤è€…ä¸­ï¼Ÿ</strong></p>
<ul>
<li>æ”¹æŸ¥æ“ä½œå¤šï¼Œé€‰æ‹©ArrayList</li>
<li>å¢åˆ æ“ä½œå¤šï¼Œé€‰æ‹©LinkedList</li>
</ul>
<h1 id="8-Seté›†åˆ"><a href="#8-Seté›†åˆ" class="headerlink" title="8. Seté›†åˆ"></a>8. Seté›†åˆ</h1><h2 id="8-1-åŸºæœ¬ä»‹ç»"><a href="#8-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="8.1 åŸºæœ¬ä»‹ç»"></a>8.1 åŸºæœ¬ä»‹ç»</h2><ul>
<li>æ— åºï¼Œ<strong>æ²¡æœ‰ç´¢å¼•</strong></li>
<li>ä¸å…è®¸é‡å¤å…ƒç´ ï¼Œæ‰€ä»¥æœ€å¤šåŒ…å«ä¸€ä¸ªnull</li>
<li>å®ç°ç±»æœ‰<ul>
<li>TreeSet</li>
<li>HashSet</li>
</ul>
</li>
</ul>
<h2 id="8-2-å¸¸ç”¨æ–¹æ³•"><a href="#8-2-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="8.2 å¸¸ç”¨æ–¹æ³•"></a>8.2 å¸¸ç”¨æ–¹æ³•</h2><p>å’ŒListæ¥å£ä¸€æ · Setæ¥å£ä¹Ÿæ˜¯Collectionå­æ¥å£ï¼Œå¸¸ç”¨æ–¹æ³•å’ŒCollectionæ¥å£ä¸€æ ·</p>
<p><strong>éå†æ–¹å¼</strong></p>
<ul>
<li>å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨</li>
<li>å¢å¼ºfor</li>
<li>ä¸èƒ½ä½¿ç”¨ç´¢å¼•çš„æ–¹å¼æ¥è·å–</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> SetMethod</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Seté›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/26 21:57</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SetMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. ä»¥ Set æ¥å£çš„å®ç°ç±» HashSet æ¥è®²è§£ Set æ¥å£çš„æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//2. set æ¥å£çš„å®ç°ç±»çš„å¯¹è±¡(Set æ¥å£å¯¹è±¡), ä¸èƒ½å­˜æ”¾é‡å¤çš„å…ƒç´ , å¯ä»¥æ·»åŠ ä¸€ä¸ª null</span></span><br><span class="line">        <span class="comment">//3. set æ¥å£å¯¹è±¡å­˜æ”¾æ•°æ®æ˜¯æ— åº(å³æ·»åŠ çš„é¡ºåºå’Œå–å‡ºçš„é¡ºåºä¸ä¸€è‡´)</span></span><br><span class="line">       <span class="comment">//4. æ³¨æ„ï¼šå–å‡ºçš„é¡ºåºçš„é¡ºåºè™½ç„¶ä¸æ˜¯æ·»åŠ çš„é¡ºåºï¼Œä½†æ˜¯ä»–çš„å›ºå®š.</span></span><br><span class="line">    Set set = <span class="keyword">new</span> HashSet();</span><br><span class="line">        set.add(<span class="string">&quot;john&quot;</span>);</span><br><span class="line">        set.add(<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">        <span class="comment">//é‡å¤</span></span><br><span class="line">        set.add(<span class="string">&quot;john&quot;</span>);</span><br><span class="line">        set.add(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        set.add(<span class="string">&quot;zk&quot;</span>);</span><br><span class="line">        set.add(<span class="string">&quot;mary&quot;</span>);</span><br><span class="line">        set.add(<span class="keyword">null</span>);</span><br><span class="line">        set.add(<span class="keyword">null</span>);<span class="comment">//å†æ¬¡æ·»åŠ  null</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;set=&quot;</span> + set);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//éå†</span></span><br><span class="line">        System.out.println(<span class="string">&quot;=====ä½¿ç”¨è¿­ä»£å™¨====&quot;</span>);</span><br><span class="line">        Iterator iterator = set.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Object obj = iterator.next();</span><br><span class="line">            System.out.println(<span class="string">&quot;obj=&quot;</span> + obj);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        set.remove(<span class="keyword">null</span>);</span><br><span class="line">        <span class="comment">//æ–¹å¼ 2: å¢å¼º for</span></span><br><span class="line">        System.out.println(<span class="string">&quot;=====å¢å¼º for====&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object o : set) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;o=&quot;</span> + o);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//set æ¥å£å¯¹è±¡ï¼Œä¸èƒ½é€šè¿‡ç´¢å¼•æ¥è·å–</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="9-HashSeté›†åˆ"><a href="#9-HashSeté›†åˆ" class="headerlink" title="9. HashSeté›†åˆ"></a>9. HashSeté›†åˆ</h1><h2 id="9-1-HashSeté›†åˆåŸºæœ¬ä»‹ç»"><a href="#9-1-HashSeté›†åˆåŸºæœ¬ä»‹ç»" class="headerlink" title="9.1 HashSeté›†åˆåŸºæœ¬ä»‹ç»"></a>9.1 HashSeté›†åˆåŸºæœ¬ä»‹ç»</h2><ul>
<li>HashSetå®é™…æ˜¯Setæ¥å£</li>
<li>HashSetå®é™…æ˜¯HashMap çœ‹æºç å›¾</li>
<li>å¯ä»¥å­˜æ”¾nullå€¼ï¼Œä½†æ˜¯åªèƒ½ä¸€ä¸ªnull</li>
<li>HashSetä¸ä¿è¯å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œå–å†³äºhashåï¼Œå†ç¡®å®šç´¢å¼•çš„ç»“æœ <strong>å³ ä¸ä¿è¯å­˜æ”¾çš„å…ƒç´ å’Œå–å‡ºé¡ºåºä¸€è‡´</strong></li>
<li>ä¸èƒ½æœ‰é‡å¤çš„å…ƒç´ /å¯¹è±¡ï¼Œåœ¨å‰é¢Setæ¥å£ä¸­æåˆ°è¿‡</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HashSet_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> HashSeté›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/27 21:37</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSet_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Set hashSet = <span class="keyword">new</span> HashSet();</span><br><span class="line">        hashSet.add(<span class="keyword">null</span>);</span><br><span class="line">        hashSet.add(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;hashSet=&quot;</span> + hashSet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡ºçš„å€¼ä¸º null</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-40-46.png"></p>
<p>ç”±æºç å¯è§ <strong>HashSetå°±æ˜¯HashMap</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HashSet01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/27 21:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSet01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HashSet set = <span class="keyword">new</span> HashSet();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. åœ¨æ‰§è¡Œ add æ–¹æ³•åï¼Œä¼šè¿”å›ä¸€ä¸ª boolean å€¼</span></span><br><span class="line">        <span class="comment">//2. å¦‚æœæ·»åŠ æˆåŠŸï¼Œè¿”å› true, å¦åˆ™è¿”å› false</span></span><br><span class="line">        <span class="comment">//3. å¯ä»¥é€šè¿‡ remove æŒ‡å®šåˆ é™¤å“ªä¸ªå¯¹è±¡</span></span><br><span class="line">        <span class="comment">//4. å…ƒç´ ä¸èƒ½é‡å¤</span></span><br><span class="line">        System.out.println(set.add(<span class="string">&quot;john&quot;</span>));<span class="comment">//T</span></span><br><span class="line">        System.out.println(set.add(<span class="string">&quot;lucy&quot;</span>));<span class="comment">//T</span></span><br><span class="line">        System.out.println(set.add(<span class="string">&quot;john&quot;</span>));<span class="comment">//F</span></span><br><span class="line">        System.out.println(set.add(<span class="string">&quot;jack&quot;</span>));<span class="comment">//T</span></span><br><span class="line">        System.out.println(set.add(<span class="string">&quot;Rose&quot;</span>));<span class="comment">//T</span></span><br><span class="line">        set.remove(<span class="string">&quot;john&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;set=&quot;</span> + set);<span class="comment">//3 ä¸ª</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        set.add(<span class="string">&quot;lucy&quot;</span>);<span class="comment">//æ·»åŠ æˆåŠŸ</span></span><br><span class="line">        set.add(<span class="string">&quot;lucy&quot;</span>);<span class="comment">//åŠ å…¥ä¸äº†</span></span><br><span class="line">        set.add(<span class="keyword">new</span> Dog(<span class="string">&quot;tom&quot;</span>));<span class="comment">//OK</span></span><br><span class="line">        set.add(<span class="keyword">new</span> Dog(<span class="string">&quot;tom&quot;</span>));<span class="comment">//Ok</span></span><br><span class="line">        System.out.println(<span class="string">&quot;set=&quot;</span> + set);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123; <span class="comment">//å®šä¹‰äº† Dog ç±»</span></span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Dog</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Dog&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-49-03.png"></p>
<h2 id="9-2-HashSetçš„åº•å±‚æœºåˆ¶æºç åˆ†æ"><a href="#9-2-HashSetçš„åº•å±‚æœºåˆ¶æºç åˆ†æ" class="headerlink" title="9.2 HashSetçš„åº•å±‚æœºåˆ¶æºç åˆ†æ"></a>9.2 HashSetçš„åº•å±‚æœºåˆ¶æºç åˆ†æ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HashSetSource</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> HashSetçš„æºç æ¢ç©¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/27 21:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSetSource</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HashSet hashSet = <span class="keyword">new</span> HashSet();</span><br><span class="line">        hashSet.add(<span class="string">&quot;java&quot;</span>);<span class="comment">//åˆ°æ­¤ä½ç½®ï¼Œç¬¬ 1 æ¬¡ add åˆ†æå®Œæ¯•. hashSet.add(&quot;php&quot;);//åˆ°æ­¤ä½ç½®ï¼Œç¬¬ 2 æ¬¡ add åˆ†æå®Œæ¯•</span></span><br><span class="line">        hashSet.add(<span class="string">&quot;java&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;set=&quot;</span> + hashSet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>debug ä¸€æŠŠ æ–­ç‚¹ä½ç½®</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_10-53-37.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_22-02-33.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-40-46.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-53-41.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-54-05.png" alt="Snipaste_2021-05-27_21-54-05"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-55-50.png" alt="Snipaste_2021-05-27_21-55-50"></p>
<p><strong>ç”±äºè¯¥æ–¹æ³•å¤ªé•¿ å•ç‹¬æ‹¿å‡ºæ¥åˆ†æ æ ¸å¿ƒæºç ï¼</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-59-35.png" alt="image-20210527220005260"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">                   <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰äº†è¾…åŠ©å˜é‡</span></span><br><span class="line">        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="comment">//table å°±æ˜¯ HashMapçš„ä¸€ä¸ªæ•°ç»„ ç±»å‹æ˜¯ Node[]</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    ifè¯­å¥è¡¨ç¤ºå¦‚æœå½“å‰çš„table æ˜¯null æˆ–è€…å¤§å°ä¸º0</span></span><br><span class="line"><span class="comment">    å°±æ˜¯ç¬¬ä¸€æ¬¡æ‰©å®¹ 16ä¸ªç©ºé—´</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">        <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">            n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    (1)æ ¹æ® keyï¼Œå¾—åˆ° hash å»è®¡ç®—è¯¥ key åº”è¯¥å­˜æ”¾åˆ° table è¡¨çš„å“ªä¸ªç´¢å¼•ä½ç½®å¹¶æŠŠè¿™ä¸ªä½ç½®çš„å¯¹è±¡ï¼Œèµ‹ç»™ p</span></span><br><span class="line"><span class="comment">	(2)åˆ¤æ–­ p æ˜¯å¦ä¸º null</span></span><br><span class="line"><span class="comment">	(2.1) å¦‚æœ p ä¸º null, è¡¨ç¤ºè¿˜æ²¡æœ‰å­˜æ”¾å…ƒç´ , å°±åˆ›å»ºä¸€ä¸ª Node (key=&quot;java&quot;,value=PRESENT)</span></span><br><span class="line"><span class="comment">	(2.2) å°±æ”¾åœ¨è¯¥ä½ç½® tab[i] = newNode(hash, key, value, null)</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">        <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">            tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;K,V&gt; e; K k;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            å¦‚æœå½“å‰ç´¢å¼•ä½ç½®å¯¹åº”çš„é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ å’Œå‡†å¤‡æ·»åŠ çš„keyçš„hashå€¼ä¸€æ ·</span></span><br><span class="line"><span class="comment">            å¹¶ä¸”æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€</span></span><br><span class="line"><span class="comment">            1.å‡†å¤‡åŠ å…¥çš„keyå’ŒpæŒ‡å‘çš„NodeèŠ‚ç‚¹çš„keyæ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment">            2.pæŒ‡å‘çš„NodeèŠ‚ç‚¹çš„keyçš„equalså’Œå‡†å¤‡åŠ å…¥çš„keyæ¯”è¾ƒåç›¸åŒå°±ä¸èƒ½åŠ å…¥ è¿™å°±æ˜¯ä¸å…è®¸é‡å¤çš„å€¼</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">                ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                e = p;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            å†åˆ¤æ–­pæ˜¯ä¸æ˜¯ä¸€é¢—çº¢é»‘æ ‘</span></span><br><span class="line"><span class="comment">            å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œå°±è°ƒç”¨putTreeValï¼Œè¿›è¡Œæ·»åŠ </span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">	    	å¦‚æœ table å¯¹åº”ç´¢å¼•ä½ç½®ï¼Œå·²ç»æ˜¯ä¸€ä¸ªé“¾è¡¨, å°±ä½¿ç”¨ for å¾ªç¯æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment">		(1) ä¾æ¬¡å’Œè¯¥é“¾è¡¨çš„æ¯ä¸€ä¸ªå…ƒç´ æ¯”è¾ƒåï¼Œéƒ½ä¸ç›¸åŒ, åˆ™åŠ å…¥åˆ°è¯¥é“¾è¡¨çš„æœ€åæ³¨æ„åœ¨æŠŠå…ƒç´ æ·»åŠ åˆ°é“¾è¡¨åï¼Œ</span></span><br><span class="line"><span class="comment">		ç«‹å³åˆ¤æ–­ è¯¥é“¾è¡¨æ˜¯å¦å·²ç»è¾¾åˆ° 8 ä¸ªç»“ç‚¹ï¼Œè¾¾åˆ°8ä¸ªç»“ç‚¹ï¼Œ	</span></span><br><span class="line"><span class="comment">		å°±è°ƒç”¨ treeifyBin() å¯¹å½“å‰è¿™ä¸ªé“¾è¡¨è¿›è¡Œæ ‘åŒ–(è½¬æˆçº¢é»‘æ ‘)</span></span><br><span class="line"><span class="comment">		æ³¨æ„ï¼Œåœ¨è½¬æˆçº¢é»‘æ ‘æ—¶ï¼Œè¦è¿›è¡Œåˆ¤æ–­, åˆ¤æ–­æ¡ä»¶</span></span><br><span class="line"><span class="comment">		if (tab == null || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY(64))</span></span><br><span class="line"><span class="comment">		resize();</span></span><br><span class="line"><span class="comment"> 		å¦‚æœä¸Šé¢æ¡ä»¶æˆç«‹ï¼Œå…ˆ table æ‰©å®¹. // åªæœ‰ä¸Šé¢æ¡ä»¶ä¸æˆç«‹æ—¶ï¼Œæ‰è¿›è¡Œè½¬æˆçº¢é»‘æ ‘</span></span><br><span class="line"><span class="comment">		(2) ä¾æ¬¡å’Œè¯¥é“¾è¡¨çš„æ¯ä¸€ä¸ªå…ƒç´ æ¯”è¾ƒè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰ç›¸åŒæƒ…å†µ,å°±ç›´æ¥ break</span></span><br><span class="line"><span class="comment">				*/</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                        <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                            treeifyBin(tab, hash);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                        ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    p = e;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">                V oldValue = e.value;</span><br><span class="line">                <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                    e.value = value;</span><br><span class="line">                afterNodeAccess(e);</span><br><span class="line">                <span class="keyword">return</span> oldValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ++modCount;</span><br><span class="line">    	<span class="comment">//size å°±æ˜¯æˆ‘ä»¬æ¯åŠ å…¥ä¸€ä¸ªç»“ç‚¹ Node(k,v,h,next), </span></span><br><span class="line">        <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">            resize(); <span class="comment">//æ‰©å®¹çš„æ–¹æ³•</span></span><br><span class="line">        afterNodeInsertion(evict);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_10-55-09.png"></p>
<p><strong>æ‰©å®¹æœºåˆ¶</strong></p>
<blockquote>
<ul>
<li><p>HashSet åº•å±‚æ˜¯ HashMap, ç¬¬ä¸€æ¬¡æ·»åŠ æ—¶ï¼Œtable æ•°ç»„æ‰©å®¹åˆ° 16ï¼Œ</p>
<pre><code>    ä¸´ç•Œå€¼(threshold)æ˜¯ 16*åŠ è½½å› å­(loadFactor)æ˜¯ 0.75 = 12
    å¦‚æœ table æ•°ç»„ä½¿ç”¨åˆ°äº†ä¸´ç•Œå€¼ 12,å°±ä¼šæ‰©å®¹åˆ° 16 * 2 = 32
    æ–°çš„ä¸´ç•Œå€¼å°±æ˜¯ 32*0.75 = 24, ä¾æ¬¡ç±»æ¨
</code></pre>
</li>
<li><p>åœ¨ Java8 ä¸­, å¦‚æœä¸€æ¡é“¾è¡¨çš„å…ƒç´ ä¸ªæ•°åˆ°è¾¾ TREEIFY_THRESHOLD(é»˜è®¤æ˜¯ 8 )ï¼Œ</p>
<pre><code>å¹¶ä¸” table çš„å¤§å° &gt;= MIN_TREEIFY_CAPACITY(é»˜è®¤ 64),å°±ä¼šè¿›è¡Œæ ‘åŒ–(çº¢é»‘æ ‘),
å¦åˆ™ä»ç„¶é‡‡ç”¨æ•°ç»„æ‰©å®¹æœºåˆ¶
</code></pre>
</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HashSetIncrement</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> æ‰©å®¹æºç æ¢ç©¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/27 22:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSetIncrement</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HashSet hashSet = <span class="keyword">new</span> HashSet();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;<span class="number">20</span>; i++) &#123;</span><br><span class="line">            hashSet.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">         HashSet åº•å±‚æ˜¯ HashMap, ç¬¬ä¸€æ¬¡æ·»åŠ æ—¶ï¼Œtable æ•°ç»„æ‰©å®¹åˆ° 16ï¼Œ</span></span><br><span class="line"><span class="comment">        ä¸´ç•Œå€¼(threshold)æ˜¯ 16*åŠ è½½å› å­(loadFactor)æ˜¯ 0.75 = 12</span></span><br><span class="line"><span class="comment">        å¦‚æœ table æ•°ç»„ä½¿ç”¨åˆ°äº†ä¸´ç•Œå€¼ 12,å°±ä¼šæ‰©å®¹åˆ° 16 * 2 = 32</span></span><br><span class="line"><span class="comment">        æ–°çš„ä¸´ç•Œå€¼å°±æ˜¯ 32*0.75 = 24, ä¾æ¬¡ç±»æ¨</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        åœ¨ Java8 ä¸­, å¦‚æœä¸€æ¡é“¾è¡¨çš„å…ƒç´ ä¸ªæ•°åˆ°è¾¾ TREEIFY_THRESHOLD(é»˜è®¤æ˜¯ 8 )ï¼Œ</span></span><br><span class="line"><span class="comment">        å¹¶ä¸” table çš„å¤§å° &gt;= MIN_TREEIFY_CAPACITY(é»˜è®¤ 64),å°±ä¼šè¿›è¡Œæ ‘åŒ–(çº¢é»‘æ ‘),</span></span><br><span class="line"><span class="comment">        å¦åˆ™ä»ç„¶é‡‡ç”¨æ•°ç»„æ‰©å®¹æœºåˆ¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-3-HashSetç»ƒä¹ "><a href="#9-3-HashSetç»ƒä¹ " class="headerlink" title="9.3 HashSetç»ƒä¹ "></a>9.3 HashSetç»ƒä¹ </h2><blockquote>
<p>å®šä¹‰ä¸€ä¸ª Employee ç±»ï¼Œè¯¥ç±»åŒ…å«ï¼šprivate æˆå‘˜å±æ€§ name,age </p>
<p>è¦æ±‚: åˆ›å»º 3 ä¸ª Employee å¯¹è±¡æ”¾å…¥ HashSet ä¸­ å½“ name å’Œ age çš„å€¼ç›¸åŒæ—¶ï¼Œè®¤ä¸ºæ˜¯ç›¸åŒå‘˜å·¥, ä¸èƒ½æ·»åŠ åˆ° HashSet é›†åˆä¸­</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HashSetExercise</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Hashç»ƒä¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 9:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSetExercise</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HashSet hashSet = <span class="keyword">new</span> HashSet();</span><br><span class="line">        hashSet.add(<span class="keyword">new</span> Employee(<span class="string">&quot;milan&quot;</span>, <span class="number">18</span>));<span class="comment">//ok</span></span><br><span class="line">        hashSet.add(<span class="keyword">new</span> Employee(<span class="string">&quot;smith&quot;</span>, <span class="number">28</span>));<span class="comment">//ok</span></span><br><span class="line">        hashSet.add(<span class="keyword">new</span> Employee(<span class="string">&quot;milan&quot;</span>, <span class="number">18</span>));<span class="comment">//åŠ å…¥ä¸æˆåŠŸ.</span></span><br><span class="line">        System.out.println(hashSet);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Employee&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            Employee employee = (Employee) o;</span><br><span class="line">            <span class="keyword">return</span> age == employee.age &amp;&amp; Objects.equals(name, employee.name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Objects.hash(name, age);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_09-46-11.png"></p>
<h1 id="10-LinkedHashSeté›†åˆ"><a href="#10-LinkedHashSeté›†åˆ" class="headerlink" title="10. LinkedHashSeté›†åˆ"></a>10. LinkedHashSeté›†åˆ</h1><h2 id="10-1-LinkedHashSetåŸºç¡€ä»‹ç»"><a href="#10-1-LinkedHashSetåŸºç¡€ä»‹ç»" class="headerlink" title="10.1 LinkedHashSetåŸºç¡€ä»‹ç»"></a>10.1 LinkedHashSetåŸºç¡€ä»‹ç»</h2><ul>
<li>LinkedHashSetæ˜¯HashSetçš„å­ç±»</li>
<li>LinkedHashSetåº•å±‚æ˜¯ä¸€ä¸ªLinkedHashMap,åº•å±‚ç»´æŠ¤äº†ä¸€ä¸ªæ•°ç»„+åŒå‘é“¾è¡¨</li>
<li>LinkedHashSetæ ¹æ®å…ƒç´ çš„hashCodeå€¼æ¥å†³å®šå…ƒç´ çš„å­˜å‚¨ä½ç½®ï¼ŒåŒæ—¶ä½¿ç”¨é“¾è¡¨ç»´æŠ¤å…ƒç´ çš„æ¬¡åºï¼Œä½¿å¾—å…ƒç´ çœ‹èµ·æ¥æ˜¯æ’å…¥é¡ºåºä¿å­˜çš„</li>
<li>LinkedHashSetä¸å…è®¸æ·»åŠ é‡å¤å…ƒç´ </li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-02-34.png"></p>
<h2 id="10-2-LinkedHashSetç»ƒä¹ "><a href="#10-2-LinkedHashSetç»ƒä¹ " class="headerlink" title="10.2 LinkedHashSetç»ƒä¹ "></a>10.2 LinkedHashSetç»ƒä¹ </h2><blockquote>
<p>Car ç±»(å±æ€§:name,price)ï¼Œ å¦‚æœ name å’Œ price ä¸€æ ·ï¼Œ åˆ™è®¤ä¸ºæ˜¯ç›¸åŒå…ƒç´ ï¼Œå°±ä¸èƒ½æ·»åŠ ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> LinkedHashSetExercise</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> LinkedHashSetç»ƒä¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 9:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedHashSetExercise</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        LinkedHashSet linkedHashSet = <span class="keyword">new</span> LinkedHashSet();</span><br><span class="line">        linkedHashSet.add(<span class="keyword">new</span> Car(<span class="string">&quot;å¥¥æ‹“&quot;</span>, <span class="number">1000</span>));<span class="comment">//OK</span></span><br><span class="line">        linkedHashSet.add(<span class="keyword">new</span> Car(<span class="string">&quot;å¥¥è¿ª&quot;</span>, <span class="number">300000</span>));<span class="comment">//OK</span></span><br><span class="line">        linkedHashSet.add(<span class="keyword">new</span> Car(<span class="string">&quot;æ³•æ‹‰åˆ©&quot;</span>, <span class="number">10000000</span>));<span class="comment">//OK</span></span><br><span class="line">        linkedHashSet.add(<span class="keyword">new</span> Car(<span class="string">&quot;å¥¥è¿ª&quot;</span>, <span class="number">300000</span>));<span class="comment">//åŠ å…¥ä¸äº†</span></span><br><span class="line">        linkedHashSet.add(<span class="keyword">new</span> Car(<span class="string">&quot;ä¿æ—¶æ·&quot;</span>, <span class="number">70000000</span>));<span class="comment">//OK</span></span><br><span class="line">        linkedHashSet.add(<span class="keyword">new</span> Car(<span class="string">&quot;å¥¥è¿ª&quot;</span>, <span class="number">300000</span>));<span class="comment">//åŠ å…¥ä¸äº†</span></span><br><span class="line">        System.out.println(<span class="string">&quot;linkedHashSet=&quot;</span> + linkedHashSet);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">(String name, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.price = price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.price = price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;\nCar&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, price=&quot;</span> + price +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é‡å†™ equals æ–¹æ³• å’Œ hashCode</span></span><br><span class="line">        <span class="comment">//å½“ name å’Œ price ç›¸åŒæ—¶ï¼Œ å°±è¿”å›ç›¸åŒçš„ hashCode å€¼, equals è¿”å› true</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            Car car = (Car) o;</span><br><span class="line">            <span class="keyword">return</span> Double.compare(car.price, price) == <span class="number">0</span> &amp;&amp; Objects.equals(name, car.name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Objects.hash(name, price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_09-51-06.png"></p>
<h1 id="11-Mapæ¥å£"><a href="#11-Mapæ¥å£" class="headerlink" title="11.Mapæ¥å£"></a>11.Mapæ¥å£</h1><h2 id="11-1-Mapæ¥å£åŸºæœ¬ä»‹ç»"><a href="#11-1-Mapæ¥å£åŸºæœ¬ä»‹ç»" class="headerlink" title="11.1 Mapæ¥å£åŸºæœ¬ä»‹ç»"></a>11.1 Mapæ¥å£åŸºæœ¬ä»‹ç»</h2><ul>
<li>Mapä¸Collectionå¹¶åˆ—å­˜åœ¨ï¼Œç”¨äºä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ï¼šKey-Value</li>
<li>Mapä¸­çš„keyå’Œvalueå¯ä»¥æ˜¯ä»»ä½•å¼•ç”¨ç±»å‹çš„æ•°æ®ï¼Œä¼šå°è£…åˆ°HashMap$Nodeå¯¹è±¡ä¸­</li>
<li>Mapä¸­çš„keyä¸å…è®¸é‡å¤</li>
<li>Mapä¸­çš„valueå¯ä»¥é‡å¤</li>
<li>Mapçš„keyå¯ä»¥ä¸ºnullï¼Œvalueä¹Ÿå¯ä»¥ä¸ºnullï¼Œkeyä¸ºnullï¼Œåªèƒ½ä¸€ä¸ªï¼Œvalueä¸ºnullï¼Œå¯ä»¥å¤šä¸ª</li>
<li>keyå’Œvalueä¹‹é—´å­˜åœ¨å•å‘ä¸€å¯¹ä¸€å…³ç³»ï¼Œé€šè¿‡æŒ‡å®šçš„keyæ€»èƒ½æ‰¾åˆ°å¯¹åº”çš„value</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-11-56.png"></p>
<h2 id="11-2-Mapæ¥å£å¸¸ç”¨æ–¹æ³•"><a href="#11-2-Mapæ¥å£å¸¸ç”¨æ–¹æ³•" class="headerlink" title="11.2 Mapæ¥å£å¸¸ç”¨æ–¹æ³•"></a>11.2 Mapæ¥å£å¸¸ç”¨æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MapMethod</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Mapçš„å¸¸ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 9:57</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(<span class="string">&quot;1&quot;</span>, <span class="keyword">new</span> Book(<span class="string">&quot;java&quot;</span>, <span class="number">100</span>));<span class="comment">//OK</span></span><br><span class="line">        map.put(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;äºŒå·&quot;</span>);<span class="comment">//æ›¿æ¢-&gt; ä¸€ä¼šåˆ†ææºç </span></span><br><span class="line">        map.put(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;ä¸‰å·&quot;</span>);<span class="comment">//OK</span></span><br><span class="line">        map.put(<span class="string">&quot;4&quot;</span>, <span class="string">&quot;å››å·&quot;</span>);<span class="comment">//OK</span></span><br><span class="line">        map.put(<span class="string">&quot;5&quot;</span>, <span class="keyword">null</span>);<span class="comment">//OK</span></span><br><span class="line">        map.put(<span class="keyword">null</span>, <span class="string">&quot;ç©º&quot;</span>);<span class="comment">//OK</span></span><br><span class="line">        map.put(<span class="string">&quot;6&quot;</span>, <span class="string">&quot;å…­å·&quot;</span>);<span class="comment">//OK</span></span><br><span class="line">        map.put(<span class="string">&quot;7&quot;</span>, <span class="string">&quot;ä¸ƒå·&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;map=&quot;</span> + map);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// remove:æ ¹æ®é”®åˆ é™¤æ˜ å°„å…³ç³»</span></span><br><span class="line">        map.remove(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;map=&quot;</span> + map);</span><br><span class="line">        <span class="comment">// getï¼šæ ¹æ®é”®è·å–å€¼</span></span><br><span class="line">        Object val = map.get(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;val=&quot;</span> + val);</span><br><span class="line">        <span class="comment">// size:è·å–å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">        System.out.println(<span class="string">&quot;k-v=&quot;</span> + map.size());</span><br><span class="line">        <span class="comment">// isEmpty:åˆ¤æ–­ä¸ªæ•°æ˜¯å¦ä¸º 0</span></span><br><span class="line">        System.out.println(map.isEmpty());<span class="comment">//F</span></span><br><span class="line">        <span class="comment">// clear:æ¸…é™¤ k-v</span></span><br><span class="line">        <span class="comment">//map.clear();</span></span><br><span class="line">        System.out.println(<span class="string">&quot;map=&quot;</span> + map);</span><br><span class="line">        <span class="comment">// containsKey:æŸ¥æ‰¾é”®æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ç»“æœ=&quot;</span> + map.containsKey(<span class="string">&quot;6&quot;</span>));<span class="comment">//T</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> num;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">(String name, <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.num = num;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Book&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, num=&quot;</span> + num +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_10-04-53.png"></p>
<h2 id="11-3-Mapæ¥å£éå†æ–¹æ³•"><a href="#11-3-Mapæ¥å£éå†æ–¹æ³•" class="headerlink" title="11.3 Mapæ¥å£éå†æ–¹æ³•"></a>11.3 Mapæ¥å£éå†æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> MapFor</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Mapé›†åˆéå†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 10:05</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapFor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;ä¸€å·&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;äºŒå·&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;ä¸‰å·&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;4&quot;</span>, <span class="string">&quot;å››å·&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„ï¼šå…ˆå–å‡º æ‰€æœ‰çš„ Key ,é€šè¿‡ Key å–å‡ºå¯¹åº”çš„ Value</span></span><br><span class="line">        Set keyset = map.keySet();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//(1) å¢å¼º for</span></span><br><span class="line">        System.out.println(<span class="string">&quot;-----ç¬¬ä¸€ç§æ–¹å¼-------&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object key : keyset) &#123;</span><br><span class="line">            System.out.println(key + <span class="string">&quot;-&quot;</span> + map.get(key));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//(2) è¿­ä»£å™¨</span></span><br><span class="line">        System.out.println(<span class="string">&quot;----ç¬¬äºŒç§æ–¹å¼--------&quot;</span>);</span><br><span class="line">        Iterator iterator = keyset.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Object key = iterator.next();</span><br><span class="line">            System.out.println(key + <span class="string">&quot;-&quot;</span> + map.get(key));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬äºŒç»„: æŠŠæ‰€æœ‰çš„ values å–å‡º</span></span><br><span class="line">        Collection values = map.values();</span><br><span class="line">        <span class="comment">//è¿™é‡Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰çš„ Collections ä½¿ç”¨çš„éå†æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//(1) å¢å¼º for</span></span><br><span class="line">        System.out.println(<span class="string">&quot;---å–å‡ºæ‰€æœ‰çš„ value å¢å¼º for----&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object value : values) &#123;</span><br><span class="line">            System.out.println(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//(2) è¿­ä»£å™¨</span></span><br><span class="line">        System.out.println(<span class="string">&quot;---å–å‡ºæ‰€æœ‰çš„ value è¿­ä»£å™¨----&quot;</span>);</span><br><span class="line">        Iterator iterator2 = values.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator2.hasNext()) &#123;</span><br><span class="line">            Object value = iterator2.next();</span><br><span class="line">            System.out.println(value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸‰ç»„: é€šè¿‡ EntrySet æ¥è·å– k-v</span></span><br><span class="line">        Set entrySet = map.entrySet();<span class="comment">// EntrySet&lt;Map.Entry&lt;K,V&gt;&gt;</span></span><br><span class="line">        <span class="comment">//(1) å¢å¼º for</span></span><br><span class="line">        System.out.println(<span class="string">&quot;----ä½¿ç”¨ EntrySet çš„ for å¢å¼º(ç¬¬ 3 ç§)----&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object entry : entrySet) &#123;</span><br><span class="line">        <span class="comment">//å°† entry è½¬æˆ Map.Entry</span></span><br><span class="line">            Map.Entry m = (Map.Entry) entry;</span><br><span class="line">            System.out.println(m.getKey() + <span class="string">&quot;-&quot;</span> + m.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//(2) è¿­ä»£å™¨</span></span><br><span class="line">        System.out.println(<span class="string">&quot;----ä½¿ç”¨ EntrySet çš„ è¿­ä»£å™¨(ç¬¬ 4 ç§)----&quot;</span>);</span><br><span class="line">        Iterator iterator3 = entrySet.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator3.hasNext()) &#123;</span><br><span class="line">            Object entry = iterator3.next();</span><br><span class="line">        <span class="comment">//System.out.println(next.getClass());//HashMap$Node -å®ç°-&gt; Map.Entry (getKey,getValue)</span></span><br><span class="line">        <span class="comment">//å‘ä¸‹è½¬å‹ Map.Entry</span></span><br><span class="line">            Map.Entry m = (Map.Entry) entry;</span><br><span class="line">            System.out.println(m.getKey() + <span class="string">&quot;-&quot;</span> + m.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="11-4-HashMapå°ç»“"><a href="#11-4-HashMapå°ç»“" class="headerlink" title="11.4 HashMapå°ç»“"></a>11.4 HashMapå°ç»“</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-15-57.png"></p>
<h2 id="11-5-HashMap-åº•å±‚æœºåˆ¶åŠæºç å‰–æ"><a href="#11-5-HashMap-åº•å±‚æœºåˆ¶åŠæºç å‰–æ" class="headerlink" title="11.5 HashMap åº•å±‚æœºåˆ¶åŠæºç å‰–æ"></a>11.5 HashMap åº•å±‚æœºåˆ¶åŠæºç å‰–æ</h2><p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-16-59.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-17-09.png" alt="Snipaste_2021-05-28_11-17-09"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> HashMapSource1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> HashMapæºç æ¢ç©¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 10:15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashMapSource1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HashMap map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(<span class="string">&quot;java&quot;</span>, <span class="number">10</span>);<span class="comment">//ok</span></span><br><span class="line">        map.put(<span class="string">&quot;php&quot;</span>, <span class="number">10</span>);<span class="comment">//ok</span></span><br><span class="line">        map.put(<span class="string">&quot;java&quot;</span>, <span class="number">20</span>);<span class="comment">//æ›¿æ¢ value</span></span><br><span class="line">        System.out.println(<span class="string">&quot;map=&quot;</span> + map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ–­ç‚¹ä½ç½® å¦‚ä¸‹ debugä¸€æŠŠ</strong></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-17-56.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-27_21-59-35.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">                   <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰è¾…åŠ©å˜é‡</span></span><br><span class="line">        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">        <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">            <span class="comment">//å¦‚æœåº•å±‚çš„tableæ•°ç»„ä¸ºnullï¼Œæˆ–è€…length=0ï¼Œå°±æ‰©å®¹åˆ°16</span></span><br><span class="line">            n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">//å–å‡ºhashå€¼å¯¹åº”çš„tableç´¢å¼•ä½ç½®çš„Nodeï¼Œå¦‚æœä¸ºnull å°±ç›´æ¥åŠ å…¥ k-v </span></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªNode,åŠ å…¥è¯¥ä½ç½®å³å¯</span></span><br><span class="line">        <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">            tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//è¾…åŠ©å˜é‡</span></span><br><span class="line">            Node&lt;K,V&gt; e; K k;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            å¦‚æœtableçš„ç´¢å¼•ä½ç½®çš„keyçš„hashç›¸åŒå’Œæ–°çš„keyçš„hashå€¼ç›¸åŒ</span></span><br><span class="line"><span class="comment">            å¹¶æ»¡è¶³(tableç°æœ‰çš„èŠ‚ç‚¹çš„keyå’Œå‡†å¤‡æ·»åŠ çš„keyæ˜¯åŒä¸€ä¸ªå¯¹è±¡ ||equalsè¿”å›çœŸ)</span></span><br><span class="line"><span class="comment">            å°±è®¤ä¸ºä¸èƒ½åŠ å…¥æ–°çš„ k-v</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">                ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                e = p;</span><br><span class="line">            <span class="comment">//å¦‚æœå½“å‰çš„tableçš„å·²æœ‰çš„Nodeæ˜¯çº¢é»‘æ ‘ï¼Œå°±æŒ‰ç…§çº¢é»‘æ ‘çš„æ–¹å¼å¤„ç†</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//å¦‚æœæ‰¾åˆ°èŠ‚ç‚¹ï¼Œåé¢æ˜¯é“¾è¡¨ï¼Œå°±å¾ªç¯æ¯”è¾ƒ</span></span><br><span class="line">                <span class="comment">//æ­»å¾ªç¯</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                    <span class="comment">//å¦‚æœæ•´ä¸ªé“¾è¡¨ï¼Œæ²¡æœ‰å’Œä»–ç›¸åŒï¼Œå°±æ·»åŠ åˆ°è¯¥é“¾è¡¨æœ€å</span></span><br><span class="line">                    <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                        <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                            treeifyBin(tab, hash);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//å¾ªç¯æ¯”è¾ƒè¿‡ç¨‹ä¸­ï¼Œå‘ç°æœ‰ç›¸åŒï¼Œå°±breakï¼Œåªæ˜¯æ›¿æ¢value</span></span><br><span class="line">                    <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                        ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    p = e;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">                V oldValue = e.value;</span><br><span class="line">                <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                    e.value = value;<span class="comment">//æ›¿æ¢</span></span><br><span class="line">                afterNodeAccess(e);</span><br><span class="line">                <span class="keyword">return</span> oldValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//æ¯å¢åŠ ä¸€ä¸ªNodeï¼Œå°±size++</span></span><br><span class="line">        ++modCount;</span><br><span class="line">        <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">            resize();</span><br><span class="line">        afterNodeInsertion(evict);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_10-37-23.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">treeifyBin</span><span class="params">(Node&lt;K,V&gt;[] tab, <span class="keyword">int</span> hash)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å…³äºæ ‘åŒ– è½¬åŒ–æˆçº¢é»‘æ ‘ </span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    å¦‚æœtableä¸ºnullï¼Œæˆ–è€…å¤§å°æ²¡åˆ°64.æš‚æ—¶ä¸æ ‘åŒ–ï¼Œè€Œæ˜¯è¿›è¡Œæ‰©å®¹</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">        <span class="keyword">int</span> n, index; Node&lt;K,V&gt; e;</span><br><span class="line">        <span class="keyword">if</span> (tab == <span class="keyword">null</span> || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)</span><br><span class="line">            resize();</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((e = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            TreeNode&lt;K,V&gt; hd = <span class="keyword">null</span>, tl = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                TreeNode&lt;K,V&gt; p = replacementTreeNode(e, <span class="keyword">null</span>);</span><br><span class="line">                <span class="keyword">if</span> (tl == <span class="keyword">null</span>)</span><br><span class="line">                    hd = p;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    p.prev = tl;</span><br><span class="line">                    tl.next = p;</span><br><span class="line">                &#125;</span><br><span class="line">                tl = p;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">if</span> ((tab[index] = hd) != <span class="keyword">null</span>)</span><br><span class="line">                hd.treeify(tab);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h1 id="12-HashTableé›†åˆ"><a href="#12-HashTableé›†åˆ" class="headerlink" title="12. HashTableé›†åˆ"></a>12. HashTableé›†åˆ</h1><h2 id="12-1-HashTable-åŸºæœ¬ä»‹ç»"><a href="#12-1-HashTable-åŸºæœ¬ä»‹ç»" class="headerlink" title="12.1 HashTable åŸºæœ¬ä»‹ç»"></a>12.1 HashTable åŸºæœ¬ä»‹ç»</h2><ul>
<li>å­˜æ”¾çš„å…ƒç´ æ˜¯é”®å€¼å¯¹:å³K-V</li>
<li>hashtableçš„é”®å’Œå€¼éƒ½ä¸èƒ½ä¸ºnullï¼Œå¦åˆ™ä¼šæŠ›å‡ºNullPointerException</li>
<li> hashTableä½¿ç”¨æ–¹æ³•åŸºæœ¬ä¸Šå’ŒHashMapä¸€æ ·</li>
<li>hashTableæ˜¯çº¿ç¨‹å®‰å…¨çš„(synchronized)ï¼Œ hashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</li>
</ul>
<h2 id="12-2-Hashtableå’ŒHashMap-å¯¹æ¯”"><a href="#12-2-Hashtableå’ŒHashMap-å¯¹æ¯”" class="headerlink" title="12.2 Hashtableå’ŒHashMap å¯¹æ¯”"></a>12.2 Hashtableå’ŒHashMap å¯¹æ¯”</h2><table>
<thead>
<tr>
<th></th>
<th>ç‰ˆæœ¬</th>
<th>çº¿ç¨‹å®‰å…¨(åŒæ­¥)</th>
<th>æ•ˆç‡</th>
<th>å…è®¸nullé”®nullå€¼</th>
</tr>
</thead>
<tbody><tr>
<td>HashMap</td>
<td>1.2</td>
<td>ä¸å®‰å…¨</td>
<td>é«˜</td>
<td>å¯ä»¥</td>
</tr>
<tr>
<td>HashTable</td>
<td>1.0</td>
<td>å®‰å…¨</td>
<td>è¾ƒä½</td>
<td>ä¸å¯ä»¥</td>
</tr>
</tbody></table>
<h1 id="13-Propertiesé›†åˆ"><a href="#13-Propertiesé›†åˆ" class="headerlink" title="13. Propertiesé›†åˆ"></a>13. Propertiesé›†åˆ</h1><ul>
<li>Propertiesç±»ç»§æ‰¿è‡ªHashtableç±»å¹¶ä¸”å®ç°äº†Mapæ¥å£ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ä¸€ç§é”®å€¼å¯¹çš„å½¢å¼æ¥ä¿å­˜æ•°æ®ã€‚</li>
<li>Properties è¿˜å¯ä»¥ç”¨äºä»xoxx.propertiesæ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ•°æ®åˆ°Propertiesç±»å¯¹è±¡,å¹¶è¿›è¡Œè¯»å–å’Œä¿®æ”¹</li>
<li>ä½¿ç”¨ç‰¹ç‚¹å’ŒHashtableç±»ä¼¼</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Properties_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> ç”¨ä¸€å¥è¯æè¿°ç±»çš„ä½œç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 10:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Properties_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. Properties ç»§æ‰¿ Hashtable</span></span><br><span class="line">        <span class="comment">//2. å¯ä»¥é€šè¿‡ k-v å­˜æ”¾æ•°æ®ï¼Œå½“ç„¶ key å’Œ value ä¸èƒ½ä¸º null</span></span><br><span class="line">        <span class="comment">//å¢åŠ </span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        <span class="comment">//properties.put(null, &quot;abc&quot;);//æŠ›å‡º ç©ºæŒ‡é’ˆå¼‚å¸¸</span></span><br><span class="line">         <span class="comment">//properties.put(&quot;abc&quot;, null); //æŠ›å‡º ç©ºæŒ‡é’ˆå¼‚å¸¸</span></span><br><span class="line">        properties.put(<span class="string">&quot;john&quot;</span>, <span class="number">100</span>);<span class="comment">//k-v</span></span><br><span class="line">        properties.put(<span class="string">&quot;lucy&quot;</span>, <span class="number">100</span>);</span><br><span class="line">        properties.put(<span class="string">&quot;lic&quot;</span>, <span class="number">100</span>);</span><br><span class="line">        properties.put(<span class="string">&quot;lic&quot;</span>, <span class="number">88</span>);<span class="comment">//å¦‚æœæœ‰ç›¸åŒçš„ key ï¼Œ value è¢«æ›¿æ¢</span></span><br><span class="line">        System.out.println(<span class="string">&quot;properties=&quot;</span> + properties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡ k è·å–å¯¹åº”å€¼</span></span><br><span class="line">        System.out.println(properties.get(<span class="string">&quot;lic&quot;</span>));<span class="comment">//88</span></span><br><span class="line">        <span class="comment">//åˆ é™¤</span></span><br><span class="line">        properties.remove(<span class="string">&quot;lic&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;properties=&quot;</span> + properties);</span><br><span class="line">        <span class="comment">//ä¿®æ”¹</span></span><br><span class="line">        properties.put(<span class="string">&quot;john&quot;</span>, <span class="string">&quot;çº¦ç¿°&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;properties=&quot;</span> + properties);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_10-49-44.png"></p>
<h1 id="14-å®é™…åº”ç”¨ä¸­å¦‚ä½•é€‰æ‹©é›†åˆå®ç°ç±»"><a href="#14-å®é™…åº”ç”¨ä¸­å¦‚ä½•é€‰æ‹©é›†åˆå®ç°ç±»" class="headerlink" title="14. å®é™…åº”ç”¨ä¸­å¦‚ä½•é€‰æ‹©é›†åˆå®ç°ç±»"></a>14. å®é™…åº”ç”¨ä¸­å¦‚ä½•é€‰æ‹©é›†åˆå®ç°ç±»</h1><p>åœ¨å¼€å‘ä¸­ï¼Œé€‰æ‹©ä»€ä¹ˆé›†åˆå®ç°ç±»ï¼Œä¸»è¦å–å†³äºä¸šåŠ¡æ“ä½œç‰¹ç‚¹ï¼Œç„¶åæ ¹æ®é›†åˆå®ç°ç±»ç‰¹æ€§è¿›è¡Œé€‰æ‹©ï¼Œåˆ†æå¦‚ä¸‹:</p>
<p>ï¼ˆ1)å…ˆåˆ¤æ–­å­˜å‚¨çš„ç±»å‹(ä¸€ç»„å¯¹è±¡[å•åˆ—]æˆ–ä¸€ç»„é”®å€¼å¯¹[åŒåˆ—)</p>
<p>(2)ä¸€ç»„å¯¹è±¡[å•åˆ—]:Collectionæ¥å£</p>
<ul>
<li>å…è®¸é‡å¤ List<ul>
<li>å¢åˆ å¤š:LinkedList[åº•å±‚ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨]</li>
<li>æ”¹æŸ¥å¤š:ArrayList[åº•å±‚ç»´æŠ¤äº†Objectç±»å‹çš„å¯å˜æ•°ç»„]</li>
</ul>
</li>
<li>ä¸å…è®¸é‡å¤:Set<ul>
<li>æ— åº: HashSet[åº•å±‚æ˜¯HashMapï¼Œç»´æŠ¤äº†ä¸€ä¸ªå“ˆå¸Œè¡¨å³(æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘)]</li>
<li>æ’åº:TreeSet</li>
<li>æ’å…¥å’Œå–å‡ºé¡ºåºä¸€è‡´:LinkedHashSetï¼Œç»´æŠ¤æ•°ç»„+åŒå‘é“¾è¡¨</li>
</ul>
</li>
</ul>
<p>(3)ä¸€ç»„é”®å€¼å¯¹[åŒåˆ—:Map</p>
<ul>
<li><p>é”®æ— åº: HashMap [åº•å±‚æ˜¯:å“ˆå¸Œè¡¨jdk7:æ•°ç»„+é“¾è¡¨ï¼Œjdk8:æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘]</p>
</li>
<li><p>é”®æ’åº:TreeMap</p>
</li>
<li><p>é”®æ’å…¥å’Œå–å‡ºé¡ºåºä¸€è‡´:LinkedHashMap</p>
</li>
<li><p>è¯»å–æ–‡ä»¶Properties</p>
</li>
</ul>
<p><strong>æ¯”è¾ƒå™¨çš„ä½¿ç”¨</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> TreeSet_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> TreeSetæ¯”è¾ƒå™¨çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 11:36</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeSet_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        TreeSet treeSet = <span class="keyword">new</span> TreeSet(<span class="keyword">new</span> Comparator() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä¸‹é¢ è°ƒç”¨ String çš„ compareTo æ–¹æ³•è¿›è¡Œå­—ç¬¦ä¸²å¤§å°æ¯”è¾ƒ</span></span><br><span class="line">        <span class="comment">//è¦æ±‚åŠ å…¥çš„å…ƒç´ ï¼ŒæŒ‰ç…§é•¿åº¦å¤§å°æ’åº</span></span><br><span class="line">        <span class="comment">//return ((String) o2).compareTo((String) o1);</span></span><br><span class="line">                <span class="keyword">return</span> ((String) o1).length() - ((String) o2).length();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        treeSet.add(<span class="string">&quot;tom&quot;</span>);<span class="comment">//3</span></span><br><span class="line">        treeSet.add(<span class="string">&quot;sp&quot;</span>);</span><br><span class="line">        treeSet.add(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        treeSet.add(<span class="string">&quot;abc&quot;</span>);<span class="comment">//3</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;treeSet=&quot;</span> + treeSet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="15-å·¥å…·ç±»"><a href="#15-å·¥å…·ç±»" class="headerlink" title="15 å·¥å…·ç±»"></a>15 å·¥å…·ç±»</h1><ul>
<li> Collectionsæ˜¯ä¸€ä¸ªæ“ä½œSetã€Listå’Œ Mapç­‰é›†åˆçš„å·¥å…·ç±»</li>
<li>Collectionsä¸­æä¾›äº†ä¸€ç³»åˆ—é™æ€çš„æ–¹æ³•å¯¹é›†åˆå…ƒç´ è¿›è¡Œæ’åºã€æŸ¥è¯¢å’Œä¿®æ”¹ç­‰æ“ä½œ</li>
</ul>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-56-00.png"></p>
<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-55-49.png" alt="Snipaste_2021-05-28_11-55-49"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhuang.collection;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Classname</span> Collections_</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Collectionså·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/5/28 11:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Created</span> by dell</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;all&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Collections_</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»º ArrayList é›†åˆï¼Œç”¨äºæµ‹è¯•.</span></span><br><span class="line">        ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list.add(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;smith&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;king&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;milan&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        <span class="comment">// reverse(List)ï¼šåè½¬ List ä¸­å…ƒç´ çš„é¡ºåº</span></span><br><span class="line">        Collections.reverse(list);</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        <span class="comment">// shuffle(List)ï¼šå¯¹ List é›†åˆå…ƒç´ è¿›è¡Œéšæœºæ’åº</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            Collections.shuffle(list);</span><br><span class="line">            System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// sort(List)ï¼šæ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºå¯¹æŒ‡å®š List é›†åˆå…ƒç´ æŒ‰å‡åºæ’åº</span></span><br><span class="line">        Collections.sort(list);</span><br><span class="line">        System.out.println(<span class="string">&quot;è‡ªç„¶æ’åºå&quot;</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// sort(Listï¼ŒComparator)ï¼šæ ¹æ®æŒ‡å®šçš„ Comparator äº§ç”Ÿçš„é¡ºåºå¯¹ List é›†åˆå…ƒç´ è¿›è¡Œæ’åº</span></span><br><span class="line">        <span class="comment">//æˆ‘ä»¬å¸Œæœ›æŒ‰ç…§ å­—ç¬¦ä¸²çš„é•¿åº¦å¤§å°æ’åº</span></span><br><span class="line">        Collections.sort(list, <span class="keyword">new</span> Comparator() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¯ä»¥åŠ å…¥æ ¡éªŒä»£ç .</span></span><br><span class="line">                <span class="keyword">return</span> ((String) o2).length() - ((String) o1).length();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(<span class="string">&quot;å­—ç¬¦ä¸²é•¿åº¦å¤§å°æ’åº=&quot;</span> + list);</span><br><span class="line">        <span class="comment">// swap(Listï¼Œintï¼Œ int)ï¼šå°†æŒ‡å®š list é›†åˆä¸­çš„ i å¤„å…ƒç´ å’Œ j å¤„å…ƒç´ è¿›è¡Œäº¤æ¢</span></span><br><span class="line">        Collections.swap(list, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;äº¤æ¢åçš„æƒ…å†µ&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;list=&quot;</span> + list);</span><br><span class="line">        <span class="comment">//Object max(Collection)ï¼šæ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºï¼Œè¿”å›ç»™å®šé›†åˆä¸­çš„æœ€å¤§å…ƒç´ </span></span><br><span class="line">        System.out.println(<span class="string">&quot;è‡ªç„¶é¡ºåºæœ€å¤§å…ƒç´ =&quot;</span> + Collections.max(list));</span><br><span class="line">        <span class="comment">//Object max(Collectionï¼ŒComparator)ï¼šæ ¹æ® Comparator æŒ‡å®šçš„é¡ºåºï¼Œè¿”å›ç»™å®šé›†åˆä¸­çš„æœ€å¤§å…ƒç´ </span></span><br><span class="line">        <span class="comment">//æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦è¿”å›é•¿åº¦æœ€å¤§çš„å…ƒç´ </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦è¿”å›é•¿åº¦æœ€å¤§çš„å…ƒç´ </span></span><br><span class="line">        Object maxObject = Collections.max(list, <span class="keyword">new</span> Comparator() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> ((String) o1).length() - ((String) o2).length();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(<span class="string">&quot;é•¿åº¦æœ€å¤§çš„å…ƒç´ =&quot;</span> + maxObject);</span><br><span class="line">        <span class="comment">//Object min(Collection)</span></span><br><span class="line">        <span class="comment">//Object min(Collectionï¼ŒComparator)</span></span><br><span class="line">        <span class="comment">//ä¸Šé¢çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå‚è€ƒ max å³å¯</span></span><br><span class="line">        <span class="comment">//int frequency(Collectionï¼ŒObject)ï¼šè¿”å›æŒ‡å®šé›†åˆä¸­æŒ‡å®šå…ƒç´ çš„å‡ºç°æ¬¡æ•°</span></span><br><span class="line">        System.out.println(<span class="string">&quot;tom å‡ºç°çš„æ¬¡æ•°=&quot;</span> + Collections.frequency(list, <span class="string">&quot;tom&quot;</span>));</span><br><span class="line">        <span class="comment">//void copy(List dest,List src)ï¼šå°† src ä¸­çš„å†…å®¹å¤åˆ¶åˆ° dest ä¸­</span></span><br><span class="line">        ArrayList dest = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="comment">//ä¸ºäº†å®Œæˆä¸€ä¸ªå®Œæ•´æ‹·è´ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç»™ dest èµ‹å€¼ï¼Œå¤§å°å’Œ list.size()ä¸€æ ·</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">            dest.add(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ‹·è´</span></span><br><span class="line">        Collections.copy(dest, list);</span><br><span class="line">        System.out.println(<span class="string">&quot;dest=&quot;</span> + dest);</span><br><span class="line">        <span class="comment">//boolean replaceAll(List listï¼ŒObject oldValï¼ŒObject newVal)ï¼šä½¿ç”¨æ–°å€¼æ›¿æ¢ List å¯¹è±¡çš„æ‰€æœ‰æ—§å€¼</span></span><br><span class="line">        <span class="comment">//å¦‚æœ list ä¸­ï¼Œæœ‰ tom å°±æ›¿æ¢æˆ æ±¤å§†</span></span><br><span class="line">        Collections.replaceAll(list, <span class="string">&quot;tom&quot;</span>, <span class="string">&quot;æ±¤å§†&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;list æ›¿æ¢å=&quot;</span> + list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhuang-kang/note-picture-2/raw/master/Java%E9%9B%86%E5%90%88%E5%9B%BE%E7%89%87/Snipaste_2021-05-28_11-52-40.png"></p>
<p><strong>å†™åœ¨æœ€åï¼šç”¨éŸ©è€å¸ˆçš„ä¸€å¥è¯æ¥é­ç­–è‡ªå·±â€æˆ‘äº¦æ— ä»–ï¼ŒæƒŸæ‰‹ç†Ÿå°”ï¼â€</strong></p>
<p><strong>è‹¥æœ‰é”™è¯¯ï¼Œè¿˜è¯·å„ä½æŒ‡å‡ºé”™è¯¯ï¼ŒåŠæ—¶æ›´æ”¹ï¼</strong></p>
]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
</search>
